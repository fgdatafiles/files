this.createjs=this.createjs||{},function(){"use strict";var a=createjs.PreloadJS=createjs.PreloadJS||{};a.version="0.6.3",a.buildDate="Tue, 15 Sep 2015 20:59:37 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(a,b){"use strict";function c(){this.constructor=a}return c.prototype=b.prototype,a.prototype=new c},this.createjs=this.createjs||{},createjs.promote=function(a,b){"use strict";var c=a.prototype,d=Object.getPrototypeOf&&Object.getPrototypeOf(c)||c.__proto__;if(d)for(var e in c[(b+="_")+"constructor"]=d.constructor,d)c.hasOwnProperty(e)&&"function"==typeof d[e]&&(c[b+e]=d[e]);return a},this.createjs=this.createjs||{},createjs.indexOf=function(a,b){"use strict";for(var c=0,d=a.length;c<d;c++)if(b===a[c])return c;return-1},this.createjs=this.createjs||{},function(){"use strict";createjs.proxy=function(a,b){var c=Array.prototype.slice.call(arguments,2);return function(){return a.apply(b,Array.prototype.slice.call(arguments,0).concat(c))}}}(),this.createjs=this.createjs||{},function(){"use strict";function BrowserDetect(){throw"BrowserDetect cannot be instantiated"}var a=BrowserDetect.agent=window.navigator.userAgent;BrowserDetect.isWindowPhone=-1<a.indexOf("IEMobile")||-1<a.indexOf("Windows Phone"),BrowserDetect.isFirefox=-1<a.indexOf("Firefox"),BrowserDetect.isOpera=null!=window.opera,BrowserDetect.isChrome=-1<a.indexOf("Chrome"),BrowserDetect.isIOS=(-1<a.indexOf("iPod")||-1<a.indexOf("iPhone")||-1<a.indexOf("iPad"))&&!BrowserDetect.isWindowPhone,BrowserDetect.isAndroid=-1<a.indexOf("Android")&&!BrowserDetect.isWindowPhone,BrowserDetect.isBlackberry=-1<a.indexOf("Blackberry"),createjs.BrowserDetect=BrowserDetect}(),this.createjs=this.createjs||{},function(){"use strict";function Event(a,b,c){this.type=a,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!b,this.cancelable=!!c,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var a=Event.prototype;a.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},a.stopPropagation=function(){this.propagationStopped=!0},a.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},a.remove=function(){this.removed=!0},a.clone=function(){return new Event(this.type,this.bubbles,this.cancelable)},a.set=function(a){for(var b in a)this[b]=a[b];return this},a.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=Event}(),this.createjs=this.createjs||{},function(){"use strict";function ErrorEvent(a,b,c){this.Event_constructor("error"),this.title=a,this.message=b,this.data=c}createjs.extend(ErrorEvent,createjs.Event).clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(ErrorEvent,"Event")}(),this.createjs=this.createjs||{},function(){"use strict";function EventDispatcher(){this._listeners=null,this._captureListeners=null}var a=EventDispatcher.prototype;EventDispatcher.initialize=function(b){b.addEventListener=a.addEventListener,b.on=a.on,b.removeEventListener=b.off=a.removeEventListener,b.removeAllEventListeners=a.removeAllEventListeners,b.hasEventListener=a.hasEventListener,b.dispatchEvent=a.dispatchEvent,b._dispatchEvent=a._dispatchEvent,b.willTrigger=a.willTrigger},a.addEventListener=function(a,b,c){var d,e=(d=c?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{})[a];return e&&this.removeEventListener(a,b,c),(e=d[a])?e.push(b):d[a]=[b],b},a.on=function(a,b,c,d,e,f){return b.handleEvent&&(c=c||b,b=b.handleEvent),c=c||this,this.addEventListener(a,function(a){b.call(c,a,e),d&&a.remove()},f)},a.removeEventListener=function(a,b,c){var d=c?this._captureListeners:this._listeners;if(d){var e=d[a];if(e)for(var f=0,g=e.length;f<g;f++)if(e[f]==b){1==g?delete d[a]:e.splice(f,1);break}}},a.off=a.removeEventListener,a.removeAllEventListeners=function(a){a?(this._listeners&&delete this._listeners[a],this._captureListeners&&delete this._captureListeners[a]):this._listeners=this._captureListeners=null},a.dispatchEvent=function(a){if("string"==typeof a){var b=this._listeners;if(!b||!b[a])return!1;a=new createjs.Event(a)}else a.target&&a.clone&&(a=a.clone());try{a.target=this}catch(c){}if(a.bubbles&&this.parent){for(var d=this,e=[d];d.parent;)e.push(d=d.parent);var f,g=e.length;for(f=g-1;0<=f&&!a.propagationStopped;f--)e[f]._dispatchEvent(a,1+(0==f));for(f=1;f<g&&!a.propagationStopped;f++)e[f]._dispatchEvent(a,3)}else this._dispatchEvent(a,2);return a.defaultPrevented},a.hasEventListener=function(a){var b=this._listeners,c=this._captureListeners;return!!(b&&b[a]||c&&c[a])},a.willTrigger=function(a){for(var b=this;b;){if(b.hasEventListener(a))return!0;b=b.parent}return!1},a.toString=function(){return"[EventDispatcher]"},a._dispatchEvent=function(a,b){var c,d=1==b?this._captureListeners:this._listeners;if(a&&d){var e=d[a.type];if(!e||!(c=e.length))return;try{a.currentTarget=this}catch(f){}try{a.eventPhase=b}catch(f){}a.removed=!1,e=e.slice();for(var g=0;g<c&&!a.immediatePropagationStopped;g++){var h=e[g];h.handleEvent?h.handleEvent(a):h(a),a.removed&&(this.off(a.type,h,1==b),a.removed=!1)}}},createjs.EventDispatcher=EventDispatcher}(),this.createjs=this.createjs||{},function(){"use strict";function ProgressEvent(a,b){this.Event_constructor("progress"),this.loaded=a,this.total=null==b?1:b,this.progress=0==b?0:this.loaded/this.total}createjs.extend(ProgressEvent,createjs.Event).clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(ProgressEvent,"Event")}(window),function(){function a(b,d){function f(a){if(f[a]!==q)return f[a];var b;if("bug-string-char-index"==a)b="a"!="a"[0];else if("json"==a)b=f("json-stringify")&&f("json-parse");else{var c,e='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==a){var i=d.stringify,k="function"==typeof i&&t;if(k){(c=function(){return 1}).toJSON=c;try{k="0"===i(0)&&"0"===i(new g)&&'""'==i(new h)&&i(s)===q&&i(q)===q&&i()===q&&"1"===i(c)&&"[1]"==i([c])&&"[null]"==i([q])&&"null"==i(null)&&"[null,null,null]"==i([q,s,null])&&i({a:[c,!0,!1,null,"\0\b\n\f\r\t"]})==e&&"1"===i(null,c)&&"[\n 1,\n 2\n]"==i([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==i(new j(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==i(new j(864e13))&&'"-000001-01-01T00:00:00.000Z"'==i(new j(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==i(new j(-1))}catch(l){k=!1}}b=k}if("json-parse"==a){var m=d.parse;if("function"==typeof m)try{if(0===m("0")&&!m(!1)){var n=5==(c=m(e)).a.length&&1===c.a[0];if(n){try{n=!m('"\t"')}catch(l){}if(n)try{n=1!==m("01")}catch(l){}if(n)try{n=1!==m("1.")}catch(l){}}}}catch(l){n=!1}b=n}}return f[a]=!!b}b||(b=e.Object()),d||(d=e.Object());var g=b.Number||e.Number,h=b.String||e.String,i=b.Object||e.Object,j=b.Date||e.Date,k=b.SyntaxError||e.SyntaxError,l=b.TypeError||e.TypeError,m=b.Math||e.Math,n=b.JSON||e.JSON;"object"==typeof n&&n&&(d.stringify=n.stringify,d.parse=n.parse);var o,p,q,r=i.prototype,s=r.toString,t=new j(-0xc782b5b800cec);try{t=-109252==t.getUTCFullYear()&&0===t.getUTCMonth()&&1===t.getUTCDate()&&10==t.getUTCHours()&&37==t.getUTCMinutes()&&6==t.getUTCSeconds()&&708==t.getUTCMilliseconds()}catch(u){}if(!f("json")){var v="[object Function]",x="[object Number]",y="[object String]",z="[object Array]",B=f("bug-string-char-index");if(!t)var C=m.floor,D=[0,31,59,90,120,151,181,212,243,273,304,334],E=function(a,b){return D[b]+365*(a-1970)+C((a-1969+(b=+(1<b)))/4)-C((a-1901+b)/100)+C((a-1601+b)/400)};if((o=r.hasOwnProperty)||(o=function(a){var b,c={};return o=(c.__proto__=null,c.__proto__={toString:1},c).toString!=s?function(a){var b=this.__proto__,c=a in(this.__proto__=null,this);return this.__proto__=b,c}:(b=c.constructor,function(a){var c=(this.constructor||b).prototype;return a in this&&!(a in c&&this[a]===c[a])}),c=null,o.call(this,a)}),p=function(a,b){var d,e,f,g=0;for(f in(d=function(){this.valueOf=0}).prototype.valueOf=0,e=new d)o.call(e,f)&&g++;return d=e=null,(p=g?2==g?function(a,b){var c,d={},e=s.call(a)==v;for(c in a)e&&"prototype"==c||o.call(d,c)||!(d[c]=1)||!o.call(a,c)||b(c)}:function(a,b){var c,d,e=s.call(a)==v;for(c in a)e&&"prototype"==c||!o.call(a,c)||(d="constructor"===c)||b(c);(d||o.call(a,c="constructor"))&&b(c)}:(e=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],function(a,b){var d,f,g=s.call(a)==v,h=!g&&"function"!=typeof a.constructor&&c[typeof a.hasOwnProperty]&&a.hasOwnProperty||o;for(d in a)g&&"prototype"==d||!h.call(a,d)||b(d);for(f=e.length;d=e[--f];h.call(a,d)&&b(d));}))(a,b)},!f("json-stringify")){function H(a,b){return("000000"+(b||0)).slice(-a)}function J(a){for(var b='"',c=0,d=a.length,e=!B||10<d,f=e&&(B?a.split(""):a);c<d;c++){var g=a.charCodeAt(c);switch(g){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=F[g];break;default:if(g<32){b+="\\u00"+H(2,g.toString(16));break}b+=e?f[c]:a.charAt(c)}}return b+'"'}var F={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},K=function(a,b,c,d,e,f,g){var h,i,j,k,m,n,r,t,u,v,B,D,F,G,I,L;try{h=b[a]}catch(M){}if("object"==typeof h&&h)if("[object Date]"!=(i=s.call(h))||o.call(h,"toJSON"))"function"==typeof h.toJSON&&(i!=x&&i!=y&&i!=z||o.call(h,"toJSON"))&&(h=h.toJSON(a));else if(-1/0<h&&h<1/0){if(E){for(m=C(h/864e5),j=C(m/365.2425)+1970-1;E(j+1,0)<=m;j++);for(k=C((m-E(j,0))/30.42);E(j,k+1)<=m;k++);m=1+m-E(j,k),r=C((n=(h%864e5+864e5)%864e5)/36e5)%24,t=C(n/6e4)%60,u=C(n/1e3)%60,v=n%1e3}else j=h.getUTCFullYear(),k=h.getUTCMonth(),m=h.getUTCDate(),r=h.getUTCHours(),t=h.getUTCMinutes(),u=h.getUTCSeconds(),v=h.getUTCMilliseconds();h=(j<=0||1e4<=j?(j<0?"-":"+")+H(6,j<0?-j:j):H(4,j))+"-"+H(2,k+1)+"-"+H(2,m)+"T"+H(2,r)+":"+H(2,t)+":"+H(2,u)+"."+H(3,v)+"Z"}else h=null;if(c&&(h=c.call(b,a,h)),null===h)return"null";if("[object Boolean]"==(i=s.call(h)))return""+h;if(i==x)return-1/0<h&&h<1/0?""+h:"null";if(i==y)return J(""+h);if("object"==typeof h){for(G=g.length;G--;)if(g[G]===h)throw l();if(g.push(h),B=[],I=f,f+=e,i==z){for(F=0,G=h.length;F<G;F++)D=K(F,h,c,d,e,f,g),B.push(D===q?"null":D);L=B.length?e?"[\n"+f+B.join(",\n"+f)+"\n"+I+"]":"["+B.join(",")+"]":"[]"}else p(d||h,function(a){var b=K(a,h,c,d,e,f,g);b!==q&&B.push(J(a)+":"+(e?" ":"")+b)}),L=B.length?e?"{\n"+f+B.join(",\n"+f)+"\n"+I+"}":"{"+B.join(",")+"}":"{}";return g.pop(),L}};d.stringify=function(a,b,d){var e,f,g,h;if(c[typeof b]&&b)if((h=s.call(b))==v)f=b;else if(h==z){g={};for(var i,j=0,k=b.length;j<k;i=b[j++],(h=s.call(i))!=y&&h!=x||(g[i]=1));}if(d)if((h=s.call(d))==x){if(0<(d-=d%1))for(e="",10<d&&(d=10);e.length<d;e+=" ");}else h==y&&(e=d.length<=10?d:d.slice(0,10));return K("",((i={})[""]=a,i),f,g,e,"",[])}}if(!f("json-parse")){function P(){throw L=M=null,k()}function Q(){for(var a,b,c,d,e,f=M,g=f.length;L<g;)switch(e=f.charCodeAt(L)){case 9:case 10:case 13:case 32:L++;break;case 123:case 125:case 91:case 93:case 58:case 44:return a=B?f.charAt(L):f[L],L++,a;case 34:for(a="@",L++;L<g;)if((e=f.charCodeAt(L))<32)P();else if(92==e)switch(e=f.charCodeAt(++L)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:a+=O[e],L++;break;case 117:for(b=++L,c=L+4;L<c;L++)48<=(e=f.charCodeAt(L))&&e<=57||97<=e&&e<=102||65<=e&&e<=70||P();a+=N("0x"+f.slice(b,L));break;default:P()}else{if(34==e)break;for(e=f.charCodeAt(L),b=L;32<=e&&92!=e&&34!=e;)e=f.charCodeAt(++L);a+=f.slice(b,L)}if(34==f.charCodeAt(L))return L++,a;P();default:if(b=L,45==e&&(d=!0,e=f.charCodeAt(++L)),48<=e&&e<=57){for(48==e&&(48<=(e=f.charCodeAt(L+1))&&e<=57)&&P(),d=!1;L<g&&(48<=(e=f.charCodeAt(L))&&e<=57);L++);if(46==f.charCodeAt(L)){for(c=++L;c<g&&(48<=(e=f.charCodeAt(c))&&e<=57);c++);c==L&&P(),L=c}if(101==(e=f.charCodeAt(L))||69==e){for(43!=(e=f.charCodeAt(++L))&&45!=e||L++,c=L;c<g&&(48<=(e=f.charCodeAt(c))&&e<=57);c++);c==L&&P(),L=c}return+f.slice(b,L)}if(d&&P(),"true"==f.slice(L,L+4))return L+=4,!0;if("false"==f.slice(L,L+5))return L+=5,!1;if("null"==f.slice(L,L+4))return L+=4,null;P()}return"$"}function S(a,b,c){var d=T(a,b,c);d===q?delete a[b]:a[b]=d}var L,M,N=h.fromCharCode,O={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},R=function(a){var b,c;if("$"==a&&P(),"string"==typeof a){if("@"==(B?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];"]"!=(a=Q());c||(c=!0))c&&(","==a?"]"==(a=Q())&&P():P()),","==a&&P(),b.push(R(a));return b}if("{"==a){for(b={};"}"!=(a=Q());c||(c=!0))c&&(","==a?"}"==(a=Q())&&P():P()),","!=a&&"string"==typeof a&&"@"==(B?a.charAt(0):a[0])&&":"==Q()||P(),b[a.slice(1)]=R(Q());return b}P()}return a},T=function(a,b,c){var d,e=a[b];if("object"==typeof e&&e)if(s.call(e)==z)for(d=e.length;d--;)S(e,d,c);else p(e,function(a){S(e,a,c)});return c.call(a,b,e)};d.parse=function(a,b){var c,d;return L=0,M=""+a,c=R(Q()),"$"!=Q()&&P(),L=M=null,b&&s.call(b)==v?T(((d={})[""]=c,d),"",b):c}}}return d.runInContext=a,d}var b="function"==typeof define&&define.amd,c={function:!0,object:!0},d=c[typeof exports]&&exports&&!exports.nodeType&&exports,e=c[typeof window]&&window||this,f=d&&c[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(!f||f.global!==f&&f.window!==f&&f.self!==f||(e=f),d&&!b)a(e,d);else{var g=e.JSON,h=e.JSON3,i=!1,j=a(e,e.JSON3={noConflict:function(){return i||(i=!0,e.JSON=g,e.JSON3=h,g=h=null),j}});e.JSON={parse:j.parse,stringify:j.stringify}}b&&define(function(){return j})}.call(this),function(){var a={appendToHead:function(b){a.getHead().appendChild(b)},getHead:function(){return document.head||document.getElementsByTagName("head")[0]},getBody:function(){return document.body||document.getElementsByTagName("body")[0]}};createjs.DomUtils=a}(),function(){var a={parseXML:function(a,b){var c=null;try{if(window.DOMParser)c=(new DOMParser).parseFromString(a,b)}catch(e){}if(!c)try{(c=new ActiveXObject("Microsoft.XMLDOM")).async=!1,c.loadXML(a)}catch(e){c=null}return c},parseJSON:function(a){if(null==a)return null;try{return JSON.parse(a)}catch(b){throw b}}};createjs.DataUtils=a}(),this.createjs=this.createjs||{},function(){"use strict";function LoadItem(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=b.LOAD_TIMEOUT_DEFAULT}var a=LoadItem.prototype={},b=LoadItem;b.LOAD_TIMEOUT_DEFAULT=8e3,b.create=function(a){if("string"==typeof a){var c=new LoadItem;return c.src=a,c}if(a instanceof b)return a;if(a instanceof Object&&a.src)return null==a.loadTimeout&&(a.loadTimeout=b.LOAD_TIMEOUT_DEFAULT),a;throw new Error("Type not recognized.")},a.set=function(a){for(var b in a)this[b]=a[b];return this},createjs.LoadItem=b}(),function(){var a={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[./]*?\//i,EXTENSION_PATT:/\/?[^/]+\.(\w{1,5})$/i,parseURI:function(b){var c={absolute:!1,relative:!1};if(null==b)return c;var e,d=b.indexOf("?");return-1<d&&(b=b.substr(0,d)),a.ABSOLUTE_PATT.test(b)?c.absolute=!0:a.RELATIVE_PATT.test(b)&&(c.relative=!0),(e=b.match(a.EXTENSION_PATT))&&(c.extension=e[1].toLowerCase()),c},formatQueryString:function(a,b){if(null==a)throw new Error("You must specify data.");var c=[];for(var d in a)c.push(d+"="+escape(a[d]));return b&&(c=c.concat(b)),c.join("&")},buildPath:function(a,b){if(null==b)return a;var c=[],d=a.indexOf("?");if(-1!=d){var e=a.slice(d+1);c=c.concat(e.split("&"))}return-1!=d?a.slice(0,d)+"?"+this._formatQueryString(b,c):a+"?"+this._formatQueryString(b,c)},isCrossDomain:function(a){var b=document.createElement("a");b.href=a.src;var c=document.createElement("a");return c.href=location.href,""!=b.hostname&&(b.port!=c.port||b.protocol!=c.protocol||b.hostname!=c.hostname)},isLocal:function(a){var b=document.createElement("a");return b.href=a.src,""==b.hostname&&"file:"==b.protocol},isBinary:function(a){switch(a){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},isImageTag:function(a){return a instanceof HTMLImageElement},isAudioTag:function(a){return!!window.HTMLAudioElement&&a instanceof HTMLAudioElement},isVideoTag:function(a){return!!window.HTMLVideoElement&&a instanceof HTMLVideoElement},isText:function(a){switch(a){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:case createjs.AbstractLoader.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(a){if(null==a)return createjs.AbstractLoader.TEXT;switch(a.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}}};createjs.RequestUtils=a}(),this.createjs=this.createjs||{},function(){"use strict";function AbstractLoader(a,b,c){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=c,this.resultFormatter=null,this._item=a?createjs.LoadItem.create(a):null,this._preferXHR=b,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var a=createjs.extend(AbstractLoader,createjs.EventDispatcher),b=AbstractLoader;b.POST="POST",b.GET="GET",b.BINARY="binary",b.CSS="css",b.IMAGE="image",b.JAVASCRIPT="javascript",b.JSON="json",b.JSONP="jsonp",b.MANIFEST="manifest",b.SOUND="sound",b.VIDEO="video",b.SPRITESHEET="spritesheet",b.SVG="svg",b.TEXT="text",b.XML="xml",a.getItem=function(){return this._item},a.getResult=function(a){return a?this._rawResult:this._result},a.getTag=function(){return this._tag},a.setTag=function(a){this._tag=a},a.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var a=new createjs.Event("initialize");a.loader=this._request,this.dispatchEvent(a),this._request.load()},a.cancel=function(){this.canceled=!0,this.destroy()},a.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},a.getLoadedItems=function(){return this._loadedItems},a._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},a._createTag=function(a){return null},a._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},a._sendProgress=function(a){if(!this._isCanceled()){var b=null;"number"==typeof a?(this.progress=a,b=new createjs.ProgressEvent(this.progress)):(b=a,this.progress=a.loaded/a.total,b.progress=this.progress,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(b)}},a._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var a=new createjs.Event("complete");a.rawResult=this._rawResult,null!=this._result&&(a.result=this._result),this.dispatchEvent(a)}},a._sendError=function(a){!this._isCanceled()&&this.hasEventListener("error")&&(null==a&&(a=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(a))},a._isCanceled=function(){return!(null!=window.createjs&&!this.canceled)},a.resultFormatter=null,a.handleEvent=function(a){switch(a.type){case"complete":this._rawResult=a.target._response;var b=this.resultFormatter&&this.resultFormatter(this),c=this;b instanceof Function?b(function(a){c._result=a,c._sendComplete()}):(this._result=b||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(a);break;case"error":this._sendError(a);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_"+a.type.toUpperCase()+"_ERROR"))}},a.buildPath=function(a,b){return createjs.RequestUtils.buildPath(a,b)},a.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(AbstractLoader,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function AbstractMediaLoader(a,b,c){this.AbstractLoader_constructor(a,b,c),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src"}var a=createjs.extend(AbstractMediaLoader,createjs.AbstractLoader);a.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},a._createTag=function(){},a._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},a._formatResult=function(a){return this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(a.getTag().src=a.getResult(!0)),a.getTag()},createjs.AbstractMediaLoader=createjs.promote(AbstractMediaLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function AbstractRequest(a){this._item=a}var a=createjs.extend(AbstractRequest,createjs.EventDispatcher);a.load=function(){},a.destroy=function(){},a.cancel=function(){},createjs.AbstractRequest=createjs.promote(AbstractRequest,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function TagRequest(a,b,c){this.AbstractRequest_constructor(a),this._tag=b,this._tagSrcAttribute=c,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var a=createjs.extend(TagRequest,createjs.AbstractRequest);a.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var a=new createjs.Event("initialize");a.loader=this._tag,this.dispatchEvent(a),this._hideTag(),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0)},a.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},a._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var a=this._tag;"loaded"!=a.readyState&&"complete"!=a.readyState||this._handleTagComplete()},a._handleError=function(){this._clean(),this.dispatchEvent("error")},a._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},a._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},a._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},a._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},a._showTag=function(){this._tag.style.visibility=this._startTagVisibility},a._handleStalled=function(){},createjs.TagRequest=createjs.promote(TagRequest,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function MediaTagRequest(a,b,c){this.AbstractRequest_constructor(a),this._tag=b,this._tagSrcAttribute=c,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var a=createjs.extend(MediaTagRequest,createjs.TagRequest);a.load=function(){var a=createjs.proxy(this._handleStalled,this);this._stalledCallback=a;var b=createjs.proxy(this._handleProgress,this);this._handleProgress=b,this._tag.addEventListener("stalled",a),this._tag.addEventListener("progress",b),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},a._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var a=this._tag;"loaded"!=a.readyState&&"complete"!=a.readyState||this._handleTagComplete()},a._handleStalled=function(){},a._handleProgress=function(a){if(a&&!(0<a.loaded&&0==a.total)){var b=new createjs.ProgressEvent(a.loaded,a.total);this.dispatchEvent(b)}},a._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(MediaTagRequest,"TagRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function XHRRequest(a){this.AbstractRequest_constructor(a),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),this._createXHR(a)}var a=createjs.extend(XHRRequest,createjs.AbstractRequest);XHRRequest.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],a.getResult=function(a){return a&&this._rawResponse?this._rawResponse:this._response},a.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},a.load=function(){if(null!=this._request){null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(a){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,a))}}else this._handleError()},a.setResponseType=function(a){"blob"===a&&(a=window.URL?"blob":"arraybuffer",this._responseType=a),this._request.responseType=a},a.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},a.getResponseHeader=function(a){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(a):null},a._handleProgress=function(a){if(a&&!(0<a.loaded&&0==a.total)){var b=new createjs.ProgressEvent(a.loaded,a.total);this.dispatchEvent(b)}},a._handleLoadStart=function(a){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},a._handleAbort=function(a){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,a))},a._handleError=function(a){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(a.message))},a._handleReadyStateChange=function(a){4==this._request.readyState&&this._handleLoad()},a._handleLoad=function(a){if(!this.loaded){this.loaded=!0;var b=this._checkError();if(b)return void this._handleError(b);if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(c){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===c.name&&window.BlobBuilder){var d=new BlobBuilder;d.append(this._response),this._response=d.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},a._handleTimeout=function(a){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,a))},a._checkError=function(){var a=parseInt(this._request.status);switch(a){case 404:return new Error(a);case 0:return this._getResponse()?null:new Error(a)}return null},a._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(a){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(a){}return null},a._createXHR=function(a){var b=createjs.RequestUtils.isCrossDomain(a),c={},d=null;if(window.XMLHttpRequest)d=new XMLHttpRequest,b&&void 0===d.withCredentials&&window.XDomainRequest&&(d=new XDomainRequest);else{for(var e=0,f=s.ACTIVEX_VERSIONS.length;e<f;e++){var g=s.ACTIVEX_VERSIONS[e];try{d=new ActiveXObject(g);break}catch(h){}}if(null==d)return!1}null==a.mimeType&&createjs.RequestUtils.isText(a.type)&&(a.mimeType="text/plain; charset=utf-8"),a.mimeType&&d.overrideMimeType&&d.overrideMimeType(a.mimeType),this._xhrLevel="string"==typeof d.responseType?2:1;var i;if(i=a.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(a.src,a.values):a.src,d.open(a.method||createjs.AbstractLoader.GET,i,!0),b&&d instanceof XMLHttpRequest&&1==this._xhrLevel&&(c.Origin=location.origin),a.values&&a.method==createjs.AbstractLoader.POST&&(c["Content-Type"]="application/x-www-form-urlencoded"),b||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest"),a.headers)for(var j in a.headers)c[j]=a.headers[j];for(j in c)d.setRequestHeader(j,c[j]);return d instanceof XMLHttpRequest&&void 0!==a.withCredentials&&(d.withCredentials=a.withCredentials),this._request=d,!0},a._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},a.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(XHRRequest,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function LoadQueue(a,b,c){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[createjs.ImageLoader,createjs.JavaScriptLoader,createjs.CSSLoader,createjs.JSONLoader,createjs.JSONPLoader,createjs.SoundLoader,createjs.ManifestLoader,createjs.SpriteSheetLoader,createjs.XMLLoader,createjs.SVGLoader,createjs.BinaryLoader,createjs.VideoLoader,createjs.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(a,b,c)}var a=createjs.extend(LoadQueue,createjs.AbstractLoader),b=LoadQueue;a.init=function(a,b,c){this.useXHR=!0,this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(a),this._paused=!1,this._basePath=b,this._crossOrigin=c,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=NaN},b.loadTimeout=8e3,b.LOAD_TIMEOUT=0,b.BINARY=createjs.AbstractLoader.BINARY,b.CSS=createjs.AbstractLoader.CSS,b.IMAGE=createjs.AbstractLoader.IMAGE,b.JAVASCRIPT=createjs.AbstractLoader.JAVASCRIPT,b.JSON=createjs.AbstractLoader.JSON,b.JSONP=createjs.AbstractLoader.JSONP,b.MANIFEST=createjs.AbstractLoader.MANIFEST,b.SOUND=createjs.AbstractLoader.SOUND,b.VIDEO=createjs.AbstractLoader.VIDEO,b.SVG=createjs.AbstractLoader.SVG,b.TEXT=createjs.AbstractLoader.TEXT,b.XML=createjs.AbstractLoader.XML,b.POST=createjs.AbstractLoader.POST,b.GET=createjs.AbstractLoader.GET,a.registerLoader=function(a){if(!a||!a.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(a))throw new Error("loader already exists.");this._availableLoaders.unshift(a)},a.unregisterLoader=function(a){var b=this._availableLoaders.indexOf(a);-1!=b&&b<this._defaultLoaderLength-1&&this._availableLoaders.splice(b,1)},a.setUseXHR=function(a){return this.setPreferXHR(a)},a.setPreferXHR=function(a){return this.preferXHR=0!=a&&null!=window.XMLHttpRequest,this.preferXHR},a.removeAll=function(){this.remove()},a.remove=function(a){var b=null;if(!a||a instanceof Array){if(a)b=a;else if(0<arguments.length)return}else b=[a];var c=!1;if(b){for(;b.length;){var d=b.pop(),e=this.getResult(d);for(f=this._loadQueue.length-1;0<=f;f--)if((g=this._loadQueue[f].getItem()).id==d||g.src==d){this._loadQueue.splice(f,1)[0].cancel();break}for(f=this._loadQueueBackup.length-1;0<=f;f--)if((g=this._loadQueueBackup[f].getItem()).id==d||g.src==d){this._loadQueueBackup.splice(f,1)[0].cancel();break}if(e)this._disposeItem(this.getItem(d));else for(var f=this._currentLoads.length-1;0<=f;f--){var g=this._currentLoads[f].getItem();if(g.id==d||g.src==d){this._currentLoads.splice(f,1)[0].cancel(),c=!0;break}}}c&&this._loadNext()}else{for(var h in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[h]);this.init(this.preferXHR,this._basePath,this._crossOrigin)}},a.reset=function(){for(var a in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[a]);for(var b=[],c=0,d=this._loadQueueBackup.length;c<d;c++)b.push(this._loadQueueBackup[c].getItem());this.loadManifest(b,!1)},a.installPlugin=function(a){if(null!=a&&null!=a.getPreloadHandlers){this._plugins.push(a);var b=a.getPreloadHandlers();if(b.scope=a,null!=b.types)for(var c=0,d=b.types.length;c<d;c++)this._typeCallbacks[b.types[c]]=b;if(null!=b.extensions)for(c=0,d=b.extensions.length;c<d;c++)this._extensionCallbacks[b.extensions[c]]=b}},a.setMaxConnections=function(a){this._maxConnections=a,!this._paused&&0<this._loadQueue.length&&this._loadNext()},a.loadFile=function(a,b,c){if(null!=a)this._addItem(a,null,c),!1!==b?this.setPaused(!1):this.setPaused(!0);else{var d=new createjs.ErrorEvent("PRELOAD_NO_FILE");this._sendError(d)}},a.loadManifest=function(a,c,d){var e=null,f=null;if(a instanceof Array){if(0==a.length){var g=new createjs.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(g)}e=a}else if("string"==typeof a)e=[{src:a,type:b.MANIFEST}];else{if("object"!=typeof a){g=new createjs.ErrorEvent("PRELOAD_MANIFEST_NULL");return void this._sendError(g)}if(void 0!==a.src){if(null==a.type)a.type=b.MANIFEST;else if(a.type!=b.MANIFEST){g=new createjs.ErrorEvent("PRELOAD_MANIFEST_TYPE");this._sendError(g)}e=[a]}else void 0!==a.manifest&&(e=a.manifest,f=a.path)}for(var h=0,i=e.length;h<i;h++)this._addItem(e[h],f,d);!1!==c?this.setPaused(!1):this.setPaused(!0)},a.load=function(){this.setPaused(!1)},a.getItem=function(a){return this._loadItemsById[a]||this._loadItemsBySrc[a]},a.getResult=function(a,b){var c=this._loadItemsById[a]||this._loadItemsBySrc[a];if(null==c)return null;var d=c.id;return b&&this._loadedRawResults[d]?this._loadedRawResults[d]:this._loadedResults[d]},a.getItems=function(a){var b=[];for(var c in this._loadItemsById){var d=this._loadItemsById[c],e=this.getResult(c);!0===a&&null==e||b.push({item:d,result:e,rawResult:this.getResult(c,!0)})}return b},a.setPaused=function(a){this._paused=a,this._paused||this._loadNext()},a.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=NaN},a._addItem=function(a,b,c){var d=this._createLoadItem(a,b,c);if(null!=d){var e=this._createLoader(d);null!=e&&("plugins"in e&&(e.plugins=this._plugins),d._loader=e,this._loadQueue.push(e),this._loadQueueBackup.push(e),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&d.type==createjs.LoadQueue.JAVASCRIPT||!0===d.maintainOrder)&&(this._scriptOrder.push(d),this._loadedScripts.push(null)))}},a._createLoadItem=function(a,b,c){var d=createjs.LoadItem.create(a);if(null==d)return null;var e="",f=c||this._basePath;if(d.src instanceof Object){if(!d.type)return null;if(b){e=b;var g=createjs.RequestUtils.parseURI(b);null==f||g.absolute||g.relative||(e=f+e)}else null!=f&&(e=f)}else{var h=createjs.RequestUtils.parseURI(d.src);h.extension&&(d.ext=h.extension),null==d.type&&(!d.ext&&window.console&&console.error("unable to get extension for "+d.src),d.type=createjs.RequestUtils.getTypeByExtension(d.ext));var i=d.src;if(!h.absolute&&!h.relative)if(b){e=b;g=createjs.RequestUtils.parseURI(b);i=b+i,null==f||g.absolute||g.relative||(e=f+e)}else null!=f&&(e=f);d.src=e+d.src}d.path=e,void 0!==d.id&&null!==d.id&&""!==d.id||(d.id=i);var j=this._typeCallbacks[d.type]||this._extensionCallbacks[d.ext];if(j){var k=j.callback.call(j.scope,d,this);if(!1===k)return null;!0===k||null!=k&&(d._loader=k),null!=(h=createjs.RequestUtils.parseURI(d.src)).extension&&(d.ext=h.extension)}return this._loadItemsById[d.id]=d,null==(this._loadItemsBySrc[d.src]=d).crossOrigin&&(d.crossOrigin=this._crossOrigin),d},a._createLoader=function(a){if(null!=a._loader)return a._loader;for(var b=this.preferXHR,c=0;c<this._availableLoaders.length;c++){var d=this._availableLoaders[c];if(d&&d.canLoadItem(a))return new d(a,b)}return null},a._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var a=0;a<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);a++){var b=this._loadQueue[a];this._canStartLoad(b)&&(this._loadQueue.splice(a,1),a--,this._loadItem(b))}}},a._loadItem=function(a){a.on("fileload",this._handleFileLoad,this),a.on("progress",this._handleProgress,this),a.on("complete",this._handleFileComplete,this),a.on("error",this._handleError,this),a.on("fileerror",this._handleFileError,this),this._currentLoads.push(a),this._sendFileStart(a.getItem()),a.load()},a._handleFileLoad=function(a){a.target=null,this.dispatchEvent(a)},a._handleFileError=function(a){var b=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,a.item);this._sendError(b)},a._handleError=function(a){var b=a.target;this._numItemsLoaded++,this._finishOrderedItem(b,!0),this._updateProgress();var c=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,b.getItem());this._sendError(c),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(b),this._cleanLoadItem(b),this._loadNext())},a._handleFileComplete=function(a){var b=a.target,c=b.getItem(),d=b.getResult();this._loadedResults[c.id]=d;var e=b.getResult(!0);null!=e&&e!==d&&(this._loadedRawResults[c.id]=e),this._saveLoadedItems(b),this._removeLoadItem(b),this._finishOrderedItem(b)||this._processFinishedLoad(c,b),this._cleanLoadItem(b)},a._saveLoadedItems=function(a){var b=a.getLoadedItems();if(null!==b)for(var c=0;c<b.length;c++){var d=b[c].item;this._loadItemsBySrc[d.src]=d,this._loadItemsById[d.id]=d,this._loadedResults[d.id]=b[c].result,this._loadedRawResults[d.id]=b[c].rawResult}},a._finishOrderedItem=function(a,b){var c=a.getItem();if(this.maintainScriptOrder&&c.type==createjs.LoadQueue.JAVASCRIPT||c.maintainOrder){a instanceof createjs.JavaScriptLoader&&(this._currentlyLoadingScript=!1);var d=createjs.indexOf(this._scriptOrder,c);return-1!=d&&(this._loadedScripts[d]=!0===b||c,this._checkScriptLoadOrder(),!0)}return!1},a._checkScriptLoadOrder=function(){for(var a=this._loadedScripts.length,b=0;b<a;b++){var c=this._loadedScripts[b];if(null==c)break;if(!0!==c){var d=this._loadedResults[c.id];c.type==createjs.LoadQueue.JAVASCRIPT&&createjs.DomUtils.appendToHead(d);var e=c._loader;this._processFinishedLoad(c,e),this._loadedScripts[b]=!0}}},a._processFinishedLoad=function(a,b){if(this._numItemsLoaded++,!this.maintainScriptOrder&&a.type==createjs.LoadQueue.JAVASCRIPT){var c=b.getTag();createjs.DomUtils.appendToHead(c)}this._updateProgress(),this._sendFileComplete(a,b),this._loadNext()},a._canStartLoad=function(a){if(!this.maintainScriptOrder||a.preferXHR)return!0;var b=a.getItem();if(b.type!=createjs.LoadQueue.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;for(var c=this._scriptOrder.indexOf(b),d=0;d<c;){if(null==this._loadedScripts[d])return!1;d++}return this._currentlyLoadingScript=!0},a._removeLoadItem=function(a){for(var b=this._currentLoads.length,c=0;c<b;c++)if(this._currentLoads[c]==a){this._currentLoads.splice(c,1);break}},a._cleanLoadItem=function(a){var b=a.getItem();b&&delete b._loader},a._handleProgress=function(a){var b=a.target;this._sendFileProgress(b.getItem(),b.progress),this._updateProgress()},a._updateProgress=function(){var a=this._numItemsLoaded/this._numItems,b=this._numItems-this._numItemsLoaded;if(0<b){for(var c=0,d=0,e=this._currentLoads.length;d<e;d++)c+=this._currentLoads[d].progress;a+=c/b*(b/this._numItems)}this._lastProgress!=a&&(this._sendProgress(a),this._lastProgress=a)},a._disposeItem=function(a){delete this._loadedResults[a.id],delete this._loadedRawResults[a.id],delete this._loadItemsById[a.id],delete this._loadItemsBySrc[a.src]},a._sendFileProgress=function(a,b){if(!this._isCanceled()&&!this._paused&&this.hasEventListener("fileprogress")){var c=new createjs.Event("fileprogress");c.progress=b,c.loaded=b,c.total=1,c.item=a,this.dispatchEvent(c)}},a._sendFileComplete=function(a,b){if(!this._isCanceled()&&!this._paused){var c=new createjs.Event("fileload");c.loader=b,c.item=a,c.result=this._loadedResults[a.id],c.rawResult=this._loadedRawResults[a.id],a.completeHandler&&a.completeHandler(c),this.hasEventListener("fileload")&&this.dispatchEvent(c)}},a._sendFileStart=function(a){var b=new createjs.Event("filestart");b.item=a,this.hasEventListener("filestart")&&this.dispatchEvent(b)},a.toString=function(){return"[PreloadJS LoadQueue]"},createjs.LoadQueue=createjs.promote(LoadQueue,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function TextLoader(a){this.AbstractLoader_constructor(a,!0,createjs.AbstractLoader.TEXT)}(createjs.extend(TextLoader,createjs.AbstractLoader),TextLoader).canLoadItem=function(a){return a.type==createjs.AbstractLoader.TEXT},createjs.TextLoader=createjs.promote(TextLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function BinaryLoader(a){this.AbstractLoader_constructor(a,!0,createjs.AbstractLoader.BINARY),this.on("initialize",this._updateXHR,this)}var a=createjs.extend(BinaryLoader,createjs.AbstractLoader);BinaryLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.BINARY},a._updateXHR=function(a){a.loader.setResponseType("arraybuffer")},createjs.BinaryLoader=createjs.promote(BinaryLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function CSSLoader(a,b){this.AbstractLoader_constructor(a,b,createjs.AbstractLoader.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=b?document.createElement("style"):document.createElement("link"),this._tag.rel="stylesheet",this._tag.type="text/css"}var a=createjs.extend(CSSLoader,createjs.AbstractLoader);CSSLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.CSS},a._formatResult=function(a){if(this._preferXHR){var b=a.getTag();if(b.styleSheet)b.styleSheet.cssText=a.getResult(!0);else{var c=document.createTextNode(a.getResult(!0));b.appendChild(c)}}else b=this._tag;return createjs.DomUtils.appendToHead(b),b},createjs.CSSLoader=createjs.promote(CSSLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function ImageLoader(a,b){this.AbstractLoader_constructor(a,b,createjs.AbstractLoader.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",createjs.RequestUtils.isImageTag(a)?this._tag=a:createjs.RequestUtils.isImageTag(a.src)?this._tag=a.src:createjs.RequestUtils.isImageTag(a.tag)&&(this._tag=a.tag),null!=this._tag?this._preferXHR=!1:this._tag=document.createElement("img"),this.on("initialize",this._updateXHR,this)}var a=createjs.extend(ImageLoader,createjs.AbstractLoader);ImageLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.IMAGE},a.load=function(){if(""!=this._tag.src&&this._tag.complete)this._sendComplete();else{var a=this._item.crossOrigin;1==a&&(a="Anonymous"),null==a||createjs.RequestUtils.isLocal(this._item.src)||(this._tag.crossOrigin=a),this.AbstractLoader_load()}},a._updateXHR=function(a){a.loader.mimeType="text/plain; charset=x-user-defined-binary",a.loader.setResponseType&&a.loader.setResponseType("blob")},a._formatResult=function(a){var b=this;return function(c){var d=b._tag,e=window.URL||window.webkitURL;if(b._preferXHR)if(e){var f=e.createObjectURL(a.getResult(!0));f?(d.src=f,d.onload=function(){e.revokeObjectURL(this.src),c(this)}):(d.src=a.getItem().src,d.complete?c(d):d.onload=function(){c(this)})}else d.src=a.getItem().src,d.complete?c(d):d.onload=function(){c(this)}}},createjs.ImageLoader=createjs.promote(ImageLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function JavaScriptLoader(a,b){this.AbstractLoader_constructor(a,b,createjs.AbstractLoader.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(document.createElement("script"))}var a=createjs.extend(JavaScriptLoader,createjs.AbstractLoader);JavaScriptLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.JAVASCRIPT},a._formatResult=function(a){var b=a.getTag();return this._preferXHR&&(b.text=a.getResult(!0)),b},createjs.JavaScriptLoader=createjs.promote(JavaScriptLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function JSONLoader(a){this.AbstractLoader_constructor(a,!0,createjs.AbstractLoader.JSON),this.resultFormatter=this._formatResult}var a=createjs.extend(JSONLoader,createjs.AbstractLoader);JSONLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.JSON},a._formatResult=function(a){var b=null;try{b=createjs.DataUtils.parseJSON(a.getResult(!0))}catch(c){var d=new createjs.ErrorEvent("JSON_FORMAT",null,c);return this._sendError(d),c}return b},createjs.JSONLoader=createjs.promote(JSONLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function JSONPLoader(a){this.AbstractLoader_constructor(a,!1,createjs.AbstractLoader.JSONP),this.setTag(document.createElement("script")),this.getTag().type="text/javascript"}var a=createjs.extend(JSONPLoader,createjs.AbstractLoader);JSONPLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.JSONP},a.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},a.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=window[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=createjs.proxy(this._handleLoad,this),window.document.body.appendChild(this._tag),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},a._handleLoad=function(a){this._result=this._rawResult=a,this._sendComplete(),this._dispose()},a._handleTimeout=function(){this._dispose(),this.dispatchEvent(new createjs.ErrorEvent("timeout"))},a._dispose=function(){window.document.body.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},createjs.JSONPLoader=createjs.promote(JSONPLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function ManifestLoader(a){this.AbstractLoader_constructor(a,null,createjs.AbstractLoader.MANIFEST),this.plugins=null,this._manifestQueue=null}var a=createjs.extend(ManifestLoader,createjs.AbstractLoader),b=ManifestLoader;b.MANIFEST_PROGRESS=.25,b.canLoadItem=function(a){return a.type==createjs.AbstractLoader.MANIFEST},a.load=function(){this.AbstractLoader_load()},a._createRequest=function(){var a=this._item.callback;this._request=null!=a?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},a.handleEvent=function(a){switch(a.type){case"complete":return this._rawResult=a.target.getResult(!0),this._result=a.target.getResult(),this._sendProgress(b.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return a.loaded*=b.MANIFEST_PROGRESS,this.progress=a.loaded/a.total,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0),void this._sendProgress(a)}this.AbstractLoader_handleEvent(a)},a.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},a._loadManifest=function(a){if(a&&a.manifest){var b=this._manifestQueue=new createjs.LoadQueue;b.on("fileload",this._handleManifestFileLoad,this),b.on("progress",this._handleManifestProgress,this),b.on("complete",this._handleManifestComplete,this,!0),b.on("error",this._handleManifestError,this,!0);for(var c=0,d=this.plugins.length;c<d;c++)b.installPlugin(this.plugins[c]);b.loadManifest(a)}else this._sendComplete()},a._handleManifestFileLoad=function(a){a.target=null,this.dispatchEvent(a)},a._handleManifestComplete=function(a){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},a._handleManifestProgress=function(a){this.progress=a.progress*(1-b.MANIFEST_PROGRESS)+b.MANIFEST_PROGRESS,this._sendProgress(this.progress)},a._handleManifestError=function(a){var b=new createjs.Event("fileerror");b.item=a.data,this.dispatchEvent(b)},createjs.ManifestLoader=createjs.promote(ManifestLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function SoundLoader(a,b){this.AbstractMediaLoader_constructor(a,b,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(a)?this._tag=a:createjs.RequestUtils.isAudioTag(a.src)?this._tag=a:createjs.RequestUtils.isAudioTag(a.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(a)?a:a.src),null!=this._tag&&(this._preferXHR=!1)}var a=createjs.extend(SoundLoader,createjs.AbstractMediaLoader);SoundLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.SOUND},a._createTag=function(a){var b=document.createElement("audio");return b.autoplay=!1,b.preload="none",b.src=a,b},createjs.SoundLoader=createjs.promote(SoundLoader,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function VideoLoader(a,b){this.AbstractMediaLoader_constructor(a,b,createjs.AbstractLoader.VIDEO),createjs.RequestUtils.isVideoTag(a)||createjs.RequestUtils.isVideoTag(a.src)?(this.setTag(createjs.RequestUtils.isVideoTag(a)?a:a.src),this._preferXHR=!1):this.setTag(this._createTag())}var b=VideoLoader;createjs.extend(VideoLoader,createjs.AbstractMediaLoader)._createTag=function(){return document.createElement("video")},b.canLoadItem=function(a){return a.type==createjs.AbstractLoader.VIDEO},createjs.VideoLoader=createjs.promote(VideoLoader,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function SpriteSheetLoader(a){this.AbstractLoader_constructor(a,null,createjs.AbstractLoader.SPRITESHEET),this._manifestQueue=null}var a=createjs.extend(SpriteSheetLoader,createjs.AbstractLoader),b=SpriteSheetLoader;b.SPRITESHEET_PROGRESS=.25,b.canLoadItem=function(a){return a.type==createjs.AbstractLoader.SPRITESHEET},a.destroy=function(){this.AbstractLoader_destroy,this._manifestQueue.close()},a._createRequest=function(){var a=this._item.callback;this._request=null!=a?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},a.handleEvent=function(a){switch(a.type){case"complete":return this._rawResult=a.target.getResult(!0),this._result=a.target.getResult(),this._sendProgress(b.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return a.loaded*=b.SPRITESHEET_PROGRESS,this.progress=a.loaded/a.total,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0),void this._sendProgress(a)}this.AbstractLoader_handleEvent(a)},a._loadManifest=function(a){if(a&&a.images){var b=this._manifestQueue=new createjs.LoadQueue;b.on("complete",this._handleManifestComplete,this,!0),b.on("fileload",this._handleManifestFileLoad,this),b.on("progress",this._handleManifestProgress,this),b.on("error",this._handleManifestError,this,!0),b.loadManifest(a.images)}},a._handleManifestFileLoad=function(a){var b=a.result;if(null!=b){var c=this.getResult().images,d=c.indexOf(a.item.src);c[d]=b}},a._handleManifestComplete=function(a){this._result=new createjs.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},a._handleManifestProgress=function(a){this.progress=a.progress*(1-b.SPRITESHEET_PROGRESS)+b.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},a._handleManifestError=function(a){var b=new createjs.Event("fileerror");b.item=a.data,this.dispatchEvent(b)},createjs.SpriteSheetLoader=createjs.promote(SpriteSheetLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function SVGLoader(a,b){this.AbstractLoader_constructor(a,b,createjs.AbstractLoader.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",b?this.setTag(document.createElement("svg")):(this.setTag(document.createElement("object")),this.getTag().type="image/svg+xml")}var a=createjs.extend(SVGLoader,createjs.AbstractLoader);SVGLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.SVG},a._formatResult=function(a){var b=createjs.DataUtils.parseXML(a.getResult(!0),"text/xml"),c=a.getTag();return!this._preferXHR&&document.body.contains(c)&&document.body.removeChild(c),null!=b.documentElement?(c.appendChild(b.documentElement),c.style.visibility="visible",c):b},createjs.SVGLoader=createjs.promote(SVGLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function XMLLoader(a){this.AbstractLoader_constructor(a,!0,createjs.AbstractLoader.XML),this.resultFormatter=this._formatResult}var a=createjs.extend(XMLLoader,createjs.AbstractLoader);XMLLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.XML},a._formatResult=function(a){return createjs.DataUtils.parseXML(a.getResult(!0),"text/xml")},createjs.XMLLoader=createjs.promote(XMLLoader,"AbstractLoader")}(),function(window){function BellhopEventDispatcher(){this._listeners={}}var p=BellhopEventDispatcher.prototype;function listenerSorter(a,b){return a._priority-b._priority}p.on=function(type,callback,priority){if("string"!=typeof type)for(var t in type)this.on(t,type[t],priority);else for(var listener,types=type.split(" "),i=0,len=types.length;i<len;i++)type=types[i],(listener=this._listeners[type])||(listener=this._listeners[type]=[]),callback._priority=parseInt(priority)||0,-1===listener.indexOf(callback)&&(listener.push(callback),1<listener.length&&listener.sort(listenerSorter));return this},p.off=function(type,callback){if(void 0===type||!this._listeners)return this._listeners={},this;if(void 0===this._listeners[type])return this;if(void 0===callback)delete this._listeners[type];else for(var listeners=this._listeners[type],i=0,len=listeners.length;i<len;i++)if(listeners[i]===callback){listeners.splice(i,1);break}return this},p.trigger=function(event){"string"==typeof event&&(event={type:event});var listeners=this._listeners[event.type];if(void 0!==listeners)for(var i=listeners.length-1;0<=i;i--)listeners[i](event)},p.destroy=function(){this._listeners=null},window.BellhopEventDispatcher=BellhopEventDispatcher}(window),function(window){function Bellhop(){BellhopEventDispatcher.call(this),this.onReceive=this.receive.bind(this),this.connected=!1,this.name="",this.isChild=!0,this.connecting=!1,this.origin="*",this._sendLater=[],this.supported=null,this.iframe=null}var BellhopEventDispatcher=window.BellhopEventDispatcher,s=BellhopEventDispatcher.prototype,p=Bellhop.prototype=Object.create(s);p.receive=function(event){if(event.source===this.target){var data=event.data;if("connected"===data){this.connecting=!1,this.connected=!0,this.trigger("connected"),this.isChild||this.target.postMessage(data,this.origin);var i,len=this._sendLater.length;if(0<len){for(i=0;i<len;i++){var e=this._sendLater[i];this.send(e.type,e.data)}this._sendLater.length=0}}else{if(!this.connected)return;try{data=JSON.parse(data,Bellhop.reviver)}catch(err){return}"object"==typeof data&&data.type&&this.trigger(data)}}},p.toString=function(){return"[Bellhop '"+this.name+"']"},Object.defineProperty(p,"target",{get:function(){return this.isChild?window.parent:this.iframe.contentWindow}}),p.connect=function(iframe,origin){if(this.connecting)return this;this.disconnect(),this.connecting=!0,this._sendLater||(this._sendLater=[]),this.iframe=iframe||null;var isChild=this.isChild=void 0===iframe,target=this.target;return this.supported=isChild?!!target&&window!=target:!!target,this.origin=void 0===origin?"*":origin,window.attachEvent?window.attachEvent("onmessage",this.onReceive):window.addEventListener("message",this.onReceive),isChild&&(window===target?this.trigger("failed"):"complete"===window.document.readyState?target.postMessage("connected",this.origin):window.onload=function(){target.postMessage("connected",this.origin)}.bind(this)),this},p.disconnect=function(){return this.connected=!1,this.connecting=!1,this.origin=null,this.iframe=null,this._sendLater&&(this._sendLater.length=0),this.isChild=!0,window.detachEvent?window.detachEvent("onmessage",this.onReceive):window.removeEventListener("message",this.onReceive),this},p.send=function(event,data){if("string"!=typeof event)throw"The event type must be a string";if(event={type:event},void 0!==data&&(event.data=data),this.connecting)this._sendLater.push(event);else{if(!this.connected)return this;this.target.postMessage(JSON.stringify(event),this.origin)}return this},p.fetch=function(event,callback,data,runOnce){var self=this;if(!this.connecting&&!this.connected)throw"No connection, please call connect() first";runOnce=void 0!==runOnce&&runOnce;var internalCallback=function(e){runOnce&&self.off(e.type,internalCallback),callback(e)};return this.on(event,internalCallback),this.send(event,data),this},p.respond=function(event,data,runOnce){runOnce=void 0!==runOnce&&runOnce;var self=this,internalCallback=function(e){runOnce&&self.off(e.type,internalCallback),self.send(event,"function"==typeof data?data():data)};return this.on(event,internalCallback),this},p.destroy=function(){s.destroy.call(this),this.disconnect(),this._sendLater=null},Bellhop.reviver=function(key,value){if(value&&"string"==typeof value.__classname){var _class=include(value.__classname);if(_class){var rtn=new _class;if(rtn.fromJSON)return rtn.fromJSON(value),rtn}}return value};var include=function(classname){for(var parts=classname.split("."),parent=window;parts.length;)if(!(parent=parent[parts.shift()]))return;return parent};window.Bellhop=Bellhop}(window),this.createjs=this.createjs||{},function(){var a=createjs.SoundJS=createjs.SoundJS||{};a.version="0.6.6",a.buildDate="Thu, 10 May 2018 18:47:59 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(a,b){"use strict";function c(){this.constructor=a}return c.prototype=b.prototype,a.prototype=new c},this.createjs=this.createjs||{},createjs.promote=function(a,b){"use strict";var c=a.prototype,d=Object.getPrototypeOf&&Object.getPrototypeOf(c)||c.__proto__;if(d)for(var e in c[(b+="_")+"constructor"]=d.constructor,d)c.hasOwnProperty(e)&&"function"==typeof d[e]&&(c[b+e]=d[e]);return a},this.createjs=this.createjs||{},createjs.indexOf=function(a,b){"use strict";for(var c=0,d=a.length;c<d;c++)if(b===a[c])return c;return-1},this.createjs=this.createjs||{},function(){"use strict";createjs.proxy=function(a,b){var c=Array.prototype.slice.call(arguments,2);return function(){return a.apply(b,Array.prototype.slice.call(arguments,0).concat(c))}}}(),this.createjs=this.createjs||{},function(){"use strict";function BrowserDetect(){throw"BrowserDetect cannot be instantiated"}var a=BrowserDetect.agent=window.navigator.userAgent;BrowserDetect.isWindowPhone=-1<a.indexOf("IEMobile")||-1<a.indexOf("Windows Phone"),BrowserDetect.isFirefox=-1<a.indexOf("Firefox"),BrowserDetect.isOpera=null!=window.opera,BrowserDetect.isChrome=-1<a.indexOf("Chrome"),BrowserDetect.isIOS=(-1<a.indexOf("iPod")||-1<a.indexOf("iPhone")||-1<a.indexOf("iPad"))&&!BrowserDetect.isWindowPhone,BrowserDetect.isAndroid=-1<a.indexOf("Android")&&!BrowserDetect.isWindowPhone,BrowserDetect.isBlackberry=-1<a.indexOf("Blackberry"),createjs.BrowserDetect=BrowserDetect}(),this.createjs=this.createjs||{},function(){"use strict";function EventDispatcher(){this._listeners=null,this._captureListeners=null}var a=EventDispatcher.prototype;EventDispatcher.initialize=function(b){b.addEventListener=a.addEventListener,b.on=a.on,b.removeEventListener=b.off=a.removeEventListener,b.removeAllEventListeners=a.removeAllEventListeners,b.hasEventListener=a.hasEventListener,b.dispatchEvent=a.dispatchEvent,b._dispatchEvent=a._dispatchEvent,b.willTrigger=a.willTrigger},a.addEventListener=function(a,b,c){var d,e=(d=c?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{})[a];return e&&this.removeEventListener(a,b,c),(e=d[a])?e.push(b):d[a]=[b],b},a.on=function(a,b,c,d,e,f){return b.handleEvent&&(c=c||b,b=b.handleEvent),c=c||this,this.addEventListener(a,function(a){b.call(c,a,e),d&&a.remove()},f)},a.removeEventListener=function(a,b,c){var d=c?this._captureListeners:this._listeners;if(d){var e=d[a];if(e)for(var f=0,g=e.length;f<g;f++)if(e[f]==b){1==g?delete d[a]:e.splice(f,1);break}}},a.off=a.removeEventListener,a.removeAllEventListeners=function(a){a?(this._listeners&&delete this._listeners[a],this._captureListeners&&delete this._captureListeners[a]):this._listeners=this._captureListeners=null},a.dispatchEvent=function(a,b,c){if("string"==typeof a){var d=this._listeners;if(!(b||d&&d[a]))return!0;a=new createjs.Event(a,b,c)}else a.target&&a.clone&&(a=a.clone());try{a.target=this}catch(a){}if(a.bubbles&&this.parent){for(var e=this,f=[e];e.parent;)f.push(e=e.parent);var g,h=f.length;for(g=h-1;0<=g&&!a.propagationStopped;g--)f[g]._dispatchEvent(a,1+(0==g));for(g=1;g<h&&!a.propagationStopped;g++)f[g]._dispatchEvent(a,3)}else this._dispatchEvent(a,2);return!a.defaultPrevented},a.hasEventListener=function(a){var b=this._listeners,c=this._captureListeners;return!!(b&&b[a]||c&&c[a])},a.willTrigger=function(a){for(var b=this;b;){if(b.hasEventListener(a))return!0;b=b.parent}return!1},a.toString=function(){return"[EventDispatcher]"},a._dispatchEvent=function(a,b){var c,d=1==b?this._captureListeners:this._listeners;if(a&&d){var e=d[a.type];if(!e||!(c=e.length))return;try{a.currentTarget=this}catch(a){}try{a.eventPhase=b}catch(a){}a.removed=!1,e=e.slice();for(var f=0;f<c&&!a.immediatePropagationStopped;f++){var g=e[f];g.handleEvent?g.handleEvent(a):g(a),a.removed&&(this.off(a.type,g,1==b),a.removed=!1)}}},createjs.EventDispatcher=EventDispatcher}(),this.createjs=this.createjs||{},function(){"use strict";function Event(a,b,c){this.type=a,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!b,this.cancelable=!!c,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var a=Event.prototype;a.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},a.stopPropagation=function(){this.propagationStopped=!0},a.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},a.remove=function(){this.removed=!0},a.clone=function(){return new Event(this.type,this.bubbles,this.cancelable)},a.set=function(a){for(var b in a)this[b]=a[b];return this},a.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=Event}(),this.createjs=this.createjs||{},function(){"use strict";function ErrorEvent(a,b,c){this.Event_constructor("error"),this.title=a,this.message=b,this.data=c}createjs.extend(ErrorEvent,createjs.Event).clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(ErrorEvent,"Event")}(),this.createjs=this.createjs||{},function(){"use strict";function ProgressEvent(a,b){this.Event_constructor("progress"),this.loaded=a,this.total=null==b?1:b,this.progress=0==b?0:this.loaded/this.total}createjs.extend(ProgressEvent,createjs.Event).clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(ProgressEvent,"Event")}(window),this.createjs=this.createjs||{},function(){"use strict";function LoadItem(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=b.LOAD_TIMEOUT_DEFAULT}var a=LoadItem.prototype={},b=LoadItem;b.LOAD_TIMEOUT_DEFAULT=8e3,b.create=function(a){if("string"==typeof a){var c=new LoadItem;return c.src=a,c}if(a instanceof b)return a;if(a instanceof Object&&a.src)return null==a.loadTimeout&&(a.loadTimeout=b.LOAD_TIMEOUT_DEFAULT),a;throw new Error("Type not recognized.")},a.set=function(a){for(var b in a)this[b]=a[b];return this},createjs.LoadItem=b}(),function(){var a={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[.\/]*?\//i,EXTENSION_PATT:/\/?[^\/]+\.(\w{1,5})$/i,parseURI:function(b){var c={absolute:!1,relative:!1};if(null==b)return c;var e,d=b.indexOf("?");return-1<d&&(b=b.substr(0,d)),a.ABSOLUTE_PATT.test(b)?c.absolute=!0:a.RELATIVE_PATT.test(b)&&(c.relative=!0),(e=b.match(a.EXTENSION_PATT))&&(c.extension=e[1].toLowerCase()),c},formatQueryString:function(a,b){if(null==a)throw new Error("You must specify data.");var c=[];for(var d in a)c.push(d+"="+escape(a[d]));return b&&(c=c.concat(b)),c.join("&")},buildPath:function(a,b){if(null==b)return a;var c=[],d=a.indexOf("?");if(-1!=d){var e=a.slice(d+1);c=c.concat(e.split("&"))}return-1!=d?a.slice(0,d)+"?"+this.formatQueryString(b,c):a+"?"+this.formatQueryString(b,c)},isCrossDomain:function(a){var b=document.createElement("a");b.href=a.src;var c=document.createElement("a");return c.href=location.href,""!=b.hostname&&(b.port!=c.port||b.protocol!=c.protocol||b.hostname!=c.hostname)},isLocal:function(a){var b=document.createElement("a");return b.href=a.src,""==b.hostname&&"file:"==b.protocol},isBinary:function(a){switch(a){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},isImageTag:function(a){return a instanceof HTMLImageElement},isAudioTag:function(a){return!!window.HTMLAudioElement&&a instanceof HTMLAudioElement},isVideoTag:function(a){return!!window.HTMLVideoElement&&a instanceof HTMLVideoElement},isText:function(a){switch(a){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:case createjs.AbstractLoader.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(a){if(null==a)return createjs.AbstractLoader.TEXT;switch(a.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}}};createjs.RequestUtils=a}(),this.createjs=this.createjs||{},function(){"use strict";function AbstractLoader(a,b,c){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=c,this.resultFormatter=null,this._item=a?createjs.LoadItem.create(a):null,this._preferXHR=b,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var a=createjs.extend(AbstractLoader,createjs.EventDispatcher),b=AbstractLoader;b.POST="POST",b.GET="GET",b.BINARY="binary",b.CSS="css",b.IMAGE="image",b.JAVASCRIPT="javascript",b.JSON="json",b.JSONP="jsonp",b.MANIFEST="manifest",b.SOUND="sound",b.VIDEO="video",b.SPRITESHEET="spritesheet",b.SVG="svg",b.TEXT="text",b.XML="xml",a.getItem=function(){return this._item},a.getResult=function(a){return a?this._rawResult:this._result},a.getTag=function(){return this._tag},a.setTag=function(a){this._tag=a},a.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var a=new createjs.Event("initialize");a.loader=this._request,this.dispatchEvent(a),this._request.load()},a.cancel=function(){this.canceled=!0,this.destroy()},a.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},a.getLoadedItems=function(){return this._loadedItems},a._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},a._createTag=function(a){return null},a._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},a._sendProgress=function(a){if(!this._isCanceled()){var b=null;"number"==typeof a?(this.progress=a,b=new createjs.ProgressEvent(this.progress)):(b=a,this.progress=a.loaded/a.total,b.progress=this.progress,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(b)}},a._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var a=new createjs.Event("complete");a.rawResult=this._rawResult,null!=this._result&&(a.result=this._result),this.dispatchEvent(a)}},a._sendError=function(a){!this._isCanceled()&&this.hasEventListener("error")&&(null==a&&(a=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(a))},a._isCanceled=function(){return!(null!=window.createjs&&!this.canceled)},a.resultFormatter=null,a.handleEvent=function(a){switch(a.type){case"complete":this._rawResult=a.target._response;var b=this.resultFormatter&&this.resultFormatter(this);b instanceof Function?b.call(this,createjs.proxy(this._resultFormatSuccess,this),createjs.proxy(this._resultFormatFailed,this)):(this._result=b||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(a);break;case"error":this._sendError(a);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_"+a.type.toUpperCase()+"_ERROR"))}},a._resultFormatSuccess=function(a){this._result=a,this._sendComplete()},a._resultFormatFailed=function(a){this._sendError(a)},a.buildPath=function(a,b){return createjs.RequestUtils.buildPath(a,b)},a.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(AbstractLoader,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function AbstractMediaLoader(a,b,c){this.AbstractLoader_constructor(a,b,c),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.on("initialize",this._updateXHR,this)}var a=createjs.extend(AbstractMediaLoader,createjs.AbstractLoader);a.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},a._createTag=function(){},a._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},a._updateXHR=function(a){a.loader.setResponseType&&a.loader.setResponseType("blob")},a._formatResult=function(a){if(this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR){var b=window.URL||window.webkitURL,c=a.getResult(!0);a.getTag().src=b.createObjectURL(c)}return a.getTag()},createjs.AbstractMediaLoader=createjs.promote(AbstractMediaLoader,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function AbstractRequest(a){this._item=a}var a=createjs.extend(AbstractRequest,createjs.EventDispatcher);a.load=function(){},a.destroy=function(){},a.cancel=function(){},createjs.AbstractRequest=createjs.promote(AbstractRequest,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function TagRequest(a,b,c){this.AbstractRequest_constructor(a),this._tag=b,this._tagSrcAttribute=c,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var a=createjs.extend(TagRequest,createjs.AbstractRequest);a.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var a=new createjs.Event("initialize");a.loader=this._tag,this.dispatchEvent(a),this._hideTag(),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0)},a.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},a._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var a=this._tag;"loaded"!=a.readyState&&"complete"!=a.readyState||this._handleTagComplete()},a._handleError=function(){this._clean(),this.dispatchEvent("error")},a._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},a._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},a._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},a._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},a._showTag=function(){this._tag.style.visibility=this._startTagVisibility},a._handleStalled=function(){},createjs.TagRequest=createjs.promote(TagRequest,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function MediaTagRequest(a,b,c){this.AbstractRequest_constructor(a),this._tag=b,this._tagSrcAttribute=c,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var a=createjs.extend(MediaTagRequest,createjs.TagRequest);a.load=function(){var a=createjs.proxy(this._handleStalled,this);this._stalledCallback=a;var b=createjs.proxy(this._handleProgress,this);this._handleProgress=b,this._tag.addEventListener("stalled",a),this._tag.addEventListener("progress",b),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},a._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var a=this._tag;"loaded"!=a.readyState&&"complete"!=a.readyState||this._handleTagComplete()},a._handleStalled=function(){},a._handleProgress=function(a){if(a&&!(0<a.loaded&&0==a.total)){var b=new createjs.ProgressEvent(a.loaded,a.total);this.dispatchEvent(b)}},a._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(MediaTagRequest,"TagRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function XHRRequest(a){this.AbstractRequest_constructor(a),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),this._createXHR(a)}var a=createjs.extend(XHRRequest,createjs.AbstractRequest);XHRRequest.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],a.getResult=function(a){return a&&this._rawResponse?this._rawResponse:this._response},a.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},a.load=function(){if(null!=this._request){null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(a){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,a))}}else this._handleError()},a.setResponseType=function(a){"blob"===a&&(a=window.URL?"blob":"arraybuffer",this._responseType=a),this._request.responseType=a},a.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},a.getResponseHeader=function(a){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(a):null},a._handleProgress=function(a){if(a&&!(0<a.loaded&&0==a.total)){var b=new createjs.ProgressEvent(a.loaded,a.total);this.dispatchEvent(b)}},a._handleLoadStart=function(a){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},a._handleAbort=function(a){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,a))},a._handleError=function(a){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(a.message))},a._handleReadyStateChange=function(a){4==this._request.readyState&&this._handleLoad()},a._handleLoad=function(a){if(!this.loaded){this.loaded=!0;var b=this._checkError();if(b)return void this._handleError(b);if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(a){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===a.name&&window.BlobBuilder){var c=new BlobBuilder;c.append(this._response),this._response=c.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},a._handleTimeout=function(a){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,a))},a._checkError=function(){var a=parseInt(this._request.status);switch(a){case 404:return new Error(a);case 0:return this._getResponse()?null:new Error(a)}return null},a._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(a){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(a){}return null},a._createXHR=function(a){var b=createjs.RequestUtils.isCrossDomain(a),c={},d=null;if(window.XMLHttpRequest)d=new XMLHttpRequest,b&&void 0===d.withCredentials&&window.XDomainRequest&&(d=new XDomainRequest);else{for(var e=0,f=s.ACTIVEX_VERSIONS.length;e<f;e++){var g=s.ACTIVEX_VERSIONS[e];try{d=new ActiveXObject(g);break}catch(a){}}if(null==d)return!1}null==a.mimeType&&createjs.RequestUtils.isText(a.type)&&(a.mimeType="text/plain; charset=utf-8"),a.mimeType&&d.overrideMimeType&&d.overrideMimeType(a.mimeType),this._xhrLevel="string"==typeof d.responseType?2:1;var h;if(h=a.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(a.src,a.values):a.src,d.open(a.method||createjs.AbstractLoader.GET,h,!0),b&&d instanceof XMLHttpRequest&&1==this._xhrLevel&&(c.Origin=location.origin),a.values&&a.method==createjs.AbstractLoader.POST&&(c["Content-Type"]="application/x-www-form-urlencoded"),b||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest"),a.headers)for(var i in a.headers)c[i]=a.headers[i];for(i in c)d.setRequestHeader(i,c[i]);return d instanceof XMLHttpRequest&&void 0!==a.withCredentials&&(d.withCredentials=a.withCredentials),this._request=d,!0},a._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},a.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(XHRRequest,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function SoundLoader(a,b){this.AbstractMediaLoader_constructor(a,b,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(a)?this._tag=a:createjs.RequestUtils.isAudioTag(a.src)?this._tag=a:createjs.RequestUtils.isAudioTag(a.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(a)?a:a.src),null!=this._tag&&(this._preferXHR=!1)}var a=createjs.extend(SoundLoader,createjs.AbstractMediaLoader);SoundLoader.canLoadItem=function(a){return a.type==createjs.AbstractLoader.SOUND},a._createTag=function(a){var b=document.createElement("audio");return b.autoplay=!1,b.preload="none",b.src=a,b},createjs.SoundLoader=createjs.promote(SoundLoader,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function PlayPropsConfig(){this.interrupt=null,this.delay=null,this.offset=null,this.loop=null,this.volume=null,this.pan=null,this.startTime=null,this.duration=null}var a=PlayPropsConfig.prototype={},b=PlayPropsConfig;b.create=function(a){if(a instanceof b||a instanceof Object){var c=new createjs.PlayPropsConfig;return c.set(a),c}throw new Error("Type not recognized.")},a.set=function(a){for(var b in a)this[b]=a[b];return this},a.toString=function(){return"[PlayPropsConfig]"},createjs.PlayPropsConfig=b}(),this.createjs=this.createjs||{},function(){"use strict";function Sound(){throw"Sound cannot be instantiated"}function a(a,b){this.init(a,b)}var b=Sound;b.INTERRUPT_ANY="any",b.INTERRUPT_EARLY="early",b.INTERRUPT_LATE="late",b.INTERRUPT_NONE="none",b.PLAY_INITED="playInited",b.PLAY_SUCCEEDED="playSucceeded",b.PLAY_INTERRUPTED="playInterrupted",b.PLAY_FINISHED="playFinished",b.PLAY_FAILED="playFailed",b.SUPPORTED_EXTENSIONS=["mp3","ogg","opus","mpeg","wav","m4a","mp4","aiff","wma","mid"],b.EXTENSION_MAP={m4a:"mp4"},b.FILE_PATTERN=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([\/.]*?(?:[^?]+)?\/)?(?:((?:[^\/?]+)\.(\w+))|(?:[^\/?]+))(?:\?((?:(?:[^&]*?[\/=])?(?:((?:(?:[^\/?&=]+)\.(\w+)))\S*?)|\S+))?)?$/,b.defaultInterruptBehavior=b.INTERRUPT_NONE,b.alternateExtensions=[],b.activePlugin=null,b._masterVolume=1,Object.defineProperty(b,"volume",{get:function(){return this._masterVolume},set:function(a){if(null==Number(a))return!1;if(a=Math.max(0,Math.min(1,a)),b._masterVolume=a,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(a))for(var c=this._instances,d=0,e=c.length;d<e;d++)c[d].setMasterVolume(a)}}),b._masterMute=!1,Object.defineProperty(b,"muted",{get:function(){return this._masterMute},set:function(a){if(null==a)return!1;if(this._masterMute=a,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(a))for(var b=this._instances,c=0,d=b.length;c<d;c++)b[c].setMasterMute(a);return!0}}),Object.defineProperty(b,"capabilities",{get:function(){return null==b.activePlugin?null:b.activePlugin._capabilities},set:function(a){return!1}}),b._pluginsRegistered=!1,b._lastID=0,b._instances=[],b._idHash={},b._preloadHash={},b._defaultPlayPropsHash={},b.addEventListener=null,b.removeEventListener=null,b.removeAllEventListeners=null,b.dispatchEvent=null,b.hasEventListener=null,b._listeners=null,createjs.EventDispatcher.initialize(b),b.getPreloadHandlers=function(){return{callback:createjs.proxy(b.initLoad,b),types:["sound"],extensions:b.SUPPORTED_EXTENSIONS}},b._handleLoadComplete=function(a){var c=a.target.getItem().src;if(b.preloadHash[c])for(var d=0,e=b._preloadHash[c].length;d<e;d++){var f=b._preloadHash[c][d];if(b._preloadHash[c][d]=!0,b.hasEventListener("fileload"))(a=new createjs.Event("fileload")).src=f.src,a.id=f.id,a.data=f.data,a.sprite=f.sprite,b.dispatchEvent(a)}},b._handleLoadError=function(a){var c=a.target.getItem().src;if(b._preloadHash[c])for(var d=0,e=b._preloadHash[c].length;d<e;d++){var f=b._preloadHash[c][d];if(b._preloadHash[c][d]=!1,b.hasEventListener("fileerror"))(a=new createjs.Event("fileerror")).src=f.src,a.id=f.id,a.data=f.data,a.sprite=f.sprite,b.dispatchEvent(a)}},b._registerPlugin=function(a){return!!a.isSupported()&&(b.activePlugin=new a,!0)},b.registerPlugins=function(a){b._pluginsRegistered=!0;for(var c=0,d=a.length;c<d;c++)if(b._registerPlugin(a[c]))return!0;return!1},b.initializeDefaultPlugins=function(){return null!=b.activePlugin||!b._pluginsRegistered&&!!b.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin])},b.isReady=function(){return null!=b.activePlugin},b.getCapabilities=function(){return null==b.activePlugin?null:b.activePlugin._capabilities},b.getCapability=function(a){return null==b.activePlugin?null:b.activePlugin._capabilities[a]},b.initLoad=function(a){return b._registerSound(a)},b._registerSound=function(c){if(!b.initializeDefaultPlugins())return!1;var d;if(c.src instanceof Object?(d=b._parseSrc(c.src)).src=c.path+d.src:d=b._parsePath(c.src),null==d)return!1;c.src=d.src,c.type="sound";var e=c.data,f=null;if(null!=e&&(isNaN(e.channels)?isNaN(e)||(f=parseInt(e)):f=parseInt(e.channels),e.audioSprite))for(var g,h=e.audioSprite.length;h--;)g=e.audioSprite[h],b._idHash[g.id]={src:c.src,startTime:parseInt(g.startTime),duration:parseInt(g.duration)},g.defaultPlayProps&&(b._defaultPlayPropsHash[g.id]=createjs.PlayPropsConfig.create(g.defaultPlayProps));null!=c.id&&(b._idHash[c.id]={src:c.src});var i=b.activePlugin.register(c);return a.create(c.src,f),null!=e&&isNaN(e)?c.data.channels=f||a.maxPerChannel():c.data=f||a.maxPerChannel(),i.type&&(c.type=i.type),c.defaultPlayProps&&(b._defaultPlayPropsHash[c.src]=createjs.PlayPropsConfig.create(c.defaultPlayProps)),i},b.registerSound=function(a,c,d,e,f){var g={src:a,id:c,data:d,defaultPlayProps:f};a instanceof Object&&a.src&&(e=c,g=a),null==((g=createjs.LoadItem.create(g)).path=e)||g.src instanceof Object||(g.src=e+a);var h=b._registerSound(g);if(!h)return!1;if(b._preloadHash[g.src]||(b._preloadHash[g.src]=[]),b._preloadHash[g.src].push(g),1==b._preloadHash[g.src].length)h.on("complete",createjs.proxy(this._handleLoadComplete,this)),h.on("error",createjs.proxy(this._handleLoadError,this)),b.activePlugin.preload(h);else if(1==b._preloadHash[g.src][0])return!0;return g},b.registerSounds=function(a,b){var c=[];a.path&&(b?b+=a.path:b=a.path,a=a.manifest);for(var d=0,e=a.length;d<e;d++)c[d]=createjs.Sound.registerSound(a[d].src,a[d].id,a[d].data,b,a[d].defaultPlayProps);return c},b.removeSound=function(c,d){if(null==b.activePlugin)return!1;var e;if(c instanceof Object&&c.src&&(c=c.src),null==(e=c instanceof Object?b._parseSrc(c):(c=b._getSrcById(c).src,b._parsePath(c))))return!1;for(var f in c=e.src,null!=d&&(c=d+c),b._idHash)b._idHash[f].src==c&&delete b._idHash[f];return a.removeSrc(c),delete b._preloadHash[c],b.activePlugin.removeSound(c),!0},b.removeSounds=function(a,b){var c=[];a.path&&(b?b+=a.path:b=a.path,a=a.manifest);for(var d=0,e=a.length;d<e;d++)c[d]=createjs.Sound.removeSound(a[d].src,b);return c},b.removeAllSounds=function(){b._idHash={},b._preloadHash={},a.removeAll(),b.activePlugin&&b.activePlugin.removeAllSounds()},b.loadComplete=function(a){if(!b.isReady())return!1;var c=b._parsePath(a);return a=c?b._getSrcById(c.src).src:b._getSrcById(a).src,null!=b._preloadHash[a]&&1==b._preloadHash[a][0]},b._parsePath=function(a){"string"!=typeof a&&(a=a.toString());var c=a.match(b.FILE_PATTERN);if(null===c)return!1;var d="",e="",f="";if(0<=b.SUPPORTED_EXTENSIONS.indexOf(c[5]))d=c[4],f=e=c[5];else{if(!(0<=b.SUPPORTED_EXTENSIONS.indexOf(c[8])))return null;d=c[7],f=e=c[8]}for(var g=b.capabilities,h=0;!g[e];)if(e=b.alternateExtensions[h++],h>b.alternateExtensions.length)return null;return{name:d,src:a=a.replace("."+f,"."+e),extension:e}},b._parseSrc=function(a){var c={name:void 0,src:void 0,extension:void 0},d=b.capabilities;for(var e in a)if(a.hasOwnProperty(e)&&d[e]){c.src=a[e],c.extension=e;break}if(!c.src)return!1;var f=c.src.lastIndexOf("/");return c.name=-1!=f?c.src.slice(f+1):c.src,c},b.play=function(a,c,d,e,f,g,h,i,j){var k;k=c instanceof Object||c instanceof createjs.PlayPropsConfig?createjs.PlayPropsConfig.create(c):createjs.PlayPropsConfig.create({interrupt:c,delay:d,offset:e,loop:f,volume:g,pan:h,startTime:i,duration:j});var l=b.createInstance(a,k.startTime,k.duration);return b._playInstance(l,k)||l._playFailed(),l},b.createInstance=function(c,d,e){if(!b.initializeDefaultPlugins())return new createjs.DefaultSoundInstance(c,d,e);var f=b._defaultPlayPropsHash[c];c=b._getSrcById(c);var g=b._parsePath(c.src),h=null;return null!=g&&null!=g.src?(a.create(g.src),null==d&&(d=c.startTime),h=b.activePlugin.create(g.src,d,e||c.duration),(f=f||b._defaultPlayPropsHash[g.src])&&h.applyPlayProps(f)):h=new createjs.DefaultSoundInstance(c,d,e),h.uniqueId=b._lastID++,h},b.stop=function(){for(var a=this._instances,b=a.length;b--;)a[b].stop()},b.setVolume=function(a){if(null==Number(a))return!1;if(a=Math.max(0,Math.min(1,a)),b._masterVolume=a,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(a))for(var c=this._instances,d=0,e=c.length;d<e;d++)c[d].setMasterVolume(a)},b.getVolume=function(){return this._masterVolume},b.setMute=function(a){if(null==a)return!1;if(this._masterMute=a,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(a))for(var b=this._instances,c=0,d=b.length;c<d;c++)b[c].setMasterMute(a);return!0},b.getMute=function(){return this._masterMute},b.setDefaultPlayProps=function(a,c){a=b._getSrcById(a),b._defaultPlayPropsHash[b._parsePath(a.src).src]=createjs.PlayPropsConfig.create(c)},b.getDefaultPlayProps=function(a){return a=b._getSrcById(a),b._defaultPlayPropsHash[b._parsePath(a.src).src]},b.pause=function(){for(var a=this.instances,b=a.length;b--;)a[b].paused=!0},b.resume=function(){for(var a=this.instances,b=a.length;b--;)a[b].paused=!1},b._playInstance=function(a,c){var d=b._defaultPlayPropsHash[a.src]||{};if(null==c.interrupt&&(c.interrupt=d.interrupt||b.defaultInterruptBehavior),null==c.delay&&(c.delay=d.delay||0),null==c.offset&&(c.offset=a.getPosition()),null==c.loop&&(c.loop=a.loop),null==c.volume&&(c.volume=a.volume),null==c.pan&&(c.pan=a.pan),0==c.delay){if(!b._beginPlaying(a,c))return!1}else{var e=setTimeout(function(){b._beginPlaying(a,c)},c.delay);a.delayTimeoutId=e}return this._instances.push(a),!0},b._beginPlaying=function(b,c){if(!a.add(b,c.interrupt))return!1;if(b._beginPlaying(c))return!0;var d=createjs.indexOf(this._instances,b);return-1<d&&this._instances.splice(d,1),!1},b._getSrcById=function(a){return b._idHash[a]||{src:a}},b._playFinished=function(c){a.remove(c);var d=createjs.indexOf(this._instances,c);-1<d&&this._instances.splice(d,1);var e=b.activePlugin._soundInstances;e[c.src]&&-1<e[c.src].indexOf(c)&&e[c.src].splice(e[c.src].indexOf(c),1)},createjs.Sound=Sound,a.channels={},a.create=function(b,c){return null==a.get(b)&&(a.channels[b]=new a(b,c),!0)},a.removeSrc=function(b){var c=a.get(b);return null!=c&&(c._removeAll(),delete a.channels[b],!0)},a.removeAll=function(){for(var b in a.channels)a.channels[b]._removeAll();a.channels={}},a.add=function(b,c){var d=a.get(b.src);return null!=d&&d._add(b,c)},a.remove=function(b){var c=a.get(b.src);return null!=c&&(c._remove(b),!0)},a.maxPerChannel=function(){return c.maxDefault},a.get=function(b){return a.channels[b]};var c=a.prototype;c.constructor=a,c.src=null,c.max=null,c.maxDefault=100,c.length=0,c.init=function(a,b){this.src=a,this.max=b||this.maxDefault,-1==this.max&&(this.max=this.maxDefault),this._instances=[]},c._get=function(a){return this._instances[a]},c._add=function(a,b){return!!this._getSlot(b,a)&&(this._instances.push(a),this.length++,!0)},c._remove=function(a){var c=b.activePlugin._soundInstances;c[a.src]&&-1<c[a.src].indexOf(a)&&c[a.src].splice(c[a.src].indexOf(a),1);var d=createjs.indexOf(this._instances,a);return-1!=d&&(this._instances.splice(d,1),this.length--,!0)},c._removeAll=function(){for(var a=this.length-1;0<=a;a--)this._instances[a].stop()},c._getSlot=function(a,b){var c,d;if(a!=Sound.INTERRUPT_NONE&&null==(d=this._get(0)))return!0;for(var e=0,f=this.max;e<f;e++){if(null==(c=this._get(e)))return!0;if(c.playState==Sound.PLAY_FINISHED||c.playState==Sound.PLAY_INTERRUPTED||c.playState==Sound.PLAY_FAILED){d=c;break}a!=Sound.INTERRUPT_NONE&&(a==Sound.INTERRUPT_EARLY&&c.getPosition()<d.getPosition()||a==Sound.INTERRUPT_LATE&&c.getPosition()>d.getPosition())&&(d=c)}return null!=d&&(d._interrupt(),this._remove(d),!0)},c.toString=function(){return"[Sound SoundChannel]"}}(),this.createjs=this.createjs||{},function(){"use strict";function AbstractSoundInstance(a,b,c,d){this.EventDispatcher_constructor(),this.src=a,this.uniqueId=-1,this.playState=null,this.delayTimeoutId=null,this._volume=1,Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),this._pan=0,Object.defineProperty(this,"pan",{get:this.getPan,set:this.setPan}),this._startTime=Math.max(0,b||0),Object.defineProperty(this,"startTime",{get:this.getStartTime,set:this.setStartTime}),this._duration=Math.max(0,c||0),Object.defineProperty(this,"duration",{get:this.getDuration,set:this.setDuration}),this._playbackResource=null,Object.defineProperty(this,"playbackResource",{get:this.getPlaybackResource,set:this.setPlaybackResource}),!1!==d&&!0!==d&&this.setPlaybackResource(d),this._position=0,Object.defineProperty(this,"position",{get:this.getPosition,set:this.setPosition}),this._loop=0,Object.defineProperty(this,"loop",{get:this.getLoop,set:this.setLoop}),this._muted=!1,Object.defineProperty(this,"muted",{get:this.getMuted,set:this.setMuted}),this._paused=!1,Object.defineProperty(this,"paused",{get:this.getPaused,set:this.setPaused})}var a=createjs.extend(AbstractSoundInstance,createjs.EventDispatcher);a.play=function(a,b,c,d,e,f){var g;return g=a instanceof Object||a instanceof createjs.PlayPropsConfig?createjs.PlayPropsConfig.create(a):createjs.PlayPropsConfig.create({interrupt:a,delay:b,offset:c,loop:d,volume:e,pan:f}),this.playState==createjs.Sound.PLAY_SUCCEEDED?(this.applyPlayProps(g),void(this._paused&&this.setPaused(!1))):(this._cleanUp(),createjs.Sound._playInstance(this,g),this)},a.stop=function(){return this._position=0,this._paused=!1,this._handleStop(),this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this},a.destroy=function(){this._cleanUp(),this.src=null,this.playbackResource=null,this.removeAllEventListeners()},a.applyPlayProps=function(a){return null!=a.offset&&this.setPosition(a.offset),null!=a.loop&&this.setLoop(a.loop),null!=a.volume&&this.setVolume(a.volume),null!=a.pan&&this.setPan(a.pan),null!=a.startTime&&(this.setStartTime(a.startTime),this.setDuration(a.duration)),this},a.toString=function(){return"[AbstractSoundInstance]"},a.getPaused=function(){return this._paused},a.setPaused=function(a){if(!(!0!==a&&!1!==a||this._paused==a||1==a&&this.playState!=createjs.Sound.PLAY_SUCCEEDED))return(this._paused=a)?this._pause():this._resume(),clearTimeout(this.delayTimeoutId),this},a.setVolume=function(a){return a==this._volume||(this._volume=Math.max(0,Math.min(1,a)),this._muted||this._updateVolume()),this},a.getVolume=function(){return this._volume},a.setMuted=function(a){if(!0===a||!1===a)return this._muted=a,this._updateVolume(),this},a.getMuted=function(){return this._muted},a.setPan=function(a){return a==this._pan||(this._pan=Math.max(-1,Math.min(1,a)),this._updatePan()),this},a.getPan=function(){return this._pan},a.getPosition=function(){return this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED||(this._position=this._calculateCurrentPosition()),this._position},a.setPosition=function(a){return this._position=Math.max(0,a),this.playState==createjs.Sound.PLAY_SUCCEEDED&&this._updatePosition(),this},a.getStartTime=function(){return this._startTime},a.setStartTime=function(a){return a==this._startTime||(this._startTime=Math.max(0,a||0),this._updateStartTime()),this},a.getDuration=function(){return this._duration},a.setDuration=function(a){return a==this._duration||(this._duration=Math.max(0,a||0),this._updateDuration()),this},a.setPlaybackResource=function(a){return this._playbackResource=a,0==this._duration&&this._setDurationFromSource(),this},a.getPlaybackResource=function(){return this._playbackResource},a.getLoop=function(){return this._loop},a.setLoop=function(a){null!=this._playbackResource&&(0!=this._loop&&0==a?this._removeLooping(a):0==this._loop&&0!=a&&this._addLooping(a)),this._loop=a},a._sendEvent=function(a){var b=new createjs.Event(a);this.dispatchEvent(b)},a._cleanUp=function(){clearTimeout(this.delayTimeoutId),this._handleCleanUp(),this._paused=!1,createjs.Sound._playFinished(this)},a._interrupt=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_INTERRUPTED,this._sendEvent("interrupted")},a._beginPlaying=function(a){return this.setPosition(a.offset),this.setLoop(a.loop),this.setVolume(a.volume),this.setPan(a.pan),null!=a.startTime&&(this.setStartTime(a.startTime),this.setDuration(a.duration)),null!=this._playbackResource&&this._position<this._duration?(this._paused=!1,this._handleSoundReady(),this.playState=createjs.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0):(this._playFailed(),!1)},a._playFailed=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_FAILED,this._sendEvent("failed")},a._handleSoundComplete=function(a){if((this._position=0)!=this._loop)return this._loop--,this._handleLoop(),void this._sendEvent("loop");this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this._sendEvent("complete")},a._handleSoundReady=function(){},a._updateVolume=function(){},a._updatePan=function(){},a._updateStartTime=function(){},a._updateDuration=function(){},a._setDurationFromSource=function(){},a._calculateCurrentPosition=function(){},a._updatePosition=function(){},a._removeLooping=function(a){},a._addLooping=function(a){},a._pause=function(){},a._resume=function(){},a._handleStop=function(){},a._handleCleanUp=function(){},a._handleLoop=function(){},createjs.AbstractSoundInstance=createjs.promote(AbstractSoundInstance,"EventDispatcher"),createjs.DefaultSoundInstance=createjs.AbstractSoundInstance}(),this.createjs=this.createjs||{},function(){"use strict";function AbstractPlugin(){this._capabilities=null,this._loaders={},this._audioSources={},this._soundInstances={},this._volume=1,this._loaderClass,this._soundInstanceClass,this._volume=1}var a=AbstractPlugin.prototype;AbstractPlugin._capabilities=null,AbstractPlugin.isSupported=function(){return!0},a.register=function(a){var b=this._loaders[a.src];return b&&!b.canceled?this._loaders[a.src]:(this._audioSources[a.src]=!0,this._soundInstances[a.src]=[],(b=new this._loaderClass(a)).on("complete",this._handlePreloadComplete,this),this._loaders[a.src]=b)},a.preload=function(a){a.on("error",this._handlePreloadError,this),a.load()},a.isPreloadStarted=function(a){return null!=this._audioSources[a]},a.isPreloadComplete=function(a){return!(null==this._audioSources[a]||1==this._audioSources[a])},a.removeSound=function(a){if(this._soundInstances[a]){for(var b=this._soundInstances[a].length;b--;)this._soundInstances[a][b].destroy();delete this._soundInstances[a],delete this._audioSources[a],this._loaders[a]&&this._loaders[a].destroy(),delete this._loaders[a]}},a.removeAllSounds=function(){for(var a in this._audioSources)this.removeSound(a)},a.create=function(a,b,c){this.isPreloadStarted(a)||this.preload(this.register(a));var d=new this._soundInstanceClass(a,b,c,this._audioSources[a]);return this._soundInstances[a].push(d),d},a.setVolume=function(a){return this._volume=a,this._updateVolume(),!0},a.getVolume=function(){return this._volume},a.setMute=function(a){return this._updateVolume(),!0},a.toString=function(){return"[AbstractPlugin]"},a._handlePreloadComplete=function(a){var b=a.target.getItem().src;this._audioSources[b]=a.result;for(var c=0,d=this._soundInstances[b].length;c<d;c++)this._soundInstances[b][c].setPlaybackResource(this._audioSources[b])},a._handlePreloadError=function(a){},a._updateVolume=function(){},createjs.AbstractPlugin=AbstractPlugin}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.AbstractLoader_constructor(a,!0,createjs.AbstractLoader.SOUND)}var b=createjs.extend(a,createjs.AbstractLoader);a.context=null,b.toString=function(){return"[WebAudioLoader]"},b._createRequest=function(){this._request=new createjs.XHRRequest(this._item,!1),this._request.setResponseType("arraybuffer")},b._sendComplete=function(b){a.context.decodeAudioData(this._rawResult,createjs.proxy(this._handleAudioDecoded,this),createjs.proxy(this._sendError,this))},b._handleAudioDecoded=function(a){this._result=a,this.AbstractLoader__sendComplete()},createjs.WebAudioLoader=createjs.promote(a,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function WebAudioSoundInstance(a,c,d,e){this.AbstractSoundInstance_constructor(a,c,d,e),this.gainNode=b.context.createGain(),this.panNode=b.context.createPanner(),this.panNode.panningModel=b._panningModel,this.panNode.connect(this.gainNode),this._updatePan(),this.sourceNode=null,this._soundCompleteTimeout=null,this._sourceNodeNext=null,this._playbackStartTime=0,this._endedHandler=createjs.proxy(this._handleSoundComplete,this)}var a=createjs.extend(WebAudioSoundInstance,createjs.AbstractSoundInstance),b=WebAudioSoundInstance;b.context=null,b._scratchBuffer=null,b.destinationNode=null,b._panningModel="equalpower",a.destroy=function(){this.AbstractSoundInstance_destroy(),this.panNode.disconnect(0),this.panNode=null,this.gainNode.disconnect(0),this.gainNode=null},a.toString=function(){return"[WebAudioSoundInstance]"},a._updatePan=function(){this.panNode.setPosition(this._pan,0,-.5)},a._removeLooping=function(a){this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)},a._addLooping=function(a){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},a._setDurationFromSource=function(){this._duration=1e3*this.playbackResource.duration},a._handleCleanUp=function(){this.sourceNode&&this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout),this._playbackStartTime=0},a._cleanUpAudioNode=function(a){if(a){a.stop(0),a.disconnect(0);try{a.buffer=b._scratchBuffer}catch(a){}a=null}return a},a._handleSoundReady=function(a){this.gainNode.connect(b.destinationNode);var c=.001*this._duration,d=.001*this._position;c<d&&(d=c),this.sourceNode=this._createAndPlayAudioNode(b.context.currentTime-c,d),this._playbackStartTime=this.sourceNode.startTime-d,this._soundCompleteTimeout=setTimeout(this._endedHandler,1e3*(c-d)),0!=this._loop&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},a._createAndPlayAudioNode=function(a,c){var d=b.context.createBufferSource();d.buffer=this.playbackResource,d.connect(this.panNode);var e=.001*this._duration;return e<c&&(c=e-.001),d.startTime=a+e,d.start(d.startTime,c+.001*this._startTime,e-c),d},a._pause=function(){this._position=1e3*(b.context.currentTime-this._playbackStartTime),this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout)},a._resume=function(){this._handleSoundReady()},a._updateVolume=function(){var a=this._muted?0:this._volume;a!=this.gainNode.gain.value&&(this.gainNode.gain.value=a)},a._calculateCurrentPosition=function(){return 1e3*(b.context.currentTime-this._playbackStartTime)},a._updatePosition=function(){this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),clearTimeout(this._soundCompleteTimeout),this._paused||this._handleSoundReady()},a._handleLoop=function(){this._cleanUpAudioNode(this.sourceNode),this.sourceNode=this._sourceNodeNext,this._playbackStartTime=this.sourceNode.startTime,this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0),this._soundCompleteTimeout=setTimeout(this._endedHandler,this._duration)},a._updateDuration=function(){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._pause(),this._resume())},createjs.WebAudioSoundInstance=createjs.promote(WebAudioSoundInstance,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){"use strict";function WebAudioPlugin(){this.AbstractPlugin_constructor(),this._panningModel=b._panningModel,this.context=b.context,this.dynamicsCompressorNode=this.context.createDynamicsCompressor(),this.dynamicsCompressorNode.connect(this.context.destination),this.gainNode=this.context.createGain(),this.gainNode.connect(this.dynamicsCompressorNode),createjs.WebAudioSoundInstance.destinationNode=this.gainNode,this._capabilities=b._capabilities,this._loaderClass=createjs.WebAudioLoader,this._soundInstanceClass=createjs.WebAudioSoundInstance,this._addPropsToClasses()}var a=createjs.extend(WebAudioPlugin,createjs.AbstractPlugin),b=WebAudioPlugin;b._capabilities=null,b._panningModel="equalpower",b.context=null,b._scratchBuffer=null,b._unlocked=!1,b.isSupported=function(){var a=createjs.BrowserDetect.isIOS||createjs.BrowserDetect.isAndroid||createjs.BrowserDetect.isBlackberry;return!("file:"==location.protocol&&!a&&!this._isFileXHRSupported())&&(b._generateCapabilities(),null!=b.context)},b.playEmptySound=function(){if(null!=b.context){var a=b.context.createBufferSource();a.buffer=b._scratchBuffer,a.connect(b.context.destination),a.start(0,0,0),"suspended"===a.context.state&&a.context.resume()}},b._isFileXHRSupported=function(){var a=!0,b=new XMLHttpRequest;try{b.open("GET","WebAudioPluginTest.fail",!1)}catch(b){return a=!1}b.onerror=function(){a=!1},b.onload=function(){a=404==this.status||200==this.status||0==this.status&&""!=this.response};try{b.send()}catch(b){a=!1}return a},b._generateCapabilities=function(){if(null==b._capabilities){var a=document.createElement("audio");if(null==a.canPlayType)return null;if(null==b.context){if(window.AudioContext)b.context=new AudioContext;else{if(!window.webkitAudioContext)return null;b.context=new webkitAudioContext}document.addEventListener("click",function(){"suspended"===b.context.state&&b.context.resume()})}null==b._scratchBuffer&&(b._scratchBuffer=b.context.createBuffer(1,1,22050)),b._compatibilitySetUp(),"ontouchstart"in window&&"running"!=b.context.state&&(b._unlock(),document.addEventListener("mousedown",b._unlock,!0),document.addEventListener("touchstart",b._unlock,!0),document.addEventListener("touchend",b._unlock,!0)),b._capabilities={panning:!0,volume:!0,tracks:-1};for(var c=createjs.Sound.SUPPORTED_EXTENSIONS,d=createjs.Sound.EXTENSION_MAP,e=0,f=c.length;e<f;e++){var g=c[e],h=d[g]||g;b._capabilities[g]="no"!=a.canPlayType("audio/"+g)&&""!=a.canPlayType("audio/"+g)||"no"!=a.canPlayType("audio/"+h)&&""!=a.canPlayType("audio/"+h)}b.context.destination.numberOfChannels<2&&(b._capabilities.panning=!1)}},b._compatibilitySetUp=function(){if(b._panningModel="equalpower",!b.context.createGain){b.context.createGain=b.context.createGainNode;var a=b.context.createBufferSource();a.__proto__.start=a.__proto__.noteGrainOn,a.__proto__.stop=a.__proto__.noteOff,b._panningModel=0}},b._unlock=function(){"suspended"===b.context.state&&b.context.resume(),b._unlocked||(b.playEmptySound(),"running"==b.context.state&&(document.removeEventListener("mousedown",b._unlock,!0),document.removeEventListener("touchend",b._unlock,!0),document.removeEventListener("touchstart",b._unlock,!0),b._unlocked=!0))},a.toString=function(){return"[WebAudioPlugin]"},a._addPropsToClasses=function(){var a=this._soundInstanceClass;a.context=this.context,a._scratchBuffer=b._scratchBuffer,a.destinationNode=this.gainNode,a._panningModel=this._panningModel,this._loaderClass.context=this.context},a._updateVolume=function(){var a=createjs.Sound._masterMute?0:this._volume;a!=this.gainNode.gain.value&&(this.gainNode.gain.value=a)},createjs.WebAudioPlugin=createjs.promote(WebAudioPlugin,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){"use strict";function HTMLAudioTagPool(){throw"HTMLAudioTagPool cannot be instantiated"}function a(a){this._tags=[]}var b=HTMLAudioTagPool;b._tags={},b._tagPool=new a,b._tagUsed={},b.get=function(a){var c=b._tags[a];return null==c?(c=b._tags[a]=b._tagPool.get()).src=a:b._tagUsed[a]?(c=b._tagPool.get()).src=a:b._tagUsed[a]=!0,c},b.set=function(a,c){c==b._tags[a]?b._tagUsed[a]=!1:b._tagPool.set(c)},b.remove=function(a){var c=b._tags[a];return null!=c&&(b._tagPool.set(c),delete b._tags[a],delete b._tagUsed[a],!0)},b.getDuration=function(a){var c=b._tags[a];return null!=c&&c.duration?1e3*c.duration:0},createjs.HTMLAudioTagPool=HTMLAudioTagPool;var c=a.prototype;c.constructor=a,c.get=function(){var a;return null==(a=0==this._tags.length?this._createTag():this._tags.pop()).parentNode&&document.body.appendChild(a),a},c.set=function(a){-1==createjs.indexOf(this._tags,a)&&(this._tags.src=null,this._tags.push(a))},c.toString=function(){return"[TagPool]"},c._createTag=function(){var a=document.createElement("audio");return a.autoplay=!1,a.preload="none",a}}(),this.createjs=this.createjs||{},function(){"use strict";function HTMLAudioSoundInstance(a,b,c,d){this.AbstractSoundInstance_constructor(a,b,c,d),this._audioSpriteStopTime=null,this._delayTimeoutId=null,this._endedHandler=createjs.proxy(this._handleSoundComplete,this),this._readyHandler=createjs.proxy(this._handleTagReady,this),this._stalledHandler=createjs.proxy(this._playFailed,this),this._audioSpriteEndHandler=createjs.proxy(this._handleAudioSpriteLoop,this),this._loopHandler=createjs.proxy(this._handleSoundComplete,this),c?this._audioSpriteStopTime=.001*(b+c):this._duration=createjs.HTMLAudioTagPool.getDuration(this.src)}var a=createjs.extend(HTMLAudioSoundInstance,createjs.AbstractSoundInstance);a.setMasterVolume=function(a){this._updateVolume()},a.setMasterMute=function(a){this._updateVolume()},a.toString=function(){return"[HTMLAudioSoundInstance]"},a._removeLooping=function(){null!=this._playbackResource&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},a._addLooping=function(){null==this._playbackResource||this._audioSpriteStopTime||(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)},a._handleCleanUp=function(){var a=this._playbackResource;if(null!=a){a.pause(),a.loop=!1,a.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),a.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),a.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),a.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),a.removeEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1);try{a.currentTime=this._startTime}catch(a){}createjs.HTMLAudioTagPool.set(this.src,a),this._playbackResource=null}},a._beginPlaying=function(a){return this._playbackResource=createjs.HTMLAudioTagPool.get(this.src),this.AbstractSoundInstance__beginPlaying(a)},a._handleSoundReady=function(a){if(4!==this._playbackResource.readyState){var b=this._playbackResource;return b.addEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),b.addEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),b.preload="auto",void b.load()}this._updateVolume(),this._playbackResource.currentTime=.001*(this._startTime+this._position),this._audioSpriteStopTime?this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1):(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),0!=this._loop&&(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)),this._playbackResource.play()},a._handleTagReady=function(a){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),this._handleSoundReady()},a._pause=function(){this._playbackResource.pause()},a._resume=function(){this._playbackResource.play()},a._updateVolume=function(){if(null!=this._playbackResource){var a=this._muted||createjs.Sound._masterMute?0:this._volume*createjs.Sound._masterVolume;a!=this._playbackResource.volume&&(this._playbackResource.volume=a)}},a._calculateCurrentPosition=function(){return 1e3*this._playbackResource.currentTime-this._startTime},a._updatePosition=function(){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1);try{this._playbackResource.currentTime=.001*(this._position+this._startTime)}catch(a){this._handleSetPositionSeek(null)}},a._handleSetPositionSeek=function(a){null!=this._playbackResource&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},a._handleAudioSpriteLoop=function(a){this._playbackResource.currentTime<=this._audioSpriteStopTime||(this._playbackResource.pause(),0==this._loop?this._handleSoundComplete(null):(this._position=0,this._loop--,this._playbackResource.currentTime=.001*this._startTime,this._paused||this._playbackResource.play(),this._sendEvent("loop")))},a._handleLoop=function(a){0==this._loop&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},a._updateStartTime=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},a._updateDuration=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},a._setDurationFromSource=function(){this._duration=createjs.HTMLAudioTagPool.getDuration(this.src),this._playbackResource=null},createjs.HTMLAudioSoundInstance=createjs.promote(HTMLAudioSoundInstance,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){"use strict";function HTMLAudioPlugin(){this.AbstractPlugin_constructor(),this.defaultNumChannels=2,this._capabilities=b._capabilities,this._loaderClass=createjs.SoundLoader,this._soundInstanceClass=createjs.HTMLAudioSoundInstance}var a=createjs.extend(HTMLAudioPlugin,createjs.AbstractPlugin),b=HTMLAudioPlugin;b.MAX_INSTANCES=30,b._AUDIO_READY="canplaythrough",b._AUDIO_ENDED="ended",b._AUDIO_SEEKED="seeked",b._AUDIO_STALLED="stalled",b._TIME_UPDATE="timeupdate",b._capabilities=null,b.isSupported=function(){return b._generateCapabilities(),null!=b._capabilities},b._generateCapabilities=function(){if(null==b._capabilities){var a=document.createElement("audio");if(null==a.canPlayType)return null;b._capabilities={panning:!1,volume:!0,tracks:-1};for(var c=createjs.Sound.SUPPORTED_EXTENSIONS,d=createjs.Sound.EXTENSION_MAP,e=0,f=c.length;e<f;e++){var g=c[e],h=d[g]||g;b._capabilities[g]="no"!=a.canPlayType("audio/"+g)&&""!=a.canPlayType("audio/"+g)||"no"!=a.canPlayType("audio/"+h)&&""!=a.canPlayType("audio/"+h)}}},a.register=function(a){var b=createjs.HTMLAudioTagPool.get(a.src),c=this.AbstractPlugin_register(a);return c.setTag(b),c},a.removeSound=function(a){this.AbstractPlugin_removeSound(a),createjs.HTMLAudioTagPool.remove(a)},a.create=function(a,b,c){var d=this.AbstractPlugin_create(a,b,c);return d.setPlaybackResource(null),d},a.toString=function(){return"[HTMLAudioPlugin]"},a.setVolume=a.getVolume=a.setMute=null,createjs.HTMLAudioPlugin=createjs.promote(HTMLAudioPlugin,"AbstractPlugin")}();var swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(a){return}R=!0;for(var b=N.length,c=0;c<b;c++)N[c]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)!function(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function f(){var a=O.length;if(0<a)for(var b=0;b<a;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(0<U.pv[0]){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;o<n;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){y=d||null,z={success:!(S=!0),id:c};var e=p(c);if(e){x="OBJECT"==e.nodeName?(w=k(e),null):(w=e,c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?"ActiveX":"PlugIn",g="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;f<e;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);for(var k in j.setAttribute("type",G),a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?function(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function p(a){var b=null;try{b=K.getElementById(a)}catch(a){}return b}function q(a){return K.createElement(a)}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(B=A=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&0<K.styleSheets.length&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){return null!=/[\\\"<>\.;]/.exec(a)&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[function(){M?function(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(d<10)return d++,setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}():f()}],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=/win/.test(c||b),e=/mac/.test(c||b),f=!!/webkit/.test(b)&&parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)!(i=L.plugins[E].description)||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(g=!(M=!0),i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J.ActiveXObject!=C)try{var j=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");j&&((i=j.GetVariable("$version"))&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(a){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();return U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&function(){if(!R){try{K.documentElement.doScroll("left")}catch(a){return setTimeout(arguments.callee,0)}a()}}()),U.wk&&function(){R||(/loaded|complete/.test(K.readyState)?a():setTimeout(arguments.callee,0))}(),c(a))),U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;b<a;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;d<c;d++)n(P[d]);for(var e in U)U[e]=null;for(var f in U=null,swfobject)swfobject[f]=null;swfobject=null}),{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(U.w3)return g(a)},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}();this.createjs=this.createjs||{},function(){"use strict";function a(a){this.AbstractLoader_constructor(a,!1,createjs.AbstractLoader.SOUND),this.flashId=null}var b=createjs.extend(a,createjs.AbstractLoader),c=a;c._flash=null,c._preloadInstances=[],c.setFlash=function(a){c._flash=a;for(var b=c._preloadInstances.length;b--;){c._preloadInstances.pop().load()}},b.load=function(){if(null!=c._flash){this.flashId=c._flash.preload(this._item.src);var a=new createjs.Event(createjs.FlashAudioPlugin._REG_FLASHID);this.dispatchEvent(a)}else c._preloadInstances.push(this)},b.handleProgress=function(a,b){this._sendProgress(a/b)},b.handleComplete=function(){this._result=this._item.src,this._sendComplete()},b.handleError=function(a){this._handleError(a)},b.destroy=function(){var a=new createjs.Event(createjs.FlashAudioPlugin._UNREG_FLASHID);this.dispatchEvent(a),this.AbstractLoader_destroy()},b.toString=function(){return"[FlashAudioLoader]"},createjs.FlashAudioLoader=createjs.promote(a,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function FlashAudioSoundInstance(a,c,d,e){this.AbstractSoundInstance_constructor(a,c,d,e),(this.flashId=null)==b._flash&&b._instances.push(this)}var a=createjs.extend(FlashAudioSoundInstance,createjs.AbstractSoundInstance),b=FlashAudioSoundInstance;b._flash=null,b._instances=[],b.setFlash=function(a){b._flash=a;for(var c=b._instances.length;c--;){b._instances.pop()._setDurationFromSource()}},a.setLoop=function(a){null!=this.flashId&&b._flash.setLoop(this.flashId,a),this._loop=a},a.toString=function(){return"[FlashAudioSoundInstance]"},a._updateVolume=function(){null!=this.flashId&&b._flash.setVolume(this.flashId,this._volume)},a._updatePan=function(){null!=this.flashId&&b._flash.setPan(this.flashId,this._pan)},a._setDurationFromSource=function(){this._duration=b._flash.getDurationBySrc(this.src)},a._interrupt=function(){null!=this.flashId&&(b._flash.interrupt(this.flashId),this.AbstractSoundInstance__interrupt())},a._handleCleanUp=function(){b._flash.stopSound(this.flashId),this._sendEvent(createjs.FlashAudioPlugin._UNREG_FLASHID),this.flashId=null},a._beginPlaying=function(a){return null!=b._flash&&(this.setPosition(a.offset),this.setLoop(a.loop),this.setVolume(a.volume),this.setPan(a.pan),null!=a.startTime&&(this.setStartTime(a.startTime),this.setDuration(a.duration)),this._paused=!1,this.flashId=b._flash.playSound(this.src,this._position,this._loop,this._volume,this._pan,this._startTime,this._duration),null==this.flashId?(this._playFailed(),!1):(this._muted&&this.setMute(!0),this._sendEvent(createjs.FlashAudioPlugin._REG_FLASHID),this.playState=createjs.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0))},a._pause=function(){null!=this.flashId&&(this._position=this._calculateCurrentPosition(),b._flash.pauseSound(this.flashId))},a._resume=function(){null!=this.flashId&&b._flash.resumeSound(this.flashId)},a._handleStop=function(){null!=this.flashId&&b._flash.stopSound(this.flashId)},a._updateVolume=function(){var a=this._muted?0:this._volume;b._flash.setVolume(this.flashId,a)},a._calculateCurrentPosition=function(){return b._flash.getPosition(this.flashId)},a._updatePosition=function(){null!=this.flashId&&b._flash.setPosition(this.flashId,this._position)},a.handleSoundFinished=function(){this._loop=0,this._handleSoundComplete()},a.handleSoundLoop=function(){this._loop--,this._sendEvent("loop")},createjs.FlashAudioSoundInstance=createjs.promote(FlashAudioSoundInstance,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){"use strict";function FlashAudioPlugin(){this.AbstractPlugin_constructor(),this.showOutput=!1,this._CONTAINER_ID="flashAudioContainer",this._WRAPPER_ID="SoundJSFlashContainer",this._container=null,this._flash=null,this.flashReady=!1,this._flashInstances={},this._flashPreloadInstances={},this._capabilities=b._capabilities,this._loaderClass=createjs.FlashAudioLoader,this._soundInstanceClass=createjs.FlashAudioSoundInstance;var a=this.wrapper=document.createElement("div");a.id=this._WRAPPER_ID,a.style.position="absolute",a.style.marginLeft="-1px",a.className=this._WRAPPER_ID,document.body.appendChild(a);var c=this._container=document.createElement("div");c.id=this._CONTAINER_ID,c.appendChild(document.createTextNode("SoundJS Flash Container")),a.appendChild(c);var d=b.swfPath;swfobject.embedSWF(d+"FlashAudioPlugin.swf",this._CONTAINER_ID,"1","1","9.0.0",null,null,{AllowScriptAccess:"always"},null,createjs.proxy(this._handleSWFReady,this))}var a=createjs.extend(FlashAudioPlugin,createjs.AbstractPlugin),b=FlashAudioPlugin;b._REG_FLASHID="registerflashid",b._UNREG_FLASHID="unregisterflashid",b._capabilities=null,b.swfPath="src/soundjs/flashaudio/",b.isSupported=function(){return!(createjs.BrowserDetect.isIOS||createjs.BrowserDetect.isAndroid||createjs.BrowserDetect.isBlackberry||createjs.BrowserDetect.isWindowsPhone)&&(b._generateCapabilities(),null!=swfobject&&swfobject.hasFlashPlayerVersion("9.0.0"))},b._generateCapabilities=function(){null==b._capabilities&&(b._capabilities={panning:!0,volume:!0,tracks:-1,mp3:!0,ogg:!1,mpeg:!0,wav:!0,m4a:!1,mp4:!1,aiff:!1,wma:!1,mid:!1})},a.register=function(a,c){var d=this.AbstractPlugin_register(a,c);return d.addEventListener(b._REG_FLASHID,createjs.proxy(this.registerPreloadInstance,this)),d.addEventListener(b._UNREG_FLASHID,createjs.proxy(this.unregisterPreloadInstance,this)),d},a.removeAllSounds=function(){this._flashInstances={},this._flashPreloadInstances={},this.AbstractPlugin_removeAllSounds()},a.create=function(a,c,d){var e=this.AbstractPlugin_create(a,c,d);return e.on(b._REG_FLASHID,this.registerSoundInstance,this),e.on(b._UNREG_FLASHID,this.unregisterSoundInstance,this),e},a.toString=function(){return"[FlashAudioPlugin]"},a._handleSWFReady=function(a){this._flash=a.ref},a._handleFlashReady=function(){this.flashReady=!0,this._loaderClass.setFlash(this._flash),this._soundInstanceClass.setFlash(this._flash),this._updateVolume()},a._updateVolume=function(){if(!this.flashReady)return!0;var a=createjs.Sound._masterMute?0:this._volume;return this._flash.setMasterVolume(a)},a.registerPreloadInstance=function(a){this._flashPreloadInstances[a.target.flashId]=a.target},a.unregisterPreloadInstance=function(a){delete this._flashPreloadInstances[a.target.flashId]},a.registerSoundInstance=function(a){this._flashInstances[a.target.flashId]=a.target},a.unregisterSoundInstance=function(a){delete this._flashInstances[a.target.flashId]},a.flashLog=function(a){try{this.showOutput&&console.log(a)}catch(a){}},a.handleSoundEvent=function(a,b){var c=this._flashInstances[a];if(null!=c){for(var d=[],e=2,f=arguments.length;e<f;e++)d.push(arguments[e]);try{0==d.length?c[b]():c[b].apply(c,d)}catch(a){}}},a.handlePreloadEvent=function(a,b){var c=this._flashPreloadInstances[a];if(null!=c){for(var d=[],e=2,f=arguments.length;e<f;e++)d.push(arguments[e]);try{0==d.length?c[b]():c[b].apply(c,d)}catch(a){}}},a.handleEvent=function(a){switch(a){case"ready":this._handleFlashReady()}},a.handleErrorEvent=function(a){},createjs.FlashAudioPlugin=createjs.promote(FlashAudioPlugin,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){var a=createjs.FlashAudioPlugin=createjs.FlashAudioPlugin||{};a.version="0.6.5",a.buildDate="Fri, 07 Apr 2017 15:14:47 GMT"}(),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PIXI=t()}}(function(){return function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=r[s]={exports:{}};e[s][0].call(l.exports,function(t){return i(e[s][1][t]||t)},l,l.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){"use strict";function n(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}r.INT_BITS=32,r.INT_MAX=2147483647,r.INT_MIN=-1<<31,r.sign=function(t){return(0<t)-(t<0)},r.abs=function(t){var e=t>>31;return(t^e)-e},r.min=function(t,e){return e^(t^e)&-(t<e)},r.max=function(t,e){return t^(t^e)&-(t<e)},r.isPow2=function(t){return!(t&t-1||!t)},r.log2=function(t){var e,r;return e=(65535<t)<<4,e|=r=(255<(t>>>=e))<<3,e|=r=(15<(t>>>=r))<<2,(e|=r=(3<(t>>>=r))<<1)|(t>>>=r)>>1},r.log10=function(t){return 1e9<=t?9:1e8<=t?8:1e7<=t?7:1e6<=t?6:1e5<=t?5:1e4<=t?4:1e3<=t?3:100<=t?2:10<=t?1:0},r.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},r.countTrailingZeros=n,r.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)},r.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},r.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var i=new Array(256);!function(t){for(var e=0;e<256;++e){var r=e,n=e,i=7;for(r>>>=1;r;r>>>=1)n<<=1,n|=1&r,--i;t[e]=n<<i&255}}(i),r.reverse=function(t){return i[255&t]<<24|i[t>>>8&255]<<16|i[t>>>16&255]<<8|i[t>>>24&255]},r.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},r.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},r.interleave3=function(t,e,r){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2))<<2},r.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},r.nextCombination=function(t){var e=t|t-1;return 1+e|(~e&-~e)-1>>>n(t)+1}},{}],2:[function(t,e,r){"use strict";function n(t,e,r){r=r||2;var h,l,d,f,p,v,g,n=e&&e.length,o=n?e[0]*r:t.length,a=i(t,0,o,r,!0),u=[];if(!a||a.next===a.prev)return u;if(n&&(a=c(t,e,a,r)),t.length>80*r){h=d=t[0],l=f=t[1];for(var y=r;y<o;y+=r)(p=t[y])<h&&(h=p),(v=t[y+1])<l&&(l=v),d<p&&(d=p),f<v&&(f=v);g=0!==(g=Math.max(d-h,f-l))?1/g:0}return s(a,u,r,h,l,g),u}function i(t,e,r,n,i){var o,s;if(i===0<A(t,e,r,n))for(o=e;o<r;o+=n)s=P(o,t[o],t[o+1],s);else for(o=r-n;e<=o;o-=n)s=P(o,t[o],t[o+1],s);return s&&T(s,s.next)&&(C(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!T(n,n.next)&&0!==x(n.prev,n,n.next))n=n.next;else{if(C(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function s(t,e,r,n,i,c,d){if(t){!d&&c&&v(t,n,i,c);for(var f,p,g=t;t.prev!==t.next;)if(f=t.prev,p=t.next,c?u(t,n,i,c):a(t))e.push(f.i/r),e.push(t.i/r),e.push(p.i/r),C(t),t=p.next,g=p.next;else if((t=p)===g){d?1===d?s(t=h(t,e,r),e,r,n,i,c,2):2===d&&l(t,e,r,n,i,c):s(o(t),e,r,n,i,c,1);break}}}function a(t){var e=t.prev,r=t,n=t.next;if(0<=x(e,r,n))return!1;for(var i=t.next.next;i!==t.prev;){if(_(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&0<=x(i.prev,i,i.next))return!1;i=i.next}return!0}function u(t,e,r,n){var i=t.prev,o=t,s=t.next;if(0<=x(i,o,s))return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,h=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,c=y(a,u,e,r,n),d=y(h,l,e,r,n),f=t.prevZ,p=t.nextZ;f&&f.z>=c&&p&&p.z<=d;){if(f!==t.prev&&f!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=x(f.prev,f,f.next))return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=x(p.prev,p,p.next))return!1;p=p.nextZ}for(;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=x(f.prev,f,f.next))return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=x(p.prev,p,p.next))return!1;p=p.nextZ}return!0}function h(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!T(i,o)&&w(i,n,n.next,o)&&S(i,o)&&S(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),C(n),C(n.next),n=t=o),n=n.next}while(n!==t);return n}function l(t,e,r,n,i,a){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&b(u,h)){var l=M(u,h);return u=o(u,u.next),l=o(l,l.next),s(u,e,r,n,i,a),void s(l,e,r,n,i,a)}h=h.next}u=u.next}while(u!==t)}function c(t,e,r,n){var s,a,l,c=[];for(s=0,a=e.length;s<a;s++)(l=i(t,e[s]*n,s<a-1?e[s+1]*n:t.length,n,!1))===l.next&&(l.steiner=!0),c.push(m(l));for(c.sort(d),s=0;s<c.length;s++)f(c[s],r),r=o(r,r.next);return r}function d(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var r,n=e,i=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&s<a){if((s=a)===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===s)return r.prev;var u,h=r,l=r.x,c=r.y,d=1/0;for(n=r.next;n!==h;)i>=n.x&&n.x>=l&&i!==n.x&&_(o<c?i:s,o,l,c,o<c?s:i,o,n.x,n.y)&&((u=Math.abs(o-n.y)/(i-n.x))<d||u===d&&n.x>r.x)&&S(n,t)&&(r=n,d=u),n=n.next;return r}(t,e)){var r=M(e,t);o(r,r.next)}}function v(t,e,r,n){for(var i=t;null===i.z&&(i.z=y(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,(i=i.next)!==t;);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,s,a,u,h=1;do{for(r=t,o=t=null,s=0;r;){for(s++,n=r,e=a=0;e<h&&(a++,n=n.nextZ);e++);for(u=h;0<a||0<u&&n;)0!==a&&(0===u||!n||r.z<=n.z)?(r=(i=r).nextZ,a--):(n=(i=n).nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,h*=2}while(1<s)}(i)}function y(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function m(t){for(var e=t,r=t;e.x<r.x&&(r=e),(e=e.next)!==t;);return r}function _(t,e,r,n,i,o,s,a){return 0<=(i-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(n-a)-(r-s)*(e-a)&&0<=(r-s)*(o-a)-(i-s)*(n-a)}function b(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&w(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&S(t,e)&&S(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;for(;r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next,r!==t;);return n}(t,e)}function x(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function T(t,e){return t.x===e.x&&t.y===e.y}function w(t,e,r,n){return!!(T(t,e)&&T(r,n)||T(t,n)&&T(r,e))||0<x(t,e,r)!=0<x(t,e,n)&&0<x(r,n,t)!=0<x(r,n,e)}function S(t,e){return x(t.prev,t,t.next)<0?0<=x(t,e,t.next)&&0<=x(t,t.prev,e):x(t,e,t.prev)<0||x(t,t.next,e)<0}function M(t,e){var r=new R(t.i,t.x,t.y),n=new R(e.i,e.x,e.y),i=t.next,o=e.prev;return(t.next=e).prev=t,(r.next=i).prev=r,(n.next=r).prev=n,(o.next=n).prev=o,n}function P(t,e,r,n){var i=new R(t,e,r);return n?(i.next=n.next,(i.prev=n).next.prev=i,n.next=i):(i.prev=i).next=i,i}function C(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function R(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(t,e,r,n){for(var i=0,o=e,s=r-n;o<r;o+=n)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}e.exports=n,(e.exports.default=n).deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,s=Math.abs(A(t,0,o,r));if(i)for(var a=0,u=e.length;a<u;a++){var h=e[a]*r,l=a<u-1?e[a+1]*r:t.length;s-=Math.abs(A(t,h,l,r))}var c=0;for(a=0;a<n.length;a+=3){var d=n[a]*r,f=n[a+1]*r,p=n[a+2]*r;c+=Math.abs((t[d]-t[p])*(t[1+f]-t[1+d])-(t[d]-t[f])*(t[1+p]-t[1+d]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[i][o][s]);0<i&&(n+=t[i-1].length,r.holes.push(n))}return r}},{}],3:[function(t,e,r){"use strict";function n(){}function i(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(){this._events=new n,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(a=!1)),o.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)s.call(t,e)&&r.push(a?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},o.prototype.listeners=function(t,e){var r=a?a+t:t,n=this._events[r];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},o.prototype.emit=function(t,e,r,n,i,o){var s=a?a+t:t;if(!this._events[s])return!1;var u,h,l=this._events[s],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,n),!0;case 5:return l.fn.call(l.context,e,r,n,i),!0;case 6:return l.fn.call(l.context,e,r,n,i,o),!0}for(h=1,u=new Array(c-1);h<c;h++)u[h-1]=arguments[h];l.fn.apply(l.context,u)}else{var d,f=l.length;for(h=0;h<f;h++)switch(l[h].once&&this.removeListener(t,l[h].fn,void 0,!0),c){case 1:l[h].fn.call(l[h].context);break;case 2:l[h].fn.call(l[h].context,e);break;case 3:l[h].fn.call(l[h].context,e,r);break;case 4:l[h].fn.call(l[h].context,e,r,n);break;default:if(!u)for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];l[h].fn.apply(l[h].context,u)}}return!0},o.prototype.on=function(t,e,r){var n=new i(e,r||this),o=a?a+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},o.prototype.once=function(t,e,r){var n=new i(e,r||this,!0),o=a?a+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},o.prototype.removeListener=function(t,e,r,i){var o=a?a+t:t;if(!this._events[o])return this;if(!e)return 0==--this._eventsCount?this._events=new n:delete this._events[o],this;var s=this._events[o];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||(0==--this._eventsCount?this._events=new n:delete this._events[o]);else{for(var u=0,h=[],l=s.length;u<l;u++)(s[u].fn!==e||i&&!s[u].once||r&&s[u].context!==r)&&h.push(s[u]);h.length?this._events[o]=1===h.length?h[0]:h:0==--this._eventsCount?this._events=new n:delete this._events[o]}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=a?a+t:t,this._events[e]&&(0==--this._eventsCount?this._events=new n:delete this._events[e])):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prototype.setMaxListeners=function(){return this},o.prefixed=a,o.EventEmitter=o,void 0!==e&&(e.exports=o)},{}],4:[function(e,r,n){!function(e){function n(t,e){return t.test(e)}function i(t){var e=t||("undefined"!=typeof navigator?navigator.userAgent:""),r=e.split("[FBAN");void 0!==r[1]&&(e=r[0]),void 0!==(r=e.split("Twitter"))[1]&&(e=r[0]);var i={apple:{phone:n(o,e)&&!n(d,e),ipod:n(s,e),tablet:!n(o,e)&&n(a,e)&&!n(d,e),device:(n(o,e)||n(s,e)||n(a,e))&&!n(d,e)},amazon:{phone:n(l,e),tablet:!n(l,e)&&n(c,e),device:n(l,e)||n(c,e)},android:{phone:!n(d,e)&&n(l,e)||!n(d,e)&&n(u,e),tablet:!n(d,e)&&!n(l,e)&&!n(u,e)&&(n(c,e)||n(h,e)),device:!n(d,e)&&(n(l,e)||n(c,e)||n(u,e)||n(h,e))},windows:{phone:n(d,e),tablet:n(f,e),device:n(d,e)||n(f,e)},other:{blackberry:n(p,e),blackberry10:n(v,e),opera:n(g,e),firefox:n(m,e),chrome:n(y,e),device:n(p,e)||n(v,e)||n(g,e)||n(m,e)||n(y,e)}};return i.any=i.apple.device||i.android.device||i.windows.device||i.other.device,i.phone=i.apple.phone||i.android.phone||i.windows.phone,i.tablet=i.apple.tablet||i.android.tablet||i.windows.tablet,i}var o=/iPhone/i,s=/iPod/i,a=/iPad/i,u=/\bAndroid(?:.+)Mobile\b/i,h=/Android/i,l=/\bAndroid(?:.+)SD4930UR\b/i,c=/\bAndroid(?:.+)(?:KF[A-Z]{2,4})\b/i,d=/Windows Phone/i,f=/\bWindows(?:.+)ARM\b/i,p=/BlackBerry/i,v=/BB10/i,g=/Opera Mini/i,y=/\b(CriOS|Chrome)(?:.+)Mobile/i,m=/\Mobile(?:.+)Firefox\b/i;void 0!==r&&r.exports&&"undefined"==typeof window?r.exports=i:void 0!==r&&r.exports&&"undefined"!=typeof window?r.exports=i():e.isMobile=i()}(this)},{}],5:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return t._head?(t._tail._next=e)._prev=t._tail:t._head=e,(t._tail=e)._owner=t,e}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(){function t(e,r,i){void 0===r&&(r=!1),n(this,t),this._fn=e,this._once=r,this._thisArg=i,this._next=this._prev=this._owner=null}return o(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}(),a=function(){function t(){n(this,t),this._head=this._tail=void 0}return o(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var r=[];e;)r.push(e),e=e._next;return r}},{key:"has",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return i(this,new s(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return i(this,new s(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=s,r.default=a,e.exports=r.default},{}],6:[function(t,e,r){"use strict";var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,a,u=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),h=1;h<arguments.length;h++){for(var l in r=Object(arguments[h]))o.call(r,l)&&(u[l]=r[l]);if(i){a=i(r);for(var c=0;c<a.length;c++)s.call(r,a[c])&&(u[a[c]]=r[a[c]])}}return u}},{}],7:[function(t,e,r){"use strict";e.exports=function(t,e){e=e||{};for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=r.parser[e.strictMode?"strict":"loose"].exec(t),i={},o=14;o--;)i[r.key[o]]=n[o]||"";return i[r.q.name]={},i[r.key[12]].replace(r.q.parser,function(t,e,n){e&&(i[r.q.name][e]=n)}),i}},{}],8:[function(t,e,r){(function(t){function e(t,e){for(var r=0,n=t.length-1;0<=n;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}function o(t){return i.exec(t).slice(1)}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;r.resolve=function(){for(var r="",i=!1,o=arguments.length-1;-1<=o&&!i;o--){var s=0<=o?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(r=s+"/"+r,i="/"===s.charAt(0))}return(i?"/":"")+(r=e(n(r.split("/"),function(t){return!!t}),!i).join("/"))||"."},r.normalize=function(t){var i=r.isAbsolute(t),o="/"===s(t,-1);return(t=e(n(t.split("/"),function(t){return!!t}),!i).join("/"))||i||(t="."),t&&o&&(t+="/"),(i?"/":"")+t},r.isAbsolute=function(t){return"/"===t.charAt(0)},r.join=function(){var t=Array.prototype.slice.call(arguments,0);return r.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},r.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;0<=r&&""===t[r];r--);return r<e?[]:t.slice(e,r-e+1)}t=r.resolve(t).substr(1),e=r.resolve(e).substr(1);for(var i=n(t.split("/")),o=n(e.split("/")),s=Math.min(i.length,o.length),a=s,u=0;u<s;u++)if(i[u]!==o[u]){a=u;break}var h=[];for(u=a;u<i.length;u++)h.push("..");return(h=h.concat(o.slice(a))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(t){var e=o(t),r=e[0],n=e[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},r.basename=function(t,e){var r=o(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r},r.extname=function(t){return o(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}}).call(this,t("_process"))},{_process:26}],9:[function(t,e,r){var n=new ArrayBuffer(0),i=function(t,e,r,i){this.gl=t,this.buffer=t.createBuffer(),this.type=e||t.ARRAY_BUFFER,this.drawType=i||t.STATIC_DRAW,this.data=n,r&&this.upload(r),this._updateID=0};i.prototype.upload=function(t,e,r){r||this.bind();var n=this.gl;t=t||this.data,e=e||0,this.data.byteLength>=t.byteLength?n.bufferSubData(this.type,e,t):n.bufferData(this.type,t,this.drawType),this.data=t},i.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},i.createVertexBuffer=function(t,e,r){return new i(t,t.ARRAY_BUFFER,e,r)},i.createIndexBuffer=function(t,e,r){return new i(t,t.ELEMENT_ARRAY_BUFFER,e,r)},i.create=function(t,e,r,n){return new i(t,e,r,n)},i.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=i},{}],10:[function(t,e,r){function i(t,e,r){this.gl=t,this.framebuffer=t.createFramebuffer(),this.stencil=null,this.texture=null,this.width=e||100,this.height=r||100}var n=t("./GLTexture");i.prototype.enableTexture=function(t){var e=this.gl;this.texture=t||new n(e),this.texture.bind(),this.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.texture,0)},i.prototype.enableStencil=function(){if(!this.stencil){var t=this.gl;this.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencil),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height)}},i.prototype.clear=function(t,e,r,n){this.bind();var i=this.gl;i.clearColor(t,e,r,n),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)},i.prototype.bind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer)},i.prototype.unbind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},i.prototype.resize=function(t,e){var r=this.gl;this.width=t,this.height=e,this.texture&&this.texture.uploadData(null,t,e),this.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,this.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t,e))},i.prototype.destroy=function(){var t=this.gl;this.texture&&this.texture.destroy(),t.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},i.createRGBA=function(t,e,r,o){var s=n.fromData(t,null,e,r);s.enableNearestScaling(),s.enableWrapClamp();var a=new i(t,e,r);return a.enableTexture(s),a.unbind(),a},i.createFloat32=function(t,e,r,o){var s=new n.fromData(t,o,e,r);s.enableNearestScaling(),s.enableWrapClamp();var a=new i(t,e,r);return a.enableTexture(s),a.unbind(),a},e.exports=i},{"./GLTexture":12}],11:[function(t,e,r){var n=t("./shader/compileProgram"),i=t("./shader/extractAttributes"),o=t("./shader/extractUniforms"),s=t("./shader/setPrecision"),a=t("./shader/generateUniformAccessObject"),u=function(t,e,r,u,h){this.gl=t,u&&(e=s(e,u),r=s(r,u)),this.program=n(t,e,r,h),this.attributes=i(t,this.program),this.uniformData=o(t,this.program),this.uniforms=a(t,this.uniformData)};u.prototype.bind=function(){return this.gl.useProgram(this.program),this},u.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null,this.gl.deleteProgram(this.program)},e.exports=u},{"./shader/compileProgram":17,"./shader/extractAttributes":19,"./shader/extractUniforms":20,"./shader/generateUniformAccessObject":21,"./shader/setPrecision":25}],12:[function(t,e,r){var n=function(t,e,r,n,i){this.gl=t,this.texture=t.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=e||-1,this.height=r||-1,this.format=n||t.RGBA,this.type=i||t.UNSIGNED_BYTE},i=!(n.prototype.upload=function(t){this.bind();var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var r=t.videoWidth||t.width,n=t.videoHeight||t.height;n!==this.height||r!==this.width?e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,t):e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.format,this.type,t),this.width=r,this.height=n});n.prototype.uploadData=function(t,e,r){this.bind();var n=this.gl;if(t instanceof Float32Array){if(!i){if(!n.getExtension("OES_texture_float"))throw new Error("floating point textures not available");i=!0}this.type=n.FLOAT}else this.type=this.type||n.UNSIGNED_BYTE;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e!==this.width||r!==this.height?n.texImage2D(n.TEXTURE_2D,0,this.format,e,r,0,this.format,this.type,t||null):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,r,this.format,this.type,t||null),this.width=e,this.height=r},n.prototype.bind=function(t){var e=this.gl;void 0!==t&&e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},n.prototype.unbind=function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,null)},n.prototype.minFilter=function(t){var e=this.gl;this.bind(),this.mipmap?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR:e.NEAREST)},n.prototype.magFilter=function(t){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t?e.LINEAR:e.NEAREST)},n.prototype.enableMipmap=function(){var t=this.gl;this.bind(),this.mipmap=!0,t.generateMipmap(t.TEXTURE_2D)},n.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},n.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},n.prototype.enableWrapClamp=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},n.prototype.enableWrapRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)},n.prototype.enableWrapMirrorRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.MIRRORED_REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.MIRRORED_REPEAT)},n.prototype.destroy=function(){this.gl.deleteTexture(this.texture)},n.fromSource=function(t,e,r){var i=new n(t);return i.premultiplyAlpha=r||!1,i.upload(e),i},n.fromData=function(t,e,r,i){var o=new n(t);return o.uploadData(e,r,i),o},e.exports=n},{}],13:[function(t,e,r){function n(t,e){if(this.nativeVaoExtension=null,n.FORCE_NATIVE||(this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=e,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var r=t.getParameter(t.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(r),attribState:new Array(r)}}this.gl=t,this.attributes=[],this.indexBuffer=null,this.dirty=!1}var i=t("./setVertexAttribArrays");n.prototype.constructor=n,(e.exports=n).FORCE_NATIVE=!1,n.prototype.bind=function(){if(this.nativeVao){if(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty)return this.dirty=!1,this.activate(),this;this.indexBuffer&&this.indexBuffer.bind()}else this.activate();return this},n.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},n.prototype.activate=function(){for(var t=this.gl,e=null,r=0;r<this.attributes.length;r++){var n=this.attributes[r];e!==n.buffer&&(n.buffer.bind(),e=n.buffer),t.vertexAttribPointer(n.attribute.location,n.attribute.size,n.type||t.FLOAT,n.normalized||!1,n.stride||0,n.start||0)}return i(t,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},n.prototype.addAttribute=function(t,e,r,n,i,o){return this.attributes.push({buffer:t,attribute:e,location:e.location,type:r||this.gl.FLOAT,normalized:n||!1,stride:i||0,start:o||0}),this.dirty=!0,this},n.prototype.addIndex=function(t){return this.indexBuffer=t,this.dirty=!0,this},n.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},n.prototype.draw=function(t,e,r){var n=this.gl;return this.indexBuffer?n.drawElements(t,e||this.indexBuffer.data.length,n.UNSIGNED_SHORT,2*(r||0)):n.drawArrays(t,r,e||this.getSize()),this},n.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},n.prototype.getSize=function(){var t=this.attributes[0];return t.buffer.data.length/(t.stride/4||t.attribute.size)}},{"./setVertexAttribArrays":16}],14:[function(t,e,r){e.exports=function(t,e){var r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!r)throw new Error("This browser does not support webGL. Try using the canvas renderer");return r}},{}],15:[function(t,e,r){var n={createContext:t("./createContext"),setVertexAttribArrays:t("./setVertexAttribArrays"),GLBuffer:t("./GLBuffer"),GLFramebuffer:t("./GLFramebuffer"),GLShader:t("./GLShader"),GLTexture:t("./GLTexture"),VertexArrayObject:t("./VertexArrayObject"),shader:t("./shader")};void 0!==e&&e.exports&&(e.exports=n),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=n)},{"./GLBuffer":9,"./GLFramebuffer":10,"./GLShader":11,"./GLTexture":12,"./VertexArrayObject":13,"./createContext":14,"./setVertexAttribArrays":16,"./shader":22}],16:[function(t,e,r){e.exports=function(t,e,r){var n;if(r){var i=r.tempAttribState,o=r.attribState;for(n=0;n<i.length;n++)i[n]=!1;for(n=0;n<e.length;n++)i[e[n].attribute.location]=!0;for(n=0;n<o.length;n++)o[n]!==i[n]&&(o[n]=i[n],r.attribState[n]?t.enableVertexAttribArray(n):t.disableVertexAttribArray(n))}else for(n=0;n<e.length;n++){var s=e[n];t.enableVertexAttribArray(s.attribute.location)}}},{}],17:[function(t,e,r){var i=function(t,e,r){var n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.log(t.getShaderInfoLog(n)),null)};e.exports=function(t,e,r,n){var o=i(t,t.VERTEX_SHADER,e),s=i(t,t.FRAGMENT_SHADER,r),a=t.createProgram();if(t.attachShader(a,o),t.attachShader(a,s),n)for(var u in n)t.bindAttribLocation(a,n[u],u);return t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(a,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(a)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(a)),t.deleteProgram(a),a=null),t.deleteShader(o),t.deleteShader(s),a}},{}],18:[function(t,e,r){var i=function(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e};e.exports=function(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return i(2*e);case"bvec3":return i(3*e);case"bvec4":return i(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}},{}],19:[function(t,e,r){var n=t("./mapType"),i=t("./mapSize"),s=function(t,e,r,n){gl.vertexAttribPointer(this.location,this.size,t||gl.FLOAT,e||!1,r||0,n||0)};e.exports=function(t,e){for(var r={},o=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;a<o;a++){var u=t.getActiveAttrib(e,a),h=n(t,u.type);r[u.name]={type:h,size:i(h),location:t.getAttribLocation(e,u.name),pointer:s}}return r}},{"./mapSize":23,"./mapType":24}],20:[function(t,e,r){var n=t("./mapType"),i=t("./defaultValue");e.exports=function(t,e){for(var r={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<o;s++){var a=t.getActiveUniform(e,s),u=a.name.replace(/\[.*?\]/,""),h=n(t,a.type);r[u]={type:h,size:a.size,location:t.getUniformLocation(e,u),value:i(h,a.size)}}return r}},{"./defaultValue":18,"./mapType":24}],21:[function(t,e,r){function n(t,e){return function(r){this.data[t].value=r;var n=this.data[t].location;1===e.size?a[e.type](this.gl,n,r):u[e.type](this.gl,n,r)}}function i(t,e){for(var r=e,n=0;n<t.length-1;n++){var i=r[t[n]]||{data:{}};r[t[n]]=i,r=i}return r}var s=function(t){return function(){return this.data[t].value}},a={float:function(t,e,r){t.uniform1f(e,r)},vec2:function(t,e,r){t.uniform2f(e,r[0],r[1])},vec3:function(t,e,r){t.uniform3f(e,r[0],r[1],r[2])},vec4:function(t,e,r){t.uniform4f(e,r[0],r[1],r[2],r[3])},int:function(t,e,r){t.uniform1i(e,r)},ivec2:function(t,e,r){t.uniform2i(e,r[0],r[1])},ivec3:function(t,e,r){t.uniform3i(e,r[0],r[1],r[2])},ivec4:function(t,e,r){t.uniform4i(e,r[0],r[1],r[2],r[3])},bool:function(t,e,r){t.uniform1i(e,r)},bvec2:function(t,e,r){t.uniform2i(e,r[0],r[1])},bvec3:function(t,e,r){t.uniform3i(e,r[0],r[1],r[2])},bvec4:function(t,e,r){t.uniform4i(e,r[0],r[1],r[2],r[3])},mat2:function(t,e,r){t.uniformMatrix2fv(e,!1,r)},mat3:function(t,e,r){t.uniformMatrix3fv(e,!1,r)},mat4:function(t,e,r){t.uniformMatrix4fv(e,!1,r)},sampler2D:function(t,e,r){t.uniform1i(e,r)}},u={float:function(t,e,r){t.uniform1fv(e,r)},vec2:function(t,e,r){t.uniform2fv(e,r)},vec3:function(t,e,r){t.uniform3fv(e,r)},vec4:function(t,e,r){t.uniform4fv(e,r)},int:function(t,e,r){t.uniform1iv(e,r)},ivec2:function(t,e,r){t.uniform2iv(e,r)},ivec3:function(t,e,r){t.uniform3iv(e,r)},ivec4:function(t,e,r){t.uniform4iv(e,r)},bool:function(t,e,r){t.uniform1iv(e,r)},bvec2:function(t,e,r){t.uniform2iv(e,r)},bvec3:function(t,e,r){t.uniform3iv(e,r)},bvec4:function(t,e,r){t.uniform4iv(e,r)},sampler2D:function(t,e,r){t.uniform1iv(e,r)}};e.exports=function(t,e){var r={data:{}};r.gl=t;for(var o=Object.keys(e),a=0;a<o.length;a++){var u=o[a],h=u.split("."),l=h[h.length-1],c=i(h,r),d=e[u];c.data[l]=d,c.gl=t,Object.defineProperty(c,l,{get:s(l),set:n(l,d)})}return r}},{}],22:[function(t,e,r){e.exports={compileProgram:t("./compileProgram"),defaultValue:t("./defaultValue"),extractAttributes:t("./extractAttributes"),extractUniforms:t("./extractUniforms"),generateUniformAccessObject:t("./generateUniformAccessObject"),setPrecision:t("./setPrecision"),mapSize:t("./mapSize"),mapType:t("./mapType")}},{"./compileProgram":17,"./defaultValue":18,"./extractAttributes":19,"./extractUniforms":20,"./generateUniformAccessObject":21,"./mapSize":23,"./mapType":24,"./setPrecision":25}],23:[function(t,e,r){var i={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=function(t){return i[t]}},{}],24:[function(t,e,r){var i=null,o={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};e.exports=function(t,e){if(!i){var r=Object.keys(o);i={};for(var n=0;n<r.length;++n){var s=r[n];i[t[s]]=o[s]}}return i[e]}},{}],25:[function(t,e,r){e.exports=function(t,e){return"precision"!==t.substring(0,9)?"precision "+e+" float;\n"+t:t}},{}],26:[function(t,e,r){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function a(){g&&p&&(g=!1,p.length?v=p.concat(v):y=-1,v.length&&u())}function u(){if(!g){var t=o(a);g=!0;for(var e=v.length;e;){for(p=v,v=[];++y<e;)p&&p[y].run();y=-1,e=v.length}p=null,g=!1,function(t){if(d===clearTimeout)return clearTimeout(t);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function l(){}var c,d,f=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(t){d=i}}();var p,v=[],g=!1,y=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];v.push(new h(t,e)),1!==v.length||g||o(u)},h.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],27:[function(e,r,n){(function(e){!function(i){function o(t){throw new RangeError(L[t])}function s(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function a(t,e){var r=t.split("@"),n="";return 1<r.length&&(n=r[0]+"@",t=r[1]),n+s((t=t.replace(D,".")).split("."),e).join(".")}function u(t){for(var e,r,n=[],i=0,o=t.length;i<o;)55296<=(e=t.charCodeAt(i++))&&e<=56319&&i<o?56320==(64512&(r=t.charCodeAt(i++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--):n.push(e);return n}function h(t){return s(t,function(t){var e="";return 65535<t&&(e+=k((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+k(t)}).join("")}function l(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:w}function c(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function d(t,e,r){var n=0;for(t=r?B(t/M):t>>1,t+=B(t/e);N*S>>1<t;n+=w)t=B(t/N);return B(n+(N+1)*t/(t+O))}function f(t){var e,r,n,i,s,a,u,c,f,p,v=[],g=t.length,y=0,m=C,_=P;for((r=t.lastIndexOf(R))<0&&(r=0),n=0;n<r;++n)128<=t.charCodeAt(n)&&o("not-basic"),v.push(t.charCodeAt(n));for(i=0<r?r+1:0;i<g;){for(s=y,a=1,u=w;g<=i&&o("invalid-input"),c=l(t.charCodeAt(i++)),(w<=c||c>B((T-y)/a))&&o("overflow"),y+=c*a,!(c<(f=u<=_?E:_+S<=u?S:u-_));u+=w)a>B(T/(p=w-f))&&o("overflow"),a*=p;_=d(y-s,e=v.length+1,0==s),B(y/e)>T-m&&o("overflow"),m+=B(y/e),y%=e,v.splice(y++,0,m)}return h(v)}function p(t){var e,r,n,i,s,a,h,l,f,p,v,g,y,m,_,b=[];for(g=(t=u(t)).length,e=C,s=P,a=r=0;a<g;++a)(v=t[a])<128&&b.push(k(v));for(n=i=b.length,i&&b.push(R);n<g;){for(h=T,a=0;a<g;++a)(v=t[a])>=e&&v<h&&(h=v);for(h-e>B((T-r)/(y=n+1))&&o("overflow"),r+=(h-e)*y,e=h,a=0;a<g;++a)if((v=t[a])<e&&++r>T&&o("overflow"),v==e){for(l=r,f=w;!(l<(p=f<=s?E:s+S<=f?S:f-s));f+=w)_=l-p,m=w-p,b.push(k(c(p+_%m,0))),l=B(_/m);b.push(k(c(l,0))),s=d(r,y,n==i),r=0,++n}++r,++e}return b.join("")}var y="object"==typeof n&&n&&!n.nodeType&&n,m="object"==typeof r&&r&&!r.nodeType&&r,_="object"==typeof e&&e;_.global!==_&&_.window!==_&&_.self!==_||(i=_);var b,x,T=2147483647,w=36,E=1,S=26,O=38,M=700,P=72,C=128,R="-",A=/^xn--/,I=/[^\x20-\x7E]/,D=/[\x2E\u3002\uFF0E\uFF61]/g,L={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=w-E,B=Math.floor,k=String.fromCharCode;if(b={version:"1.4.1",ucs2:{decode:u,encode:h},decode:f,encode:p,toASCII:function(t){return a(t,function(t){return I.test(t)?"xn--"+p(t):t})},toUnicode:function(t){return a(t,function(t){return A.test(t)?f(t.slice(4).toLowerCase()):t})}},y&&m)if(r.exports==y)m.exports=b;else for(x in b)b.hasOwnProperty(x)&&(y[x]=b[x]);else i.punycode=b}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(t,e,r){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,r,o){e=e||"&",r=r||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var h=t.length;0<u&&u<h&&(h=u);for(var l=0;l<h;++l){var c,d,f,p,v=t[l].replace(a,"%20"),g=v.indexOf(r);d=0<=g?(c=v.substr(0,g),v.substr(g+1)):(c=v,""),f=decodeURIComponent(c),p=decodeURIComponent(d),n(s,f)?i(s[f])?s[f].push(p):s[f]=[s[f],p]:s[f]=p}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],29:[function(t,e,r){"use strict";function n(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}function i(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}e.exports=function(t,e,r,a){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?n(s(t),function(s){var a=encodeURIComponent(i(s))+r;return o(t[s])?n(t[s],function(t){return a+encodeURIComponent(i(t))}).join(e):a+encodeURIComponent(i(t[s]))}).join(e):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},{}],30:[function(t,e,r){"use strict";r.decode=r.parse=t("./decode"),r.encode=r.stringify=t("./encode")},{"./decode":28,"./encode":29}],31:[function(t,e,r){"use strict";e.exports=function(t,e,r){var n,i=t.length;if(!(i<=e||0===r)){var o=i-(r=i<e+r?i-e:r);for(n=e;n<o;++n)t[n]=t[n+r];t.length=o}}},{}],32:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.Loader=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=n(t("mini-signals")),l=n(t("parse-uri")),d=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("./async")),f=t("./Resource"),p=/(#[\w-]+)?$/,v=r.Loader=function(){function t(){var e=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.baseUrl=r,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,r){return e._loadResource(t,r)},this._queue=d.queue(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new u.default,this.onError=new u.default,this.onLoad=new u.default,this.onStart=new u.default,this.onComplete=new u.default;for(var o=0;o<t._defaultBeforeMiddleware.length;++o)this.pre(t._defaultBeforeMiddleware[o]);for(var s=0;s<t._defaultAfterMiddleware.length;++s)this.use(t._defaultAfterMiddleware[s])}return t.prototype.add=function(t,e,r,n){if(Array.isArray(t)){for(var i=0;i<t.length;++i)this.add(t[i]);return this}if("object"===(void 0===t?"undefined":o(t))&&(n=e||t.callback||t.onComplete,e=(r=t).url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=r,r=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(n=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new f.Resource(t,e,r),"function"==typeof n&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var s=r.parentResource,a=[],u=0;u<s.children.length;++u)s.children[u].isComplete||a.push(s.children[u]);var l=s.progressChunk*(a.length+1)/(a.length+2);s.children.push(this.resources[t]),s.progressChunk=l;for(var c=0;c<a.length;++c)a[c].progressChunk=l;this.resources[t].progressChunk=l}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var r=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=r;this._onStart(),this._queue.resume()}return this},t.prototype._prepareUrl=function(t){var e=(0,l.default)(t,{strictMode:!0}),r=void 0;if(r=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var n=p.exec(r)[0];-1!==(r=r.substr(0,r.length-n.length)).indexOf("?")?r+="&"+this.defaultQueryString:r+="?"+this.defaultQueryString,r+=n}return r},t.prototype._loadResource=function(t,e){var r=this;t._dequeue=e,d.eachSeries(this._beforeMiddleware,function(e,n){e.call(r,t,function(){n(t.isComplete?{}:null)})},function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())},!0)},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),d.eachSeries(this._afterMiddleware,function(r,n){r.call(e,t,n)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()},!0)},s(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();v._defaultBeforeMiddleware=[],v._defaultAfterMiddleware=[],v.pre=function(t){return v._defaultBeforeMiddleware.push(t),v},v.use=function(t){return v._defaultAfterMiddleware.push(t),v}},{"./Resource":33,"./async":34,"mini-signals":5,"parse-uri":7}],33:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(){}function s(t,e,r){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=r)}function a(t){return t.toString().replace("object ","")}r.__esModule=!0,r.Resource=void 0;var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=n(t("parse-uri")),d=n(t("mini-signals")),f=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),p=null,v=r.Resource=function(){function t(e,r,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"!=typeof e||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=e,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===n.crossOrigin?"anonymous":n.crossOrigin,this.timeout=n.timeout||0,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=o,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new d.default,this.onProgress=new d.default,this.onComplete=new d.default,this.onAfterMiddleware=new d.default}return t.setExtensionLoadType=function(e,r){s(t._loadTypeMap,e,r)},t.setExtensionXhrType=function(e,r){s(t._xhrTypeMap,e,r)},t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var r=this;if(!this.isLoading){if(this.isComplete)return void(e&&setTimeout(function(){return e(r)},1));switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:f&&this.crossOrigin?this._loadXdr():this._loadXhr()}}},t.prototype._hasFlag=function(t){return 0!=(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(e)?e[r]:e));else{var n=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(n)?n[0]:n))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,r){r||(r=t+"/"+this._getExtension(e));var n=document.createElement("source");return n.src=e,n.type=r,n},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(a(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(a(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(a(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,r="",n=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(r=e.responseText),0===n&&(0<r.length||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?n=200:1223===n&&(n=204),2==(n/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var i=new DOMParser;this.data=i.parseFromString(r,"text/xml")}else{var o=document.createElement("div");o.innerHTML=r,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||r;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,p||(p=document.createElement("a")),p.href=t;var r=!(t=(0,l.default)(p.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,n=t.protocol?t.protocol+":":"";return t.host===e.hostname&&r&&n===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var n=t.indexOf("?"),i=t.indexOf("#"),o=Math.min(-1<n?n:t.length,-1<i?i:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},u(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();v.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},v.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},v.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},v.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},v._loadTypeMap={gif:v.LOAD_TYPE.IMAGE,png:v.LOAD_TYPE.IMAGE,bmp:v.LOAD_TYPE.IMAGE,jpg:v.LOAD_TYPE.IMAGE,jpeg:v.LOAD_TYPE.IMAGE,tif:v.LOAD_TYPE.IMAGE,tiff:v.LOAD_TYPE.IMAGE,webp:v.LOAD_TYPE.IMAGE,tga:v.LOAD_TYPE.IMAGE,svg:v.LOAD_TYPE.IMAGE,"svg+xml":v.LOAD_TYPE.IMAGE,mp3:v.LOAD_TYPE.AUDIO,ogg:v.LOAD_TYPE.AUDIO,wav:v.LOAD_TYPE.AUDIO,mp4:v.LOAD_TYPE.VIDEO,webm:v.LOAD_TYPE.VIDEO},v._xhrTypeMap={xhtml:v.XHR_RESPONSE_TYPE.DOCUMENT,html:v.XHR_RESPONSE_TYPE.DOCUMENT,htm:v.XHR_RESPONSE_TYPE.DOCUMENT,xml:v.XHR_RESPONSE_TYPE.DOCUMENT,tmx:v.XHR_RESPONSE_TYPE.DOCUMENT,svg:v.XHR_RESPONSE_TYPE.DOCUMENT,tsx:v.XHR_RESPONSE_TYPE.DOCUMENT,gif:v.XHR_RESPONSE_TYPE.BLOB,png:v.XHR_RESPONSE_TYPE.BLOB,bmp:v.XHR_RESPONSE_TYPE.BLOB,jpg:v.XHR_RESPONSE_TYPE.BLOB,jpeg:v.XHR_RESPONSE_TYPE.BLOB,tif:v.XHR_RESPONSE_TYPE.BLOB,tiff:v.XHR_RESPONSE_TYPE.BLOB,webp:v.XHR_RESPONSE_TYPE.BLOB,tga:v.XHR_RESPONSE_TYPE.BLOB,json:v.XHR_RESPONSE_TYPE.JSON,text:v.XHR_RESPONSE_TYPE.TEXT,txt:v.XHR_RESPONSE_TYPE.TEXT,ttf:v.XHR_RESPONSE_TYPE.BUFFER,otf:v.XHR_RESPONSE_TYPE.BUFFER},v.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",void 0!==e&&(e.exports.default=v)},{"mini-signals":5,"parse-uri":7}],34:[function(t,e,r){"use strict";function n(){}function o(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}r.__esModule=!0,r.eachSeries=function(t,e,r,n){var i=0,o=t.length;!function s(a){a||i===o?r&&r(a):n?setTimeout(function(){e(t[i++],s)},1):e(t[i++],s)}()},r.queue=function(t,e){function r(t,e,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(a.started=!0,null==t&&a.idle())setTimeout(function(){return a.drain()},1);else{var i={data:t,callback:"function"==typeof r?r:n};e?a._tasks.unshift(i):a._tasks.push(i),setTimeout(function(){return a.process()},1)}}function i(t){return function(){s-=1,t.callback.apply(t,arguments),null!=arguments[0]&&a.error(arguments[0],t.data),s<=a.concurrency-a.buffer&&a.unsaturated(),a.idle()&&a.drain(),a.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var s=0,a={_tasks:[],concurrency:e,saturated:n,unsaturated:n,buffer:e/4,empty:n,drain:n,error:n,started:!1,paused:!1,push:function(t,e){r(t,!1,e)},kill:function(){s=0,a.drain=n,a.started=!1,a._tasks=[]},unshift:function(t,e){r(t,!0,e)},process:function(){for(;!a.paused&&s<a.concurrency&&a._tasks.length;){var e=a._tasks.shift();0===a._tasks.length&&a.empty(),(s+=1)===a.concurrency&&a.saturated(),t(e.data,o(i(e)))}},length:function(){return a._tasks.length},running:function(){return s},idle:function(){return a._tasks.length+s===0},pause:function(){!0!==a.paused&&(a.paused=!0)},resume:function(){if(!1!==a.paused){a.paused=!1;for(var t=1;t<=a.concurrency;t++)a.process()}}};return a}},{}],35:[function(t,e,r){"use strict";function n(t){for(var e="",r=0;r<t.length;){for(var n=[0,0,0],o=[0,0,0,0],s=0;s<n.length;++s)r<t.length?n[s]=255&t.charCodeAt(r++):n[s]=0;switch(o[0]=n[0]>>2,o[1]=(3&n[0])<<4|n[1]>>4,o[2]=(15&n[1])<<2|n[2]>>6,o[3]=63&n[2],r-(t.length-1)){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64}for(var a=0;a<o.length;++a)e+=i.charAt(o[a])}return e}r.__esModule=!0,r.encodeBinary=n;var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";void 0!==e&&(e.exports.default=n)},{}],36:[function(t,e,r){"use strict";var n=t("./Loader").Loader,i=t("./Resource").Resource,o=t("./async"),s=t("./b64");n.Resource=i,n.async=o,n.encodeBinary=s,n.base64=s,e.exports=n,e.exports.Loader=n,e.exports.default=n},{"./Loader":32,"./Resource":33,"./async":34,"./b64":35}],37:[function(t,e,r){"use strict";r.__esModule=!0,r.blobMiddlewareFactory=function(){return function(t,e){if(t.data){if(t.xhr&&t.xhrType===i.Resource.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=s.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=r,t.type=i.Resource.TYPE.IMAGE,void(t.data.onload=function(){s.revokeObjectURL(r),t.data.onload=null,e()})}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+(0,o.encodeBinary)(t.xhr.responseText),t.type=i.Resource.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}};var i=t("../../Resource"),o=t("../../b64"),s=window.URL||window.webkitURL},{"../../Resource":33,"../../b64":35}],38:[function(t,e,r){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(t,e,r){if(t&&h.isObject(t)&&t instanceof n)return t;var i=new n;return i.parse(t,e,r),i}var u=t("punycode"),h=t("./util");r.parse=i,r.resolve=function(t,e){return i(t,!1,!0).resolve(e)},r.resolveObject=function(t,e){return t?i(t,!1,!0).resolveObject(e):e},r.format=function(t){return h.isString(t)&&(t=i(t)),t instanceof n?t.format():n.prototype.format.call(t)},r.Url=n;var l=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,d=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),v=["'"].concat(p),g=["%","/","?",";","#"].concat(v),y=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:!0,"javascript:":!0},x={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=t("querystring");n.prototype.parse=function(t,e,r){if(!h.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=-1!==n&&n<t.indexOf("#")?"?":"#",o=t.split(i);o[0]=o[0].replace(/\\/g,"/");var a=t=o.join(i);if(a=a.trim(),!r&&1===t.split("#").length){var c=d.exec(a);if(c)return this.path=a,this.href=a,this.pathname=c[1],c[2]?(this.search=c[2],this.query=e?w.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var f=l.exec(a);if(f){var p=(f=f[0]).toLowerCase();this.protocol=p,a=a.substr(f.length)}if(r||f||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===a.substr(0,2);!E||f&&x[f]||(a=a.substr(2),this.slashes=!0)}if(!x[f]&&(E||f&&!T[f])){for(var S=-1,O=0;O<y.length;O++){-1!==(M=a.indexOf(y[O]))&&(-1===S||M<S)&&(S=M)}var P,C;-1!==(C=-1===S?a.lastIndexOf("@"):a.lastIndexOf("@",S))&&(P=a.slice(0,C),a=a.slice(C+1),this.auth=decodeURIComponent(P)),S=-1;for(O=0;O<g.length;O++){var M;-1!==(M=a.indexOf(g[O]))&&(-1===S||M<S)&&(S=M)}-1===S&&(S=a.length),this.host=a.slice(0,S),a=a.slice(S),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var A=this.hostname.split(/\./),I=(O=0,A.length);O<I;O++){var D=A[O];if(D&&!D.match(m)){for(var L="",N=0,B=D.length;N<B;N++)127<D.charCodeAt(N)?L+="x":L+=D[N];if(!L.match(m)){var k=A.slice(0,O),F=A.slice(O+1),j=D.match(_);j&&(k.push(j[1]),F.unshift(j[2])),F.length&&(a="/"+F.join(".")+a),this.hostname=k.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=u.toASCII(this.hostname));var U=this.port?":"+this.port:"",X=this.hostname||"";this.host=X+U,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!b[p])for(O=0,I=v.length;O<I;O++){var G=v[O];if(-1!==a.indexOf(G)){var W=encodeURIComponent(G);W===G&&(W=escape(G)),a=a.split(G).join(W)}}var H=a.indexOf("#");-1!==H&&(this.hash=a.substr(H),a=a.slice(0,H));var Y=a.indexOf("?");if(-1!==Y?(this.search=a.substr(Y),this.query=a.substr(Y+1),e&&(this.query=w.parse(this.query)),a=a.slice(0,Y)):e&&(this.search="",this.query={}),a&&(this.pathname=a),T[p]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var V=this.search||"";this.path=U+V}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&h.isObject(this.query)&&Object.keys(this.query).length&&(o=w.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||T[e])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),e+i+(r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(s=s.replace("#","%23"))+n},n.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(h.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var r=new n,i=Object.keys(this),o=0;o<i.length;o++){var s=i[o];r[s]=this[s]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),u=0;u<a.length;u++){var l=a[u];"protocol"!==l&&(r[l]=t[l])}return T[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!T[t.protocol]){for(var c=Object.keys(t),d=0;d<c.length;d++){var f=c[d];r[f]=t[f]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||x[t.protocol])r.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),r.pathname=p.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var v=r.pathname||"",g=r.search||"";r.path=v+g}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var y=r.pathname&&"/"===r.pathname.charAt(0),m=t.host||t.pathname&&"/"===t.pathname.charAt(0),_=m||y||r.host&&t.pathname,b=_,w=r.pathname&&r.pathname.split("/")||[],E=(p=t.pathname&&t.pathname.split("/")||[],r.protocol&&!T[r.protocol]);if(E&&(r.hostname="",r.port=null,r.host&&(""===w[0]?w[0]=r.host:w.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),_=_&&(""===p[0]||""===w[0])),m)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,w=p;else if(p.length)w||(w=[]),w.pop(),w=w.concat(p),r.search=t.search,r.query=t.query;else if(!h.isNullOrUndefined(t.search)){if(E)r.hostname=r.host=w.shift(),(S=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=S.shift(),r.host=r.hostname=S.shift());return r.search=t.search,r.query=t.query,h.isNull(r.pathname)&&h.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!w.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var O=w.slice(-1)[0],M=(r.host||t.host||1<w.length)&&("."===O||".."===O)||""===O,P=0,C=w.length;0<=C;C--)"."===(O=w[C])?w.splice(C,1):".."===O?(w.splice(C,1),P++):P&&(w.splice(C,1),P--);if(!_&&!b)for(;P--;)w.unshift("..");!_||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),M&&"/"!==w.join("/").substr(-1)&&w.push("");var S,R=""===w[0]||w[0]&&"/"===w[0].charAt(0);E&&(r.hostname=r.host=R?"":w.length?w.shift():"",(S=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=S.shift(),r.host=r.hostname=S.shift()));return(_=_||r.host&&w.length)&&!R&&w.unshift(""),w.length?r.pathname=w.join("/"):(r.pathname=null,r.path=null),h.isNull(r.pathname)&&h.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var t=this.host,e=c.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":39,punycode:27,querystring:30}],39:[function(t,e,r){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],40:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),u=n(t("ismobilejs")),l=n(t("./accessibleTarget"));s.utils.mixins.delayMixin(s.DisplayObject.prototype,l.default);var c=100,v=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),!u.default.tablet&&!u.default.phone||navigator.isCocoonJS||this.createTouchHook();var r=document.createElement("div");r.style.width=c+"px",r.style.height=c+"px",r.style.position="absolute",r.style.top="0px",r.style.left="0px",r.style.zIndex=2,this.div=r,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessabillity=!0,t.activate(),document.body.removeChild(e)}),document.body.appendChild(e)},t.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},t.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}},t.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,r=t.height/this.renderer.height,n=this.div;n.style.left=t.left+"px",n.style.top=t.top+"px",n.style.width=this.renderer.width+"px",n.style.height=this.renderer.height+"px";for(var i=0;i<this.children.length;i++){var o=this.children[i];if(o.renderId!==this.renderId)o._accessibleActive=!1,s.utils.removeItems(this.children,i,1),this.div.removeChild(o._accessibleDiv),this.pool.push(o._accessibleDiv),o._accessibleDiv=null,i--,0===this.children.length&&this.deactivate();else{n=o._accessibleDiv;var a=o.hitArea,u=o.worldTransform;o.hitArea?(n.style.left=(u.tx+a.x*u.a)*e+"px",n.style.top=(u.ty+a.y*u.d)*r+"px",n.style.width=a.width*u.a*e+"px",n.style.height=a.height*u.d*r+"px"):(a=o.getBounds(),this.capHitArea(a),n.style.left=a.x*e+"px",n.style.top=a.y*r+"px",n.style.width=a.width*e+"px",n.style.height=a.height*r+"px",n.title!==o.accessibleTitle&&null!==o.accessibleTitle&&(n.title=o.accessibleTitle),n.getAttribute("aria-label")!==o.accessibleHint&&null!==o.accessibleHint&&n.setAttribute("aria-label",o.accessibleHint))}}this.renderId++}},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width=c+"px",e.style.height=c+"px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",-1<navigator.userAgent.toLowerCase().indexOf("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,(t._accessibleDiv=e).displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}();r.default=v,s.WebGLRenderer.registerPlugin("accessibility",v),s.CanvasRenderer.registerPlugin("accessibility",v)},{"../core":65,"./accessibleTarget":41,ismobilejs:4}],41:[function(t,e,r){"use strict";r.__esModule=!0,r.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],42:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./accessibleTarget");Object.defineProperty(r,"accessibleTarget",{enumerable:!0,get:function(){return n(i).default}});var o=t("./AccessibilityManager");Object.defineProperty(r,"AccessibilityManager",{enumerable:!0,get:function(){return n(o).default}})},{"./AccessibilityManager":40,"./accessibleTarget":41}],43:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("./autoDetectRenderer"),u=n(t("./display/Container")),h=t("./ticker"),c=n(t("./settings")),d=t("./const"),f=function(){function t(e,r,n,o,a){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),"number"==typeof e&&(e=Object.assign({width:e,height:r||c.default.RENDER_OPTIONS.height,forceCanvas:!!o,sharedTicker:!!a},n)),this._options=e=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},e),this.renderer=(0,s.autoDetectRenderer)(e),this.stage=new u.default,this._ticker=null,this.ticker=e.sharedTicker?h.shared:new h.Ticker,e.autoStart&&this.start()}return t.prototype.render=function(){this.renderer.render(this.stage)},t.prototype.stop=function(){this._ticker.stop()},t.prototype.start=function(){this._ticker.start()},t.prototype.destroy=function(t,e){if(this._ticker){var r=this._ticker;this.ticker=null,r.destroy()}this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},o(t,[{key:"ticker",set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,d.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),t}();r.default=f},{"./autoDetectRenderer":45,"./const":46,"./display/Container":48,"./settings":101,"./ticker":121}],44:[function(t,e,r){"use strict";function s(t,e){if(t instanceof Array){if("precision"!==t[0].substring(0,9)){var r=t.slice(0);return r.unshift("precision "+e+" float;"),r}}else if("precision"!==t.trim().substring(0,9))return"precision "+e+" float;\n"+t;return t}r.__esModule=!0;var a=t("pixi-gl-core"),h=function(t){return t&&t.__esModule?t:{default:t}}(t("./settings")),l=function(t){function e(r,o,a,u,l){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,s(o,l||h.default.PRECISION_VERTEX),s(a,l||h.default.PRECISION_FRAGMENT),void 0,u))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(a.GLShader);r.default=l},{"./settings":101,"pixi-gl-core":15}],45:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.autoDetectRenderer=function(t,e,r,n){var i=t&&t.forceCanvas;return void 0!==n&&(i=n),!i&&s.isWebGLSupported()?new l.default(t,e,r):new u.default(t,e,r)};var s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("./utils")),u=n(t("./renderers/canvas/CanvasRenderer")),l=n(t("./renderers/webgl/WebGLRenderer"))},{"./renderers/canvas/CanvasRenderer":77,"./renderers/webgl/WebGLRenderer":84,"./utils":125}],46:[function(t,e,r){"use strict";r.__esModule=!0,r.VERSION="4.8.7",r.PI_2=2*Math.PI,r.RAD_TO_DEG=180/Math.PI,r.DEG_TO_RAD=Math.PI/180,r.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},r.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},r.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},r.SCALE_MODES={LINEAR:0,NEAREST:1},r.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},r.GC_MODES={AUTO:0,MANUAL:1},r.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,r.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i,r.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,r.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},r.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},r.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},r.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},r.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],47:[function(t,e,r){"use strict";r.__esModule=!0;var i=t("../math"),o=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?i.Rectangle.EMPTY:((t=t||new i.Rectangle(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,r=this.minY,n=this.maxX,i=this.maxY,o=t[0],s=t[1];e=o<e?o:e,r=s<r?s:r,n=n<o?o:n,i=i<s?s:i,e=(o=t[2])<e?o:e,r=(s=t[3])<r?s:r,n=n<o?o:n,i=i<s?s:i,e=(o=t[4])<e?o:e,r=(s=t[5])<r?s:r,n=n<o?o:n,i=i<s?s:i,e=(o=t[6])<e?o:e,r=(s=t[7])<r?s:r,n=n<o?o:n,i=i<s?s:i,this.minX=e,this.minY=r,this.maxX=n,this.maxY=i},t.prototype.addFrame=function(t,e,r,n,i){var o=t.worldTransform,s=o.a,a=o.b,u=o.c,h=o.d,l=o.tx,c=o.ty,d=this.minX,f=this.minY,p=this.maxX,v=this.maxY,g=s*e+u*r+l,y=a*e+h*r+c;d=g<d?g:d,f=y<f?y:f,p=p<g?g:p,v=v<y?y:v,d=(g=s*n+u*r+l)<d?g:d,f=(y=a*n+h*r+c)<f?y:f,p=p<g?g:p,v=v<y?y:v,d=(g=s*e+u*i+l)<d?g:d,f=(y=a*e+h*i+c)<f?y:f,p=p<g?g:p,v=v<y?y:v,d=(g=s*n+u*i+l)<d?g:d,f=(y=a*n+h*i+c)<f?y:f,p=p<g?g:p,v=v<y?y:v,this.minX=d,this.minY=f,this.maxX=p,this.maxY=v},t.prototype.addVertices=function(t,e,r,n){for(var i=t.worldTransform,o=i.a,s=i.b,a=i.c,u=i.d,h=i.tx,l=i.ty,c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,v=r;v<n;v+=2){var g=e[v],y=e[v+1],m=o*g+a*y+h,_=u*y+s*g+l;c=m<c?m:c,d=_<d?_:d,f=f<m?m:f,p=p<_?_:p}this.minX=c,this.minY=d,this.maxX=f,this.maxY=p},t.prototype.addBounds=function(t){var e=this.minX,r=this.minY,n=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>i?t.maxY:i},t.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=i&&n<=o){var s=this.minX,a=this.minY,u=this.maxX,h=this.maxY;this.minX=r<s?r:s,this.minY=n<a?n:a,this.maxX=u<i?i:u,this.maxY=h<o?o:h}},t.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=i&&n<=o){var s=this.minX,a=this.minY,u=this.maxX,h=this.maxY;this.minX=r<s?r:s,this.minY=n<a?n:a,this.maxX=u<i?i:u,this.maxY=h<o?o:h}},t}();r.default=o},{"../math":70}],48:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("../utils"),l=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.children=[],r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments.length;if(1<e)for(var r=0;r<e;r++)this.addChild(arguments[r]);else t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),n=this.getChildIndex(e);this.children[r]=e,this.children[n]=t,this.onChildrenChange(r<n?r:n)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);(0,a.removeItems)(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments.length;if(1<e)for(var r=0;r<e;r++)this.removeChild(arguments[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,(0,a.removeItems)(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,(0,a.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),e},e.prototype.removeChildren=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],r=t,n="number"==typeof e?e:this.children.length,i=n-r,o=void 0;if(0<i&&i<=n){o=this.children.splice(r,i);for(var s=0;s<o.length;++s)o[s].parent=null,o[s].transform&&(o[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<o.length;++a)o[a].emit("removed",this);return o}if(0==i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(t);else{this._renderWebGL(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].renderWebGL(t)}},e.prototype.renderAdvancedWebGL=function(t){t.flush();var e=this._filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var n=this._enabledFilters.length=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filterManager.pushFilter(this,this._enabledFilters)}r&&t.maskManager.pushMask(this,this._mask),this._renderWebGL(t);for(var i=0,o=this.children.length;i<o;i++)this.children[i].renderWebGL(t);t.flush(),r&&t.maskManager.popMask(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filterManager.popFilter()},e.prototype._renderWebGL=function(t){},e.prototype._renderCanvas=function(t){},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},e.prototype.destroy=function(e){t.prototype.destroy.call(this);var r="boolean"==typeof e?e:e&&e.children,n=this.removeChildren(0,this.children.length);if(r)for(var i=0;i<n.length;++i)n[i].destroy(e)},s(e,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("./DisplayObject")).default);(r.default=l).prototype.containerUpdateTransform=l.prototype.updateTransform},{"../utils":125,"./DisplayObject":49}],49:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),h=n(t("eventemitter3")),l=t("../const"),d=n(t("../settings")),p=n(t("./TransformStatic")),g=n(t("./Transform")),m=n(t("./Bounds")),_=t("../math"),b=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this)),n=d.default.TRANSFORM_MODE===l.TRANSFORM_MODE.STATIC?p.default:g.default;return r.tempDisplayObjectParent=null,r.transform=new n,r.alpha=1,r.visible=!0,r.renderable=!0,r.parent=null,r.worldAlpha=1,r.filterArea=null,r._filters=null,r._enabledFilters=null,r._bounds=new m.default,r._boundsID=0,r._lastBoundsID=-1,r._boundsRect=null,r._localBoundsRect=null,r._mask=null,r._destroyed=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new _.Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new _.Rectangle),t=this._localBoundsRect);var n=this.getBounds(!1,t);return this.parent=r,this.transform=e,n},e.prototype.toGlobal=function(t,e){return 2<arguments.length&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,n){return e&&(t=e.toGlobal(t,r,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.renderWebGL=function(t){},e.prototype.renderCanvas=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,a=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,u=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=n||1,this.rotation=i,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=u,this},e.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},a(e,[{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(t){this.transform.position.copy(t)}},{key:"scale",get:function(){return this.transform.scale},set:function(t){this.transform.scale.copy(t)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copy(t)}},{key:"skew",get:function(){return this.transform.skew},set:function(t){this.transform.skew.copy(t)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"worldVisible",get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0,this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}]),e}(h.default);(r.default=b).prototype.displayObjectUpdateTransform=b.prototype.updateTransform},{"../const":46,"../math":70,"../settings":101,"./Bounds":47,"./Transform":50,"./TransformStatic":52,eventemitter3:3}],50:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("../math"),l=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.position=new a.Point(0,0),r.scale=new a.Point(1,1),r.skew=new a.ObservablePoint(r.updateSkew,r,0,0),r.pivot=new a.Point(0,0),r._rotation=0,r._cx=1,r._sx=0,r._cy=0,r._sy=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},e.prototype.updateLocalTransform=function(){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d)},e.prototype.updateTransform=function(t){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d);var r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._worldID++},e.prototype.setFromMatrix=function(t){t.decompose(this)},s(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("./TransformBase")).default);r.default=l},{"../math":70,"./TransformBase":51}],51:[function(t,e,r){"use strict";r.__esModule=!0;var i=t("../math"),o=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.worldTransform=new i.Matrix,this.localTransform=new i.Matrix,this._worldID=0,this._parentID=0}return t.prototype.updateLocalTransform=function(){},t.prototype.updateTransform=function(t){var e=t.worldTransform,r=this.worldTransform,n=this.localTransform;r.a=n.a*e.a+n.b*e.c,r.b=n.a*e.b+n.b*e.d,r.c=n.c*e.a+n.d*e.c,r.d=n.c*e.b+n.d*e.d,r.tx=n.tx*e.a+n.ty*e.c+e.tx,r.ty=n.tx*e.b+n.ty*e.d+e.ty,this._worldID++},t}();(r.default=o).prototype.updateWorldTransform=o.prototype.updateTransform,o.IDENTITY=new o},{"../math":70}],52:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("../math"),l=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.position=new a.ObservablePoint(r.onChange,r,0,0),r.scale=new a.ObservablePoint(r.onChange,r,1,1),r.pivot=new a.ObservablePoint(r.onChange,r,0,0),r.skew=new a.ObservablePoint(r.updateSkew,r,0,0),r._rotation=0,r._cx=1,r._sx=0,r._cy=0,r._sy=1,r._localID=0,r._currentLocalID=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},e.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},e.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},s(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}}]),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("./TransformBase")).default);r.default=l},{"../math":70,"./TransformBase":51}],53:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("../display/Container")),l=n(t("../textures/RenderTexture")),d=n(t("../textures/Texture")),p=n(t("./GraphicsData")),g=n(t("../sprites/Sprite")),y=t("../math"),m=t("../utils"),_=t("../const"),x=n(t("../display/Bounds")),w=n(t("./utils/bezierCurveTo")),S=n(t("../renderers/canvas/CanvasRenderer")),O=void 0,M=new y.Matrix,P=new y.Point,C=new Float32Array(4),R=new Float32Array(4),A=function(t){function e(){var r=0<arguments.length&&void 0!==arguments[0]&&arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n.fillAlpha=1,n.lineWidth=0,n.nativeLines=r,n.lineColor=0,n.lineAlignment=.5,n.graphicsData=[],n.tint=16777215,n._prevTint=16777215,n.blendMode=_.BLEND_MODES.NORMAL,n.currentPath=null,n._webGL={},n.isMask=!1,n.boundsPadding=0,n._localBounds=new x.default,n.dirty=0,n.fastRectDirty=-1,n.clearDirty=0,n.boundsDirty=-1,n.cachedSpriteDirty=!1,n._spriteRect=null,n._fastRect=!1,n._prevRectTint=null,n._prevRectFillColor=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.clone=function(){var t=new e;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.lineAlignment=this.lineAlignment,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var r=0;r<this.graphicsData.length;++r)t.graphicsData.push(this.graphicsData[r].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},e.prototype._quadraticCurveLength=function(t,e,r,n,i,o){var s=t-2*r+i,a=e-2*n+o,u=2*r-2*t,h=2*n-2*e,l=4*(s*s+a*a),c=4*(s*u+a*h),d=u*u+h*h,f=2*Math.sqrt(l+c+d),p=Math.sqrt(l),v=2*l*p,g=2*Math.sqrt(d),y=c/p;return(v*f+p*c*(f-g)+(4*d*l-c*c)*Math.log((2*p+y+f)/(y+g)))/(4*v)},e.prototype._bezierCurveLength=function(t,e,r,n,i,o,s,a){for(var u=0,h=0,l=0,c=0,d=0,f=0,p=0,v=0,g=0,y=0,m=0,_=t,b=e,x=1;x<=10;++x)y=_-(v=(p=(f=(d=1-(h=x/10))*d)*d)*t+3*f*h*r+3*d*(l=h*h)*i+(c=l*h)*s),m=b-(g=p*e+3*f*h*n+3*d*l*o+c*a),_=v,b=g,u+=Math.sqrt(y*y+m*m);return u},e.prototype._segmentsCount=function(t){var r=Math.ceil(t/e.CURVES.maxLength);return r<e.CURVES.minSegments?r=e.CURVES.minSegments:r>e.CURVES.maxSegments&&(r=e.CURVES.maxSegments),r},e.prototype.lineStyle=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:.5;if(this.lineWidth=t,this.lineColor=e,this.lineAlpha=r,this.lineAlignment=n,this.currentPath)if(this.currentPath.shape.points.length){var i=new y.Polygon(this.currentPath.shape.points.slice(-2));i.closed=!1,this.drawShape(i)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha,this.currentPath.lineAlignment=this.lineAlignment;return this},e.prototype.moveTo=function(t,e){var r=new y.Polygon([t,e]);return r.closed=!1,this.drawShape(r),this},e.prototype.lineTo=function(t,e){var r=this.currentPath.shape.points,n=r[r.length-2],i=r[r.length-1];return n===t&&i===e||(r.push(t,e),this.dirty++),this},e.prototype.quadraticCurveTo=function(t,r,n,i){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=this.currentPath.shape.points,s=0,a=0;0===o.length&&this.moveTo(0,0);for(var u=o[o.length-2],h=o[o.length-1],l=e.CURVES.adaptive?this._segmentsCount(this._quadraticCurveLength(u,h,t,r,n,i)):20,c=1;c<=l;++c){var d=c/l;s=u+(t-u)*d,a=h+(r-h)*d,o.push(s+(t+(n-t)*d-s)*d,a+(r+(i-r)*d-a)*d)}return this.dirty++,this},e.prototype.bezierCurveTo=function(t,r,n,i,o,s){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var a=this.currentPath.shape.points,u=a[a.length-2],h=a[a.length-1];a.length-=2;var l=e.CURVES.adaptive?this._segmentsCount(this._bezierCurveLength(u,h,t,r,n,i,o,s)):20;return(0,w.default)(u,h,t,r,n,i,o,s,l,a),this.dirty++,this},e.prototype.arcTo=function(t,e,r,n,i){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o=this.currentPath.shape.points,s=o[o.length-2],u=o[o.length-1]-e,h=s-t,l=n-e,c=r-t,d=Math.abs(u*c-h*l);if(d<1e-8||0===i)o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e);else{var f=u*u+h*h,p=l*l+c*c,v=u*l+h*c,g=i*Math.sqrt(f)/d,y=i*Math.sqrt(p)/d,m=g*v/f,_=y*v/p,b=g*c+y*h,x=g*l+y*u,T=h*(y+m),w=u*(y+m),E=c*(g+_),S=l*(g+_),O=Math.atan2(w-x,T-b),M=Math.atan2(S-x,E-b);this.arc(b+t,x+e,i,O,M,c*u<h*l)}return this.dirty++,this},e.prototype.arc=function(t,r,n,i,o){var s=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(i===o)return this;!s&&o<=i?o+=_.PI_2:s&&i<=o&&(i+=_.PI_2);var a=o-i,u=e.CURVES.adaptive?this._segmentsCount(Math.abs(a)*n):40*Math.ceil(Math.abs(a)/_.PI_2);if(0==a)return this;var h=t+Math.cos(i)*n,l=r+Math.sin(i)*n,c=this.currentPath?this.currentPath.shape.points:null;if(c){var d=Math.abs(c[c.length-2]-h),f=Math.abs(c[c.length-1]-l);d<.001&&f<.001||c.push(h,l)}else this.moveTo(h,l),c=this.currentPath.shape.points;for(var p=a/(2*u),v=2*p,g=Math.cos(p),y=Math.sin(p),m=u-1,b=m%1/m,x=0;x<=m;++x){var w=p+i+v*(x+b*x),E=Math.cos(w),S=-Math.sin(w);c.push((g*E+y*S)*n+t,(g*-S+y*E)*n+r)}return this.dirty++,this},e.prototype.beginFill=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=t,this.fillAlpha=e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},e.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.prototype.drawRect=function(t,e,r,n){return this.drawShape(new y.Rectangle(t,e,r,n)),this},e.prototype.drawRoundedRect=function(t,e,r,n,i){return this.drawShape(new y.RoundedRectangle(t,e,r,n,i)),this},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new y.Circle(t,e,r)),this},e.prototype.drawEllipse=function(t,e,r,n){return this.drawShape(new y.Ellipse(t,e,r,n)),this},e.prototype.drawPolygon=function(t){var e=t,r=!0;if(e instanceof y.Polygon&&(r=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}var i=new y.Polygon(e);return i.closed=r,this.drawShape(i),this},e.prototype.drawStar=function(t,e,r,n,i){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;i=i||n/2;for(var s=-1*Math.PI/2+o,a=2*r,u=_.PI_2/a,h=[],l=0;l<a;l++){var c=l%2?i:n,d=l*u+s;h.push(t+c*Math.cos(d),e+c*Math.sin(d))}return this.drawPolygon(h)},e.prototype.clear=function(){return(this.lineWidth||this.filling||0<this.graphicsData.length)&&(this.lineWidth=0,this.lineAlignment=.5,this.filling=!1,this.boundsDirty=-1,this.canvasTintDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},e.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===_.SHAPES.RECT&&!this.graphicsData[0].lineWidth},e.prototype._renderWebGL=function(t){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(t):(t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this))},e.prototype._renderSpriteRect=function(t){var e=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new g.default(new d.default(d.default.WHITE)));var r=this._spriteRect,n=this.graphicsData[0].fillColor;if(16777215===this.tint)r.tint=n;else if(this.tint!==this._prevRectTint||n!==this._prevRectFillColor){var i=C,o=R;(0,m.hex2rgb)(n,i),(0,m.hex2rgb)(this.tint,o),i[0]*=o[0],i[1]*=o[1],i[2]*=o[2],r.tint=(0,m.rgb2hex)(i),this._prevRectTint=this.tint,this._prevRectFillColor=n}r.alpha=this.graphicsData[0].fillAlpha,r.worldAlpha=this.worldAlpha*r.alpha,r.blendMode=this.blendMode,r._texture._frame.width=e.width,r._texture._frame.height=e.height,r.transform.worldTransform=this.transform.worldTransform,r.anchor.set(-e.x/e.width,-e.y/e.height),r._onAnchorUpdate(),r._renderWebGL(t)},e.prototype._renderCanvas=function(t){!0!==this.isMask&&t.plugins.graphics.render(this)},e.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var t=this._localBounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,P);for(var e=this.graphicsData,r=0;r<e.length;++r){var n=e[r];if(n.fill&&n.shape&&n.shape.contains(P.x,P.y)){if(n.holes)for(var i=0;i<n.holes.length;i++){if(n.holes[i].contains(P.x,P.y))return!1}return!0}}return!1},e.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,r=1/0,n=-1/0;if(this.graphicsData.length)for(var i=0,o=0,s=0,a=0,u=0,h=0;h<this.graphicsData.length;h++){var l=this.graphicsData[h],c=l.type,p=l.lineWidth*l.lineAlignment;if(i=l.shape,c===_.SHAPES.RECT||c===_.SHAPES.RREC)o=i.x-p,s=i.y-p,t=o<t?o:t,e=e<o+(a=i.width+2*p)?o+a:e,r=s<r?s:r,n=n<s+(u=i.height+2*p)?s+u:n;else if(c===_.SHAPES.CIRC)o=i.x,s=i.y,t=o-(a=i.radius+p)<t?o-a:t,e=e<o+a?o+a:e,r=s-(u=i.radius+p)<r?s-u:r,n=n<s+u?s+u:n;else if(c===_.SHAPES.ELIP)o=i.x,s=i.y,t=o-(a=i.width+p)<t?o-a:t,e=e<o+a?o+a:e,r=s-(u=i.height+p)<r?s-u:r,n=n<s+u?s+u:n;else for(var v=i.points,g=0,y=0,m=0,b=0,x=0,T=0,w=0,E=0,S=0;S+2<v.length;S+=2)o=v[S],s=v[S+1],g=v[S+2],y=v[S+3],m=Math.abs(g-o),b=Math.abs(y-s),u=2*p,(a=Math.sqrt(m*m+b*b))<1e-9||(t=(w=(g+o)/2)-(x=(u/a*b+m)/2)<t?w-x:t,e=e<w+x?w+x:e,r=(E=(y+s)/2)-(T=(u/a*m+b)/2)<r?E-T:r,n=n<E+T?E+T:n)}else n=r=e=t=0;var O=this.boundsPadding;this._localBounds.minX=t-O,this._localBounds.maxX=e+O,this._localBounds.minY=r-O,this._localBounds.maxY=n+O},e.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new p.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,t,this.lineAlignment);return this.graphicsData.push(e),e.type===_.SHAPES.POLY&&(e.shape.closed=e.shape.closed,this.currentPath=e),this.dirty++,e},e.prototype.generateCanvasTexture=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=this.getLocalBounds(),n=l.default.create(r.width,r.height,t,e);O||(O=new S.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(M),M.invert(),M.tx-=r.x,M.ty-=r.y,O.render(this,n,!0,M);var i=d.default.fromCanvas(n.baseTexture._canvasRenderTarget.canvas,t,"graphics");return i.baseTexture.resolution=e,i.baseTexture.update(),i},e.prototype.closePath=function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this},e.prototype.addHole=function(){var t=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(t.shape),this.currentPath=null,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var r=0;r<this.graphicsData.length;++r)this.graphicsData[r].destroy();for(var n in this._webGL)for(var i=0;i<this._webGL[n].data.length;++i)this._webGL[n].data[i].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webGL=null,this._localBounds=null},e}(u.default);(r.default=A)._SPRITE_TEXTURE=null,A.CURVES={adaptive:!1,maxLength:10,minSegments:8,maxSegments:2048}},{"../const":46,"../display/Bounds":47,"../display/Container":48,"../math":70,"../renderers/canvas/CanvasRenderer":77,"../sprites/Sprite":102,"../textures/RenderTexture":113,"../textures/Texture":115,"../utils":125,"./GraphicsData":54,"./utils/bezierCurveTo":56}],54:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(e,r,i,o,s,a,u,h,l){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.lineWidth=e,this.lineAlignment=l,this.nativeLines=u,this.lineColor=r,this.lineAlpha=i,this._lineTint=r,this.fillColor=o,this.fillAlpha=s,this._fillTint=o,this.fill=a,this.holes=[],this.shape=h,this.type=h.type}return t.prototype.clone=function(){return new t(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape,this.lineAlignment)},t.prototype.addHole=function(t){this.holes.push(t)},t.prototype.destroy=function(){this.shape=null,this.holes=null},t}();r.default=i},{}],55:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("../../renderers/canvas/CanvasRenderer")),s=t("../../const"),a=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,r=e.context,n=t.worldAlpha,i=t.transform.worldTransform,o=e.resolution;r.setTransform(i.a*o,i.b*o,i.c*o,i.d*o,i.tx*o,i.ty*o),t.canvasTintDirty===t.dirty&&t._prevTint===t.tint||this.updateGraphicsTint(t),e.setBlendMode(t.blendMode);for(var a=0;a<t.graphicsData.length;a++){var u=t.graphicsData[a],h=u.shape,l=u._fillTint,c=u._lineTint;if(r.lineWidth=u.lineWidth,u.type===s.SHAPES.POLY){r.beginPath();var d=h.points,f=u.holes,p=void 0,v=void 0;r.moveTo(d[0],d[1]);for(var g=2;g<d.length;g+=2)r.lineTo(d[g],d[g+1]);if(h.closed&&r.closePath(),0<f.length){for(var y=p=0;y<d.length;y+=2)p+=d[y]*d[y+3]-d[y+1]*d[y+2];for(var m=0;m<f.length;m++){d=f[m].points;for(var _=v=0;_<d.length;_+=2)v+=d[_]*d[_+3]-d[_+1]*d[_+2];if(r.moveTo(d[0],d[1]),v*p<0)for(var b=2;b<d.length;b+=2)r.lineTo(d[b],d[b+1]);else for(var x=d.length-2;2<=x;x-=2)r.lineTo(d[x],d[x+1]);f[m].closed&&r.closePath()}}u.fill&&(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}else if(u.type===s.SHAPES.RECT)!u.fillColor&&0!==u.fillColor||(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fillRect(h.x,h.y,h.width,h.height)),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.strokeRect(h.x,h.y,h.width,h.height));else if(u.type===s.SHAPES.CIRC)r.beginPath(),r.arc(h.x,h.y,h.radius,0,2*Math.PI),r.closePath(),u.fill&&(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke());else if(u.type===s.SHAPES.ELIP){var T=2*h.width,w=2*h.height,E=h.x-T/2,S=h.y-w/2;r.beginPath();var O=T/2*.5522848,M=w/2*.5522848,P=E+T,C=S+w,R=E+T/2,A=S+w/2;r.moveTo(E,A),r.bezierCurveTo(E,A-M,R-O,S,R,S),r.bezierCurveTo(R+O,S,P,A-M,P,A),r.bezierCurveTo(P,A+M,R+O,C,R,C),r.bezierCurveTo(R-O,C,E,A+M,E,A),r.closePath(),u.fill&&(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}else if(u.type===s.SHAPES.RREC){var I=h.x,D=h.y,L=h.width,N=h.height,B=h.radius,k=Math.min(L,N)/2|0;B=k<B?k:B,r.beginPath(),r.moveTo(I,D+B),r.lineTo(I,D+N-B),r.quadraticCurveTo(I,D+N,I+B,D+N),r.lineTo(I+L-B,D+N),r.quadraticCurveTo(I+L,D+N,I+L,D+N-B),r.lineTo(I+L,D+B),r.quadraticCurveTo(I+L,D,I+L-B,D),r.lineTo(I+B,D),r.quadraticCurveTo(I,D,I,D+B),r.closePath(),!u.fillColor&&0!==u.fillColor||(r.globalAlpha=u.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),u.lineWidth&&(r.globalAlpha=u.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}}},t.prototype.updateGraphicsTint=function(t){t._prevTint=t.tint,t.canvasTintDirty=t.dirty;for(var e=(t.tint>>16&255)/255,r=(t.tint>>8&255)/255,n=(255&t.tint)/255,i=0;i<t.graphicsData.length;++i){var o=t.graphicsData[i],s=0|o.fillColor,a=0|o.lineColor;o._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*r*255<<8)+(255&s)/255*n*255,o._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*r*255<<8)+(255&a)/255*n*255}},t.prototype.renderPolygon=function(t,e,r){r.moveTo(t[0],t[1]);for(var n=1;n<t.length/2;++n)r.lineTo(t[2*n],t[2*n+1]);e&&r.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();r.default=a,o.default.registerPlugin("graphics",a)},{"../../const":46,"../../renderers/canvas/CanvasRenderer":77}],56:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e,r,n,i,o,s,a,u){var h=9<arguments.length&&void 0!==arguments[9]?arguments[9]:[],l=0,c=0,d=0,f=0,p=0;h.push(t,e);for(var v=1,g=0;v<=u;++v)d=(c=(l=1-(g=v/u))*l)*l,p=(f=g*g)*g,h.push(d*t+3*c*g*r+3*l*f*i+p*s,d*e+3*c*g*n+3*l*f*o+p*a);return h}},{}],57:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=t("../../utils"),u=t("../../const"),l=n(t("../../renderers/webgl/utils/ObjectRenderer")),d=n(t("../../renderers/webgl/WebGLRenderer")),p=n(t("./WebGLGraphicsData")),g=n(t("./shaders/PrimitiveShader")),m=n(t("./utils/buildPoly")),b=n(t("./utils/buildRectangle")),T=n(t("./utils/buildRoundedRectangle")),E=n(t("./utils/buildCircle")),S=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.graphicsDataPool=[],n.primitiveShader=null,n.gl=r.gl,n.CONTEXT_UID=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new g.default(this.gl)},e.prototype.destroy=function(){l.default.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},e.prototype.render=function(t){var e=this.renderer,r=e.gl,n=void 0,i=t._webGL[this.CONTEXT_UID];i&&t.dirty===i.dirty||(this.updateGraphics(t),i=t._webGL[this.CONTEXT_UID]);var o=this.primitiveShader;e.bindShader(o),e.state.setBlendMode(t.blendMode);for(var s=0,u=i.data.length;s<u;s++){var h=(n=i.data[s]).shader;e.bindShader(h),h.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),h.uniforms.tint=(0,a.hex2rgb)(t.tint),h.uniforms.alpha=t.worldAlpha,e.bindVao(n.vao),n.nativeLines?r.drawArrays(r.LINES,0,n.points.length/6):n.vao.draw(r.TRIANGLE_STRIP,n.indices.length)}},e.prototype.updateGraphics=function(t){var e=this.renderer.gl,r=t._webGL[this.CONTEXT_UID];if(r||(r=t._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:e,clearDirty:-1,dirty:-1}),r.dirty=t.dirty,t.clearDirty!==r.clearDirty){r.clearDirty=t.clearDirty;for(var n=0;n<r.data.length;n++)this.graphicsDataPool.push(r.data[n]);r.data.length=0,r.lastIndex=0}for(var i=void 0,o=void 0,s=r.lastIndex;s<t.graphicsData.length;s++){var a=t.graphicsData[s];i=this.getWebGLData(r,0),a.nativeLines&&a.lineWidth&&(o=this.getWebGLData(r,0,!0),r.lastIndex++),a.type===u.SHAPES.POLY&&(0,m.default)(a,i,o),a.type===u.SHAPES.RECT?(0,b.default)(a,i,o):a.type===u.SHAPES.CIRC||a.type===u.SHAPES.ELIP?(0,E.default)(a,i,o):a.type===u.SHAPES.RREC&&(0,T.default)(a,i,o),r.lastIndex++}this.renderer.bindVao(null);for(var h=0;h<r.data.length;h++)(i=r.data[h]).dirty&&i.upload()},e.prototype.getWebGLData=function(t,e,r){var n=t.data[t.data.length-1];return(!n||n.nativeLines!==r||32e4<n.points.length)&&((n=this.graphicsDataPool.pop()||new p.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState)).nativeLines=r,n.reset(e),t.data.push(n)),n.dirty=!0,n},e}(l.default);r.default=S,d.default.registerPlugin("graphics",S)},{"../../const":46,"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../utils":125,"./WebGLGraphicsData":58,"./shaders/PrimitiveShader":59,"./utils/buildCircle":60,"./utils/buildPoly":62,"./utils/buildRectangle":63,"./utils/buildRoundedRectangle":64}],58:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("pixi-gl-core")),s=function(){function t(e,r,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=o.default.GLBuffer.createVertexBuffer(e),this.indexBuffer=o.default.GLBuffer.createIndexBuffer(e),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=r,this.vao=new o.default.VertexArrayObject(e,i).addIndex(this.indexBuffer).addAttribute(this.buffer,r.attributes.aVertexPosition,e.FLOAT,!1,24,0).addAttribute(this.buffer,r.attributes.aColor,e.FLOAT,!1,24,8)}return t.prototype.reset=function(){this.points.length=0,this.indices.length=0},t.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},t.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},t}();r.default=s},{"pixi-gl-core":15}],59:[function(t,e,r){"use strict";r.__esModule=!0;var u=function(t){function e(r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("../../../Shader")).default);r.default=u},{"../../../Shader":44}],60:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e,r){var n=t.shape,i=n.x,u=n.y,h=void 0,l=void 0;if(l=t.type===s.SHAPES.CIRC?(h=n.radius,n.radius):(h=n.width,n.height),0!==h&&0!==l){var c=Math.floor(30*Math.sqrt(n.radius))||Math.floor(15*Math.sqrt(n.width+n.height)),d=2*Math.PI/c;if(t.fill){var f=(0,a.hex2rgb)(t.fillColor),p=t.fillAlpha,v=f[0]*p,g=f[1]*p,y=f[2]*p,m=e.points,_=e.indices,b=m.length/6;_.push(b);for(var x=0;x<c+1;x++)m.push(i,u,v,g,y,p),m.push(i+Math.sin(d*x)*h,u+Math.cos(d*x)*l,v,g,y,p),_.push(b++,b++);_.push(b-1)}if(t.lineWidth){var T=t.points;t.points=[];for(var w=0;w<c;w++)t.points.push(i+Math.sin(d*-w)*h,u+Math.cos(d*-w)*l);t.points.push(t.points[0],t.points[1]),(0,o.default)(t,e,r),t.points=T}}};var o=function(t){return t&&t.__esModule?t:{default:t}}(t("./buildLine")),s=t("../../../const"),a=t("../../../utils")},{"../../../const":46,"../../../utils":125,"./buildLine":61}],61:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e,r){t.nativeLines?function(t,e){var r=0,n=t.points;if(0!==n.length){var i=e.points,o=n.length/2,a=(0,s.hex2rgb)(t.lineColor),u=t.lineAlpha,h=a[0]*u,l=a[1]*u,c=a[2]*u;for(r=1;r<o;r++){var d=n[2*(r-1)],f=n[2*(r-1)+1],p=n[2*r],v=n[2*r+1];i.push(d,f),i.push(h,l,c,u),i.push(p,v),i.push(h,l,c,u)}}}(t,r):function(t,e){var r=t.points;if(0!==r.length){var n=new o.Point(r[0],r[1]),i=new o.Point(r[r.length-2],r[r.length-1]);if(n.x===i.x&&n.y===i.y){(r=r.slice()).pop(),r.pop();var a=(i=new o.Point(r[r.length-2],r[r.length-1])).x+.5*(n.x-i.x),u=i.y+.5*(n.y-i.y);r.unshift(a,u),r.push(a,u)}var h=e.points,l=e.indices,c=r.length/2,d=r.length,f=h.length/6,p=t.lineWidth/2,v=(0,s.hex2rgb)(t.lineColor),g=t.lineAlpha,y=v[0]*g,m=v[1]*g,_=v[2]*g,b=r[0],x=r[1],T=r[2],w=r[3],E=0,S=0,O=-(x-w),M=b-T,P=0,C=0,R=0,A=0,I=Math.sqrt(O*O+M*M);O/=I,M/=I,O*=p,M*=p;var D=t.lineAlignment,L=2*(1-D),N=2*D;h.push(b-O*L,x-M*L,y,m,_,g),h.push(b+O*N,x+M*N,y,m,_,g);for(var B=1;B<c-1;++B){b=r[2*(B-1)],x=r[2*(B-1)+1],T=r[2*B],w=r[2*B+1],E=r[2*(B+1)],S=r[2*(B+1)+1],O=-(x-w),M=b-T,O/=I=Math.sqrt(O*O+M*M),M/=I,O*=p,M*=p,P=-(w-S),C=T-E,P/=I=Math.sqrt(P*P+C*C),C/=I;var k=-M+x-(-M+w),F=-O+T-(-O+b),j=(-O+b)*(-M+w)-(-O+T)*(-M+x),U=-(C*=p)+S-(-C+w),X=-(P*=p)+T-(-P+E),G=(-P+E)*(-C+w)-(-P+T)*(-C+S),W=k*X-U*F;if(Math.abs(W)<.1)W+=10.1,h.push(T-O*L,w-M*L,y,m,_,g),h.push(T+O*N,w+M*N,y,m,_,g);else{var H=(F*G-X*j)/W,Y=(U*j-k*G)/W;196*p*p<(H-T)*(H-T)+(Y-w)*(Y-w)?(R=O-P,A=M-C,R/=I=Math.sqrt(R*R+A*A),A/=I,R*=p,A*=p,h.push(T-R*L,w-A*L),h.push(y,m,_,g),h.push(T+R*N,w+A*N),h.push(y,m,_,g),h.push(T-R*N*L,w-A*L),h.push(y,m,_,g),d++):(h.push(T+(H-T)*L,w+(Y-w)*L),h.push(y,m,_,g),h.push(T-(H-T)*N,w-(Y-w)*N),h.push(y,m,_,g))}}b=r[2*(c-2)],x=r[2*(c-2)+1],T=r[2*(c-1)],O=-(x-(w=r[2*(c-1)+1])),M=b-T,O/=I=Math.sqrt(O*O+M*M),M/=I,O*=p,M*=p,h.push(T-O*L,w-M*L),h.push(y,m,_,g),h.push(T+O*N,w+M*N),h.push(y,m,_,g),l.push(f);for(var V=0;V<d;++V)l.push(f++);l.push(f-1)}}(t,e)};var o=t("../../../math"),s=t("../../../utils")},{"../../../math":70,"../../../utils":125}],62:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.default=function(t,e,r){t.points=t.shape.points.slice();var n=t.points;if(t.fill&&6<=n.length){for(var i=[],o=t.holes,u=0;u<o.length;u++){var l=o[u];i.push(n.length/2),n=n.concat(l.points)}var c=e.points,d=e.indices,f=n.length/2,p=(0,a.hex2rgb)(t.fillColor),v=t.fillAlpha,g=p[0]*v,y=p[1]*v,m=p[2]*v,_=(0,h.default)(n,i,2);if(!_)return;for(var b=c.length/6,x=0;x<_.length;x+=3)d.push(_[x]+b),d.push(_[x]+b),d.push(_[x+1]+b),d.push(_[x+2]+b),d.push(_[x+2]+b);for(var T=0;T<f;T++)c.push(n[2*T],n[2*T+1],g,y,m,v)}0<t.lineWidth&&(0,s.default)(t,e,r)};var s=n(t("./buildLine")),a=t("../../../utils"),h=n(t("earcut"))},{"../../../utils":125,"./buildLine":61,earcut:2}],63:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e,r){var n=t.shape,i=n.x,a=n.y,u=n.width,h=n.height;if(t.fill){var l=(0,s.hex2rgb)(t.fillColor),c=t.fillAlpha,d=l[0]*c,f=l[1]*c,p=l[2]*c,v=e.points,g=e.indices,y=v.length/6;v.push(i,a),v.push(d,f,p,c),v.push(i+u,a),v.push(d,f,p,c),v.push(i,a+h),v.push(d,f,p,c),v.push(i+u,a+h),v.push(d,f,p,c),g.push(y,y,1+y,2+y,3+y,3+y)}if(t.lineWidth){var m=t.points;t.points=[i,a,i+u,a,i+u,a+h,i,a+h,i,a],(0,o.default)(t,e,r),t.points=m}};var o=function(t){return t&&t.__esModule?t:{default:t}}(t("./buildLine")),s=t("../../../utils")},{"../../../utils":125,"./buildLine":61}],64:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){return t+(e-t)*r}function s(t,e,r,n,i,s,argument_6){for(var u=6<arguments.length&&void 0!==argument_6?argument_6:[],h=0,l=0,c=0,d=0,f=0,p=0,v=0,g=0;v<=20;++v)h=o(t,r,g=v/20),l=o(e,n,g),c=o(r,i,g),d=o(n,s,g),f=o(h,c,g),p=o(l,d,g),u.push(f,p);return u}r.__esModule=!0,r.default=function(t,e,r){var n=t.shape,i=n.x,o=n.y,a=n.width,h=n.height,d=n.radius,f=[];if(f.push(i+d,o),s(i+a-d,o,i+a,o,i+a,o+d,f),s(i+a,o+h-d,i+a,o+h,i+a-d,o+h,f),s(i+d,o+h,i,o+h,i,o+h-d,f),s(i,o+d,i,o,i+d+1e-10,o,f),t.fill){for(var p=(0,c.hex2rgb)(t.fillColor),v=t.fillAlpha,g=p[0]*v,y=p[1]*v,m=p[2]*v,_=e.points,b=e.indices,x=_.length/6,T=(0,u.default)(f,null,2),w=0,E=T.length;w<E;w+=3)b.push(T[w]+x),b.push(T[w]+x),b.push(T[w+1]+x),b.push(T[w+2]+x),b.push(T[w+2]+x);for(var S=0,O=f.length;S<O;S++)_.push(f[S],f[++S],g,y,m,v)}if(t.lineWidth){var M=t.points;t.points=f,(0,l.default)(t,e,r),t.points=M}};var u=n(t("earcut")),l=n(t("./buildLine")),c=t("../../../utils")},{"../../../utils":125,"./buildLine":61,earcut:2}],65:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.autoDetectRenderer=r.Application=r.Filter=r.SpriteMaskFilter=r.Quad=r.RenderTarget=r.ObjectRenderer=r.WebGLManager=r.Shader=r.CanvasRenderTarget=r.TextureUvs=r.VideoBaseTexture=r.BaseRenderTexture=r.RenderTexture=r.BaseTexture=r.TextureMatrix=r.Texture=r.Spritesheet=r.CanvasGraphicsRenderer=r.GraphicsRenderer=r.GraphicsData=r.Graphics=r.TextMetrics=r.TextStyle=r.Text=r.SpriteRenderer=r.CanvasTinter=r.CanvasSpriteRenderer=r.Sprite=r.TransformBase=r.TransformStatic=r.Transform=r.Container=r.DisplayObject=r.Bounds=r.glCore=r.WebGLRenderer=r.CanvasRenderer=r.ticker=r.utils=r.settings=void 0;var o=t("./const");Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(r,t,{enumerable:!0,get:function(){return o[t]}})});var s=t("./math");Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(r,t,{enumerable:!0,get:function(){return s[t]}})});var a=t("pixi-gl-core");Object.defineProperty(r,"glCore",{enumerable:!0,get:function(){return i(a).default}});var u=t("./display/Bounds");Object.defineProperty(r,"Bounds",{enumerable:!0,get:function(){return i(u).default}});var h=t("./display/DisplayObject");Object.defineProperty(r,"DisplayObject",{enumerable:!0,get:function(){return i(h).default}});var l=t("./display/Container");Object.defineProperty(r,"Container",{enumerable:!0,get:function(){return i(l).default}});var c=t("./display/Transform");Object.defineProperty(r,"Transform",{enumerable:!0,get:function(){return i(c).default}});var d=t("./display/TransformStatic");Object.defineProperty(r,"TransformStatic",{enumerable:!0,get:function(){return i(d).default}});var f=t("./display/TransformBase");Object.defineProperty(r,"TransformBase",{enumerable:!0,get:function(){return i(f).default}});var p=t("./sprites/Sprite");Object.defineProperty(r,"Sprite",{enumerable:!0,get:function(){return i(p).default}});var v=t("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(r,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return i(v).default}});var g=t("./sprites/canvas/CanvasTinter");Object.defineProperty(r,"CanvasTinter",{enumerable:!0,get:function(){return i(g).default}});var y=t("./sprites/webgl/SpriteRenderer");Object.defineProperty(r,"SpriteRenderer",{enumerable:!0,get:function(){return i(y).default}});var m=t("./text/Text");Object.defineProperty(r,"Text",{enumerable:!0,get:function(){return i(m).default}});var _=t("./text/TextStyle");Object.defineProperty(r,"TextStyle",{enumerable:!0,get:function(){return i(_).default}});var b=t("./text/TextMetrics");Object.defineProperty(r,"TextMetrics",{enumerable:!0,get:function(){return i(b).default}});var x=t("./graphics/Graphics");Object.defineProperty(r,"Graphics",{enumerable:!0,get:function(){return i(x).default}});var T=t("./graphics/GraphicsData");Object.defineProperty(r,"GraphicsData",{enumerable:!0,get:function(){return i(T).default}});var w=t("./graphics/webgl/GraphicsRenderer");Object.defineProperty(r,"GraphicsRenderer",{enumerable:!0,get:function(){return i(w).default}});var E=t("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(r,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return i(E).default}});var S=t("./textures/Spritesheet");Object.defineProperty(r,"Spritesheet",{enumerable:!0,get:function(){return i(S).default}});var O=t("./textures/Texture");Object.defineProperty(r,"Texture",{enumerable:!0,get:function(){return i(O).default}});var M=t("./textures/TextureMatrix");Object.defineProperty(r,"TextureMatrix",{enumerable:!0,get:function(){return i(M).default}});var P=t("./textures/BaseTexture");Object.defineProperty(r,"BaseTexture",{enumerable:!0,get:function(){return i(P).default}});var C=t("./textures/RenderTexture");Object.defineProperty(r,"RenderTexture",{enumerable:!0,get:function(){return i(C).default}});var R=t("./textures/BaseRenderTexture");Object.defineProperty(r,"BaseRenderTexture",{enumerable:!0,get:function(){return i(R).default}});var A=t("./textures/VideoBaseTexture");Object.defineProperty(r,"VideoBaseTexture",{enumerable:!0,get:function(){return i(A).default}});var I=t("./textures/TextureUvs");Object.defineProperty(r,"TextureUvs",{enumerable:!0,get:function(){return i(I).default}});var D=t("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(r,"CanvasRenderTarget",{enumerable:!0,get:function(){return i(D).default}});var L=t("./Shader");Object.defineProperty(r,"Shader",{enumerable:!0,get:function(){return i(L).default}});var N=t("./renderers/webgl/managers/WebGLManager");Object.defineProperty(r,"WebGLManager",{enumerable:!0,get:function(){return i(N).default}});var B=t("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(r,"ObjectRenderer",{enumerable:!0,get:function(){return i(B).default}});var k=t("./renderers/webgl/utils/RenderTarget");Object.defineProperty(r,"RenderTarget",{enumerable:!0,get:function(){return i(k).default}});var F=t("./renderers/webgl/utils/Quad");Object.defineProperty(r,"Quad",{enumerable:!0,get:function(){return i(F).default}});var j=t("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(r,"SpriteMaskFilter",{enumerable:!0,get:function(){return i(j).default}});var U=t("./renderers/webgl/filters/Filter");Object.defineProperty(r,"Filter",{enumerable:!0,get:function(){return i(U).default}});var X=t("./Application");Object.defineProperty(r,"Application",{enumerable:!0,get:function(){return i(X).default}});var G=t("./autoDetectRenderer");Object.defineProperty(r,"autoDetectRenderer",{enumerable:!0,get:function(){return G.autoDetectRenderer}});var H=n(t("./utils")),V=n(t("./ticker")),q=i(t("./settings")),Z=i(t("./renderers/canvas/CanvasRenderer")),Q=i(t("./renderers/webgl/WebGLRenderer"));r.settings=q.default,r.utils=H,r.ticker=V,r.CanvasRenderer=Z.default,r.WebGLRenderer=Q.default},{"./Application":43,"./Shader":44,"./autoDetectRenderer":45,"./const":46,"./display/Bounds":47,"./display/Container":48,"./display/DisplayObject":49,"./display/Transform":50,"./display/TransformBase":51,"./display/TransformStatic":52,"./graphics/Graphics":53,"./graphics/GraphicsData":54,"./graphics/canvas/CanvasGraphicsRenderer":55,"./graphics/webgl/GraphicsRenderer":57,"./math":70,"./renderers/canvas/CanvasRenderer":77,"./renderers/canvas/utils/CanvasRenderTarget":79,"./renderers/webgl/WebGLRenderer":84,"./renderers/webgl/filters/Filter":86,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":89,"./renderers/webgl/managers/WebGLManager":93,"./renderers/webgl/utils/ObjectRenderer":94,"./renderers/webgl/utils/Quad":95,"./renderers/webgl/utils/RenderTarget":96,"./settings":101,"./sprites/Sprite":102,"./sprites/canvas/CanvasSpriteRenderer":103,"./sprites/canvas/CanvasTinter":104,"./sprites/webgl/SpriteRenderer":106,"./text/Text":108,"./text/TextMetrics":109,"./text/TextStyle":110,"./textures/BaseRenderTexture":111,"./textures/BaseTexture":112,"./textures/RenderTexture":113,"./textures/Spritesheet":114,"./textures/Texture":115,"./textures/TextureMatrix":116,"./textures/TextureUvs":117,"./textures/VideoBaseTexture":118,"./ticker":121,"./utils":125,"pixi-gl-core":15}],66:[function(t,e,r){"use strict";function n(t){return t<0?-1:0<t?1:0}r.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("./Matrix")),s=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],a=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],u=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],h=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],l=[],c=[];!function(){for(var t=0;t<16;t++){var e=[];c.push(e);for(var r=0;r<16;r++)for(var i=n(s[t]*s[r]+u[t]*a[r]),d=n(a[t]*s[r]+h[t]*a[r]),f=n(s[t]*u[r]+u[t]*h[r]),p=n(a[t]*u[r]+h[t]*h[r]),v=0;v<16;v++)if(s[v]===i&&a[v]===d&&u[v]===f&&h[v]===p){e.push(v);break}}for(var g=0;g<16;g++){var y=new o.default;y.set(s[g],a[g],u[g],h[g],0,0),l.push(y)}}();var d={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return s[t]},uY:function(t){return a[t]},vX:function(t){return u[t]},vY:function(t){return h[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return c[t][e]},sub:function(t,e){return c[t][d.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?d.S:d.N:2*Math.abs(e)<=Math.abs(t)?0<t?d.E:d.W:0<e?0<t?d.SE:d.SW:0<t?d.NE:d.NW},matrixAppendRotationInv:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=l[d.inv(e)];i.tx=r,i.ty=n,t.append(i)}};r.default=d},{"./Matrix":67}],67:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(t){return t&&t.__esModule?t:{default:t}}(t("./Point")),a=t("../const"),u=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.a=e,this.b=r,this.c=i,this.d=o,this.tx=s,this.ty=a,this.array=null}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,n,i,o){return this.a=t,this.b=e,this.c=r,this.d=n,this.tx=i,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0),r[8]=1,r},t.prototype.apply=function(t,e){e=e||new s.default;var r=t.x,n=t.y;return e.x=this.a*r+this.c*n+this.tx,e.y=this.b*r+this.d*n+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new s.default;var r=1/(this.a*this.d+this.c*-this.b),n=t.x,i=t.y;return e.x=this.d*r*n+-this.c*r*i+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*i+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.a,i=this.c,o=this.tx;return this.a=n*e-this.b*r,this.b=n*r+this.b*e,this.c=i*e-this.d*r,this.d=i*r+this.d*e,this.tx=o*e-this.ty*r,this.ty=o*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,n=this.c,i=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*r+t.b*i,this.c=t.c*e+t.d*n,this.d=t.c*r+t.d*i,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*r+t.ty*i+this.ty,this},t.prototype.setTransform=function(t,e,r,n,i,o,s,a,u){return this.a=Math.cos(s+u)*i,this.b=Math.sin(s+u)*i,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(r*this.a+n*this.c),this.ty=e-(r*this.b+n*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,n=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,n=this.c,i=this.d,o=-Math.atan2(-n,i),s=Math.atan2(r,e),u=Math.abs(o+s);return u<1e-5||Math.abs(a.PI_2-u)<1e-5?(t.rotation=s,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=s),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(n*n+i*i),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,n=this.d,i=this.tx,o=t*n-e*r;return this.a=n/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(t*this.ty-e*i)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},i(t,null,[{key:"IDENTITY",get:function(){return new t}},{key:"TEMP_MATRIX",get:function(){return new t}}]),t}();r.default=u},{"../const":46,"./Point":69}],68:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e,r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._x=i,this._y=o,this.cb=e,this.scope=r}return t.prototype.clone=function(){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return new t((0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)||this.cb,r||this.scope,this._x,this._y)},t.prototype.set=function(t,e){var r=t||0,n=e||(0!==e?r:0);this._x===r&&this._y===n||(this._x=r,this._y=n,this.cb.call(this.scope))},t.prototype.copy=function(t){this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope))},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},i(t,[{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}]),t}();r.default=o},{}],69:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=r}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copy=function(t){this.set(t.x,t.y)},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},t}();r.default=i},{}],70:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./Point");Object.defineProperty(r,"Point",{enumerable:!0,get:function(){return n(i).default}});var o=t("./ObservablePoint");Object.defineProperty(r,"ObservablePoint",{enumerable:!0,get:function(){return n(o).default}});var s=t("./Matrix");Object.defineProperty(r,"Matrix",{enumerable:!0,get:function(){return n(s).default}});var a=t("./GroupD8");Object.defineProperty(r,"GroupD8",{enumerable:!0,get:function(){return n(a).default}});var u=t("./shapes/Circle");Object.defineProperty(r,"Circle",{enumerable:!0,get:function(){return n(u).default}});var h=t("./shapes/Ellipse");Object.defineProperty(r,"Ellipse",{enumerable:!0,get:function(){return n(h).default}});var l=t("./shapes/Polygon");Object.defineProperty(r,"Polygon",{enumerable:!0,get:function(){return n(l).default}});var c=t("./shapes/Rectangle");Object.defineProperty(r,"Rectangle",{enumerable:!0,get:function(){return n(c).default}});var d=t("./shapes/RoundedRectangle");Object.defineProperty(r,"RoundedRectangle",{enumerable:!0,get:function(){return n(d).default}})},{"./GroupD8":66,"./Matrix":67,"./ObservablePoint":68,"./Point":69,"./shapes/Circle":71,"./shapes/Ellipse":72,"./shapes/Polygon":73,"./shapes/Rectangle":74,"./shapes/RoundedRectangle":75}],71:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("./Rectangle")),s=t("../../const"),a=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=r,this.radius=i,this.type=s.SHAPES.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,n=this.x-t,i=this.y-e;return(n*=n)+(i*=i)<=r},t.prototype.getBounds=function(){return new o.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}();r.default=a},{"../../const":46,"./Rectangle":74}],72:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("./Rectangle")),s=t("../../const"),a=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=r,this.width=i,this.height=o,this.type=s.SHAPES.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,n=(e-this.y)/this.height;return(r*=r)+(n*=n)<=1},t.prototype.getBounds=function(){return new o.default(this.x-this.width,this.y-this.height,this.width,this.height)},t}();r.default=a},{"../../const":46,"./Rectangle":74}],73:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("../Point")),s=t("../../const"),a=function(){function t(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Array.isArray(r[0])&&(r=r[0]),r[0]instanceof o.default){for(var a=[],u=0,h=r.length;u<h;u++)a.push(r[u].x,r[u].y);r=a}this.closed=!0,this.points=r,this.type=s.SHAPES.POLY}return t.prototype.clone=function(){return new t(this.points.slice())},t.prototype.close=function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1])},t.prototype.contains=function(t,e){for(var r=!1,n=this.points.length/2,i=0,o=n-1;i<n;o=i++){var s=this.points[2*i],a=this.points[2*i+1],u=this.points[2*o],h=this.points[2*o+1];e<a!=e<h&&t<(e-a)/(h-a)*(u-s)+s&&(r=!r)}return r},t}();r.default=a},{"../../const":46,"../Point":69}],74:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("../../const"),s=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=Number(e),this.y=Number(r),this.width=Number(i),this.height=Number(s),this.type=o.SHAPES.RECT}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},t.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);this.x=e,this.width=Math.max(r-e,0),this.y=n,this.height=Math.max(i-n,0)},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=r-e,this.y=n,this.height=i-n},t.prototype.ceil=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.001,r=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=n-this.y},i(t,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new t(0,0,0,0)}}]),t}();r.default=s},{"../../const":46}],75:[function(t,e,r){"use strict";r.__esModule=!0;var i=t("../../const"),o=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:20;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=r,this.width=o,this.height=s,this.radius=a,this.type=i.SHAPES.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),n=e-(this.y+this.radius),i=this.radius*this.radius;if(r*r+n*n<=i)return!0;if((r=t-(this.x+this.width-this.radius))*r+n*n<=i)return!0;if(r*r+(n=e-(this.y+this.height-this.radius))*n<=i)return!0;if((r=t-(this.x+this.radius))*r+n*n<=i)return!0}return!1},t}();r.default=o},{"../../const":46}],76:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=t("../utils"),h=t("../math"),l=t("../const"),d=n(t("../settings")),p=n(t("../display/Container")),g=n(t("../textures/RenderTexture")),m=n(t("eventemitter3")),_=new h.Matrix,b=function(t){function e(r,n,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return(0,u.sayHello)(r),"number"==typeof n&&(n=Object.assign({width:n,height:s||d.default.RENDER_OPTIONS.height},a)),n=Object.assign({},d.default.RENDER_OPTIONS,n),c.options=n,c.type=l.RENDERER_TYPE.UNKNOWN,c.screen=new h.Rectangle(0,0,n.width,n.height),c.view=n.view||document.createElement("canvas"),c.resolution=n.resolution||d.default.RESOLUTION,c.transparent=n.transparent,c.autoResize=n.autoResize||!1,c.blendModes=null,c.preserveDrawingBuffer=n.preserveDrawingBuffer,c.clearBeforeRender=n.clearBeforeRender,c.roundPixels=n.roundPixels,c._backgroundColor=0,c._backgroundColorRgba=[0,0,0,0],c._backgroundColorString="#000000",c.backgroundColor=n.backgroundColor||c._backgroundColor,c._tempDisplayObjectParent=new p.default,c._lastObjectRendered=c._tempDisplayObjectParent,c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoResize&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,r,n){n=n||t.getLocalBounds();var i=g.default.create(0|n.width,0|n.height,e,r);return _.tx=-n.x,_.ty=-n.y,this.render(t,i,!1,_,!!t.parent),i},e.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=l.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},a(e,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=(0,u.hex2string)(t),(0,u.hex2rgb)(t,this._backgroundColorRgba)}}]),e}(m.default);r.default=b},{"../const":46,"../display/Container":48,"../math":70,"../settings":101,"../textures/RenderTexture":113,"../utils":125,eventemitter3:3}],77:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("../SystemRenderer")),l=n(t("./utils/CanvasMaskManager")),d=n(t("./utils/CanvasRenderTarget")),p=n(t("./utils/mapCanvasBlendModesToPixi")),v=t("../../utils"),g=t("../../const"),m=n(t("../../settings")),_=function(t){function e(r,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"Canvas",r,n,s));return a.type=g.RENDERER_TYPE.CANVAS,a.rootContext=a.view.getContext("2d",{alpha:a.transparent}),a.context=a.rootContext,a.refresh=!0,a.maskManager=new l.default(a),a.smoothProperty="imageSmoothingEnabled",a.rootContext.imageSmoothingEnabled||(a.rootContext.webkitImageSmoothingEnabled?a.smoothProperty="webkitImageSmoothingEnabled":a.rootContext.mozImageSmoothingEnabled?a.smoothProperty="mozImageSmoothingEnabled":a.rootContext.oImageSmoothingEnabled?a.smoothProperty="oImageSmoothingEnabled":a.rootContext.msImageSmoothingEnabled&&(a.smoothProperty="msImageSmoothingEnabled")),a.initPlugins(),a.blendModes=(0,p.default)(),a._activeBlendMode=null,a.renderingToScreen=!1,a.resize(a.options.width,a.options.height),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(t,e,r,n,i){if(this.view){this.renderingToScreen=!e,this.emit("prerender");var o=this.resolution;e?((e=e.baseTexture||e)._canvasRenderTarget||(e._canvasRenderTarget=new d.default(e.width,e.height,e.resolution),e.source=e._canvasRenderTarget.canvas,e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var s=this.context;if(e||(this._lastObjectRendered=t),!i){var a=t.parent,u=this._tempDisplayObjectParent.transform.worldTransform;n?(n.copy(u),this._tempDisplayObjectParent.transform._worldID=-1):u.identity(),t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=a}s.save(),s.setTransform(1,0,0,1,0,0),s.globalAlpha=1,this._activeBlendMode=g.BLEND_MODES.NORMAL,s.globalCompositeOperation=this.blendModes[g.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(s.fillStyle="black",s.clear()),(void 0!==r?r:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?s.clearRect(0,0,this.width,this.height):(s.fillStyle=this._backgroundColorString,s.fillRect(0,0,this.width,this.height)));var h=this.context;this.context=s,t.renderCanvas(this),this.context=h,s.restore(),this.resolution=o,this.emit("postrender")}},e.prototype.clear=function(t){var e=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(e.fillStyle=t,e.fillRect(0,0,this.width,this.height)):e.clearRect(0,0,this.width,this.height)},e.prototype.setBlendMode=function(t){this._activeBlendMode!==t&&(this._activeBlendMode=t,this.context.globalCompositeOperation=this.blendModes[t])},e.prototype.destroy=function(e){this.destroyPlugins(),t.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},e.prototype.resize=function(e,r){t.prototype.resize.call(this,e,r),this.smoothProperty&&(this.rootContext[this.smoothProperty]=m.default.SCALE_MODE===g.SCALE_MODES.LINEAR)},e.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},e}(u.default);r.default=_,v.pluginTarget.mixin(_)},{"../../const":46,"../../settings":101,"../../utils":125,"../SystemRenderer":76,"./utils/CanvasMaskManager":78,"./utils/CanvasRenderTarget":79,"./utils/mapCanvasBlendModesToPixi":81}],78:[function(t,e,r){"use strict";r.__esModule=!0;var i=t("../../../const"),o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e}return t.prototype.pushMask=function(t){var e=this.renderer;e.context.save();var r=t.alpha,n=t.transform.worldTransform,i=e.resolution;e.context.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i,n.ty*i),t._texture||(this.renderGraphicsShape(t),e.context.clip()),t.worldAlpha=r},t.prototype.renderGraphicsShape=function(t){var e=this.renderer.context,r=t.graphicsData.length;if(0!==r){e.beginPath();for(var n=0;n<r;n++){var o=t.graphicsData[n],s=o.shape;if(o.type===i.SHAPES.POLY){var a=s.points,u=o.holes,h=void 0,l=void 0;e.moveTo(a[0],a[1]);for(var c=2;c<a.length;c+=2)e.lineTo(a[c],a[c+1]);if(a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath(),0<u.length){for(var d=h=0;d<a.length;d+=2)h+=a[d]*a[d+3]-a[d+1]*a[d+2];for(var f=0;f<u.length;f++){a=u[f].points;for(var p=l=0;p<a.length;p+=2)l+=a[p]*a[p+3]-a[p+1]*a[p+2];if(e.moveTo(a[0],a[1]),l*h<0)for(var v=2;v<a.length;v+=2)e.lineTo(a[v],a[v+1]);else for(var g=a.length-2;2<=g;g-=2)e.lineTo(a[g],a[g+1])}}}else if(o.type===i.SHAPES.RECT)e.rect(s.x,s.y,s.width,s.height),e.closePath();else if(o.type===i.SHAPES.CIRC)e.arc(s.x,s.y,s.radius,0,2*Math.PI),e.closePath();else if(o.type===i.SHAPES.ELIP){var y=2*s.width,m=2*s.height,_=s.x-y/2,b=s.y-m/2,x=y/2*.5522848,T=m/2*.5522848,w=_+y,E=b+m,S=_+y/2,O=b+m/2;e.moveTo(_,O),e.bezierCurveTo(_,O-T,S-x,b,S,b),e.bezierCurveTo(S+x,b,w,O-T,w,O),e.bezierCurveTo(w,O+T,S+x,E,S,E),e.bezierCurveTo(S-x,E,_,O+T,_,O),e.closePath()}else if(o.type===i.SHAPES.RREC){var M=s.x,P=s.y,C=s.width,R=s.height,A=s.radius,I=Math.min(C,R)/2|0;A=I<A?I:A,e.moveTo(M,P+A),e.lineTo(M,P+R-A),e.quadraticCurveTo(M,P+R,M+A,P+R),e.lineTo(M+C-A,P+R),e.quadraticCurveTo(M+C,P+R,M+C,P+R-A),e.lineTo(M+C,P+A),e.quadraticCurveTo(M+C,P,M+C-A,P),e.lineTo(M+A,P),e.quadraticCurveTo(M,P,M,P+A),e.closePath()}}}},t.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},t.prototype.destroy=function(){},t}();r.default=o},{"../../../const":46}],79:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../settings")),a=function(){function t(e,r,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||s.default.RESOLUTION,this.resize(e,r)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},i(t,[{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}]),t}();r.default=a},{"../../../settings":101}],80:[function(t,e,r){"use strict";function n(t){var e=document.createElement("canvas");e.width=6,e.height=1;var r=e.getContext("2d");return r.fillStyle=t,r.fillRect(0,0,6,1),e}r.__esModule=!0,r.default=function(){if("undefined"==typeof document)return!1;var t=n("#ff00ff"),e=n("#ffff00"),r=document.createElement("canvas");r.width=6,r.height=1;var i=r.getContext("2d");i.globalCompositeOperation="multiply",i.drawImage(t,0,0),i.drawImage(e,2,0);var o=i.getImageData(2,0,1,1);if(!o)return!1;var s=o.data;return 255===s[0]&&0===s[1]&&0===s[2]}},{}],81:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return(0,s.default)()?(t[i.BLEND_MODES.NORMAL]="source-over",t[i.BLEND_MODES.ADD]="lighter",t[i.BLEND_MODES.MULTIPLY]="multiply",t[i.BLEND_MODES.SCREEN]="screen",t[i.BLEND_MODES.OVERLAY]="overlay",t[i.BLEND_MODES.DARKEN]="darken",t[i.BLEND_MODES.LIGHTEN]="lighten",t[i.BLEND_MODES.COLOR_DODGE]="color-dodge",t[i.BLEND_MODES.COLOR_BURN]="color-burn",t[i.BLEND_MODES.HARD_LIGHT]="hard-light",t[i.BLEND_MODES.SOFT_LIGHT]="soft-light",t[i.BLEND_MODES.DIFFERENCE]="difference",t[i.BLEND_MODES.EXCLUSION]="exclusion",t[i.BLEND_MODES.HUE]="hue",t[i.BLEND_MODES.SATURATION]="saturate",t[i.BLEND_MODES.COLOR]="color",t[i.BLEND_MODES.LUMINOSITY]="luminosity"):(t[i.BLEND_MODES.NORMAL]="source-over",t[i.BLEND_MODES.ADD]="lighter",t[i.BLEND_MODES.MULTIPLY]="source-over",t[i.BLEND_MODES.SCREEN]="source-over",t[i.BLEND_MODES.OVERLAY]="source-over",t[i.BLEND_MODES.DARKEN]="source-over",t[i.BLEND_MODES.LIGHTEN]="source-over",t[i.BLEND_MODES.COLOR_DODGE]="source-over",t[i.BLEND_MODES.COLOR_BURN]="source-over",t[i.BLEND_MODES.HARD_LIGHT]="source-over",t[i.BLEND_MODES.SOFT_LIGHT]="source-over",t[i.BLEND_MODES.DIFFERENCE]="source-over",t[i.BLEND_MODES.EXCLUSION]="source-over",t[i.BLEND_MODES.HUE]="source-over",t[i.BLEND_MODES.SATURATION]="source-over",t[i.BLEND_MODES.COLOR]="source-over",t[i.BLEND_MODES.LUMINOSITY]="source-over"),t[i.BLEND_MODES.NORMAL_NPM]=t[i.BLEND_MODES.NORMAL],t[i.BLEND_MODES.ADD_NPM]=t[i.BLEND_MODES.ADD],t[i.BLEND_MODES.SCREEN_NPM]=t[i.BLEND_MODES.SCREEN],t};var i=t("../../../const"),s=function(t){return t&&t.__esModule?t:{default:t}}(t("./canUseNewCanvasBlendModes"))},{"../../../const":46,"./canUseNewCanvasBlendModes":80}],82:[function(t,e,r){"use strict";r.__esModule=!0;var i=t("../../const"),s=function(t){return t&&t.__esModule?t:{default:t}}(t("../../settings")),a=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=s.default.GC_MAX_IDLE,this.checkCountMax=s.default.GC_MAX_CHECK_COUNT,this.mode=s.default.GC_MODE}return t.prototype.update=function(){this.count++,this.mode!==i.GC_MODES.MANUAL&&++this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())},t.prototype.run=function(){for(var t=this.renderer.textureManager,e=t._managedTextures,r=!1,n=0;n<e.length;n++){var i=e[n];!i._glRenderTargets&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),r=!(e[n]=null))}if(r){for(var o=0,s=0;s<e.length;s++)null!==e[s]&&(e[o++]=e[s]);e.length=o}},t.prototype.unload=function(t){var e=this.renderer.textureManager;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture,!0);for(var r=t.children.length-1;0<=r;r--)this.unload(t.children[r])},t}();r.default=a},{"../../const":46,"../../settings":101}],83:[function(t,e,r){"use strict";r.__esModule=!0;var i=t("pixi-gl-core"),o=t("../../const"),a=function(t){return t&&t.__esModule?t:{default:t}}(t("./utils/RenderTarget")),u=t("../../utils"),h=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e,this.gl=e.gl,this._managedTextures=[]}return t.prototype.bindTexture=function(){},t.prototype.getTexture=function(){},t.prototype.updateTexture=function(t,e){var r=this.gl,n=!!t._glRenderTargets;if(!t.hasLoaded)return null;var s=this.renderer.boundTextures;if(void 0===e)for(var u=e=0;u<s.length;++u)if(s[u]===t){e=u;break}s[e]=t,r.activeTexture(r.TEXTURE0+e);var h=t._glTextures[this.renderer.CONTEXT_UID];if(h)n?t._glRenderTargets[this.renderer.CONTEXT_UID].resize(t.width,t.height):h.upload(t.source);else{if(n){var l=new a.default(this.gl,t.width,t.height,t.scaleMode,t.resolution);l.resize(t.width,t.height),h=(t._glRenderTargets[this.renderer.CONTEXT_UID]=l).texture,this.renderer._activeRenderTarget.root||this.renderer._activeRenderTarget.frameBuffer.bind()}else(h=new i.GLTexture(this.gl,null,null,null,null)).bind(e),h.premultiplyAlpha=!0,h.upload(t.source);t._glTextures[this.renderer.CONTEXT_UID]=h,t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t),t.isPowerOfTwo?(t.mipmap&&h.enableMipmap(),t.wrapMode===o.WRAP_MODES.CLAMP?h.enableWrapClamp():t.wrapMode===o.WRAP_MODES.REPEAT?h.enableWrapRepeat():h.enableWrapMirrorRepeat()):h.enableWrapClamp(),t.scaleMode===o.SCALE_MODES.NEAREST?h.enableNearestScaling():h.enableLinearScaling()}return h},t.prototype.destroyTexture=function(t,e){if((t=t.baseTexture||t).hasLoaded){var r=this.renderer,n=r.CONTEXT_UID,i=t._glTextures,o=t._glRenderTargets;if(i[n]&&(r.unbindTexture(t),i[n].destroy(),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this),delete i[n],!e)){var s=this._managedTextures.indexOf(t);-1!==s&&(0,u.removeItems)(this._managedTextures,s,1)}o&&o[n]&&(r._activeRenderTarget===o[n]&&r.bindRenderTarget(r.rootRenderTarget),o[n].destroy(),delete o[n])}},t.prototype.removeAll=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.renderer.CONTEXT_UID]&&delete e._glTextures[this.renderer.CONTEXT_UID]}},t.prototype.destroy=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];this.destroyTexture(e,!0),e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this)}this._managedTextures=null},t}();r.default=h},{"../../const":46,"../../utils":125,"./utils/RenderTarget":96,"pixi-gl-core":15}],84:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("../SystemRenderer")),l=n(t("./managers/MaskManager")),d=n(t("./managers/StencilManager")),p=n(t("./managers/FilterManager")),g=n(t("./utils/RenderTarget")),m=n(t("./utils/ObjectRenderer")),b=n(t("./TextureManager")),T=n(t("../../textures/BaseTexture")),E=n(t("./TextureGarbageCollector")),O=n(t("./WebGLState")),P=n(t("./utils/mapWebGLDrawModesToPixi")),R=n(t("./utils/validateContext")),A=t("../../utils"),D=n(t("pixi-gl-core")),L=t("../../const"),N=0,B=function(t){function e(r,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"WebGL",r,n,s));return a.legacy=a.options.legacy,a.legacy&&(D.default.VertexArrayObject.FORCE_NATIVE=!0),a.type=L.RENDERER_TYPE.WEBGL,a.handleContextLost=a.handleContextLost.bind(a),a.handleContextRestored=a.handleContextRestored.bind(a),a.view.addEventListener("webglcontextlost",a.handleContextLost,!1),a.view.addEventListener("webglcontextrestored",a.handleContextRestored,!1),a._contextOptions={alpha:a.transparent,antialias:a.options.antialias,premultipliedAlpha:a.transparent&&"notMultiplied"!==a.transparent,stencil:!0,preserveDrawingBuffer:a.options.preserveDrawingBuffer,powerPreference:a.options.powerPreference},a._backgroundColorRgba[3]=a.transparent?0:1,a.maskManager=new l.default(a),a.stencilManager=new d.default(a),a.emptyRenderer=new m.default(a),a.currentRenderer=a.emptyRenderer,a.textureManager=null,a.filterManager=null,a.initPlugins(),a.options.context&&(0,R.default)(a.options.context),a.gl=a.options.context||D.default.createContext(a.view,a._contextOptions),a.CONTEXT_UID=N++,a.state=new O.default(a.gl),a.renderingToScreen=!0,a.boundTextures=null,a._activeShader=null,a._activeVao=null,a._activeRenderTarget=null,a._initContext(),a.drawModes=(0,P.default)(a.gl),a._nextTextureLocation=0,a.setBlendMode(0),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._initContext=function(){var t=this.gl;t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext();var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(e),this.emptyTextures=new Array(e),this._unknownBoundTextures=!1,this.textureManager=new b.default(this),this.filterManager=new p.default(this),this.textureGC=new E.default(this),this.state.resetToDefault(),this.rootRenderTarget=new g.default(t,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var r=new D.default.GLTexture.fromData(t,null,1,1),n={_glTextures:{}};n._glTextures[this.CONTEXT_UID]={};for(var i=0;i<e;i++){var o=new T.default;o._glTextures[this.CONTEXT_UID]=r,this.boundTextures[i]=n,this.emptyTextures[i]=o,this.bindTexture(null,i)}this.emit("context",t),this.resize(this.screen.width,this.screen.height)},e.prototype.render=function(t,e,r,n,i){if(this.renderingToScreen=!e,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,e||(this._lastObjectRendered=t),!i){var o=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=o}this.bindRenderTexture(e,n),this.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this._activeRenderTarget.clear(),t.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.resize=function(t,e){u.default.prototype.resize.call(this,t,e),this.rootRenderTarget.resize(t,e),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},e.prototype.setBlendMode=function(t){this.state.setBlendMode(t)},e.prototype.clear=function(t){this._activeRenderTarget.clear(t)},e.prototype.setTransform=function(t){this._activeRenderTarget.transform=t},e.prototype.clearRenderTexture=function(t,e){var n=t.baseTexture._glRenderTargets[this.CONTEXT_UID];return n&&n.clear(e),this},e.prototype.bindRenderTexture=function(t,e){var r=void 0;if(t){var n=t.baseTexture;n._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(n,0),this.unbindTexture(n),(r=n._glRenderTargets[this.CONTEXT_UID]).setFrame(t.frame)}else r=this.rootRenderTarget;return r.transform=e,this.bindRenderTarget(r),this},e.prototype.bindRenderTarget=function(t){return t!==this._activeRenderTarget&&((this._activeRenderTarget=t).activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=t.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(t.stencilMaskStack)),this},e.prototype.bindShader=function(t,e){return this._activeShader!==t&&((this._activeShader=t).bind(),!1!==e&&(t.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},e.prototype.bindTexture=function(t,e,r){if((t=(t=t||this.emptyTextures[e]).baseTexture||t).touched=this.textureGC.count,r)e=e||0;else{for(var n=0;n<this.boundTextures.length;n++)if(this.boundTextures[n]===t)return n;void 0===e&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,e=this.boundTextures.length-this._nextTextureLocation-1)}var i=this.gl,o=t._glTextures[this.CONTEXT_UID];return o?(this.boundTextures[e]=t,i.activeTexture(i.TEXTURE0+e),i.bindTexture(i.TEXTURE_2D,o.texture)):this.textureManager.updateTexture(t,e),e},e.prototype.unbindTexture=function(t){var e=this.gl;if(t=t.baseTexture||t,this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<this.boundTextures.length;r++)this.boundTextures[r]===this.emptyTextures[r]&&(e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[r]._glTextures[this.CONTEXT_UID].texture))}for(var n=0;n<this.boundTextures.length;n++)this.boundTextures[n]===t&&(this.boundTextures[n]=this.emptyTextures[n],e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[n]._glTextures[this.CONTEXT_UID].texture));return this},e.prototype.createVao=function(){return new D.default.VertexArrayObject(this.gl,this.state.attribState)},e.prototype.bindVao=function(t){return this._activeVao===t||(t?t.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=t),this},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer),this.bindVao(null),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget,this._unknownBoundTextures=!0;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.emptyTextures[t];return this.rootRenderTarget.activate(),this.state.resetToDefault(),this},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},e.prototype.destroy=function(e){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),t.prototype.destroy.call(this,e),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},e}(u.default);r.default=B,A.pluginTarget.mixin(B)},{"../../const":46,"../../textures/BaseTexture":112,"../../utils":125,"../SystemRenderer":76,"./TextureGarbageCollector":82,"./TextureManager":83,"./WebGLState":85,"./managers/FilterManager":90,"./managers/MaskManager":91,"./managers/StencilManager":92,"./utils/ObjectRenderer":94,"./utils/RenderTarget":96,"./utils/mapWebGLDrawModesToPixi":99,"./utils/validateContext":100,"pixi-gl-core":15}],85:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("./utils/mapWebGLBlendModesToPixi")),s=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=e,this.maxAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,o.default)(e),this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")}return t.prototype.push=function(){var t=this.stack[this.stackIndex];t||(t=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var e=0;e<this.activeState.length;e++)t[e]=this.activeState[e]},t.prototype.pop=function(){var t=this.stack[--this.stackIndex];this.setState(t)},t.prototype.setState=function(t){this.setBlend(t[0]),this.setDepthTest(t[1]),this.setFrontFace(t[2]),this.setCullFace(t[3]),this.setBlendMode(t[4])},t.prototype.setBlend=function(t){t=t?1:0,this.activeState[0]!==t&&(this.activeState[0]=t,this.gl[t?"enable":"disable"](this.gl.BLEND))},t.prototype.setBlendMode=function(t){if(t!==this.activeState[4]){this.activeState[4]=t;var e=this.blendModes[t];2===e.length?this.gl.blendFunc(e[0],e[1]):this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3])}},t.prototype.setDepthTest=function(t){t=t?1:0,this.activeState[1]!==t&&(this.activeState[1]=t,this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST))},t.prototype.setCullFace=function(t){t=t?1:0,this.activeState[3]!==t&&(this.activeState[3]=t,this.gl[t?"enable":"disable"](this.gl.CULL_FACE))},t.prototype.setFrontFace=function(t){t=t?1:0,this.activeState[2]!==t&&(this.activeState[2]=t,this.gl.frontFace(this.gl[t?"CW":"CCW"]))},t.prototype.resetAttributes=function(){for(var t=0;t<this.attribState.tempAttribState.length;t++)this.attribState.tempAttribState[t]=0;for(var e=0;e<this.attribState.attribState.length;e++)this.attribState.attribState[e]=0;for(var r=1;r<this.maxAttribs;r++)this.gl.disableVertexAttribArray(r)},t.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var t=0;t<this.activeState.length;++t)this.activeState[t]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},t}();r.default=s},{"./utils/mapWebGLBlendModesToPixi":98}],86:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=n(t("./extractUniformsFromSrc")),u=t("../../../utils"),h=t("../../../const"),c=n(t("../../../settings")),d={},f=function(){function t(e,r,n){for(var o in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this._blendMode=h.BLEND_MODES.NORMAL,this.uniformData=n||(0,a.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={},this.uniformData)this.uniforms[o]=this.uniformData[o].value,this.uniformData[o].type&&(this.uniformData[o].type=this.uniformData[o].type.toLowerCase());this.glShaders={},d[this.vertexSrc+this.fragmentSrc]||(d[this.vertexSrc+this.fragmentSrc]=(0,u.uid)()),this.glShaderKey=d[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=c.default.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0}return t.prototype.apply=function(t,e,r,n,i){t.applyFilter(this,e,r,n)},o(t,[{key:"blendMode",get:function(){return this._blendMode},set:function(t){this._blendMode=t}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),t}();r.default=f},{"../../../const":46,"../../../settings":101,"../../../utils":125,"./extractUniformsFromSrc":87}],87:[function(t,e,r){"use strict";function i(t){for(var e=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),r={},n=void 0,i=t.replace(/\s+/g," ").split(/\s*;\s*/),o=0;o<i.length;o++){var s=i[o].trim();if(-1<s.indexOf("uniform")){var u=s.split(" "),h=u[1],l=u[2],c=1;-1<l.indexOf("[")&&(l=(n=l.split(/\[|]/))[0],c*=Number(n[1])),l.match(e)||(r[l]={value:a(h,c),name:l,type:h})}}return r}r.__esModule=!0,r.default=function(t,e,r){var n=i(t),o=i(e);return Object.assign(n,o)};var a=function(t){return t&&t.__esModule?t:{default:t}}(t("pixi-gl-core")).default.shader.defaultValue},{"pixi-gl-core":15}],88:[function(t,e,r){"use strict";r.__esModule=!0,r.calculateScreenSpaceMatrix=function(t,e,r){var n=t.identity();return n.translate(e.x/r.width,e.y/r.height),n.scale(r.width,r.height),n},r.calculateNormalizedScreenSpaceMatrix=function(t,e,r){var n=t.identity();n.translate(e.x/r.width,e.y/r.height);var i=r.width/e.width,o=r.height/e.height;return n.scale(i,o),n},r.calculateSpriteMatrix=function(t,e,r,n){var i=n._texture.orig,o=t.set(r.width,0,0,r.height,e.x,e.y),a=n.worldTransform.copy(s.Matrix.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/i.width,1/i.height),o.translate(n.anchor.x,n.anchor.y),o};var s=t("../../../math")},{"../../../math":70}],89:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("../Filter")),h=t("../../../../math"),c=n((t("path"),t("../../../../textures/TextureMatrix"))),d=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new h.Matrix,s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return r.renderable=!1,s.maskSprite=r,s.maskMatrix=n,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r,n){var i=this.maskSprite,o=this.maskSprite.texture;o.valid&&(o.transform||(o.transform=new c.default(o,0)),o.transform.update(),this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.transform.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.transform.uClampFrame,t.applyFilter(this,e,r,n))},e}(u.default);r.default=d},{"../../../../math":70,"../../../../textures/TextureMatrix":116,"../Filter":86,path:8}],90:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var u=n(t("./WebGLManager")),l=n(t("../utils/RenderTarget")),d=n(t("../utils/Quad")),f=t("../../../math"),v=n(t("../../../Shader")),y=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../filters/filterTransforms")),_=n(t("bit-twiddle")),b=function(){function t(){s(this,t),this.renderTarget=null,this.target=null,this.resolution=1,this.sourceFrame=new f.Rectangle,this.destinationFrame=new f.Rectangle,this.filters=[]}return t.prototype.clear=function(){this.filters=null,this.target=null,this.renderTarget=null},t}(),x=function(t){function e(r){s(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.gl=n.renderer.gl,n.quad=new d.default(n.gl,r.state.attribState),n.shaderCache={},n.pool={},n.filterData=null,n.managedFilters=[],n.renderer.on("prerender",n.onPrerender,n),n._screenWidth=r.view.width,n._screenHeight=r.view.height,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.pushFilter=function(t,e){var r=this.renderer,n=this.filterData;if(!n){n=this.renderer._activeRenderTarget.filterStack;var i=new b;i.sourceFrame=i.destinationFrame=this.renderer._activeRenderTarget.size,i.renderTarget=r._activeRenderTarget,this.renderer._activeRenderTarget.filterData=n={index:0,stack:[i]},this.filterData=n}var o=n.stack[++n.index],s=n.stack[0].destinationFrame;o||(o=n.stack[n.index]=new b);var a=t.filterArea&&0===t.filterArea.x&&0===t.filterArea.y&&t.filterArea.width===r.screen.width&&t.filterArea.height===r.screen.height,u=e[0].resolution,h=0|e[0].padding,l=a?r.screen:t.filterArea||t.getBounds(!0),c=o.sourceFrame,d=o.destinationFrame;c.x=(l.x*u|0)/u,c.y=(l.y*u|0)/u,c.width=(l.width*u|0)/u,c.height=(l.height*u|0)/u,a||(n.stack[0].renderTarget.transform||e[0].autoFit&&c.fit(s),c.pad(h)),d.width=c.width,d.height=c.height;var f=this.getPotRenderTarget(r.gl,c.width,c.height,u);o.target=t,o.filters=e,o.resolution=u,(o.renderTarget=f).setFrame(d,c),r.bindRenderTarget(f),f.clear()},e.prototype.popFilter=function(){var t=this.filterData,e=t.stack[t.index-1],r=t.stack[t.index];this.quad.map(r.renderTarget.size,r.sourceFrame).upload();var n=r.filters;if(1===n.length)n[0].apply(this,r.renderTarget,e.renderTarget,!1,r),this.freePotRenderTarget(r.renderTarget);else{var i=r.renderTarget,o=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,r.resolution);o.setFrame(r.destinationFrame,r.sourceFrame),o.clear();var s=0;for(s=0;s<n.length-1;++s){n[s].apply(this,i,o,!0,r);var a=i;i=o,o=a}n[s].apply(this,i,e.renderTarget,!1,r),this.freePotRenderTarget(i),this.freePotRenderTarget(o)}r.clear(),0==--t.index&&(this.filterData=null)},e.prototype.applyFilter=function(t,e,r,n){var i=this.renderer,o=i.gl,s=t.glShaders[i.CONTEXT_UID];s||(t.glShaderKey?(s=this.shaderCache[t.glShaderKey])||(s=new v.default(this.gl,t.vertexSrc,t.fragmentSrc),t.glShaders[i.CONTEXT_UID]=this.shaderCache[t.glShaderKey]=s,this.managedFilters.push(t)):(s=t.glShaders[i.CONTEXT_UID]=new v.default(this.gl,t.vertexSrc,t.fragmentSrc),this.managedFilters.push(t)),i.bindVao(null),this.quad.initVao(s)),i.bindVao(this.quad.vao),i.bindRenderTarget(r),n&&(o.disable(o.SCISSOR_TEST),i.clear(),o.enable(o.SCISSOR_TEST)),r===i.maskManager.scissorRenderTarget&&i.maskManager.pushScissorMask(null,i.maskManager.scissorData),i.bindShader(s);var a=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=a,this.syncUniforms(s,t),i.state.setBlendMode(t.blendMode),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,e.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),o.bindTexture(o.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)},e.prototype.syncUniforms=function(t,e){var r=e.uniformData,n=e.uniforms,i=1,o=void 0;if(t.uniforms.filterArea){o=this.filterData.stack[this.filterData.index];var s=t.uniforms.filterArea;s[0]=o.renderTarget.size.width,s[1]=o.renderTarget.size.height,s[2]=o.sourceFrame.x,s[3]=o.sourceFrame.y,t.uniforms.filterArea=s}if(t.uniforms.filterClamp){o=o||this.filterData.stack[this.filterData.index];var a=t.uniforms.filterClamp;a[0]=0,a[1]=0,a[2]=(o.sourceFrame.width-1)/o.renderTarget.size.width,a[3]=(o.sourceFrame.height-1)/o.renderTarget.size.height,t.uniforms.filterClamp=a}for(var u in r)if(t.uniforms.data[u]){var h=r[u].type;if("sampler2d"===h&&0!==n[u]){if(n[u].baseTexture)t.uniforms[u]=this.renderer.bindTexture(n[u].baseTexture,i);else{t.uniforms[u]=i;var l=this.renderer.gl;this.renderer.boundTextures[i]=this.renderer.emptyTextures[i],l.activeTexture(l.TEXTURE0+i),n[u].texture.bind()}i++}else if("mat3"===h)void 0!==n[u].a?t.uniforms[u]=n[u].toArray(!0):t.uniforms[u]=n[u];else if("vec2"===h)if(void 0!==n[u].x){var c=t.uniforms[u]||new Float32Array(2);c[0]=n[u].x,c[1]=n[u].y,t.uniforms[u]=c}else t.uniforms[u]=n[u];else"float"===h?t.uniforms.data[u].value!==r[u]&&(t.uniforms[u]=n[u]):t.uniforms[u]=n[u]}},e.prototype.getRenderTarget=function(t,e){var r=this.filterData.stack[this.filterData.index],n=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,e||r.resolution);return n.setFrame(r.destinationFrame,r.sourceFrame),n},e.prototype.returnRenderTarget=function(t){this.freePotRenderTarget(t)},e.prototype.calculateScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return y.calculateScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size)},e.prototype.calculateNormalizedScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return y.calculateNormalizedScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size,e.destinationFrame)},e.prototype.calculateSpriteMatrix=function(t,e){var r=this.filterData.stack[this.filterData.index];return y.calculateSpriteMatrix(t,r.sourceFrame,r.renderTarget.size,e)},e.prototype.destroy=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.renderer,r=this.managedFilters;e.off("prerender",this.onPrerender,this);for(var n=0;n<r.length;n++)t||r[n].glShaders[e.CONTEXT_UID].destroy(),delete r[n].glShaders[e.CONTEXT_UID];this.shaderCache={},t?this.pool={}:this.emptyPool()},e.prototype.getPotRenderTarget=function(t,e,r,n){var i="screen";r*=n,(e*=n)===this._screenWidth&&r===this._screenHeight||(i=(65535&(e=_.default.nextPow2(e)))<<16|65535&(r=_.default.nextPow2(r))),this.pool[i]||(this.pool[i]=[]);var o=this.pool[i].pop();if(!o){var s=this.renderer.boundTextures[0];t.activeTexture(t.TEXTURE0),o=new l.default(t,e,r,null,1),t.bindTexture(t.TEXTURE_2D,s._glTextures[this.renderer.CONTEXT_UID].texture)}return o.resolution=n,o.defaultFrame.width=o.size.width=e/n,o.defaultFrame.height=o.size.height=r/n,o.filterPoolKey=i,o},e.prototype.emptyPool=function(){for(var t in this.pool){var e=this.pool[t];if(e)for(var r=0;r<e.length;r++)e[r].destroy(!0)}this.pool={}},e.prototype.freePotRenderTarget=function(t){this.pool[t.filterPoolKey].push(t)},e.prototype.onPrerender=function(){if(this._screenWidth!==this.renderer.view.width||this._screenHeight!==this.renderer.view.height){this._screenWidth=this.renderer.view.width,this._screenHeight=this.renderer.view.height;var t=this.pool.screen;if(t)for(var e=0;e<t.length;e++)t[e].destroy(!0);this.pool.screen=[]}},e}(u.default);r.default=x},{"../../../Shader":44,"../../../math":70,"../filters/filterTransforms":88,"../utils/Quad":95,"../utils/RenderTarget":96,"./WebGLManager":93,"bit-twiddle":1}],91:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("./WebGLManager")),l=n(t("../filters/spriteMask/SpriteMaskFilter")),c=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.scissor=!1,n.scissorData=null,n.scissorRenderTarget=null,n.enableScissor=!0,n.alphaMaskPool=[],n.alphaMaskIndex=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.pushMask=function(t,e){if(e.texture)this.pushSpriteMask(t,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&e.isFastRect()){var r=e.worldTransform,n=Math.atan2(r.b,r.a);(n=Math.round(n*(180/Math.PI)))%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},e.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},e.prototype.pushSpriteMask=function(t,e){var r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new l.default(e)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=t.filterArea;t.filterArea=e.getBounds(!0),this.renderer.filterManager.pushFilter(t,r),t.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},e.prototype.pushStencilMask=function(t){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(t)},e.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},e.prototype.pushScissorMask=function(t,e){e.renderable=!0;var r=this.renderer._activeRenderTarget,n=e.getBounds();n.fit(r.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var i=this.renderer.resolution;this.renderer.gl.scissor(n.x*i,(r.root?r.size.height-n.y-n.height:n.y)*i,n.width*i,n.height*i),this.scissorRenderTarget=r,this.scissorData=e,this.scissor=!0},e.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},e}(u.default);r.default=c},{"../filters/spriteMask/SpriteMaskFilter":89,"./WebGLManager":93}],92:[function(t,e,r){"use strict";r.__esModule=!0;var a=function(t){return t&&t.__esModule?t:{default:t}}(t("./WebGLManager")),u=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return o.stencilMaskStack=null,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},e.prototype.pushStencil=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var e=this.renderer.gl,r=this.stencilMaskStack.length;0===r&&e.enable(e.STENCIL_TEST),this.stencilMaskStack.push(t),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,r,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.INCR),this.renderer.plugins.graphics.render(t),this._useCurrent()},e.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var t=this.renderer.gl,e=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderer.plugins.graphics.render(e),this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},e.prototype.destroy=function(){a.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},e}(a.default);r.default=u},{"./WebGLManager":93}],93:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e,this.renderer.on("context",this.onContextChange,this)}return t.prototype.onContextChange=function(){},t.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},t}();r.default=i},{}],94:[function(t,e,r){"use strict";r.__esModule=!0;var u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){},e.prototype.render=function(t){},e}(function(t){return t&&t.__esModule?t:{default:t}}(t("../managers/WebGLManager")).default);r.default=u},{"../managers/WebGLManager":93}],95:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var s=n(t("pixi-gl-core")),u=n(t("../../../utils/createIndicesForQuads")),h=function(){function t(e,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.gl=e,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var n=0;n<4;n++)this.interleaved[4*n]=this.vertices[2*n],this.interleaved[4*n+1]=this.vertices[2*n+1],this.interleaved[4*n+2]=this.uvs[2*n],this.interleaved[4*n+3]=this.uvs[2*n+1];this.indices=(0,u.default)(1),this.vertexBuffer=s.default.GLBuffer.createVertexBuffer(e,this.interleaved,e.STATIC_DRAW),this.indexBuffer=s.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.vao=new s.default.VertexArrayObject(e,r)}return t.prototype.initVao=function(t){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,t.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,t.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},t.prototype.map=function(t,e){var r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+e.width/t.width,this.uvs[3]=n,this.uvs[4]=r+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=r,this.uvs[7]=n+e.height/t.height,r=e.x,n=e.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+e.width,this.vertices[3]=n,this.vertices[4]=r+e.width,this.vertices[5]=n+e.height,this.vertices[6]=r,this.vertices[7]=n+e.height,this},t.prototype.upload=function(){for(var t=0;t<4;t++)this.interleaved[4*t]=this.vertices[2*t],this.interleaved[4*t+1]=this.vertices[2*t+1],this.interleaved[4*t+2]=this.uvs[2*t],this.interleaved[4*t+3]=this.uvs[2*t+1];return this.vertexBuffer.upload(this.interleaved),this},t.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},t}();r.default=h},{"../../../utils/createIndicesForQuads":123,"pixi-gl-core":15}],96:[function(t,e,r){"use strict";r.__esModule=!0;var i=t("../../../math"),o=t("../../../const"),a=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../settings")),u=t("pixi-gl-core"),h=function(){function t(e,r,s,h,l,c){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.gl=e,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new i.Rectangle(0,0,1,1),this.resolution=l||a.default.RESOLUTION,this.projectionMatrix=new i.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new i.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.filterPoolKey="",this.scaleMode=void 0!==h?h:a.default.SCALE_MODE,this.root=c||!1,this.root?(this.frameBuffer=new u.GLFramebuffer(e,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=u.GLFramebuffer.createRGBA(e,100,100),this.scaleMode===o.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(r,s)}return t.prototype.clear=function(t){var e=t||this.clearColor;this.frameBuffer.clear(e[0],e[1],e[2],e[3])},t.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},t.prototype.setFrame=function(t,e){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||this.destinationFrame},t.prototype.activate=function(){var t=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(t.enable(t.SCISSOR_TEST),t.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):t.disable(t.SCISSOR_TEST),t.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},t.prototype.calculateProjection=function(t,e){var r=this.projectionMatrix;e=e||t,r.identity(),this.root?(r.a=1/t.width*2,r.d=-1/t.height*2,r.tx=-1-e.x*r.a,r.ty=1-e.y*r.d):(r.a=1/t.width*2,r.d=1/t.height*2,r.tx=-1-e.x*r.a,r.ty=-1-e.y*r.d)},t.prototype.resize=function(t,e){if(t|=0,e|=0,this.size.width!==t||this.size.height!==e){this.size.width=t,this.size.height=e,this.defaultFrame.width=t,this.defaultFrame.height=e,this.frameBuffer.resize(t*this.resolution,e*this.resolution);var r=this.frame||this.size;this.calculateProjection(r)}},t.prototype.destroy=function(){this.frameBuffer.stencil&&this.gl.deleteRenderbuffer(this.frameBuffer.stencil),this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},t}();r.default=h},{"../../../const":46,"../../../math":70,"../../../settings":101,"pixi-gl-core":15}],97:[function(t,e,r){"use strict";function i(t){for(var e="",r=0;r<t;++r)0<r&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}r.__esModule=!0,r.default=function(t,e){var r=!e;if(r){var n=document.createElement("canvas");n.width=1,n.height=1,e=s.default.createContext(n)}for(var o=e.createShader(e.FRAGMENT_SHADER);;){var u=a.replace(/%forloop%/gi,i(t));if(e.shaderSource(o,u),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS))break;t=t/2|0}return r&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext(),t};var s=function(t){return t&&t.__esModule?t:{default:t}}(t("pixi-gl-core")),a=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n")},{"pixi-gl-core":15}],98:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return e[i.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.ADD]=[t.ONE,t.DST_ALPHA],e[i.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR],e[i.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.BLEND_MODES.ADD_NPM]=[t.SRC_ALPHA,t.DST_ALPHA,t.ONE,t.DST_ALPHA],e[i.BLEND_MODES.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_COLOR],e};var i=t("../../../const")},{"../../../const":46}],99:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e[i.DRAW_MODES.POINTS]=t.POINTS,e[i.DRAW_MODES.LINES]=t.LINES,e[i.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,e[i.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,e[i.DRAW_MODES.TRIANGLES]=t.TRIANGLES,e[i.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,e[i.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN,e};var i=t("../../../const")},{"../../../const":46}],100:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}},{}],101:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var o=n(t("./utils/maxRecommendedTextures")),a=n(t("./utils/canUploadSameBuffer"));r.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,o.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,a.default)(),MESH_CANVAS_PADDING:0}},{"./utils/canUploadSameBuffer":122,"./utils/maxRecommendedTextures":127}],102:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=t("../math"),h=t("../utils"),l=t("../const"),d=n(t("../textures/Texture")),p=n(t("../display/Container")),v=new u.Point,g=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n._anchor=new u.ObservablePoint(n._onAnchorUpdate,n,r?r.defaultAnchor.x:0,r?r.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=l.BLEND_MODES.NORMAL,n.shader=null,n.cachedTint=16777215,n.texture=r||d.default.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.pluginName="sprite",n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,h.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,h.sign)(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var t=this._texture,e=this.transform.worldTransform,r=e.a,n=e.b,i=e.c,o=e.d,s=e.tx,a=e.ty,u=this.vertexData,h=t.trim,l=t.orig,c=this._anchor,d=0,f=0,p=0,v=0;p=h?(d=(f=h.x-c._x*l.width)+h.width,(v=h.y-c._y*l.height)+h.height):(d=(f=-c._x*l.width)+l.width,(v=-c._y*l.height)+l.height),u[0]=r*f+i*v+s,u[1]=o*v+n*f+a,u[2]=r*d+i*v+s,u[3]=o*v+n*d+a,u[4]=r*d+i*p+s,u[5]=o*p+n*d+a,u[6]=r*f+i*p+s,u[7]=o*p+n*f+a}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,n=this._anchor,i=this.transform.worldTransform,o=i.a,s=i.b,a=i.c,u=i.d,h=i.tx,l=i.ty,c=-n._x*r.width,d=c+r.width,f=-n._y*r.height,p=f+r.height;e[0]=o*c+a*f+h,e[1]=u*f+s*c+l,e[2]=o*d+a*f+h,e[3]=u*f+s*d+l,e[4]=o*d+a*p+h,e[5]=u*p+s*d+l,e[6]=o*c+a*p+h,e[7]=u*p+s*c+l},e.prototype._renderWebGL=function(t){this.calculateVertices(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new u.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,v);var e=this._texture.orig.width,r=this._texture.orig.height,n=-e*this.anchor.x,i=0;return v.x>=n&&v.x<n+e&&(i=-r*this.anchor.y,v.y>=i&&v.y<i+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null,this.shader=null},e.from=function(t){return new e(d.default.from(t))},e.fromFrame=function(t){var r=h.TextureCache[t];if(!r)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new e(r)},e.fromImage=function(t,r,n){return new e(d.default.fromImage(t,r,n))},a(e,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=(0,h.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=(0,h.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor.copy(t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t||d.default.EMPTY,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}]),e}(p.default);r.default=g},{"../const":46,"../display/Container":48,"../math":70,"../textures/Texture":115,"../utils":125}],103:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var s=n(t("../../renderers/canvas/CanvasRenderer")),a=t("../../const"),u=t("../../math"),l=n(t("./CanvasTinter")),c=new u.Matrix,d=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e}return t.prototype.render=function(t){var e=t._texture,r=this.renderer,n=e._frame.width,i=e._frame.height,o=t.transform.worldTransform,s=0,h=0;if(!(e.orig.width<=0||e.orig.height<=0)&&e.baseTexture.source&&(r.setBlendMode(t.blendMode),e.valid)){r.context.globalAlpha=t.worldAlpha;var d=e.baseTexture.scaleMode===a.SCALE_MODES.LINEAR;r.smoothProperty&&r.context[r.smoothProperty]!==d&&(r.context[r.smoothProperty]=d),h=e.trim?(s=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(s=(.5-t.anchor.x)*e.orig.width,(.5-t.anchor.y)*e.orig.height),e.rotate&&(o.copy(c),o=c,u.GroupD8.matrixAppendRotationInv(o,e.rotate,s,h),h=s=0),s-=n/2,h-=i/2,r.roundPixels?(r.context.setTransform(o.a,o.b,o.c,o.d,o.tx*r.resolution|0,o.ty*r.resolution|0),s|=0,h|=0):r.context.setTransform(o.a,o.b,o.c,o.d,o.tx*r.resolution,o.ty*r.resolution);var f=e.baseTexture.resolution;16777215!==t.tint?(t.cachedTint===t.tint&&t.tintedTexture.tintId===t._texture._updateID||(t.cachedTint=t.tint,t.tintedTexture=l.default.getTintedTexture(t,t.tint)),r.context.drawImage(t.tintedTexture,0,0,n*f,i*f,s*r.resolution,h*r.resolution,n*r.resolution,i*r.resolution)):r.context.drawImage(e.baseTexture.source,e._frame.x*f,e._frame.y*f,n*f,i*f,s*r.resolution,h*r.resolution,n*r.resolution,i*r.resolution)}},t.prototype.destroy=function(){this.renderer=null},t}();r.default=d,s.default.registerPlugin("sprite",d)},{"../../const":46,"../../math":70,"../../renderers/canvas/CanvasRenderer":77,"./CanvasTinter":104}],104:[function(t,e,r){"use strict";r.__esModule=!0;var n=t("../../utils"),s={getTintedTexture:function(t,e){var r=t._texture,n="#"+("00000"+(0|(e=s.roundColor(e))).toString(16)).substr(-6);r.tintCache=r.tintCache||{};var i=r.tintCache[n],o=void 0;if(i){if(i.tintId===r._updateID)return r.tintCache[n];o=r.tintCache[n]}else o=s.canvas||document.createElement("canvas");if(s.tintMethod(r,e,o),o.tintId=r._updateID,s.convertTintToImage){var a=new Image;a.src=o.toDataURL(),r.tintCache[n]=a}else r.tintCache[n]=o,s.canvas=null;return o},tintWithMultiply:function(t,e,r){var n=r.getContext("2d"),i=t._frame.clone(),o=t.baseTexture.resolution;i.x*=o,i.y*=o,i.width*=o,i.height*=o,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore()},tintWithOverlay:function(t,e,r){var n=r.getContext("2d"),i=t._frame.clone(),o=t.baseTexture.resolution;i.x*=o,i.y*=o,i.width*=o,i.height*=o,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore()},tintWithPerPixel:function(t,e,r){var i=r.getContext("2d"),o=t._frame.clone(),s=t.baseTexture.resolution;o.x*=s,o.y*=s,o.width*=s,o.height*=s,r.width=Math.ceil(o.width),r.height=Math.ceil(o.height),i.save(),i.globalCompositeOperation="copy",i.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),i.restore();for(var a=(0,n.hex2rgb)(e),u=a[0],h=a[1],l=a[2],c=i.getImageData(0,0,o.width,o.height),d=c.data,f=0;f<d.length;f+=4)d[f+0]*=u,d[f+1]*=h,d[f+2]*=l;i.putImageData(c,0,0)},roundColor:function(t){var e=s.cacheStepsPerColorChannel,r=(0,n.hex2rgb)(t);return r[0]=Math.min(255,r[0]/e*e),r[1]=Math.min(255,r[1]/e*e),r[2]=Math.min(255,r[2]/e*e),(0,n.rgb2hex)(r)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,function(t){return t&&t.__esModule?t:{default:t}}(t("../../renderers/canvas/utils/canUseNewCanvasBlendModes")).default)(),tintMethod:0};s.tintMethod=s.canUseMultiply?s.tintWithMultiply:s.tintWithPerPixel,r.default=s},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":80,"../../utils":125}],105:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.vertices=new ArrayBuffer(e),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},t}();r.default=i},{}],106:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("../../renderers/webgl/utils/ObjectRenderer")),l=n(t("../../renderers/webgl/WebGLRenderer")),d=n(t("../../utils/createIndicesForQuads")),p=n(t("./generateMultiTextureShader")),g=n(t("../../renderers/webgl/utils/checkMaxIfStatmentsInShader")),m=n(t("./BatchBuffer")),b=n(t("../../settings")),x=t("../../utils"),w=n(t("pixi-gl-core")),S=n(t("bit-twiddle")),O=0,M=0,P=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));n.vertSize=5,n.vertByteSize=4*n.vertSize,n.size=b.default.SPRITE_BATCH_SIZE,n.buffers=[];for(var s=1;s<=S.default.nextPow2(n.size);s*=2)n.buffers.push(new m.default(4*s*n.vertByteSize));n.indices=(0,d.default)(n.size),n.shader=null,n.currentIndex=0,n.groups=[];for(var a=0;a<n.size;a++)n.groups[a]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return n.sprites=[],n.vertexBuffers=[],n.vaos=[],n.vaoMax=2,n.vertexCount=0,n.renderer.on("prerender",n.onPrerender,n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),b.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,g.default)(this.MAX_TEXTURES,t)),this.shader=(0,p.default)(t,this.MAX_TEXTURES),this.indexBuffer=w.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.renderer.bindVao(null);for(var e=this.shader.attributes,r=0;r<this.vaoMax;r++){var n=this.vertexBuffers[r]=w.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),i=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(n,e.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(n,e.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(n,e.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);e.aTextureId&&i.addAttribute(n,e.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[r]=i}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},e.prototype.onPrerender=function(){this.vertexCount=0},e.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&(this.sprites[this.currentIndex++]=t)},e.prototype.flush=function(){if(0!==this.currentIndex){var t=this.renderer.gl,e=this.MAX_TEXTURES,r=S.default.nextPow2(this.currentIndex),n=S.default.log2(r),i=this.buffers[n],o=this.sprites,s=this.groups,a=i.float32View,u=i.uint32View,h=this.boundTextures,l=this.renderer.boundTextures,c=this.renderer.textureGC.count,d=0,f=void 0,p=void 0,v=1,g=0,y=s[0],m=void 0,_=void 0,T=x.premultiplyBlendMode[o[0]._texture.baseTexture.premultipliedAlpha?1:0][o[0].blendMode];y.textureCount=0,y.start=0,y.blend=T,O++;var E=void 0;for(E=0;E<e;++E){var P=l[E];P._enabled!==O?((h[E]=P)._virtalBoundId=E,P._enabled=O):h[E]=this.renderer.emptyTextures[E]}for(O++,E=0;E<this.currentIndex;++E){var C=o[E];o[E]=null,f=C._texture.baseTexture;var R=x.premultiplyBlendMode[Number(f.premultipliedAlpha)][C.blendMode];if(T!==R&&(T=R,p=null,g=e,O++),p!==f&&(p=f)._enabled!==O){if(g===e&&(O++,y.size=E-y.start,g=0,(y=s[v++]).blend=T,y.textureCount=0,y.start=E),f.touched=c,-1===f._virtalBoundId)for(var A=0;A<e;++A){var I=(A+M)%e,D=h[I];if(D._enabled!==O){M++,D._virtalBoundId=-1,h[f._virtalBoundId=I]=f;break}}f._enabled=O,y.textureCount++,y.ids[g]=f._virtalBoundId,y.textures[g++]=f}if(m=C.vertexData,_=C._texture._uvs.uvsUint32,this.renderer.roundPixels){var L=this.renderer.resolution;a[d]=(m[0]*L|0)/L,a[d+1]=(m[1]*L|0)/L,a[d+5]=(m[2]*L|0)/L,a[d+6]=(m[3]*L|0)/L,a[d+10]=(m[4]*L|0)/L,a[d+11]=(m[5]*L|0)/L,a[d+15]=(m[6]*L|0)/L,a[d+16]=(m[7]*L|0)/L}else a[d]=m[0],a[d+1]=m[1],a[d+5]=m[2],a[d+6]=m[3],a[d+10]=m[4],a[d+11]=m[5],a[d+15]=m[6],a[d+16]=m[7];u[d+2]=_[0],u[d+7]=_[1],u[d+12]=_[2],u[d+17]=_[3];var N=Math.min(C.worldAlpha,1),B=N<1&&f.premultipliedAlpha?(0,x.premultiplyTint)(C._tintRGB,N):C._tintRGB+(255*N<<24);u[d+3]=u[d+8]=u[d+13]=u[d+18]=B,a[d+4]=a[d+9]=a[d+14]=a[d+19]=f._virtalBoundId,d+=20}if(y.size=E-y.start,b.default.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(i.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;var k=this.shader.attributes,F=this.vertexBuffers[this.vertexCount]=w.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),j=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(F,k.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(F,k.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(F,k.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);k.aTextureId&&j.addAttribute(F,k.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=j}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(i.vertices,0,!1),this.vertexCount++}for(E=0;E<e;++E)l[E]._virtalBoundId=-1;for(E=0;E<v;++E){for(var U=s[E],X=U.textureCount,G=0;G<X;G++)p=U.textures[G],l[U.ids[G]]!==p&&this.renderer.bindTexture(p,U.ids[G],!0),p._virtalBoundId=-1;this.renderer.state.setBlendMode(U.blend),t.drawElements(t.TRIANGLES,6*U.size,t.UNSIGNED_SHORT,6*U.start*2)}this.currentIndex=0}},e.prototype.start=function(){this.renderer.bindShader(this.shader),b.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this.vaoMax;e++)this.vertexBuffers[e]&&this.vertexBuffers[e].destroy(),this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var r=0;r<this.buffers.length;++r)this.buffers[r].destroy()},e}(u.default);r.default=P,l.default.registerPlugin("sprite",P)},{"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":97,"../../settings":101,"../../utils":125,"../../utils/createIndicesForQuads":123,"./BatchBuffer":105,"./generateMultiTextureShader":107,"bit-twiddle":1,"pixi-gl-core":15}],107:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e){var r=a;r=(r=r.replace(/%count%/gi,e)).replace(/%forloop%/gi,function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)0<r&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}(e));for(var n=new s.default(t,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",r),o=[],u=0;u<e;u++)o[u]=u;return n.bind(),n.uniforms.uSamplers=o,n};var s=function(t){return t&&t.__esModule?t:{default:t}}(t("../../Shader")),a=(t("path"),["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","%forloop%","gl_FragColor = color * vColor;","}"].join("\n"))},{"../../Shader":44,path:8}],108:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),h=n(t("../sprites/Sprite")),c=n(t("../textures/Texture")),d=t("../math"),f=t("../utils"),p=t("../const"),g=n(t("../settings")),m=n(t("./TextStyle")),b=n(t("./TextMetrics")),T=n(t("../utils/trimCanvas")),w={texture:!0,children:!1,baseTexture:!0},E=function(t){function e(r,n,s){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),(s=s||document.createElement("canvas")).width=3,s.height=3;var a=c.default.fromCanvas(s,g.default.SCALE_MODE,"text");a.orig=new d.Rectangle,a.trim=new d.Rectangle;var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,a));return c.default.addToCache(u._texture,u._texture.baseTexture.textureCacheIds[0]),u.canvas=s,u.context=u.canvas.getContext("2d"),u.resolution=g.default.RESOLUTION,u._text=null,u._style=null,u._styleListener=null,u._font="",u.text=r,u.style=n,u.localStyleID=-1,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var r=this.context,n=b.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),i=n.width,o=n.height,s=n.lines,a=n.lineHeight,u=n.lineWidths,h=n.maxLineWidth,l=n.fontProperties;this.canvas.width=Math.ceil((Math.max(1,i)+2*e.padding)*this.resolution),this.canvas.height=Math.ceil((Math.max(1,o)+2*e.padding)*this.resolution),r.scale(this.resolution,this.resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.strokeStyle=e.stroke,r.lineWidth=e.strokeThickness,r.textBaseline=e.textBaseline,r.lineJoin=e.lineJoin,r.miterLimit=e.miterLimit;var c=void 0,d=void 0;if(e.dropShadow){r.fillStyle=e.dropShadowColor,r.globalAlpha=e.dropShadowAlpha,r.shadowBlur=e.dropShadowBlur,0<e.dropShadowBlur&&(r.shadowColor=e.dropShadowColor);for(var f=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,p=Math.sin(e.dropShadowAngle)*e.dropShadowDistance,v=0;v<s.length;v++)c=e.strokeThickness/2,d=e.strokeThickness/2+v*a+l.ascent,"right"===e.align?c+=h-u[v]:"center"===e.align&&(c+=(h-u[v])/2),e.fill&&(this.drawLetterSpacing(s[v],c+f+e.padding,d+p+e.padding),e.stroke&&e.strokeThickness&&(r.strokeStyle=e.dropShadowColor,this.drawLetterSpacing(s[v],c+f+e.padding,d+p+e.padding,!0),r.strokeStyle=e.stroke))}r.shadowBlur=0,r.globalAlpha=1,r.fillStyle=this._generateFillStyle(e,s);for(var g=0;g<s.length;g++)c=e.strokeThickness/2,d=e.strokeThickness/2+g*a+l.ascent,"right"===e.align?c+=h-u[g]:"center"===e.align&&(c+=(h-u[g])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(s[g],c+e.padding,d+e.padding,!0),e.fill&&this.drawLetterSpacing(s[g],c+e.padding,d+e.padding);this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],o=this._style.letterSpacing;if(0!==o)for(var s=String.prototype.split.call(t,""),a=e,u=0,h="";u<t.length;)h=s[u++],n?this.context.strokeText(h,a,r):this.context.fillText(h,a,r),a+=this.context.measureText(h).width+o;else n?this.context.strokeText(t,e,r):this.context.fillText(t,e,r)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=(0,T.default)(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var r=this._texture,n=this._style,i=n.trim?0:n.padding,o=r.baseTexture;o.hasLoaded=!0,o.resolution=this.resolution,o.realWidth=t.width,o.realHeight=t.height,o.width=t.width/this.resolution,o.height=t.height/this.resolution,r.trim.width=r._frame.width=t.width/this.resolution,r.trim.height=r._frame.height=t.height/this.resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-2*i,r.orig.height=r._frame.height-2*i,this._onTextureUpdate(),o.emit("update",o),this.dirty=!1},e.prototype.renderWebGL=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype.renderWebGL.call(this,e)},e.prototype._renderCanvas=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._renderCanvas.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e){if(!Array.isArray(t.fill))return t.fill;if(navigator.isCocoonJS)return t.fill[0];var r=void 0,n=void 0,i=void 0,o=void 0,s=this.canvas.width/this.resolution,a=this.canvas.height/this.resolution,u=t.fill.slice(),h=t.fillGradientStops.slice();if(!h.length)for(var l=u.length+1,c=1;c<l;++c)h.push(c/l);if(u.unshift(t.fill[0]),h.unshift(0),u.push(t.fill[t.fill.length-1]),h.push(1),t.fillGradientType===p.TEXT_GRADIENT.LINEAR_VERTICAL){r=this.context.createLinearGradient(s/2,0,s/2,a),n=(u.length+1)*e.length;for(var d=i=0;d<e.length;d++){i+=1;for(var f=0;f<u.length;f++)o="number"==typeof h[f]?h[f]/e.length+d/e.length:i/n,r.addColorStop(o,u[f]),i++}}else{r=this.context.createLinearGradient(0,a/2,s,a/2),n=u.length+1,i=1;for(var v=0;v<u.length;v++)o="number"==typeof h[v]?h[v]:i/n,r.addColorStop(o,u[v]),i++}return r},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},w,e),t.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},a(e,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=(0,f.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=(0,f.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"style",get:function(){return this._style},set:function(t){(t=t||{})instanceof m.default?this._style=t:this._style=new m.default(t),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=String(""===t||null==t?" ":t),this._text!==t&&(this._text=t,this.dirty=!0)}}]),e}(h.default);r.default=E},{"../const":46,"../math":70,"../settings":101,"../sprites/Sprite":102,"../textures/Texture":115,"../utils":125,"../utils/trimCanvas":130,"./TextMetrics":109,"./TextStyle":110}],109:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(e,r,i,o,s,a,u,h,l){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.text=e,this.style=r,this.width=i,this.height=o,this.lines=s,this.lineWidths=a,this.lineHeight=u,this.maxLineWidth=h,this.fontProperties=l}return t.measureText=function(e,r,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:t._canvas;n=null==n?r.wordWrap:n;var o=r.toFontString(),s=t.measureFont(o),a=i.getContext("2d");a.font=o;for(var h=(n?t.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),l=new Array(h.length),c=0,d=0;d<h.length;d++){var f=a.measureText(h[d]).width+(h[d].length-1)*r.letterSpacing;l[d]=f,c=Math.max(c,f)}var p=c+r.strokeThickness;r.dropShadow&&(p+=r.dropShadowDistance);var v=r.lineHeight||s.fontSize+r.strokeThickness,g=Math.max(v,s.fontSize+r.strokeThickness)+(h.length-1)*(v+r.leading);return r.dropShadow&&(g+=r.dropShadowDistance),new t(e,r,p,g,h,l,v+r.leading,c,s)},t.wordWrap=function(e,r){for(var i=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:t._canvas).getContext("2d"),o=0,s="",a="",u={},h=r.letterSpacing,l=r.whiteSpace,c=t.collapseSpaces(l),d=t.collapseNewlines(l),f=!c,p=r.wordWrapWidth+h,v=t.tokenize(e),g=0;g<v.length;g++){var y=v[g];if(t.isNewline(y)){if(!d){a+=t.addLine(s),f=!c,s="",o=0;continue}y=" "}if(c){var m=t.isBreakingSpace(y),_=t.isBreakingSpace(s[s.length-1]);if(m&&_)continue}var b=t.getFromCache(y,h,u,i);if(p<b)if(""!==s&&(a+=t.addLine(s),s="",o=0),t.canBreakWords(y,r.breakWords))for(var x=y.split(""),T=0;T<x.length;T++){for(var w=x[T],E=1;x[T+E];){var S=x[T+E],O=w[w.length-1];if(t.canBreakChars(O,S,y,T,r.breakWords))break;w+=S,E++}T+=w.length-1;var M=t.getFromCache(w,h,u,i);p<M+o&&(a+=t.addLine(s),f=!1,s="",o=0),s+=w,o+=M}else{0<s.length&&(a+=t.addLine(s),s="",o=0);var P=g===v.length-1;a+=t.addLine(y,!P),f=!1,s="",o=0}else p<b+o&&(f=!1,a+=t.addLine(s),s="",o=0),(0<s.length||!t.isBreakingSpace(y)||f)&&(s+=y,o+=b)}return a+t.addLine(s,!1)},t.addLine=function(e){var r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return e=t.trimRight(e),r?e+"\n":e},t.getFromCache=function(t,e,r,n){var i=r[t];if(void 0===i){var o=t.length*e;i=n.measureText(t).width+o,r[t]=i}return i},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var r=e.length-1;0<=r;r--){var n=e[r];if(!t.isBreakingSpace(n))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&0<=t._newlines.indexOf(e.charCodeAt(0))},t.isBreakingSpace=function(e){return"string"==typeof e&&0<=t._breakingSpaces.indexOf(e.charCodeAt(0))},t.tokenize=function(e){var r=[],n="";if("string"!=typeof e)return r;for(var i=0;i<e.length;i++){var o=e[i];t.isBreakingSpace(o)||t.isNewline(o)?(""!==n&&(r.push(n),n=""),r.push(o)):n+=o}return""!==n&&r.push(n),r},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,r,n,i){return!0},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var r={},n=t._canvas,i=t._context;i.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(i.measureText(o).width),a=Math.ceil(i.measureText(t.BASELINE_SYMBOL).width),u=2*a;a=a*t.BASELINE_MULTIPLIER|0,n.width=s,n.height=u,i.fillStyle="#f00",i.fillRect(0,0,s,u),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,a);var h=i.getImageData(0,0,s,u).data,l=h.length,c=4*s,d=0,f=0,p=!1;for(d=0;d<a;++d){for(var v=0;v<c;v+=4)if(255!==h[f+v]){p=!0;break}if(p)break;f+=c}for(r.ascent=a-d,f=l-c,p=!1,d=u;a<d;--d){for(var g=0;g<c;g+=4)if(255!==h[f+g]){p=!0;break}if(p)break;f-=c}return r.descent=d-a,r.fontSize=r.ascent+r.descent,t._fonts[e]=r},t.clearMetrics=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";e?delete t._fonts[e]:t._fonts={}},t}();r.default=i;var o=document.createElement("canvas");o.width=o.height=10,i._canvas=o,i._context=o.getContext("2d"),i._fonts={},i.METRICS_STRING="|q",i.BASELINE_SYMBOL="M",i.BASELINE_MULTIPLIER=1.4,i._newlines=[10,13],i._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},{}],110:[function(t,e,r){"use strict";function i(t){return"number"==typeof t?(0,l.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function o(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=i(t[e]);return t}return i(t)}function a(t,e,r){for(var n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}r.__esModule=!0;var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),h=t("../const"),l=t("../utils"),c={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:h.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},d=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],f=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.styleID=0,this.reset(),a(this,e,e)}return t.prototype.clone=function(){var e={};return a(e,this,c),new t(e)},t.prototype.reset=function(){a(this,c,c)},t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;0<=r;r--){var n=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&d.indexOf(n)<0&&(n='"'+n+'"'),e[r]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},u(t,[{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(t){var e=o(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(t){var e=o(t);this._fill!==e&&(this._fill=e,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(t){!function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}(this._fillGradientStops,t)&&(this._fillGradientStops=t,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(t){var e=o(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}}]),t}();r.default=f},{"../const":46,"../utils":125}],111:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("./BaseTexture")),l=n(t("../settings")),c=function(t){function e(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,s=arguments[2],a=arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,null,s));return u.resolution=a||l.default.RESOLUTION,u.width=Math.ceil(r),u.height=Math.ceil(n),u.realWidth=u.width*u.resolution,u.realHeight=u.height*u.resolution,u.scaleMode=void 0!==s?s:l.default.SCALE_MODE,u.hasLoaded=!0,u._glRenderTargets={},u._canvasRenderTarget=null,u.valid=!1,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),t===this.width&&e===this.height||(this.valid=0<t&&0<e,this.width=t,this.height=e,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.renderer=null},e}(u.default);r.default=c},{"../settings":101,"./BaseTexture":112}],112:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=t("../utils"),h=n(t("../settings")),c=n(t("eventemitter3")),f=n(t("../utils/determineCrossOrigin")),v=n(t("bit-twiddle")),g=function(t){function e(r,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return u.uid=(0,a.uid)(),u.touched=0,u.resolution=s||h.default.RESOLUTION,u.width=100,u.height=100,u.realWidth=100,u.realHeight=100,u.scaleMode=void 0!==n?n:h.default.SCALE_MODE,u.hasLoaded=!1,u.isLoading=!1,u.source=null,u.origSource=null,u.imageType=null,u.sourceScale=1,u.premultipliedAlpha=!0,u.imageUrl=null,u.isPowerOfTwo=!1,u.mipmap=h.default.MIPMAP_TEXTURES,u.wrapMode=h.default.WRAP_MODE,u._glTextures={},u._enabled=0,u._virtalBoundId=-1,u._destroyed=!1,u.textureCacheIds=[],r&&u.loadSource(r),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},e.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=v.default.isPow2(this.realWidth)&&v.default.isPow2(this.realHeight)},e.prototype.loadSource=function(t){var e=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null);var r=!this.source;if(((this.source=t).src&&t.complete||t.getContext)&&t.width&&t.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),r&&this.emit("loaded",this);else if(!t.getContext){this.isLoading=!0;var n=this;if(t.onload=function(){if(n._updateImageType(),t.onload=null,t.onerror=null,n.isLoading){if(n.isLoading=!1,n._sourceLoaded(),"svg"===n.imageType)return void n._loadSvgSource();n.emit("loaded",n)}},t.onerror=function(){t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n.emit("error",n))},t.complete&&t.src){if(t.onload=null,t.onerror=null,"svg"===n.imageType)return void n._loadSvgSource();this.isLoading=!1,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this)}}},e.prototype._updateImageType=function(){if(this.imageUrl){var t=(0,a.decomposeDataUri)(this.imageUrl),e=void 0;if(t&&"image"===t.mediaType){var r=t.subType.split("+")[0];if(!(e=(0,a.getUrlFileExtension)("."+r)))throw new Error("Invalid image type in data URI.")}else(e=(0,a.getUrlFileExtension)(this.imageUrl))||(e="png");this.imageType=e}},e.prototype._loadSvgSource=function(){if("svg"===this.imageType){var t=(0,a.decomposeDataUri)(this.imageUrl);t?this._loadSvgSourceUsingDataUri(t):this._loadSvgSourceUsingXhr()}},e.prototype._loadSvgSourceUsingDataUri=function(t){var e=void 0;if("base64"===t.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");e=atob(t.data)}else e=t.data;this._loadSvgSourceUsingString(e)},e.prototype._loadSvgSourceUsingXhr=function(){var t=this,e=new XMLHttpRequest;e.onload=function(){if(e.readyState!==e.DONE||200!==e.status)throw new Error("Failed to load SVG using XHR.");t._loadSvgSourceUsingString(e.response)},e.onerror=function(){return t.emit("error",t)},e.open("GET",this.imageUrl,!0),e.send()},e.prototype._loadSvgSourceUsingString=function(t){var r=(0,a.getSvgSize)(t),n=r.width,i=r.height;if(!n||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(n*this.sourceScale),this.realHeight=Math.round(i*this.sourceScale),this._updateDimensions();var o=document.createElement("canvas");o.width=this.realWidth,o.height=this.realHeight,o._pixiId="canvas_"+(0,a.uid)(),o.getContext("2d").drawImage(this.source,0,0,n,i,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=o,e.addToCache(this,o._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},e.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},e.prototype.destroy=function(){this.imageUrl&&(delete a.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},e.fromImage=function(t,r,n,i){var o=a.BaseTextureCache[t];if(!o){var s=new Image;void 0===r&&0!==t.indexOf("data:")?s.crossOrigin=(0,f.default)(t):r&&(s.crossOrigin="string"==typeof r?r:"anonymous"),(o=new e(s,n)).imageUrl=t,i&&(o.sourceScale=i),o.resolution=(0,a.getResolutionOfUrl)(t),s.src=t,e.addToCache(o,t)}return o},e.fromCanvas=function(t,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"canvas";t._pixiId||(t._pixiId=n+"_"+(0,a.uid)());var i=a.BaseTextureCache[t._pixiId];return i||(i=new e(t,r),e.addToCache(i,t._pixiId)),i},e.from=function(t,r,n){if("string"==typeof t)return e.fromImage(t,void 0,r,n);if(t instanceof HTMLImageElement){var i=t.src,o=a.BaseTextureCache[i];return o||((o=new e(t,r)).imageUrl=i,n&&(o.sourceScale=n),o.resolution=(0,a.getResolutionOfUrl)(i),e.addToCache(o,i)),o}return t instanceof HTMLCanvasElement?e.fromCanvas(t,r):t},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),a.BaseTextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=a.BaseTextureCache[t];if(e){var r=e.textureCacheIds.indexOf(t);return-1<r&&e.textureCacheIds.splice(r,1),delete a.BaseTextureCache[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)delete a.BaseTextureCache[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},e}(c.default);r.default=g},{"../settings":101,"../utils":125,"../utils/determineCrossOrigin":124,"bit-twiddle":1,eventemitter3:3}],113:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("./BaseRenderTexture")),c=function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=null;if(!(r instanceof u.default)){var a=arguments[1],h=arguments[2],l=arguments[3],c=arguments[4];console.warn("Please use RenderTexture.create("+a+", "+h+") instead of the ctor directly."),s=arguments[0],n=null,r=new u.default(a,h,l,c)}var d=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return d.legacyRenderer=s,d.valid=!0,d._updateUvs(),d}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e,r){t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,r||this.baseTexture.resize(t,e),this._updateUvs()},e.create=function(t,r,n,i){return new e(new u.default(t,r,n,i))},e}(n(t("./Texture")).default);r.default=c},{"./BaseRenderTexture":111,"./Texture":115}],114:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("../"),s=t("../utils"),a=function(){function t(e,r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.baseTexture=e,this.textures={},this.animations={},this.data=r,this.resolution=this._updateResolution(i||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return i(t,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),t.prototype._updateResolution=function(t){var e=this.data.meta.scale,r=(0,s.getResolutionOfUrl)(t,null);return null===r&&(r=void 0!==e?parseFloat(e):1),1!==r&&(this.baseTexture.resolution=r,this.baseTexture.update()),r},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var r=e,n=t.BATCH_SIZE,i=this.baseTexture.sourceScale;r-e<n&&r<this._frameKeys.length;){var s=this._frameKeys[r],a=this._frames[s],u=a.frame;if(u){var h,l=null,c=!1!==a.trimmed&&a.sourceSize?a.sourceSize:a.frame,d=new o.Rectangle(0,0,Math.floor(c.w*i)/this.resolution,Math.floor(c.h*i)/this.resolution);h=a.rotated?new o.Rectangle(Math.floor(u.x*i)/this.resolution,Math.floor(u.y*i)/this.resolution,Math.floor(u.h*i)/this.resolution,Math.floor(u.w*i)/this.resolution):new o.Rectangle(Math.floor(u.x*i)/this.resolution,Math.floor(u.y*i)/this.resolution,Math.floor(u.w*i)/this.resolution,Math.floor(u.h*i)/this.resolution),!1!==a.trimmed&&a.spriteSourceSize&&(l=new o.Rectangle(Math.floor(a.spriteSourceSize.x*i)/this.resolution,Math.floor(a.spriteSourceSize.y*i)/this.resolution,Math.floor(u.w*i)/this.resolution,Math.floor(u.h*i)/this.resolution)),this.textures[s]=new o.Texture(this.baseTexture,h,d,l,a.rotated?2:0,a.anchor),o.Texture.addToCache(this.textures[s],s)}r++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];var r=t[e],n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var o;if(n){if(i>=r.length)break;o=r[i++]}else{if((i=r.next()).done)break;o=i.value}var s=o;this.animations[e].push(this.textures[s])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())},0)},t.prototype.destroy=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];for(var e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},t}();r.default=a},{"../":65,"../utils":125}],115:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}r.__esModule=!0;var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=n(t("./BaseTexture")),d=n(t("./VideoBaseTexture")),p=n(t("./TextureUvs")),g=n(t("eventemitter3")),y=t("../math"),m=t("../utils"),b=n(t("../settings")),x=function(t){function e(r,n,s,a,u,h){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));if(l.noFrame=!1,n||(l.noFrame=!0,n=new y.Rectangle(0,0,1,1)),r instanceof e&&(r=r.baseTexture),l.baseTexture=r,l._frame=n,l.trim=a,l.valid=!1,l.requiresUpdate=!1,l._uvs=null,l.orig=s||n,l._rotate=Number(u||0),!0===u)l._rotate=2;else if(l._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return r.hasLoaded?(l.noFrame&&(n=new y.Rectangle(0,0,r.width,r.height),r.on("update",l.onBaseTextureUpdated,l)),l.frame=n):r.once("loaded",l.onBaseTextureLoaded,l),l.defaultAnchor=h?new y.Point(h.x,h.y):new y.Point(0,0),l._updateID=0,l.transform=null,l.textureCacheIds=[],l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){this.baseTexture.update()},e.prototype.onBaseTextureLoaded=function(t){this._updateID++,this.noFrame?this.frame=new y.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},e.prototype.onBaseTextureUpdated=function(t){this._updateID++,this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},e.prototype.destroy=function(t){this.baseTexture&&(t&&(m.TextureCache[this.baseTexture.imageUrl]&&e.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},e.prototype._updateUvs=function(){this._uvs||(this._uvs=new p.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.fromImage=function(t,r,n,i){var o=m.TextureCache[t];return o||(o=new e(l.default.fromImage(t,r,n,i)),e.addToCache(o,t)),o},e.fromFrame=function(t){var e=m.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},e.fromCanvas=function(t,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"canvas";return new e(l.default.fromCanvas(t,r,n))},e.fromVideo=function(t,r,n,i){return"string"==typeof t?e.fromVideoUrl(t,r,n,i):new e(d.default.fromVideo(t,r,i))},e.fromVideoUrl=function(t,r,n,i){return new e(d.default.fromUrl(t,r,n,i))},e.from=function(t){if("string"!=typeof t)return t instanceof HTMLImageElement?new e(l.default.from(t)):t instanceof HTMLCanvasElement?e.fromCanvas(t,b.default.SCALE_MODE,"HTMLCanvasElement"):t instanceof HTMLVideoElement?e.fromVideo(t):t instanceof l.default?new e(t):t;var r=m.TextureCache[t];return r||(null!==t.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?e.fromVideoUrl(t):e.fromImage(t))},e.fromLoader=function(t,r,n){var i=new l.default(t,void 0,(0,m.getResolutionOfUrl)(r)),o=new e(i);return i.imageUrl=r,n||(n=r),l.default.addToCache(o.baseTexture,n),e.addToCache(o,n),n!==r&&(l.default.addToCache(o.baseTexture,r),e.addToCache(o,r)),o},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),m.TextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=m.TextureCache[t];if(e){var r=e.textureCacheIds.indexOf(t);return-1<r&&e.textureCacheIds.splice(r,1),delete m.TextureCache[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)m.TextureCache[t.textureCacheIds[n]]===t&&delete m.TextureCache[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},u(e,[{key:"frame",get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,n=t.width,i=t.height,o=e+n>this.baseTexture.width,s=r+i>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",u="X: "+e+" + "+n+" = "+(e+n)+" > "+this.baseTexture.width,h="Y: "+r+" + "+i+" = "+(r+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+a+" "+h)}this.valid=n&&i&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=t),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),e}(g.default);(r.default=x).EMPTY=new x(new l.default),a(x.EMPTY),a(x.EMPTY.baseTexture),x.WHITE=function(){var t=document.createElement("canvas");t.width=10,t.height=10;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,10,10),new x(new l.default(t))}(),a(x.WHITE),a(x.WHITE.baseTexture)},{"../math":70,"../settings":101,"../utils":125,"./BaseTexture":112,"./TextureUvs":117,"./VideoBaseTexture":118,eventemitter3:3}],116:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(t){return t&&t.__esModule?t:{default:t}}(t("../math/Matrix")),a=new s.default,u=function(){function t(e,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._texture=e,this.mapCoord=new s.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=void 0===r?.5:r}return t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,n=0;n<t.length;n+=2){var i=t[n],o=t[n+1];e[n]=i*r.a+o*r.c+r.tx,e[n+1]=i*r.b+o*r.d+r.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._lastTextureID===e._updateID)return!1;this._lastTextureID=e._updateID;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=e.orig,i=e.trim;i&&(a.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(a));var o=e.baseTexture,s=this.uClampFrame,u=this.clampMargin/o.resolution,h=this.clampOffset;return s[0]=(e._frame.x+u+h)/o.width,s[1]=(e._frame.y+u+h)/o.height,s[2]=(e._frame.x+e._frame.width-u+h)/o.width,s[3]=(e._frame.y+e._frame.height-u+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,!0},i(t,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this._lastTextureID=-1}}]),t}();r.default=u},{"../math/Matrix":67}],117:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){return t&&t.__esModule?t:{default:t}}(t("../math/GroupD8")),s=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return t.prototype.set=function(t,e,r){var n=e.width,i=e.height;if(r){var s=t.width/2/n,a=t.height/2/i,u=t.x/n+s,h=t.y/i+a;r=o.default.add(r,o.default.NW),this.x0=u+s*o.default.uX(r),this.y0=h+a*o.default.uY(r),r=o.default.add(r,2),this.x1=u+s*o.default.uX(r),this.y1=h+a*o.default.uY(r),r=o.default.add(r,2),this.x2=u+s*o.default.uX(r),this.y2=h+a*o.default.uY(r),r=o.default.add(r,2),this.x3=u+s*o.default.uX(r),this.y3=h+a*o.default.uY(r)}else this.x0=t.x/n,this.y0=t.y/i,this.x1=(t.x+t.width)/n,this.y1=t.y/i,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/i,this.x3=t.x/n,this.y3=(t.y+t.height)/i;this.uvsUint32[0]=(65535&Math.round(65535*this.y0))<<16|65535&Math.round(65535*this.x0),this.uvsUint32[1]=(65535&Math.round(65535*this.y1))<<16|65535&Math.round(65535*this.x1),this.uvsUint32[2]=(65535&Math.round(65535*this.y2))<<16|65535&Math.round(65535*this.x2),this.uvsUint32[3]=(65535&Math.round(65535*this.y3))<<16|65535&Math.round(65535*this.x3)},t}();r.default=s},{"../math/GroupD8":66}],118:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!e){var r=t.split("?").shift().toLowerCase();e="video/"+r.substr(r.lastIndexOf(".")+1)}var n=document.createElement("source");return n.src=t,n.type=e,n}r.__esModule=!0;var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=n(t("./BaseTexture")),c=t("../utils"),d=t("../ticker"),f=t("../const"),v=n(t("../utils/determineCrossOrigin")),g=function(t){function e(r,n){var s=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),!r)throw new Error("No video source element specified.");(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));return a.width=r.videoWidth,a.height=r.videoHeight,a._autoUpdate=!0,a._isAutoUpdating=!1,a.autoPlay=s,a.update=a.update.bind(a),a._onCanPlay=a._onCanPlay.bind(a),r.addEventListener("play",a._onPlayStart.bind(a)),r.addEventListener("pause",a._onPlayStop.bind(a)),a.hasLoaded=!1,a.__loaded=!1,a._isSourceReady()?a._onCanPlay():(r.addEventListener("canplay",a._onCanPlay),r.addEventListener("canplaythrough",a._onCanPlay)),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._isSourcePlaying=function(){var t=this.source;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(d.shared.add(this.update,this,f.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},e.prototype._onPlayStop=function(){this._isAutoUpdating&&(d.shared.remove(this.update,this),this._isAutoUpdating=!1)},e.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},e.prototype.destroy=function(){this._isAutoUpdating&&d.shared.remove(this.update,this),this.source&&this.source._pixiId&&(l.default.removeFromCache(this.source._pixiId),delete this.source._pixiId,this.source.pause(),this.source.src="",this.source.load()),t.prototype.destroy.call(this)},e.fromVideo=function(t,r,n){t._pixiId||(t._pixiId="video_"+(0,c.uid)());var i=c.BaseTextureCache[t._pixiId];return i||(i=new e(t,r,n),l.default.addToCache(i,t._pixiId)),i},e.fromUrl=function(t,r,n,i){var o=document.createElement("video");o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline","");var s=Array.isArray(t)?t[0].src||t[0]:t.src||t;if(void 0===n&&0!==s.indexOf("data:")?o.crossOrigin=(0,v.default)(s):n&&(o.crossOrigin="string"==typeof n?n:"anonymous"),Array.isArray(t))for(var u=0;u<t.length;++u)o.appendChild(a(t[u].src||t[u],t[u].mime));else o.appendChild(a(s,t.mime));return o.load(),e.fromVideo(o,r,i)},u(e,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(d.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(d.shared.add(this.update,this,f.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),e}(l.default);(r.default=g).fromUrls=g.fromUrl},{"../const":46,"../ticker":121,"../utils":125,"../utils/determineCrossOrigin":124,"./BaseTexture":112}],119:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=n(t("../settings")),u=t("../const"),l=n(t("./TickerListener")),c=function(){function t(){var e=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._head=new l.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/a.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:u.UPDATE_PRIORITY.NORMAL;return this._addListener(new l.default(t,e,r))},t.prototype.addOnce=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:u.UPDATE_PRIORITY.NORMAL;return this._addListener(new l.default(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}e=(r=e).next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null},t.prototype.update=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:performance.now(),e=void 0;if(t>this.lastTime){(e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*a.default.TARGET_FPMS*this.speed;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=t},o(t,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,a.default.TARGET_FPMS);this._maxElapsedMS=1/e}}]),t}();r.default=c},{"../const":46,"../settings":101,"./TickerListener":120}],120:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.fn=e,this.context=r,this.priority=i,this.once=o,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return e=e||null,this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}();r.default=i},{}],121:[function(t,e,r){"use strict";r.__esModule=!0,r.Ticker=r.shared=void 0;var i=function(t){return t&&t.__esModule?t:{default:t}}(t("./Ticker")),o=new i.default;o.autoStart=!0,o.destroy=function(){},r.shared=o,r.Ticker=i.default},{"./Ticker":119}],122:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(){return!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))}},{}],123:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){for(var e=6*t,r=new Uint16Array(e),n=0,i=0;n<e;n+=6,i+=4)r[n+0]=i+0,r[n+1]=i+1,r[n+2]=i+2,r[n+3]=i+0,r[n+4]=i+2,r[n+5]=i+3;return r}},{}],124:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.location;if(0===t.indexOf("data:"))return"";e=e||window.location,s||(s=document.createElement("a")),s.href=t;var r=!(t=o.default.parse(s.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&r&&t.protocol===e.protocol?"":"anonymous"};var o=function(t){return t&&t.__esModule?t:{default:t}}(t("url")),s=void 0},{url:38}],125:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.premultiplyBlendMode=r.BaseTextureCache=r.TextureCache=r.earcut=r.mixins=r.pluginTarget=r.EventEmitter=r.removeItems=r.isMobile=void 0,r.uid=function(){return++U},r.hex2rgb=function(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},r.hex2string=function(t){return t=t.toString(16),"#"+("000000".substr(0,6-t.length)+t)},r.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},r.getResolutionOfUrl=function(t,e){var r=S.default.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1},r.decomposeDataUri=function(t){var e=w.DATA_URI.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}},r.getUrlFileExtension=function(t){var e=w.URL_FILE_EXTENSION.exec(t);if(e)return e[1].toLowerCase()},r.getSvgSize=function(t){var e=w.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r},r.skipHello=function(){X=!0},r.sayHello=function(t){if(!X){if(-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var e=["\n %c %c %c PixiJS "+w.VERSION+" -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("PixiJS "+w.VERSION+" - "+t+" - http://www.pixijs.com/");X=!0}},r.isWebGLSupported=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n=!(!r||!r.getContextAttributes().stencil);if(r){var i=r.getExtension("WEBGL_lose_context");i&&i.loseContext()}return r=null,n}catch(t){return!1}},r.sign=function(t){return 0===t?0:t<0?-1:1},r.destroyTextureCache=function(){var t=void 0;for(t in G)G[t].destroy();for(t in W)W[t].destroy()},r.clearTextureCache=function(){var t=void 0;for(t in G)delete G[t];for(t in W)delete W[t]},r.correctBlendMode=function(t,e){return H[e?1:0][t]},r.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,n=t>>8&255,i=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((n=n*e+.5|0)<<8)+(i=i*e+.5|0)},r.premultiplyRgba=function(t,e,r,n){return r=r||new Float32Array(4),n||void 0===n?(r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e):(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=e,r},r.premultiplyTintToRgba=function(t,e,r,n){return(r=r||new Float32Array(4))[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,!n&&void 0!==n||(r[0]*=e,r[1]*=e,r[2]*=e),r[3]=e,r};var w=t("../const"),S=i(t("../settings")),M=i(t("eventemitter3")),C=i(t("./pluginTarget")),A=n(t("./mixin")),D=n(t("ismobilejs")),N=i(t("remove-array-items")),k=i(t("./mapPremultipliedBlendModes")),j=i(t("earcut")),U=0,X=!1;r.isMobile=D,r.removeItems=N.default,r.EventEmitter=M.default,r.pluginTarget=C.default,r.mixins=A,r.earcut=j.default;var G=r.TextureCache=Object.create(null),W=r.BaseTextureCache=Object.create(null),H=r.premultiplyBlendMode=(0,k.default)()},{"../const":46,"../settings":101,"./mapPremultipliedBlendModes":126,"./mixin":128,"./pluginTarget":129,earcut:2,eventemitter3:3,ismobilejs:4,"remove-array-items":31}],126:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(){for(var t=[],e=[],r=0;r<32;r++)e[t[r]=r]=r;t[i.BLEND_MODES.NORMAL_NPM]=i.BLEND_MODES.NORMAL,t[i.BLEND_MODES.ADD_NPM]=i.BLEND_MODES.ADD,t[i.BLEND_MODES.SCREEN_NPM]=i.BLEND_MODES.SCREEN,e[i.BLEND_MODES.NORMAL]=i.BLEND_MODES.NORMAL_NPM,e[i.BLEND_MODES.ADD]=i.BLEND_MODES.ADD_NPM,e[i.BLEND_MODES.SCREEN]=i.BLEND_MODES.SCREEN_NPM;var n=[];return n.push(e),n.push(t),n};var i=t("../const")},{"../const":46}],127:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){return o.default.tablet||o.default.phone?4:t};var o=function(t){return t&&t.__esModule?t:{default:t}}(t("ismobilejs"))},{ismobilejs:4}],128:[function(t,e,r){"use strict";function n(t,e){if(t&&e)for(var r=Object.keys(e),n=0;n<r.length;++n){var i=r[n];Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}}r.__esModule=!0,r.mixin=n,r.delayMixin=function(t,e){s.push(t,e)},r.performMixins=function(){for(var t=0;t<s.length;t+=2)n(s[t],s[t+1]);s.length=0};var s=[]},{}],129:[function(t,e,r){"use strict";r.__esModule=!0,r.default={mixin:function(t){!function(t){t.__plugins={},t.registerPlugin=function(e,r){t.__plugins[e]=r},t.prototype.initPlugins=function(){for(var e in this.plugins=this.plugins||{},t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}(t)}}},{}],130:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){var e=t.width,r=t.height,n=t.getContext("2d"),o=n.getImageData(0,0,e,r).data,s=o.length,a={top:null,left:null,right:null,bottom:null},u=null,h=void 0,l=void 0,c=void 0;for(h=0;h<s;h+=4)0!==o[h+3]&&(l=h/4%e,c=~~(h/4/e),null===a.top&&(a.top=c),null===a.left?a.left=l:l<a.left&&(a.left=l),null===a.right?a.right=l+1:a.right<l&&(a.right=l+1),null===a.bottom?a.bottom=c:a.bottom<c&&(a.bottom=c));return null!==a.top&&(e=a.right-a.left,r=a.bottom-a.top+1,u=n.getImageData(a.left,a.top,e,r)),{height:r,width:e,data:u}}},{}],131:[function(t,e,r){"use strict";function n(t){if(!o[t]){var e=(new Error).stack;void 0===e?console.warn("Deprecation Warning: ",t):(e=e.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t),console.warn(e),console.groupEnd()):(console.warn("Deprecation Warning: ",t),console.warn(e))),o[t]=!0}}r.__esModule=!0,r.default=function(t){var e=t.mesh,r=t.particles,i=t.extras,o=t.filters,s=t.prepare,a=t.loaders,u=t.interaction;Object.defineProperties(t,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return n("You do not need to use a PIXI Stage any more, you can simply render any container."),t.Container}},DisplayObjectContainer:{get:function(){return n("DisplayObjectContainer has been shortened to Container, please use Container from now on."),t.Container}},Strip:{get:function(){return n("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),e.Mesh}},Rope:{get:function(){return n("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),e.Rope}},ParticleContainer:{get:function(){return n("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),r.ParticleContainer}},MovieClip:{get:function(){return n("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),i.AnimatedSprite}},TilingSprite:{get:function(){return n("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),i.TilingSprite}},BitmapText:{get:function(){return n("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),i.BitmapText}},blendModes:{get:function(){return n("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),t.BLEND_MODES}},scaleModes:{get:function(){return n("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),t.SCALE_MODES}},BaseTextureCache:{get:function(){return n("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),t.utils.BaseTextureCache}},TextureCache:{get:function(){return n("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),t.utils.TextureCache}},math:{get:function(){return n("The math namespace is deprecated, please access members already accessible on PIXI."),t}},AbstractFilter:{get:function(){return n("AstractFilter has been renamed to Filter, please use PIXI.Filter"),t.Filter}},TransformManual:{get:function(){return n("TransformManual has been renamed to TransformBase, please update your pixi-spine"),t.TransformBase}},TARGET_FPMS:{get:function(){return n("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),t.settings.TARGET_FPMS},set:function(e){n("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),t.settings.TARGET_FPMS=e}},FILTER_RESOLUTION:{get:function(){return n("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),t.settings.FILTER_RESOLUTION},set:function(e){n("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),t.settings.FILTER_RESOLUTION=e}},RESOLUTION:{get:function(){return n("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),t.settings.RESOLUTION},set:function(e){n("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),t.settings.RESOLUTION=e}},MIPMAP_TEXTURES:{get:function(){return n("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),t.settings.MIPMAP_TEXTURES},set:function(e){n("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),t.settings.MIPMAP_TEXTURES=e}},SPRITE_BATCH_SIZE:{get:function(){return n("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),t.settings.SPRITE_BATCH_SIZE},set:function(e){n("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),t.settings.SPRITE_BATCH_SIZE=e}},SPRITE_MAX_TEXTURES:{get:function(){return n("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),t.settings.SPRITE_MAX_TEXTURES},set:function(e){n("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),t.settings.SPRITE_MAX_TEXTURES=e}},RETINA_PREFIX:{get:function(){return n("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),t.settings.RETINA_PREFIX},set:function(e){n("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),t.settings.RETINA_PREFIX=e}},DEFAULT_RENDER_OPTIONS:{get:function(){return n("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),t.settings.RENDER_OPTIONS}}});for(var h=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],l=0;l<h.length;l++)!function(){var r=h[l];Object.defineProperty(t[r.parent],"DEFAULT",{get:function(){return n("PIXI."+r.parent+".DEFAULT has been deprecated, please use PIXI.settings."+r.target),t.settings[r.target]},set:function(e){n("PIXI."+r.parent+".DEFAULT has been deprecated, please use PIXI.settings."+r.target),t.settings[r.target]=e}})}();Object.defineProperties(t.settings,{PRECISION:{get:function(){return n("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),t.settings.PRECISION_FRAGMENT},set:function(e){n("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),t.settings.PRECISION_FRAGMENT=e}}}),i.AnimatedSprite&&Object.defineProperties(i,{MovieClip:{get:function(){return n("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),i.AnimatedSprite}}}),i&&Object.defineProperties(i,{TextureTransform:{get:function(){return n("The TextureTransform class has been renamed to TextureMatrix, please use PIXI.TextureMatrix from now on."),t.TextureMatrix}}}),t.DisplayObject.prototype.generateTexture=function(t,e,r){return n("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),t.generateTexture(this,e,r)},t.Graphics.prototype.generateTexture=function(t,e){return n("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(t,e)},t.GroupD8.isSwapWidthHeight=function(e){return n("GroupD8.isSwapWidthHeight was renamed to GroupD8.isVertical"),t.GroupD8.isVertical(e)},t.RenderTexture.prototype.render=function(t,e,r,i){this.legacyRenderer.render(t,this,r,e,!i),n("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},t.RenderTexture.prototype.getImage=function(t){return n("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(t)},t.RenderTexture.prototype.getBase64=function(t){return n("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(t)},t.RenderTexture.prototype.getCanvas=function(t){return n("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(t)},t.RenderTexture.prototype.getPixels=function(t){return n("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(t)},t.Sprite.prototype.setTexture=function(t){this.texture=t,n("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},i.BitmapText&&(i.BitmapText.prototype.setText=function(t){this.text=t,n("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")}),t.Text.prototype.setText=function(t){this.text=t,n("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},t.Text.calculateFontProperties=function(e){return n("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),t.TextMetrics.measureFont(e)},Object.defineProperties(t.Text,{fontPropertiesCache:{get:function(){return n("Text.fontPropertiesCache is deprecated"),t.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return n("Text.fontPropertiesCanvas is deprecated"),t.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return n("Text.fontPropertiesContext is deprecated"),t.TextMetrics._context}}}),t.Text.prototype.setStyle=function(t){this.style=t,n("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},t.Text.prototype.determineFontProperties=function(e){return n("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),t.TextMetrics.measureFont(e)},t.Text.getFontStyle=function(e){return n("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),(e=e||{})instanceof t.TextStyle||(e=new t.TextStyle(e)),e.toFontString()},Object.defineProperties(t.TextStyle.prototype,{font:{get:function(){n("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var t="number"==typeof this._fontSize?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+t+" "+this._fontFamily},set:function(t){n("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),1<t.indexOf("italic")?this._fontStyle="italic":-1<t.indexOf("oblique")?this._fontStyle="oblique":this._fontStyle="normal",-1<t.indexOf("small-caps")?this._fontVariant="small-caps":this._fontVariant="normal";var e=t.split(" "),r=-1;this._fontSize=26;for(var i=0;i<e.length;++i)if(e[i].match(/(px|pt|em|%)/)){r=i,this._fontSize=e[i];break}this._fontWeight="normal";for(var o=0;o<r;++o)if(e[o].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=e[o];break}if(-1<r&&r<e.length-1){this._fontFamily="";for(var s=r+1;s<e.length;++s)this._fontFamily+=e[s]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),t.Texture.prototype.setFrame=function(t){this.frame=t,n("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},t.Texture.addTextureToCache=function(e,r){t.Texture.addToCache(e,r),n("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},t.Texture.removeTextureFromCache=function(e){return n("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),t.BaseTexture.removeFromCache(e),t.Texture.removeFromCache(e)},Object.defineProperties(o,{AbstractFilter:{get:function(){return n("AstractFilter has been renamed to Filter, please use PIXI.Filter"),t.AbstractFilter}},SpriteMaskFilter:{get:function(){return n("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),t.SpriteMaskFilter}},VoidFilter:{get:function(){return n("VoidFilter has been renamed to AlphaFilter, please use PIXI.filters.AlphaFilter"),o.AlphaFilter}}}),t.utils.uuid=function(){return n("utils.uuid() is deprecated, please use utils.uid() from now on."),t.utils.uid()},t.utils.canUseNewCanvasBlendModes=function(){return n("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),t.CanvasTinter.canUseMultiply};var c=!0;if(Object.defineProperty(t.utils,"_saidHello",{set:function(t){t&&(n("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),c=t},get:function(){return c}}),s.BasePrepare&&(s.BasePrepare.prototype.register=function(t,e){return n("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),t&&this.registerFindHook(t),e&&this.registerUploadHook(e),this}),s.canvas&&Object.defineProperty(s.canvas,"UPLOADS_PER_FRAME",{set:function(){n("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return n("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),s.webgl&&Object.defineProperty(s.webgl,"UPLOADS_PER_FRAME",{set:function(){n("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return n("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),a.Loader){var d=a.Resource,f=a.Loader;Object.defineProperties(d.prototype,{isJson:{get:function(){return n("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===d.TYPE.JSON}},isXml:{get:function(){return n("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===d.TYPE.XML}},isImage:{get:function(){return n("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===d.TYPE.IMAGE}},isAudio:{get:function(){return n("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===d.TYPE.AUDIO}},isVideo:{get:function(){return n("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===d.TYPE.VIDEO}}}),Object.defineProperties(f.prototype,{before:{get:function(){return n("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return n("The after() method is deprecated, please use use()."),this.use}}})}u.interactiveTarget&&Object.defineProperty(u.interactiveTarget,"defaultCursor",{set:function(t){n("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=t},get:function(){return n("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}}),u.InteractionManager&&(Object.defineProperty(u.InteractionManager,"defaultCursorStyle",{set:function(t){n("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=t},get:function(){return n("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(u.InteractionManager,"currentCursorStyle",{set:function(t){n("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=t},get:function(){return n("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))};var o={}},{}],132:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),s=new o.Rectangle,a=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),(this.renderer=e).extract=this}return t.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,r=void 0,n=void 0,i=void 0,a=void 0;t&&(a=t instanceof o.RenderTexture?t:e.generateTexture(t)),a?(r=a.baseTexture._canvasRenderTarget.context,n=a.baseTexture._canvasRenderTarget.resolution,i=a.frame):(r=e.rootContext,n=e.resolution,(i=s).width=this.renderer.width,i.height=this.renderer.height);var u=i.width*n,h=i.height*n,l=new o.CanvasRenderTarget(u,h,1),c=r.getImageData(i.x*n,i.y*n,u,h);return l.context.putImageData(c,0,0),l.canvas},t.prototype.pixels=function(t){var e=this.renderer,r=void 0,n=void 0,i=void 0,a=void 0;return t&&(a=t instanceof o.RenderTexture?t:e.generateTexture(t)),a?(r=a.baseTexture._canvasRenderTarget.context,n=a.baseTexture._canvasRenderTarget.resolution,i=a.frame):(r=e.rootContext,(i=s).width=e.width,i.height=e.height),r.getImageData(0,0,i.width*n,i.height*n).data},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();r.default=a,o.CanvasRenderer.registerPlugin("extract",a)},{"../../core":65}],133:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./webgl/WebGLExtract");Object.defineProperty(r,"webgl",{enumerable:!0,get:function(){return n(i).default}});var o=t("./canvas/CanvasExtract");Object.defineProperty(r,"canvas",{enumerable:!0,get:function(){return n(o).default}})},{"./canvas/CanvasExtract":132,"./webgl/WebGLExtract":134}],134:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),s=new o.Rectangle,a=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),(this.renderer=e).extract=this}return t.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,r=void 0,n=void 0,i=void 0,a=!1,u=void 0,h=!1;t&&(t instanceof o.RenderTexture?u=t:(u=this.renderer.generateTexture(t),h=!0)),u?(n=(r=u.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,i=u.frame,a=!1):(n=(r=this.renderer.rootRenderTarget).resolution,a=!0,(i=s).width=r.size.width,i.height=r.size.height);var l=i.width*n,c=i.height*n,d=new o.CanvasRenderTarget(l,c,1);if(r){e.bindRenderTarget(r);var f=new Uint8Array(4*l*c),p=e.gl;p.readPixels(i.x*n,i.y*n,l,c,p.RGBA,p.UNSIGNED_BYTE,f);var v=d.context.getImageData(0,0,l,c);v.data.set(f),d.context.putImageData(v,0,0),a&&(d.context.scale(1,-1),d.context.drawImage(d.canvas,0,-c))}return h&&u.destroy(!0),d.canvas},t.prototype.pixels=function(t){var e=this.renderer,r=void 0,n=void 0,i=void 0,a=void 0,u=!1;t&&(t instanceof o.RenderTexture?a=t:(a=this.renderer.generateTexture(t),u=!0)),a?(n=(r=a.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,i=a.frame):(n=(r=this.renderer.rootRenderTarget).resolution,(i=s).width=r.size.width,i.height=r.size.height);var h=i.width*n,l=i.height*n,c=new Uint8Array(4*h*l);if(r){e.bindRenderTarget(r);var d=e.gl;d.readPixels(i.x*n,i.y*n,h,l,d.RGBA,d.UNSIGNED_BYTE,c)}return u&&a.destroy(!0),c},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();r.default=a,o.WebGLRenderer.registerPlugin("extract",a)},{"../../core":65}],135:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),h=function(t){function e(r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r[0]instanceof u.Texture?r[0]:r[0].texture));return s._textures=null,s._durations=null,s.textures=r,s._autoUpdate=!1!==o,s.animationSpeed=1,s.loop=!0,s.updateAnchor=!1,s.onComplete=null,s.onFrameChange=null,s.onLoop=null,s._currentTime=0,s.playing=!1,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&u.ticker.shared.remove(this.update,this))},e.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&u.ticker.shared.add(this.update,this,u.UPDATE_PRIORITY.HIGH))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,r=this.currentFrame;if(null!==this._durations){var n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(0<this.animationSpeed&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())},e.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.updateAnchor&&this._anchor.copy(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame)},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e)},e.fromFrames=function(t){for(var r=[],n=0;n<t.length;++n)r.push(u.Texture.fromFrame(t[n]));return new e(r)},e.fromImages=function(t){for(var r=[],n=0;n<t.length;++n)r.push(u.Texture.fromImage(t[n]));return new e(r)},s(e,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(t){if(t[0]instanceof u.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}}]),e}(u.Sprite);r.default=h},{"../core":65}],136:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),c=n(t("../core/math/ObservablePoint")),d=t("../core/utils"),p=n(t("../core/settings")),v=function(t){function e(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return s._textWidth=0,s._textHeight=0,s._glyphs=[],s._font={tint:void 0!==n.tint?n.tint:16777215,align:n.align||"left",name:null,size:0},s.font=n.font,s._text=r,s._maxWidth=0,s._maxLineHeight=0,s._letterSpacing=0,s._anchor=new c.default(function(){s.dirty=!0},s,0,0),s.dirty=!1,s.updateText(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],r=this._font.size/t.size,n=new h.Point,i=[],o=[],s=this.text.replace(/(?:\r\n|\r)/g,"\n"),a=s.length,u=this._maxWidth*t.size/this._font.size,l=null,c=0,d=0,f=0,p=-1,v=0,g=0,y=0,m=0;m<a;m++){var _=s.charCodeAt(m),b=s.charAt(m);if(/(?:\s)/.test(b)&&(p=m,v=c),"\r"!==b&&"\n"!==b){var x=t.chars[_];x&&(l&&x.kerning[l]&&(n.x+=x.kerning[l]),i.push({texture:x.texture,line:f,charCode:_,position:new h.Point(n.x+x.xOffset+this._letterSpacing/2,n.y+x.yOffset)}),n.x+=x.xAdvance+this._letterSpacing,c=n.x,y=Math.max(y,x.yOffset+x.texture.height),l=_,-1!==p&&0<u&&n.x>u&&(++g,h.utils.removeItems(i,1+p-g,1+m-p),m=p,p=-1,o.push(v),d=Math.max(d,v),f++,n.x=0,n.y+=t.lineHeight,l=null))}else o.push(c),d=Math.max(d,c),++f,++g,n.x=0,n.y+=t.lineHeight,l=null}var T=s.charAt(s.length-1);"\r"!==T&&"\n"!==T&&(/(?:\s)/.test(T)&&(c=v),o.push(c),d=Math.max(d,c));for(var w=[],E=0;E<=f;E++){var S=0;"right"===this._font.align?S=d-o[E]:"center"===this._font.align&&(S=(d-o[E])/2),w.push(S)}for(var O=i.length,M=this.tint,P=0;P<O;P++){var C=this._glyphs[P];C?C.texture=i[P].texture:(C=new h.Sprite(i[P].texture),this._glyphs.push(C)),C.position.x=(i[P].position.x+w[i[P].line])*r,C.position.y=i[P].position.y*r,C.scale.x=C.scale.y=r,C.tint=M,C.parent||this.addChild(C)}for(var R=O;R<this._glyphs.length;++R)this.removeChild(this._glyphs[R]);if(this._textWidth=d*r,this._textHeight=(n.y+t.lineHeight)*r,0!==this.anchor.x||0!==this.anchor.y)for(var A=0;A<O;A++)this._glyphs[A].x-=this._textWidth*this.anchor.x,this._glyphs[A].y-=this._textHeight*this.anchor.y;this._maxLineHeight=y*r},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},e.registerFont=function(t,r){var n={},i=t.getElementsByTagName("info")[0],o=t.getElementsByTagName("common")[0],s=t.getElementsByTagName("page"),a=(0,d.getResolutionOfUrl)(s[0].getAttribute("file"),p.default.RESOLUTION),u={};n.font=i.getAttribute("face"),n.size=parseInt(i.getAttribute("size"),10),n.lineHeight=parseInt(o.getAttribute("lineHeight"),10)/a,n.chars={},r instanceof h.Texture&&(r=[r]);for(var l=0;l<s.length;l++){var c=s[l].getAttribute("id"),f=s[l].getAttribute("file");u[c]=r instanceof Array?r[l]:r[f]}for(var v=t.getElementsByTagName("char"),g=0;g<v.length;g++){var y=v[g],m=parseInt(y.getAttribute("id"),10),_=y.getAttribute("page")||0,b=new h.Rectangle(parseInt(y.getAttribute("x"),10)/a+u[_].frame.x/a,parseInt(y.getAttribute("y"),10)/a+u[_].frame.y/a,parseInt(y.getAttribute("width"),10)/a,parseInt(y.getAttribute("height"),10)/a);n.chars[m]={xOffset:parseInt(y.getAttribute("xoffset"),10)/a,yOffset:parseInt(y.getAttribute("yoffset"),10)/a,xAdvance:parseInt(y.getAttribute("xadvance"),10)/a,kerning:{},texture:new h.Texture(u[_].baseTexture,b),page:_}}for(var x=t.getElementsByTagName("kerning"),T=0;T<x.length;T++){var w=x[T],E=parseInt(w.getAttribute("first"),10)/a,S=parseInt(w.getAttribute("second"),10)/a,O=parseInt(w.getAttribute("amount"),10)/a;n.chars[S]&&(n.chars[S].kerning[E]=O)}return e.fonts[n.font]=n},a(e,[{key:"tint",get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&0<=t?t:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copy(t)}},{key:"font",get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=2<=t.length?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),e}(h.Container);(r.default=v).fonts={}},{"../core":65,"../core/math/ObservablePoint":68,"../core/settings":101,"../core/utils":125}],137:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),l=function(t){return t&&t.__esModule?t:{default:t}}(t("../core/sprites/canvas/CanvasTinter")),c=new u.Point,d=function(t){function e(r){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return a.tileTransform=new u.TransformStatic,a._width=o,a._height=s,a._canvasPattern=null,a.uvTransform=r.transform||new u.TextureMatrix(r),a.pluginName="tilingSprite",a.uvRespectAnchor=!1,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},e.prototype._renderWebGL=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var r=t.context,n=this.worldTransform,i=t.resolution,o=2===e.rotate,s=e.baseTexture,a=s.resolution,h=this.tilePosition.x/this.tileScale.x%e.orig.width*a,c=this.tilePosition.y/this.tileScale.y%e.orig.height*a;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var d=new u.CanvasRenderTarget(e.orig.width,e.orig.height,a);if(16777215!==this.tint)this.tintedTexture=l.default.getTintedTexture(this,this.tint),d.context.drawImage(this.tintedTexture,0,0);else{var f=e._frame.x*a,p=e._frame.y*a,v=e._frame.width*a,g=e._frame.height*a,y=(e.trim?e.trim.width:e.orig.width)*a,m=(e.trim?e.trim.height:e.orig.height)*a,_=(e.trim?e.trim.x:0)*a,b=(e.trim?e.trim.y:0)*a;o?(d.context.rotate(-Math.PI/2),d.context.translate(-m,0),d.context.drawImage(s.source,f,p,v,g,-b,_,m,y)):d.context.drawImage(s.source,f,p,v,g,_,b,y,m)}this.cachedTint=this.tint,this._canvasPattern=d.context.createPattern(d.canvas,"repeat")}r.globalAlpha=this.worldAlpha,r.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i,n.ty*i),t.setBlendMode(this.blendMode),r.fillStyle=this._canvasPattern,r.scale(this.tileScale.x/a,this.tileScale.y/a);var x=this.anchor.x*-this._width*a,T=this.anchor.y*-this._height*a;this.uvRespectAnchor?(r.translate(h,c),r.fillRect(x-h,T-c,this._width/this.tileScale.x*a,this._height/this.tileScale.y*a)):(r.translate(h+x,c+T),r.fillRect(-h,-c,this._width/this.tileScale.x*a,this._height/this.tileScale.y*a))}},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,r,n)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new u.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,c);var e=this._width,r=this._height,n=-e*this.anchor._x;if(c.x>=n&&c.x<n+e){var i=-r*this.anchor._y;if(c.y>=i&&c.y<i+r)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvTransform=null},e.from=function(t,r,n){return new e(u.Texture.from(t),r,n)},e.fromFrame=function(t,r,n){var i=u.utils.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(i,r,n)},e.fromImage=function(t,r,n,i,o){return new e(u.Texture.fromImage(t,i,o),r,n)},s(e,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(t){this.uvTransform.clampMargin=t,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copy(t)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copy(t)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),e}(u.Sprite);r.default=d},{"../core":65,"../core/sprites/canvas/CanvasTinter":104}],138:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),u=n(t("../core/textures/Texture")),l=n(t("../core/textures/BaseTexture")),c=t("../core/utils"),d=s.DisplayObject,f=new s.Matrix;d.prototype._cacheAsBitmap=!1,d.prototype._cacheData=!1;function p(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,p),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null}Object.defineProperties(d.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap!==t){var e=void 0;(this._cacheAsBitmap=t)?(this._cacheData||(this._cacheData=new p),(e=this._cacheData).originalRenderWebGL=this.renderWebGL,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=e.originalRenderWebGL,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}}),d.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(t))},d.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.currentRenderer.flush();var r=this.getLocalBounds().clone();if(this._filters&&this._filters.length){var n=this._filters[0].padding;r.pad(n)}r.ceil(s.settings.RESOLUTION);var i=t._activeRenderTarget,o=t.filterManager.filterStack,a=s.RenderTexture.create(r.width,r.height),h="cacheAsBitmap_"+(0,c.uid)();this._cacheData.textureCacheId=h,l.default.addToCache(a.baseTexture,h),u.default.addToCache(a,h);var d=f;d.tx=-r.x,d.ty=-r.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,t.render(this,a,!0,d,!0),t.bindRenderTarget(i),t.filterManager.filterStack=o,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var p=new s.Sprite(a);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-r.x/r.width,p.anchor.y=-r.y/r.height,p.alpha=e,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=p.containsPoint.bind(p)}},d.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},d.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),r=this.alpha;this.alpha=1;var n=t.context;e.ceil(s.settings.RESOLUTION);var i=s.RenderTexture.create(e.width,e.height),o="cacheAsBitmap_"+(0,c.uid)();this._cacheData.textureCacheId=o,l.default.addToCache(i.baseTexture,o),u.default.addToCache(i,o);var a=f;this.transform.localTransform.copy(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,i,!0,a,!1),t.context=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var h=new s.Sprite(i);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},d.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID},d.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},d.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,l.default.removeFromCache(this._cacheData.textureCacheId),u.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},d.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)}},{"../core":65,"../core/textures/BaseTexture":112,"../core/textures/Texture":115,"../core/utils":125}],139:[function(t,e,r){"use strict";var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core"));i.DisplayObject.prototype.name=null,i.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":65}],140:[function(t,e,r){"use strict";var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core"));i.DisplayObject.prototype.getGlobalPosition=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new i.Point,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":65}],141:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.BitmapText=r.TilingSpriteRenderer=r.TilingSprite=r.AnimatedSprite=void 0;var i=t("./AnimatedSprite");Object.defineProperty(r,"AnimatedSprite",{enumerable:!0,get:function(){return n(i).default}});var o=t("./TilingSprite");Object.defineProperty(r,"TilingSprite",{enumerable:!0,get:function(){return n(o).default}});var s=t("./webgl/TilingSpriteRenderer");Object.defineProperty(r,"TilingSpriteRenderer",{enumerable:!0,get:function(){return n(s).default}});var a=t("./BitmapText");Object.defineProperty(r,"BitmapText",{enumerable:!0,get:function(){return n(a).default}}),t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition")},{"./AnimatedSprite":135,"./BitmapText":136,"./TilingSprite":137,"./cacheAsBitmap":138,"./getChildByName":139,"./getGlobalPosition":140,"./webgl/TilingSpriteRenderer":142}],142:[function(t,e,r){"use strict";r.__esModule=!0;var a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),u=t("../../core/const"),h=(t("path"),new a.Matrix),l=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return o.shader=null,o.simpleShader=null,o.quad=null,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new a.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new a.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new a.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},e.prototype.render=function(t){var e=this.renderer,r=this.quad;e.bindVao(r.vao);var n=r.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((n=r.uvs)[0]=n[6]=-t.anchor.x,n[1]=n[3]=-t.anchor.y,n[2]=n[4]=1-t.anchor.x,n[5]=n[7]=1-t.anchor.y),r.upload();var i=t._texture,o=i.baseTexture,s=t.tileTransform.localTransform,l=t.uvTransform,c=o.isPowerOfTwo&&i.frame.width===o.width&&i.frame.height===o.height;c&&(o._glTextures[e.CONTEXT_UID]?c=o.wrapMode!==u.WRAP_MODES.CLAMP:o.wrapMode===u.WRAP_MODES.CLAMP&&(o.wrapMode=u.WRAP_MODES.REPEAT));var d=c?this.simpleShader:this.shader;e.bindShader(d);var f=i.width,p=i.height,v=t._width,g=t._height;h.set(s.a*f/v,s.b*f/g,s.c*p/v,s.d*p/g,s.tx/v,s.ty/g),h.invert(),c?h.prepend(l.mapCoord):(d.uniforms.uMapCoord=l.mapCoord.toArray(!0),d.uniforms.uClampFrame=l.uClampFrame,d.uniforms.uClampOffset=l.uClampOffset),d.uniforms.uTransform=h.toArray(!0),d.uniforms.uColor=a.utils.premultiplyTintToRgba(t.tint,t.worldAlpha,d.uniforms.uColor,o.premultipliedAlpha),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=e.bindTexture(i),e.setBlendMode(a.utils.correctBlendMode(t.blendMode,o.premultipliedAlpha)),r.vao.draw(this.renderer.gl.TRIANGLES,6,0)},e}(a.ObjectRenderer);r.default=l,a.WebGLRenderer.registerPlugin("tilingSprite",l)},{"../../core":65,"../../core/const":46,path:8}],143:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),h=(t("path"),function(t){function e(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n"));return o.alpha=r,o.glShaderKey="alpha",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),e}(u.Filter));r.default=h},{"../../core":65,path:8}],144:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),c=n(t("./BlurXFilter")),f=n(t("./BlurYFilter")),p=function(t){function e(r,n,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return u.blurXFilter=new c.default(r,n,s,a),u.blurYFilter=new f.default(r,n,s,a),u.padding=0,u.resolution=s||h.settings.RESOLUTION,u.quality=n||4,u.blur=r||8,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r){var n=t.getRenderTarget(!0);this.blurXFilter.apply(t,e,n,!0),this.blurYFilter.apply(t,n,r,!1),t.returnRenderTarget(n)},a(e,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(t){this.blurYFilter._blendMode=t}}]),e}(h.Filter);r.default=p},{"../../core":65,"./BlurXFilter":145,"./BlurYFilter":146}],145:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),c=n(t("./generateBlurVertSource")),f=n(t("./generateBlurFragSource")),v=n(t("./getMaxBlurKernelSize")),g=function(t){function e(r,n,s,a){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),a=a||5;var u=(0,c.default)(a,!0),l=(0,f.default)(a),d=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,u,l));return d.resolution=s||h.settings.RESOLUTION,d._quality=0,d.quality=n||4,d.strength=r||8,d.firstRun=!0,d}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r,n){if(this.firstRun){var i=t.renderer.gl,o=(0,v.default)(i);this.vertexSrc=(0,c.default)(o,!0),this.fragmentSrc=(0,f.default)(o),this.firstRun=!1}if(this.uniforms.strength=1/r.size.width*(r.size.width/e.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,n);else{for(var s=t.getRenderTarget(!0),a=e,u=s,h=0;h<this.passes-1;h++){t.applyFilter(this,a,u,!0);var l=u;u=a,a=l}t.applyFilter(this,a,r,n),t.returnRenderTarget(s)}},a(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(h.Filter);r.default=g},{"../../core":65,"./generateBlurFragSource":147,"./generateBlurVertSource":148,"./getMaxBlurKernelSize":149}],146:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),c=n(t("./generateBlurVertSource")),f=n(t("./generateBlurFragSource")),v=n(t("./getMaxBlurKernelSize")),g=function(t){function e(r,n,s,a){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),a=a||5;var u=(0,c.default)(a,!1),l=(0,f.default)(a),d=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,u,l));return d.resolution=s||h.settings.RESOLUTION,d._quality=0,d.quality=n||4,d.strength=r||8,d.firstRun=!0,d}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r,n){if(this.firstRun){var i=t.renderer.gl,o=(0,v.default)(i);this.vertexSrc=(0,c.default)(o,!1),this.fragmentSrc=(0,f.default)(o),this.firstRun=!1}if(this.uniforms.strength=1/r.size.height*(r.size.height/e.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,n);else{for(var s=t.getRenderTarget(!0),a=e,u=s,h=0;h<this.passes-1;h++){t.applyFilter(this,a,u,!0);var l=u;u=a,a=l}t.applyFilter(this,a,r,n),t.returnRenderTarget(s)}},a(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(h.Filter);r.default=g},{"../../core":65,"./generateBlurFragSource":147,"./generateBlurVertSource":148,"./getMaxBlurKernelSize":149}],147:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){for(var e=i[t],r=e.length,n=o,s="",u=void 0,h=0;h<t;h++){var l="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",h);r<=(u=h)&&(u=t-h-1),s+=l=l.replace("%value%",e[u]),s+="\n"}return(n=n.replace("%blur%",s)).replace("%size%",t)};var i={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},o=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],148:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t,e){var r=Math.ceil(t/2),n=i,o="",s=void 0;s=e?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var a=0;a<t;a++){var u=s.replace("%index%",a);o+=u=u.replace("%sampleIndex%",a-(r-1)+".0"),o+="\n"}return(n=n.replace("%blur%",o)).replace("%size%",t)};var i=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],149:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(t){for(var e=t.getParameter(t.MAX_VARYING_VECTORS),r=15;e<r;)r-=2;return r}},{}],150:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),h=(t("path"),function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"));return r.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],r.alpha=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._loadMatrix=function(t){var r=t;1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r},e.prototype._multiply=function(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.greyscale=function(t,e){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var r=Math.cos(t),n=Math.sin(t),o=1/3,s=(0,Math.sqrt)(o),g=[r+(1-r)*o,o*(1-r)-s*n,o*(1-r)+s*n,0,0,o*(1-r)+s*n,r+o*(1-r),o*(1-r)-s*n,0,0,o*(1-r)-s*n,o*(1-r)+s*n,r+o*(1-r),0,0,0,0,0,1,0];this._loadMatrix(g,e)},e.prototype.contrast=function(t,e){var r=(t||0)+1,n=-.5*(r-1),i=[r,0,0,0,n,0,r,0,0,n,0,0,r,0,n,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.saturate=function(){var e=arguments[1],r=2*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)/3+1,n=-.5*(r-1),i=[r,n,n,0,0,n,r,n,0,0,n,n,r,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,r,n,i){var o=((r=r||16770432)>>16&255)/255,s=(r>>8&255)/255,a=(255&r)/255,u=((n=n||3375104)>>16&255)/255,h=(n>>8&255)/255,l=(255&n)/255,c=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,u,h,l,e=e||.15,0,o-u,s-h,a-l,0,0];this._loadMatrix(c,i)},e.prototype.night=function(t,e){var r=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.predator=function(t,e){var r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},s(e,[{key:"matrix",get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),e}(u.Filter));(r.default=h).prototype.grayscale=h.prototype.greyscale},{"../../core":65,path:8}],151:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),h=(t("path"),function(t){function e(r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=new u.Matrix;r.renderable=!1;var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy *= scale / filterArea.xy;\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));return a.maskSprite=r,a.maskMatrix=s,a.uniforms.mapSampler=r._texture,a.uniforms.filterMatrix=s,a.uniforms.scale={x:1,y:1},null!=o||(o=20),a.scale=new u.Point(o,o),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y,t.applyFilter(this,e,r)},s(e,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t}}]),e}(u.Filter));r.default=h},{"../../core":65,path:8}],152:[function(t,e,r){"use strict";r.__esModule=!0;var a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),u=(t("path"),function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(a.Filter));r.default=u},{"../../core":65,path:8}],153:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./fxaa/FXAAFilter");Object.defineProperty(r,"FXAAFilter",{enumerable:!0,get:function(){return n(i).default}});var o=t("./noise/NoiseFilter");Object.defineProperty(r,"NoiseFilter",{enumerable:!0,get:function(){return n(o).default}});var s=t("./displacement/DisplacementFilter");Object.defineProperty(r,"DisplacementFilter",{enumerable:!0,get:function(){return n(s).default}});var a=t("./blur/BlurFilter");Object.defineProperty(r,"BlurFilter",{enumerable:!0,get:function(){return n(a).default}});var u=t("./blur/BlurXFilter");Object.defineProperty(r,"BlurXFilter",{enumerable:!0,get:function(){return n(u).default}});var h=t("./blur/BlurYFilter");Object.defineProperty(r,"BlurYFilter",{enumerable:!0,get:function(){return n(h).default}});var l=t("./colormatrix/ColorMatrixFilter");Object.defineProperty(r,"ColorMatrixFilter",{enumerable:!0,get:function(){return n(l).default}});var c=t("./alpha/AlphaFilter");Object.defineProperty(r,"AlphaFilter",{enumerable:!0,get:function(){return n(c).default}})},{"./alpha/AlphaFilter":143,"./blur/BlurFilter":144,"./blur/BlurXFilter":145,"./blur/BlurYFilter":146,"./colormatrix/ColorMatrixFilter":150,"./displacement/DisplacementFilter":151,"./fxaa/FXAAFilter":152,"./noise/NoiseFilter":154}],154:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),h=(t("path"),function(t){function e(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Math.random();!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"));return s.noise=r,s.seed=o,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t}}]),e}(u.Filter));r.default=h},{"../../core":65,path:8}],155:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),a=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.global=new s.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return t.prototype.getLocalPosition=function(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)},t.prototype.copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},i(t,[{key:"pointerId",get:function(){return this.identifier}}]),t}();r.default=a},{"../core":65}],156:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0},t.prototype.reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},t}();r.default=i},{}],157:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),c=n(t("./InteractionData")),f=n(t("./InteractionEvent")),v=n(t("./InteractionTrackingData")),y=n(t("eventemitter3")),_=n(t("./interactiveTarget"));h.utils.mixins.delayMixin(h.DisplayObject.prototype,_.default);var x={target:null,data:{global:null}},T=function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n=n||{},s.renderer=r,s.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,s.interactionFrequency=n.interactionFrequency||10,s.mouse=new c.default,s.mouse.identifier=1,s.mouse.global.set(-999999),s.activeInteractionData={},s.activeInteractionData[1]=s.mouse,s.interactionDataPool=[],s.eventData=new f.default,s.interactionDOMElement=null,s.moveWhenInside=!1,s.eventsAdded=!1,s.mouseOverRenderer=!1,s.supportsTouchEvents="ontouchstart"in window,s.supportsPointerEvents=!!window.PointerEvent,s.onPointerUp=s.onPointerUp.bind(s),s.processPointerUp=s.processPointerUp.bind(s),s.onPointerCancel=s.onPointerCancel.bind(s),s.processPointerCancel=s.processPointerCancel.bind(s),s.onPointerDown=s.onPointerDown.bind(s),s.processPointerDown=s.processPointerDown.bind(s),s.onPointerMove=s.onPointerMove.bind(s),s.processPointerMove=s.processPointerMove.bind(s),s.onPointerOut=s.onPointerOut.bind(s),s.processPointerOverOut=s.processPointerOverOut.bind(s),s.onPointerOver=s.onPointerOver.bind(s),s.cursorStyles={default:"inherit",pointer:"pointer"},s.currentCursorMode=null,s.cursor=null,s._tempPoint=new h.Point,s.resolution=1,s.setTargetElement(s.renderer.view,s.renderer.resolution),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.hitTest=function(t,e){return x.target=null,x.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(x,e,null,!0),x.target},e.prototype.setTargetElement=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},e.prototype.addEvents=function(){this.interactionDOMElement&&(h.ticker.shared.add(this.update,this,h.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.interactionDOMElement&&(h.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var r=this.activeInteractionData[e];if(r.originalEvent&&"touch"!==r.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(void 0===e?"undefined":a(e)){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,r){r.stopped||(r.currentTarget=t,r.type=e,t.emit(e,r),t[e]&&t[e](r))},e.prototype.mapPositionToPoint=function(t,e,r){var n;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var i=navigator.isCocoonJS?this.resolution:1/this.resolution;t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*i,t.y=(r-n.top)*(this.interactionDOMElement.height/n.height)*i},e.prototype.processInteractive=function(t,e,r,n,i){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=i=e.interactive||i,u=!0;if(e.hitArea?(n&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:u=n=!1),a=!1):e._mask&&n&&(e._mask.containsPoint(o)||(u=n=!1)),u&&e.interactiveChildren&&e.children)for(var h=e.children,l=h.length-1;0<=l;l--){var c=h[l],d=this.processInteractive(t,c,r,n,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(n=!1),s=!0)}}return i&&(n&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),r&&r(t,e,!!s))),s},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&t.preventDefault();for(var r=e.length,n=0;n<r;n++){var i=e[n],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);if(s.data.originalEvent=t,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===i.pointerType)this.emit("touchstart",s);else if("mouse"===i.pointerType||"pen"===i.pointerType){var a=2===i.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,r){var n=t.data,i=t.data.identifier;if(r)if(e.trackedPointers[i]||(e.trackedPointers[i]=new v.default(i)),this.dispatchEvent(e,"pointerdown",t),"touch"===n.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===n.pointerType||"pen"===n.pointerType){var o=2===n.button;o?e.trackedPointers[i].rightDown=!0:e.trackedPointers[i].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,r){for(var n=this.normalizeToPointerData(t),i=n.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<i;s++){var a=n[s],u=this.getInteractionDataForPointerId(a),h=this.configureInteractionEventForDOMEvent(this.eventData,a,u);if(h.data.originalEvent=t,this.processInteractive(h,this.renderer._lastObjectRendered,r,e||!o),this.emit(e?"pointercancel":"pointerup"+o,h),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+o:"mouseup"+o,h)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,h),this.releaseInteractionDataForPointerId(a.pointerId,u))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var r=t.data,n=t.data.identifier;void 0!==e.trackedPointers[n]&&(delete e.trackedPointers[n],this.dispatchEvent(e,"pointercancel",t),"touch"===r.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,r){var n=t.data,i=t.data.identifier,o=e.trackedPointers[i],s="touch"===n.pointerType,a="mouse"===n.pointerType||"pen"===n.pointerType,u=!1;if(a){var h=2===n.button,l=v.default.FLAGS,c=h?l.RIGHT_DOWN:l.LEFT_DOWN,d=void 0!==o&&o.flags&c;r?(this.dispatchEvent(e,h?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,h?"rightclick":"click",t),u=!0)):d&&this.dispatchEvent(e,h?"rightupoutside":"mouseupoutside",t),o&&(h?o.rightDown=!1:o.leftDown=!1)}r?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(a&&!u||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[i]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var r=e.length,n=0;n<r;n++){var i=e[n],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);s.data.originalEvent=t;var a="touch"!==i.pointerType||this.moveWhenInside;this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerMove,a),this.emit("pointermove",s),"touch"===i.pointerType&&this.emit("touchmove",s),"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,r){var n=t.data,i="touch"===n.pointerType,o="mouse"===n.pointerType||"pen"===n.pointerType;o&&this.processPointerOverOut(t,e,r),this.moveWhenInside&&!r||(this.dispatchEvent(e,"pointermove",t),i&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var r=this.normalizeToPointerData(t)[0];"mouse"===r.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(r),i=this.configureInteractionEventForDOMEvent(this.eventData,r,n);i.data.originalEvent=r,this.processInteractive(i,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===r.pointerType||"pen"===r.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(n.identifier)}},e.prototype.processPointerOverOut=function(t,e,r){var n=t.data,i=t.data.identifier,o="mouse"===n.pointerType||"pen"===n.pointerType,s=e.trackedPointers[i];r&&!s&&(s=e.trackedPointers[i]=new v.default(i)),void 0!==s&&(r&&this.mouseOverRenderer?(s.over||(s.over=!0,this.dispatchEvent(e,"pointerover",t),o&&this.dispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[i]))},e.prototype.onPointerOver=function(t){var r=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(r),i=this.configureInteractionEventForDOMEvent(this.eventData,r,n);"mouse"===(i.data.originalEvent=r).pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.emit("mouseover",i)},e.prototype.getInteractionDataForPointerId=function(t){var e=t.pointerId,r=void 0;return 1===e||"mouse"===t.pointerType?r=this.mouse:this.activeInteractionData[e]?r=this.activeInteractionData[e]:((r=this.interactionDataPool.pop()||new c.default).identifier=e,this.activeInteractionData[e]=r),r.copyEvent(t),r},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,r){return t.data=r,this.mapPositionToPoint(r.global,e.clientX,e.clientY),navigator.isCocoonJS&&"touch"===e.pointerType&&(r.global.x=r.global.x/this.resolution,r.global.y=r.global.y/this.resolution),"touch"===e.pointerType&&(e.globalX=r.global.x,e.globalY=r.global.y),r.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,n=t.changedTouches.length;r<n;r++){var i=t.changedTouches[r];void 0===i.button&&(i.button=t.touches.length?1:0),void 0===i.buttons&&(i.buttons=t.touches.length?1:0),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,e.push(i)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent||(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=1),void 0===t.pressure&&(t.pressure=.5),void 0===t.twist&&(t.twist=0),void 0===t.tangentialPressure&&(t.tangentialPressure=0),t.isNormalized=!0),e.push(t);return e},e.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},e}(y.default);r.default=T,h.WebGLRenderer.registerPlugin("interaction",T),h.CanvasRenderer.registerPlugin("interaction",T)},{"../core":65,"./InteractionData":155,"./InteractionEvent":156,"./InteractionTrackingData":158,"./interactiveTarget":160,eventemitter3:3}],158:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},i(t,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(t){this._flags=t}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},set:function(t){this._doSet(this.constructor.FLAGS.OVER,t)}},{key:"rightDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)}},{key:"leftDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)}}]),t}();(r.default=o).FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],159:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./InteractionData");Object.defineProperty(r,"InteractionData",{enumerable:!0,get:function(){return n(i).default}});var o=t("./InteractionManager");Object.defineProperty(r,"InteractionManager",{enumerable:!0,get:function(){return n(o).default}});var s=t("./interactiveTarget");Object.defineProperty(r,"interactiveTarget",{enumerable:!0,get:function(){return n(s).default}});var a=t("./InteractionTrackingData");Object.defineProperty(r,"InteractionTrackingData",{enumerable:!0,get:function(){return n(a).default}});var u=t("./InteractionEvent");Object.defineProperty(r,"InteractionEvent",{enumerable:!0,get:function(){return n(u).default}})},{"./InteractionData":155,"./InteractionEvent":156,"./InteractionManager":157,"./InteractionTrackingData":158,"./interactiveTarget":160}],160:[function(t,e,r){"use strict";r.__esModule=!0,r.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},{}],161:[function(t,e,r){"use strict";function n(t,e){t.bitmapFont=a.BitmapText.registerFont(t.data,e)}r.__esModule=!0,r.parse=n,r.default=function(){return function(t,e){if(t.data&&t.type===s.Resource.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var r=t.isDataUrl?"":o.dirname(t.url);t.isDataUrl&&("."===r&&(r=""),this.baseUrl&&r&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(r+="/")),(r=r.replace(this.baseUrl,""))&&"/"!==r.charAt(r.length-1)&&(r+="/");for(var i=t.data.getElementsByTagName("page"),a={},u=function(r){a[r.metadata.pageFile]=r.texture,Object.keys(a).length===i.length&&(n(t,a),e())},h=0;h<i.length;++h){var l=i[h].getAttribute("file"),c=r+l,d=!1;for(var f in this.resources){var p=this.resources[f];if(p.url===c){p.metadata.pageFile=l,p.texture?u(p):p.onAfterMiddleware.add(u),d=!0;break}}if(!d){var v={crossOrigin:t.crossOrigin,loadType:s.Resource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:l},t.metadata.imageMetadata),parentResource:t};this.add(c,v,u)}}}else e();else e()}};var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("path")),s=t("resource-loader"),a=t("../extras")},{"../extras":141,path:8,"resource-loader":36}],162:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0,r.shared=r.Resource=r.textureParser=r.getResourcePath=r.spritesheetParser=r.parseBitmapFontData=r.bitmapFontParser=r.Loader=void 0;var i=t("./bitmapFontParser");Object.defineProperty(r,"bitmapFontParser",{enumerable:!0,get:function(){return n(i).default}}),Object.defineProperty(r,"parseBitmapFontData",{enumerable:!0,get:function(){return i.parse}});var o=t("./spritesheetParser");Object.defineProperty(r,"spritesheetParser",{enumerable:!0,get:function(){return n(o).default}}),Object.defineProperty(r,"getResourcePath",{enumerable:!0,get:function(){return o.getResourcePath}});var s=t("./textureParser");Object.defineProperty(r,"textureParser",{enumerable:!0,get:function(){return n(s).default}});var a=t("resource-loader");Object.defineProperty(r,"Resource",{enumerable:!0,get:function(){return a.Resource}});var h=n(t("../core/Application")),c=n(t("./loader"));r.Loader=c.default;var d=new c.default;d.destroy=function(){},r.shared=d;var f=h.default.prototype;f._loader=null,Object.defineProperty(f,"loader",{get:function(){if(!this._loader){var t=this._options.sharedLoader;this._loader=t?d:new c.default}return this._loader}}),f._parentDestroy=f.destroy,f.destroy=function(t,e){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(t,e)}},{"../core/Application":43,"./bitmapFontParser":161,"./loader":163,"./spritesheetParser":164,"./textureParser":165,"resource-loader":36}],163:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=n(t("resource-loader")),h=t("resource-loader/lib/middlewares/parsing/blob"),c=n(t("eventemitter3")),f=n(t("./textureParser")),v=n(t("./spritesheetParser")),y=n(t("./bitmapFontParser")),m=function(t){function e(r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,n));c.default.call(s);for(var a=0;a<e._pixiMiddleware.length;++a)s.use(e._pixiMiddleware[a]());return s.onStart.add(function(t){return s.emit("start",t)}),s.onProgress.add(function(t,e){return s.emit("progress",t,e)}),s.onError.add(function(t,e,r){return s.emit("error",t,e,r)}),s.onLoad.add(function(t,e){return s.emit("load",t,e)}),s.onComplete.add(function(t,e){return s.emit("complete",t,e)}),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.addPixiMiddleware=function(t){e._pixiMiddleware.push(t)},e.prototype.destroy=function(){this.removeAllListeners(),this.reset()},e}(u.default);for(var _ in r.default=m,c.default.prototype)m.prototype[_]=c.default.prototype[_];m._pixiMiddleware=[h.blobMiddlewareFactory,f.default,v.default,y.default];var b=u.default.Resource;b.setExtensionXhrType("fnt",b.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":161,"./spritesheetParser":164,"./textureParser":165,eventemitter3:3,"resource-loader":36,"resource-loader/lib/middlewares/parsing/blob":37}],164:[function(t,e,r){"use strict";function n(t,e){return t.isDataUrl?t.data.meta.image:s.default.resolve(t.url.replace(e,""),t.data.meta.image)}r.__esModule=!0,r.default=function(){return function(t,e){var r=t.name+"_image";if(t.data&&t.type===i.Resource.TYPE.JSON&&t.data.frames&&!this.resources[r]){var o={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},s=n(t,this.baseUrl);this.add(r,s,o,function(r){if(r.error)e(r.error);else{var n=new a.Spritesheet(r.texture.baseTexture,t.data,t.url);n.parse(function(){t.spritesheet=n,t.textures=n.textures,e()})}})}else e()}},r.getResourcePath=n;var i=t("resource-loader"),s=function(t){return t&&t.__esModule?t:{default:t}}(t("url")),a=t("../core")},{"../core":65,"resource-loader":36,url:38}],165:[function(t,e,r){"use strict";r.__esModule=!0,r.default=function(){return function(t,e){t.data&&t.type===n.Resource.TYPE.IMAGE&&(t.texture=o.default.fromLoader(t.data,t.url,t.name)),e()}};var n=t("resource-loader"),o=function(t){return t&&t.__esModule?t:{default:t}}(t("../core/textures/Texture"))},{"../core/textures/Texture":115,"resource-loader":36}],166:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),l=function(t){return t&&t.__esModule?t:{default:t}}(t("../core/textures/Texture")),c=new u.Point,d=new u.Polygon,f=function(t){function e(r,o,s,a,h){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return c._texture=r||l.default.EMPTY,c.uvs=s||new Float32Array([0,0,1,0,1,1,0,1]),c.vertices=o||new Float32Array([0,0,100,0,100,100,0,100]),c.indices=a||new Uint16Array([0,1,3,2]),c.dirty=0,c.indexDirty=0,c.vertexDirty=0,c.autoUpdate=!0,c.blendMode=u.BLEND_MODES.NORMAL,c.canvasPadding=u.settings.MESH_CANVAS_PADDING,c.drawMode=h||e.DRAW_MODES.TRIANGLE_MESH,c.shader=null,c.tintRgb=new Float32Array([1,1,1]),c._glDatas={},c._uvTransform=new u.TextureMatrix(c._texture),c.uploadUvTransform=!1,c.pluginName="mesh",c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._renderWebGL=function(t){this.refresh(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){this.refresh(),t.plugins[this.pluginName].render(this)},e.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},e.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},e.prototype.refresh=function(t){this.autoUpdate&&this.vertexDirty++,this._uvTransform.update(t)&&this._refresh()},e.prototype._refresh=function(){},e.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,c);for(var r=this.vertices,n=d.points,i=this.indices,o=this.indices.length,s=this.drawMode===e.DRAW_MODES.TRIANGLES?3:1,a=0;a+2<o;a+=s){var u=2*i[a],h=2*i[a+1],l=2*i[a+2];if(n[0]=r[u],n[1]=r[1+u],n[2]=r[h],n[3]=r[1+h],n[4]=r[l],n[5]=r[1+l],d.contains(c.x,c.y))return!0}return!1},e.prototype.destroy=function(e){for(var r in this._glDatas){var n=this._glDatas[r];n.destroy?n.destroy():(n.vertexBuffer&&(n.vertexBuffer.destroy(),n.vertexBuffer=null),n.indexBuffer&&(n.indexBuffer.destroy(),n.indexBuffer=null),n.uvBuffer&&(n.uvBuffer.destroy(),n.uvBuffer=null),n.vao&&(n.vao.destroy(),n.vao=null))}this._glDatas=null,t.prototype.destroy.call(this,e)},s(e,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&((this._texture=t)&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return u.utils.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=u.utils.hex2rgb(t,this.tintRgb)}}]),e}(u.Container);(r.default=f).DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":65,"../core/textures/Texture":115}],167:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),h=n(t("./Plane")),c=n(t("../core/sprites/canvas/CanvasTinter")),f=function(t){function e(r,n,s,a,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,4,4));return h._origWidth=r.orig.width,h._origHeight=r.orig.height,h._width=h._origWidth,h._height=h._origHeight,h._leftWidth=void 0!==n?n:10,h._rightWidth=void 0!==a?a:10,h._topHeight=void 0!==s?s:10,h._bottomHeight=void 0!==u?u:10,h._cachedTint=16777215,h._tintedTexture=null,h._canvasUvs=null,h.refresh(!0),h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._topHeight+this._bottomHeight,r=this._height>e?1:this._height/e;t[9]=t[11]=t[13]=t[15]=this._topHeight*r,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*r,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._leftWidth+this._rightWidth,r=this._width>e?1:this._width/e;t[2]=t[10]=t[18]=t[26]=this._leftWidth*r,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*r,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._renderCanvas=function(t){var e=t.context,r=this.worldTransform,n=t.resolution,i=16777215!==this.tint,o=this._texture;i&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedTexture=c.default.getTintedTexture(this,this.tint));var s=i?this._tintedTexture:o.baseTexture.source;this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var a=this.vertices,u=this._canvasUvs,h=i?0:o.frame.x,l=i?0:o.frame.y,d=h+o.frame.width,f=l+o.frame.height;u[0]=h,u[1]=h+this._leftWidth,u[2]=d-this._rightWidth,u[3]=d,u[4]=l,u[5]=l+this._topHeight,u[6]=f-this._bottomHeight,u[7]=f;for(var p=0;p<8;p++)u[p]*=o.baseTexture.resolution;e.globalAlpha=this.worldAlpha,t.setBlendMode(this.blendMode),t.roundPixels?e.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n|0,r.ty*n|0):e.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n,r.ty*n);for(var v=0;v<3;v++)for(var g=0;g<3;g++){var y=2*g+8*v,m=Math.max(1,u[g+1]-u[g]),_=Math.max(1,u[v+5]-u[v+4]),b=Math.max(1,a[10+y]-a[y]),x=Math.max(1,a[11+y]-a[1+y]);e.drawImage(s,u[g],u[v+4],m,_,a[y],a[1+y],b,x)}},e.prototype._refresh=function(){t.prototype._refresh.call(this);var e=this.uvs,r=this._texture;this._origWidth=r.orig.width,this._origHeight=r.orig.height;var n=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},a(e,[{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._refresh()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()}}]),e}(h.default);r.default=f},{"../core/sprites/canvas/CanvasTinter":104,"./Plane":168}],168:[function(t,e,r){"use strict";r.__esModule=!0;var a=function(t){return t&&t.__esModule?t:{default:t}}(t("./Mesh")),u=function(t){function e(r,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return u._ready=!0,u.verticesX=o||10,u.verticesY=s||10,u.drawMode=a.default.DRAW_MODES.TRIANGLES,u.refresh(),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._refresh=function(){for(var t=this._texture,e=this.verticesX*this.verticesY,r=[],i=[],o=[],s=this.verticesX-1,a=this.verticesY-1,u=t.width/s,h=t.height/a,l=0;l<e;l++){var c=l%this.verticesX,d=l/this.verticesX|0;r.push(c*u,d*h),i.push(c/s,d/a)}for(var f=s*a,p=0;p<f;p++){var v=p%s,g=p/s|0,y=g*this.verticesX+v,m=g*this.verticesX+v+1,_=(1+g)*this.verticesX+v,b=(1+g)*this.verticesX+v+1;o.push(y,m,_),o.push(m,b,_)}this.vertices=new Float32Array(r),this.uvs=new Float32Array(i),this.colors=new Float32Array([]),this.indices=new Uint16Array(o),this.dirty++,this.indexDirty++,this.multiplyUvs()},e.prototype._onTextureUpdate=function(){a.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},e}(a.default);r.default=u},{"./Mesh":166}],169:[function(t,e,r){"use strict";r.__esModule=!0;var u=function(t){function e(r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return s.points=o,s.vertices=new Float32Array(4*o.length),s.uvs=new Float32Array(4*o.length),s.colors=new Float32Array(2*o.length),s.indices=new Uint16Array(2*o.length),s.autoUpdate=!0,s.refresh(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){this.vertices.length/4!==t.length&&(this.vertices=new Float32Array(4*t.length),this.uvs=new Float32Array(4*t.length),this.colors=new Float32Array(2*t.length),this.indices=new Uint16Array(2*t.length));var e=this.uvs,r=this.indices,n=this.colors;e[0]=0,e[1]=0,e[2]=0,e[3]=1,n[0]=1,n[1]=1,r[0]=0,r[1]=1;for(var i=t.length,o=1;o<i;o++){var s=4*o,a=o/(i-1);e[s]=a,e[s+1]=0,e[s+2]=a,e[s+3]=1,n[s=2*o]=1,n[s+1]=1,r[s=2*o]=s,r[s+1]=s+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},e.prototype.refreshVertices=function(){var t=this.points;if(!(t.length<1))for(var e=t[0],r=void 0,n=0,i=0,o=this.vertices,s=t.length,a=0;a<s;a++){var u=t[a],h=4*a;i=-((r=a<t.length-1?t[a+1]:u).x-e.x),n=r.y-e.y;var l=10*(1-a/(s-1));1<l&&(l=1);var c=Math.sqrt(n*n+i*i),d=this._texture.height/2;n/=c,i/=c,n*=d,i*=d,o[h]=u.x+n,o[1+h]=u.y+i,o[2+h]=u.x-n,o[3+h]=u.y-i,e=u}},e.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},e}(function(t){return t&&t.__esModule?t:{default:t}}(t("./Mesh")).default);r.default=u},{"./Mesh":166}],170:[function(t,e,r){"use strict";r.__esModule=!0;var o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),a=function(t){return t&&t.__esModule?t:{default:t}}(t("../Mesh")),u=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,r=e.context,n=t.worldTransform,i=e.resolution;e.roundPixels?r.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i|0,n.ty*i|0):r.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i,n.ty*i),e.context.globalAlpha=t.worldAlpha,e.setBlendMode(t.blendMode),t.drawMode===a.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(t):this._renderTriangles(t)},t.prototype._renderTriangleMesh=function(t){for(var e=t.vertices.length/2,r=0;r<e-2;r++){var n=2*r;this._renderDrawTriangle(t,n,2+n,4+n)}},t.prototype._renderTriangles=function(t){for(var e=t.indices,r=e.length,n=0;n<r;n+=3){var i=2*e[n],o=2*e[n+1],s=2*e[n+2];this._renderDrawTriangle(t,i,o,s)}},t.prototype._renderDrawTriangle=function(t,e,r,n){var i=this.renderer.context,o=t.uvs,s=t.vertices,a=t._texture;if(a.valid){var u=a.baseTexture,h=u.source,l=u.width,c=u.height,d=void 0,f=void 0,p=void 0,v=void 0,g=void 0,y=void 0;if(t.uploadUvTransform){var m=t._uvTransform.mapCoord;d=(o[e]*m.a+o[e+1]*m.c+m.tx)*u.width,f=(o[r]*m.a+o[r+1]*m.c+m.tx)*u.width,p=(o[n]*m.a+o[n+1]*m.c+m.tx)*u.width,v=(o[e]*m.b+o[e+1]*m.d+m.ty)*u.height,g=(o[r]*m.b+o[r+1]*m.d+m.ty)*u.height,y=(o[n]*m.b+o[n+1]*m.d+m.ty)*u.height}else d=o[e]*u.width,f=o[r]*u.width,p=o[n]*u.width,v=o[e+1]*u.height,g=o[r+1]*u.height,y=o[n+1]*u.height;var _=s[e],b=s[r],x=s[n],T=s[e+1],w=s[r+1],E=s[n+1],S=t.canvasPadding/this.renderer.resolution;if(0<S){var O=S/Math.abs(t.worldTransform.a),M=S/Math.abs(t.worldTransform.d),P=(_+b+x)/3,C=(T+w+E)/3,R=_-P,A=T-C,I=Math.sqrt(R*R+A*A);_=P+R/I*(I+O),T=C+A/I*(I+M),A=w-C,b=P+(R=b-P)/(I=Math.sqrt(R*R+A*A))*(I+O),w=C+A/I*(I+M),A=E-C,x=P+(R=x-P)/(I=Math.sqrt(R*R+A*A))*(I+O),E=C+A/I*(I+M)}i.save(),i.beginPath(),i.moveTo(_,T),i.lineTo(b,w),i.lineTo(x,E),i.closePath(),i.clip();var D=d*g+v*p+f*y-g*p-v*f-d*y,L=_*g+v*x+b*y-g*x-v*b-_*y,N=d*b+_*p+f*x-b*p-_*f-d*x,B=d*g*x+v*b*p+_*f*y-_*g*p-v*f*x-d*b*y,k=T*g+v*E+w*y-g*E-v*w-T*y,F=d*w+T*p+f*E-w*p-T*f-d*E,j=d*g*E+v*w*p+T*f*y-T*g*p-v*f*E-d*w*y;i.transform(L/D,k/D,N/D,F/D,B/D,j/D),i.drawImage(h,0,0,l*u.resolution,c*u.resolution,0,0,l,c),i.restore(),this.renderer.invalidateBlendMode()}},t.prototype.renderMeshFlat=function(t){var e=this.renderer.context,r=t.vertices,n=r.length/2;e.beginPath();for(var i=1;i<n-2;++i){var o=2*i,s=r[o],a=r[1+o],u=r[2+o],h=r[3+o],l=r[4+o],c=r[5+o];e.moveTo(s,a),e.lineTo(u,h),e.lineTo(l,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();r.default=u,o.CanvasRenderer.registerPlugin("mesh",u)},{"../../core":65,"../Mesh":166}],171:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./Mesh");Object.defineProperty(r,"Mesh",{enumerable:!0,get:function(){return n(i).default}});var o=t("./webgl/MeshRenderer");Object.defineProperty(r,"MeshRenderer",{enumerable:!0,get:function(){return n(o).default}});var s=t("./canvas/CanvasMeshRenderer");Object.defineProperty(r,"CanvasMeshRenderer",{enumerable:!0,get:function(){return n(s).default}});var a=t("./Plane");Object.defineProperty(r,"Plane",{enumerable:!0,get:function(){return n(a).default}});var u=t("./NineSlicePlane");Object.defineProperty(r,"NineSlicePlane",{enumerable:!0,get:function(){return n(u).default}});var h=t("./Rope");Object.defineProperty(r,"Rope",{enumerable:!0,get:function(){return n(h).default}})},{"./Mesh":166,"./NineSlicePlane":167,"./Plane":168,"./Rope":169,"./canvas/CanvasMeshRenderer":170,"./webgl/MeshRenderer":172}],172:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),l=n(t("pixi-gl-core")),d=n(t("../Mesh")),f=(t("path"),u.Matrix.IDENTITY),p=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.shader=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new u.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n")},e.prototype.render=function(t){var e=this.renderer,r=e.gl,n=t._texture;if(n.valid){var i=t._glDatas[e.CONTEXT_UID];i||(e.bindVao(null),(i={shader:this.shader,vertexBuffer:l.default.GLBuffer.createVertexBuffer(r,t.vertices,r.STREAM_DRAW),uvBuffer:l.default.GLBuffer.createVertexBuffer(r,t.uvs,r.STREAM_DRAW),indexBuffer:l.default.GLBuffer.createIndexBuffer(r,t.indices,r.STATIC_DRAW),vao:null,dirty:t.dirty,indexDirty:t.indexDirty,vertexDirty:t.vertexDirty}).vao=new l.default.VertexArrayObject(r).addIndex(i.indexBuffer).addAttribute(i.vertexBuffer,i.shader.attributes.aVertexPosition,r.FLOAT,!1,8,0).addAttribute(i.uvBuffer,i.shader.attributes.aTextureCoord,r.FLOAT,!1,8,0),t._glDatas[e.CONTEXT_UID]=i),e.bindVao(i.vao),t.dirty!==i.dirty&&(i.dirty=t.dirty,i.uvBuffer.upload(t.uvs)),t.indexDirty!==i.indexDirty&&(i.indexDirty=t.indexDirty,i.indexBuffer.upload(t.indices)),t.vertexDirty!==i.vertexDirty&&(i.vertexDirty=t.vertexDirty,i.vertexBuffer.upload(t.vertices)),e.bindShader(i.shader),i.shader.uniforms.uSampler=e.bindTexture(n),e.state.setBlendMode(u.utils.correctBlendMode(t.blendMode,n.baseTexture.premultipliedAlpha)),i.shader.uniforms.uTransform&&(t.uploadUvTransform?i.shader.uniforms.uTransform=t._uvTransform.mapCoord.toArray(!0):i.shader.uniforms.uTransform=f.toArray(!0)),i.shader.uniforms.translationMatrix=t.worldTransform.toArray(!0),i.shader.uniforms.uColor=u.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,i.shader.uniforms.uColor,n.baseTexture.premultipliedAlpha);var o=t.drawMode===d.default.DRAW_MODES.TRIANGLE_MESH?r.TRIANGLE_STRIP:r.TRIANGLES;i.vao.draw(o,t.indices.length,0)}},e}(u.ObjectRenderer);r.default=p,u.WebGLRenderer.registerPlugin("mesh",p)},{"../../core":65,"../Mesh":166,path:8,"pixi-gl-core":15}],173:[function(t,e,r){"use strict";r.__esModule=!0;var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),h=t("../core/utils"),l=function(t){function e(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1500,o=arguments[1],s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:16384,a=3<arguments.length&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return 16384<s&&(s=16384),r<s&&(s=r),h._properties=[!1,!0,!1,!1,!1],h._maxSize=r,h._batchSize=s,h._glBuffers={},h._bufferUpdateIDs=[],h._updateID=0,h.interactiveChildren=!1,h.blendMode=u.BLEND_MODES.NORMAL,h.autoResize=a,h.roundPixels=!0,h.baseTexture=null,h.setProperties(o),h._tint=0,h.tintRgb=new Float32Array(4),h.tint=16777215,h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},e.prototype.renderWebGL=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,r=this.worldTransform,n=!0,i=0,o=0,s=0,a=0;t.setBlendMode(this.blendMode),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var u=0;u<this.children.length;++u){var h=this.children[u];if(h.visible){var l=h._texture.frame;if(e.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)n&&(e.setTransform(r.a,r.b,r.c,r.d,r.tx*t.resolution,r.ty*t.resolution),n=!1),i=h.anchor.x*(-l.width*h.scale.x)+h.position.x+.5,o=h.anchor.y*(-l.height*h.scale.y)+h.position.y+.5,s=l.width*h.scale.x,a=l.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var c=h.worldTransform;t.roundPixels?e.setTransform(c.a,c.b,c.c,c.d,c.tx*t.resolution|0,c.ty*t.resolution|0):e.setTransform(c.a,c.b,c.c,c.d,c.tx*t.resolution,c.ty*t.resolution),i=h.anchor.x*-l.width+.5,o=h.anchor.y*-l.height+.5,s=l.width,a=l.height}var d=h._texture.baseTexture.resolution;e.drawImage(h._texture.baseTexture.source,l.x*d,l.y*d,l.width*d,l.height*d,i*t.resolution,o*t.resolution,s*t.resolution,a*t.resolution)}}}},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._buffers)for(var r=0;r<this._buffers.length;++r)this._buffers[r].destroy();this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},s(e,[{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,(0,h.hex2rgb)(t,this.tintRgb)}}]),e}(u.Container);r.default=l},{"../core":65,"../core/utils":125}],174:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./ParticleContainer");Object.defineProperty(r,"ParticleContainer",{enumerable:!0,get:function(){return n(i).default}});var o=t("./webgl/ParticleRenderer");Object.defineProperty(r,"ParticleRenderer",{enumerable:!0,get:function(){return n(o).default}})},{"./ParticleContainer":173,"./webgl/ParticleRenderer":176}],175:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var s=n(t("pixi-gl-core")),u=n(t("../../core/utils/createIndicesForQuads")),h=function(){function t(e,r,n,o){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.gl=e,this.size=o,this.dynamicProperties=[],this.staticProperties=[];for(var s=0;s<r.length;++s){var a=r[s];a={attribute:a.attribute,size:a.size,uploadFunction:a.uploadFunction,unsignedByte:a.unsignedByte,offset:a.offset},n[s]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.gl,e=0;this.indices=(0,u.default)(this.size),this.indexBuffer=s.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW);for(var r=this.dynamicStride=0;r<this.dynamicProperties.length;++r){var n=this.dynamicProperties[r];n.offset=e,e+=n.size,this.dynamicStride+=n.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=s.default.GLBuffer.createVertexBuffer(t,i,t.STREAM_DRAW);for(var o=0,a=this.staticStride=0;a<this.staticProperties.length;++a){var h=this.staticProperties[a];h.offset=o,o+=h.size,this.staticStride+=h.size}var l=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(l),this.staticDataUint32=new Uint32Array(l),this.staticBuffer=s.default.GLBuffer.createVertexBuffer(t,l,t.STATIC_DRAW),this.vao=new s.default.VertexArrayObject(t).addIndex(this.indexBuffer);for(var c=0;c<this.dynamicProperties.length;++c){var d=this.dynamicProperties[c];d.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,d.attribute,t.UNSIGNED_BYTE,!0,4*this.dynamicStride,4*d.offset):this.vao.addAttribute(this.dynamicBuffer,d.attribute,t.FLOAT,!1,4*this.dynamicStride,4*d.offset)}for(var f=0;f<this.staticProperties.length;++f){var p=this.staticProperties[f];p.unsignedByte?this.vao.addAttribute(this.staticBuffer,p.attribute,t.UNSIGNED_BYTE,!0,4*this.staticStride,4*p.offset):this.vao.addAttribute(this.staticBuffer,p.attribute,t.FLOAT,!1,4*this.staticStride,4*p.offset)}},t.prototype.uploadDynamic=function(t,e,r){for(var n=0;n<this.dynamicProperties.length;n++){var i=this.dynamicProperties[n];i.uploadFunction(t,e,r,i.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer.upload()},t.prototype.uploadStatic=function(t,e,r){for(var n=0;n<this.staticProperties.length;n++){var i=this.staticProperties[n];i.uploadFunction(t,e,r,i.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer.upload()},t.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicBuffer.destroy(),this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer.destroy(),this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null},t}();r.default=h},{"../../core/utils/createIndicesForQuads":123,"pixi-gl-core":15}],176:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),l=n(t("./ParticleShader")),d=n(t("./ParticleBuffer")),f=t("../../core/utils"),p=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return n.shader=null,n.indexBuffer=null,n.properties=null,n.tempMatrix=new u.Matrix,n.CONTEXT_UID=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new l.default(t),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},e.prototype.start=function(){this.renderer.bindShader(this.shader)},e.prototype.render=function(t){var e=t.children,r=t._maxSize,n=t._batchSize,i=this.renderer,o=e.length;if(0!==o){r<o&&(o=r);var s=t._glBuffers[i.CONTEXT_UID];s||(s=t._glBuffers[i.CONTEXT_UID]=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.renderer.setBlendMode(u.utils.correctBlendMode(t.blendMode,a.premultipliedAlpha));var h=i.gl,l=t.worldTransform.copy(this.tempMatrix);l.prepend(i._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=l.toArray(!0),this.shader.uniforms.uColor=u.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,a.premultipliedAlpha),this.shader.uniforms.uSampler=i.bindTexture(a);for(var c=!1,d=0,f=0;d<o;d+=n,f+=1){var p=o-d;if(n<p&&(p=n),f>=s.length){if(!t.autoResize)break;s.push(this._generateOneMoreBuffer(t))}var v=s[f];v.uploadDynamic(e,d,p);var g=t._bufferUpdateIDs[f]||0;(c=c||v._updateID<g)&&(v._updateID=t._updateID,v.uploadStatic(e,d,p)),i.bindVao(v.vao),v.vao.draw(h.TRIANGLES,6*p)}}},e.prototype.generateBuffers=function(t){for(var e=this.renderer.gl,r=[],n=t._maxSize,i=t._batchSize,o=t._properties,s=0;s<n;s+=i)r.push(new d.default(e,this.properties,o,i));return r},e.prototype._generateOneMoreBuffer=function(t){var e=this.renderer.gl,r=t._batchSize,n=t._properties;return new d.default(e,this.properties,n,r)},e.prototype.uploadVertices=function(t,e,r,n,i,o){for(var s=0,a=0,u=0,h=0,l=0;l<r;++l){var c=t[e+l],d=c._texture,f=c.scale.x,p=c.scale.y,v=d.trim,g=d.orig;v?(s=(a=v.x-c.anchor.x*g.width)+v.width,u=(h=v.y-c.anchor.y*g.height)+v.height):(s=g.width*(1-c.anchor.x),a=g.width*-c.anchor.x,u=g.height*(1-c.anchor.y),h=g.height*-c.anchor.y),n[o]=a*f,n[o+1]=h*p,n[o+i]=s*f,n[o+i+1]=h*p,n[o+2*i]=s*f,n[o+2*i+1]=u*p,n[o+3*i]=a*f,n[o+3*i+1]=u*p,o+=4*i}},e.prototype.uploadPosition=function(t,e,r,n,i,o){for(var s=0;s<r;s++){var a=t[e+s].position;n[o]=a.x,n[o+1]=a.y,n[o+i]=a.x,n[o+i+1]=a.y,n[o+2*i]=a.x,n[o+2*i+1]=a.y,n[o+3*i]=a.x,n[o+3*i+1]=a.y,o+=4*i}},e.prototype.uploadRotation=function(t,e,r,n,i,o){for(var s=0;s<r;s++){var a=t[e+s].rotation;n[o]=a,n[o+i]=a,n[o+2*i]=a,n[o+3*i]=a,o+=4*i}},e.prototype.uploadUvs=function(t,e,r,n,i,o){for(var s=0;s<r;++s){var a=t[e+s]._texture._uvs;a?(n[o]=a.x0,n[o+1]=a.y0,n[o+i]=a.x1,n[o+i+1]=a.y1,n[o+2*i]=a.x2,n[o+2*i+1]=a.y2,n[o+3*i]=a.x3,n[o+3*i+1]=a.y3):(n[o]=0,n[o+1]=0,n[o+i]=0,n[o+i+1]=0,n[o+2*i]=0,n[o+2*i+1]=0,n[o+3*i]=0,n[o+3*i+1]=0),o+=4*i}},e.prototype.uploadTint=function(t,e,r,n,i,o){for(var s=0;s<r;++s){var a=t[e+s],u=a._texture.baseTexture.premultipliedAlpha,h=a.alpha,l=h<1&&u?(0,f.premultiplyTint)(a._tintRGB,h):a._tintRGB+(255*h<<24);n[o]=l,n[o+i]=l,n[o+2*i]=l,n[o+3*i]=l,o+=4*i}},e.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),t.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},e}(u.ObjectRenderer);r.default=p,u.WebGLRenderer.registerPlugin("particle",p)},{"../../core":65,"../../core/utils":125,"./ParticleBuffer":175,"./ParticleShader":177}],177:[function(t,e,r){"use strict";r.__esModule=!0;var u=function(t){function e(r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   vec2 v = vec2(x, y);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  gl_FragColor = color;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("../../core/Shader")).default);r.default=u},{"../../core/Shader":44}],178:[function(t,e,r){"use strict";Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:0<t?1:-1})},{}],179:[function(t,e,r){"use strict";Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t})},{}],180:[function(t,e,r){"use strict";var i=function(t){return t&&t.__esModule?t:{default:t}}(t("object-assign"));Object.assign||(Object.assign=i.default)},{"object-assign":6}],181:[function(t,e,r){"use strict";t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign"),t("./Number.isInteger"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":178,"./Number.isInteger":179,"./Object.assign":180,"./requestAnimationFrame":182}],182:[function(t,e,r){(function(t){"use strict";if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var r=Date.now(),n=["ms","moz","webkit","o"],i=0;i<n.length&&!t.requestAnimationFrame;++i){var o=n[i];t.requestAnimationFrame=t[o+"RequestAnimationFrame"],t.cancelAnimationFrame=t[o+"CancelAnimationFrame"]||t[o+"CancelRequestAnimationFrame"]}t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+r-e;return n<0&&(n=0),r=e,setTimeout(function(){r=Date.now(),t(performance.now())},n)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){return clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],183:[function(t,e,r){"use strict";function i(t,e){var r=!1;if(t&&t._textures&&t._textures.length)for(var n=0;n<t._textures.length;n++)if(t._textures[n]instanceof d.Texture){var i=t._textures[n].baseTexture;-1===e.indexOf(i)&&(e.push(i),r=!0)}return r}function o(t,e){return t instanceof d.BaseTexture&&(-1===e.indexOf(t)&&e.push(t),!0)}function s(t,e){if(t._texture&&t._texture instanceof d.Texture){var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function a(t,e){return e instanceof d.Text&&(e.updateText(!0),!0)}function u(t,e){if(e instanceof d.TextStyle){var r=e.toFontString();return d.TextMetrics.measureFont(r),!0}return!1}function h(t,e){if(t instanceof d.Text){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var r=t._texture.baseTexture;return-1===e.indexOf(r)&&e.push(r),!0}return!1}function l(t,e){return t instanceof d.TextStyle&&(-1===e.indexOf(t)&&e.push(t),!0)}r.__esModule=!0;var d=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../core")),p=function(t){return t&&t.__esModule?t:{default:t}}(t("./limiters/CountLimiter")),v=d.ticker.shared;d.settings.UPLOADS_PER_FRAME=4;var g=function(){function t(e){var r=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.limiter=new p.default(d.settings.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){r.queue&&r.prepareItems()},this.registerFindHook(h),this.registerFindHook(l),this.registerFindHook(i),this.registerFindHook(o),this.registerFindHook(s),this.registerUploadHook(a),this.registerUploadHook(u)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,v.addOnce(this.tick,this,d.UPDATE_PRIORITY.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)v.addOnce(this.tick,this,d.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;for(var i=this.completes.slice(0),o=this.completes.length=0,s=i.length;o<s;o++)i[o]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof d.Container)for(var n=t.children.length-1;0<=n;n--)this.add(t.children[n]);return this},t.prototype.destroy=function(){this.ticking&&v.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();r.default=g},{"../core":65,"./limiters/CountLimiter":186}],184:[function(t,e,r){"use strict";function s(t,e){if(e instanceof u.BaseTexture){var r=e.source,n=0===r.width?t.canvas.width:Math.min(t.canvas.width,r.width),i=0===r.height?t.canvas.height:Math.min(t.canvas.height,r.height);return t.ctx.drawImage(r,0,0,n,i,0,0,t.canvas.width,t.canvas.height),!0}return!1}r.__esModule=!0;var u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),l=function(t){return t&&t.__esModule?t:{default:t}}(t("../BasePrepare")),d=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return(o.uploadHookHelper=o).canvas=document.createElement("canvas"),o.canvas.width=16,o.canvas.height=16,o.ctx=o.canvas.getContext("2d"),o.registerUploadHook(s),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ctx=null,this.canvas=null},e}(l.default);r.default=d,u.CanvasRenderer.registerPlugin("prepare",d)},{"../../core":65,"../BasePrepare":183}],185:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}r.__esModule=!0;var i=t("./webgl/WebGLPrepare");Object.defineProperty(r,"webgl",{enumerable:!0,get:function(){return n(i).default}});var o=t("./canvas/CanvasPrepare");Object.defineProperty(r,"canvas",{enumerable:!0,get:function(){return n(o).default}});var s=t("./BasePrepare");Object.defineProperty(r,"BasePrepare",{enumerable:!0,get:function(){return n(s).default}});var a=t("./limiters/CountLimiter");Object.defineProperty(r,"CountLimiter",{enumerable:!0,get:function(){return n(a).default}});var u=t("./limiters/TimeLimiter");Object.defineProperty(r,"TimeLimiter",{enumerable:!0,get:function(){return n(u).default}})},{"./BasePrepare":183,"./canvas/CanvasPrepare":184,"./limiters/CountLimiter":186,"./limiters/TimeLimiter":187,"./webgl/WebGLPrepare":188}],186:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.maxItemsPerFrame=e,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return 0<this.itemsLeft--},t}();r.default=i},{}],187:[function(t,e,r){"use strict";r.__esModule=!0;var i=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.maxMilliseconds=e,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}();r.default=i},{}],188:[function(t,e,r){"use strict";function s(t,e){return e instanceof l.BaseTexture&&(e._glTextures[t.CONTEXT_UID]||t.textureManager.updateTexture(e),!0)}function a(t,e){return e instanceof l.Graphics&&(!e.dirty&&!e.clearDirty&&e._webGL[t.plugins.graphics.CONTEXT_UID]||t.plugins.graphics.updateGraphics(e),!0)}function u(t,e){return t instanceof l.Graphics&&(e.push(t),!0)}r.__esModule=!0;var l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(t("../../core")),f=function(t){function e(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,r));return o.uploadHookHelper=o.renderer,o.registerFindHook(u),o.registerUploadHook(s),o.registerUploadHook(a),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(function(t){return t&&t.__esModule?t:{default:t}}(t("../BasePrepare")).default);r.default=f,l.WebGLRenderer.registerPlugin("prepare",f)},{"../../core":65,"../BasePrepare":183}],189:[function(t,e,r){(function(e){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}r.__esModule=!0,r.loader=r.prepare=r.particles=r.mesh=r.loaders=r.interaction=r.filters=r.extras=r.extract=r.accessibility=void 0;var i=t("./polyfill");Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(r,t,{enumerable:!0,get:function(){return i[t]}})});var o=t("./core");Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(r,t,{enumerable:!0,get:function(){return o[t]}})});var a=function(t){return t&&t.__esModule?t:{default:t}}(t("./deprecation")),h=n(t("./accessibility")),c=n(t("./extract")),f=n(t("./extras")),v=n(t("./filters")),y=n(t("./interaction")),_=n(t("./loaders")),x=n(t("./mesh")),w=n(t("./particles")),S=n(t("./prepare"));o.utils.mixins.performMixins();var O=_.shared||null;r.accessibility=h,r.extract=c,r.extras=f,r.filters=v,r.interaction=y,r.loaders=_,r.mesh=x,r.particles=w,r.prepare=S,r.loader=O,"function"==typeof a.default&&(0,a.default)(r),e.PIXI=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":42,"./core":65,"./deprecation":131,"./extract":133,"./extras":141,"./filters":153,"./interaction":159,"./loaders":162,"./mesh":171,"./particles":174,"./polyfill":181,"./prepare":185}]},{},[189])(189)});var pixi_spine,__extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();!function(pixi_spine){!function(core){var MixBlend,MixDirection,TimelineType,Animation=function(){function Animation(name,timelines,duration){if(null==name)throw new Error("name cannot be null.");if(null==timelines)throw new Error("timelines cannot be null.");this.name=name,this.timelines=timelines,this.duration=duration}return Animation.prototype.apply=function(skeleton,lastTime,time,loop,events,alpha,blend,direction){if(null==skeleton)throw new Error("skeleton cannot be null.");loop&&0!=this.duration&&(time%=this.duration,0<lastTime&&(lastTime%=this.duration));for(var timelines=this.timelines,i=0,n=timelines.length;i<n;i++)timelines[i].apply(skeleton,lastTime,time,events,alpha,blend,direction)},Animation.binarySearch=function(values,target,step){void 0===step&&(step=1);var low=0,high=values.length/step-2;if(0==high)return step;for(var current=high>>>1;;){if(values[(current+1)*step]<=target?low=current+1:high=current,low==high)return(low+1)*step;current=low+high>>>1}},Animation.linearSearch=function(values,target,step){for(var i=0,last=values.length-step;i<=last;i+=step)if(values[i]>target)return i;return-1},Animation}();core.Animation=Animation,function(MixBlend){MixBlend[MixBlend.setup=0]="setup",MixBlend[MixBlend.first=1]="first",MixBlend[MixBlend.replace=2]="replace",MixBlend[MixBlend.add=3]="add"}(MixBlend=core.MixBlend||(core.MixBlend={})),function(MixDirection){MixDirection[MixDirection.in=0]="in",MixDirection[MixDirection.out=1]="out"}(MixDirection=core.MixDirection||(core.MixDirection={})),function(TimelineType){TimelineType[TimelineType.rotate=0]="rotate",TimelineType[TimelineType.translate=1]="translate",TimelineType[TimelineType.scale=2]="scale",TimelineType[TimelineType.shear=3]="shear",TimelineType[TimelineType.attachment=4]="attachment",TimelineType[TimelineType.color=5]="color",TimelineType[TimelineType.deform=6]="deform",TimelineType[TimelineType.event=7]="event",TimelineType[TimelineType.drawOrder=8]="drawOrder",TimelineType[TimelineType.ikConstraint=9]="ikConstraint",TimelineType[TimelineType.transformConstraint=10]="transformConstraint",TimelineType[TimelineType.pathConstraintPosition=11]="pathConstraintPosition",TimelineType[TimelineType.pathConstraintSpacing=12]="pathConstraintSpacing",TimelineType[TimelineType.pathConstraintMix=13]="pathConstraintMix",TimelineType[TimelineType.twoColor=14]="twoColor"}(TimelineType=core.TimelineType||(core.TimelineType={}));var CurveTimeline=function(){function CurveTimeline(frameCount){if(frameCount<=0)throw new Error("frameCount must be > 0: "+frameCount);this.curves=core.Utils.newFloatArray((frameCount-1)*CurveTimeline.BEZIER_SIZE)}return CurveTimeline.prototype.getFrameCount=function(){return this.curves.length/CurveTimeline.BEZIER_SIZE+1},CurveTimeline.prototype.setLinear=function(frameIndex){this.curves[frameIndex*CurveTimeline.BEZIER_SIZE]=CurveTimeline.LINEAR},CurveTimeline.prototype.setStepped=function(frameIndex){this.curves[frameIndex*CurveTimeline.BEZIER_SIZE]=CurveTimeline.STEPPED},CurveTimeline.prototype.getCurveType=function(frameIndex){var index=frameIndex*CurveTimeline.BEZIER_SIZE;if(index==this.curves.length)return CurveTimeline.LINEAR;var type=this.curves[index];return type==CurveTimeline.LINEAR?CurveTimeline.LINEAR:type==CurveTimeline.STEPPED?CurveTimeline.STEPPED:CurveTimeline.BEZIER},CurveTimeline.prototype.setCurve=function(frameIndex,cx1,cy1,cx2,cy2){var tmpx=.03*(2*-cx1+cx2),tmpy=.03*(2*-cy1+cy2),dddfx=.006*(3*(cx1-cx2)+1),dddfy=.006*(3*(cy1-cy2)+1),ddfx=2*tmpx+dddfx,ddfy=2*tmpy+dddfy,dfx=.3*cx1+tmpx+.16666667*dddfx,dfy=.3*cy1+tmpy+.16666667*dddfy,i=frameIndex*CurveTimeline.BEZIER_SIZE,curves=this.curves;curves[i++]=CurveTimeline.BEZIER;for(var x=dfx,y=dfy,n=i+CurveTimeline.BEZIER_SIZE-1;i<n;i+=2)curves[i]=x,curves[i+1]=y,dfx+=ddfx,dfy+=ddfy,ddfx+=dddfx,ddfy+=dddfy,x+=dfx,y+=dfy},CurveTimeline.prototype.getCurvePercent=function(frameIndex,percent){percent=core.MathUtils.clamp(percent,0,1);var curves=this.curves,i=frameIndex*CurveTimeline.BEZIER_SIZE,type=curves[i];if(type==CurveTimeline.LINEAR)return percent;if(type==CurveTimeline.STEPPED)return 0;for(var x=0,start=++i,n=i+CurveTimeline.BEZIER_SIZE-1;i<n;i+=2)if(percent<=(x=curves[i])){var prevX=void 0,prevY=void 0;return(prevY=i==start?prevX=0:(prevX=curves[i-2],curves[i-1]))+(curves[i+1]-prevY)*(percent-prevX)/(x-prevX)}var y=curves[i-1];return y+(1-y)*(percent-x)/(1-x)},CurveTimeline.LINEAR=0,CurveTimeline.STEPPED=1,CurveTimeline.BEZIER=2,CurveTimeline.BEZIER_SIZE=19,CurveTimeline}(),RotateTimeline=function(_super){function RotateTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount<<1),_this}return __extends(RotateTimeline,_super),RotateTimeline.prototype.getPropertyId=function(){return(TimelineType.rotate<<24)+this.boneIndex},RotateTimeline.prototype.setFrame=function(frameIndex,time,degrees){frameIndex<<=1,this.frames[frameIndex]=time,this.frames[frameIndex+RotateTimeline.ROTATION]=degrees},RotateTimeline.prototype.apply=function(skeleton,lastTime,time,events,alpha,blend,direction){var frames=this.frames,bone=skeleton.bones[this.boneIndex];if(time<frames[0])switch(blend){case MixBlend.setup:return void(bone.rotation=bone.data.rotation);case MixBlend.first:var r_1=bone.data.rotation-bone.rotation;bone.rotation+=(r_1-360*(16384-(16384.499999999996-r_1/360|0)))*alpha}else if(time>=frames[frames.length-RotateTimeline.ENTRIES]){var r_2=frames[frames.length+RotateTimeline.PREV_ROTATION];switch(blend){case MixBlend.setup:bone.rotation=bone.data.rotation+r_2*alpha;break;case MixBlend.first:case MixBlend.replace:r_2+=bone.data.rotation-bone.rotation,r_2-=360*(16384-(16384.499999999996-r_2/360|0));case MixBlend.add:bone.rotation+=r_2*alpha}}else{var frame=Animation.binarySearch(frames,time,RotateTimeline.ENTRIES),prevRotation=frames[frame+RotateTimeline.PREV_ROTATION],frameTime=frames[frame],percent=this.getCurvePercent((frame>>1)-1,1-(time-frameTime)/(frames[frame+RotateTimeline.PREV_TIME]-frameTime)),r=frames[frame+RotateTimeline.ROTATION]-prevRotation;switch(r=prevRotation+(r-360*(16384-(16384.499999999996-r/360|0)))*percent,blend){case MixBlend.setup:bone.rotation=bone.data.rotation+(r-360*(16384-(16384.499999999996-r/360|0)))*alpha;break;case MixBlend.first:case MixBlend.replace:r+=bone.data.rotation-bone.rotation;case MixBlend.add:bone.rotation+=(r-360*(16384-(16384.499999999996-r/360|0)))*alpha}}},RotateTimeline.ENTRIES=2,RotateTimeline.PREV_TIME=-2,RotateTimeline.PREV_ROTATION=-1,RotateTimeline.ROTATION=1,RotateTimeline}(core.CurveTimeline=CurveTimeline);core.RotateTimeline=RotateTimeline;var TranslateTimeline=function(_super){function TranslateTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount*TranslateTimeline.ENTRIES),_this}return __extends(TranslateTimeline,_super),TranslateTimeline.prototype.getPropertyId=function(){return(TimelineType.translate<<24)+this.boneIndex},TranslateTimeline.prototype.setFrame=function(frameIndex,time,x,y){frameIndex*=TranslateTimeline.ENTRIES,this.frames[frameIndex]=time,this.frames[frameIndex+TranslateTimeline.X]=x,this.frames[frameIndex+TranslateTimeline.Y]=y},TranslateTimeline.prototype.apply=function(skeleton,lastTime,time,events,alpha,blend,direction){var frames=this.frames,bone=skeleton.bones[this.boneIndex];if(time<frames[0])switch(blend){case MixBlend.setup:return bone.x=bone.data.x,void(bone.y=bone.data.y);case MixBlend.first:bone.x+=(bone.data.x-bone.x)*alpha,bone.y+=(bone.data.y-bone.y)*alpha}else{var x=0,y=0;if(time>=frames[frames.length-TranslateTimeline.ENTRIES])x=frames[frames.length+TranslateTimeline.PREV_X],y=frames[frames.length+TranslateTimeline.PREV_Y];else{var frame=Animation.binarySearch(frames,time,TranslateTimeline.ENTRIES);x=frames[frame+TranslateTimeline.PREV_X],y=frames[frame+TranslateTimeline.PREV_Y];var frameTime=frames[frame],percent=this.getCurvePercent(frame/TranslateTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+TranslateTimeline.PREV_TIME]-frameTime));x+=(frames[frame+TranslateTimeline.X]-x)*percent,y+=(frames[frame+TranslateTimeline.Y]-y)*percent}switch(blend){case MixBlend.setup:bone.x=bone.data.x+x*alpha,bone.y=bone.data.y+y*alpha;break;case MixBlend.first:case MixBlend.replace:bone.x+=(bone.data.x+x-bone.x)*alpha,bone.y+=(bone.data.y+y-bone.y)*alpha;break;case MixBlend.add:bone.x+=x*alpha,bone.y+=y*alpha}}},TranslateTimeline.ENTRIES=3,TranslateTimeline.PREV_TIME=-3,TranslateTimeline.PREV_X=-2,TranslateTimeline.PREV_Y=-1,TranslateTimeline.X=1,TranslateTimeline.Y=2,TranslateTimeline}(CurveTimeline),ScaleTimeline=function(_super){function ScaleTimeline(frameCount){return _super.call(this,frameCount)||this}return __extends(ScaleTimeline,_super),ScaleTimeline.prototype.getPropertyId=function(){return(TimelineType.scale<<24)+this.boneIndex},ScaleTimeline.prototype.apply=function(skeleton,lastTime,time,events,alpha,blend,direction){var frames=this.frames,bone=skeleton.bones[this.boneIndex];if(time<frames[0])switch(blend){case MixBlend.setup:return bone.scaleX=bone.data.scaleX,void(bone.scaleY=bone.data.scaleY);case MixBlend.first:bone.scaleX+=(bone.data.scaleX-bone.scaleX)*alpha,bone.scaleY+=(bone.data.scaleY-bone.scaleY)*alpha}else{var x=0,y=0;if(time>=frames[frames.length-ScaleTimeline.ENTRIES])x=frames[frames.length+ScaleTimeline.PREV_X]*bone.data.scaleX,y=frames[frames.length+ScaleTimeline.PREV_Y]*bone.data.scaleY;else{var frame=Animation.binarySearch(frames,time,ScaleTimeline.ENTRIES);x=frames[frame+ScaleTimeline.PREV_X],y=frames[frame+ScaleTimeline.PREV_Y];var frameTime=frames[frame],percent=this.getCurvePercent(frame/ScaleTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+ScaleTimeline.PREV_TIME]-frameTime));x=(x+(frames[frame+ScaleTimeline.X]-x)*percent)*bone.data.scaleX,y=(y+(frames[frame+ScaleTimeline.Y]-y)*percent)*bone.data.scaleY}if(1==alpha)blend==MixBlend.add?(bone.scaleX+=x-bone.data.scaleX,bone.scaleY+=y-bone.data.scaleY):(bone.scaleX=x,bone.scaleY=y);else{var bx=0,by=0;if(direction==MixDirection.out)switch(blend){case MixBlend.setup:bx=bone.data.scaleX,by=bone.data.scaleY,bone.scaleX=bx+(Math.abs(x)*core.MathUtils.signum(bx)-bx)*alpha,bone.scaleY=by+(Math.abs(y)*core.MathUtils.signum(by)-by)*alpha;break;case MixBlend.first:case MixBlend.replace:bx=bone.scaleX,by=bone.scaleY,bone.scaleX=bx+(Math.abs(x)*core.MathUtils.signum(bx)-bx)*alpha,bone.scaleY=by+(Math.abs(y)*core.MathUtils.signum(by)-by)*alpha;break;case MixBlend.add:bx=bone.scaleX,by=bone.scaleY,bone.scaleX=bx+(Math.abs(x)*core.MathUtils.signum(bx)-bone.data.scaleX)*alpha,bone.scaleY=by+(Math.abs(y)*core.MathUtils.signum(by)-bone.data.scaleY)*alpha}else switch(blend){case MixBlend.setup:bx=Math.abs(bone.data.scaleX)*core.MathUtils.signum(x),by=Math.abs(bone.data.scaleY)*core.MathUtils.signum(y),bone.scaleX=bx+(x-bx)*alpha,bone.scaleY=by+(y-by)*alpha;break;case MixBlend.first:case MixBlend.replace:bx=Math.abs(bone.scaleX)*core.MathUtils.signum(x),by=Math.abs(bone.scaleY)*core.MathUtils.signum(y),bone.scaleX=bx+(x-bx)*alpha,bone.scaleY=by+(y-by)*alpha;break;case MixBlend.add:bx=core.MathUtils.signum(x),by=core.MathUtils.signum(y),bone.scaleX=Math.abs(bone.scaleX)*bx+(x-Math.abs(bone.data.scaleX)*bx)*alpha,bone.scaleY=Math.abs(bone.scaleY)*by+(y-Math.abs(bone.data.scaleY)*by)*alpha}}}},ScaleTimeline}(core.TranslateTimeline=TranslateTimeline);core.ScaleTimeline=ScaleTimeline;var ShearTimeline=function(_super){function ShearTimeline(frameCount){return _super.call(this,frameCount)||this}return __extends(ShearTimeline,_super),ShearTimeline.prototype.getPropertyId=function(){return(TimelineType.shear<<24)+this.boneIndex},ShearTimeline.prototype.apply=function(skeleton,lastTime,time,events,alpha,blend,direction){var frames=this.frames,bone=skeleton.bones[this.boneIndex];if(time<frames[0])switch(blend){case MixBlend.setup:return bone.shearX=bone.data.shearX,void(bone.shearY=bone.data.shearY);case MixBlend.first:bone.shearX+=(bone.data.shearX-bone.shearX)*alpha,bone.shearY+=(bone.data.shearY-bone.shearY)*alpha}else{var x=0,y=0;if(time>=frames[frames.length-ShearTimeline.ENTRIES])x=frames[frames.length+ShearTimeline.PREV_X],y=frames[frames.length+ShearTimeline.PREV_Y];else{var frame=Animation.binarySearch(frames,time,ShearTimeline.ENTRIES);x=frames[frame+ShearTimeline.PREV_X],y=frames[frame+ShearTimeline.PREV_Y];var frameTime=frames[frame],percent=this.getCurvePercent(frame/ShearTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+ShearTimeline.PREV_TIME]-frameTime));x+=(frames[frame+ShearTimeline.X]-x)*percent,y+=(frames[frame+ShearTimeline.Y]-y)*percent}switch(blend){case MixBlend.setup:bone.shearX=bone.data.shearX+x*alpha,bone.shearY=bone.data.shearY+y*alpha;break;case MixBlend.first:case MixBlend.replace:bone.shearX+=(bone.data.shearX+x-bone.shearX)*alpha,bone.shearY+=(bone.data.shearY+y-bone.shearY)*alpha;break;case MixBlend.add:bone.shearX+=x*alpha,bone.shearY+=y*alpha}}},ShearTimeline}(TranslateTimeline);core.ShearTimeline=ShearTimeline;var ColorTimeline=function(_super){function ColorTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount*ColorTimeline.ENTRIES),_this}return __extends(ColorTimeline,_super),ColorTimeline.prototype.getPropertyId=function(){return(TimelineType.color<<24)+this.slotIndex},ColorTimeline.prototype.setFrame=function(frameIndex,time,r,g,b,a){frameIndex*=ColorTimeline.ENTRIES,this.frames[frameIndex]=time,this.frames[frameIndex+ColorTimeline.R]=r,this.frames[frameIndex+ColorTimeline.G]=g,this.frames[frameIndex+ColorTimeline.B]=b,this.frames[frameIndex+ColorTimeline.A]=a},ColorTimeline.prototype.apply=function(skeleton,lastTime,time,events,alpha,blend,direction){var slot=skeleton.slots[this.slotIndex],frames=this.frames;if(time<frames[0])switch(blend){case MixBlend.setup:return void slot.color.setFromColor(slot.data.color);case MixBlend.first:var color=slot.color,setup=slot.data.color;color.add((setup.r-color.r)*alpha,(setup.g-color.g)*alpha,(setup.b-color.b)*alpha,(setup.a-color.a)*alpha)}else{var r=0,g=0,b=0,a=0;if(time>=frames[frames.length-ColorTimeline.ENTRIES]){var i=frames.length;r=frames[i+ColorTimeline.PREV_R],g=frames[i+ColorTimeline.PREV_G],b=frames[i+ColorTimeline.PREV_B],a=frames[i+ColorTimeline.PREV_A]}else{var frame=Animation.binarySearch(frames,time,ColorTimeline.ENTRIES);r=frames[frame+ColorTimeline.PREV_R],g=frames[frame+ColorTimeline.PREV_G],b=frames[frame+ColorTimeline.PREV_B],a=frames[frame+ColorTimeline.PREV_A];var frameTime=frames[frame],percent=this.getCurvePercent(frame/ColorTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+ColorTimeline.PREV_TIME]-frameTime));r+=(frames[frame+ColorTimeline.R]-r)*percent,g+=(frames[frame+ColorTimeline.G]-g)*percent,b+=(frames[frame+ColorTimeline.B]-b)*percent,a+=(frames[frame+ColorTimeline.A]-a)*percent}if(1==alpha)slot.color.set(r,g,b,a);else{color=slot.color;blend==MixBlend.setup&&color.setFromColor(slot.data.color),color.add((r-color.r)*alpha,(g-color.g)*alpha,(b-color.b)*alpha,(a-color.a)*alpha)}}},ColorTimeline.ENTRIES=5,ColorTimeline.PREV_TIME=-5,ColorTimeline.PREV_R=-4,ColorTimeline.PREV_G=-3,ColorTimeline.PREV_B=-2,ColorTimeline.PREV_A=-1,ColorTimeline.R=1,ColorTimeline.G=2,ColorTimeline.B=3,ColorTimeline.A=4,ColorTimeline}(CurveTimeline);core.ColorTimeline=ColorTimeline;var TwoColorTimeline=function(_super){function TwoColorTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount*TwoColorTimeline.ENTRIES),_this}return __extends(TwoColorTimeline,_super),TwoColorTimeline.prototype.getPropertyId=function(){return(TimelineType.twoColor<<24)+this.slotIndex},TwoColorTimeline.prototype.setFrame=function(frameIndex,time,r,g,b,a,r2,g2,b2){frameIndex*=TwoColorTimeline.ENTRIES,this.frames[frameIndex]=time,this.frames[frameIndex+TwoColorTimeline.R]=r,this.frames[frameIndex+TwoColorTimeline.G]=g,this.frames[frameIndex+TwoColorTimeline.B]=b,this.frames[frameIndex+TwoColorTimeline.A]=a,this.frames[frameIndex+TwoColorTimeline.R2]=r2,this.frames[frameIndex+TwoColorTimeline.G2]=g2,this.frames[frameIndex+TwoColorTimeline.B2]=b2},TwoColorTimeline.prototype.apply=function(skeleton,lastTime,time,events,alpha,blend,direction){var slot=skeleton.slots[this.slotIndex],frames=this.frames;if(time<frames[0])switch(blend){case MixBlend.setup:return slot.color.setFromColor(slot.data.color),void slot.darkColor.setFromColor(slot.data.darkColor);case MixBlend.first:var light=slot.color,dark=slot.darkColor,setupLight=slot.data.color,setupDark=slot.data.darkColor;light.add((setupLight.r-light.r)*alpha,(setupLight.g-light.g)*alpha,(setupLight.b-light.b)*alpha,(setupLight.a-light.a)*alpha),dark.add((setupDark.r-dark.r)*alpha,(setupDark.g-dark.g)*alpha,(setupDark.b-dark.b)*alpha,0)}else{var r=0,g=0,b=0,a=0,r2=0,g2=0,b2=0;if(time>=frames[frames.length-TwoColorTimeline.ENTRIES]){var i=frames.length;r=frames[i+TwoColorTimeline.PREV_R],g=frames[i+TwoColorTimeline.PREV_G],b=frames[i+TwoColorTimeline.PREV_B],a=frames[i+TwoColorTimeline.PREV_A],r2=frames[i+TwoColorTimeline.PREV_R2],g2=frames[i+TwoColorTimeline.PREV_G2],b2=frames[i+TwoColorTimeline.PREV_B2]}else{var frame=Animation.binarySearch(frames,time,TwoColorTimeline.ENTRIES);r=frames[frame+TwoColorTimeline.PREV_R],g=frames[frame+TwoColorTimeline.PREV_G],b=frames[frame+TwoColorTimeline.PREV_B],a=frames[frame+TwoColorTimeline.PREV_A],r2=frames[frame+TwoColorTimeline.PREV_R2],g2=frames[frame+TwoColorTimeline.PREV_G2],b2=frames[frame+TwoColorTimeline.PREV_B2];var frameTime=frames[frame],percent=this.getCurvePercent(frame/TwoColorTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+TwoColorTimeline.PREV_TIME]-frameTime));r+=(frames[frame+TwoColorTimeline.R]-r)*percent,g+=(frames[frame+TwoColorTimeline.G]-g)*percent,b+=(frames[frame+TwoColorTimeline.B]-b)*percent,a+=(frames[frame+TwoColorTimeline.A]-a)*percent,r2+=(frames[frame+TwoColorTimeline.R2]-r2)*percent,g2+=(frames[frame+TwoColorTimeline.G2]-g2)*percent,b2+=(frames[frame+TwoColorTimeline.B2]-b2)*percent}if(1==alpha)slot.color.set(r,g,b,a),slot.darkColor.set(r2,g2,b2,1);else{light=slot.color,dark=slot.darkColor;blend==MixBlend.setup&&(light.setFromColor(slot.data.color),dark.setFromColor(slot.data.darkColor)),light.add((r-light.r)*alpha,(g-light.g)*alpha,(b-light.b)*alpha,(a-light.a)*alpha),dark.add((r2-dark.r)*alpha,(g2-dark.g)*alpha,(b2-dark.b)*alpha,0)}}},TwoColorTimeline.ENTRIES=8,TwoColorTimeline.PREV_TIME=-8,TwoColorTimeline.PREV_R=-7,TwoColorTimeline.PREV_G=-6,TwoColorTimeline.PREV_B=-5,TwoColorTimeline.PREV_A=-4,TwoColorTimeline.PREV_R2=-3,TwoColorTimeline.PREV_G2=-2,TwoColorTimeline.PREV_B2=-1,TwoColorTimeline.R=1,TwoColorTimeline.G=2,TwoColorTimeline.B=3,TwoColorTimeline.A=4,TwoColorTimeline.R2=5,TwoColorTimeline.G2=6,TwoColorTimeline.B2=7,TwoColorTimeline}(CurveTimeline);core.TwoColorTimeline=TwoColorTimeline;var AttachmentTimeline=function(){function AttachmentTimeline(frameCount){this.frames=core.Utils.newFloatArray(frameCount),this.attachmentNames=new Array(frameCount)}return AttachmentTimeline.prototype.getPropertyId=function(){return(TimelineType.attachment<<24)+this.slotIndex},AttachmentTimeline.prototype.getFrameCount=function(){return this.frames.length},AttachmentTimeline.prototype.setFrame=function(frameIndex,time,attachmentName){this.frames[frameIndex]=time,this.attachmentNames[frameIndex]=attachmentName},AttachmentTimeline.prototype.apply=function(skeleton,lastTime,time,events,alpha,blend,direction){var slot=skeleton.slots[this.slotIndex];if(direction!=MixDirection.out||blend!=MixBlend.setup){var frames=this.frames;if(time<frames[0]){if(blend==MixBlend.setup||blend==MixBlend.first){var attachmentName_2=slot.data.attachmentName;slot.setAttachment(null==attachmentName_2?null:skeleton.getAttachment(this.slotIndex,attachmentName_2))}}else{var frameIndex=0;frameIndex=time>=frames[frames.length-1]?frames.length-1:Animation.binarySearch(frames,time,1)-1;var attachmentName=this.attachmentNames[frameIndex];skeleton.slots[this.slotIndex].setAttachment(null==attachmentName?null:skeleton.getAttachment(this.slotIndex,attachmentName))}}else{var attachmentName_1=slot.data.attachmentName;slot.setAttachment(null==attachmentName_1?null:skeleton.getAttachment(this.slotIndex,attachmentName_1))}},AttachmentTimeline}();core.AttachmentTimeline=AttachmentTimeline;var zeros=null,DeformTimeline=function(_super){function DeformTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount),_this.frameVertices=new Array(frameCount),null==zeros&&(zeros=core.Utils.newFloatArray(64)),_this}return __extends(DeformTimeline,_super),DeformTimeline.prototype.getPropertyId=function(){return(TimelineType.deform<<27)+ +this.attachment.id+this.slotIndex},DeformTimeline.prototype.setFrame=function(frameIndex,time,vertices){this.frames[frameIndex]=time,this.frameVertices[frameIndex]=vertices},DeformTimeline.prototype.apply=function(skeleton,lastTime,time,firedEvents,alpha,blend,direction){var slot=skeleton.slots[this.slotIndex],slotAttachment=slot.getAttachment();if(slotAttachment instanceof core.VertexAttachment&&slotAttachment.applyDeform(this.attachment)){var verticesArray=slot.attachmentVertices;0==verticesArray.length&&(blend=MixBlend.setup);var frameVertices=this.frameVertices,vertexCount=frameVertices[0].length,frames=this.frames;if(time<frames[0]){var vertexAttachment=slotAttachment;switch(blend){case MixBlend.setup:return void(verticesArray.length=0);case MixBlend.first:if(1==alpha){verticesArray.length=0;break}var vertices_1=core.Utils.setArraySize(verticesArray,vertexCount);if(null==vertexAttachment.bones)for(var setupVertices=vertexAttachment.vertices,i=0;i<vertexCount;i++)vertices_1[i]+=(setupVertices[i]-vertices_1[i])*alpha;else{alpha=1-alpha;for(i=0;i<vertexCount;i++)vertices_1[i]*=alpha}}}else{var vertices=core.Utils.setArraySize(verticesArray,vertexCount);if(time>=frames[frames.length-1]){var lastVertices=frameVertices[frames.length-1];if(1==alpha)if(blend==MixBlend.add)if(null==(vertexAttachment=slotAttachment).bones)for(setupVertices=vertexAttachment.vertices,i=0;i<vertexCount;i++)vertices[i]+=lastVertices[i]-setupVertices[i];else for(i=0;i<vertexCount;i++)vertices[i]+=lastVertices[i];else core.Utils.arrayCopy(lastVertices,0,vertices,0,vertexCount);else switch(blend){case MixBlend.setup:var vertexAttachment_1=slotAttachment;if(null==vertexAttachment_1.bones)for(setupVertices=vertexAttachment_1.vertices,i=0;i<vertexCount;i++){var setup=setupVertices[i];vertices[i]=setup+(lastVertices[i]-setup)*alpha}else for(i=0;i<vertexCount;i++)vertices[i]=lastVertices[i]*alpha;break;case MixBlend.first:case MixBlend.replace:for(i=0;i<vertexCount;i++)vertices[i]+=(lastVertices[i]-vertices[i])*alpha;case MixBlend.add:if(null==(vertexAttachment=slotAttachment).bones)for(setupVertices=vertexAttachment.vertices,i=0;i<vertexCount;i++)vertices[i]+=(lastVertices[i]-setupVertices[i])*alpha;else for(i=0;i<vertexCount;i++)vertices[i]+=lastVertices[i]*alpha}}else{var frame=Animation.binarySearch(frames,time),prevVertices=frameVertices[frame-1],nextVertices=frameVertices[frame],frameTime=frames[frame],percent=this.getCurvePercent(frame-1,1-(time-frameTime)/(frames[frame-1]-frameTime));if(1==alpha)if(blend==MixBlend.add)if(null==(vertexAttachment=slotAttachment).bones)for(setupVertices=vertexAttachment.vertices,i=0;i<vertexCount;i++){var prev=prevVertices[i];vertices[i]+=prev+(nextVertices[i]-prev)*percent-setupVertices[i]}else for(i=0;i<vertexCount;i++){prev=prevVertices[i];vertices[i]+=prev+(nextVertices[i]-prev)*percent}else for(i=0;i<vertexCount;i++){prev=prevVertices[i];vertices[i]=prev+(nextVertices[i]-prev)*percent}else switch(blend){case MixBlend.setup:var vertexAttachment_2=slotAttachment;if(null==vertexAttachment_2.bones)for(setupVertices=vertexAttachment_2.vertices,i=0;i<vertexCount;i++){prev=prevVertices[i],setup=setupVertices[i];vertices[i]=setup+(prev+(nextVertices[i]-prev)*percent-setup)*alpha}else for(i=0;i<vertexCount;i++){prev=prevVertices[i];vertices[i]=(prev+(nextVertices[i]-prev)*percent)*alpha}break;case MixBlend.first:case MixBlend.replace:for(i=0;i<vertexCount;i++){prev=prevVertices[i];vertices[i]+=(prev+(nextVertices[i]-prev)*percent-vertices[i])*alpha}break;case MixBlend.add:if(null==(vertexAttachment=slotAttachment).bones)for(setupVertices=vertexAttachment.vertices,i=0;i<vertexCount;i++){prev=prevVertices[i];vertices[i]+=(prev+(nextVertices[i]-prev)*percent-setupVertices[i])*alpha}else for(i=0;i<vertexCount;i++){prev=prevVertices[i];vertices[i]+=(prev+(nextVertices[i]-prev)*percent)*alpha}}}}}},DeformTimeline}(CurveTimeline);core.DeformTimeline=DeformTimeline;var EventTimeline=function(){function EventTimeline(frameCount){this.frames=core.Utils.newFloatArray(frameCount),this.events=new Array(frameCount)}return EventTimeline.prototype.getPropertyId=function(){return TimelineType.event<<24},EventTimeline.prototype.getFrameCount=function(){return this.frames.length},EventTimeline.prototype.setFrame=function(frameIndex,event){this.frames[frameIndex]=event.time,this.events[frameIndex]=event},EventTimeline.prototype.apply=function(skeleton,lastTime,time,firedEvents,alpha,blend,direction){if(null!=firedEvents){var frames=this.frames,frameCount=this.frames.length;if(time<lastTime)this.apply(skeleton,lastTime,Number.MAX_VALUE,firedEvents,alpha,blend,direction),lastTime=-1;else if(lastTime>=frames[frameCount-1])return;if(!(time<frames[0])){var frame=0;if(lastTime<frames[0])frame=0;else for(var frameTime=frames[frame=Animation.binarySearch(frames,lastTime)];0<frame&&frames[frame-1]==frameTime;)frame--;for(;frame<frameCount&&time>=frames[frame];frame++)firedEvents.push(this.events[frame])}}},EventTimeline}();core.EventTimeline=EventTimeline;var DrawOrderTimeline=function(){function DrawOrderTimeline(frameCount){this.frames=core.Utils.newFloatArray(frameCount),this.drawOrders=new Array(frameCount)}return DrawOrderTimeline.prototype.getPropertyId=function(){return TimelineType.drawOrder<<24},DrawOrderTimeline.prototype.getFrameCount=function(){return this.frames.length},DrawOrderTimeline.prototype.setFrame=function(frameIndex,time,drawOrder){this.frames[frameIndex]=time,this.drawOrders[frameIndex]=drawOrder},DrawOrderTimeline.prototype.apply=function(skeleton,lastTime,time,firedEvents,alpha,blend,direction){var drawOrder=skeleton.drawOrder,slots=skeleton.slots;if(direction!=MixDirection.out||blend!=MixBlend.setup){var frames=this.frames;if(time<frames[0])blend!=MixBlend.setup&&blend!=MixBlend.first||core.Utils.arrayCopy(skeleton.slots,0,skeleton.drawOrder,0,skeleton.slots.length);else{var frame=0;frame=time>=frames[frames.length-1]?frames.length-1:Animation.binarySearch(frames,time)-1;var drawOrderToSetupIndex=this.drawOrders[frame];if(null==drawOrderToSetupIndex)core.Utils.arrayCopy(slots,0,drawOrder,0,slots.length);else for(var i=0,n=drawOrderToSetupIndex.length;i<n;i++)drawOrder[i]=slots[drawOrderToSetupIndex[i]]}}else core.Utils.arrayCopy(skeleton.slots,0,skeleton.drawOrder,0,skeleton.slots.length)},DrawOrderTimeline}();core.DrawOrderTimeline=DrawOrderTimeline;var IkConstraintTimeline=function(_super){function IkConstraintTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount*IkConstraintTimeline.ENTRIES),_this}return __extends(IkConstraintTimeline,_super),IkConstraintTimeline.prototype.getPropertyId=function(){return(TimelineType.ikConstraint<<24)+this.ikConstraintIndex},IkConstraintTimeline.prototype.setFrame=function(frameIndex,time,mix,bendDirection,compress,stretch){frameIndex*=IkConstraintTimeline.ENTRIES,this.frames[frameIndex]=time,this.frames[frameIndex+IkConstraintTimeline.MIX]=mix,this.frames[frameIndex+IkConstraintTimeline.BEND_DIRECTION]=bendDirection,this.frames[frameIndex+IkConstraintTimeline.COMPRESS]=compress?1:0,this.frames[frameIndex+IkConstraintTimeline.STRETCH]=stretch?1:0},IkConstraintTimeline.prototype.apply=function(skeleton,lastTime,time,firedEvents,alpha,blend,direction){var frames=this.frames,constraint=skeleton.ikConstraints[this.ikConstraintIndex];if(time<frames[0])switch(blend){case MixBlend.setup:return constraint.mix=constraint.data.mix,constraint.bendDirection=constraint.data.bendDirection,constraint.compress=constraint.data.compress,void(constraint.stretch=constraint.data.stretch);case MixBlend.first:constraint.mix+=(constraint.data.mix-constraint.mix)*alpha,constraint.bendDirection=constraint.data.bendDirection,constraint.compress=constraint.data.compress,constraint.stretch=constraint.data.stretch}else if(time>=frames[frames.length-IkConstraintTimeline.ENTRIES])blend==MixBlend.setup?(constraint.mix=constraint.data.mix+(frames[frames.length+IkConstraintTimeline.PREV_MIX]-constraint.data.mix)*alpha,direction==MixDirection.out?(constraint.bendDirection=constraint.data.bendDirection,constraint.compress=constraint.data.compress,constraint.stretch=constraint.data.stretch):(constraint.bendDirection=frames[frames.length+IkConstraintTimeline.PREV_BEND_DIRECTION],constraint.compress=0!=frames[frames.length+IkConstraintTimeline.PREV_COMPRESS],constraint.stretch=0!=frames[frames.length+IkConstraintTimeline.PREV_STRETCH])):(constraint.mix+=(frames[frames.length+IkConstraintTimeline.PREV_MIX]-constraint.mix)*alpha,direction==MixDirection.in&&(constraint.bendDirection=frames[frames.length+IkConstraintTimeline.PREV_BEND_DIRECTION],constraint.compress=0!=frames[frames.length+IkConstraintTimeline.PREV_COMPRESS],constraint.stretch=0!=frames[frames.length+IkConstraintTimeline.PREV_STRETCH]));else{var frame=Animation.binarySearch(frames,time,IkConstraintTimeline.ENTRIES),mix=frames[frame+IkConstraintTimeline.PREV_MIX],frameTime=frames[frame],percent=this.getCurvePercent(frame/IkConstraintTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+IkConstraintTimeline.PREV_TIME]-frameTime));blend==MixBlend.setup?(constraint.mix=constraint.data.mix+(mix+(frames[frame+IkConstraintTimeline.MIX]-mix)*percent-constraint.data.mix)*alpha,direction==MixDirection.out?(constraint.bendDirection=constraint.data.bendDirection,constraint.compress=constraint.data.compress,constraint.stretch=constraint.data.stretch):(constraint.bendDirection=frames[frame+IkConstraintTimeline.PREV_BEND_DIRECTION],constraint.compress=0!=frames[frame+IkConstraintTimeline.PREV_COMPRESS],constraint.stretch=0!=frames[frame+IkConstraintTimeline.PREV_STRETCH])):(constraint.mix+=(mix+(frames[frame+IkConstraintTimeline.MIX]-mix)*percent-constraint.mix)*alpha,direction==MixDirection.in&&(constraint.bendDirection=frames[frame+IkConstraintTimeline.PREV_BEND_DIRECTION],constraint.compress=0!=frames[frame+IkConstraintTimeline.PREV_COMPRESS],constraint.stretch=0!=frames[frame+IkConstraintTimeline.PREV_STRETCH]))}},IkConstraintTimeline.ENTRIES=5,IkConstraintTimeline.PREV_TIME=-5,IkConstraintTimeline.PREV_MIX=-4,IkConstraintTimeline.PREV_BEND_DIRECTION=-3,IkConstraintTimeline.PREV_COMPRESS=-2,IkConstraintTimeline.PREV_STRETCH=-1,IkConstraintTimeline.MIX=1,IkConstraintTimeline.BEND_DIRECTION=2,IkConstraintTimeline.COMPRESS=3,IkConstraintTimeline.STRETCH=4,IkConstraintTimeline}(CurveTimeline);core.IkConstraintTimeline=IkConstraintTimeline;var TransformConstraintTimeline=function(_super){function TransformConstraintTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount*TransformConstraintTimeline.ENTRIES),_this}return __extends(TransformConstraintTimeline,_super),TransformConstraintTimeline.prototype.getPropertyId=function(){return(TimelineType.transformConstraint<<24)+this.transformConstraintIndex},TransformConstraintTimeline.prototype.setFrame=function(frameIndex,time,rotateMix,translateMix,scaleMix,shearMix){frameIndex*=TransformConstraintTimeline.ENTRIES,this.frames[frameIndex]=time,this.frames[frameIndex+TransformConstraintTimeline.ROTATE]=rotateMix,this.frames[frameIndex+TransformConstraintTimeline.TRANSLATE]=translateMix,this.frames[frameIndex+TransformConstraintTimeline.SCALE]=scaleMix,this.frames[frameIndex+TransformConstraintTimeline.SHEAR]=shearMix},TransformConstraintTimeline.prototype.apply=function(skeleton,lastTime,time,firedEvents,alpha,blend,direction){var frames=this.frames,constraint=skeleton.transformConstraints[this.transformConstraintIndex];if(time<frames[0]){var data=constraint.data;switch(blend){case MixBlend.setup:return constraint.rotateMix=data.rotateMix,constraint.translateMix=data.translateMix,constraint.scaleMix=data.scaleMix,void(constraint.shearMix=data.shearMix);case MixBlend.first:constraint.rotateMix+=(data.rotateMix-constraint.rotateMix)*alpha,constraint.translateMix+=(data.translateMix-constraint.translateMix)*alpha,constraint.scaleMix+=(data.scaleMix-constraint.scaleMix)*alpha,constraint.shearMix+=(data.shearMix-constraint.shearMix)*alpha}}else{var rotate=0,translate=0,scale=0,shear=0;if(time>=frames[frames.length-TransformConstraintTimeline.ENTRIES]){var i=frames.length;rotate=frames[i+TransformConstraintTimeline.PREV_ROTATE],translate=frames[i+TransformConstraintTimeline.PREV_TRANSLATE],scale=frames[i+TransformConstraintTimeline.PREV_SCALE],shear=frames[i+TransformConstraintTimeline.PREV_SHEAR]}else{var frame=Animation.binarySearch(frames,time,TransformConstraintTimeline.ENTRIES);rotate=frames[frame+TransformConstraintTimeline.PREV_ROTATE],translate=frames[frame+TransformConstraintTimeline.PREV_TRANSLATE],scale=frames[frame+TransformConstraintTimeline.PREV_SCALE],shear=frames[frame+TransformConstraintTimeline.PREV_SHEAR];var frameTime=frames[frame],percent=this.getCurvePercent(frame/TransformConstraintTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+TransformConstraintTimeline.PREV_TIME]-frameTime));rotate+=(frames[frame+TransformConstraintTimeline.ROTATE]-rotate)*percent,translate+=(frames[frame+TransformConstraintTimeline.TRANSLATE]-translate)*percent,scale+=(frames[frame+TransformConstraintTimeline.SCALE]-scale)*percent,shear+=(frames[frame+TransformConstraintTimeline.SHEAR]-shear)*percent}if(blend==MixBlend.setup){data=constraint.data;constraint.rotateMix=data.rotateMix+(rotate-data.rotateMix)*alpha,constraint.translateMix=data.translateMix+(translate-data.translateMix)*alpha,constraint.scaleMix=data.scaleMix+(scale-data.scaleMix)*alpha,constraint.shearMix=data.shearMix+(shear-data.shearMix)*alpha}else constraint.rotateMix+=(rotate-constraint.rotateMix)*alpha,constraint.translateMix+=(translate-constraint.translateMix)*alpha,constraint.scaleMix+=(scale-constraint.scaleMix)*alpha,constraint.shearMix+=(shear-constraint.shearMix)*alpha}},TransformConstraintTimeline.ENTRIES=5,TransformConstraintTimeline.PREV_TIME=-5,TransformConstraintTimeline.PREV_ROTATE=-4,TransformConstraintTimeline.PREV_TRANSLATE=-3,TransformConstraintTimeline.PREV_SCALE=-2,TransformConstraintTimeline.PREV_SHEAR=-1,TransformConstraintTimeline.ROTATE=1,TransformConstraintTimeline.TRANSLATE=2,TransformConstraintTimeline.SCALE=3,TransformConstraintTimeline.SHEAR=4,TransformConstraintTimeline}(CurveTimeline);core.TransformConstraintTimeline=TransformConstraintTimeline;var PathConstraintPositionTimeline=function(_super){function PathConstraintPositionTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount*PathConstraintPositionTimeline.ENTRIES),_this}return __extends(PathConstraintPositionTimeline,_super),PathConstraintPositionTimeline.prototype.getPropertyId=function(){return(TimelineType.pathConstraintPosition<<24)+this.pathConstraintIndex},PathConstraintPositionTimeline.prototype.setFrame=function(frameIndex,time,value){frameIndex*=PathConstraintPositionTimeline.ENTRIES,this.frames[frameIndex]=time,this.frames[frameIndex+PathConstraintPositionTimeline.VALUE]=value},PathConstraintPositionTimeline.prototype.apply=function(skeleton,lastTime,time,firedEvents,alpha,blend,direction){var frames=this.frames,constraint=skeleton.pathConstraints[this.pathConstraintIndex];if(time<frames[0])switch(blend){case MixBlend.setup:return void(constraint.position=constraint.data.position);case MixBlend.first:constraint.position+=(constraint.data.position-constraint.position)*alpha}else{var position=0;if(time>=frames[frames.length-PathConstraintPositionTimeline.ENTRIES])position=frames[frames.length+PathConstraintPositionTimeline.PREV_VALUE];else{var frame=Animation.binarySearch(frames,time,PathConstraintPositionTimeline.ENTRIES);position=frames[frame+PathConstraintPositionTimeline.PREV_VALUE];var frameTime=frames[frame],percent=this.getCurvePercent(frame/PathConstraintPositionTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+PathConstraintPositionTimeline.PREV_TIME]-frameTime));position+=(frames[frame+PathConstraintPositionTimeline.VALUE]-position)*percent}blend==MixBlend.setup?constraint.position=constraint.data.position+(position-constraint.data.position)*alpha:constraint.position+=(position-constraint.position)*alpha}},PathConstraintPositionTimeline.ENTRIES=2,PathConstraintPositionTimeline.PREV_TIME=-2,PathConstraintPositionTimeline.PREV_VALUE=-1,PathConstraintPositionTimeline.VALUE=1,PathConstraintPositionTimeline}(CurveTimeline),PathConstraintSpacingTimeline=function(_super){function PathConstraintSpacingTimeline(frameCount){return _super.call(this,frameCount)||this}return __extends(PathConstraintSpacingTimeline,_super),PathConstraintSpacingTimeline.prototype.getPropertyId=function(){return(TimelineType.pathConstraintSpacing<<24)+this.pathConstraintIndex},PathConstraintSpacingTimeline.prototype.apply=function(skeleton,lastTime,time,firedEvents,alpha,blend,direction){var frames=this.frames,constraint=skeleton.pathConstraints[this.pathConstraintIndex];if(time<frames[0])switch(blend){case MixBlend.setup:return void(constraint.spacing=constraint.data.spacing);case MixBlend.first:constraint.spacing+=(constraint.data.spacing-constraint.spacing)*alpha}else{var spacing=0;if(time>=frames[frames.length-PathConstraintSpacingTimeline.ENTRIES])spacing=frames[frames.length+PathConstraintSpacingTimeline.PREV_VALUE];else{var frame=Animation.binarySearch(frames,time,PathConstraintSpacingTimeline.ENTRIES);spacing=frames[frame+PathConstraintSpacingTimeline.PREV_VALUE];var frameTime=frames[frame],percent=this.getCurvePercent(frame/PathConstraintSpacingTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+PathConstraintSpacingTimeline.PREV_TIME]-frameTime));spacing+=(frames[frame+PathConstraintSpacingTimeline.VALUE]-spacing)*percent}blend==MixBlend.setup?constraint.spacing=constraint.data.spacing+(spacing-constraint.data.spacing)*alpha:constraint.spacing+=(spacing-constraint.spacing)*alpha}},PathConstraintSpacingTimeline}(core.PathConstraintPositionTimeline=PathConstraintPositionTimeline);core.PathConstraintSpacingTimeline=PathConstraintSpacingTimeline;var PathConstraintMixTimeline=function(_super){function PathConstraintMixTimeline(frameCount){var _this=_super.call(this,frameCount)||this;return _this.frames=core.Utils.newFloatArray(frameCount*PathConstraintMixTimeline.ENTRIES),_this}return __extends(PathConstraintMixTimeline,_super),PathConstraintMixTimeline.prototype.getPropertyId=function(){return(TimelineType.pathConstraintMix<<24)+this.pathConstraintIndex},PathConstraintMixTimeline.prototype.setFrame=function(frameIndex,time,rotateMix,translateMix){frameIndex*=PathConstraintMixTimeline.ENTRIES,this.frames[frameIndex]=time,this.frames[frameIndex+PathConstraintMixTimeline.ROTATE]=rotateMix,this.frames[frameIndex+PathConstraintMixTimeline.TRANSLATE]=translateMix},PathConstraintMixTimeline.prototype.apply=function(skeleton,lastTime,time,firedEvents,alpha,blend,direction){var frames=this.frames,constraint=skeleton.pathConstraints[this.pathConstraintIndex];if(time<frames[0])switch(blend){case MixBlend.setup:return constraint.rotateMix=constraint.data.rotateMix,void(constraint.translateMix=constraint.data.translateMix);case MixBlend.first:constraint.rotateMix+=(constraint.data.rotateMix-constraint.rotateMix)*alpha,constraint.translateMix+=(constraint.data.translateMix-constraint.translateMix)*alpha}else{var rotate=0,translate=0;if(time>=frames[frames.length-PathConstraintMixTimeline.ENTRIES])rotate=frames[frames.length+PathConstraintMixTimeline.PREV_ROTATE],translate=frames[frames.length+PathConstraintMixTimeline.PREV_TRANSLATE];else{var frame=Animation.binarySearch(frames,time,PathConstraintMixTimeline.ENTRIES);rotate=frames[frame+PathConstraintMixTimeline.PREV_ROTATE],translate=frames[frame+PathConstraintMixTimeline.PREV_TRANSLATE];var frameTime=frames[frame],percent=this.getCurvePercent(frame/PathConstraintMixTimeline.ENTRIES-1,1-(time-frameTime)/(frames[frame+PathConstraintMixTimeline.PREV_TIME]-frameTime));rotate+=(frames[frame+PathConstraintMixTimeline.ROTATE]-rotate)*percent,translate+=(frames[frame+PathConstraintMixTimeline.TRANSLATE]-translate)*percent}blend==MixBlend.setup?(constraint.rotateMix=constraint.data.rotateMix+(rotate-constraint.data.rotateMix)*alpha,constraint.translateMix=constraint.data.translateMix+(translate-constraint.data.translateMix)*alpha):(constraint.rotateMix+=(rotate-constraint.rotateMix)*alpha,constraint.translateMix+=(translate-constraint.translateMix)*alpha)}},PathConstraintMixTimeline.ENTRIES=3,PathConstraintMixTimeline.PREV_TIME=-3,PathConstraintMixTimeline.PREV_ROTATE=-2,PathConstraintMixTimeline.PREV_TRANSLATE=-1,PathConstraintMixTimeline.ROTATE=1,PathConstraintMixTimeline.TRANSLATE=2,PathConstraintMixTimeline}(CurveTimeline);core.PathConstraintMixTimeline=PathConstraintMixTimeline}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var AnimationState=function(){function AnimationState(data){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new EventQueue(this),this.propertyIDs=new core.IntSet,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new core.Pool(function(){return new TrackEntry}),this.data=data}return AnimationState.prototype.update=function(delta){delta*=this.timeScale;for(var tracks=this.tracks,i=0,n=tracks.length;i<n;i++){var current=tracks[i];if(null!=current){current.animationLast=current.nextAnimationLast,current.trackLast=current.nextTrackLast;var currentDelta=delta*current.timeScale;if(0<current.delay){if(current.delay-=currentDelta,0<current.delay)continue;currentDelta=-current.delay,current.delay=0}var next=current.next;if(null!=next){var nextTime=current.trackLast-next.delay;if(0<=nextTime){for(next.delay=0,next.trackTime=0==current.timeScale?0:(nextTime/current.timeScale+delta)*next.timeScale,current.trackTime+=currentDelta,this.setCurrent(i,next,!0);null!=next.mixingFrom;)next.mixTime+=delta,next=next.mixingFrom;continue}}else if(current.trackLast>=current.trackEnd&&null==current.mixingFrom){tracks[i]=null,this.queue.end(current),this.disposeNext(current);continue}if(null!=current.mixingFrom&&this.updateMixingFrom(current,delta)){var from=current.mixingFrom;for((current.mixingFrom=null)!=from&&(from.mixingTo=null);null!=from;)this.queue.end(from),from=from.mixingFrom}current.trackTime+=currentDelta}}this.queue.drain()},AnimationState.prototype.updateMixingFrom=function(to,delta){var from=to.mixingFrom;if(null==from)return!0;var finished=this.updateMixingFrom(from,delta);return from.animationLast=from.nextAnimationLast,from.trackLast=from.nextTrackLast,0<to.mixTime&&to.mixTime>=to.mixDuration?(0!=from.totalAlpha&&0!=to.mixDuration||(to.mixingFrom=from.mixingFrom,null!=from.mixingFrom&&(from.mixingFrom.mixingTo=to),to.interruptAlpha=from.interruptAlpha,this.queue.end(from)),finished):(from.trackTime+=delta*from.timeScale,to.mixTime+=delta,!1)},AnimationState.prototype.apply=function(skeleton){if(null==skeleton)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var events=this.events,tracks=this.tracks,applied=!1,i=0,n=tracks.length;i<n;i++){var current=tracks[i];if(!(null==current||0<current.delay)){applied=!0;var blend=0==i?core.MixBlend.first:current.mixBlend,mix=current.alpha;null!=current.mixingFrom?mix*=this.applyMixingFrom(current,skeleton,blend):current.trackTime>=current.trackEnd&&null==current.next&&(mix=0);var animationLast=current.animationLast,animationTime=current.getAnimationTime(),timelineCount=current.animation.timelines.length,timelines=current.animation.timelines;if(0!=i||1!=mix&&blend!=core.MixBlend.add){var timelineMode=current.timelineMode,firstFrame=0==current.timelinesRotation.length;firstFrame&&core.Utils.setArraySize(current.timelinesRotation,timelineCount<<1,null);var timelinesRotation=current.timelinesRotation;for(ii=0;ii<timelineCount;ii++){var timeline=timelines[ii],timelineBlend=timelineMode[ii]==AnimationState.SUBSEQUENT?blend:core.MixBlend.setup;timeline instanceof core.RotateTimeline?this.applyRotateTimeline(timeline,skeleton,animationTime,mix,timelineBlend,timelinesRotation,ii<<1,firstFrame):(core.Utils.webkit602BugfixHelper(mix,blend),timeline.apply(skeleton,animationLast,animationTime,events,mix,timelineBlend,core.MixDirection.in))}}else for(var ii=0;ii<timelineCount;ii++)timelines[ii].apply(skeleton,animationLast,animationTime,events,mix,blend,core.MixDirection.in);this.queueEvents(current,animationTime),events.length=0,current.nextAnimationLast=animationTime,current.nextTrackLast=current.trackTime}}return this.queue.drain(),applied},AnimationState.prototype.applyMixingFrom=function(to,skeleton,blend){var from=to.mixingFrom;null!=from.mixingFrom&&this.applyMixingFrom(from,skeleton,blend);var mix=0;0==to.mixDuration?(mix=1,blend==core.MixBlend.first&&(blend=core.MixBlend.setup)):(1<(mix=to.mixTime/to.mixDuration)&&(mix=1),blend!=core.MixBlend.first&&(blend=from.mixBlend));var events=mix<from.eventThreshold?this.events:null,attachments=mix<from.attachmentThreshold,drawOrder=mix<from.drawOrderThreshold,animationLast=from.animationLast,animationTime=from.getAnimationTime(),timelineCount=from.animation.timelines.length,timelines=from.animation.timelines,alphaHold=from.alpha*to.interruptAlpha,alphaMix=alphaHold*(1-mix);if(blend==core.MixBlend.add)for(var i=0;i<timelineCount;i++)timelines[i].apply(skeleton,animationLast,animationTime,events,alphaMix,blend,core.MixDirection.out);else{var timelineMode=from.timelineMode,timelineHoldMix=from.timelineHoldMix,firstFrame=0==from.timelinesRotation.length;firstFrame&&core.Utils.setArraySize(from.timelinesRotation,timelineCount<<1,null);var timelinesRotation=from.timelinesRotation;for(i=from.totalAlpha=0;i<timelineCount;i++){var timeline=timelines[i],direction=core.MixDirection.out,timelineBlend=void 0,alpha=0;switch(timelineMode[i]){case AnimationState.SUBSEQUENT:if(!attachments&&timeline instanceof core.AttachmentTimeline)continue;if(!drawOrder&&timeline instanceof core.DrawOrderTimeline)continue;timelineBlend=blend,alpha=alphaMix;break;case AnimationState.FIRST:timelineBlend=core.MixBlend.setup,alpha=alphaMix;break;case AnimationState.HOLD:timelineBlend=core.MixBlend.setup,alpha=alphaHold;break;default:timelineBlend=core.MixBlend.setup;var holdMix=timelineHoldMix[i];alpha=alphaHold*Math.max(0,1-holdMix.mixTime/holdMix.mixDuration)}from.totalAlpha+=alpha,timeline instanceof core.RotateTimeline?this.applyRotateTimeline(timeline,skeleton,animationTime,alpha,timelineBlend,timelinesRotation,i<<1,firstFrame):(core.Utils.webkit602BugfixHelper(alpha,blend),timelineBlend==core.MixBlend.setup&&(timeline instanceof core.AttachmentTimeline?attachments&&(direction=core.MixDirection.out):timeline instanceof core.DrawOrderTimeline&&drawOrder&&(direction=core.MixDirection.out)),timeline.apply(skeleton,animationLast,animationTime,events,alpha,timelineBlend,direction))}}return 0<to.mixDuration&&this.queueEvents(from,animationTime),this.events.length=0,from.nextAnimationLast=animationTime,from.nextTrackLast=from.trackTime,mix},AnimationState.prototype.applyRotateTimeline=function(timeline,skeleton,time,alpha,blend,timelinesRotation,i,firstFrame){if(firstFrame&&(timelinesRotation[i]=0),1!=alpha){var rotateTimeline=timeline,frames=rotateTimeline.frames,bone=skeleton.bones[rotateTimeline.boneIndex],r1=0,r2=0;if(time<frames[0])switch(blend){case core.MixBlend.setup:bone.rotation=bone.data.rotation;default:return;case core.MixBlend.first:r1=bone.rotation,r2=bone.data.rotation}else if(r1=blend==core.MixBlend.setup?bone.data.rotation:bone.rotation,time>=frames[frames.length-core.RotateTimeline.ENTRIES])r2=bone.data.rotation+frames[frames.length+core.RotateTimeline.PREV_ROTATION];else{var frame=core.Animation.binarySearch(frames,time,core.RotateTimeline.ENTRIES),prevRotation=frames[frame+core.RotateTimeline.PREV_ROTATION],frameTime=frames[frame],percent=rotateTimeline.getCurvePercent((frame>>1)-1,1-(time-frameTime)/(frames[frame+core.RotateTimeline.PREV_TIME]-frameTime));r2=frames[frame+core.RotateTimeline.ROTATION]-prevRotation,r2=prevRotation+(r2-=360*(16384-(16384.499999999996-r2/360|0)))*percent+bone.data.rotation,r2-=360*(16384-(16384.499999999996-r2/360|0))}var total=0,diff=r2-r1;if(0==(diff-=360*(16384-(16384.499999999996-diff/360|0))))total=timelinesRotation[i];else{var lastTotal=0,lastDiff=0;lastDiff=firstFrame?(lastTotal=0,diff):(lastTotal=timelinesRotation[i],timelinesRotation[i+1]);var current=0<diff,dir=0<=lastTotal;core.MathUtils.signum(lastDiff)!=core.MathUtils.signum(diff)&&Math.abs(lastDiff)<=90&&(180<Math.abs(lastTotal)&&(lastTotal+=360*core.MathUtils.signum(lastTotal)),dir=current),total=diff+lastTotal-lastTotal%360,dir!=current&&(total+=360*core.MathUtils.signum(lastTotal)),timelinesRotation[i]=total}timelinesRotation[i+1]=diff,r1+=total*alpha,bone.rotation=r1-360*(16384-(16384.499999999996-r1/360|0))}else timeline.apply(skeleton,0,time,null,1,blend,core.MixDirection.in)},AnimationState.prototype.queueEvents=function(entry,animationTime){for(var animationStart=entry.animationStart,animationEnd=entry.animationEnd,duration=animationEnd-animationStart,trackLastWrapped=entry.trackLast%duration,events=this.events,i=0,n=events.length;i<n;i++){var event_1=events[i];if(event_1.time<trackLastWrapped)break;event_1.time>animationEnd||this.queue.event(entry,event_1)}for((entry.loop?0==duration||trackLastWrapped>entry.trackTime%duration:animationEnd<=animationTime&&entry.animationLast<animationEnd)&&this.queue.complete(entry);i<n;i++){events[i].time<animationStart||this.queue.event(entry,events[i])}},AnimationState.prototype.clearTracks=function(){var oldDrainDisabled=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var i=0,n=this.tracks.length;i<n;i++)this.clearTrack(i);this.tracks.length=0,this.queue.drainDisabled=oldDrainDisabled,this.queue.drain()},AnimationState.prototype.clearTrack=function(trackIndex){if(!(trackIndex>=this.tracks.length)){var current=this.tracks[trackIndex];if(null!=current){this.queue.end(current),this.disposeNext(current);for(var entry=current;;){var from=entry.mixingFrom;if(null==from)break;this.queue.end(from),entry.mixingFrom=null,entry.mixingTo=null,entry=from}this.tracks[current.trackIndex]=null,this.queue.drain()}}},AnimationState.prototype.setCurrent=function(index,current,interrupt){var from=this.expandToIndex(index);this.tracks[index]=current,null!=from&&(interrupt&&this.queue.interrupt(from),((current.mixingFrom=from).mixingTo=current).mixTime=0,null!=from.mixingFrom&&0<from.mixDuration&&(current.interruptAlpha*=Math.min(1,from.mixTime/from.mixDuration)),from.timelinesRotation.length=0),this.queue.start(current)},AnimationState.prototype.setAnimation=function(trackIndex,animationName,loop){var animation=this.data.skeletonData.findAnimation(animationName);if(null==animation)throw new Error("Animation not found: "+animationName);return this.setAnimationWith(trackIndex,animation,loop)},AnimationState.prototype.setAnimationWith=function(trackIndex,animation,loop){if(null==animation)throw new Error("animation cannot be null.");var interrupt=!0,current=this.expandToIndex(trackIndex);null!=current&&(-1==current.nextTrackLast?(this.tracks[trackIndex]=current.mixingFrom,this.queue.interrupt(current),this.queue.end(current),this.disposeNext(current),current=current.mixingFrom,interrupt=!1):this.disposeNext(current));var entry=this.trackEntry(trackIndex,animation,loop,current);return this.setCurrent(trackIndex,entry,interrupt),this.queue.drain(),entry},AnimationState.prototype.addAnimation=function(trackIndex,animationName,loop,delay){var animation=this.data.skeletonData.findAnimation(animationName);if(null==animation)throw new Error("Animation not found: "+animationName);return this.addAnimationWith(trackIndex,animation,loop,delay)},AnimationState.prototype.addAnimationWith=function(trackIndex,animation,loop,delay){if(null==animation)throw new Error("animation cannot be null.");var last=this.expandToIndex(trackIndex);if(null!=last)for(;null!=last.next;)last=last.next;var entry=this.trackEntry(trackIndex,animation,loop,last);if(null==last)this.setCurrent(trackIndex,entry,!0),this.queue.drain();else if(last.next=entry,delay<=0){var duration=last.animationEnd-last.animationStart;0!=duration?(last.loop?delay+=duration*(1+(last.trackTime/duration|0)):delay+=Math.max(duration,last.trackTime),delay-=this.data.getMix(last.animation,animation)):delay=last.trackTime}return entry.delay=delay,entry},AnimationState.prototype.setEmptyAnimation=function(trackIndex,mixDuration){var entry=this.setAnimationWith(trackIndex,AnimationState.emptyAnimation,!1);return entry.mixDuration=mixDuration,entry.trackEnd=mixDuration,entry},AnimationState.prototype.addEmptyAnimation=function(trackIndex,mixDuration,delay){delay<=0&&(delay-=mixDuration);var entry=this.addAnimationWith(trackIndex,AnimationState.emptyAnimation,!1,delay);return entry.mixDuration=mixDuration,entry.trackEnd=mixDuration,entry},AnimationState.prototype.setEmptyAnimations=function(mixDuration){var oldDrainDisabled=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var i=0,n=this.tracks.length;i<n;i++){var current=this.tracks[i];null!=current&&this.setEmptyAnimation(current.trackIndex,mixDuration)}this.queue.drainDisabled=oldDrainDisabled,this.queue.drain()},AnimationState.prototype.expandToIndex=function(index){return index<this.tracks.length?this.tracks[index]:(core.Utils.ensureArrayCapacity(this.tracks,index-this.tracks.length+1,null),this.tracks.length=index+1,null)},AnimationState.prototype.trackEntry=function(trackIndex,animation,loop,last){var entry=this.trackEntryPool.obtain();return entry.trackIndex=trackIndex,entry.animation=animation,entry.loop=loop,entry.holdPrevious=!1,entry.eventThreshold=0,entry.attachmentThreshold=0,entry.drawOrderThreshold=0,entry.animationStart=0,entry.animationEnd=animation.duration,entry.animationLast=-1,entry.nextAnimationLast=-1,entry.delay=0,entry.trackTime=0,entry.trackLast=-1,entry.nextTrackLast=-1,entry.trackEnd=Number.MAX_VALUE,entry.timeScale=1,entry.alpha=1,entry.interruptAlpha=1,entry.mixTime=0,entry.mixDuration=null==last?0:this.data.getMix(last.animation,animation),entry},AnimationState.prototype.disposeNext=function(entry){for(var next=entry.next;null!=next;)this.queue.dispose(next),next=next.next;entry.next=null},AnimationState.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var i=0,n=this.tracks.length;i<n;i++){var entry=this.tracks[i];if(null!=entry){for(;null!=entry.mixingFrom;)entry=entry.mixingFrom;for(;null!=entry.mixingFrom&&entry.mixBlend==core.MixBlend.add||this.setTimelineModes(entry),null!=(entry=entry.mixingTo););}}},AnimationState.prototype.setTimelineModes=function(entry){var to=entry.mixingTo,timelines=entry.animation.timelines,timelinesCount=entry.animation.timelines.length,timelineMode=core.Utils.setArraySize(entry.timelineMode,timelinesCount);entry.timelineHoldMix.length=0;var timelineDipMix=core.Utils.setArraySize(entry.timelineHoldMix,timelinesCount),propertyIDs=this.propertyIDs;if(null!=to&&to.holdPrevious)for(var i=0;i<timelinesCount;i++)propertyIDs.add(timelines[i].getPropertyId()),timelineMode[i]=AnimationState.HOLD;else outer:for(i=0;i<timelinesCount;i++){var id=timelines[i].getPropertyId();if(propertyIDs.add(id))if(null!=to&&this.hasTimeline(to,id)){for(var next=to.mixingTo;null!=next;next=next.mixingTo)if(!this.hasTimeline(next,id)){if(0<entry.mixDuration){timelineMode[i]=AnimationState.HOLD_MIX,timelineDipMix[i]=next;continue outer}break}timelineMode[i]=AnimationState.HOLD}else timelineMode[i]=AnimationState.FIRST;else timelineMode[i]=AnimationState.SUBSEQUENT}},AnimationState.prototype.hasTimeline=function(entry,id){for(var timelines=entry.animation.timelines,i=0,n=timelines.length;i<n;i++)if(timelines[i].getPropertyId()==id)return!0;return!1},AnimationState.prototype.getCurrent=function(trackIndex){return trackIndex>=this.tracks.length?null:this.tracks[trackIndex]},AnimationState.prototype.addListener=function(listener){if(null==listener)throw new Error("listener cannot be null.");this.listeners.push(listener)},AnimationState.prototype.removeListener=function(listener){var index=this.listeners.indexOf(listener);0<=index&&this.listeners.splice(index,1)},AnimationState.prototype.clearListeners=function(){this.listeners.length=0},AnimationState.prototype.clearListenerNotifications=function(){this.queue.clear()},AnimationState.prototype.setAnimationByName=function(trackIndex,animationName,loop){AnimationState.deprecatedWarning1||(AnimationState.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(trackIndex,animationName,loop)},AnimationState.prototype.addAnimationByName=function(trackIndex,animationName,loop,delay){AnimationState.deprecatedWarning2||(AnimationState.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(trackIndex,animationName,loop,delay)},AnimationState.prototype.hasAnimation=function(animationName){return null!==this.data.skeletonData.findAnimation(animationName)},AnimationState.prototype.hasAnimationByName=function(animationName){return AnimationState.deprecatedWarning3||(AnimationState.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(animationName)},AnimationState.emptyAnimation=new core.Animation("<empty>",[],0),AnimationState.SUBSEQUENT=0,AnimationState.FIRST=1,AnimationState.HOLD=2,AnimationState.HOLD_MIX=3,AnimationState.deprecatedWarning1=!1,AnimationState.deprecatedWarning2=!1,AnimationState.deprecatedWarning3=!1,AnimationState}();core.AnimationState=AnimationState;var TrackEntry=function(){function TrackEntry(){this.mixBlend=core.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return TrackEntry.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},TrackEntry.prototype.getAnimationTime=function(){if(this.loop){var duration=this.animationEnd-this.animationStart;return 0==duration?this.animationStart:this.trackTime%duration+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},TrackEntry.prototype.setAnimationLast=function(animationLast){this.animationLast=animationLast,this.nextAnimationLast=animationLast},TrackEntry.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},TrackEntry.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},Object.defineProperty(TrackEntry.prototype,"time",{get:function(){return TrackEntry.deprecatedWarning1||(TrackEntry.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime},set:function(value){TrackEntry.deprecatedWarning1||(TrackEntry.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=value},enumerable:!0,configurable:!0}),Object.defineProperty(TrackEntry.prototype,"endTime",{get:function(){return TrackEntry.deprecatedWarning2||(TrackEntry.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime},set:function(value){TrackEntry.deprecatedWarning2||(TrackEntry.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=value},enumerable:!0,configurable:!0}),TrackEntry.prototype.loopsCount=function(){return Math.floor(this.trackTime/this.trackEnd)},TrackEntry.deprecatedWarning1=!1,TrackEntry.deprecatedWarning2=!1,TrackEntry}();core.TrackEntry=TrackEntry;var EventType,EventQueue=function(){function EventQueue(animState){this.objects=[],this.drainDisabled=!1,this.animState=animState}return EventQueue.prototype.start=function(entry){this.objects.push(EventType.start),this.objects.push(entry),this.animState.animationsChanged=!0},EventQueue.prototype.interrupt=function(entry){this.objects.push(EventType.interrupt),this.objects.push(entry)},EventQueue.prototype.end=function(entry){this.objects.push(EventType.end),this.objects.push(entry),this.animState.animationsChanged=!0},EventQueue.prototype.dispose=function(entry){this.objects.push(EventType.dispose),this.objects.push(entry)},EventQueue.prototype.complete=function(entry){this.objects.push(EventType.complete),this.objects.push(entry)},EventQueue.prototype.event=function(entry,event){this.objects.push(EventType.event),this.objects.push(entry),this.objects.push(event)},EventQueue.prototype.deprecateStuff=function(){return EventQueue.deprecatedWarning1||(EventQueue.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0},EventQueue.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var objects=this.objects,listeners=this.animState.listeners,i=0;i<objects.length;i+=2){var type=objects[i],entry=objects[i+1];switch(type){case EventType.start:null!=entry.listener&&entry.listener.start&&entry.listener.start(entry);for(var ii=0;ii<listeners.length;ii++)listeners[ii].start&&listeners[ii].start(entry);entry.onStart&&this.deprecateStuff()&&entry.onStart(entry.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(entry.trackIndex);break;case EventType.interrupt:null!=entry.listener&&entry.listener.interrupt&&entry.listener.interrupt(entry);for(ii=0;ii<listeners.length;ii++)listeners[ii].interrupt&&listeners[ii].interrupt(entry);break;case EventType.end:null!=entry.listener&&entry.listener.end&&entry.listener.end(entry);for(ii=0;ii<listeners.length;ii++)listeners[ii].end&&listeners[ii].end(entry);entry.onEnd&&this.deprecateStuff()&&entry.onEnd(entry.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(entry.trackIndex);case EventType.dispose:null!=entry.listener&&entry.listener.dispose&&entry.listener.dispose(entry);for(ii=0;ii<listeners.length;ii++)listeners[ii].dispose&&listeners[ii].dispose(entry);this.animState.trackEntryPool.free(entry);break;case EventType.complete:null!=entry.listener&&entry.listener.complete&&entry.listener.complete(entry);for(ii=0;ii<listeners.length;ii++)listeners[ii].complete&&listeners[ii].complete(entry);var count=core.MathUtils.toInt(entry.loopsCount());entry.onComplete&&this.deprecateStuff()&&entry.onComplete(entry.trackIndex,count),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(entry.trackIndex,count);break;case EventType.event:var event_3=objects[2+i++];null!=entry.listener&&entry.listener.event&&entry.listener.event(entry,event_3);for(ii=0;ii<listeners.length;ii++)listeners[ii].event&&listeners[ii].event(entry,event_3);entry.onEvent&&this.deprecateStuff()&&entry.onEvent(entry.trackIndex,event_3),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(entry.trackIndex,event_3)}}this.clear(),this.drainDisabled=!1}},EventQueue.prototype.clear=function(){this.objects.length=0},EventQueue.deprecatedWarning1=!1,EventQueue}();core.EventQueue=EventQueue,function(EventType){EventType[EventType.start=0]="start",EventType[EventType.interrupt=1]="interrupt",EventType[EventType.end=2]="end",EventType[EventType.dispose=3]="dispose",EventType[EventType.complete=4]="complete",EventType[EventType.event=5]="event"}(EventType=core.EventType||(core.EventType={}));var AnimationStateAdapter2=function(){function AnimationStateAdapter2(){}return AnimationStateAdapter2.prototype.start=function(entry){},AnimationStateAdapter2.prototype.interrupt=function(entry){},AnimationStateAdapter2.prototype.end=function(entry){},AnimationStateAdapter2.prototype.dispose=function(entry){},AnimationStateAdapter2.prototype.complete=function(entry){},AnimationStateAdapter2.prototype.event=function(entry,event){},AnimationStateAdapter2}();core.AnimationStateAdapter2=AnimationStateAdapter2}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var AnimationStateData=function(){function AnimationStateData(skeletonData){if(this.animationToMixTime={},this.defaultMix=0,null==skeletonData)throw new Error("skeletonData cannot be null.");this.skeletonData=skeletonData}return AnimationStateData.prototype.setMix=function(fromName,toName,duration){var from=this.skeletonData.findAnimation(fromName);if(null==from)throw new Error("Animation not found: "+fromName);var to=this.skeletonData.findAnimation(toName);if(null==to)throw new Error("Animation not found: "+toName);this.setMixWith(from,to,duration)},AnimationStateData.prototype.setMixByName=function(fromName,toName,duration){AnimationStateData.deprecatedWarning1||(AnimationStateData.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(fromName,toName,duration)},AnimationStateData.prototype.setMixWith=function(from,to,duration){if(null==from)throw new Error("from cannot be null.");if(null==to)throw new Error("to cannot be null.");var key=from.name+"."+to.name;this.animationToMixTime[key]=duration},AnimationStateData.prototype.getMix=function(from,to){var key=from.name+"."+to.name,value=this.animationToMixTime[key];return void 0===value?this.defaultMix:value},AnimationStateData.deprecatedWarning1=!1,AnimationStateData}();core.AnimationStateData=AnimationStateData}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var AtlasAttachmentLoader=function(){function AtlasAttachmentLoader(atlas){this.atlas=atlas}return AtlasAttachmentLoader.prototype.newRegionAttachment=function(skin,name,path){var region=this.atlas.findRegion(path);if(null==region)throw new Error("Region not found in atlas: "+path+" (region attachment: "+name+")");var attachment=new core.RegionAttachment(name);return attachment.region=region,attachment},AtlasAttachmentLoader.prototype.newMeshAttachment=function(skin,name,path){var region=this.atlas.findRegion(path);if(null==region)throw new Error("Region not found in atlas: "+path+" (mesh attachment: "+name+")");var attachment=new core.MeshAttachment(name);return attachment.region=region,attachment},AtlasAttachmentLoader.prototype.newBoundingBoxAttachment=function(skin,name){return new core.BoundingBoxAttachment(name)},AtlasAttachmentLoader.prototype.newPathAttachment=function(skin,name){return new core.PathAttachment(name)},AtlasAttachmentLoader.prototype.newPointAttachment=function(skin,name){return new core.PointAttachment(name)},AtlasAttachmentLoader.prototype.newClippingAttachment=function(skin,name){return new core.ClippingAttachment(name)},AtlasAttachmentLoader}();core.AtlasAttachmentLoader=AtlasAttachmentLoader}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){!function(BlendMode){BlendMode[BlendMode.Normal=0]="Normal",BlendMode[BlendMode.Additive=1]="Additive",BlendMode[BlendMode.Multiply=2]="Multiply",BlendMode[BlendMode.Screen=3]="Screen"}(core.BlendMode||(core.BlendMode={}))}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var Bone=function(){function Bone(data,skeleton,parent){if(this.matrix=new PIXI.Matrix,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,null==data)throw new Error("data cannot be null.");if(null==skeleton)throw new Error("skeleton cannot be null.");this.data=data,this.skeleton=skeleton,this.parent=parent,this.setToSetupPose()}return Object.defineProperty(Bone.prototype,"worldX",{get:function(){return this.matrix.tx},enumerable:!0,configurable:!0}),Object.defineProperty(Bone.prototype,"worldY",{get:function(){return this.matrix.ty},enumerable:!0,configurable:!0}),Bone.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},Bone.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},Bone.prototype.updateWorldTransformWith=function(x,y,rotation,scaleX,scaleY,shearX,shearY){this.ax=x,this.ay=y,this.arotation=rotation,this.ascaleX=scaleX,this.ascaleY=scaleY,this.ashearX=shearX,this.ashearY=shearY,this.appliedValid=!0;var parent=this.parent,m=this.matrix,sx=this.skeleton.scaleX,sy=Bone.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(null==parent){Bone.yDown&&(rotation=-rotation,this.arotation=rotation);var skeleton=this.skeleton,rotationY=rotation+90+shearY;return m.a=core.MathUtils.cosDeg(rotation+shearX)*scaleX*sx,m.c=core.MathUtils.cosDeg(rotationY)*scaleY*sy,m.b=core.MathUtils.sinDeg(rotation+shearX)*scaleX*sx,m.d=core.MathUtils.sinDeg(rotationY)*scaleY*sy,m.tx=x*sx+skeleton.x,void(m.ty=y*sy+skeleton.y)}var pa=parent.matrix.a,pb=parent.matrix.c,pc=parent.matrix.b,pd=parent.matrix.d;switch(m.tx=pa*x+pb*y+parent.matrix.tx,m.ty=pc*x+pd*y+parent.matrix.ty,this.data.transformMode){case core.TransformMode.Normal:rotationY=rotation+90+shearY;var la=core.MathUtils.cosDeg(rotation+shearX)*scaleX,lb=core.MathUtils.cosDeg(rotationY)*scaleY,lc=core.MathUtils.sinDeg(rotation+shearX)*scaleX,ld=core.MathUtils.sinDeg(rotationY)*scaleY;return m.a=pa*la+pb*lc,m.c=pa*lb+pb*ld,m.b=pc*la+pd*lc,void(m.d=pc*lb+pd*ld);case core.TransformMode.OnlyTranslation:rotationY=rotation+90+shearY;m.a=core.MathUtils.cosDeg(rotation+shearX)*scaleX,m.c=core.MathUtils.cosDeg(rotationY)*scaleY,m.b=core.MathUtils.sinDeg(rotation+shearX)*scaleX,m.d=core.MathUtils.sinDeg(rotationY)*scaleY;break;case core.TransformMode.NoRotationOrReflection:var prx=0,rx=rotation+shearX-(prx=1e-4<(s=pa*pa+pc*pc)?(pb=pc*(s=Math.abs(pa*pd-pb*pc)/s),pd=pa*s,Math.atan2(pc,pa)*core.MathUtils.radDeg):(pc=pa=0,90-Math.atan2(pd,pb)*core.MathUtils.radDeg)),ry=rotation+shearY-prx+90;la=core.MathUtils.cosDeg(rx)*scaleX,lb=core.MathUtils.cosDeg(ry)*scaleY,lc=core.MathUtils.sinDeg(rx)*scaleX,ld=core.MathUtils.sinDeg(ry)*scaleY;m.a=pa*la-pb*lc,m.c=pa*lb-pb*ld,m.b=pc*la+pd*lc,m.d=pc*lb+pd*ld;break;case core.TransformMode.NoScale:case core.TransformMode.NoScaleOrReflection:var s,cos=core.MathUtils.cosDeg(rotation),sin=core.MathUtils.sinDeg(rotation),za=(pa*cos+pb*sin)/sx,zc=(pc*cos+pd*sin)/sy;1e-5<(s=Math.sqrt(za*za+zc*zc))&&(s=1/s),za*=s,zc*=s,s=Math.sqrt(za*za+zc*zc),this.data.transformMode==core.TransformMode.NoScale&&pa*pd-pb*pc<0!=(Bone.yDown?this.skeleton.scaleX<0!=0<this.skeleton.scaleY:this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(s=-s);var r=Math.PI/2+Math.atan2(zc,za),zb=Math.cos(r)*s,zd=Math.sin(r)*s;la=core.MathUtils.cosDeg(shearX)*scaleX,lb=core.MathUtils.cosDeg(90+shearY)*scaleY,lc=core.MathUtils.sinDeg(shearX)*scaleX,ld=core.MathUtils.sinDeg(90+shearY)*scaleY;m.a=za*la+zb*lc,m.c=za*lb+zb*ld,m.b=zc*la+zd*lc,m.d=zc*lb+zd*ld}m.a*=sx,m.c*=sx,m.b*=sy,m.d*=sy},Bone.prototype.setToSetupPose=function(){var data=this.data;this.x=data.x,this.y=data.y,this.rotation=data.rotation,this.scaleX=data.scaleX,this.scaleY=data.scaleY,this.shearX=data.shearX,this.shearY=data.shearY},Bone.prototype.getWorldRotationX=function(){return Math.atan2(this.matrix.b,this.matrix.a)*core.MathUtils.radDeg},Bone.prototype.getWorldRotationY=function(){return Math.atan2(this.matrix.d,this.matrix.c)*core.MathUtils.radDeg},Bone.prototype.getWorldScaleX=function(){var m=this.matrix;return Math.sqrt(m.a*m.a+m.c*m.c)},Bone.prototype.getWorldScaleY=function(){var m=this.matrix;return Math.sqrt(m.b*m.b+m.d*m.d)},Bone.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var parent=this.parent,m=this.matrix;if(null==parent)return this.ax=m.tx,this.ay=m.ty,this.arotation=Math.atan2(m.b,m.a)*core.MathUtils.radDeg,this.ascaleX=Math.sqrt(m.a*m.a+m.b*m.b),this.ascaleY=Math.sqrt(m.c*m.c+m.d*m.d),this.ashearX=0,void(this.ashearY=Math.atan2(m.a*m.c+m.b*m.d,m.a*m.d-m.b*m.c)*core.MathUtils.radDeg);var pm=parent.matrix,pid=1/(pm.a*pm.d-pm.b*pm.c),dx=m.tx-pm.tx,dy=m.ty-pm.ty;this.ax=dx*pm.d*pid-dy*pm.c*pid,this.ay=dy*pm.a*pid-dx*pm.b*pid;var ia=pid*pm.d,id=pid*pm.a,ib=pid*pm.c,ic=pid*pm.b,ra=ia*m.a-ib*m.b,rb=ia*m.c-ib*m.d,rc=id*m.b-ic*m.a,rd=id*m.d-ic*m.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(ra*ra+rc*rc),1e-4<this.ascaleX){var det=ra*rd-rb*rc;this.ascaleY=det/this.ascaleX,this.ashearY=Math.atan2(ra*rb+rc*rd,det)*core.MathUtils.radDeg,this.arotation=Math.atan2(rc,ra)*core.MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(rb*rb+rd*rd),this.ashearY=0,this.arotation=90-Math.atan2(rd,rb)*core.MathUtils.radDeg},Bone.prototype.worldToLocal=function(world){var m=this.matrix,a=m.a,b=m.c,c=m.b,d=m.d,invDet=1/(a*d-b*c),x=world.x-m.tx,y=world.y-m.ty;return world.x=x*d*invDet-y*b*invDet,world.y=y*a*invDet-x*c*invDet,world},Bone.prototype.localToWorld=function(local){var m=this.matrix,x=local.x,y=local.y;return local.x=x*m.a+y*m.c+m.tx,local.y=x*m.b+y*m.d+m.ty,local},Bone.prototype.worldToLocalRotation=function(worldRotation){var sin=core.MathUtils.sinDeg(worldRotation),cos=core.MathUtils.cosDeg(worldRotation),mat=this.matrix;return Math.atan2(mat.a*sin-mat.b*cos,mat.d*cos-mat.c*sin)*core.MathUtils.radDeg},Bone.prototype.localToWorldRotation=function(localRotation){var sin=core.MathUtils.sinDeg(localRotation),cos=core.MathUtils.cosDeg(localRotation),mat=this.matrix;return Math.atan2(cos*mat.b+sin*mat.d,cos*mat.a+sin*mat.c)*core.MathUtils.radDeg},Bone.prototype.rotateWorld=function(degrees){var mat=this.matrix,a=mat.a,b=mat.c,c=mat.b,d=mat.d,cos=core.MathUtils.cosDeg(degrees),sin=core.MathUtils.sinDeg(degrees);mat.a=cos*a-sin*c,mat.c=cos*b-sin*d,mat.b=sin*a+cos*c,mat.d=sin*b+cos*d,this.appliedValid=!1},Bone.yDown=!1,Bone}();core.Bone=Bone}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){function BoneData(index,name,parent){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=TransformMode.Normal,index<0)throw new Error("index must be >= 0.");if(null==name)throw new Error("name cannot be null.");this.index=index,this.name=name,this.parent=parent}var TransformMode;core.BoneData=BoneData,function(TransformMode){TransformMode[TransformMode.Normal=0]="Normal",TransformMode[TransformMode.OnlyTranslation=1]="OnlyTranslation",TransformMode[TransformMode.NoRotationOrReflection=2]="NoRotationOrReflection",TransformMode[TransformMode.NoScale=3]="NoScale",TransformMode[TransformMode.NoScaleOrReflection=4]="NoScaleOrReflection"}(TransformMode=core.TransformMode||(core.TransformMode={}))}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){function Event(time,data){if(null==data)throw new Error("data cannot be null.");this.time=time,this.data=data}core.Event=Event}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){function EventData(name){this.name=name}core.EventData=EventData}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var IkConstraint=function(){function IkConstraint(data,skeleton){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,null==data)throw new Error("data cannot be null.");if(null==skeleton)throw new Error("skeleton cannot be null.");this.data=data,this.mix=data.mix,this.bendDirection=data.bendDirection,this.compress=data.compress,this.stretch=data.stretch,this.bones=new Array;for(var i=0;i<data.bones.length;i++)this.bones.push(skeleton.findBone(data.bones[i].name));this.target=skeleton.findBone(data.target.name)}return IkConstraint.prototype.getOrder=function(){return this.data.order},IkConstraint.prototype.apply=function(){this.update()},IkConstraint.prototype.update=function(){var target=this.target,bones=this.bones;switch(bones.length){case 1:this.apply1(bones[0],target.worldX,target.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(bones[0],bones[1],target.worldX,target.worldY,this.bendDirection,this.stretch,this.mix)}},IkConstraint.prototype.apply1=function(bone,targetX,targetY,compress,stretch,uniform,alpha){bone.appliedValid||bone.updateAppliedTransform();var p=bone.parent.matrix,id=1/(p.a*p.d-p.b*p.c),x=targetX-p.tx,y=targetY-p.ty,tx=(x*p.d-y*p.c)*id-bone.ax,ty=(y*p.a-x*p.b)*id-bone.ay,rotationIK=Math.atan2(ty,tx)*core.MathUtils.radDeg-bone.ashearX-bone.arotation;bone.ascaleX<0&&(rotationIK+=180),180<rotationIK?rotationIK-=360:rotationIK<-180&&(rotationIK+=360);var sx=bone.ascaleX,sy=bone.ascaleY;if(compress||stretch){var b=bone.data.length*sx,dd=Math.sqrt(tx*tx+ty*ty);if(compress&&dd<b||stretch&&b<dd&&1e-4<b){var s=(dd/b-1)*alpha+1;sx*=s,uniform&&(sy*=s)}}bone.updateWorldTransformWith(bone.ax,bone.ay,bone.arotation+rotationIK*alpha,sx,sy,bone.ashearX,bone.ashearY)},IkConstraint.prototype.apply2=function(parent,child,targetX,targetY,bendDir,stretch,alpha){if(0!=alpha){parent.appliedValid||parent.updateAppliedTransform(),child.appliedValid||child.updateAppliedTransform();var px=parent.ax,py=parent.ay,psx=parent.ascaleX,sx=psx,psy=parent.ascaleY,csx=child.ascaleX,pmat=parent.matrix,os1=0,os2=0,s2=0;s2=psx<0?(psx=-psx,os1=180,-1):(os1=0,1),psy<0&&(psy=-psy,s2=-s2),os2=csx<0?(csx=-csx,180):0;var cx=child.ax,cy=0,cwx=0,cwy=0,a=pmat.a,b=pmat.c,c=pmat.b,d=pmat.d,u=Math.abs(psx-psy)<=1e-4;cwy=u?(cwx=a*cx+b*(cy=child.ay)+pmat.tx,c*cx+d*cy+pmat.ty):(cy=0,cwx=a*cx+pmat.tx,c*cx+pmat.ty);var pp=parent.parent.matrix;a=pp.a,b=pp.c,c=pp.b;var id=1/(a*(d=pp.d)-b*c),x=targetX-pp.tx,y=targetY-pp.ty,tx=(x*d-y*b)*id-px,ty=(y*a-x*c)*id-py,dd=tx*tx+ty*ty,dx=((x=cwx-pp.tx)*d-(y=cwy-pp.ty)*b)*id-px,dy=(y*a-x*c)*id-py,l1=Math.sqrt(dx*dx+dy*dy),l2=child.data.length*csx,a1=0,a2=0;outer:if(u){var cos=(dd-l1*l1-(l2*=psx)*l2)/(2*l1*l2);cos<-1?cos=-1:1<cos&&(cos=1,stretch&&1e-4<l1+l2&&(sx*=(Math.sqrt(dd)/(l1+l2)-1)*alpha+1)),a2=Math.acos(cos)*bendDir,a=l1+l2*cos,b=l2*Math.sin(a2),a1=Math.atan2(ty*a-tx*b,tx*a+ty*b)}else{var aa=(a=psx*l2)*a,bb=(b=psy*l2)*b,ta=Math.atan2(ty,tx),c1=-2*bb*l1,c2=bb-aa;if(0<=(d=c1*c1-4*c2*(c=bb*l1*l1+aa*dd-aa*bb))){var q=Math.sqrt(d);c1<0&&(q=-q);var r0=(q=-(c1+q)/2)/c2,r1=c/q,r=Math.abs(r0)<Math.abs(r1)?r0:r1;if(r*r<=dd){y=Math.sqrt(dd-r*r)*bendDir,a1=ta-Math.atan2(y,r),a2=Math.atan2(y/psy,(r-l1)/psx);break outer}}var minAngle=core.MathUtils.PI,minX=l1-a,minDist=minX*minX,minY=0,maxAngle=0,maxX=l1+a,maxDist=maxX*maxX,maxY=0;-1<=(c=-a*l1/(aa-bb))&&c<=1&&(c=Math.acos(c),(d=(x=a*Math.cos(c)+l1)*x+(y=b*Math.sin(c))*y)<minDist&&(minAngle=c,minDist=d,minX=x,minY=y),maxDist<d&&(maxAngle=c,maxDist=d,maxX=x,maxY=y)),a2=dd<=(minDist+maxDist)/2?(a1=ta-Math.atan2(minY*bendDir,minX),minAngle*bendDir):(a1=ta-Math.atan2(maxY*bendDir,maxX),maxAngle*bendDir)}var os=Math.atan2(cy,cx)*s2,rotation=parent.arotation;180<(a1=(a1-os)*core.MathUtils.radDeg+os1-rotation)?a1-=360:a1<-180&&(a1+=360),parent.updateWorldTransformWith(px,py,rotation+a1*alpha,sx,parent.ascaleY,0,0),rotation=child.arotation,180<(a2=((a2+os)*core.MathUtils.radDeg-child.ashearX)*s2+os2-rotation)?a2-=360:a2<-180&&(a2+=360),child.updateWorldTransformWith(cx,cy,rotation+a2*alpha,child.ascaleX,child.ascaleY,child.ashearX,child.ashearY)}else child.updateWorldTransform()},IkConstraint}();core.IkConstraint=IkConstraint}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){function IkConstraintData(name){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=name}core.IkConstraintData=IkConstraintData}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var PathConstraint=function(){function PathConstraint(data,skeleton){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,null==data)throw new Error("data cannot be null.");if(null==skeleton)throw new Error("skeleton cannot be null.");this.data=data,this.bones=new Array;for(var i=0,n=data.bones.length;i<n;i++)this.bones.push(skeleton.findBone(data.bones[i].name));this.target=skeleton.findSlot(data.target.name),this.position=data.position,this.spacing=data.spacing,this.rotateMix=data.rotateMix,this.translateMix=data.translateMix}return PathConstraint.prototype.apply=function(){this.update()},PathConstraint.prototype.update=function(){var attachment=this.target.getAttachment();if(attachment instanceof core.PathAttachment){var rotateMix=this.rotateMix,translateMix=this.translateMix,rotate=0<rotateMix;if(0<translateMix||rotate){var data=this.data,spacingMode=data.spacingMode,lengthSpacing=spacingMode==core.SpacingMode.Length,rotateMode=data.rotateMode,tangents=rotateMode==core.RotateMode.Tangent,scale=rotateMode==core.RotateMode.ChainScale,boneCount=this.bones.length,spacesCount=tangents?boneCount:boneCount+1,bones=this.bones,spaces=core.Utils.setArraySize(this.spaces,spacesCount),lengths=null,spacing=this.spacing;if(scale||lengthSpacing){scale&&(lengths=core.Utils.setArraySize(this.lengths,boneCount));for(var i=0,n=spacesCount-1;i<n;){var setupLength=(bone=bones[i]).data.length;if(setupLength<PathConstraint.epsilon)scale&&(lengths[i]=0),spaces[++i]=0;else{var x=setupLength*bone.matrix.a,y=setupLength*bone.matrix.b,length_1=Math.sqrt(x*x+y*y);scale&&(lengths[i]=length_1),spaces[++i]=(lengthSpacing?setupLength+spacing:spacing)*length_1/setupLength}}}else for(i=1;i<spacesCount;i++)spaces[i]=spacing;var positions=this.computeWorldPositions(attachment,spacesCount,tangents,data.positionMode==core.PositionMode.Percent,spacingMode==core.SpacingMode.Percent),boneX=positions[0],boneY=positions[1],offsetRotation=data.offsetRotation,tip=!1;if(0==offsetRotation)tip=rotateMode==core.RotateMode.Chain;else tip=!1,offsetRotation*=0<(p=this.target.bone.matrix).a*p.d-p.b*p.c?core.MathUtils.degRad:-core.MathUtils.degRad;i=0;for(var p=3;i<boneCount;i++,p+=3){var bone,mat=(bone=bones[i]).matrix;mat.tx+=(boneX-mat.tx)*translateMix,mat.ty+=(boneY-mat.ty)*translateMix;var dx=(x=positions[p])-boneX,dy=(y=positions[p+1])-boneY;if(scale){var length_2=lengths[i];if(0!=length_2){var s=(Math.sqrt(dx*dx+dy*dy)/length_2-1)*rotateMix+1;mat.a*=s,mat.b*=s}}if(boneX=x,boneY=y,rotate){var a=mat.a,b=mat.c,c=mat.b,d=mat.d,r=0,cos=0,sin=0;if(r=tangents?positions[p-1]:0==spaces[i+1]?positions[p+2]:Math.atan2(dy,dx),r-=Math.atan2(c,a),tip){cos=Math.cos(r),sin=Math.sin(r);var length_3=bone.data.length;boneX+=(length_3*(cos*a-sin*c)-dx)*rotateMix,boneY+=(length_3*(sin*a+cos*c)-dy)*rotateMix}else r+=offsetRotation;r>core.MathUtils.PI?r-=core.MathUtils.PI2:r<-core.MathUtils.PI&&(r+=core.MathUtils.PI2),r*=rotateMix,cos=Math.cos(r),sin=Math.sin(r),mat.a=cos*a-sin*c,mat.c=cos*b-sin*d,mat.b=sin*a+cos*c,mat.d=sin*b+cos*d}bone.appliedValid=!1}}}},PathConstraint.prototype.computeWorldPositions=function(path,spacesCount,tangents,percentPosition,percentSpacing){var target=this.target,position=this.position,spaces=this.spaces,out=core.Utils.setArraySize(this.positions,3*spacesCount+2),world=null,closed=path.closed,verticesLength=path.worldVerticesLength,curveCount=verticesLength/6,prevCurve=PathConstraint.NONE;if(!path.constantSpeed){var lengths=path.lengths,pathLength_1=lengths[curveCount-=closed?1:2];if(percentPosition&&(position*=pathLength_1),percentSpacing)for(var i=0;i<spacesCount;i++)spaces[i]*=pathLength_1;world=core.Utils.setArraySize(this.world,8);i=0;for(var o=0,curve=0;i<spacesCount;i++,o+=3){var p=position+=space=spaces[i];if(closed)(p%=pathLength_1)<0&&(p+=pathLength_1),curve=0;else{if(p<0){prevCurve!=PathConstraint.BEFORE&&(prevCurve=PathConstraint.BEFORE,path.computeWorldVertices(target,2,4,world,0,2)),this.addBeforePosition(p,world,0,out,o);continue}if(pathLength_1<p){prevCurve!=PathConstraint.AFTER&&(prevCurve=PathConstraint.AFTER,path.computeWorldVertices(target,verticesLength-6,4,world,0,2)),this.addAfterPosition(p-pathLength_1,world,0,out,o);continue}}for(;;curve++){var length_4=lengths[curve];if(!(length_4<p)){if(0==curve)p/=length_4;else p=(p-(prev=lengths[curve-1]))/(length_4-prev);break}}curve!=prevCurve&&(prevCurve=curve,closed&&curve==curveCount?(path.computeWorldVertices(target,verticesLength-4,4,world,0,2),path.computeWorldVertices(target,0,4,world,4,2)):path.computeWorldVertices(target,6*curve+2,8,world,0,2)),this.addCurvePosition(p,world[0],world[1],world[2],world[3],world[4],world[5],world[6],world[7],out,o,tangents||0<i&&0==space)}return out}closed?(verticesLength+=2,world=core.Utils.setArraySize(this.world,verticesLength),path.computeWorldVertices(target,2,verticesLength-4,world,0,2),path.computeWorldVertices(target,0,2,world,verticesLength-4,2),world[verticesLength-2]=world[0],world[verticesLength-1]=world[1]):(curveCount--,verticesLength-=4,world=core.Utils.setArraySize(this.world,verticesLength),path.computeWorldVertices(target,2,verticesLength,world,0,2));for(var curves=core.Utils.setArraySize(this.curves,curveCount),pathLength=0,x1=world[0],y1=world[1],cx1=0,cy1=0,cx2=0,cy2=0,x2=0,y2=0,tmpx=0,tmpy=0,dddfx=0,dddfy=0,ddfx=0,ddfy=0,dfx=0,dfy=0,w=(i=0,2);i<curveCount;i++,w+=6)cx1=world[w],cy1=world[w+1],cx2=world[w+2],cy2=world[w+3],ddfx=2*(tmpx=.1875*(x1-2*cx1+cx2))+(dddfx=.09375*(3*(cx1-cx2)-x1+(x2=world[w+4]))),ddfy=2*(tmpy=.1875*(y1-2*cy1+cy2))+(dddfy=.09375*(3*(cy1-cy2)-y1+(y2=world[w+5]))),dfx=.75*(cx1-x1)+tmpx+.16666667*dddfx,dfy=.75*(cy1-y1)+tmpy+.16666667*dddfy,pathLength+=Math.sqrt(dfx*dfx+dfy*dfy),dfx+=ddfx,dfy+=ddfy,ddfx+=dddfx,ddfy+=dddfy,pathLength+=Math.sqrt(dfx*dfx+dfy*dfy),dfx+=ddfx,dfy+=ddfy,pathLength+=Math.sqrt(dfx*dfx+dfy*dfy),dfx+=ddfx+dddfx,dfy+=ddfy+dddfy,pathLength+=Math.sqrt(dfx*dfx+dfy*dfy),curves[i]=pathLength,x1=x2,y1=y2;if(percentPosition&&(position*=pathLength),percentSpacing)for(i=0;i<spacesCount;i++)spaces[i]*=pathLength;for(var segments=this.segments,curveLength=0,segment=(i=0,o=0,curve=0,0);i<spacesCount;i++,o+=3){var space;p=position+=space=spaces[i];if(closed)(p%=pathLength)<0&&(p+=pathLength),curve=0;else{if(p<0){this.addBeforePosition(p,world,0,out,o);continue}if(pathLength<p){this.addAfterPosition(p-pathLength,world,verticesLength-4,out,o);continue}}for(;;curve++){var length_5=curves[curve];if(!(length_5<p)){if(0==curve)p/=length_5;else p=(p-(prev=curves[curve-1]))/(length_5-prev);break}}if(curve!=prevCurve){var ii=6*(prevCurve=curve);for(x1=world[ii],y1=world[ii+1],cx1=world[ii+2],cy1=world[ii+3],cx2=world[ii+4],cy2=world[ii+5],ddfx=2*(tmpx=.03*(x1-2*cx1+cx2))+(dddfx=.006*(3*(cx1-cx2)-x1+(x2=world[ii+6]))),ddfy=2*(tmpy=.03*(y1-2*cy1+cy2))+(dddfy=.006*(3*(cy1-cy2)-y1+(y2=world[ii+7]))),dfx=.3*(cx1-x1)+tmpx+.16666667*dddfx,dfy=.3*(cy1-y1)+tmpy+.16666667*dddfy,curveLength=Math.sqrt(dfx*dfx+dfy*dfy),segments[0]=curveLength,ii=1;ii<8;ii++)dfx+=ddfx,dfy+=ddfy,ddfx+=dddfx,ddfy+=dddfy,curveLength+=Math.sqrt(dfx*dfx+dfy*dfy),segments[ii]=curveLength;dfx+=ddfx,dfy+=ddfy,curveLength+=Math.sqrt(dfx*dfx+dfy*dfy),segments[8]=curveLength,dfx+=ddfx+dddfx,dfy+=ddfy+dddfy,curveLength+=Math.sqrt(dfx*dfx+dfy*dfy),segments[9]=curveLength,segment=0}for(p*=curveLength;;segment++){var length_6=segments[segment];if(!(length_6<p)){var prev;if(0==segment)p/=length_6;else p=segment+(p-(prev=segments[segment-1]))/(length_6-prev);break}}this.addCurvePosition(.1*p,x1,y1,cx1,cy1,cx2,cy2,x2,y2,out,o,tangents||0<i&&0==space)}return out},PathConstraint.prototype.addBeforePosition=function(p,temp,i,out,o){var x1=temp[i],y1=temp[i+1],dx=temp[i+2]-x1,dy=temp[i+3]-y1,r=Math.atan2(dy,dx);out[o]=x1+p*Math.cos(r),out[o+1]=y1+p*Math.sin(r),out[o+2]=r},PathConstraint.prototype.addAfterPosition=function(p,temp,i,out,o){var x1=temp[i+2],y1=temp[i+3],dx=x1-temp[i],dy=y1-temp[i+1],r=Math.atan2(dy,dx);out[o]=x1+p*Math.cos(r),out[o+1]=y1+p*Math.sin(r),out[o+2]=r},PathConstraint.prototype.addCurvePosition=function(p,x1,y1,cx1,cy1,cx2,cy2,x2,y2,out,o,tangents){0!=p&&!isNaN(p)||(p=1e-4);var tt=p*p,ttt=tt*p,u=1-p,uu=u*u,uuu=uu*u,ut=u*p,ut3=3*ut,uut3=u*ut3,utt3=ut3*p,x=x1*uuu+cx1*uut3+cx2*utt3+x2*ttt,y=y1*uuu+cy1*uut3+cy2*utt3+y2*ttt;out[o]=x,out[o+1]=y,tangents&&(out[o+2]=Math.atan2(y-(y1*uu+cy1*ut*2+cy2*tt),x-(x1*uu+cx1*ut*2+cx2*tt)))},PathConstraint.prototype.getOrder=function(){return this.data.order},PathConstraint.NONE=-1,PathConstraint.BEFORE=-2,PathConstraint.AFTER=-3,PathConstraint.epsilon=1e-5,PathConstraint}();core.PathConstraint=PathConstraint}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){function PathConstraintData(name){this.order=0,this.bones=new Array,this.name=name}core.PathConstraintData=PathConstraintData,function(PositionMode){PositionMode[PositionMode.Fixed=0]="Fixed",PositionMode[PositionMode.Percent=1]="Percent"}(core.PositionMode||(core.PositionMode={})),function(SpacingMode){SpacingMode[SpacingMode.Length=0]="Length",SpacingMode[SpacingMode.Fixed=1]="Fixed",SpacingMode[SpacingMode.Percent=2]="Percent"}(core.SpacingMode||(core.SpacingMode={})),function(RotateMode){RotateMode[RotateMode.Tangent=0]="Tangent",RotateMode[RotateMode.Chain=1]="Chain",RotateMode[RotateMode.ChainScale=2]="ChainScale"}(core.RotateMode||(core.RotateMode={}))}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var Skeleton=function(){function Skeleton(data){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==data)throw new Error("data cannot be null.");this.data=data,this.bones=new Array;for(var i=0;i<data.bones.length;i++){var boneData=data.bones[i],bone=void 0;if(null==boneData.parent)bone=new core.Bone(boneData,this,null);else{var parent_1=this.bones[boneData.parent.index];bone=new core.Bone(boneData,this,parent_1),parent_1.children.push(bone)}this.bones.push(bone)}this.slots=new Array,this.drawOrder=new Array;for(i=0;i<data.slots.length;i++){var slotData=data.slots[i],slot=(bone=this.bones[slotData.boneData.index],new core.Slot(slotData,bone));this.slots.push(slot),this.drawOrder.push(slot)}this.ikConstraints=new Array;for(i=0;i<data.ikConstraints.length;i++){var ikConstraintData=data.ikConstraints[i];this.ikConstraints.push(new core.IkConstraint(ikConstraintData,this))}this.transformConstraints=new Array;for(i=0;i<data.transformConstraints.length;i++){var transformConstraintData=data.transformConstraints[i];this.transformConstraints.push(new core.TransformConstraint(transformConstraintData,this))}this.pathConstraints=new Array;for(i=0;i<data.pathConstraints.length;i++){var pathConstraintData=data.pathConstraints[i];this.pathConstraints.push(new core.PathConstraint(pathConstraintData,this))}this.color=new core.Color(1,1,1,1),this.updateCache()}return Skeleton.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var bones=this.bones,i=0,n=bones.length;i<n;i++)bones[i].sorted=!1;var ikConstraints=this.ikConstraints,transformConstraints=this.transformConstraints,pathConstraints=this.pathConstraints,ikCount=ikConstraints.length,transformCount=transformConstraints.length,pathCount=pathConstraints.length,constraintCount=ikCount+transformCount+pathCount;outer:for(i=0;i<constraintCount;i++){for(var ii=0;ii<ikCount;ii++){if((constraint=ikConstraints[ii]).data.order==i){this.sortIkConstraint(constraint);continue outer}}for(ii=0;ii<transformCount;ii++){if((constraint=transformConstraints[ii]).data.order==i){this.sortTransformConstraint(constraint);continue outer}}for(ii=0;ii<pathCount;ii++){var constraint;if((constraint=pathConstraints[ii]).data.order==i){this.sortPathConstraint(constraint);continue outer}}}for(i=0,n=bones.length;i<n;i++)this.sortBone(bones[i])},Skeleton.prototype.sortIkConstraint=function(constraint){var target=constraint.target;this.sortBone(target);var constrained=constraint.bones,parent=constrained[0];if(this.sortBone(parent),1<constrained.length){var child=constrained[constrained.length-1];-1<this._updateCache.indexOf(child)||this.updateCacheReset.push(child)}this._updateCache.push(constraint),this.sortReset(parent.children),constrained[constrained.length-1].sorted=!0},Skeleton.prototype.sortPathConstraint=function(constraint){var slot=constraint.target,slotIndex=slot.data.index,slotBone=slot.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,slotIndex,slotBone),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,slotIndex,slotBone);for(var i=0,n=this.data.skins.length;i<n;i++)this.sortPathConstraintAttachment(this.data.skins[i],slotIndex,slotBone);var attachment=slot.getAttachment();attachment instanceof core.PathAttachment&&this.sortPathConstraintAttachmentWith(attachment,slotBone);var constrained=constraint.bones,boneCount=constrained.length;for(i=0;i<boneCount;i++)this.sortBone(constrained[i]);this._updateCache.push(constraint);for(i=0;i<boneCount;i++)this.sortReset(constrained[i].children);for(i=0;i<boneCount;i++)constrained[i].sorted=!0},Skeleton.prototype.sortTransformConstraint=function(constraint){this.sortBone(constraint.target);var constrained=constraint.bones,boneCount=constrained.length;if(constraint.data.local)for(var i=0;i<boneCount;i++){var child=constrained[i];this.sortBone(child.parent),-1<this._updateCache.indexOf(child)||this.updateCacheReset.push(child)}else for(i=0;i<boneCount;i++)this.sortBone(constrained[i]);this._updateCache.push(constraint);for(var ii=0;ii<boneCount;ii++)this.sortReset(constrained[ii].children);for(ii=0;ii<boneCount;ii++)constrained[ii].sorted=!0},Skeleton.prototype.sortPathConstraintAttachment=function(skin,slotIndex,slotBone){var attachments=skin.attachments[slotIndex];if(attachments)for(var key in attachments)this.sortPathConstraintAttachmentWith(attachments[key],slotBone)},Skeleton.prototype.sortPathConstraintAttachmentWith=function(attachment,slotBone){if(attachment instanceof core.PathAttachment){var pathBones=attachment.bones;if(null==pathBones)this.sortBone(slotBone);else for(var bones=this.bones,i=0;i<pathBones.length;)for(var boneCount=pathBones[i++],n=i+boneCount;i<n;i++){var boneIndex=pathBones[i];this.sortBone(bones[boneIndex])}}},Skeleton.prototype.sortBone=function(bone){if(!bone.sorted){var parent=bone.parent;null!=parent&&this.sortBone(parent),bone.sorted=!0,this._updateCache.push(bone)}},Skeleton.prototype.sortReset=function(bones){for(var i=0,n=bones.length;i<n;i++){var bone=bones[i];bone.sorted&&this.sortReset(bone.children),bone.sorted=!1}},Skeleton.prototype.updateWorldTransform=function(){for(var updateCacheReset=this.updateCacheReset,i=0,n=updateCacheReset.length;i<n;i++){var bone=updateCacheReset[i];bone.ax=bone.x,bone.ay=bone.y,bone.arotation=bone.rotation,bone.ascaleX=bone.scaleX,bone.ascaleY=bone.scaleY,bone.ashearX=bone.shearX,bone.ashearY=bone.shearY,bone.appliedValid=!0}var updateCache=this._updateCache;for(i=0,n=updateCache.length;i<n;i++)updateCache[i].update()},Skeleton.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},Skeleton.prototype.setBonesToSetupPose=function(){for(var bones=this.bones,i=0,n=bones.length;i<n;i++)bones[i].setToSetupPose();var ikConstraints=this.ikConstraints;for(i=0,n=ikConstraints.length;i<n;i++){(constraint=ikConstraints[i]).bendDirection=constraint.data.bendDirection,constraint.mix=constraint.data.mix}var transformConstraints=this.transformConstraints;for(i=0,n=transformConstraints.length;i<n;i++){var data=(constraint=transformConstraints[i]).data;constraint.rotateMix=data.rotateMix,constraint.translateMix=data.translateMix,constraint.scaleMix=data.scaleMix,constraint.shearMix=data.shearMix}var pathConstraints=this.pathConstraints;for(i=0,n=pathConstraints.length;i<n;i++){var constraint;data=(constraint=pathConstraints[i]).data;constraint.position=data.position,constraint.spacing=data.spacing,constraint.rotateMix=data.rotateMix,constraint.translateMix=data.translateMix}},Skeleton.prototype.setSlotsToSetupPose=function(){var slots=this.slots;core.Utils.arrayCopy(slots,0,this.drawOrder,0,slots.length);for(var i=0,n=slots.length;i<n;i++)slots[i].setToSetupPose()},Skeleton.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},Skeleton.prototype.findBone=function(boneName){if(null==boneName)throw new Error("boneName cannot be null.");for(var bones=this.bones,i=0,n=bones.length;i<n;i++){var bone=bones[i];if(bone.data.name==boneName)return bone}return null},Skeleton.prototype.findBoneIndex=function(boneName){if(null==boneName)throw new Error("boneName cannot be null.");for(var bones=this.bones,i=0,n=bones.length;i<n;i++)if(bones[i].data.name==boneName)return i;return-1},Skeleton.prototype.findSlot=function(slotName){if(null==slotName)throw new Error("slotName cannot be null.");for(var slots=this.slots,i=0,n=slots.length;i<n;i++){var slot=slots[i];if(slot.data.name==slotName)return slot}return null},Skeleton.prototype.findSlotIndex=function(slotName){if(null==slotName)throw new Error("slotName cannot be null.");for(var slots=this.slots,i=0,n=slots.length;i<n;i++)if(slots[i].data.name==slotName)return i;return-1},Skeleton.prototype.setSkinByName=function(skinName){var skin=this.data.findSkin(skinName);if(null==skin)throw new Error("Skin not found: "+skinName);this.setSkin(skin)},Skeleton.prototype.setSkin=function(newSkin){if(null!=newSkin)if(null!=this.skin)newSkin.attachAll(this,this.skin);else for(var slots=this.slots,i=0,n=slots.length;i<n;i++){var slot=slots[i],name_1=slot.data.attachmentName;if(null!=name_1){var attachment=newSkin.getAttachment(i,name_1);null!=attachment&&slot.setAttachment(attachment)}}this.skin=newSkin},Skeleton.prototype.getAttachmentByName=function(slotName,attachmentName){return this.getAttachment(this.data.findSlotIndex(slotName),attachmentName)},Skeleton.prototype.getAttachment=function(slotIndex,attachmentName){if(null==attachmentName)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var attachment=this.skin.getAttachment(slotIndex,attachmentName);if(null!=attachment)return attachment}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(slotIndex,attachmentName):null},Skeleton.prototype.setAttachment=function(slotName,attachmentName){if(null==slotName)throw new Error("slotName cannot be null.");for(var slots=this.slots,i=0,n=slots.length;i<n;i++){var slot=slots[i];if(slot.data.name==slotName){var attachment=null;if(null!=attachmentName&&null==(attachment=this.getAttachment(i,attachmentName)))throw new Error("Attachment not found: "+attachmentName+", for slot: "+slotName);return void slot.setAttachment(attachment)}}throw new Error("Slot not found: "+slotName)},Skeleton.prototype.findIkConstraint=function(constraintName){if(null==constraintName)throw new Error("constraintName cannot be null.");for(var ikConstraints=this.ikConstraints,i=0,n=ikConstraints.length;i<n;i++){var ikConstraint=ikConstraints[i];if(ikConstraint.data.name==constraintName)return ikConstraint}return null},Skeleton.prototype.findTransformConstraint=function(constraintName){if(null==constraintName)throw new Error("constraintName cannot be null.");for(var transformConstraints=this.transformConstraints,i=0,n=transformConstraints.length;i<n;i++){var constraint=transformConstraints[i];if(constraint.data.name==constraintName)return constraint}return null},Skeleton.prototype.findPathConstraint=function(constraintName){if(null==constraintName)throw new Error("constraintName cannot be null.");for(var pathConstraints=this.pathConstraints,i=0,n=pathConstraints.length;i<n;i++){var constraint=pathConstraints[i];if(constraint.data.name==constraintName)return constraint}return null},Skeleton.prototype.getBounds=function(offset,size,temp){if(null==offset)throw new Error("offset cannot be null.");if(null==size)throw new Error("size cannot be null.");for(var drawOrder=this.drawOrder,minX=Number.POSITIVE_INFINITY,minY=Number.POSITIVE_INFINITY,maxX=Number.NEGATIVE_INFINITY,maxY=Number.NEGATIVE_INFINITY,i=0,n=drawOrder.length;i<n;i++){var slot=drawOrder[i],verticesLength=0,vertices=null,attachment=slot.getAttachment();if(attachment instanceof core.RegionAttachment)verticesLength=8,vertices=core.Utils.setArraySize(temp,verticesLength,0),attachment.computeWorldVertices(slot.bone,vertices,0,2);else if(attachment instanceof core.MeshAttachment){var mesh=attachment;verticesLength=mesh.worldVerticesLength,vertices=core.Utils.setArraySize(temp,verticesLength,0),mesh.computeWorldVertices(slot,0,verticesLength,vertices,0,2)}if(null!=vertices)for(var ii=0,nn=vertices.length;ii<nn;ii+=2){var x=vertices[ii],y=vertices[ii+1];minX=Math.min(minX,x),minY=Math.min(minY,y),maxX=Math.max(maxX,x),maxY=Math.max(maxY,y)}}offset.set(minX,minY),size.set(maxX-minX,maxY-minY)},Skeleton.prototype.update=function(delta){this.time+=delta},Object.defineProperty(Skeleton.prototype,"flipX",{get:function(){return-1==this.scaleX},set:function(value){Skeleton.deprecatedWarning1||(Skeleton.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=value?1:-1},enumerable:!0,configurable:!0}),Object.defineProperty(Skeleton.prototype,"flipY",{get:function(){return-1==this.scaleY},set:function(value){Skeleton.deprecatedWarning1||(Skeleton.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=value?1:-1},enumerable:!0,configurable:!0}),Skeleton.deprecatedWarning1=!1,Skeleton}();core.Skeleton=Skeleton}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var SkeletonBounds=function(){function SkeletonBounds(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new core.Pool(function(){return core.Utils.newFloatArray(16)})}return SkeletonBounds.prototype.update=function(skeleton,updateAabb){if(null==skeleton)throw new Error("skeleton cannot be null.");var boundingBoxes=this.boundingBoxes,polygons=this.polygons,polygonPool=this.polygonPool,slots=skeleton.slots,slotCount=slots.length;boundingBoxes.length=0,polygonPool.freeAll(polygons);for(var i=polygons.length=0;i<slotCount;i++){var slot=slots[i],attachment=slot.getAttachment();if(attachment instanceof core.BoundingBoxAttachment){var boundingBox=attachment;boundingBoxes.push(boundingBox);var polygon=polygonPool.obtain();polygon.length!=boundingBox.worldVerticesLength&&(polygon=core.Utils.newFloatArray(boundingBox.worldVerticesLength)),polygons.push(polygon),boundingBox.computeWorldVertices(slot,0,boundingBox.worldVerticesLength,polygon,0,2)}}updateAabb?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},SkeletonBounds.prototype.aabbCompute=function(){for(var minX=Number.POSITIVE_INFINITY,minY=Number.POSITIVE_INFINITY,maxX=Number.NEGATIVE_INFINITY,maxY=Number.NEGATIVE_INFINITY,polygons=this.polygons,i=0,n=polygons.length;i<n;i++)for(var polygon=polygons[i],vertices=polygon,ii=0,nn=polygon.length;ii<nn;ii+=2){var x=vertices[ii],y=vertices[ii+1];minX=Math.min(minX,x),minY=Math.min(minY,y),maxX=Math.max(maxX,x),maxY=Math.max(maxY,y)}this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY},SkeletonBounds.prototype.aabbContainsPoint=function(x,y){return x>=this.minX&&x<=this.maxX&&y>=this.minY&&y<=this.maxY},SkeletonBounds.prototype.aabbIntersectsSegment=function(x1,y1,x2,y2){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY;if(x1<=minX&&x2<=minX||y1<=minY&&y2<=minY||maxX<=x1&&maxX<=x2||maxY<=y1&&maxY<=y2)return!1;var m=(y2-y1)/(x2-x1),y=m*(minX-x1)+y1;if(minY<y&&y<maxY)return!0;if(minY<(y=m*(maxX-x1)+y1)&&y<maxY)return!0;var x=(minY-y1)/m+x1;return minX<x&&x<maxX||minX<(x=(maxY-y1)/m+x1)&&x<maxX},SkeletonBounds.prototype.aabbIntersectsSkeleton=function(bounds){return this.minX<bounds.maxX&&this.maxX>bounds.minX&&this.minY<bounds.maxY&&this.maxY>bounds.minY},SkeletonBounds.prototype.containsPoint=function(x,y){for(var polygons=this.polygons,i=0,n=polygons.length;i<n;i++)if(this.containsPointPolygon(polygons[i],x,y))return this.boundingBoxes[i];return null},SkeletonBounds.prototype.containsPointPolygon=function(polygon,x,y){for(var vertices=polygon,nn=polygon.length,prevIndex=nn-2,inside=!1,ii=0;ii<nn;ii+=2){var vertexY=vertices[ii+1],prevY=vertices[prevIndex+1];if(vertexY<y&&y<=prevY||prevY<y&&y<=vertexY){var vertexX=vertices[ii];vertexX+(y-vertexY)/(prevY-vertexY)*(vertices[prevIndex]-vertexX)<x&&(inside=!inside)}prevIndex=ii}return inside},SkeletonBounds.prototype.intersectsSegment=function(x1,y1,x2,y2){for(var polygons=this.polygons,i=0,n=polygons.length;i<n;i++)if(this.intersectsSegmentPolygon(polygons[i],x1,y1,x2,y2))return this.boundingBoxes[i];return null},SkeletonBounds.prototype.intersectsSegmentPolygon=function(polygon,x1,y1,x2,y2){for(var vertices=polygon,nn=polygon.length,width12=x1-x2,height12=y1-y2,det1=x1*y2-y1*x2,x3=vertices[nn-2],y3=vertices[nn-1],ii=0;ii<nn;ii+=2){var x4=vertices[ii],y4=vertices[ii+1],det2=x3*y4-y3*x4,width34=x3-x4,height34=y3-y4,det3=width12*height34-height12*width34,x=(det1*width34-width12*det2)/det3;if((x3<=x&&x<=x4||x4<=x&&x<=x3)&&(x1<=x&&x<=x2||x2<=x&&x<=x1)){var y=(det1*height34-height12*det2)/det3;if((y3<=y&&y<=y4||y4<=y&&y<=y3)&&(y1<=y&&y<=y2||y2<=y&&y<=y1))return!0}x3=x4,y3=y4}return!1},SkeletonBounds.prototype.getPolygon=function(boundingBox){if(null==boundingBox)throw new Error("boundingBox cannot be null.");var index=this.boundingBoxes.indexOf(boundingBox);return-1==index?null:this.polygons[index]},SkeletonBounds.prototype.getWidth=function(){return this.maxX-this.minX},SkeletonBounds.prototype.getHeight=function(){return this.maxY-this.minY},SkeletonBounds}();core.SkeletonBounds=SkeletonBounds}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var SkeletonClipping=function(){function SkeletonClipping(){this.triangulator=new core.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}return SkeletonClipping.prototype.clipStart=function(slot,clip){if(null!=this.clipAttachment)return 0;var n=(this.clipAttachment=clip).worldVerticesLength,vertices=core.Utils.setArraySize(this.clippingPolygon,n);clip.computeWorldVertices(slot,0,n,vertices,0,2);var clippingPolygon=this.clippingPolygon;SkeletonClipping.makeClockwise(clippingPolygon);for(var clippingPolygons=this.clippingPolygons=this.triangulator.decompose(clippingPolygon,this.triangulator.triangulate(clippingPolygon)),i=0,n_1=clippingPolygons.length;i<n_1;i++){var polygon=clippingPolygons[i];SkeletonClipping.makeClockwise(polygon),polygon.push(polygon[0]),polygon.push(polygon[1])}return clippingPolygons.length},SkeletonClipping.prototype.clipEndWithSlot=function(slot){null!=this.clipAttachment&&this.clipAttachment.endSlot==slot.data&&this.clipEnd()},SkeletonClipping.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},SkeletonClipping.prototype.isClipping=function(){return null!=this.clipAttachment},SkeletonClipping.prototype.clipTriangles=function(vertices,verticesLength,triangles,trianglesLength,uvs,light,dark,twoColor){var clipOutput=this.clipOutput,clippedVertices=this.clippedVertices,clippedTriangles=this.clippedTriangles,polygons=this.clippingPolygons,polygonsCount=this.clippingPolygons.length,vertexSize=twoColor?12:8,index=0;clippedVertices.length=0;outer:for(var i=clippedTriangles.length=0;i<trianglesLength;i+=3)for(var vertexOffset=triangles[i]<<1,x1=vertices[vertexOffset],y1=vertices[vertexOffset+1],u1=uvs[vertexOffset],v1=uvs[vertexOffset+1],x2=vertices[vertexOffset=triangles[i+1]<<1],y2=vertices[vertexOffset+1],u2=uvs[vertexOffset],v2=uvs[vertexOffset+1],x3=vertices[vertexOffset=triangles[i+2]<<1],y3=vertices[vertexOffset+1],u3=uvs[vertexOffset],v3=uvs[vertexOffset+1],p=0;p<polygonsCount;p++){var s=clippedVertices.length;if(!this.clip(x1,y1,x2,y2,x3,y3,polygons[p],clipOutput)){(clippedVerticesItems=core.Utils.setArraySize(clippedVertices,s+3*vertexSize))[s]=x1,clippedVerticesItems[s+1]=y1,clippedVerticesItems[s+2]=light.r,clippedVerticesItems[s+3]=light.g,clippedVerticesItems[s+4]=light.b,clippedVerticesItems[s+5]=light.a,twoColor?(clippedVerticesItems[s+6]=u1,clippedVerticesItems[s+7]=v1,clippedVerticesItems[s+8]=dark.r,clippedVerticesItems[s+9]=dark.g,clippedVerticesItems[s+10]=dark.b,clippedVerticesItems[s+11]=dark.a,clippedVerticesItems[s+12]=x2,clippedVerticesItems[s+13]=y2,clippedVerticesItems[s+14]=light.r,clippedVerticesItems[s+15]=light.g,clippedVerticesItems[s+16]=light.b,clippedVerticesItems[s+17]=light.a,clippedVerticesItems[s+18]=u2,clippedVerticesItems[s+19]=v2,clippedVerticesItems[s+20]=dark.r,clippedVerticesItems[s+21]=dark.g,clippedVerticesItems[s+22]=dark.b,clippedVerticesItems[s+23]=dark.a,clippedVerticesItems[s+24]=x3,clippedVerticesItems[s+25]=y3,clippedVerticesItems[s+26]=light.r,clippedVerticesItems[s+27]=light.g,clippedVerticesItems[s+28]=light.b,clippedVerticesItems[s+29]=light.a,clippedVerticesItems[s+30]=u3,clippedVerticesItems[s+31]=v3,clippedVerticesItems[s+32]=dark.r,clippedVerticesItems[s+33]=dark.g,clippedVerticesItems[s+34]=dark.b,clippedVerticesItems[s+35]=dark.a):(clippedVerticesItems[s+6]=u1,clippedVerticesItems[s+7]=v1,clippedVerticesItems[s+8]=x2,clippedVerticesItems[s+9]=y2,clippedVerticesItems[s+10]=light.r,clippedVerticesItems[s+11]=light.g,clippedVerticesItems[s+12]=light.b,clippedVerticesItems[s+13]=light.a,clippedVerticesItems[s+14]=u2,clippedVerticesItems[s+15]=v2,clippedVerticesItems[s+16]=x3,clippedVerticesItems[s+17]=y3,clippedVerticesItems[s+18]=light.r,clippedVerticesItems[s+19]=light.g,clippedVerticesItems[s+20]=light.b,clippedVerticesItems[s+21]=light.a,clippedVerticesItems[s+22]=u3,clippedVerticesItems[s+23]=v3),s=clippedTriangles.length,(clippedTrianglesItems=core.Utils.setArraySize(clippedTriangles,s+3))[s]=index,clippedTrianglesItems[s+1]=index+1,clippedTrianglesItems[s+2]=index+2,index+=3;continue outer}var clipOutputLength=clipOutput.length;if(0!=clipOutputLength){for(var d0=y2-y3,d1=x3-x2,d2=x1-x3,d4=y3-y1,d=1/(d0*d2+d1*(y1-y3)),clipOutputCount=clipOutputLength>>1,clipOutputItems=this.clipOutput,clippedVerticesItems=core.Utils.setArraySize(clippedVertices,s+clipOutputCount*vertexSize),ii=0;ii<clipOutputLength;ii+=2){var x=clipOutputItems[ii],y=clipOutputItems[ii+1];clippedVerticesItems[s]=x,clippedVerticesItems[s+1]=y,clippedVerticesItems[s+2]=light.r,clippedVerticesItems[s+3]=light.g,clippedVerticesItems[s+4]=light.b,clippedVerticesItems[s+5]=light.a;var c0=x-x3,c1=y-y3,a=(d0*c0+d1*c1)*d,b=(d4*c0+d2*c1)*d,c=1-a-b;clippedVerticesItems[s+6]=u1*a+u2*b+u3*c,clippedVerticesItems[s+7]=v1*a+v2*b+v3*c,twoColor&&(clippedVerticesItems[s+8]=dark.r,clippedVerticesItems[s+9]=dark.g,clippedVerticesItems[s+10]=dark.b,clippedVerticesItems[s+11]=dark.a),s+=vertexSize}s=clippedTriangles.length;var clippedTrianglesItems=core.Utils.setArraySize(clippedTriangles,s+3*(clipOutputCount-2));clipOutputCount--;for(ii=1;ii<clipOutputCount;ii++)clippedTrianglesItems[s]=index,clippedTrianglesItems[s+1]=index+ii,clippedTrianglesItems[s+2]=index+ii+1,s+=3;index+=clipOutputCount+1}}},SkeletonClipping.prototype.clip=function(x1,y1,x2,y2,x3,y3,clippingArea,output){var originalOutput=output,clipped=!1,input=null;2<=clippingArea.length%4?(input=output,output=this.scratch):input=this.scratch,input.length=0,input.push(x1),input.push(y1),input.push(x2),input.push(y2),input.push(x3),input.push(y3),input.push(x1),input.push(y1),output.length=0;for(var clippingVertices=clippingArea,clippingVerticesLast=clippingArea.length-4,i=0;;i+=2){for(var edgeX=clippingVertices[i],edgeY=clippingVertices[i+1],edgeX2=clippingVertices[i+2],edgeY2=clippingVertices[i+3],deltaX=edgeX-edgeX2,deltaY=edgeY-edgeY2,inputVertices=input,inputVerticesLength=input.length-2,outputStart=output.length,ii=0;ii<inputVerticesLength;ii+=2){var inputX=inputVertices[ii],inputY=inputVertices[ii+1],inputX2=inputVertices[ii+2],inputY2=inputVertices[ii+3],side2=0<deltaX*(inputY2-edgeY2)-deltaY*(inputX2-edgeX2);if(0<deltaX*(inputY-edgeY2)-deltaY*(inputX-edgeX2)){if(side2){output.push(inputX2),output.push(inputY2);continue}var ua=((c2=inputX2-inputX)*(edgeY-inputY)-(c0=inputY2-inputY)*(edgeX-inputX))/(c0*(edgeX2-edgeX)-c2*(edgeY2-edgeY));output.push(edgeX+(edgeX2-edgeX)*ua),output.push(edgeY+(edgeY2-edgeY)*ua)}else if(side2){var c0,c2;ua=((c2=inputX2-inputX)*(edgeY-inputY)-(c0=inputY2-inputY)*(edgeX-inputX))/(c0*(edgeX2-edgeX)-c2*(edgeY2-edgeY));output.push(edgeX+(edgeX2-edgeX)*ua),output.push(edgeY+(edgeY2-edgeY)*ua),output.push(inputX2),output.push(inputY2)}clipped=!0}if(outputStart==output.length)return!(originalOutput.length=0);if(output.push(output[0]),output.push(output[1]),i==clippingVerticesLast)break;var temp=output;(output=input).length=0,input=temp}if(originalOutput!=output){i=originalOutput.length=0;for(var n=output.length-2;i<n;i++)originalOutput[i]=output[i]}else originalOutput.length=originalOutput.length-2;return clipped},SkeletonClipping.makeClockwise=function(polygon){for(var vertices=polygon,verticeslength=polygon.length,area=vertices[verticeslength-2]*vertices[1]-vertices[0]*vertices[verticeslength-1],p1x=0,p1y=0,p2x=0,i=0,n=verticeslength-3;i<n;i+=2)p1x=vertices[i],p1y=vertices[i+1],p2x=vertices[i+2],area+=p1x*vertices[i+3]-p2x*p1y;if(!(area<0)){i=0;var lastX=verticeslength-2;for(n=verticeslength>>1;i<n;i+=2){var x=vertices[i],y=vertices[i+1],other=lastX-i;vertices[i]=vertices[other],vertices[i+1]=vertices[1+other],vertices[other]=x,vertices[1+other]=y}}},SkeletonClipping}();core.SkeletonClipping=SkeletonClipping}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var SkeletonData=function(){function SkeletonData(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return SkeletonData.prototype.findBone=function(boneName){if(null==boneName)throw new Error("boneName cannot be null.");for(var bones=this.bones,i=0,n=bones.length;i<n;i++){var bone=bones[i];if(bone.name==boneName)return bone}return null},SkeletonData.prototype.findBoneIndex=function(boneName){if(null==boneName)throw new Error("boneName cannot be null.");for(var bones=this.bones,i=0,n=bones.length;i<n;i++)if(bones[i].name==boneName)return i;return-1},SkeletonData.prototype.findSlot=function(slotName){if(null==slotName)throw new Error("slotName cannot be null.");for(var slots=this.slots,i=0,n=slots.length;i<n;i++){var slot=slots[i];if(slot.name==slotName)return slot}return null},SkeletonData.prototype.findSlotIndex=function(slotName){if(null==slotName)throw new Error("slotName cannot be null.");for(var slots=this.slots,i=0,n=slots.length;i<n;i++)if(slots[i].name==slotName)return i;return-1},SkeletonData.prototype.findSkin=function(skinName){if(null==skinName)throw new Error("skinName cannot be null.");for(var skins=this.skins,i=0,n=skins.length;i<n;i++){var skin=skins[i];if(skin.name==skinName)return skin}return null},SkeletonData.prototype.findEvent=function(eventDataName){if(null==eventDataName)throw new Error("eventDataName cannot be null.");for(var events=this.events,i=0,n=events.length;i<n;i++){var event_4=events[i];if(event_4.name==eventDataName)return event_4}return null},SkeletonData.prototype.findAnimation=function(animationName){if(null==animationName)throw new Error("animationName cannot be null.");for(var animations=this.animations,i=0,n=animations.length;i<n;i++){var animation=animations[i];if(animation.name==animationName)return animation}return null},SkeletonData.prototype.findIkConstraint=function(constraintName){if(null==constraintName)throw new Error("constraintName cannot be null.");for(var ikConstraints=this.ikConstraints,i=0,n=ikConstraints.length;i<n;i++){var constraint=ikConstraints[i];if(constraint.name==constraintName)return constraint}return null},SkeletonData.prototype.findTransformConstraint=function(constraintName){if(null==constraintName)throw new Error("constraintName cannot be null.");for(var transformConstraints=this.transformConstraints,i=0,n=transformConstraints.length;i<n;i++){var constraint=transformConstraints[i];if(constraint.name==constraintName)return constraint}return null},SkeletonData.prototype.findPathConstraint=function(constraintName){if(null==constraintName)throw new Error("constraintName cannot be null.");for(var pathConstraints=this.pathConstraints,i=0,n=pathConstraints.length;i<n;i++){var constraint=pathConstraints[i];if(constraint.name==constraintName)return constraint}return null},SkeletonData.prototype.findPathConstraintIndex=function(pathConstraintName){if(null==pathConstraintName)throw new Error("pathConstraintName cannot be null.");for(var pathConstraints=this.pathConstraints,i=0,n=pathConstraints.length;i<n;i++)if(pathConstraints[i].name==pathConstraintName)return i;return-1},SkeletonData}();core.SkeletonData=SkeletonData}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var SkeletonJson=function(){function SkeletonJson(attachmentLoader){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=attachmentLoader}return SkeletonJson.prototype.readSkeletonData=function(json){var scale=this.scale,skeletonData=new core.SkeletonData,root="string"==typeof json?JSON.parse(json):json,skeletonMap=root.skeleton;if(null!=skeletonMap&&(skeletonData.hash=skeletonMap.hash,skeletonData.version=skeletonMap.spine,skeletonData.width=skeletonMap.width,skeletonData.height=skeletonMap.height,skeletonData.fps=skeletonMap.fps,skeletonData.imagesPath=skeletonMap.images),root.bones)for(var i=0;i<root.bones.length;i++){var boneMap=root.bones[i],parent_2=null,parentName=this.getValue(boneMap,"parent",null);if(null!=parentName&&null==(parent_2=skeletonData.findBone(parentName)))throw new Error("Parent bone not found: "+parentName);(data=new core.BoneData(skeletonData.bones.length,boneMap.name,parent_2)).length=this.getValue(boneMap,"length",0)*scale,data.x=this.getValue(boneMap,"x",0)*scale,data.y=this.getValue(boneMap,"y",0)*scale,data.rotation=this.getValue(boneMap,"rotation",0),data.scaleX=this.getValue(boneMap,"scaleX",1),data.scaleY=this.getValue(boneMap,"scaleY",1),data.shearX=this.getValue(boneMap,"shearX",0),data.shearY=this.getValue(boneMap,"shearY",0),data.transformMode=SkeletonJson.transformModeFromString(this.getValue(boneMap,"transform","normal")),skeletonData.bones.push(data)}if(root.slots)for(i=0;i<root.slots.length;i++){var slotName=(slotMap=root.slots[i]).name,boneName=slotMap.bone,boneData=skeletonData.findBone(boneName);if(null==boneData)throw new Error("Slot bone not found: "+boneName);var data=new core.SlotData(skeletonData.slots.length,slotName,boneData),color=this.getValue(slotMap,"color",null);null!=color&&data.color.setFromString(color);var dark=this.getValue(slotMap,"dark",null);null!=dark&&(data.darkColor=new core.Color(1,1,1,1),data.darkColor.setFromString(dark)),data.attachmentName=this.getValue(slotMap,"attachment",null),data.blendMode=SkeletonJson.blendModeFromString(this.getValue(slotMap,"blend","normal")),skeletonData.slots.push(data)}if(root.ik)for(i=0;i<root.ik.length;i++){var constraintMap=root.ik[i];(data=new core.IkConstraintData(constraintMap.name)).order=this.getValue(constraintMap,"order",0);for(var j=0;j<constraintMap.bones.length;j++){boneName=constraintMap.bones[j];if(null==(bone=skeletonData.findBone(boneName)))throw new Error("IK bone not found: "+boneName);data.bones.push(bone)}var targetName=constraintMap.target;if(data.target=skeletonData.findBone(targetName),null==data.target)throw new Error("IK target bone not found: "+targetName);data.bendDirection=this.getValue(constraintMap,"bendPositive",!0)?1:-1,data.mix=this.getValue(constraintMap,"mix",1),skeletonData.ikConstraints.push(data)}if(root.transform)for(i=0;i<root.transform.length;i++){constraintMap=root.transform[i];(data=new core.TransformConstraintData(constraintMap.name)).order=this.getValue(constraintMap,"order",0);for(j=0;j<constraintMap.bones.length;j++){boneName=constraintMap.bones[j];if(null==(bone=skeletonData.findBone(boneName)))throw new Error("Transform constraint bone not found: "+boneName);data.bones.push(bone)}targetName=constraintMap.target;if(data.target=skeletonData.findBone(targetName),null==data.target)throw new Error("Transform constraint target bone not found: "+targetName);data.local=this.getValue(constraintMap,"local",!1),data.relative=this.getValue(constraintMap,"relative",!1),data.offsetRotation=this.getValue(constraintMap,"rotation",0),data.offsetX=this.getValue(constraintMap,"x",0)*scale,data.offsetY=this.getValue(constraintMap,"y",0)*scale,data.offsetScaleX=this.getValue(constraintMap,"scaleX",0),data.offsetScaleY=this.getValue(constraintMap,"scaleY",0),data.offsetShearY=this.getValue(constraintMap,"shearY",0),data.rotateMix=this.getValue(constraintMap,"rotateMix",1),data.translateMix=this.getValue(constraintMap,"translateMix",1),data.scaleMix=this.getValue(constraintMap,"scaleMix",1),data.shearMix=this.getValue(constraintMap,"shearMix",1),skeletonData.transformConstraints.push(data)}if(root.path)for(i=0;i<root.path.length;i++){constraintMap=root.path[i];(data=new core.PathConstraintData(constraintMap.name)).order=this.getValue(constraintMap,"order",0);for(j=0;j<constraintMap.bones.length;j++){var bone;boneName=constraintMap.bones[j];if(null==(bone=skeletonData.findBone(boneName)))throw new Error("Transform constraint bone not found: "+boneName);data.bones.push(bone)}targetName=constraintMap.target;if(data.target=skeletonData.findSlot(targetName),null==data.target)throw new Error("Path target slot not found: "+targetName);data.positionMode=SkeletonJson.positionModeFromString(this.getValue(constraintMap,"positionMode","percent")),data.spacingMode=SkeletonJson.spacingModeFromString(this.getValue(constraintMap,"spacingMode","length")),data.rotateMode=SkeletonJson.rotateModeFromString(this.getValue(constraintMap,"rotateMode","tangent")),data.offsetRotation=this.getValue(constraintMap,"rotation",0),data.position=this.getValue(constraintMap,"position",0),data.positionMode==core.PositionMode.Fixed&&(data.position*=scale),data.spacing=this.getValue(constraintMap,"spacing",0),data.spacingMode!=core.SpacingMode.Length&&data.spacingMode!=core.SpacingMode.Fixed||(data.spacing*=scale),data.rotateMix=this.getValue(constraintMap,"rotateMix",1),data.translateMix=this.getValue(constraintMap,"translateMix",1),skeletonData.pathConstraints.push(data)}if(root.skins)for(var skinName in root.skins){var skinMap=root.skins[skinName],skin=new core.Skin(skinName);for(var slotName in skinMap){var slotIndex=skeletonData.findSlotIndex(slotName);if(-1==slotIndex)throw new Error("Slot not found: "+slotName);var slotMap=skinMap[slotName];for(var entryName in slotMap){var attachment=this.readAttachment(slotMap[entryName],skin,slotIndex,entryName,skeletonData);null!=attachment&&skin.addAttachment(slotIndex,entryName,attachment)}}skeletonData.skins.push(skin),"default"==skin.name&&(skeletonData.defaultSkin=skin)}i=0;for(var n=this.linkedMeshes.length;i<n;i++){var linkedMesh=this.linkedMeshes[i];if(null==(skin=null==linkedMesh.skin?skeletonData.defaultSkin:skeletonData.findSkin(linkedMesh.skin)))throw new Error("Skin not found: "+linkedMesh.skin);var parent_3=skin.getAttachment(linkedMesh.slotIndex,linkedMesh.parent);if(null==parent_3)throw new Error("Parent mesh not found: "+linkedMesh.parent);linkedMesh.mesh.setParentMesh(parent_3)}if(this.linkedMeshes.length=0,root.events)for(var eventName in root.events){var eventMap=root.events[eventName];(data=new core.EventData(eventName)).intValue=this.getValue(eventMap,"int",0),data.floatValue=this.getValue(eventMap,"float",0),data.stringValue=this.getValue(eventMap,"string",""),data.audioPath=this.getValue(eventMap,"audio",null),null!=data.audioPath&&(data.volume=this.getValue(eventMap,"volume",1),data.balance=this.getValue(eventMap,"balance",0)),skeletonData.events.push(data)}if(root.animations)for(var animationName in root.animations){var animationMap=root.animations[animationName];this.readAnimation(animationMap,animationName,skeletonData)}return skeletonData},SkeletonJson.prototype.readAttachment=function(map,skin,slotIndex,name,skeletonData){var scale=this.scale;switch(name=this.getValue(map,"name",name),this.getValue(map,"type","region")){case"region":var path=this.getValue(map,"path",name),region=this.attachmentLoader.newRegionAttachment(skin,name,path);return null==region?null:(region.path=path,region.x=this.getValue(map,"x",0)*scale,region.y=this.getValue(map,"y",0)*scale,region.scaleX=this.getValue(map,"scaleX",1),region.scaleY=this.getValue(map,"scaleY",1),region.rotation=this.getValue(map,"rotation",0),region.width=map.width*scale,region.height=map.height*scale,null!=(color=this.getValue(map,"color",null))&&region.color.setFromString(color),region);case"boundingbox":var box=this.attachmentLoader.newBoundingBoxAttachment(skin,name);return null==box?null:(this.readVertices(map,box,map.vertexCount<<1),null!=(color=this.getValue(map,"color",null))&&box.color.setFromString(color),box);case"mesh":case"linkedmesh":path=this.getValue(map,"path",name);var mesh=this.attachmentLoader.newMeshAttachment(skin,name,path);if(null==mesh)return null;mesh.path=path,null!=(color=this.getValue(map,"color",null))&&mesh.color.setFromString(color);var parent_4=this.getValue(map,"parent",null);if(null!=parent_4)return mesh.inheritDeform=this.getValue(map,"deform",!0),this.linkedMeshes.push(new LinkedMesh(mesh,this.getValue(map,"skin",null),slotIndex,parent_4)),mesh;var uvs=map.uvs;return this.readVertices(map,mesh,uvs.length),mesh.triangles=map.triangles,mesh.regionUVs=uvs,mesh.hullLength=2*this.getValue(map,"hull",0),mesh;case"path":if(null==(path=this.attachmentLoader.newPathAttachment(skin,name)))return null;path.closed=this.getValue(map,"closed",!1),path.constantSpeed=this.getValue(map,"constantSpeed",!0);var vertexCount=map.vertexCount;this.readVertices(map,path,vertexCount<<1);for(var lengths=core.Utils.newArray(vertexCount/3,0),i=0;i<map.lengths.length;i++)lengths[i]=map.lengths[i]*scale;return path.lengths=lengths,null!=(color=this.getValue(map,"color",null))&&path.color.setFromString(color),path;case"point":var point=this.attachmentLoader.newPointAttachment(skin,name);return null==point?null:(point.x=this.getValue(map,"x",0)*scale,point.y=this.getValue(map,"y",0)*scale,point.rotation=this.getValue(map,"rotation",0),null!=(color=this.getValue(map,"color",null))&&point.color.setFromString(color),point);case"clipping":var clip=this.attachmentLoader.newClippingAttachment(skin,name);if(null==clip)return null;var end=this.getValue(map,"end",null);if(null!=end){var slot=skeletonData.findSlot(end);if(null==slot)throw new Error("Clipping end slot not found: "+end);clip.endSlot=slot}var color;vertexCount=map.vertexCount;return this.readVertices(map,clip,vertexCount<<1),null!=(color=this.getValue(map,"color",null))&&clip.color.setFromString(color),clip}return null},SkeletonJson.prototype.readVertices=function(map,attachment,verticesLength){var scale=this.scale;attachment.worldVerticesLength=verticesLength;var vertices=map.vertices;if(verticesLength!=vertices.length){var weights=new Array,bones=new Array;for(i=0,n=vertices.length;i<n;){var boneCount=vertices[i++];bones.push(boneCount);for(var nn=i+4*boneCount;i<nn;i+=4)bones.push(vertices[i]),weights.push(vertices[i+1]*scale),weights.push(vertices[i+2]*scale),weights.push(vertices[i+3])}attachment.bones=bones,attachment.vertices=core.Utils.toFloatArray(weights)}else{var scaledVertices=core.Utils.toFloatArray(vertices);if(1!=scale)for(var i=0,n=vertices.length;i<n;i++)scaledVertices[i]*=scale;attachment.vertices=scaledVertices}},SkeletonJson.prototype.readAnimation=function(map,name,skeletonData){var scale=this.scale,timelines=new Array,duration=0;if(map.slots)for(var slotName in map.slots){var slotMap=map.slots[slotName];if(-1==(slotIndex=skeletonData.findSlotIndex(slotName)))throw new Error("Slot not found: "+slotName);for(var timelineName in slotMap){var timelineMap=slotMap[timelineName];if("attachment"==timelineName){(timeline=new core.AttachmentTimeline(timelineMap.length)).slotIndex=slotIndex;for(var frameIndex=0,i=0;i<timelineMap.length;i++){var valueMap=timelineMap[i];timeline.setFrame(frameIndex++,valueMap.time,valueMap.name)}timelines.push(timeline),duration=Math.max(duration,timeline.frames[timeline.getFrameCount()-1])}else if("color"==timelineName){(timeline=new core.ColorTimeline(timelineMap.length)).slotIndex=slotIndex;for(frameIndex=0,i=0;i<timelineMap.length;i++){valueMap=timelineMap[i];var color=new core.Color;color.setFromString(valueMap.color||"ffffffff"),timeline.setFrame(frameIndex,valueMap.time,color.r,color.g,color.b,color.a),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[(timeline.getFrameCount()-1)*core.ColorTimeline.ENTRIES])}else{if("twoColor"!=timelineName)throw new Error("Invalid timeline type for a slot: "+timelineName+" ("+slotName+")");(timeline=new core.TwoColorTimeline(timelineMap.length)).slotIndex=slotIndex;for(frameIndex=0,i=0;i<timelineMap.length;i++){valueMap=timelineMap[i];var light=new core.Color,dark=new core.Color;light.setFromString(valueMap.light),dark.setFromString(valueMap.dark),timeline.setFrame(frameIndex,valueMap.time,light.r,light.g,light.b,light.a,dark.r,dark.g,dark.b),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[(timeline.getFrameCount()-1)*core.TwoColorTimeline.ENTRIES])}}}if(map.bones)for(var boneName in map.bones){var boneMap=map.bones[boneName],boneIndex=skeletonData.findBoneIndex(boneName);if(-1==boneIndex)throw new Error("Bone not found: "+boneName);for(var timelineName in boneMap){timelineMap=boneMap[timelineName];if("rotate"===timelineName){(timeline=new core.RotateTimeline(timelineMap.length)).boneIndex=boneIndex;for(frameIndex=0,i=0;i<timelineMap.length;i++){valueMap=timelineMap[i];timeline.setFrame(frameIndex,valueMap.time,valueMap.angle),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[(timeline.getFrameCount()-1)*core.RotateTimeline.ENTRIES])}else{if("translate"!==timelineName&&"scale"!==timelineName&&"shear"!==timelineName)throw new Error("Invalid timeline type for a bone: "+timelineName+" ("+boneName+")");var timeline=null,timelineScale=1;"scale"===timelineName?timeline=new core.ScaleTimeline(timelineMap.length):"shear"===timelineName?timeline=new core.ShearTimeline(timelineMap.length):(timeline=new core.TranslateTimeline(timelineMap.length),timelineScale=scale),timeline.boneIndex=boneIndex;for(frameIndex=0,i=0;i<timelineMap.length;i++){valueMap=timelineMap[i];var x=this.getValue(valueMap,"x",0),y=this.getValue(valueMap,"y",0);timeline.setFrame(frameIndex,valueMap.time,x*timelineScale,y*timelineScale),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[(timeline.getFrameCount()-1)*core.TranslateTimeline.ENTRIES])}}}if(map.ik)for(var constraintName in map.ik){var constraintMap=map.ik[constraintName],constraint=skeletonData.findIkConstraint(constraintName);(timeline=new core.IkConstraintTimeline(constraintMap.length)).ikConstraintIndex=skeletonData.ikConstraints.indexOf(constraint);for(frameIndex=0,i=0;i<constraintMap.length;i++){valueMap=constraintMap[i];timeline.setFrame(frameIndex,valueMap.time,this.getValue(valueMap,"mix",1),this.getValue(valueMap,"bendPositive",!0)?1:-1,this.getValue(valueMap,"compress",!1),this.getValue(valueMap,"stretch",!1)),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[(timeline.getFrameCount()-1)*core.IkConstraintTimeline.ENTRIES])}if(map.transform)for(var constraintName in map.transform){constraintMap=map.transform[constraintName],constraint=skeletonData.findTransformConstraint(constraintName);(timeline=new core.TransformConstraintTimeline(constraintMap.length)).transformConstraintIndex=skeletonData.transformConstraints.indexOf(constraint);for(frameIndex=0,i=0;i<constraintMap.length;i++){valueMap=constraintMap[i];timeline.setFrame(frameIndex,valueMap.time,this.getValue(valueMap,"rotateMix",1),this.getValue(valueMap,"translateMix",1),this.getValue(valueMap,"scaleMix",1),this.getValue(valueMap,"shearMix",1)),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[(timeline.getFrameCount()-1)*core.TransformConstraintTimeline.ENTRIES])}if(map.paths)for(var constraintName in map.paths){constraintMap=map.paths[constraintName];var index=skeletonData.findPathConstraintIndex(constraintName);if(-1==index)throw new Error("Path constraint not found: "+constraintName);var data=skeletonData.pathConstraints[index];for(var timelineName in constraintMap){timelineMap=constraintMap[timelineName];if("position"===timelineName||"spacing"===timelineName){timeline=null,timelineScale=1;"spacing"===timelineName?(timeline=new core.PathConstraintSpacingTimeline(timelineMap.length),data.spacingMode!=core.SpacingMode.Length&&data.spacingMode!=core.SpacingMode.Fixed||(timelineScale=scale)):(timeline=new core.PathConstraintPositionTimeline(timelineMap.length),data.positionMode==core.PositionMode.Fixed&&(timelineScale=scale)),timeline.pathConstraintIndex=index;for(frameIndex=0,i=0;i<timelineMap.length;i++){valueMap=timelineMap[i];timeline.setFrame(frameIndex,valueMap.time,this.getValue(valueMap,timelineName,0)*timelineScale),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[(timeline.getFrameCount()-1)*core.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===timelineName){(timeline=new core.PathConstraintMixTimeline(timelineMap.length)).pathConstraintIndex=index;for(frameIndex=0,i=0;i<timelineMap.length;i++){valueMap=timelineMap[i];timeline.setFrame(frameIndex,valueMap.time,this.getValue(valueMap,"rotateMix",1),this.getValue(valueMap,"translateMix",1)),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[(timeline.getFrameCount()-1)*core.PathConstraintMixTimeline.ENTRIES])}}}if(map.deform)for(var deformName in map.deform){var deformMap=map.deform[deformName],skin=skeletonData.findSkin(deformName);if(null==skin)throw new Error("Skin not found: "+deformName);for(var slotName in deformMap){slotMap=deformMap[slotName];if(-1==(slotIndex=skeletonData.findSlotIndex(slotName)))throw new Error("Slot not found: "+slotMap.name);for(var timelineName in slotMap){timelineMap=slotMap[timelineName];var attachment=skin.getAttachment(slotIndex,timelineName);if(null==attachment)throw new Error("Deform attachment not found: "+timelineMap.name);var weighted=null!=attachment.bones,vertices=attachment.vertices,deformLength=weighted?vertices.length/3*2:vertices.length;(timeline=new core.DeformTimeline(timelineMap.length)).slotIndex=slotIndex,timeline.attachment=attachment;frameIndex=0;for(var j=0;j<timelineMap.length;j++){valueMap=timelineMap[j];var deform=void 0,verticesValue=this.getValue(valueMap,"vertices",null);if(null==verticesValue)deform=weighted?core.Utils.newFloatArray(deformLength):vertices;else{deform=core.Utils.newFloatArray(deformLength);var start=this.getValue(valueMap,"offset",0);if(core.Utils.arrayCopy(verticesValue,0,deform,start,verticesValue.length),1!=scale)for(var n=(i=start)+verticesValue.length;i<n;i++)deform[i]*=scale;if(!weighted)for(i=0;i<deformLength;i++)deform[i]+=vertices[i]}timeline.setFrame(frameIndex,valueMap.time,deform),this.readCurve(valueMap,timeline,frameIndex),frameIndex++}timelines.push(timeline),duration=Math.max(duration,timeline.frames[timeline.getFrameCount()-1])}}}var drawOrderNode=map.drawOrder;if(null==drawOrderNode&&(drawOrderNode=map.draworder),null!=drawOrderNode){timeline=new core.DrawOrderTimeline(drawOrderNode.length);var slotCount=skeletonData.slots.length;for(frameIndex=0,j=0;j<drawOrderNode.length;j++){var drawOrderMap=drawOrderNode[j],drawOrder=null,offsets=this.getValue(drawOrderMap,"offsets",null);if(null!=offsets){drawOrder=core.Utils.newArray(slotCount,-1);var unchanged=core.Utils.newArray(slotCount-offsets.length,0),originalIndex=0,unchangedIndex=0;for(i=0;i<offsets.length;i++){var slotIndex,offsetMap=offsets[i];if(-1==(slotIndex=skeletonData.findSlotIndex(offsetMap.slot)))throw new Error("Slot not found: "+offsetMap.slot);for(;originalIndex!=slotIndex;)unchanged[unchangedIndex++]=originalIndex++;drawOrder[originalIndex+offsetMap.offset]=originalIndex++}for(;originalIndex<slotCount;)unchanged[unchangedIndex++]=originalIndex++;for(i=slotCount-1;0<=i;i--)-1==drawOrder[i]&&(drawOrder[i]=unchanged[--unchangedIndex])}timeline.setFrame(frameIndex++,drawOrderMap.time,drawOrder)}timelines.push(timeline),duration=Math.max(duration,timeline.frames[timeline.getFrameCount()-1])}if(map.events){for(timeline=new core.EventTimeline(map.events.length),frameIndex=0,i=0;i<map.events.length;i++){var eventMap=map.events[i],eventData=skeletonData.findEvent(eventMap.name);if(null==eventData)throw new Error("Event not found: "+eventMap.name);var event_5=new core.Event(core.Utils.toSinglePrecision(eventMap.time),eventData);event_5.intValue=this.getValue(eventMap,"int",eventData.intValue),event_5.floatValue=this.getValue(eventMap,"float",eventData.floatValue),event_5.stringValue=this.getValue(eventMap,"string",eventData.stringValue),null!=event_5.data.audioPath&&(event_5.volume=this.getValue(eventMap,"volume",1),event_5.balance=this.getValue(eventMap,"balance",0)),timeline.setFrame(frameIndex++,event_5)}timelines.push(timeline),duration=Math.max(duration,timeline.frames[timeline.getFrameCount()-1])}if(isNaN(duration))throw new Error("Error while parsing animation, duration is NaN");skeletonData.animations.push(new core.Animation(name,timelines,duration))},SkeletonJson.prototype.readCurve=function(map,timeline,frameIndex){if(map.curve)if("stepped"===map.curve)timeline.setStepped(frameIndex);else if("[object Array]"===Object.prototype.toString.call(map.curve)){var curve=map.curve;timeline.setCurve(frameIndex,curve[0],curve[1],curve[2],curve[3])}},SkeletonJson.prototype.getValue=function(map,prop,defaultValue){return void 0!==map[prop]?map[prop]:defaultValue},SkeletonJson.blendModeFromString=function(str){if("normal"==(str=str.toLowerCase()))return core.BlendMode.Normal;if("additive"==str)return core.BlendMode.Additive;if("multiply"==str)return core.BlendMode.Multiply;if("screen"==str)return core.BlendMode.Screen;throw new Error("Unknown blend mode: "+str)},SkeletonJson.positionModeFromString=function(str){if("fixed"==(str=str.toLowerCase()))return core.PositionMode.Fixed;if("percent"==str)return core.PositionMode.Percent;throw new Error("Unknown position mode: "+str)},SkeletonJson.spacingModeFromString=function(str){if("length"==(str=str.toLowerCase()))return core.SpacingMode.Length;if("fixed"==str)return core.SpacingMode.Fixed;if("percent"==str)return core.SpacingMode.Percent;throw new Error("Unknown position mode: "+str)},SkeletonJson.rotateModeFromString=function(str){if("tangent"==(str=str.toLowerCase()))return core.RotateMode.Tangent;if("chain"==str)return core.RotateMode.Chain;if("chainscale"==str)return core.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+str)},SkeletonJson.transformModeFromString=function(str){if("normal"==(str=str.toLowerCase()))return core.TransformMode.Normal;if("onlytranslation"==str)return core.TransformMode.OnlyTranslation;if("norotationorreflection"==str)return core.TransformMode.NoRotationOrReflection;if("noscale"==str)return core.TransformMode.NoScale;if("noscaleorreflection"==str)return core.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+str)},SkeletonJson}();core.SkeletonJson=SkeletonJson;var LinkedMesh=function(mesh,skin,slotIndex,parent){this.mesh=mesh,this.skin=skin,this.slotIndex=slotIndex,this.parent=parent}}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var Skin=function(){function Skin(name){if(this.attachments=new Array,null==name)throw new Error("name cannot be null.");this.name=name}return Skin.prototype.addAttachment=function(slotIndex,name,attachment){if(null==attachment)throw new Error("attachment cannot be null.");var attachments=this.attachments;slotIndex>=attachments.length&&(attachments.length=slotIndex+1),attachments[slotIndex]||(attachments[slotIndex]={}),attachments[slotIndex][name]=attachment},Skin.prototype.getAttachment=function(slotIndex,name){var dictionary=this.attachments[slotIndex];return dictionary?dictionary[name]:null},Skin.prototype.attachAll=function(skeleton,oldSkin){for(var slotIndex=0,i=0;i<skeleton.slots.length;i++){var slot=skeleton.slots[i],slotAttachment=slot.getAttachment();if(slotAttachment&&slotIndex<oldSkin.attachments.length){var dictionary=oldSkin.attachments[slotIndex];for(var key in dictionary){if(slotAttachment==dictionary[key]){var attachment=this.getAttachment(slotIndex,key);null!=attachment&&slot.setAttachment(attachment);break}}}slotIndex++}},Skin}();core.Skin=Skin}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var Slot=function(){function Slot(data,bone){if(this.attachmentVertices=new Array,null==data)throw new Error("data cannot be null.");if(null==bone)throw new Error("bone cannot be null.");this.data=data,this.bone=bone,this.color=new core.Color,this.darkColor=null==data.darkColor?null:new core.Color,this.setToSetupPose(),this.blendMode=this.data.blendMode}return Slot.prototype.getAttachment=function(){return this.attachment},Slot.prototype.setAttachment=function(attachment){this.attachment!=attachment&&(this.attachment=attachment,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},Slot.prototype.setAttachmentTime=function(time){this.attachmentTime=this.bone.skeleton.time-time},Slot.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},Slot.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},Slot}();core.Slot=Slot}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){function SlotData(index,name,boneData){if(this.color=new core.Color(1,1,1,1),index<0)throw new Error("index must be >= 0.");if(null==name)throw new Error("name cannot be null.");if(null==boneData)throw new Error("boneData cannot be null.");this.index=index,this.name=name,this.boneData=boneData}core.SlotData=SlotData}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var TextureFilter,TextureWrap,Texture=function(){function Texture(image){this._image=image}return Texture.prototype.getImage=function(){return this._image},Texture.filterFromString=function(text){switch(text.toLowerCase()){case"nearest":return TextureFilter.Nearest;case"linear":return TextureFilter.Linear;case"mipmap":return TextureFilter.MipMap;case"mipmapnearestnearest":return TextureFilter.MipMapNearestNearest;case"mipmaplinearnearest":return TextureFilter.MipMapLinearNearest;case"mipmapnearestlinear":return TextureFilter.MipMapNearestLinear;case"mipmaplinearlinear":return TextureFilter.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+text)}},Texture.wrapFromString=function(text){switch(text.toLowerCase()){case"mirroredtepeat":return TextureWrap.MirroredRepeat;case"clamptoedge":return TextureWrap.ClampToEdge;case"repeat":return TextureWrap.Repeat;default:throw new Error("Unknown texture wrap "+text)}},Texture}();core.Texture=Texture,function(TextureFilter){TextureFilter[TextureFilter.Nearest=9728]="Nearest",TextureFilter[TextureFilter.Linear=9729]="Linear",TextureFilter[TextureFilter.MipMap=9987]="MipMap",TextureFilter[TextureFilter.MipMapNearestNearest=9984]="MipMapNearestNearest",TextureFilter[TextureFilter.MipMapLinearNearest=9985]="MipMapLinearNearest",TextureFilter[TextureFilter.MipMapNearestLinear=9986]="MipMapNearestLinear",TextureFilter[TextureFilter.MipMapLinearLinear=9987]="MipMapLinearLinear"}(TextureFilter=core.TextureFilter||(core.TextureFilter={})),function(TextureWrap){TextureWrap[TextureWrap.MirroredRepeat=33648]="MirroredRepeat",TextureWrap[TextureWrap.ClampToEdge=33071]="ClampToEdge",TextureWrap[TextureWrap.Repeat=10497]="Repeat"}(TextureWrap=core.TextureWrap||(core.TextureWrap={}));var TextureRegion=function(){function TextureRegion(){this.size=null}return Object.defineProperty(TextureRegion.prototype,"width",{get:function(){var tex=this.texture;return"3"==PIXI.VERSION[0]?tex.crop.width:tex.trim?tex.trim.width:tex.orig.width},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"height",{get:function(){var tex=this.texture;return"3"==PIXI.VERSION[0]?tex.crop.height:tex.trim?tex.trim.height:tex.orig.height},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"u",{get:function(){return this.texture._uvs.x0},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"v",{get:function(){return this.texture._uvs.y0},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"u2",{get:function(){return this.texture._uvs.x2},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"v2",{get:function(){return this.texture._uvs.y2},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"offsetX",{get:function(){var tex=this.texture;return tex.trim?tex.trim.x:0},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"offsetY",{get:function(){return console.warn("Deprecation Warning: @Hackerham: I guess, if you are using PIXI-SPINE ATLAS region.offsetY, you want a texture, right? Use region.texture from now on."),this.spineOffsetY},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"pixiOffsetY",{get:function(){var tex=this.texture;return tex.trim?tex.trim.y:0},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"spineOffsetY",{get:function(){var tex=this.texture;return this.originalHeight-this.height-(tex.trim?tex.trim.y:0)},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"originalWidth",{get:function(){var tex=this.texture;return"3"==PIXI.VERSION[0]?tex.trim?tex.trim.width:tex.crop.width:tex.orig.width},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"originalHeight",{get:function(){var tex=this.texture;return"3"==PIXI.VERSION[0]?tex.trim?tex.trim.height:tex.crop.height:tex.orig.height},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"x",{get:function(){return this.texture.frame.x},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"y",{get:function(){return this.texture.frame.y},enumerable:!0,configurable:!0}),Object.defineProperty(TextureRegion.prototype,"rotate",{get:function(){return 0!==this.texture.rotate},enumerable:!0,configurable:!0}),TextureRegion}();core.TextureRegion=TextureRegion}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var TextureAtlas=function(){function TextureAtlas(atlasText,textureLoader,callback){this.pages=new Array,this.regions=new Array,atlasText&&this.addSpineAtlas(atlasText,textureLoader,callback)}return TextureAtlas.prototype.addTexture=function(name,texture){for(var pages=this.pages,page=null,i=0;i<pages.length;i++)if(pages[i].baseTexture===texture.baseTexture){page=pages[i];break}if(null===page){(page=new TextureAtlasPage).name="texturePage";var baseTexture=texture.baseTexture;page.width=baseTexture.realWidth,page.height=baseTexture.realHeight,page.baseTexture=baseTexture,page.minFilter=page.magFilter=core.TextureFilter.Nearest,page.uWrap=core.TextureWrap.ClampToEdge,page.vWrap=core.TextureWrap.ClampToEdge,pages.push(page)}var region=new TextureAtlasRegion;return region.name=name,region.page=page,region.texture=texture,region.index=-1,this.regions.push(region),region},TextureAtlas.prototype.addTextureHash=function(textures,stripExtension){for(var key in textures)textures.hasOwnProperty(key)&&this.addTexture(stripExtension&&-1!==key.indexOf(".")?key.substr(0,key.lastIndexOf(".")):key,textures[key])},TextureAtlas.prototype.addSpineAtlas=function(atlasText,textureLoader,callback){return this.load(atlasText,textureLoader,callback)},TextureAtlas.prototype.load=function(atlasText,textureLoader,callback){var _this=this;if(null==textureLoader)throw new Error("textureLoader cannot be null.");var reader=new TextureAtlasReader(atlasText),tuple=new Array(4),page=null,iterateParser=function(){for(;;){var line=reader.readLine();if(null==line)return callback&&callback(_this);if(0==(line=line.trim()).length)page=null;else{if(!page){(page=new TextureAtlasPage).name=line,2==reader.readTuple(tuple)&&(page.width=parseInt(tuple[0]),page.height=parseInt(tuple[1]),reader.readTuple(tuple)),reader.readTuple(tuple),page.minFilter=core.Texture.filterFromString(tuple[0]),page.magFilter=core.Texture.filterFromString(tuple[1]);var direction=reader.readValue();page.uWrap=core.TextureWrap.ClampToEdge,page.vWrap=core.TextureWrap.ClampToEdge,"x"==direction?page.uWrap=core.TextureWrap.Repeat:"y"==direction?page.vWrap=core.TextureWrap.Repeat:"xy"==direction&&(page.uWrap=page.vWrap=core.TextureWrap.Repeat),textureLoader(line,function(texture){(page.baseTexture=texture).hasLoaded||(texture.width=page.width,texture.height=page.height),_this.pages.push(page),page.setFilters(),page.width&&page.height||(page.width=texture.realWidth,page.height=texture.realHeight,page.width&&page.height||console.log("ERROR spine atlas page "+page.name+": meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)")),iterateParser()}),_this.pages.push(page);break}var region=new TextureAtlasRegion;region.name=line,region.page=page;var rotate="true"==reader.readValue()?6:0;reader.readTuple(tuple);var x=parseInt(tuple[0]),y=parseInt(tuple[1]);reader.readTuple(tuple);var width=parseInt(tuple[0]),height=parseInt(tuple[1]),resolution=page.baseTexture.resolution;x/=resolution,y/=resolution,width/=resolution,height/=resolution;var frame=new PIXI.Rectangle(x,y,rotate?height:width,rotate?width:height);4==reader.readTuple(tuple)&&4==reader.readTuple(tuple)&&reader.readTuple(tuple);var originalWidth=parseInt(tuple[0])/resolution,originalHeight=parseInt(tuple[1])/resolution;reader.readTuple(tuple);var offsetX=parseInt(tuple[0])/resolution,offsetY=parseInt(tuple[1])/resolution,orig=new PIXI.Rectangle(0,0,originalWidth,originalHeight),trim=new PIXI.Rectangle(offsetX,originalHeight-height-offsetY,width,height);if("3"!=PIXI.VERSION[0])region.texture=new PIXI.Texture(region.page.baseTexture,frame,orig,trim,rotate);else{var frame2=new PIXI.Rectangle(x,y,width,height),crop=frame2.clone();trim.width=originalWidth,trim.height=originalHeight,region.texture=new PIXI.Texture(region.page.baseTexture,frame2,crop,trim,rotate)}region.index=parseInt(reader.readValue()),region.texture._updateUvs(),_this.regions.push(region)}}};iterateParser()},TextureAtlas.prototype.findRegion=function(name){for(var i=0;i<this.regions.length;i++)if(this.regions[i].name==name)return this.regions[i];return null},TextureAtlas.prototype.dispose=function(){for(var i=0;i<this.pages.length;i++)this.pages[i].baseTexture.dispose()},TextureAtlas}();core.TextureAtlas=TextureAtlas;var TextureAtlasReader=function(){function TextureAtlasReader(text){this.index=0,this.lines=text.split(/\r\n|\r|\n/)}return TextureAtlasReader.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},TextureAtlasReader.prototype.readValue=function(){var line=this.readLine(),colon=line.indexOf(":");if(-1==colon)throw new Error("Invalid line: "+line);return line.substring(colon+1).trim()},TextureAtlasReader.prototype.readTuple=function(tuple){var line=this.readLine(),colon=line.indexOf(":");if(-1==colon)throw new Error("Invalid line: "+line);for(var i=0,lastMatch=colon+1;i<3;i++){var comma=line.indexOf(",",lastMatch);if(-1==comma)break;tuple[i]=line.substr(lastMatch,comma-lastMatch).trim(),lastMatch=comma+1}return tuple[i]=line.substring(lastMatch).trim(),i+1},TextureAtlasReader}(),TextureAtlasPage=function(){function TextureAtlasPage(){}return TextureAtlasPage.prototype.setFilters=function(){var tex=this.baseTexture,filter=this.minFilter;filter==core.TextureFilter.Linear?tex.scaleMode=PIXI.SCALE_MODES.LINEAR:this.minFilter==core.TextureFilter.Nearest?tex.scaleMode=PIXI.SCALE_MODES.NEAREST:(tex.mipmap=!0,filter==core.TextureFilter.MipMapNearestNearest?tex.scaleMode=PIXI.SCALE_MODES.NEAREST:tex.scaleMode=PIXI.SCALE_MODES.LINEAR)},TextureAtlasPage}();core.TextureAtlasPage=TextureAtlasPage;var TextureAtlasRegion=function(_super){function TextureAtlasRegion(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TextureAtlasRegion,_super),TextureAtlasRegion}(core.TextureRegion);core.TextureAtlasRegion=TextureAtlasRegion}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var TransformConstraint=function(){function TransformConstraint(data,skeleton){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new core.Vector2,null==data)throw new Error("data cannot be null.");if(null==skeleton)throw new Error("skeleton cannot be null.");this.data=data,this.rotateMix=data.rotateMix,this.translateMix=data.translateMix,this.scaleMix=data.scaleMix,this.shearMix=data.shearMix,this.bones=new Array;for(var i=0;i<data.bones.length;i++)this.bones.push(skeleton.findBone(data.bones[i].name));this.target=skeleton.findBone(data.target.name)}return TransformConstraint.prototype.apply=function(){this.update()},TransformConstraint.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},TransformConstraint.prototype.applyAbsoluteWorld=function(){for(var rotateMix=this.rotateMix,translateMix=this.translateMix,scaleMix=this.scaleMix,shearMix=this.shearMix,target=this.target,targetMat=target.matrix,ta=targetMat.a,tb=targetMat.c,tc=targetMat.b,td=targetMat.d,degRadReflect=0<ta*td-tb*tc?core.MathUtils.degRad:-core.MathUtils.degRad,offsetRotation=this.data.offsetRotation*degRadReflect,offsetShearY=this.data.offsetShearY*degRadReflect,bones=this.bones,i=0,n=bones.length;i<n;i++){var bone=bones[i],modified=!1,mat=bone.matrix;if(0!=rotateMix){var a=mat.a,b=mat.c,c=mat.b,d=mat.d;(r=Math.atan2(tc,ta)-Math.atan2(c,a)+offsetRotation)>core.MathUtils.PI?r-=core.MathUtils.PI2:r<-core.MathUtils.PI&&(r+=core.MathUtils.PI2),r*=rotateMix;var cos=Math.cos(r),sin=Math.sin(r);mat.a=cos*a-sin*c,mat.c=cos*b-sin*d,mat.b=sin*a+cos*c,mat.d=sin*b+cos*d,modified=!0}if(0!=translateMix){var temp=this.temp;target.localToWorld(temp.set(this.data.offsetX,this.data.offsetY)),mat.tx+=(temp.x-mat.tx)*translateMix,mat.ty+=(temp.y-mat.ty)*translateMix,modified=!0}if(0<scaleMix){var s=Math.sqrt(mat.a*mat.a+mat.b*mat.b),ts=Math.sqrt(ta*ta+tc*tc);1e-5<s&&(s=(s+(ts-s+this.data.offsetScaleX)*scaleMix)/s),mat.a*=s,mat.b*=s,s=Math.sqrt(mat.c*mat.c+mat.d*mat.d),ts=Math.sqrt(tb*tb+td*td),1e-5<s&&(s=(s+(ts-s+this.data.offsetScaleY)*scaleMix)/s),mat.c*=s,mat.d*=s,modified=!0}if(0<shearMix){b=mat.c,d=mat.d;var r,by=Math.atan2(d,b);(r=Math.atan2(td,tb)-Math.atan2(tc,ta)-(by-Math.atan2(mat.b,mat.a)))>core.MathUtils.PI?r-=core.MathUtils.PI2:r<-core.MathUtils.PI&&(r+=core.MathUtils.PI2),r=by+(r+offsetShearY)*shearMix;s=Math.sqrt(b*b+d*d);mat.c=Math.cos(r)*s,mat.d=Math.sin(r)*s,modified=!0}modified&&(bone.appliedValid=!1)}},TransformConstraint.prototype.applyRelativeWorld=function(){for(var rotateMix=this.rotateMix,translateMix=this.translateMix,scaleMix=this.scaleMix,shearMix=this.shearMix,target=this.target,targetMat=target.matrix,ta=targetMat.a,tb=targetMat.c,tc=targetMat.b,td=targetMat.d,degRadReflect=0<ta*td-tb*tc?core.MathUtils.degRad:-core.MathUtils.degRad,offsetRotation=this.data.offsetRotation*degRadReflect,offsetShearY=this.data.offsetShearY*degRadReflect,bones=this.bones,i=0,n=bones.length;i<n;i++){var bone=bones[i],modified=!1,mat=bone.matrix;if(0!=rotateMix){var a=mat.a,b=mat.c,c=mat.b,d=mat.d;(r=Math.atan2(tc,ta)+offsetRotation)>core.MathUtils.PI?r-=core.MathUtils.PI2:r<-core.MathUtils.PI&&(r+=core.MathUtils.PI2),r*=rotateMix;var cos=Math.cos(r),sin=Math.sin(r);mat.a=cos*a-sin*c,mat.c=cos*b-sin*d,mat.b=sin*a+cos*c,mat.d=sin*b+cos*d,modified=!0}if(0!=translateMix){var temp=this.temp;target.localToWorld(temp.set(this.data.offsetX,this.data.offsetY)),mat.tx+=temp.x*translateMix,mat.ty+=temp.y*translateMix,modified=!0}if(0<scaleMix){var s=(Math.sqrt(ta*ta+tc*tc)-1+this.data.offsetScaleX)*scaleMix+1;mat.a*=s,mat.b*=s,s=(Math.sqrt(tb*tb+td*td)-1+this.data.offsetScaleY)*scaleMix+1,mat.c*=s,mat.d*=s,modified=!0}if(0<shearMix){var r;(r=Math.atan2(td,tb)-Math.atan2(tc,ta))>core.MathUtils.PI?r-=core.MathUtils.PI2:r<-core.MathUtils.PI&&(r+=core.MathUtils.PI2);b=mat.c,d=mat.d;r=Math.atan2(d,b)+(r-core.MathUtils.PI/2+offsetShearY)*shearMix;s=Math.sqrt(b*b+d*d);mat.c=Math.cos(r)*s,mat.d=Math.sin(r)*s,modified=!0}modified&&(bone.appliedValid=!1)}},TransformConstraint.prototype.applyAbsoluteLocal=function(){var rotateMix=this.rotateMix,translateMix=this.translateMix,scaleMix=this.scaleMix,shearMix=this.shearMix,target=this.target;target.appliedValid||target.updateAppliedTransform();for(var bones=this.bones,i=0,n=bones.length;i<n;i++){var bone=bones[i];bone.appliedValid||bone.updateAppliedTransform();var rotation=bone.arotation;if(0!=rotateMix){var r=target.arotation-rotation+this.data.offsetRotation;rotation+=(r-=360*(16384-(16384.499999999996-r/360|0)))*rotateMix}var x=bone.ax,y=bone.ay;0!=translateMix&&(x+=(target.ax-x+this.data.offsetX)*translateMix,y+=(target.ay-y+this.data.offsetY)*translateMix);var scaleX=bone.ascaleX,scaleY=bone.ascaleY;0<scaleMix&&(1e-5<scaleX&&(scaleX=(scaleX+(target.ascaleX-scaleX+this.data.offsetScaleX)*scaleMix)/scaleX),1e-5<scaleY&&(scaleY=(scaleY+(target.ascaleY-scaleY+this.data.offsetScaleY)*scaleMix)/scaleY));var shearY=bone.ashearY;if(0<shearMix){r=target.ashearY-shearY+this.data.offsetShearY;r-=360*(16384-(16384.499999999996-r/360|0)),bone.shearY+=r*shearMix}bone.updateWorldTransformWith(x,y,rotation,scaleX,scaleY,bone.ashearX,shearY)}},TransformConstraint.prototype.applyRelativeLocal=function(){var rotateMix=this.rotateMix,translateMix=this.translateMix,scaleMix=this.scaleMix,shearMix=this.shearMix,target=this.target;target.appliedValid||target.updateAppliedTransform();for(var bones=this.bones,i=0,n=bones.length;i<n;i++){var bone=bones[i];bone.appliedValid||bone.updateAppliedTransform();var rotation=bone.arotation;0!=rotateMix&&(rotation+=(target.arotation+this.data.offsetRotation)*rotateMix);var x=bone.ax,y=bone.ay;0!=translateMix&&(x+=(target.ax+this.data.offsetX)*translateMix,y+=(target.ay+this.data.offsetY)*translateMix);var scaleX=bone.ascaleX,scaleY=bone.ascaleY;0<scaleMix&&(1e-5<scaleX&&(scaleX*=(target.ascaleX-1+this.data.offsetScaleX)*scaleMix+1),1e-5<scaleY&&(scaleY*=(target.ascaleY-1+this.data.offsetScaleY)*scaleMix+1));var shearY=bone.ashearY;0<shearMix&&(shearY+=(target.ashearY+this.data.offsetShearY)*shearMix),bone.updateWorldTransformWith(x,y,rotation,scaleX,scaleY,bone.ashearX,shearY)}},TransformConstraint.prototype.getOrder=function(){return this.data.order},TransformConstraint}();core.TransformConstraint=TransformConstraint}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){function TransformConstraintData(name){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,null==name)throw new Error("name cannot be null.");this.name=name}core.TransformConstraintData=TransformConstraintData}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var Triangulator=function(){function Triangulator(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new core.Pool(function(){return new Array}),this.polygonIndicesPool=new core.Pool(function(){return new Array})}return Triangulator.prototype.triangulate=function(verticesArray){for(var vertices=verticesArray,vertexCount=verticesArray.length>>1,indices=this.indicesArray,i=indices.length=0;i<vertexCount;i++)indices[i]=i;for(var isConcave=this.isConcaveArray,n=(i=isConcave.length=0,vertexCount);i<n;++i)isConcave[i]=Triangulator.isConcave(i,vertexCount,vertices,indices);var triangles=this.triangles;for(triangles.length=0;3<vertexCount;){for(var previous=vertexCount-1,next=(i=0,1);;){outer:if(!isConcave[i]){for(var p1=indices[previous]<<1,p2=indices[i]<<1,p3=indices[next]<<1,p1x=vertices[p1],p1y=vertices[1+p1],p2x=vertices[p2],p2y=vertices[1+p2],p3x=vertices[p3],p3y=vertices[1+p3],ii=(next+1)%vertexCount;ii!=previous;ii=(ii+1)%vertexCount)if(isConcave[ii]){var v=indices[ii]<<1,vx=vertices[v],vy=vertices[1+v];if(Triangulator.positiveArea(p3x,p3y,p1x,p1y,vx,vy)&&Triangulator.positiveArea(p1x,p1y,p2x,p2y,vx,vy)&&Triangulator.positiveArea(p2x,p2y,p3x,p3y,vx,vy))break outer}break}if(0==next){do{if(!isConcave[i])break;i--}while(0<i);break}previous=i,next=((i=next)+1)%vertexCount}triangles.push(indices[(vertexCount+i-1)%vertexCount]),triangles.push(indices[i]),triangles.push(indices[(i+1)%vertexCount]),indices.splice(i,1),isConcave.splice(i,1);var previousIndex=(--vertexCount+i-1)%vertexCount,nextIndex=i==vertexCount?0:i;isConcave[previousIndex]=Triangulator.isConcave(previousIndex,vertexCount,vertices,indices),isConcave[nextIndex]=Triangulator.isConcave(nextIndex,vertexCount,vertices,indices)}return 3==vertexCount&&(triangles.push(indices[2]),triangles.push(indices[0]),triangles.push(indices[1])),triangles},Triangulator.prototype.decompose=function(verticesArray,triangles){var vertices=verticesArray,convexPolygons=this.convexPolygons;this.polygonPool.freeAll(convexPolygons),convexPolygons.length=0;var convexPolygonsIndices=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(convexPolygonsIndices),convexPolygonsIndices.length=0;var polygonIndices=this.polygonIndicesPool.obtain();polygonIndices.length=0;for(var polygon=this.polygonPool.obtain(),fanBaseIndex=-1,lastWinding=polygon.length=0,i=0,n=triangles.length;i<n;i+=3){var t1=triangles[i]<<1,t2=triangles[i+1]<<1,t3=triangles[i+2]<<1,x1=vertices[t1],y1=vertices[1+t1],x2=vertices[t2],y2=vertices[1+t2],x3=vertices[t3],y3=vertices[1+t3],merged=!1;if(fanBaseIndex==t1){var o=polygon.length-4,winding1=Triangulator.winding(polygon[o],polygon[o+1],polygon[o+2],polygon[o+3],x3,y3),winding2=Triangulator.winding(x3,y3,polygon[0],polygon[1],polygon[2],polygon[3]);winding1==lastWinding&&winding2==lastWinding&&(polygon.push(x3),polygon.push(y3),polygonIndices.push(t3),merged=!0)}merged||(0<polygon.length?(convexPolygons.push(polygon),convexPolygonsIndices.push(polygonIndices)):(this.polygonPool.free(polygon),this.polygonIndicesPool.free(polygonIndices)),(polygon=this.polygonPool.obtain()).length=0,polygon.push(x1),polygon.push(y1),polygon.push(x2),polygon.push(y2),polygon.push(x3),polygon.push(y3),(polygonIndices=this.polygonIndicesPool.obtain()).length=0,polygonIndices.push(t1),polygonIndices.push(t2),polygonIndices.push(t3),lastWinding=Triangulator.winding(x1,y1,x2,y2,x3,y3),fanBaseIndex=t1)}0<polygon.length&&(convexPolygons.push(polygon),convexPolygonsIndices.push(polygonIndices));for(i=0,n=convexPolygons.length;i<n;i++)if(0!=(polygonIndices=convexPolygonsIndices[i]).length)for(var firstIndex=polygonIndices[0],lastIndex=polygonIndices[polygonIndices.length-1],prevPrevX=(polygon=convexPolygons[i])[o=polygon.length-4],prevPrevY=polygon[o+1],prevX=polygon[o+2],prevY=polygon[o+3],firstX=polygon[0],firstY=polygon[1],secondX=polygon[2],secondY=polygon[3],winding=Triangulator.winding(prevPrevX,prevPrevY,prevX,prevY,firstX,firstY),ii=0;ii<n;ii++)if(ii!=i){var otherIndices=convexPolygonsIndices[ii];if(3==otherIndices.length){var otherFirstIndex=otherIndices[0],otherSecondIndex=otherIndices[1],otherLastIndex=otherIndices[2],otherPoly=convexPolygons[ii];x3=otherPoly[otherPoly.length-2],y3=otherPoly[otherPoly.length-1];if(otherFirstIndex==firstIndex&&otherSecondIndex==lastIndex){winding1=Triangulator.winding(prevPrevX,prevPrevY,prevX,prevY,x3,y3),winding2=Triangulator.winding(x3,y3,firstX,firstY,secondX,secondY);winding1==winding&&winding2==winding&&(otherPoly.length=0,otherIndices.length=0,polygon.push(x3),polygon.push(y3),polygonIndices.push(otherLastIndex),prevPrevX=prevX,prevPrevY=prevY,prevX=x3,prevY=y3,ii=0)}}}for(i=convexPolygons.length-1;0<=i;i--)0==(polygon=convexPolygons[i]).length&&(convexPolygons.splice(i,1),this.polygonPool.free(polygon),polygonIndices=convexPolygonsIndices[i],convexPolygonsIndices.splice(i,1),this.polygonIndicesPool.free(polygonIndices));return convexPolygons},Triangulator.isConcave=function(index,vertexCount,vertices,indices){var previous=indices[(vertexCount+index-1)%vertexCount]<<1,current=indices[index]<<1,next=indices[(index+1)%vertexCount]<<1;return!this.positiveArea(vertices[previous],vertices[1+previous],vertices[current],vertices[1+current],vertices[next],vertices[1+next])},Triangulator.positiveArea=function(p1x,p1y,p2x,p2y,p3x,p3y){return 0<=p1x*(p3y-p2y)+p2x*(p1y-p3y)+p3x*(p2y-p1y)},Triangulator.winding=function(p1x,p1y,p2x,p2y,p3x,p3y){var px=p2x-p1x,py=p2y-p1y;return 0<=p3x*py-p3y*px+px*p1y-p1x*py?1:-1},Triangulator}();core.Triangulator=Triangulator}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var IntSet=function(){function IntSet(){this.array=new Array}return IntSet.prototype.add=function(value){var contains=this.contains(value);return this.array[0|value]=0|value,!contains},IntSet.prototype.contains=function(value){return null!=this.array[0|value]},IntSet.prototype.remove=function(value){this.array[0|value]=void 0},IntSet.prototype.clear=function(){this.array.length=0},IntSet}();core.IntSet=IntSet;var Color=function(){function Color(r,g,b,a){void 0===r&&(r=0),void 0===g&&(g=0),void 0===b&&(b=0),void 0===a&&(a=0),this.r=r,this.g=g,this.b=b,this.a=a}return Color.prototype.set=function(r,g,b,a){return this.r=r,this.g=g,this.b=b,this.a=a,this.clamp(),this},Color.prototype.setFromColor=function(c){return this.r=c.r,this.g=c.g,this.b=c.b,this.a=c.a,this},Color.prototype.setFromString=function(hex){return hex="#"==hex.charAt(0)?hex.substr(1):hex,this.r=parseInt(hex.substr(0,2),16)/255,this.g=parseInt(hex.substr(2,2),16)/255,this.b=parseInt(hex.substr(4,2),16)/255,this.a=(8!=hex.length?255:parseInt(hex.substr(6,2),16))/255,this},Color.prototype.add=function(r,g,b,a){return this.r+=r,this.g+=g,this.b+=b,this.a+=a,this.clamp(),this},Color.prototype.clamp=function(){return this.r<0?this.r=0:1<this.r&&(this.r=1),this.g<0?this.g=0:1<this.g&&(this.g=1),this.b<0?this.b=0:1<this.b&&(this.b=1),this.a<0?this.a=0:1<this.a&&(this.a=1),this},Color.WHITE=new Color(1,1,1,1),Color.RED=new Color(1,0,0,1),Color.GREEN=new Color(0,1,0,1),Color.BLUE=new Color(0,0,1,1),Color.MAGENTA=new Color(1,0,1,1),Color}();core.Color=Color;var MathUtils=function(){function MathUtils(){}return MathUtils.clamp=function(value,min,max){return value<min?min:max<value?max:value},MathUtils.cosDeg=function(degrees){return Math.cos(degrees*MathUtils.degRad)},MathUtils.sinDeg=function(degrees){return Math.sin(degrees*MathUtils.degRad)},MathUtils.signum=function(value){return 0<value?1:value<0?-1:0},MathUtils.toInt=function(x){return 0<x?Math.floor(x):Math.ceil(x)},MathUtils.cbrt=function(x){var y=Math.pow(Math.abs(x),1/3);return x<0?-y:y},MathUtils.randomTriangular=function(min,max){return MathUtils.randomTriangularWith(min,max,.5*(min+max))},MathUtils.randomTriangularWith=function(min,max,mode){var u=Math.random(),d=max-min;return u<=(mode-min)/d?min+Math.sqrt(u*d*(mode-min)):max-Math.sqrt((1-u)*d*(max-mode))},MathUtils.PI2=2*(MathUtils.PI=3.1415927),MathUtils.radDeg=MathUtils.radiansToDegrees=180/MathUtils.PI,MathUtils.degRad=MathUtils.degreesToRadians=MathUtils.PI/180,MathUtils}();core.MathUtils=MathUtils;var Interpolation=function(){function Interpolation(){}return Interpolation.prototype.apply=function(start,end,a){return start+(end-start)*this.applyInternal(a)},Interpolation}(),Pow=function(_super){function Pow(power){var _this=_super.call(this)||this;return _this.power=2,_this.power=power,_this}return __extends(Pow,_super),Pow.prototype.applyInternal=function(a){return a<=.5?Math.pow(2*a,this.power)/2:Math.pow(2*(a-1),this.power)/(this.power%2==0?-2:2)+1},Pow}(core.Interpolation=Interpolation),PowOut=function(_super){function PowOut(power){return _super.call(this,power)||this}return __extends(PowOut,_super),PowOut.prototype.applyInternal=function(a){return Math.pow(a-1,this.power)*(this.power%2==0?-1:1)+1},PowOut}(core.Pow=Pow);core.PowOut=PowOut;var Utils=function(){function Utils(){}return Utils.arrayCopy=function(source,sourceStart,dest,destStart,numElements){for(var i=sourceStart,j=destStart;i<sourceStart+numElements;i++,j++)dest[j]=source[i]},Utils.setArraySize=function(array,size,value){void 0===value&&(value=0);var oldSize=array.length;if(oldSize==size)return array;if(oldSize<(array.length=size))for(var i=oldSize;i<size;i++)array[i]=value;return array},Utils.ensureArrayCapacity=function(array,size,value){return void 0===value&&(value=0),array.length>=size?array:Utils.setArraySize(array,size,value)},Utils.newArray=function(size,defaultValue){for(var array=new Array(size),i=0;i<size;i++)array[i]=defaultValue;return array},Utils.newFloatArray=function(size){if(Utils.SUPPORTS_TYPED_ARRAYS)return new Float32Array(size);for(var array=new Array(size),i=0;i<array.length;i++)array[i]=0;return array},Utils.newShortArray=function(size){if(Utils.SUPPORTS_TYPED_ARRAYS)return new Int16Array(size);for(var array=new Array(size),i=0;i<array.length;i++)array[i]=0;return array},Utils.toFloatArray=function(array){return Utils.SUPPORTS_TYPED_ARRAYS?new Float32Array(array):array},Utils.toSinglePrecision=function(value){return Utils.SUPPORTS_TYPED_ARRAYS?Math.fround(value):value},Utils.webkit602BugfixHelper=function(alpha,blend){},Utils.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,Utils}();core.Utils=Utils;var DebugUtils=function(){function DebugUtils(){}return DebugUtils.logBones=function(skeleton){for(var i=0;i<skeleton.bones.length;i++){var bone=skeleton.bones[i],mat=bone.matrix;console.log(bone.data.name+", "+mat.a+", "+mat.b+", "+mat.c+", "+mat.d+", "+mat.tx+", "+mat.ty)}},DebugUtils}();core.DebugUtils=DebugUtils;var Pool=function(){function Pool(instantiator){this.items=new Array,this.instantiator=instantiator}return Pool.prototype.obtain=function(){return 0<this.items.length?this.items.pop():this.instantiator()},Pool.prototype.free=function(item){item.reset&&item.reset(),this.items.push(item)},Pool.prototype.freeAll=function(items){for(var i=0;i<items.length;i++)items[i].reset&&items[i].reset(),this.items[i]=items[i]},Pool.prototype.clear=function(){this.items.length=0},Pool}();core.Pool=Pool;var Vector2=function(){function Vector2(x,y){void 0===x&&(x=0),void 0===y&&(y=0),this.x=x,this.y=y}return Vector2.prototype.set=function(x,y){return this.x=x,this.y=y,this},Vector2.prototype.length=function(){var x=this.x,y=this.y;return Math.sqrt(x*x+y*y)},Vector2.prototype.normalize=function(){var len=this.length();return 0!=len&&(this.x/=len,this.y/=len),this},Vector2}();core.Vector2=Vector2;var TimeKeeper=function(){function TimeKeeper(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return TimeKeeper.prototype.update=function(){var now=Date.now()/1e3;this.delta=now-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=now,this.frameCount++,1<this.frameTime&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},TimeKeeper}();core.TimeKeeper=TimeKeeper;var WindowedMean=function(){function WindowedMean(windowSize){void 0===windowSize&&(windowSize=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(windowSize)}return WindowedMean.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},WindowedMean.prototype.addValue=function(value){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=value,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},WindowedMean.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var mean=0,i=0;i<this.values.length;i++)mean+=this.values[i];this.mean=mean/this.values.length,this.dirty=!1}return this.mean}return 0},WindowedMean}();core.WindowedMean=WindowedMean}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){function Attachment(name){if(null==name)throw new Error("name cannot be null.");this.name=name}var VertexAttachment=function(_super){function VertexAttachment(name){var _this=_super.call(this,name)||this;return _this.id=(65535&VertexAttachment.nextID++)<<11,_this.worldVerticesLength=0,_this}return __extends(VertexAttachment,_super),VertexAttachment.prototype.computeWorldVerticesOld=function(slot,worldVertices){this.computeWorldVertices(slot,0,this.worldVerticesLength,worldVertices,0,2)},VertexAttachment.prototype.computeWorldVertices=function(slot,start,count,worldVertices,offset,stride){count=offset+(count>>1)*stride;var skeleton=slot.bone.skeleton,deformArray=slot.attachmentVertices,vertices=this.vertices,bones=this.bones;if(null!=bones){for(var v=0,skip=0,i=0;i<start;i+=2){v+=(n=bones[v])+1,skip+=n}var skeletonBones=skeleton.bones;if(0==deformArray.length)for(w=offset,b=3*skip;w<count;w+=stride){var wx=0,wy=0,n=bones[v++];for(n+=v;v<n;v++,b+=3){mat=skeletonBones[bones[v]].matrix,vx=vertices[b],vy=vertices[b+1];var weight=vertices[b+2];wx+=(vx*mat.a+vy*mat.c+mat.tx)*weight,wy+=(vx*mat.b+vy*mat.d+mat.ty)*weight}worldVertices[w]=wx,worldVertices[w+1]=wy}else for(var deform=deformArray,f=(w=offset,b=3*skip,skip<<1);w<count;w+=stride){wx=0,wy=0,n=bones[v++];for(n+=v;v<n;v++,b+=3,f+=2){mat=skeletonBones[bones[v]].matrix,vx=vertices[b]+deform[f],vy=vertices[b+1]+deform[f+1],weight=vertices[b+2];wx+=(vx*mat.a+vy*mat.c+mat.tx)*weight,wy+=(vx*mat.b+vy*mat.d+mat.ty)*weight}worldVertices[w]=wx,worldVertices[w+1]=wy}}else{0<deformArray.length&&(vertices=deformArray);for(var mat,x=(mat=slot.bone.matrix).tx,y=mat.ty,a=mat.a,b=mat.c,c=mat.b,d=mat.d,v_1=start,w=offset;w<count;v_1+=2,w+=stride){var vx=vertices[v_1],vy=vertices[v_1+1];worldVertices[w]=vx*a+vy*b+x,worldVertices[w+1]=vx*c+vy*d+y}}},VertexAttachment.prototype.applyDeform=function(sourceAttachment){return this==sourceAttachment},VertexAttachment.nextID=0,VertexAttachment}(core.Attachment=Attachment);core.VertexAttachment=VertexAttachment}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){!function(AttachmentType){AttachmentType[AttachmentType.Region=0]="Region",AttachmentType[AttachmentType.BoundingBox=1]="BoundingBox",AttachmentType[AttachmentType.Mesh=2]="Mesh",AttachmentType[AttachmentType.LinkedMesh=3]="LinkedMesh",AttachmentType[AttachmentType.Path=4]="Path",AttachmentType[AttachmentType.Point=5]="Point"}(core.AttachmentType||(core.AttachmentType={}))}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var BoundingBoxAttachment=function(_super){function BoundingBoxAttachment(name){var _this=_super.call(this,name)||this;return _this.color=new core.Color(1,1,1,1),_this}return __extends(BoundingBoxAttachment,_super),BoundingBoxAttachment}(core.VertexAttachment);core.BoundingBoxAttachment=BoundingBoxAttachment}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var ClippingAttachment=function(_super){function ClippingAttachment(name){var _this=_super.call(this,name)||this;return _this.color=new core.Color(.2275,.2275,.8078,1),_this}return __extends(ClippingAttachment,_super),ClippingAttachment}(core.VertexAttachment);core.ClippingAttachment=ClippingAttachment}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var MeshAttachment=function(_super){function MeshAttachment(name){var _this=_super.call(this,name)||this;return _this.color=new core.Color(1,1,1,1),_this.inheritDeform=!1,_this.tempColor=new core.Color(0,0,0,0),_this}return __extends(MeshAttachment,_super),MeshAttachment.prototype.updateUVs=function(region,uvs){var n=this.regionUVs.length;if(uvs&&uvs.length==n||(uvs=core.Utils.newFloatArray(n)),null!=region){for(var r=region.texture._uvs,w1=region.width,h1=region.height,w2=region.originalWidth,h2=region.originalHeight,x=region.offsetX,y=region.pixiOffsetY,i=0;i<n;i+=2){var u=this.regionUVs[i],v=this.regionUVs[i+1];u=(u*w2-x)/w1,v=(v*h2-y)/h1,uvs[i]=(r.x0*(1-u)+r.x1*u)*(1-v)+(r.x3*(1-u)+r.x2*u)*v,uvs[i+1]=(r.y0*(1-u)+r.y1*u)*(1-v)+(r.y3*(1-u)+r.y2*u)*v}return uvs}},MeshAttachment.prototype.applyDeform=function(sourceAttachment){return this==sourceAttachment||this.inheritDeform&&this.parentMesh==sourceAttachment},MeshAttachment.prototype.getParentMesh=function(){return this.parentMesh},MeshAttachment.prototype.setParentMesh=function(parentMesh){null!=(this.parentMesh=parentMesh)&&(this.bones=parentMesh.bones,this.vertices=parentMesh.vertices,this.worldVerticesLength=parentMesh.worldVerticesLength,this.regionUVs=parentMesh.regionUVs,this.triangles=parentMesh.triangles,this.hullLength=parentMesh.hullLength,this.worldVerticesLength=parentMesh.worldVerticesLength)},MeshAttachment}(core.VertexAttachment);core.MeshAttachment=MeshAttachment}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var PathAttachment=function(_super){function PathAttachment(name){var _this=_super.call(this,name)||this;return _this.closed=!1,_this.constantSpeed=!1,_this.color=new core.Color(1,1,1,1),_this}return __extends(PathAttachment,_super),PathAttachment}(core.VertexAttachment);core.PathAttachment=PathAttachment}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var PointAttachment=function(_super){function PointAttachment(name){var _this=_super.call(this,name)||this;return _this.color=new core.Color(.38,.94,0,1),_this}return __extends(PointAttachment,_super),PointAttachment.prototype.computeWorldPosition=function(bone,point){var mat=bone.matrix;return point.x=this.x*mat.a+this.y*mat.c+bone.worldX,point.y=this.x*mat.b+this.y*mat.d+bone.worldY,point},PointAttachment.prototype.computeWorldRotation=function(bone){var mat=bone.matrix,cos=core.MathUtils.cosDeg(this.rotation),sin=core.MathUtils.sinDeg(this.rotation),x=cos*mat.a+sin*mat.c,y=cos*mat.b+sin*mat.d;return Math.atan2(y,x)*core.MathUtils.radDeg},PointAttachment}(core.VertexAttachment);core.PointAttachment=PointAttachment}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var RegionAttachment=function(_super){function RegionAttachment(name){var _this=_super.call(this,name)||this;return _this.x=0,_this.y=0,_this.scaleX=1,_this.scaleY=1,_this.rotation=0,_this.width=0,_this.height=0,_this.color=new core.Color(1,1,1,1),_this.offset=core.Utils.newFloatArray(8),_this.uvs=core.Utils.newFloatArray(8),_this.tempColor=new core.Color(1,1,1,1),_this}return __extends(RegionAttachment,_super),RegionAttachment.prototype.updateOffset=function(){var regionScaleX=this.width/this.region.originalWidth*this.scaleX,regionScaleY=this.height/this.region.originalHeight*this.scaleY,localX=-this.width/2*this.scaleX+this.region.offsetX*regionScaleX,localY=-this.height/2*this.scaleY+this.region.offsetY*regionScaleY,localX2=localX+this.region.width*regionScaleX,localY2=localY+this.region.height*regionScaleY,radians=this.rotation*Math.PI/180,cos=Math.cos(radians),sin=Math.sin(radians),localXCos=localX*cos+this.x,localXSin=localX*sin,localYCos=localY*cos+this.y,localYSin=localY*sin,localX2Cos=localX2*cos+this.x,localX2Sin=localX2*sin,localY2Cos=localY2*cos+this.y,localY2Sin=localY2*sin,offset=this.offset;offset[RegionAttachment.OX1]=localXCos-localYSin,offset[RegionAttachment.OY1]=localYCos+localXSin,offset[RegionAttachment.OX2]=localXCos-localY2Sin,offset[RegionAttachment.OY2]=localY2Cos+localXSin,offset[RegionAttachment.OX3]=localX2Cos-localY2Sin,offset[RegionAttachment.OY3]=localY2Cos+localX2Sin,offset[RegionAttachment.OX4]=localX2Cos-localYSin,offset[RegionAttachment.OY4]=localYCos+localX2Sin},RegionAttachment.prototype.setRegion=function(region){this.region=region;var uvs=this.uvs;region.rotate?(uvs[2]=region.u,uvs[3]=region.v2,uvs[4]=region.u,uvs[5]=region.v,uvs[6]=region.u2,uvs[7]=region.v,uvs[0]=region.u2,uvs[1]=region.v2):(uvs[0]=region.u,uvs[1]=region.v2,uvs[2]=region.u,uvs[3]=region.v,uvs[4]=region.u2,uvs[5]=region.v,uvs[6]=region.u2,uvs[7]=region.v2)},RegionAttachment.prototype.computeWorldVertices=function(bone,worldVertices,offset,stride){var vertexOffset=this.offset,mat=bone.matrix,x=mat.tx,y=mat.ty,a=mat.a,b=mat.c,c=mat.b,d=mat.d,offsetX=0,offsetY=0;offsetX=vertexOffset[RegionAttachment.OX1],offsetY=vertexOffset[RegionAttachment.OY1],worldVertices[offset]=offsetX*a+offsetY*b+x,worldVertices[offset+1]=offsetX*c+offsetY*d+y,offset+=stride,offsetX=vertexOffset[RegionAttachment.OX2],offsetY=vertexOffset[RegionAttachment.OY2],worldVertices[offset]=offsetX*a+offsetY*b+x,worldVertices[offset+1]=offsetX*c+offsetY*d+y,offset+=stride,offsetX=vertexOffset[RegionAttachment.OX3],offsetY=vertexOffset[RegionAttachment.OY3],worldVertices[offset]=offsetX*a+offsetY*b+x,worldVertices[offset+1]=offsetX*c+offsetY*d+y,offset+=stride,offsetX=vertexOffset[RegionAttachment.OX4],offsetY=vertexOffset[RegionAttachment.OY4],worldVertices[offset]=offsetX*a+offsetY*b+x,worldVertices[offset+1]=offsetX*c+offsetY*d+y},RegionAttachment.OX1=0,RegionAttachment.OY1=1,RegionAttachment.OX2=2,RegionAttachment.OY2=3,RegionAttachment.OX3=4,RegionAttachment.OY3=5,RegionAttachment.OX4=6,RegionAttachment.OY4=7,RegionAttachment.X1=0,RegionAttachment.Y1=1,RegionAttachment.C1R=2,RegionAttachment.C1G=3,RegionAttachment.C1B=4,RegionAttachment.C1A=5,RegionAttachment.U1=6,RegionAttachment.V1=7,RegionAttachment.X2=8,RegionAttachment.Y2=9,RegionAttachment.C2R=10,RegionAttachment.C2G=11,RegionAttachment.C2B=12,RegionAttachment.C2A=13,RegionAttachment.U2=14,RegionAttachment.V2=15,RegionAttachment.X3=16,RegionAttachment.Y3=17,RegionAttachment.C3R=18,RegionAttachment.C3G=19,RegionAttachment.C3B=20,RegionAttachment.C3A=21,RegionAttachment.U3=22,RegionAttachment.V3=23,RegionAttachment.X4=24,RegionAttachment.Y4=25,RegionAttachment.C4R=26,RegionAttachment.C4G=27,RegionAttachment.C4B=28,RegionAttachment.C4A=29,RegionAttachment.U4=30,RegionAttachment.V4=31,RegionAttachment}(core.Attachment);core.RegionAttachment=RegionAttachment}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var JitterEffect=function(){function JitterEffect(jitterX,jitterY){this.jitterX=0,this.jitterY=0,this.jitterX=jitterX,this.jitterY=jitterY}return JitterEffect.prototype.begin=function(skeleton){},JitterEffect.prototype.transform=function(position,uv,light,dark){position.x+=core.MathUtils.randomTriangular(-this.jitterX,this.jitterY),position.y+=core.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},JitterEffect.prototype.end=function(){},JitterEffect}();core.JitterEffect=JitterEffect}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){!function(core){var SwirlEffect=function(){function SwirlEffect(radius){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=radius}return SwirlEffect.prototype.begin=function(skeleton){this.worldX=skeleton.x+this.centerX,this.worldY=skeleton.y+this.centerY},SwirlEffect.prototype.transform=function(position,uv,light,dark){var radAngle=this.angle*core.MathUtils.degreesToRadians,x=position.x-this.worldX,y=position.y-this.worldY,dist=Math.sqrt(x*x+y*y);if(dist<this.radius){var theta=SwirlEffect.interpolation.apply(0,radAngle,(this.radius-dist)/this.radius),cos=Math.cos(theta),sin=Math.sin(theta);position.x=cos*x-sin*y+this.worldX,position.y=sin*x+cos*y+this.worldY}},SwirlEffect.prototype.end=function(){},SwirlEffect.interpolation=new core.PowOut(2),SwirlEffect}();core.SwirlEffect=SwirlEffect}(pixi_spine.core||(pixi_spine.core={}))}(pixi_spine||(pixi_spine={})),function(pixi_spine){PIXI.spine=pixi_spine;var TextureProto=PIXI.Texture.prototype;TextureProto._updateUvs||(TextureProto._updateUvs=TextureProto.updateUvs)}(pixi_spine||(pixi_spine={})),function(pixi_spine){function atlasParser(){return function(resource,next){if(!resource.data||!function(resource){return resource.type===PIXI.loaders.Resource.TYPE.JSON}(resource)||!resource.data.bones)return next();var metadata=resource.metadata||{},metadataSkeletonScale=metadata?resource.metadata.spineSkeletonScale:null,metadataAtlas=metadata?resource.metadata.spineAtlas:null;if(!1===metadataAtlas)return next();if(metadataAtlas&&metadataAtlas.pages){var spineJsonParser=new pixi_spine.core.SkeletonJson(new pixi_spine.core.AtlasAttachmentLoader(metadataAtlas));metadataSkeletonScale&&(spineJsonParser.scale=metadataSkeletonScale);var skeletonData=spineJsonParser.readSkeletonData(resource.data);return resource.spineData=skeletonData,resource.spineAtlas=metadataAtlas,next()}var metadataAtlasSuffix=metadata.spineAtlasSuffix||".atlas",atlasPath=resource.url,queryStringPos=atlasPath.indexOf("?");0<queryStringPos&&(atlasPath=atlasPath.substr(0,queryStringPos)),atlasPath=atlasPath.substr(0,atlasPath.lastIndexOf("."))+metadataAtlasSuffix,resource.metadata&&resource.metadata.spineAtlasFile&&(atlasPath=resource.metadata.spineAtlasFile),atlasPath=atlasPath.replace(this.baseUrl,"");var atlasOptions={crossOrigin:resource.crossOrigin,xhrType:PIXI.loaders.Resource.XHR_RESPONSE_TYPE.TEXT,metadata:metadata.spineMetadata||null,parentResource:resource},imageOptions={crossOrigin:resource.crossOrigin,metadata:metadata.imageMetadata||null,parentResource:resource},baseUrl=resource.url.substr(0,resource.url.lastIndexOf("/")+1);baseUrl=baseUrl.replace(this.baseUrl,"");function createSkeletonWithRawAtlas(rawData){new pixi_spine.core.TextureAtlas(rawData,adapter,function(spineAtlas){var spineJsonParser=new pixi_spine.core.SkeletonJson(new pixi_spine.core.AtlasAttachmentLoader(spineAtlas));metadataSkeletonScale&&(spineJsonParser.scale=metadataSkeletonScale),resource.spineData=spineJsonParser.readSkeletonData(resource.data),resource.spineAtlas=spineAtlas,next()})}var namePrefix=metadata.imageNamePrefix||resource.name+"_atlas_page_",adapter=metadata.images?staticImageLoader(metadata.images):metadata.image?staticImageLoader({default:metadata.image}):metadata.imageLoader?metadata.imageLoader(this,namePrefix,baseUrl,imageOptions):imageLoaderAdapter(this,namePrefix,baseUrl,imageOptions);resource.metadata&&resource.metadata.atlasRawData?createSkeletonWithRawAtlas(resource.metadata.atlasRawData):this.add(resource.name+"_atlas",atlasPath,atlasOptions,function(atlasResource){atlasResource.error?next():createSkeletonWithRawAtlas(atlasResource.data)})}}function imageLoaderAdapter(loader,namePrefix,baseUrl,imageOptions){return baseUrl&&baseUrl.lastIndexOf("/")!==baseUrl.length-1&&(baseUrl+="/"),function(line,callback){var name=namePrefix+line,url=baseUrl+line,cachedResource=loader.resources[name];if(cachedResource){function done(){callback(cachedResource.texture.baseTexture)}cachedResource.texture?done():cachedResource.onAfterMiddleware.add(done)}else loader.add(name,url,imageOptions,function(resource){callback(resource.texture.baseTexture)})}}function staticImageLoader(pages){return function(line,callback){var page=pages[line]||pages.default;page&&page.baseTexture?callback(page.baseTexture):callback(page)}}pixi_spine.atlasParser=atlasParser,pixi_spine.imageLoaderAdapter=imageLoaderAdapter,pixi_spine.syncImageLoaderAdapter=function(baseUrl,crossOrigin){return baseUrl&&baseUrl.lastIndexOf("/")!==baseUrl.length-1&&(baseUrl+="/"),function(line,callback){callback(PIXI.BaseTexture.fromImage(line,crossOrigin))}},pixi_spine.staticImageLoader=staticImageLoader,PIXI.loaders.Loader&&(PIXI.loaders.Loader.addPixiMiddleware(atlasParser),PIXI.loader.use(atlasParser()))}(pixi_spine||(pixi_spine={})),function(){var array;Math.fround||(Math.fround=Math.fround=(array=new Float32Array(1),function(x){return array[0]=x,array[0]}))}(),function(pixi_spine){pixi_spine.core.Bone.yDown=!0;var tempRgb=[0,0,0],SpineSprite=function(_super){function SpineSprite(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.region=null,_this}return __extends(SpineSprite,_super),SpineSprite}(PIXI.Sprite);pixi_spine.SpineSprite=SpineSprite;var SpineMesh=function(_super){function SpineMesh(texture,vertices,uvs,indices,drawMode){return _super.call(this,texture,vertices,uvs,indices,drawMode)||this}return __extends(SpineMesh,_super),SpineMesh}(PIXI.mesh.Mesh);pixi_spine.SpineMesh=SpineMesh;var Spine=function(_super){function Spine(spineData){var _this=_super.call(this)||this;if(!spineData)throw new Error("The spineData param is required.");if("string"==typeof spineData)throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');_this.spineData=spineData,_this.skeleton=new pixi_spine.core.Skeleton(spineData),_this.skeleton.updateWorldTransform(),_this.stateData=new pixi_spine.core.AnimationStateData(spineData),_this.state=new pixi_spine.core.AnimationState(_this.stateData),_this.slotContainers=[],_this.tempClipContainers=[];for(var i=0,n=_this.skeleton.slots.length;i<n;i++){var slot=_this.skeleton.slots[i],attachment=slot.attachment,slotContainer=_this.newContainer();if(_this.slotContainers.push(slotContainer),_this.addChild(slotContainer),_this.tempClipContainers.push(null),attachment instanceof pixi_spine.core.RegionAttachment){var spriteName=attachment.region.name,sprite=_this.createSprite(slot,attachment,spriteName);slot.currentSprite=sprite,slot.currentSpriteName=spriteName,slotContainer.addChild(sprite)}else if(attachment instanceof pixi_spine.core.MeshAttachment){var mesh=_this.createMesh(slot,attachment);slot.currentMesh=mesh,slot.currentMeshName=attachment.name,slotContainer.addChild(mesh)}else{if(!(attachment instanceof pixi_spine.core.ClippingAttachment))continue;_this.createGraphics(slot,attachment),slotContainer.addChild(slot.clippingContainer),slotContainer.addChild(slot.currentGraphics)}}return _this.autoUpdate=!0,_this.tintRgb=new Float32Array([1,1,1]),_this}return __extends(Spine,_super),Object.defineProperty(Spine.prototype,"autoUpdate",{get:function(){return this.updateTransform===Spine.prototype.autoUpdateTransform},set:function(value){this.updateTransform=value?Spine.prototype.autoUpdateTransform:PIXI.Container.prototype.updateTransform},enumerable:!0,configurable:!0}),Object.defineProperty(Spine.prototype,"tint",{get:function(){return PIXI.utils.rgb2hex(this.tintRgb)},set:function(value){this.tintRgb=PIXI.utils.hex2rgb(value,this.tintRgb)},enumerable:!0,configurable:!0}),Object.defineProperty(Spine.prototype,"delayLimit",{get:function(){return(void 0!==this.localDelayLimit?this.localDelayLimit:Spine.globalDelayLimit)||Number.MAX_VALUE},enumerable:!0,configurable:!0}),Spine.prototype.update=function(dt){var delayLimit=this.delayLimit;if(delayLimit<dt&&(dt=delayLimit),this.state.update(dt),this.state.apply(this.skeleton),this.skeleton){this.skeleton.updateWorldTransform();var slots=this.skeleton.slots,globalClr=this.color,light=null,dark=null;globalClr?(light=globalClr.light,dark=globalClr.dark):light=this.tintRgb;for(var thack=PIXI.TransformBase&&1==this.transformHack(),i=0,n=slots.length;i<n;i++){var attachment=(slot=slots[i]).attachment,slotContainer=this.slotContainers[i];if(attachment){var spriteColor=null,attColor=attachment.color;if(attachment instanceof pixi_spine.core.RegionAttachment){var region=attachment.region;if(region){slot.currentMesh&&(slot.currentMesh.visible=!1,slot.currentMesh=null,slot.currentMeshName=void 0);var ar=region;if(!slot.currentSpriteName||slot.currentSpriteName!==ar.name){var spriteName=ar.name;if(slot.currentSprite&&(slot.currentSprite.visible=!1),slot.sprites=slot.sprites||{},void 0!==slot.sprites[spriteName])slot.sprites[spriteName].visible=!0;else{var sprite=this.createSprite(slot,attachment,spriteName);slotContainer.addChild(sprite)}slot.currentSprite=slot.sprites[spriteName],slot.currentSpriteName=spriteName}}if(slotContainer.transform){var transAny=transform=slotContainer.transform,lt=null;transAny.matrix2d?(lt=transAny.matrix2d,transAny._dirtyVersion++,transAny.version=transAny._dirtyVersion,transAny.isStatic=!0,transAny.operMode=0):thack?(transAny.position&&((transform=new PIXI.TransformBase)._parentID=-1,transform._worldID=slotContainer.transform._worldID,slotContainer.transform=transform),lt=transform.localTransform):transAny.setFromMatrix(slot.bone.matrix),lt&&slot.bone.matrix.copy(lt)}else{lt=slotContainer.localTransform||new PIXI.Matrix;slot.bone.matrix.copy(lt),slotContainer.localTransform=lt,slotContainer.displayObjectUpdateTransform=SlotContainerUpdateTransformV3}slot.currentSprite.color?spriteColor=slot.currentSprite.color:(tempRgb[0]=light[0]*slot.color.r*attColor.r,tempRgb[1]=light[1]*slot.color.g*attColor.g,tempRgb[2]=light[2]*slot.color.b*attColor.b,slot.currentSprite.tint=PIXI.utils.rgb2hex(tempRgb)),slot.currentSprite.blendMode=slot.blendMode}else if(attachment instanceof pixi_spine.core.MeshAttachment){var transform;if(slot.currentSprite)if(slot.currentSprite.visible=!1,slot.currentSprite=null,slot.currentSpriteName=void 0,slotContainer.transform)(transform=new PIXI.TransformStatic)._parentID=-1,transform._worldID=slotContainer.transform._worldID,slotContainer.transform=transform;else slotContainer.localTransform=new PIXI.Matrix,slotContainer.displayObjectUpdateTransform=PIXI.DisplayObject.prototype.updateTransform;if(!slot.currentMeshName||slot.currentMeshName!==attachment.name){var meshName=attachment.name;if(slot.currentMesh&&(slot.currentMesh.visible=!1),slot.meshes=slot.meshes||{},void 0!==slot.meshes[meshName])slot.meshes[meshName].visible=!0;else{var mesh=this.createMesh(slot,attachment);slotContainer.addChild(mesh)}slot.currentMesh=slot.meshes[meshName],slot.currentMeshName=meshName}if(attachment.computeWorldVerticesOld(slot,slot.currentMesh.vertices),slot.currentMesh.color)spriteColor=slot.currentMesh.color;else if("3"!==PIXI.VERSION[0]){var tintRgb=slot.currentMesh.tintRgb;tintRgb[0]=light[0]*slot.color.r*attColor.r,tintRgb[1]=light[1]*slot.color.g*attColor.g,tintRgb[2]=light[2]*slot.color.b*attColor.b}slot.currentMesh.blendMode=slot.blendMode}else{if(!(attachment instanceof pixi_spine.core.ClippingAttachment)){slotContainer.visible=!1;continue}slot.currentGraphics||(this.createGraphics(slot,attachment),slotContainer.addChild(slot.clippingContainer),slotContainer.addChild(slot.currentGraphics)),this.updateGraphics(slot,attachment)}if(slotContainer.visible=!0,spriteColor){var r0=slot.color.r*attColor.r,g0=slot.color.g*attColor.g,b0=slot.color.b*attColor.b;spriteColor.setLight(light[0]*r0+dark[0]*(1-r0),light[1]*g0+dark[1]*(1-g0),light[2]*b0+dark[2]*(1-b0)),b0=slot.darkColor?(r0=slot.darkColor.r,g0=slot.darkColor.g,slot.darkColor.b):g0=r0=0,spriteColor.setDark(light[0]*r0+dark[0]*(1-r0),light[1]*g0+dark[1]*(1-g0),light[2]*b0+dark[2]*(1-b0))}slotContainer.alpha=slot.color.a}else slotContainer.visible=!1}var drawOrder=this.skeleton.drawOrder,clippingAttachment=null,clippingContainer=null;for(i=0,n=drawOrder.length;i<n;i++){var slot=slots[drawOrder[i].data.index];slotContainer=this.slotContainers[drawOrder[i].data.index];if(clippingContainer||null!==slotContainer.parent&&slotContainer.parent!==this&&(slotContainer.parent.removeChild(slotContainer),slotContainer.parent=this),slot.currentGraphics&&slot.attachment)clippingContainer=slot.clippingContainer,clippingAttachment=slot.attachment,clippingContainer.children.length=0,this.children[i]=slotContainer,clippingAttachment.endSlot==slot.data&&(clippingAttachment.endSlot=null);else if(clippingContainer){var c=this.tempClipContainers[i];c||((c=this.tempClipContainers[i]=this.newContainer()).visible=!1),this.children[i]=c,slotContainer.parent=null,clippingContainer.addChild(slotContainer),clippingAttachment.endSlot==slot.data&&(clippingContainer.renderable=!0,clippingAttachment=clippingContainer=null)}else this.children[i]=slotContainer}}},Spine.prototype.setSpriteRegion=function(attachment,sprite,region){sprite.region=region,sprite.texture=region.texture,region.size?(sprite.scale.x=region.size.width/region.originalWidth,sprite.scale.y=-region.size.height/region.originalHeight):(sprite.scale.x=attachment.scaleX*attachment.width/region.originalWidth,sprite.scale.y=-attachment.scaleY*attachment.height/region.originalHeight)},Spine.prototype.setMeshRegion=function(attachment,mesh,region){mesh.region=region,mesh.texture=region.texture,region.texture._updateUvs(),attachment.updateUVs(region,mesh.uvs),mesh.dirty++},Spine.prototype.autoUpdateTransform=function(){if(Spine.globalAutoUpdate){this.lastTime=this.lastTime||Date.now();var timeDelta=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(timeDelta)}else this.lastTime=0;PIXI.Container.prototype.updateTransform.call(this)},Spine.prototype.createSprite=function(slot,attachment,defName){var region=attachment.region;slot.tempAttachment===attachment&&(region=slot.tempRegion,slot.tempAttachment=null,slot.tempRegion=null);var texture=region.texture,sprite=this.newSprite(texture);return sprite.rotation=attachment.rotation*pixi_spine.core.MathUtils.degRad,sprite.anchor.x=.5,sprite.anchor.y=.5,sprite.position.x=attachment.x,sprite.position.y=attachment.y,sprite.alpha=attachment.color.a,sprite.region=attachment.region,this.setSpriteRegion(attachment,sprite,attachment.region),slot.sprites=slot.sprites||{},slot.sprites[defName]=sprite},Spine.prototype.createMesh=function(slot,attachment){var region=attachment.region;slot.tempAttachment===attachment&&(region=slot.tempRegion,slot.tempAttachment=null,slot.tempRegion=null);var strip=this.newMesh(region.texture,new Float32Array(attachment.regionUVs.length),new Float32Array(attachment.regionUVs.length),new Uint16Array(attachment.triangles),PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES);return strip.canvasPadding=1.5,strip.alpha=attachment.color.a,strip.region=attachment.region,this.setMeshRegion(attachment,strip,region),slot.meshes=slot.meshes||{},slot.meshes[attachment.name]=strip},Spine.prototype.createGraphics=function(slot,clip){var graphics=this.newGraphics(),poly=new PIXI.Polygon([]);return graphics.clear(),graphics.beginFill(16777215,1),graphics.drawPolygon(poly),graphics.renderable=!1,slot.currentGraphics=graphics,slot.clippingContainer=this.newContainer(),slot.clippingContainer.mask=slot.currentGraphics,graphics},Spine.prototype.updateGraphics=function(slot,clip){var vertices=slot.currentGraphics.graphicsData[0].shape.points,n=clip.worldVerticesLength;vertices.length=n,clip.computeWorldVertices(slot,0,n,vertices,0,2),slot.currentGraphics.dirty++,slot.currentGraphics.clearDirty++},Spine.prototype.hackTextureBySlotIndex=function(slotIndex,texture,size){void 0===texture&&(texture=null),void 0===size&&(size=null);var slot=this.skeleton.slots[slotIndex];if(!slot)return!1;var attachment=slot.attachment,region=attachment.region;return texture&&((region=new pixi_spine.core.TextureRegion).texture=texture,region.size=size),slot.currentSprite&&slot.currentSprite.region!=region?(this.setSpriteRegion(attachment,slot.currentSprite,region),slot.currentSprite.region=region):slot.currentMesh&&slot.currentMesh.region!=region?this.setMeshRegion(attachment,slot.currentMesh,region):(slot.tempRegion=region,slot.tempAttachment=attachment),!0},Spine.prototype.hackTextureBySlotName=function(slotName,texture,size){void 0===texture&&(texture=null),void 0===size&&(size=null);var index=this.skeleton.findSlotIndex(slotName);return-1!=index&&this.hackTextureBySlotIndex(index,texture,size)},Spine.prototype.newContainer=function(){return new PIXI.Container},Spine.prototype.newSprite=function(tex){return new SpineSprite(tex)},Spine.prototype.newGraphics=function(){return new PIXI.Graphics},Spine.prototype.newMesh=function(texture,vertices,uvs,indices,drawMode){return new SpineMesh(texture,vertices,uvs,indices,drawMode)},Spine.prototype.transformHack=function(){return 1},Spine.prototype.hackAttachmentGroups=function(nameSuffix,group,outGroup){if(nameSuffix){for(var list_d=[],list_n=[],i=0,len=this.skeleton.slots.length;i<len;i++){var slot=this.skeleton.slots[i],name_2=slot.currentSpriteName||slot.currentMeshName||"",target=slot.currentSprite||slot.currentMesh;name_2.endsWith(nameSuffix)?(target.parentGroup=group,list_n.push(target)):outGroup&&target&&(target.parentGroup=outGroup,list_d.push(target))}return[list_d,list_n]}},Spine.prototype.destroy=function(options){for(var i=0,n=this.skeleton.slots.length;i<n;i++){var slot=this.skeleton.slots[i];for(var name_3 in slot.meshes)slot.meshes[name_3].destroy(options);for(var name_4 in slot.meshes=null,slot.sprites)slot.sprites[name_4].destroy(options);slot.sprites=null}for(i=0,n=this.slotContainers.length;i<n;i++)this.slotContainers[i].destroy(options);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,_super.prototype.destroy.call(this,options)},Spine.globalAutoUpdate=!0,Spine.globalDelayLimit=0,Spine.clippingPolygon=[],Spine}(PIXI.Container);function SlotContainerUpdateTransformV3(){var pt=this.parent.worldTransform,wt=this.worldTransform,lt=this.localTransform;wt.a=lt.a*pt.a+lt.b*pt.c,wt.b=lt.a*pt.b+lt.b*pt.d,wt.c=lt.c*pt.a+lt.d*pt.c,wt.d=lt.c*pt.b+lt.d*pt.d,wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx,wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null}pixi_spine.Spine=Spine}(pixi_spine||(pixi_spine={})),function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pixiParticles=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var Particle_1=_dereq_("./Particle"),Texture=PIXI.Texture,AnimatedParticle=function(_super){function AnimatedParticle(emitter){var _this=_super.call(this,emitter)||this;return _this.textures=null,_this.duration=0,_this.framerate=0,_this.elapsed=0,_this.loop=!1,_this}return __extends(AnimatedParticle,_super),AnimatedParticle.prototype.init=function(){this.Particle_init(),this.elapsed=0,this.framerate<0&&(this.duration=this.maxLife,this.framerate=this.textures.length/this.duration)},AnimatedParticle.prototype.applyArt=function(art){this.textures=art.textures,this.framerate=art.framerate,this.duration=art.duration,this.loop=art.loop},AnimatedParticle.prototype.update=function(delta){var lerp=this.Particle_update(delta);if(0<=lerp){this.elapsed+=delta,this.elapsed>this.duration&&(this.loop?this.elapsed=this.elapsed%this.duration:this.elapsed=this.duration-1e-6);var frame=this.elapsed*this.framerate+1e-7|0;this.texture=this.textures[frame]||PIXI.Texture.EMPTY}return lerp},AnimatedParticle.prototype.destroy=function(){this.Particle_destroy(),this.textures=null},AnimatedParticle.parseArt=function(art){for(var data,output,textures,tex,outTextures,outArr=[],i=0;i<art.length;++i){data=art[i],outArr[i]=output={},output.textures=outTextures=[],textures=data.textures;for(var j=0;j<textures.length;++j)if("string"==typeof(tex=textures[j]))outTextures.push(Texture.fromImage(tex));else if(tex instanceof Texture)outTextures.push(tex);else{var dupe=tex.count||1;for(tex="string"==typeof tex.texture?Texture.fromImage(tex.texture):tex.texture;0<dupe;--dupe)outTextures.push(tex)}"matchLife"==data.framerate?(output.framerate=-1,output.duration=0,output.loop=!1):(output.loop=!!data.loop,output.framerate=0<data.framerate?data.framerate:60,output.duration=outTextures.length/output.framerate)}return outArr},AnimatedParticle}(Particle_1.default);exports.default=AnimatedParticle},{"./Particle":3}],2:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ParticleUtils_1=_dereq_("./ParticleUtils"),Particle_1=_dereq_("./Particle"),PropertyNode_1=_dereq_("./PropertyNode"),PolygonalChain_1=_dereq_("./PolygonalChain"),ticker=PIXI.ticker.shared,helperPoint=new PIXI.Point,Emitter=function(){function Emitter(particleParent,particleImages,config){this._particleConstructor=Particle_1.default,this.particleImages=null,this.startAlpha=null,this.startSpeed=null,this.minimumSpeedMultiplier=1,this.acceleration=null,this.maxSpeed=NaN,this.startScale=null,this.minimumScaleMultiplier=1,this.startColor=null,this.minLifetime=0,this.maxLifetime=0,this.minStartRotation=0,this.maxStartRotation=0,this.noRotation=!1,this.minRotationSpeed=0,this.maxRotationSpeed=0,this.particleBlendMode=0,this.customEase=null,this.extraData=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=null,this.spawnType=null,this._spawnFunc=null,this.spawnRect=null,this.spawnCircle=null,this.spawnPolygonalChain=null,this.particlesPerWave=1,this.particleSpacing=0,this.angleStart=0,this.rotation=0,this.ownerPos=null,this._prevEmitterPos=null,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._origArt=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=particleParent,particleImages&&config&&this.init(particleImages,config),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}return Object.defineProperty(Emitter.prototype,"frequency",{get:function(){return this._frequency},set:function(value){this._frequency="number"==typeof value&&0<value?value:1},enumerable:!0,configurable:!0}),Object.defineProperty(Emitter.prototype,"particleConstructor",{get:function(){return this._particleConstructor},set:function(value){if(value!=this._particleConstructor){this._particleConstructor=value,this.cleanup();for(var particle=this._poolFirst;particle;particle=particle.next)particle.destroy();this._poolFirst=null,this._origConfig&&this._origArt&&this.init(this._origArt,this._origConfig)}},enumerable:!0,configurable:!0}),Object.defineProperty(Emitter.prototype,"parent",{get:function(){return this._parent},set:function(value){this.cleanup(),this._parent=value},enumerable:!0,configurable:!0}),Emitter.prototype.init=function(art,config){if(art&&config){this.cleanup(),this._origConfig=config,this._origArt=art,art=Array.isArray(art)?art.slice():[art];var partClass=this._particleConstructor;this.particleImages=partClass.parseArt?partClass.parseArt(art):art,config.alpha?this.startAlpha=PropertyNode_1.default.createList(config.alpha):this.startAlpha=new PropertyNode_1.default(1,0),config.speed?(this.startSpeed=PropertyNode_1.default.createList(config.speed),this.minimumSpeedMultiplier=config.speed.minimumSpeedMultiplier||1):(this.minimumSpeedMultiplier=1,this.startSpeed=new PropertyNode_1.default(0,0));var spawnCircle,acceleration=config.acceleration;switch(acceleration&&(acceleration.x||acceleration.y)?(this.startSpeed.next=null,this.acceleration=new PIXI.Point(acceleration.x,acceleration.y),this.maxSpeed=config.maxSpeed||NaN):this.acceleration=new PIXI.Point,config.scale?(this.startScale=PropertyNode_1.default.createList(config.scale),this.minimumScaleMultiplier=config.scale.minimumScaleMultiplier||1):(this.startScale=new PropertyNode_1.default(1,0),this.minimumScaleMultiplier=1),config.color?this.startColor=PropertyNode_1.default.createList(config.color):this.startColor=new PropertyNode_1.default({r:255,g:255,b:255},0),config.startRotation?(this.minStartRotation=config.startRotation.min,this.maxStartRotation=config.startRotation.max):this.minStartRotation=this.maxStartRotation=0,config.noRotation&&(this.minStartRotation||this.maxStartRotation)?this.noRotation=!!config.noRotation:this.noRotation=!1,config.rotationSpeed?(this.minRotationSpeed=config.rotationSpeed.min,this.maxRotationSpeed=config.rotationSpeed.max):this.minRotationSpeed=this.maxRotationSpeed=0,this.minLifetime=config.lifetime.min,this.maxLifetime=config.lifetime.max,this.particleBlendMode=ParticleUtils_1.default.getBlendMode(config.blendMode),config.ease?this.customEase="function"==typeof config.ease?config.ease:ParticleUtils_1.default.generateEase(config.ease):this.customEase=null,partClass.parseData?this.extraData=partClass.parseData(config.extraData):this.extraData=config.extraData||null,this.spawnRect=this.spawnCircle=null,this.particlesPerWave=1,config.particlesPerWave&&1<config.particlesPerWave&&(this.particlesPerWave=config.particlesPerWave),this.particleSpacing=0,this.angleStart=0,config.spawnType){case"rect":this.spawnType="rect",this._spawnFunc=this._spawnRect;var spawnRect=config.spawnRect;this.spawnRect=new PIXI.Rectangle(spawnRect.x,spawnRect.y,spawnRect.w,spawnRect.h);break;case"circle":this.spawnType="circle",this._spawnFunc=this._spawnCircle,spawnCircle=config.spawnCircle,this.spawnCircle=new PIXI.Circle(spawnCircle.x,spawnCircle.y,spawnCircle.r);break;case"ring":this.spawnType="ring",this._spawnFunc=this._spawnRing,spawnCircle=config.spawnCircle,this.spawnCircle=new PIXI.Circle(spawnCircle.x,spawnCircle.y,spawnCircle.r),this.spawnCircle.minRadius=spawnCircle.minR;break;case"burst":this.spawnType="burst",this._spawnFunc=this._spawnBurst,this.particleSpacing=config.particleSpacing,this.angleStart=config.angleStart?config.angleStart:0;break;case"point":this.spawnType="point",this._spawnFunc=this._spawnPoint;break;case"polygonalChain":this.spawnType="polygonalChain",this._spawnFunc=this._spawnPolygonalChain,this.spawnPolygonalChain=new PolygonalChain_1.default(config.spawnPolygon);break;default:this.spawnType="point",this._spawnFunc=this._spawnPoint}this.frequency=config.frequency,this.spawnChance="number"==typeof config.spawnChance&&0<config.spawnChance?config.spawnChance:1,this.emitterLifetime=config.emitterLifetime||-1,this.maxParticles=0<config.maxParticles?config.maxParticles:1e3,this.addAtBack=!!config.addAtBack,this.rotation=0,this.ownerPos=new PIXI.Point,this.spawnPos=new PIXI.Point(config.pos.x,config.pos.y),this._prevEmitterPos=this.spawnPos.clone(),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=void 0===config.emit||!!config.emit,this.autoUpdate=void 0!==config.autoUpdate&&!!config.autoUpdate}},Emitter.prototype.recycle=function(particle){particle.next&&(particle.next.prev=particle.prev),particle.prev&&(particle.prev.next=particle.next),particle==this._activeParticlesLast&&(this._activeParticlesLast=particle.prev),particle==this._activeParticlesFirst&&(this._activeParticlesFirst=particle.next),particle.prev=null,particle.next=this._poolFirst,(this._poolFirst=particle).parent&&particle.parent.removeChild(particle),--this.particleCount},Emitter.prototype.rotate=function(newRot){if(this.rotation!=newRot){var diff=newRot-this.rotation;this.rotation=newRot,ParticleUtils_1.default.rotatePoint(diff,this.spawnPos),this._posChanged=!0}},Emitter.prototype.updateSpawnPos=function(x,y){this._posChanged=!0,this.spawnPos.x=x,this.spawnPos.y=y},Emitter.prototype.updateOwnerPos=function(x,y){this._posChanged=!0,this.ownerPos.x=x,this.ownerPos.y=y},Emitter.prototype.resetPositionTracking=function(){this._prevPosIsValid=!1},Object.defineProperty(Emitter.prototype,"emit",{get:function(){return this._emit},set:function(value){this._emit=!!value,this._emitterLife=this.emitterLifetime},enumerable:!0,configurable:!0}),Object.defineProperty(Emitter.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(value){this._autoUpdate&&!value?ticker.remove(this.update,this):!this._autoUpdate&&value&&ticker.add(this.update,this),this._autoUpdate=!!value},enumerable:!0,configurable:!0}),Emitter.prototype.playOnceAndDestroy=function(callback){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=callback},Emitter.prototype.playOnce=function(callback){this.emit=!0,this._completeCallback=callback},Emitter.prototype.update=function(delta){if(this._autoUpdate&&(delta=delta/PIXI.settings.TARGET_FPMS/1e3),this._parent){var i,particle,next,prevX,prevY;for(particle=this._activeParticlesFirst;particle;particle=next)next=particle.next,particle.update(delta);this._prevPosIsValid&&(prevX=this._prevEmitterPos.x,prevY=this._prevEmitterPos.y);var curX=this.ownerPos.x+this.spawnPos.x,curY=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=delta<0?0:delta;this._spawnTimer<=0;){if(0<this._emitterLife&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles)this._spawnTimer+=this._frequency;else{var lifetime=void 0;if(lifetime=this.minLifetime==this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer<lifetime){var emitPosX=void 0,emitPosY=void 0;if(this._prevPosIsValid&&this._posChanged){var lerp=1+this._spawnTimer/delta;emitPosX=(curX-prevX)*lerp+prevX,emitPosY=(curY-prevY)*lerp+prevY}else emitPosX=curX,emitPosY=curY;i=0;for(var len=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount);i<len;++i)if(!(this.spawnChance<1&&Math.random()>=this.spawnChance)){var p=void 0;if(this._poolFirst?(p=this._poolFirst,this._poolFirst=this._poolFirst.next,p.next=null):p=new this.particleConstructor(this),1<this.particleImages.length?p.applyArt(this.particleImages[Math.floor(Math.random()*this.particleImages.length)]):p.applyArt(this.particleImages[0]),p.alphaList.reset(this.startAlpha),1!=this.minimumSpeedMultiplier&&(p.speedMultiplier=Math.random()*(1-this.minimumSpeedMultiplier)+this.minimumSpeedMultiplier),p.speedList.reset(this.startSpeed),p.acceleration.x=this.acceleration.x,p.acceleration.y=this.acceleration.y,p.maxSpeed=this.maxSpeed,1!=this.minimumScaleMultiplier&&(p.scaleMultiplier=Math.random()*(1-this.minimumScaleMultiplier)+this.minimumScaleMultiplier),p.scaleList.reset(this.startScale),p.colorList.reset(this.startColor),this.minRotationSpeed==this.maxRotationSpeed?p.rotationSpeed=this.minRotationSpeed:p.rotationSpeed=Math.random()*(this.maxRotationSpeed-this.minRotationSpeed)+this.minRotationSpeed,p.noRotation=this.noRotation,p.maxLife=lifetime,p.blendMode=this.particleBlendMode,p.ease=this.customEase,p.extraData=this.extraData,this._spawnFunc(p,emitPosX,emitPosY,i),p.init(),p.update(-this._spawnTimer),p.parent){var children=this._parent.children;if(children[0]==p)children.shift();else if(children[children.length-1]==p)children.pop();else{var index=children.indexOf(p);children.splice(index,1)}this.addAtBack?children.unshift(p):children.push(p)}else this.addAtBack?this._parent.addChildAt(p,0):this._parent.addChild(p);this._activeParticlesLast?((this._activeParticlesLast.next=p).prev=this._activeParticlesLast,this._activeParticlesLast=p):this._activeParticlesLast=this._activeParticlesFirst=p,++this.particleCount}}this._spawnTimer+=this._frequency}}this._posChanged&&(this._prevEmitterPos.x=curX,this._prevEmitterPos.y=curY,this._prevPosIsValid=!0,this._posChanged=!1),this._emit||this._activeParticlesFirst||(this._completeCallback&&this._completeCallback(),this._destroyWhenComplete&&this.destroy())}},Emitter.prototype._spawnPoint=function(p,emitPosX,emitPosY){this.minStartRotation==this.maxStartRotation?p.rotation=this.minStartRotation+this.rotation:p.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,p.position.x=emitPosX,p.position.y=emitPosY},Emitter.prototype._spawnRect=function(p,emitPosX,emitPosY){this.minStartRotation==this.maxStartRotation?p.rotation=this.minStartRotation+this.rotation:p.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,helperPoint.x=Math.random()*this.spawnRect.width+this.spawnRect.x,helperPoint.y=Math.random()*this.spawnRect.height+this.spawnRect.y,0!==this.rotation&&ParticleUtils_1.default.rotatePoint(this.rotation,helperPoint),p.position.x=emitPosX+helperPoint.x,p.position.y=emitPosY+helperPoint.y},Emitter.prototype._spawnCircle=function(p,emitPosX,emitPosY){this.minStartRotation==this.maxStartRotation?p.rotation=this.minStartRotation+this.rotation:p.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,helperPoint.x=Math.random()*this.spawnCircle.radius,helperPoint.y=0,ParticleUtils_1.default.rotatePoint(360*Math.random(),helperPoint),helperPoint.x+=this.spawnCircle.x,helperPoint.y+=this.spawnCircle.y,0!==this.rotation&&ParticleUtils_1.default.rotatePoint(this.rotation,helperPoint),p.position.x=emitPosX+helperPoint.x,p.position.y=emitPosY+helperPoint.y},Emitter.prototype._spawnRing=function(p,emitPosX,emitPosY){var spawnCircle=this.spawnCircle;this.minStartRotation==this.maxStartRotation?p.rotation=this.minStartRotation+this.rotation:p.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,spawnCircle.minRadius!==spawnCircle.radius?helperPoint.x=Math.random()*(spawnCircle.radius-spawnCircle.minRadius)+spawnCircle.minRadius:helperPoint.x=spawnCircle.radius,helperPoint.y=0;var angle=360*Math.random();p.rotation+=angle,ParticleUtils_1.default.rotatePoint(angle,helperPoint),helperPoint.x+=this.spawnCircle.x,helperPoint.y+=this.spawnCircle.y,0!==this.rotation&&ParticleUtils_1.default.rotatePoint(this.rotation,helperPoint),p.position.x=emitPosX+helperPoint.x,p.position.y=emitPosY+helperPoint.y},Emitter.prototype._spawnPolygonalChain=function(p,emitPosX,emitPosY){this.minStartRotation==this.maxStartRotation?p.rotation=this.minStartRotation+this.rotation:p.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,this.spawnPolygonalChain.getRandomPoint(helperPoint),0!==this.rotation&&ParticleUtils_1.default.rotatePoint(this.rotation,helperPoint),p.position.x=emitPosX+helperPoint.x,p.position.y=emitPosY+helperPoint.y},Emitter.prototype._spawnBurst=function(p,emitPosX,emitPosY,i){0===this.particleSpacing?p.rotation=360*Math.random():p.rotation=this.angleStart+this.particleSpacing*i+this.rotation,p.position.x=emitPosX,p.position.y=emitPosY},Emitter.prototype.cleanup=function(){var particle,next;for(particle=this._activeParticlesFirst;particle;particle=next)next=particle.next,this.recycle(particle),particle.parent&&particle.parent.removeChild(particle);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0},Emitter.prototype.destroy=function(){var next;this.autoUpdate=!1,this.cleanup();for(var particle=this._poolFirst;particle;particle=next)next=particle.next,particle.destroy();this._poolFirst=this._parent=this.particleImages=this.spawnPos=this.ownerPos=this.startColor=this.startScale=this.startAlpha=this.startSpeed=this.customEase=this._completeCallback=null},Emitter}();exports.default=Emitter},{"./Particle":3,"./ParticleUtils":4,"./PolygonalChain":6,"./PropertyNode":8}],3:[function(_dereq_,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var ParticleUtils_1=_dereq_("./ParticleUtils"),PropertyList_1=_dereq_("./PropertyList"),Particle=function(_super){function Particle(emitter){var _this=_super.call(this)||this;return _this.emitter=emitter,_this.anchor.x=_this.anchor.y=.5,_this.velocity=new PIXI.Point,_this.maxLife=0,_this.age=0,_this.ease=null,_this.extraData=null,_this.alphaList=new PropertyList_1.default,_this.speedList=new PropertyList_1.default,_this.speedMultiplier=1,_this.acceleration=new PIXI.Point,_this.maxSpeed=NaN,_this.scaleList=new PropertyList_1.default,_this.scaleMultiplier=1,_this.colorList=new PropertyList_1.default(!0),_this._doAlpha=!1,_this._doScale=!1,_this._doSpeed=!1,_this._doAcceleration=!1,_this._doColor=!1,_this._doNormalMovement=!1,_this._oneOverLife=0,_this.next=null,_this.prev=null,_this.init=_this.init,_this.Particle_init=Particle.prototype.init,_this.update=_this.update,_this.Particle_update=Particle.prototype.update,_this.Sprite_destroy=_super.prototype.destroy,_this.Particle_destroy=Particle.prototype.destroy,_this.applyArt=_this.applyArt,_this.kill=_this.kill,_this}return __extends(Particle,_super),Particle.prototype.init=function(){this.age=0,this.velocity.x=this.speedList.current.value*this.speedMultiplier,this.velocity.y=0,ParticleUtils_1.default.rotatePoint(this.rotation,this.velocity),this.noRotation?this.rotation=0:this.rotation*=ParticleUtils_1.default.DEG_TO_RADS,this.rotationSpeed*=ParticleUtils_1.default.DEG_TO_RADS,this.alpha=this.alphaList.current.value,this.scale.x=this.scale.y=this.scaleList.current.value,this._doAlpha=!!this.alphaList.current.next,this._doSpeed=!!this.speedList.current.next,this._doScale=!!this.scaleList.current.next,this._doColor=!!this.colorList.current.next,this._doAcceleration=0!==this.acceleration.x||0!==this.acceleration.y,this._doNormalMovement=this._doSpeed||0!==this.speedList.current.value||this._doAcceleration,this._oneOverLife=1/this.maxLife;var color=this.colorList.current.value;this.tint=ParticleUtils_1.default.combineRGBComponents(color.r,color.g,color.b),this.visible=!0},Particle.prototype.applyArt=function(art){this.texture=art||PIXI.Texture.EMPTY},Particle.prototype.update=function(delta){if(this.age+=delta,this.age>=this.maxLife||this.age<0)return this.kill(),-1;var lerp=this.age*this._oneOverLife;if(this.ease&&(lerp=4==this.ease.length?this.ease(lerp,0,1,1):this.ease(lerp)),this._doAlpha&&(this.alpha=this.alphaList.interpolate(lerp)),this._doScale){var scale=this.scaleList.interpolate(lerp)*this.scaleMultiplier;this.scale.x=this.scale.y=scale}if(this._doNormalMovement){if(this._doSpeed){var speed=this.speedList.interpolate(lerp)*this.speedMultiplier;ParticleUtils_1.default.normalize(this.velocity),ParticleUtils_1.default.scaleBy(this.velocity,speed)}else if(this._doAcceleration&&(this.velocity.x+=this.acceleration.x*delta,this.velocity.y+=this.acceleration.y*delta,this.maxSpeed)){var currentSpeed=ParticleUtils_1.default.length(this.velocity);currentSpeed>this.maxSpeed&&ParticleUtils_1.default.scaleBy(this.velocity,this.maxSpeed/currentSpeed)}this.position.x+=this.velocity.x*delta,this.position.y+=this.velocity.y*delta}return this._doColor&&(this.tint=this.colorList.interpolate(lerp)),0!==this.rotationSpeed?this.rotation+=this.rotationSpeed*delta:this.acceleration&&!this.noRotation&&(this.rotation=Math.atan2(this.velocity.y,this.velocity.x)),lerp},Particle.prototype.kill=function(){this.emitter.recycle(this)},Particle.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.Sprite_destroy(),this.emitter=this.velocity=this.colorList=this.scaleList=this.alphaList=this.speedList=this.ease=this.next=this.prev=null},Particle.parseArt=function(art){var i;for(i=art.length;0<=i;--i)"string"==typeof art[i]&&(art[i]=PIXI.Texture.fromImage(art[i]));if(ParticleUtils_1.default.verbose)for(i=art.length-1;0<i;--i)if(art[i].baseTexture!=art[i-1].baseTexture){window.console&&console.warn("PixiParticles: using particle textures from different images may hinder performance in WebGL");break}return art},Particle.parseData=function(extraData){return extraData},Particle}(PIXI.Sprite);exports.default=Particle},{"./ParticleUtils":4,"./PropertyList":7}],4:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BLEND_MODES=PIXI.BLEND_MODES,PropertyNode_1=_dereq_("./PropertyNode"),ParticleUtils={verbose:!1,DEG_TO_RADS:Math.PI/180,rotatePoint:function(angle,p){if(angle){angle*=ParticleUtils.DEG_TO_RADS;var s=Math.sin(angle),c=Math.cos(angle),xnew=p.x*c-p.y*s,ynew=p.x*s+p.y*c;p.x=xnew,p.y=ynew}},combineRGBComponents:function(r,g,b){return r<<16|g<<8|b},normalize:function(point){var oneOverLen=1/ParticleUtils.length(point);point.x*=oneOverLen,point.y*=oneOverLen},scaleBy:function(point,value){point.x*=value,point.y*=value},length:function(point){return Math.sqrt(point.x*point.x+point.y*point.y)},hexToRGB:function(color,output){var alpha;return output||(output={}),"#"==color.charAt(0)?color=color.substr(1):0===color.indexOf("0x")&&(color=color.substr(2)),8==color.length&&(alpha=color.substr(0,2),color=color.substr(2)),output.r=parseInt(color.substr(0,2),16),output.g=parseInt(color.substr(2,2),16),output.b=parseInt(color.substr(4,2),16),alpha&&(output.a=parseInt(alpha,16)),output},generateEase:function(segments){var qty=segments.length,oneOverQty=1/qty;return function(time){var t,s,i=qty*time|0;return t=(time-i*oneOverQty)*qty,(s=segments[i]||segments[qty-1]).s+t*(2*(1-t)*(s.cp-s.s)+t*(s.e-s.s))}},getBlendMode:function(name){if(!name)return BLEND_MODES.NORMAL;for(name=name.toUpperCase();0<=name.indexOf(" ");)name=name.replace(" ","_");return BLEND_MODES[name]||BLEND_MODES.NORMAL},createSteppedGradient:function(list,numSteps){void 0===numSteps&&(numSteps=10),("number"!=typeof numSteps||numSteps<=0)&&(numSteps=10);var first=new PropertyNode_1.default(list[0].value,list[0].time);first.isStepped=!0;for(var currentNode=first,current=list[0],nextIndex=1,next=list[nextIndex],i=1;i<numSteps;++i){for(var lerp=i/numSteps;lerp>next.time;)current=next,next=list[++nextIndex];lerp=(lerp-current.time)/(next.time-current.time);var curVal=ParticleUtils.hexToRGB(current.value),nextVal=ParticleUtils.hexToRGB(next.value),output={};output.r=(nextVal.r-curVal.r)*lerp+curVal.r,output.g=(nextVal.g-curVal.g)*lerp+curVal.g,output.b=(nextVal.b-curVal.b)*lerp+curVal.b,currentNode.next=new PropertyNode_1.default(output,i/numSteps),currentNode=currentNode.next}return first}};exports.default=ParticleUtils},{"./PropertyNode":8}],5:[function(_dereq_,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var ParticleUtils_1=_dereq_("./ParticleUtils"),Particle_1=_dereq_("./Particle"),helperPoint=new PIXI.Point,MATH_FUNCS=["pow","sqrt","abs","floor","round","ceil","E","PI","sin","cos","tan","asin","acos","atan","atan2","log"],WHITELISTER=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(MATH_FUNCS).join("|"),"g"),PathParticle=function(_super){function PathParticle(emitter){var _this=_super.call(this,emitter)||this;return _this.path=null,_this.initialRotation=0,_this.initialPosition=new PIXI.Point,_this.movement=0,_this}return __extends(PathParticle,_super),PathParticle.prototype.init=function(){this.initialRotation=this.rotation,this.Particle_init(),this.path=this.extraData.path,this._doNormalMovement=!this.path,this.movement=0,this.initialPosition.x=this.position.x,this.initialPosition.y=this.position.y},PathParticle.prototype.update=function(delta){var lerp=this.Particle_update(delta);if(0<=lerp&&this.path){var speed=this.speedList.interpolate(lerp)*this.speedMultiplier;this.movement+=speed*delta,helperPoint.x=this.movement,helperPoint.y=this.path(this.movement),ParticleUtils_1.default.rotatePoint(this.initialRotation,helperPoint),this.position.x=this.initialPosition.x+helperPoint.x,this.position.y=this.initialPosition.y+helperPoint.y}return lerp},PathParticle.prototype.destroy=function(){this.Particle_destroy(),this.path=this.initialPosition=null},PathParticle.parseArt=function(art){return Particle_1.default.parseArt(art)},PathParticle.parseData=function(extraData){var output={};if(extraData&&extraData.path)try{output.path=function(pathString){for(var matches=pathString.match(WHITELISTER),i=matches.length-1;0<=i;--i)0<=MATH_FUNCS.indexOf(matches[i])&&(matches[i]="Math."+matches[i]);return pathString=matches.join(""),new Function("x","return "+pathString+";")}(extraData.path)}catch(e){ParticleUtils_1.default.verbose&&console.error("PathParticle: error in parsing path expression"),output.path=null}else ParticleUtils_1.default.verbose&&console.error("PathParticle requires a path string in extraData!"),output.path=null;return output},PathParticle}(Particle_1.default);exports.default=PathParticle},{"./Particle":3,"./ParticleUtils":4}],6:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var PolygonalChain=function(){function PolygonalChain(data){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(data)}return PolygonalChain.prototype.init=function(data){if(data&&data.length)if(Array.isArray(data[0]))for(var i=0;i<data.length;++i)for(var chain=data[i],prevPoint=chain[0],j=1;j<chain.length;++j){var second=chain[j];this.segments.push({p1:prevPoint,p2:second,l:0}),prevPoint=second}else for(prevPoint=data[0],i=1;i<data.length;++i){second=data[i];this.segments.push({p1:prevPoint,p2:second,l:0}),prevPoint=second}else this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});for(i=0;i<this.segments.length;++i){var _a=this.segments[i],p1=_a.p1,p2=_a.p2,segLength=Math.sqrt((p2.x-p1.x)*(p2.x-p1.x)+(p2.y-p1.y)*(p2.y-p1.y));this.segments[i].l=segLength,this.totalLength+=segLength,this.countingLengths.push(this.totalLength)}},PolygonalChain.prototype.getRandomPoint=function(out){var chosenSeg,lerp,rand=Math.random()*this.totalLength;if(1===this.segments.length)chosenSeg=this.segments[0],lerp=rand;else for(var i=0;i<this.countingLengths.length;++i)if(rand<this.countingLengths[i]){chosenSeg=this.segments[i],lerp=0===i?rand:rand-this.countingLengths[i-1];break}lerp/=chosenSeg.l||1;var p1=chosenSeg.p1,p2=chosenSeg.p2;out.x=p1.x+lerp*(p2.x-p1.x),out.y=p1.y+lerp*(p2.y-p1.y)},PolygonalChain}();exports.default=PolygonalChain},{}],7:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ParticleUtils_1=_dereq_("./ParticleUtils"),PropertyList=function(){function PropertyList(isColor){void 0===isColor&&(isColor=!1),this.current=null,this.next=null,this.isColor=!!isColor,this.interpolate=null,this.ease=null}return PropertyList.prototype.reset=function(first){this.current=first,this.next=first.next,this.next&&1<=this.next.time?this.interpolate=this.isColor?intColorSimple:intValueSimple:first.isStepped?this.interpolate=this.isColor?intColorStepped:intValueStepped:this.interpolate=this.isColor?intColorComplex:intValueComplex,this.ease=this.current.ease},PropertyList}();function intValueSimple(lerp){return this.ease&&(lerp=this.ease(lerp)),(this.next.value-this.current.value)*lerp+this.current.value}function intColorSimple(lerp){this.ease&&(lerp=this.ease(lerp));var curVal=this.current.value,nextVal=this.next.value,r=(nextVal.r-curVal.r)*lerp+curVal.r,g=(nextVal.g-curVal.g)*lerp+curVal.g,b=(nextVal.b-curVal.b)*lerp+curVal.b;return ParticleUtils_1.default.combineRGBComponents(r,g,b)}function intValueComplex(lerp){for(this.ease&&(lerp=this.ease(lerp));lerp>this.next.time;)this.current=this.next,this.next=this.next.next;return lerp=(lerp-this.current.time)/(this.next.time-this.current.time),(this.next.value-this.current.value)*lerp+this.current.value}function intColorComplex(lerp){for(this.ease&&(lerp=this.ease(lerp));lerp>this.next.time;)this.current=this.next,this.next=this.next.next;lerp=(lerp-this.current.time)/(this.next.time-this.current.time);var curVal=this.current.value,nextVal=this.next.value,r=(nextVal.r-curVal.r)*lerp+curVal.r,g=(nextVal.g-curVal.g)*lerp+curVal.g,b=(nextVal.b-curVal.b)*lerp+curVal.b;return ParticleUtils_1.default.combineRGBComponents(r,g,b)}function intValueStepped(lerp){for(this.ease&&(lerp=this.ease(lerp));this.next&&lerp>this.next.time;)this.current=this.next,this.next=this.next.next;return this.current.value}function intColorStepped(lerp){for(this.ease&&(lerp=this.ease(lerp));this.next&&lerp>this.next.time;)this.current=this.next,this.next=this.next.next;var curVal=this.current.value;return ParticleUtils_1.default.combineRGBComponents(curVal.r,curVal.g,curVal.b)}exports.default=PropertyList},{"./ParticleUtils":4}],8:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ParticleUtils_1=_dereq_("./ParticleUtils"),PropertyNode=function(){function PropertyNode(value,time,ease){this.value="string"==typeof value?ParticleUtils_1.default.hexToRGB(value):value,this.time=time,this.next=null,this.isStepped=!1,this.ease=ease?"function"==typeof ease?ease:ParticleUtils_1.default.generateEase(ease):null}return PropertyNode.createList=function(data){if(Array.isArray(data.list)){var array=data.list,node=void 0,first=void 0;if(first=node=new PropertyNode(array[0].value,array[0].time,data.ease),2<array.length||2===array.length&&array[1].value!==array[0].value)for(var i=1;i<array.length;++i)node.next=new PropertyNode(array[i].value,array[i].time),node=node.next;return first.isStepped=!!data.isStepped,first}var start=new PropertyNode(data.start,0);return data.end!==data.start&&(start.next=new PropertyNode(data.end,1)),start},PropertyNode}();exports.default=PropertyNode},{"./ParticleUtils":4}],9:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ParticleUtils_js_1=_dereq_("./ParticleUtils.js");exports.ParticleUtils=ParticleUtils_js_1.default;var Particle_js_1=_dereq_("./Particle.js");exports.Particle=Particle_js_1.default;var Emitter_js_1=_dereq_("./Emitter.js");exports.Emitter=Emitter_js_1.default;var PathParticle_js_1=_dereq_("./PathParticle.js");exports.PathParticle=PathParticle_js_1.default;var AnimatedParticle_js_1=_dereq_("./AnimatedParticle.js");exports.AnimatedParticle=AnimatedParticle_js_1.default},{"./AnimatedParticle.js":1,"./Emitter.js":2,"./Particle.js":3,"./ParticleUtils.js":4,"./PathParticle.js":5}],10:[function(_dereq_,module,exports){"use strict";if(Object.defineProperty(exports,"__esModule",{value:!0}),"undefined"==typeof PIXI)throw"pixi-particles requires pixi.js to be loaded first";PIXI.particles||(PIXI.particles={});var particles=_dereq_("./particles");for(var prop in particles)PIXI.particles[prop]=particles[prop];void 0!==module&&module.exports&&(module.exports=particles)},{"./particles":9}]},{},[10])(10)}),function(){"use strict";var b,c,d,a;"extend"in(a=window)||(a.extend=function(b,c){if(c){"string"==typeof c&&(c=a.include(c));var d=c.prototype;b.prototype=Object.create(d),Object.defineProperty(b.prototype,"__parent",{configurable:!0,writable:!0,value:d})}return Object.defineProperty(b.prototype,"constructor",{configurable:!0,writable:!0,value:b}),b.extend=function(c){return a.extend(c,b)},b.prototype}),function(a){if(!("include"in a)){a.include=function(c,d){var e=c.split("."),f=a,g="";d=void 0===d||!!d;for(var h=0,i=e.length;h<i;h++){if(!f[g=e[h]]){if(!d)return null;throw"Unable to include '"+c+"'"}f=f[g]}return f}}}(window),function(a,b){if(!("mixin"in a)){a.mixin=function(c,d){if("string"==typeof d&&(d=a.include(d)),!d.prototype)throw"no mixin prototype";var e=d.prototype;for(var f in e){var g=b.getOwnPropertyDescriptor(e,f);g?b.defineProperty(c,f,g):c[f]=e[f]}return d.apply(c,Array.prototype.slice.call(arguments,2)),c}}}(window,Object),function(a){if(!("namespace"in a)){a.namespace=function(b){for(var c=b.split("."),d=a,e="",f=0,g=c.length;f<g;f++)d[e=c[f]]=d[e]||{},d=d[e];return d}}}(window),function(a,b,c){a.prototype.shuffle||c.defineProperty(a.prototype,"shuffle",{enumerable:!1,writable:!1,value:function(){for(var a,c,d=this.length;d;a=b.floor(b.random()*d),c=this[--d],this[d]=this[a],this[a]=c);return this}}),a.prototype.random||c.defineProperty(a.prototype,"random",{enumerable:!1,writable:!1,value:function(){return this[b.floor(b.random()*this.length)]}}),a.prototype.last||c.defineProperty(a.prototype,"last",{enumerable:!1,writable:!1,value:function(){return this[this.length-1]}}),a.prototype.append||c.defineProperty(a.prototype,"append",{enumerable:!1,writable:!1,value:function(){for(var b=arguments,c=0,d=b.length;c<d;++c){var e=b[c];if(a.isArray(e))for(var f=0,g=e.length;f<g;++f)this.push(e[f]);else this.push(e)}return this}})}(Array,Math,Object),function(a){a.randomInt=function(b,c){return void 0===c&&(c=b,b=0),a.floor(a.random()*(c-b+1))+b},a.randomFloat=function(b,c){return void 0===c&&(c=b,b=0),a.random()*(c-b)+b},a.dist=function(b,c,d,e){return a.sqrt(a.distSq(b,c,d,e))},a.distSq=function(a,b,c,d){return"number"==typeof a.x&&a.x==a.x&&(d=c,c=b,b=a.y,a=a.x),"number"==typeof c.x&&c.x==c.x&&(d=c.y,c=c.x),(a-c)*(a-c)+(b-d)*(b-d)},a.clamp=function(a,b,c){return void 0===c&&(c=b,b=0),c<a?c:a<b?b:a},a.roundDecimal=function(b,c){return a.round(b/c)*c}}(Math),function(a,b){a.prototype.toPaddedString||b.defineProperty(a.prototype,"toPaddedString",{enumerable:!1,writable:!1,value:function(a){a||(a=2);var b,c=this;c<0&&(c*=-1,b="-");for(var d=String(Math.floor(c));d.length<a;)d="0"+d;return b&&(d=b+d),d}})}(Number,Object),function(a,b){a.merge=function(b,c){for(var d in b&&"object"==typeof b||(b={}),c)if(c.hasOwnProperty(d)){var e=c[d];if("object"==typeof e&&a.isPlain(e)){b[d]=a.merge(b[d],e);continue}b[d]=e}for(var f=2,g=arguments.length;f<g;f++)a.merge(b,arguments[f]);return b},a.isPlain=function(a){var d,e=b.hasOwnProperty;if(!a||"object"!=typeof a||a.nodeType||a===window)return!1;try{if(a.constructor&&!e.call(a,"constructor")&&!e.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(f){return!1}if(b.ownLast)for(d in a)return e.call(a,d);for(d in a);return void 0===d||e.call(a,d)},a.prototype.clone||a.defineProperty(a.prototype,"clone",{enumerable:!1,writable:!0,value:function(){var a={};for(var c in this)a[c]=this[c];return a}})}(Object,{}),function(){var a=include("createjs.RequestUtils",!1),b=include("createjs.AbstractLoader",!1);if(a){var c=a.getTypeByExtension;a.getTypeByExtension=function(a){if(a)switch(a.toLowerCase()){case"fnt":return b.XML}return c(a)}}}(),function(a,b){b.defineProperty(a.prototype,"format",{enumerable:!1,writable:!1,value:function(){if(arguments.length<1)return this;var a=Array.isArray(a)?a:Array.prototype.slice.call(arguments);return this.replace(/([^%]|^)%(?:(\d+)\$)?s/g,function(b,c,d){return d?c+a[parseInt(d)-1]:c+a.shift()}).replace(/%%s/g,"%s")}}),a.prototype.reverse||b.defineProperty(a.prototype,"reverse",{enumerable:!1,writable:!1,value:function(){for(var a="",b=this.length-1;0<=b;b--)a+=this[b];return a}})}(String,Object),function(){function a(){this.currentCallCount=0}var b={create:function(b,c){if(!b)return null;("number"!=typeof c||c<1)&&(c=2);var d=function(){++d.currentCallCount>=c&&b()};return d.currentCallCount=0,d.reset=a,d}};namespace("springroll").CombinedCallback=b}(),c=function(c,d,e,f,g){b||(b=include("springroll.Application")),"boolean"==typeof e&&(e={repeat:!!e,autoDestroy:void 0===f||!!f,useFrames:!!g}),e=Object.merge({repeat:!1,autoDestroy:!0,useFrames:!1},e||{}),this._callback=c,this._delay=d,this._timer=d,this._repeat=e.repeat,this._autoDestroy=e.autoDestroy,this._useFrames=e.useFrames,this._paused=!1,this._update=this._update.bind(this),b.instance.on("update",this._update)},(d=extend(c))._update=function(a){this._callback?(this._timer-=this._useFrames?1:a,this._timer<=0&&(this._callback(this),this._repeat?this._timer+=this._delay:this._autoDestroy?this.destroy():b.instance.off("update",this._update))):this.destroy()},d.restart=function(){if(this._callback){var a=b.instance;a.has("update",this._update)||a.on("update",this._update),this._timer=this._delay,this._paused=!1}},d.stop=function(){b.instance.off("update",this._update),this._paused=!1},Object.defineProperty(d,"paused",{get:function(){return this._paused},set:function(a){if(this._callback){var c=b.instance;this._paused&&!a?(this._paused=!1,c.has("update",this._update)||c.on("update",this._update)):a&&c.has("update",this._update)&&(this._paused=!0,c.off("update",this._update))}}}),d.destroy=function(){b.instance.off("update",this._update),this._callback=null},namespace("springroll").DelayedCall=c,function(){var a,b=function(b,c,d){void 0===a&&(a=include("springroll.Debug",!1)),this.name=b,this._value=c,this._toString=d||this.name};Object.defineProperty(b.prototype,"asInt",{get:function(){return this._value}}),b.prototype.toString=function(){return this._toString};var c=function(){var a=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);Object.defineProperty(this,"_byValue",{enumerable:!1,writable:!1,value:[]}),Object.defineProperty(this,"rawEnumValues",{enumerable:!1,writable:!1,value:a});for(var c,d,e,f=0,g=0,h=a.length;g<h;++g)"string"==typeof a[g]?e=a[g]:(e=a[g].name,d=a[g].value||f,f=d),this[e]||(this[(c="string"==typeof a[g]?new b(e,f,e):new b(e,d,a[g].toString||e)).name]=c,this._byValue[f]?Array.isArray(this._byValue[f])?this._byValue[f].push(c):this._byValue[f]=[this._byValue[f],c]:this._byValue[f]=c,f++);Object.defineProperty(this,"length",{enumerable:!1,writable:!1,value:a.length}),Object.defineProperty(this,"next",{enumerable:!1,writable:!1,value:function(a){var b=a.asInt+1;return f<=b?this.first:this.valueFromInt(b)}}),Object.defineProperty(this,"first",{enumerable:!1,writable:!1,value:this.valueFromInt(a[0].value||0)}),Object.defineProperty(this,"last",{enumerable:!1,writable:!1,value:this.valueFromInt(f-1)})},d=extend(c);Object.defineProperty(d,"valueFromInt",{enumerable:!1,writable:!1,value:function(a){var b=this._byValue[a];return b?Array.isArray(b)?b[0]:b:null}}),namespace("springroll").Enum=c}(),function(){var b={},c=void 0!==window.Storage;if(c)try{localStorage.setItem("LS_TEST","test"),localStorage.removeItem("LS_TEST")}catch(e){c=!1}b.remove=function(a){c?(localStorage.removeItem(a),sessionStorage.removeItem(a)):b.write(a,"",-1)},b.write=function(a,b,e){var f;c?e?sessionStorage.setItem(a,JSON.stringify(b)):localStorage.setItem(a,JSON.stringify(b)):(f=e?-1!==e?"":"; expires=Thu, 01 Jan 1970 00:00:00 GMT":"; expires="+new Date(2147483646e3).toGMTString(),document.cookie=a+"="+escape(JSON.stringify(b))+f+"; path=/")},b.read=function(a){if(c){var d=localStorage.getItem(a)||sessionStorage.getItem(a);return d?JSON.parse(d,b.reviver):null}var e,f,g=a+"=",h=document.cookie.split(";"),i=0;for(i=0,f=h.length;i<f;i++){for(e=h[i];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(g))return JSON.parse(unescape(e.substring(g.length,e.length)),b.reviver)}return null},b.reviver=function(a,b){if(b&&"string"==typeof b.__classname){var c=include(b.__classname,!1);if(c){var d=new c;if(d.fromJSON)return d.fromJSON(b),d}}return b},namespace("springroll").SavedData=b}(),function(){var b=include("performance",!1),c=b&&(b.now||b.mozNow||b.msNow||b.oNow||b.webkitNow);c&&(b.now=c);var d={};d.now=c?function(){return b.now()}:Date.now,namespace("springroll").TimeUtils=d}(window),function(){var a=function(a){this.max=-1,this.options=[];var b=0;for(var c in a)b+=a[c],this.options.push({key:c,value:b}),this.max+=a[c]};extend(a).random=function(){for(var a=Math.randomInt(0,this.max),b=0,c=this.options,d=c.length;b<d;++b)if(a<c[b].value)return c[b].key;return null},namespace("springroll").WeightedRandom=a}(),function(){for(var a=["ms","moz","webkit","o"],b=a.length,c=0;c<b&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[a[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[c]+"CancelAnimationFrame"]||window[a[c]+"CancelRequestAnimationFrame"];if(!window.requestAnimationFrame){var d=include("springroll.TimeUtils"),e=0;window.requestAnimationFrame=function(a){var b=d.now(),c=Math.max(0,16-(b-e)),f=window.setTimeout(function(){a(b+c)},c);return e=b+c,f},window.cancelAnimationFrame=function(a){clearTimeout(a)}}window.requestAnimFrame=window.requestAnimationFrame}(),function(a){function b(a,b){return a._priority-b._priority}function c(a){if(null===a)return"null";var b=typeof a;return"object"==b||"function"==b?Object.prototype.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":b}function d(){this._listeners={},this._destroyed=!1}var e=extend(d);Object.defineProperty(e,"destroyed",{enumerable:!0,get:function(){return this._destroyed}}),e.trigger=function(b){if(!this._destroyed&&this._listeners.hasOwnProperty(b)&&this._listeners[b]!==a){var c,d=this._listeners[b].slice();1<arguments.length&&(c=Array.prototype.slice.call(arguments,1));for(var e=d.length-1;0<=e;--e){var f=d[e];f._eventDispatcherOnce&&(delete f._eventDispatcherOnce,this.off(b,f)),f.apply(this,c)}}},e.once=function(a,b,c){return this.on(a,b,c,!0)},e.on=function(a,d,e,f){if(!this._destroyed){if("object"===c(a))for(var g in a)a.hasOwnProperty(g)&&this.on(g,a[g],e,f);else if("function"===c(d))for(var h,i=a.split(" "),j=null,k=0,l=i.length;k<l;k++)j=i[k],h=this._listeners.hasOwnProperty(j)?this._listeners[j]:this._listeners[j]=[],f&&(d._eventDispatcherOnce=!0),d._priority=parseInt(e)||0,-1===h.indexOf(d)&&(h.push(d),1<h.length&&h.sort(b));else if(Array.isArray(d))for(var m=0,n=d.length;m<n;m++)this.on(a,d[m],e,f);return this}},e.off=function(b,c){if(!this._destroyed){if(b===a)this._listeners={};else if(Array.isArray(c))for(var d=0,e=c.length;d<e;d++)this.off(b,c[d]);else for(var f,g,h=b.split(" "),i=null,j=0,k=h.length;j<k;j++)i=h[j],this._listeners.hasOwnProperty(i)&&(f=this._listeners[i],c===a?f.length=0:-1!==(g=f.indexOf(c))&&f.splice(g,1));return this}},e.has=function(a,b){if(!a||!this._listeners.hasOwnProperty(a))return!1;var c=this._listeners[a];return!!c&&(b?0<=c.indexOf(b):0<c.length)},e.destroy=function(){this._destroyed=!0,this._listeners=null},namespace("springroll").EventDispatcher=d}(),function(a){function c(){b.call(this),this._properties={}}var b=include("springroll.EventDispatcher"),d=b.prototype,e=b.extend(c);e.add=function(b,c,d){var e=this._properties,i=e[b];if(i!==a)return i.setValue(c),i.setReadOnly(d===a?i.readOnly:d),this;if(this.hasOwnProperty(b))throw"Object already has property "+b;return e[b]=new h(b,c,d),Object.defineProperty(this,b,{get:function(a){var b=this._properties[a];if(b.responder){var c=b.responder();return b.value=c}return b.value}.bind(this,b),set:function(a,b){var c=this._properties[a];if(c.readOnly)throw"Property '"+a+"' is read-only";c.value!=(c.value=b)&&this.trigger(a,b)}.bind(this,b)}),this},e.respond=function(b,c){var d=this._properties[b];if(d===a)throw"Property "+b+" does not exist";return d.responder=c,d.value=c(),this},e.destroy=function(){var a;for(var b in this._properties)(a=this._properties[b]).value=null,a.responder=null;this._properties=null,d.destroy.call(this)};var h=function(a,b,c){this.name=a,this.setValue(b),this.setReadOnly(c),this.responder=null};h.prototype.setValue=function(b){this.value=b===a?null:b},h.prototype.setReadOnly=function(b){this.readOnly=b!==a&&!!b},namespace("springroll").PropertyDispatcher=c}(),function(a){var b,c=include("springroll.PropertyDispatcher"),d=function(d,e){b===a&&(b=include("springroll.Debug",!1)),c.call(this),this._options=e||{},this._app=d},e=c.extend(d);e.init=function(){var a=this._options;for(var b in this._app,(a=Object.merge({},a)).useQueryString&&Object.merge(a,f()),a)this.add(b,a[b]);var c=this._properties;for(var d in c)this.trigger(d,c[d].value)};var f=function(){var b={},c=window.location.search;if(!c)return b;for(var f,d=c.substr(c.indexOf("?")+1),e=d.indexOf("#"),g=(d=e<0?d:d.substring(0,e)).split("&"),h=0,i=g.length;h<i;h++){var j=(f=g[h].split("="))[1];"true"===j||j===a?j=!0:"false"===j&&(j=!1),b[f[0]]=j}return b};e.asDOMElement=function(a){var b=this._properties[a];b&&b.value&&"string"==typeof b.value&&(b.value=document.getElementById(b.value))},e.override=function(b,c){var d=this._properties[b];if(d===a)throw"Invalid override "+b;return d.setValue(c),this},namespace("springroll").ApplicationOptions=d}(),function(){var a;namespace("springroll").ApplicationPlugin=function(b){a||(a=include("springroll.Application")),this.priority=b||0,this.setup=function(){},this.preload=null,this.teardown=function(){},a._plugins.push(this),a._plugins.sort(function(a,b){return b.priority-a.priority})}}(),function(){var b=include("springroll.TimeUtils"),c=include("springroll.EventDispatcher"),d=include("springroll.ApplicationOptions"),e=include("springroll.DelayedCall"),f=function(a,b){if(r)throw"Only one Application can be opened at a time";r=this,c.call(this),this.options=new d(this,a),this.display=null,this.init=b||null,this.pluginLoad=null,q={},p=[],j=this._tick.bind(this),f._plugins.forEach(function(a){a.setup.call(r)}),this.options.init(),this.name=this.options.name,setTimeout(this._preInit.bind(this),0)};f.version="1.1.1";var g=c.prototype,h=c.extend(f);f._plugins=[];var i=0,j=null,k=!1,l=!0,m=-1,n=!1,o=0,p=null,q=null,r=null;Object.defineProperty(f,"instance",{get:function(){return r}}),h._preInit=function(){if(!this.destroyed){var a=this.options;n=a.raf,a.on("raf",function(a){n=a}),a.on("fps",function(a){"number"==typeof a&&(o=1e3/a|0)}),a.canvasId&&a.display&&this.addDisplay(a.canvasId,a.display,a.displayOptions);var b=[];f._plugins.forEach(function(a){a.preload&&b.push(a.preload.bind(r))}),this.pluginLoad=this.load(b,{complete:this._doInit.bind(this),progress:s.bind(this),autoStart:!1,startAll:!1}),this.pluginLoad.start()}};var s=function(a){this.trigger("pluginProgress",a)};h._doInit=function(){this.destroyed||(this.pluginLoad=null,this.trigger("beforeInit"),this.paused=!1,this.trigger("init"),this.init&&this.init.call(this),this.trigger("afterInit"))},Object.defineProperty(h,"enabled",{set:function(a){l=a,p.forEach(function(b){b.enabled=a})},get:function(){return l}}),Object.defineProperty(h,"paused",{get:function(){return k},set:function(a){k=!!a,this.internalPaused(k)}}),h.internalPaused=function(a){this.trigger("pause",a),this.trigger(a?"paused":"resumed",a),a?-1!=m&&(n?cancelAnimationFrame(m):clearTimeout(m),m=-1):-1==m&&j&&(i=b.now(),m=n?requestAnimFrame(j):t(j))};var t=function(a,b){var c=o;return b&&(c=Math.max(0,o-b)),setTimeout(a,c)};h.addDisplay=function(a,b,c){if(q[a])throw"Display exists with id '"+a+"'";var d=new b(a,c);return q[a]=d,p.push(d),d.enabled=l,this.display||(this.display=d),this.trigger("displayAdded",d),d},Object.defineProperty(h,"displays",{get:function(){return p}}),h.getDisplay=function(a){return q[a]},h.removeDisplay=function(a){var b=q[a];b&&(p.splice(p.indexOf(b),1),b.destroy(),delete q[a],this.trigger("displayRemoved",a))},h._tick=function(){if(k)m=-1;else{var a=b.now(),c=a-i;if(i=a,this.trigger("update",c),p)for(var d=0;d<p.length;d++)p[d].render(c);j&&(m=n?requestAnimFrame(j):t(j,b.now()-i))}},h.setTimeout=function(a,b,c,d){return new e(a,b,!1,d,c)},h.setInterval=function(a,b,c){return new e(a,b,!0,!1,c)},h.destroy=function(){this.destroyed||(this.paused=!0,this.trigger("destroy"),f._plugins.slice().reverse().forEach(function(a){a.teardown.call(r)}),p.forEach(function(a){a.destroy()}),r=j=q=p=null,this.display=null,this.options.destroy(),this.options=null,g.destroy.call(this))},h.toString=function(){return"[Application name='"+this.name+"']"},namespace("springroll").Application=f}(),function(){var a=include("springroll.ApplicationPlugin"),b=include("createjs.Tween",!1),c=include("createjs.Ticker",!1);new a(120).setup=function(){var a=this.options;a.add("raf",!0,!0),a.add("fps",60,!0),a.add("useQueryString",!1,!0),a.add("canvasId",null,!0),a.add("display",null,!0),a.add("displayOptions",null,!0);var d=this;a.add("updateTween",!0,!0).on("updateTween",function(a){b&&(c&&c.setPaused(!!a),d.off("update",b.tick),a&&d.on("update",b.tick))}),a.add("name","",!0)}}(),function(a,b,c){var d=function(a,d){this._onFocus=a,this._onBlur=d,this._enabled=!1,!f&&b.onfocusin===c||(this._onToggle=function(){b.hidden||b.webkitHidden||b.msHidden||b.mozHidden?this._onBlur():this._onFocus()}.bind(this),this.enabled=!0)},e=extend(d),f=null;b.hidden!==c?f="visibilitychange":b.mozHidden!==c?f="mozvisibilitychange":b.msHidden!==c?f="msvisibilitychange":b.webkitHidden!==c&&(f="webkitvisibilitychange");var g=!f&&b.onfocusin!==c;Object.defineProperty(e,"enabled",{get:function(){return this._enabled},set:function(c){c=!!c,this._enabled!=c&&(this._enabled=c,a.removeEventListener("pagehide",this._onBlur),a.removeEventListener("pageshow",this._onFocus),a.removeEventListener("blur",this._onBlur),a.removeEventListener("focus",this._onFocus),a.removeEventListener("visibilitychange",this._onToggle),b.removeEventListener(f,this._onToggle,!1),g&&(b.removeEventListener("focusin",this._onFocus),b.removeEventListener("focusout",this._onBlur)),c&&(b.addEventListener(f,this._onToggle,!1),a.addEventListener("pagehide",this._onBlur),a.addEventListener("pageshow",this._onFocus),a.addEventListener("blur",this._onBlur),a.addEventListener("focus",this._onFocus),a.addEventListener("visibilitychange",this._onToggle,!1),g&&(b.addEventListener("focusin",this._onFocus),b.addEventListener("focusout",this._onBlur))))}}),e.destroy=function(){f&&this._onToggle&&(this.enabled=!1,this._onToggle=null,this._onFocus=null,this._onBlur=null)},namespace("springroll").PageVisibility=d}(window,document),function(){var b=new(include("springroll.ApplicationPlugin"));b.setup=function(){var a=include("springroll.PageVisibility"),b=this._visibility=new a(d.bind(this),c.bind(this));this.options.add("autoPause",!0).on("autoPause",function(a){b.enabled=a}).respond("autoPause",function(){return b.enabled}),Object.defineProperty(this,"autoPaused",{set:function(a){this.paused||this.internalPaused(a)}})};var c=function(){this.autoPaused=!0},d=function(){this.autoPaused=!1};b.teardown=function(){this._visibility&&this._visibility.destroy(),this._visibility=null}}(),function(){function a(){this._filters=[]}var b=extend(a);b.add=function(a,b){if(!a||"string"!=typeof a&&a instanceof RegExp==0)throw"invalide replace value";if("string"!=typeof b)throw"invalid replacement value";if(this._filters){for(var c=this._filters.length-1;0<=c;c--)if(a.toString()==this._filters[c].replace.toString())throw"Filter already exists.";this._filters.push({replace:a,replacement:b})}},b.filter=function(a){if(!this._filters)return a;for(var b=this._filters.length-1;0<=b;b--){var c=this._filters[b].replace,d=this._filters[b].replacement;a=a.replace(c,d)}return a},b.destroy=function(){this._filters=null},namespace("springroll").StringFilters=a}(),function(){var b=new(include("springroll.ApplicationPlugin"))(110);b.setup=function(){var a=include("springroll.StringFilters");this.filters=new a},b.teardown=function(){this.filters&&this.filters.destroy(),this.filters=null}}(),function(){var a=include("springroll.ApplicationPlugin"),b=include("devicePixelRatio",!1),c=new a(100),d=null,e=0,f=0,g=0,h=0,i={width:0,height:0,normalWidth:0,normalHeight:0},j=null;c.setup=function(){var a=this.options;a.add("maxWidth",0),a.add("maxHeight",0),a.add("uniformResize",!0),a.add("responsive",!1,!0),a.add("resizeElement","frame",!0),a.add("enableHiDPI",!1),a.on("maxWidth",function(a){e=a}),a.on("maxHeight",function(a){f=a}),this.once("displayAdded",function(a){g=a.width,h=a.height,e||(e=g),f||(f=h)}),this.realWidth=0,this.realHeight=0,this.triggerResize=function(){if(d){i.width=0|(d.innerWidth||d.clientWidth),i.height=0|(d.innerHeight||d.clientHeight),this.calculateDisplaySize(i);var a=this.realWidth=i.width,c=this.realHeight=i.height,e=i.normalWidth,f=i.normalHeight,g=this.options.responsive,h=this.options.enableHiDPI;this.displays.forEach(function(d){g?(h&&b&&(d.canvas.style.width=a+"px",d.canvas.style.height=c+"px",a*=b,c*=b),d.resize(a,c)):(d.canvas.style.width=a+"px",d.canvas.style.height=c+"px",h&&b&&(e*=b,f*=b),d.resize(e,f))}),this.trigger("resize",g?a:e,g?c:f),this.displays.forEach(function(a){a.render(0,!0)})}},this.onWindowResize=function(){this.triggerResize(),j=this.setTimeout(function(){this.triggerResize(),j=null}.bind(this),500)},this.calculateDisplaySize=function(a){if(h&&this.options.uniformResize){var b=e/h,c=g/f,d=g/h,i=a.width/a.height;i<c?a.height=a.width/c:b<i&&(a.width=a.height*b),i=a.width/a.height,a.normalWidth=g,a.normalHeight=h,d<i?a.normalWidth=h*i:i<d&&(a.normalHeight=g/i),a.width=Math.ceil(a.width),a.height=Math.ceil(a.height),a.normalWidth=Math.ceil(a.normalWidth),a.normalHeight=Math.ceil(a.normalHeight)}},this.once("beforeInit",this.triggerResize)},c.preload=function(a){var b=this.options;b.asDOMElement("resizeElement"),b.resizeElement&&(d=b.resizeElement,this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize)),a()},c.teardown=function(){j&&(j.destroy(),j=null),d&&window.removeEventListener("resize",this.onWindowResize),d=null,i.width=i.height=i.normalWidth=i.normalHeight=g=h=f=e=0}}(),function(){function b(a){this._app=a,this._versions={},this._filters=[],this._globalVersion=null,this._applySpecificVersion=this._applySpecificVersion.bind(this),this._applyGlobalVersion=this._applyGlobalVersion.bind(this),this.cacheBust=!1}var c=extend(b);Object.defineProperty(c,"cacheBust",{get:function(){return!(!this._globalVersion||0!==this._globalVersion.indexOf("cb="))},set:function(a){if(a)this._globalVersion="cb="+Date.now(),this.unregisterURLFilter(this._applySpecificVersion),this.registerURLFilter(this._applyGlobalVersion);else{var b=this._app.options.version;this._globalVersion=b?"v="+b:null,this._globalVersion?(this.unregisterURLFilter(this._applySpecificVersion),this.registerURLFilter(this._applyGlobalVersion)):(this.unregisterURLFilter(this._applyGlobalVersion),this.registerURLFilter(this._applySpecificVersion))}}}),c.destroy=function(){this._app=null,this._versions=null,this._filters=null,this._applySpecificVersion=null,this._applyGlobalVersion=null},c.addVersionsFile=function(a,b,c){if(this.cacheBust)b&&b();else{this.addVersion(a,Date.now().toString()),a=this._applySpecificVersion(a);var d=this;this._app.load(a,function(a){if(a){var e,f,g=a.replace(/\r/g,"").split("\n");for(e=0,len=g.length;e<len;e++)g[e]&&(2==(f=g[e].split(" ")).length&&d.addVersion((c||"")+f[0],f[1]))}b&&b()})}},c.addVersion=function(a,b){this._versions[a]||(this._versions[a]=b)},c.registerURLFilter=function(a){-1==this._filters.indexOf(a)&&this._filters.push(a)},c.unregisterURLFilter=function(a){var b=this._filters.indexOf(a);-1<b&&this._filters.splice(b,1)},c._applySpecificVersion=function(a){var b=this._app.options.basePath;if(b&&0<b.indexOf("?"))return a;var c=this._versions[a];return c&&!1===/(\?|\&)v\=[0-9]*/.test(a)&&(a=a+(a.indexOf("?")<0?"?":"&")+"v="+c.version),a},c._applyGlobalVersion=function(a){if(!this._globalVersion)return a;var b=this._app.options.basePath;return b&&0<b.indexOf("?")||!1===(0===this._globalVersion.indexOf("cb=")?/(\?|\&)cb\=[0-9]*/:/(\?|\&)v\=/).test(a)&&(a=a+(a.indexOf("?")<0?"?":"&")+this._globalVersion),a},c._applyBasePath=function(a){var b=this._app.options.basePath;return b&&!1===/^http(s)?\:/.test(a)&&-1==a.search(b)&&(a=b+a),a},c.prepare=function(a,b){b&&(a=this._applyBasePath(a));for(var c=0,d=this._filters.length;c<d;++c)a=this._filters[c](a);return a},namespace("springroll").CacheManager=b}(),function(){var a,b=include("springroll.Application"),c=function(b,d){if(void 0===a&&(a=include("springroll.Debug",!1)),this.status=c.WAITING,this.complete=b.complete||null,this.cache=!!b.cache,this.id=b.id||null,this.type=b.type||null,this.original=b,this.cache&&!this.id){if(d&&"string"==typeof d){var e=d.lastIndexOf(".");-1<e&&(d=d.substr(0,e));var f=d.lastIndexOf("/");-1<f&&(d=d.substr(f+1)),b.id=this.id=d}this.id||(this.cache=!1)}},d=extend(c);c.WAITING=0,c.RUNNING=1,c.FINISHED=2,d.start=function(a){a()},d.filter=function(a){var c=b.instance.assetManager.sizes;if(a&&c.test(a)){var d=c.size(this.original.sizes);a=c.filter(a,d),this.original.scale=d.scale}return a},d.load=function(a,c){return b.instance.load(a,c)},d.simpleLoad=function(a,c,d,e){return b.instance.loader.load(a,c,d,e)},d.destroy=function(){this.status=c.FINISHED,this.id=null,this.type=null,this.complete=null,this.original=null},namespace("springroll").Task=c}(),function(){var a=include("springroll.Task"),b=function(b){a.call(this,b),this.async=b.async},c=a.extend(b);b.test=function(a){return!!a.async},c.start=function(a){this.async(a)},c.destroy=function(){a.prototype.destroy.call(this),this.async=null},namespace("springroll").FunctionTask=b}(),function(){var a=include("springroll.Task"),b=function(b){a.call(this,b,b.color),this.color=this.filter(b.color),this.alpha=this.filter(b.alpha)},c=a.extend(b);b.test=function(a){return!!a.color&&!!a.alpha},c.start=function(a){this.load({_alpha:this.alpha,_color:this.color},function(c){a(b.mergeAlpha(c._color,c._alpha)),c._color.src=c._alpha.src=""})},b.mergeAlpha=function(a,b,c){c||(c=document.createElement("canvas")),c.width=Math.max(b.width,a.width),c.height=Math.max(b.height,a.height);var d=c.getContext("2d");return d.save(),d.drawImage(a,0,0),d.globalCompositeOperation="destination-in",d.drawImage(b,0,0),d.restore(),c},namespace("springroll").ColorAlphaTask=b}(),function(){var a=include("springroll.Task"),b=function(b){a.call(this,b),this.assets=b.assets,this.cacheAll=b.cacheAll,this.progress=b.progress},c=a.extend(b);b.test=function(a){return!!a.assets&&(Array.isArray(a.assets)||Object.isPlain(a.assets))},c.start=function(a){this.load(this.assets,{complete:a,progress:this.progress,cacheAll:this.cacheAll})},c.destroy=function(){a.prototype.destroy.call(this),this.assets=null},namespace("springroll").ListTask=b}(),function(){var a=include("springroll.Task"),b=function(b){a.call(this,b,b.src),this.src=this.filter(b.src),this.progress=b.progress||null,this.data=b.data||null,this.advanced=!!b.advanced},c=a.extend(b);b.test=function(a){return!!a.src},c.start=function(a){var b=this.advanced;this.simpleLoad(this.src,function(c){var d=c;d&&!b&&(d=c.content,c.destroy()),a(d)},this.progress,this.data)},c.destroy=function(){a.prototype.destroy.call(this),this.data=null,this.progress=null},namespace("springroll").LoadTask=b}(),function(){function e(){c.call(this,!0),void 0===b&&(b=include("springroll.Debug",!1)),this.retries=0,this.url=null,this.preparedUrl=null,this.data=null,this.onComplete=null,this.onProgress=null,this._onFailed=this._onFailed.bind(this),this._onProgress=this._onProgress.bind(this),this._onCompleted=this._onCompleted.bind(this),d&&this.installPlugin(d)}var b,c=include("createjs.LoadQueue"),d=include("createjs.Sound",!1),f=extend(e,c);e.MAX_RETRIES=3,f.toString=function(){return"[LoaderItem(url:'"+this.url+"')]"},Object.defineProperty(f,"basePath",{set:function(a){this._basePath=a}}),Object.defineProperty(f,"crossOrigin",{set:function(a){this._crossOrigin=a}}),f.clear=function(){this.basePath="",this.crossOrigin=!1,this.retries=0,this.onComplete=null,this.onProgress=null,this.data=null,this.preparedUrl=null,this.url=null,this.removeAllEventListeners(),this.removeAll(),this.close()},f.start=function(a){this.addEventListener("fileload",this._onCompleted),this.addEventListener("error",this._onFailed),this.addEventListener("fileprogress",this._onProgress),this._internalStart()},f._internalStart=function(){var a=this.preparedUrl;this.data&&this.data.id&&(a={id:this.data.id,src:a,data:this.data}),this.loadFile(a)},f._onProgress=function(a){this.onProgress&&this.onProgress(this.progress)},f._onFailed=function(a){this.removeAll(),this.retry()},f.retry=function(){this.retries++,this.retries>e.MAX_RETRIES?this.onComplete(this,null):this._internalStart()},f._onCompleted=function(a){this.onComplete(this,a.result)},namespace("springroll").LoaderItem=e}(),function(){var a=function(a,b,c){this.content=a,this.url=b,this.data=c,this.id=null},b=extend(a);b.toString=function(){return"[LoaderResult(url: '"+this.url+"')]"},b.reset=function(){this.content=this.url=this.data=this.id=null},b.destroy=function(){this.reset()},namespace("springroll").LoaderResult=a}(),function(){function e(a){this.app=a,this.maxCurrentLoads=2,this.cacheManager=new c(a),this.items={},this.itemPool=[]}var b=include("springroll.LoaderItem"),c=include("springroll.CacheManager"),d=include("springroll.LoaderResult"),f=extend(e);f.destroy=function(){this.itemPool&&this.itemPool.forEach(function(a){a.clear()}),this.itemPool=null,this.cacheManager&&this.cacheManager.destroy(),this.cacheManager=null,this.items=null},f.load=function(b,c,d,e){var f=this.app.options,g=this._getItem(),h=f.basePath;return void 0!==h&&!1===/^http(s)?\:/.test(b)&&-1==b.search(h)&&(g.basePath=h),g.crossOrigin=f.crossOrigin,g.url=b,g.preparedUrl=this.cacheManager.prepare(b),g.onComplete=this._onComplete.bind(this,c),g.onProgress=d||null,g.data=e||null,g.setMaxConnections(this.maxCurrentLoads),(this.items[b]=g).start(),g},f._onComplete=function(a,b,c){c&&(c=new d(c,b.url,b.data)),a(c),this._putItem(b)},f.cancel=function(a){var b=this.items[a];return!!b&&(b.clear(),this._putItem(b),!0)},f._getItem=function(){var a=this.itemPool;return a.length?a.pop():new b},f._putItem=function(a){delete this.items[a.url],a.clear(),this.itemPool.push(a)},namespace("springroll").Loader=e}(),function(){function b(a){a&&(a.destroy&&a.destroy(),"IMG"==a.tagName&&(a.src=""))}function d(){void 0===c&&(c=include("springroll.Debug",!1)),this._cache={}}var c,e=extend(d);e.read=function(a){return this._cache[a]||null},e.write=function(a,b){this._cache[a]&&this.delete(a),this._cache[a]=b},e.delete=function(a){var c="string"==typeof a?a:a.id;if(c){var d=this._cache[c];if(d){if(Object.isPlain(d))for(var e in d)b(d[e]);else Array.isArray(d)?d.forEach(b):b(d);delete this._cache[c]}}},e.empty=function(){for(var a in this._cache)this.delete(a)},e.destroy=function(){this.empty(),this._cache=null},namespace("springroll").AssetCache=d}(),function(){function c(){void 0===a&&(a=include("springroll.Debug",!1)),this._sizes=[],this._sizesMap={},this._preferredSize=null}var a,b=include("devicePixelRatio",!1)||1,d=extend(c);c.SIZE_TOKEN="%SIZE%",d.reset=function(){this._sizes.length=0,this._sizesMap={}},d.define=function(a,b,c,d){var e={id:a,maxSize:b,scale:c,fallback:d};this._sizesMap[a]=e,this._sizes.push(e),this._sizes.sort(function(a,b){return a.maxSize-b.maxSize})},d.filter=function(a,b){return b=b||this._preferredSize,a.replace(c.SIZE_TOKEN,b.id)},d.test=function(a){return-1<a.indexOf(c.SIZE_TOKEN)},d.size=function(a){var b=this._preferredSize,c=b.fallback;if(a&&!a[b.id])for(var d=0,e=c.length;d<e;d++){var f=c[d];if(!1!==a[f]){b=this._sizesMap[f];break}}if(!b)throw"Asset does not support any valid size";return b},d.refresh=function(a,c){for(var d=Math.min(a,c),e=null,f=this._sizes,g=f.length-1;0<=g&&f[g].maxSize/b>d;--g)e=f[g];this._preferredSize=e},d.destroy=function(){this._preferredSize=null,this._sizes=null,this._sizesMap=null},namespace("springroll").AssetSizes=c}(),function(a){function b(a){return function(a){return"string"==typeof a}(a)?{src:a}:function(a){return"function"==typeof a}(a)?{async:a}:a}function h(a){g.call(this),this.manager=a,this.mode=k,this.startAll=!0,this.cacheAll=!1,this.tasks=[],this.results=null,this.running=!1,this.numLoaded=0,this.total=0,this.type=null}var f=include("springroll.Task"),g=include("springroll.EventDispatcher"),i=g.extend(h);i.setup=function(a,b){this.startAll=b.startAll,this.cacheAll=b.cacheAll,this.type=b.type,this.mode=this.addTasks(a),this.results=m(this.mode),b.autoStart&&this.start()},i.start=function(){this.trigger("progress",0),this.running=!0,this.nextTask()},i.reset=function(){this.tasks.forEach(function(a){a.status=f.FINISHED,a.destroy()}),this.total=0,this.numLoaded=0,this.mode=k,this.tasks.length=0,this.results=null,this.type=null,this.startAll=!0,this.cacheAll=!1,this.running=!1};var k=1;i.addTasks=function(c){var d,f,e=k;if((c=b(c)).type===a&&this.type&&(c.type=this.type),this.getTaskByAsset(c))return this.addTask(c),0;if(c.type===this.type&&this.type&&delete c.type,Array.isArray(c))for(var g=0;g<c.length;g++)d=b(c[g]),(f=this.addTask(d)).id||(e=2);else if(Object.isPlain(c))for(var h in c)d=b(c[h]),(f=this.addTask(d)).id||(f.id=h);return e},i.addTask=function(b){b.type===a&&this.type&&(b.type=this.type);var c,d=this.getTaskByAsset(b);return d&&(b.cache===a&&this.cacheAll&&(b.cache=!0),c=new d(b),this.tasks.push(c),++this.total),c},i.getTaskByAsset=function(a){for(var b,c=this.manager.taskDefs,d=0,e=c.length;d<e;d++)if((b=c[d]).test(a))return b;return null},i.nextTask=function(){for(var a=this.tasks,b=0;b<a.length;b++){var c=a[b];if(c.status===f.WAITING&&(c.status=f.RUNNING,c.start(this.taskDone.bind(this,c)),!this.startAll))return}},i.taskDone=function(a,b){if(this.running){b=b||null;var c=this.tasks.indexOf(a);if(-1!==c){this.tasks.splice(c,1);var d=[];if(b){switch(this.mode){case 0:this.results=b;break;case 2:this.results.push(b);break;case k:this.results[a.id]=b}a.cache&&this.manager.cache.write(a.id,b)}a.complete&&a.complete(b,a.original,d),this.trigger("taskDone",b,a.original,d),a.destroy();var e=this.addTasks(d);if(this.trigger("progress",++this.numLoaded/this.total),this.mode===k&&e!==this.mode)throw"Assets require IDs";this.tasks.length?this.nextTask():this.trigger("complete",this.results)}}};var m=function(a){switch(a){case 0:return null;case 2:return[];case k:return{}}};i.destroy=function(){g.prototype.destroy.call(this),this.reset(),this.tasks=null,this.manager=null},namespace("springroll").AssetLoad=h}(),function(){var b=include("springroll.AssetLoad"),c=include("springroll.AssetCache"),d=include("springroll.AssetSizes"),e=(include("springroll.Task"),function(){this.loads=[],this.loadPool=[],this.taskDefs=[],this.cache=new c,this.sizes=new d,this.defaultType=null,this.sizes.define("half",400,.5,["full"]),this.sizes.define("full",1e4,1,["half"])}),f=extend(e);f.register=function(a,b){"string"==typeof a&&(a=include(a,!1)),a&&(a.priority=b||0,this.taskDefs.push(a),this.taskDefs.sort(function(a,b){return b.priority-a.priority}))},f.load=function(a,b){b=Object.merge({complete:null,progress:null,taskDone:null,cacheAll:!1,startAll:!0,autoStart:!0,type:this.defaultType},b);var c=this.getLoad();return this.loads.push(c),b.complete=this._onLoaded.bind(this,b.complete,c),c.once("complete",b.complete),b.progress&&c.on("progress",b.progress),b.taskDone&&c.on("taskDone",b.taskDone),c.setup(a,b),c},f.poolLoad=function(a){a.off("complete progress taskDone"),a.reset(),this.loadPool.push(a)},f.getLoad=function(){return 0<this.loadPool.length?this.loadPool.pop():new b(this)},f._onLoaded=function(a,b,c){var d=this.loads.indexOf(b);-1<d&&this.loads.splice(d,1),a&&a(c),this.poolLoad(b)},f.destroy=function(){this.sizes.destroy(),this.sizes=null,this.cache.destroy(),this.cache=null,this.loadPool=null,this.loads=null,this.taskDefs=null},namespace("springroll").AssetManager=e}(),function(){var a=include("springroll.ApplicationPlugin"),b=include("springroll.Loader"),c=include("springroll.AssetManager"),d=new a(100);d.setup=function(){var a=this.loader=new b(this),d=this.assetManager=new c;d.register("springroll.LoadTask"),d.register("springroll.ListTask"),d.register("springroll.FunctionTask",10),d.register("springroll.ColorAlphaTask",20);var e=this.options;e.add("cacheBust",!1).respond("cacheBust",function(){return a.cacheManager.cacheBust}).on("cacheBust",function(b){a.cacheManager.cacheBust="true"==b||!!b}),e.add("basePath"),e.add("version",null,!0),e.add("versionsFile",null,!0),e.add("defaultAssetType").on("defaultAssetType",function(a){d.defaultType=a}),this.load=function(a,b,c,e,f){var g;return"string"==typeof a?a={src:a,progress:c||null,complete:b||null,cache:!!e,data:f||null}:"function"==typeof(g=b)&&(g={complete:b}),d.load(a,g)},this.unload=function(a){"string"==typeof a&&(a=Array.prototype.slice.call(arguments));for(var b=0;b<a.length;b++)d.cache.delete(a[b])},this.unloadAll=function(){d.cache.empty()},this.getCache=function(a){return d.cache.read(a)},this.on("resize",function(){d.sizes.refresh(this.realWidth,this.realHeight)}),this.once("beforeInit",function(){this.display&&d.sizes.refresh(this.realWidth,this.realHeight)})},d.preload=function(a){this.triggerResize();var b=this.options.versionsFile;b?this.loader.cacheManager.addVersionsFile(b,a):a()},d.teardown=function(){this.loader&&(this.loader.destroy(),this.loader=null),this.assetManager&&(this.assetManager.destroy(),this.assetManager=null)}}(),function(){var c=new(include("springroll.ApplicationPlugin"))(80);c.setup=function(){include("springroll.Debug",!1);var b=this.options;b.add("configPath",null,!0),b.add("preload",[],!0),this.config=null,this._assetLoad=null,this._numLoaded=0,this._total=0,this._progress=-1,this.on("pluginProgress",d.bind(this))},c.preload=function(a){var b=[],c=this.options.configPath;c?b.push({id:"config",src:c,cache:!1,complete:f.bind(this)}):e(this,b);var h=g.bind(this,a);b.length?this._assetLoad=this.load(b,{complete:h,progress:d.bind(this),cacheAll:!0}):h()};var d=function(){this._assetLoad&&(this._numLoaded=this._assetLoad.numLoaded,this._total=this._assetLoad.total);var c=(this._numLoaded+this.pluginLoad.numLoaded)/(this._total+this.pluginLoad.total);c>this._progress&&(this._progress=c,this.trigger("progress",c))},e=function(a,b){b.append(a.options.preload),a.trigger("loading",b)},f=function(a,b,c){this.config=a,this.trigger("configLoaded",a,c),e(this,c)},g=function(a,b){this._assetLoad=null,this.trigger("loaded",b),a()};c.teardown=function(){this.config=null}}(),function(){var b=include("springroll.EventDispatcher"),c=function(a,c){b.call(this),c=c||{},this.canvas=document.getElementById(a),this.id=a,this.width=this.canvas.width,this.height=this.canvas.height,this.stage=null,this.paused=!1,this._enabled=!1,this._visible="none"!=this.canvas.style.display,this.adapter=null},d=b.extend(c);Object.defineProperty(d,"enabled",{get:function(){return this._enabled},set:function(a){this._enabled!=(this._enabled=a)&&(this.trigger(a?"enabled":"disabled"),this.trigger("enable",a))}}),Object.defineProperty(d,"visible",{get:function(){return this._visible},set:function(a){var b=this._visible;this._visible=a,this.canvas.style.display=a?"block":"none",b!=a&&(this.trigger(a?"visible":"hidden"),this.trigger("visibility",a))}}),d.resize=function(a,b){this.width=this.canvas.width=a,this.height=this.canvas.height=b},d.render=function(a,b){},d.destroy=function(){this.enabled=!1,this.adapter=null,this.stage=null,this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.canvas.onmousedown=null,this.canvas=null},namespace("springroll").AbstractDisplay=c}(),function(){var a=include("springroll.Application"),b=include("springroll.Loader"),c=include("springroll.PropertyDispatcher"),d=include("springroll.EventDispatcher");a.prototype.getDisplays=function(a){return"function"==typeof a&&_displays.forEach(a),_displays},d.mixIn=function(a,b){return mixin(a,d)},Object.defineProperty(b,"instance",{get:function(){return a.instance.loader}}),c.prototype.readOnly=function(a){for(var b,c,d=0;d<arguments.length;d++){if(c=arguments[d],void 0===(b=this._properties[c]))throw"Property "+c+" does not exist";b.readOnly=!0}return this}}()}(),function(){"use strict";function b(a){this.container=a,this.id=""}var a,c;a=include("springroll.SavedData"),(c=extend(b)).read=function(b,c){if(!this.container.supported)return c(a.read(this.id+b));this.container.fetch("userDataRead",function(a){c(a.data)},this.id+b,!0)},c.write=function(b,c,d){if(!this.container.supported)return a.write(this.id+b,c),void(d&&d());this.container.fetch("userDataWrite",function(a){d&&d()},{name:this.id+b,value:c},!0)},c.remove=function(b,c){if(!this.container.supported)return a.remove(this.id+b),void(c&&c());this.container.fetch("userDataRemove",function(a){c&&c()},this.id+b,!0)},c.destroy=function(){this.id=null,this.container=null},namespace("springroll").UserData=b,function(){var b=include("springroll.ApplicationPlugin"),c=include("springroll.PageVisibility"),d=include("springroll.UserData"),e=include("Bellhop"),f=new b(200);f.setup=function(){var a=this.options,b=this.container=new e;b.connect(),this.userData=new d(b),a.add("keepFocus",!1).on("keepFocus",function(a){b.send("keepFocus",a)}),this.on("progress",function(a){this.container.send("progress",a)}),this.once("beforeInit",function(){b.send("loaded")}),b.send("loading"),this.singlePlay=!1,this.playOptions={};var c=/playOptions=[^&$]*/.exec(window.location.search);if(null!==c){var f=c[0],i=decodeURIComponent(f.split("=")[1]);try{this.playOptions=JSON.parse(i)}catch(j){springroll.Debug&&springroll.Debug.warn("ContainerClientPlugin: Failed to parse playOptions from query string")}}this.singlePlayEnd=function(){return!!this.singlePlay&&(this.endGame(),!0)},this.endGame=function(a){this.trigger("endGame",a||"game_completed"),this.destroy()},this.once("beforeInit",function(){var a=!!this.sound;this.container.send("features",{sound:a,hints:!!this.hints,music:a&&this.sound.contextExists("music"),vo:a&&this.sound.contextExists("vo"),sfx:a&&this.sound.contextExists("sfx"),captions:!!this.captions,disablePause:!!this.options.disablePause})}),b.supported&&(b.fetch("singlePlay",o.bind(this)),b.fetch("playOptions",n.bind(this))),window.onerror=h.bind(this),window.onunload=window.onbeforeunload=g.bind(this)};var g=function(){return window.onunload=window.onbeforeunload=null,void this.endGame("left_site")},h=function(a){if(this.container.supported)return this.container.send("localError",String(a)),!0};f.preload=function(a){if(!this.name)throw"Application name is empty";if(this.userData.id=this.name,this.container.supported){this.container.on("soundMuted",j.bind(this)),this.container.on("captionsMuted",k.bind(this)),this.container.on("musicMuted",l.bind(this,"music")),this.container.on("voMuted",l.bind(this,"vo")),this.container.on("sfxMuted",l.bind(this,"sfx")),this.container.on("captionsStyles",m.bind(this)),this.container.on("pause",i.bind(this)),this.container.on("close",p.bind(this)),this.options.autoPause=!1;var b=this.container;this._pageVisibility=new c(b.send.bind(b,"focus",!0),b.send.bind(b,"focus",!1))}a()};var i=function(a){var b=!!a.data;this.autoPaused=b,this.enabled=!b},j=function(a){this.sound&&(this.sound.muteAll=!!a.data)},k=function(a){this.captions&&(this.captions.mute=!!a.data)},l=function(a,b){this.sound&&this.sound.setContextMute(a,!!b.data)},m=function(a){var b=a.data,d=(this.captions||{}).textField||null;d&&d.nodeName&&(d.className="size-"+b.size+" bg-"+b.background+" color-"+b.color+" edge-"+b.edge+" font-"+b.font+" align-"+b.align)},n=function(a){Object.merge(this.playOptions,a.data||{}),this.trigger("playOptions",this.playOptions)},o=function(a){this.singlePlay=!!a.data},p=function(){this.endGame("closed_container")};f.teardown=function(){window.onerror=null,this._pageVisibility&&(this._pageVisibility.destroy(),this._pageVisibility=null),this.userData&&(this.userData.destroy(),this.userData=null),this.container&&(this.container.send("endGame"),this.container.destroy(),this.container=null)}}()}(),function(){"use strict";function a(){this.onComplete=null,this.onCancelled=null,this.eventList=null,this.listIndex=-1,this.instance=null,this.isLooping=!1,this.useCaptions=!1,this._paused=!1,this.duration=0,this.speed=1,this.soundAlias=null,this.soundInst=null,this.playSound=!1,this.soundStart=0,this.soundEnd=0,this.complete=!1,this._position=0,this.isTimer=!1}var b;(b=extend(a)).reset=function(){return this.instance&&(this.instance.destroy(),this.instance=null),this.complete=!1,this.soundEnd=0,this.soundStart=0,this.playSound=!1,this.soundInst=null,this.soundAlias=null,this.speed=1,this._position=0,this.duration=0,this._paused=!1,this.useCaptions=!1,this.isLooping=!1,this.isTimer=!1,this.listIndex=-1,this.eventList=null,this.onCancelled=null,this.onComplete=null,this},Object.defineProperty(b,"position",{get:function(){return this._position},set:function(a){this._position=a,this.isTimer||this.instance.setPosition(a)}}),b._nextItem=function(){var a=!1;if(this.soundInst&&(this.soundInst._endCallback=null),this.isLooping){var b=this.soundInst;b&&(b.stop(),this.soundInst=null),a=!0}else if(this.isTimer||this.instance.endAnim(),this.soundEnd=this.soundStart=0,this.isLooping=this.playSound=this.useCaptions=!1,this.soundInst=this.soundAlias=null,++this.listIndex>=this.eventList.length)return void(this.complete=!0);var c=this.eventList[this.listIndex];switch(typeof c){case"object":this.isTimer=!1;var d=this.instance;d.beginAnim(c,a),this.duration=d.duration,this.speed=c.speed,this.isLooping=d.isLooping||c.loop,this._position=d.position,c.alias&&(this.soundAlias=c.alias,this.soundStart=c.audioStart,this.playSound=!0,this.useCaptions=c.useCaptions);break;case"number":this.isTimer=!0,this.duration=c,this._position=0;break;case"function":c(),this._nextItem()}},Object.defineProperty(b,"time",{get:function(){return 1e3*this.position},set:function(a){this.position=.001*a}}),Object.defineProperty(b,"paused",{get:function(){return this._paused},set:function(a){if(a!=this._paused){this._paused=!!a;var b=this.soundInst;b&&(this.paused?b.pause():b.resume())}}}),namespace("springroll").AnimatorTimeline=a,function(){function b(a){return"string"==typeof a}function c(a){return"number"==typeof a}function d(a){return"function"==typeof a}function n(a){this.debug=!1,this.captions=null,l=a,h=[],f=[];try{"function"==typeof(g=new Map([])).delete&&"function"==typeof g.has&&"function"==typeof g.set&&"function"==typeof g.get||(g=null)}catch(b){}j=i=!(k=[]),this._update=this._update.bind(this),include("springroll.Debug",!1)}var f,g,h,i,j,k,l,m=include("springroll.AnimatorTimeline"),o=extend(n);o.register=function(a,b){var c=include(a,!1);c&&(c.priority=b,h.push(c),h.sort(function(a,b){return b.priority-a.priority}))},o.play=function(a,b,c,d){!0===d&&(d=c),Array.isArray(b)||(b=[b]),this.stop(a);var e=this._makeTimeline(a,b,c,d);return e.eventList&&1<=e.eventList.length?(e._nextItem(),i||this._startUpdate(),g&&g.set(a,e),f.push(e),i=!0,e):(k.push(e.reset()),c&&c(),null)},o._makeTimeline=function(a,e,f,g){var h=k.length?k.pop():new m,i=p(a);if(!i)return h;var j=i.create(a);if(!j)return h;h.instance=j,h.eventList=[],h.onComplete=f,h.onCancelled=g,h.speed=void 0;for(var n,o,r,s=0,t=e.length;s<t;++s){var u=e[s];if(b(u)){if(!i.hasAnimation(a,u))continue;h.eventList.push({anim:u,audio:null,start:0,speed:1})}else if("object"==typeof u){if(!i.hasAnimation(a,u.anim))continue;var v={anim:u.anim,start:c(u.start)?.001*u.start:0,speed:0<u.speed?u.speed:1,loop:u.loop};(n=u.audio)&&l.sound&&(r=b(n)?(o=0,n):(o=0<n.start?.001*n.start:0,n.alias),l.sound.isSupported&&!l.sound.systemMuted&&l.sound.exists(r)&&(l.sound.preload(r),v.alias=r,v.audioStart=o,v.useCaptions=this.captions&&this.captions.hasCaption(r))),h.eventList.push(v)}else c(u)?h.eventList.push(.001*u):d(u)&&h.eventList.push(u)}return h},o.canAnimate=function(a){return!!a&&!!p(a)};var p=function(a){for(var b,c=0,d=h.length;c<d;c++)if((b=h[c]).test(a))return b;return null};o.hasAnimation=function(a,b){var c=p(a);return!!c&&c.hasAnimation(a,b)},o.getDuration=function(a,b){var c=p(a);if(!c)return 0;if(!Array.isArray(b))return c.getDuration(a,b.anim||b);for(var d=0,e=0;e<b.length;++e){var f=b[e];"number"==typeof f?d+=f:"string"==typeof f?d+=c.getDuration(a,f):"object"==typeof f&&f.anim&&(d+=c.getDuration(a,f.anim))}return d},o.stop=function(a,b){var c=q(a);c&&(b&&(c.onComplete=c.onCancelled=null),this._remove(c,!0))},o.stopAll=function(a,b){if(i)for(var c,d=f.length-1;0<=d;--d)c=f[d],a&&!a.contains(c.instance.clip)||(b&&(c.onComplete=c.onCancelled=null),this._remove(c,!0))},o._remove=function(a,b){var c=f.indexOf(a);if(!(c<0)){var d=a.onComplete,e=a.onCancelled;b&&a.soundInst&&a.soundInst.stop(),g&&g.delete(a.instance.clip),c==f.length-1?f.pop():f.splice(c,1),i=0<f.length,a.useCaptions&&this.captions.stop(),k.push(a.reset()),i||this._stopUpdate(),b?e&&e():d&&d()}},o.pause=function(){if(!j){j=!0;for(var a=f.length-1;0<=a;--a)f[a].paused=!0;this._stopUpdate()}},o.resume=function(){if(j){j=!1;for(var a=f.length-1;0<=a;--a)f[a].paused=!1;i&&this._startUpdate()}},o.pauseInGroup=function(a,b){if(i&&b)for(var c=f.length-1;0<=c;--c)b.contains(f[c].instance.clip)&&(f[c].paused=a)},o.getTimeline=function(a){return i?q(a):null};var q=function(a){if(g)return g.has(a)?g.get(a):null;for(var b=f.length-1;0<=b;--b)if(f[b].instance.clip===a)return f[b];return null};Object.defineProperty(o,"paused",{get:function(){return j}}),o._startUpdate=function(){l.on("update",this._update)},o._stopUpdate=function(){l.off("update",this._update)},o._update=function(a){for(var b,c,d,e=.001*a,g=f.length-1;0<=g;--g){if(!(b=f[g]))return;if(b.instance,!b.paused){if(d=0,b.soundInst?b.soundInst.isValid?((c=.001*b.soundInst.position)<0&&(c=0),d=b.soundStart+c,b.useCaptions&&this.captions.seek(b.soundInst.position)):d=b.duration:d=b.position+e*b.speed,d>=b.duration){for(;d>=b.duration;){if(d-=b.duration,b.isLooping){if(!b.duration){b.complete=!0;break}b.onComplete&&b.onComplete()}if(b._nextItem(),b.complete)break}if(b.complete){this._remove(b);continue}}b.playSound&&d>=b.soundStart?(b.position=b.soundStart,b.playSound=!1,b.soundInst=l.sound.play(b.soundAlias,this._onSoundDone.bind(this,b,b.listIndex,b.soundAlias),r.bind(null,b,b.listIndex)),b.useCaptions&&this.captions.play(b.soundAlias)):b.position=d}}};var r=function(a,b){a.listIndex==b&&(a.soundEnd=a.soundStart+.001*a.soundInst.length)};o._onSoundDone=function(a,b,c){this.captions&&this.captions.currentAlias==c&&this.captions.stop(),a.listIndex==b&&(a.soundEnd>a.position&&(a.position=a.soundEnd),a.soundInst=null)},o.destroy=function(){this.stopAll(null,!0),this.captions=null,h=g=k=f=l=null},namespace("springroll").Animator=n}(),function(){var b=(include("springroll.Application"),function(){this.clip=null,this.position=0,this.duration=0,this.isLooping=!1,this.currentName=null}),c=extend(b);c.init=function(a){this.clip=a},c.beginAnim=function(a,b){},c.endAnim=function(){},c.setPosition=function(a){},b.test=function(a){return!1},b.hasAnimation=function(a,b){return!1},b.getDuration=function(a,b){return 0},b.extend=function(a,c){return a._pool=[],a.create=function(b){var c=0<a._pool.length?a._pool.pop():new a;return c.init(b),c},a.pool=function(b){b.destroy(),a._pool.push(b)},extend(a,c||b)},c.destroy=function(){this.clip=null},namespace("springroll").AnimatorInstance=b}(),function(a){function d(){c.call(this),this.startTime=0,this.length=0,this.firstFrame=-1,this.lastFrame=-1}var b=include("springroll.Application"),c=include("springroll.AnimatorInstance"),e=c.extend(d);e.init=function(a){a.framerate||(a.framerate=b.instance.options.fps||15),a.tickEnabled=!1,this.clip=a,this.isLooping=!1,this.currentName=null,this.position=this.duration=0,this.lastFrame=a.currentFrame},e.beginAnim=function(a,b){var c,d=this.currentName=a.anim,e=-1,f=-1,g=!1;if("*"!=d||this.clip.timeline.resolve(d))for(var h=this.clip.getLabels(),i=d+"_stop",j=d+"_loop",k=0,l=h.length;k<l;++k)if((c=h[k]).label==d)e=c.position;else{if(c.label==i){f=c.position;break}if(c.label==j){f=c.position,g=!0;break}}else e=0,f=this.clip.timeline.duration-1,g=!!a.loop;this.firstFrame=e,this.lastFrame=f,this.length=f-e,this.isLooping=g;var m=this.clip.framerate;if(this.startTime=this.firstFrame/m,this.duration=this.length/m,b)this.position=0;else{var n=a.start||0;this.position=n<0?Math.random()*this.duration:n}this.clip.play(),this.clip.elapsedTime=this.startTime+this.position,this.clip.advance()},e.endAnim=function(){this.clip.gotoAndStop(this.lastFrame)},e.setPosition=function(a){this.position=a,this.clip.elapsedTime=this.startTime+a,this.clip.advance()},d.test=function(b){return b.framerate!==a&&b.getLabels!==a&&b.elapsedTime!==a&&b.gotoAndStop!==a&&b.gotoAndPlay!==a&&b.stop!==a&&b.play!==a},d.hasAnimation=function(a,b){if("*"==b&&!a.timeline.resolve(b))return!0;for(var c,d=a.getLabels(),e=-1,f=-1,g=b+"_stop",h=b+"_loop",i=0,j=d.length;i<j;++i)if((c=d[i]).label==b)e=c.position;else if(c.label==g||c.label==h){f=c.position;break}return 0<=e&&0<f},d.getDuration=function(a,c){if(a.framerate||(a.framerate=b.instance.options.fps||15),"*"==c&&!a.timeline.resolve(c))return a.timeline.duration/a.framerate*1e3;for(var d,e=a.getLabels(),f=-1,g=-1,h=c+"_stop",i=c+"_loop",j=0,k=e.length;j<k;++j)if((d=e[j]).label==c)f=d.position;else if(d.label==h||d.label==i){g=d.position;break}return 0<=f&&0<g?(g-f)/a.framerate*1e3:0},e.destroy=function(){this.clip=null},namespace("springroll").GenericMovieClipInstance=d}(),function(){var a=include("springroll.ApplicationPlugin"),b=include("springroll.Animator"),c=new a(50);c.setup=function(){this.animator=new b(this),this.animator.captions=this.captions||null,this.animator.register("springroll.GenericMovieClipInstance",0)},c.teardown=function(){this.animator&&(this.animator.destroy(),this.animator=null)}}()}(),function(){"use strict";function b(){a||(a=include("springroll.Sound")),this._channel=null,this._endFunc=null,this._endCallback=null,this._startFunc=null,this._startParams=null,this.alias=null,this._fTime=0,this._fDur=0,this._fStart=0,this._fEnd=0,this.curVol=0,this._pan=0,this.length=0,this.paused=!1,this.globallyPaused=!1,this.isValid=!0}var a,c;namespace("springroll").SoundContext=function(a){this.id=a,this.volume=1,this.muted=!1,this.sounds=[],this.subContexts=[]},c=extend(b),Object.defineProperty(c,"position",{get:function(){return this._channel?this._channel.getPosition():0}}),c.stop=function(){var b=a.instance;if(b){var c=b._sounds[this.alias];if(!c)return;var d=c.playing.indexOf(this);-1<d&&c.playing.splice(d,1),-1<(d=c.waitingToPlay.indexOf(this))&&c.waitingToPlay.splice(d,1),b._stopInst(this)}},c.updateVolume=function(b){if(this._channel){if(void 0===b){var c=a.instance,d=c._sounds[this.alias];if(d.context){var e=c._contexts[d.context];b=e.muted?0:e.volume}else b=1}this._channel.setVolume(b*this.curVol)}},Object.defineProperty(c,"volume",{get:function(){return this.curVol},set:function(a){this.curVol=a,this.updateVolume()}}),Object.defineProperty(c,"pan",{get:function(){return this._pan},set:function(a){this._pan=a,this._channel&&(this._channel.pan=a)}}),c.pause=function(){this.globallyPaused=!1,this.paused||(this.paused=!0,this._channel&&(this._channel.paused=!0,a.instance._onInstancePaused()))},c.resume=function(){this.paused&&(this.paused=!1,this._channel&&(a.instance._onInstanceResume(),this._channel.paused=!1,this._channel.gainNode&&(this._channel._volume=-1,this._channel.gainNode.gain.value=0),this.updateVolume()))},namespace("springroll").SoundInstance=b,function(){function c(b){a.call(this,b,b.sounds[0]),this.sounds=b.sounds}var a=include("springroll.Task"),b=include("springroll.Application"),d=a.prototype,e=a.extend(c);c.test=function(a){return!!a.sounds&&Array.isArray(a.sounds)},e.start=function(a){var c=b.instance.sound,d=this.sounds;c.preload(d,function(){d.destroy=function(){c.unload(this),this.length=0,delete this.destroy},a(d)})},e.destroy=function(){this.sounds=null,d.destroy.call(this)},namespace("springroll").SoundTask=c}(),function(){function a(){var a=m.activePlugin,b=a._audioSources,c=a._soundInstances,d=a._loaders;j.context.close&&j.context.close();var e=window.AudioContext||window.webkitAudioContext;for(var f in j.context=new e,j.call(a),a._loaders=d,a._audioSources=b,a._soundInstances=c)for(var g=c[f],h=0;h<g.length;++h){var i=g[h];i.panNode.disconnect(0),i.gainNode.disconnect(0),i.gainNode=j.context.createGain(),i.panNode=j.context.createPanner(),i.panNode.panningModel=j._panningModel,i.panNode.connect(i.gainNode),i._updatePan(),(i._position<0||void 0===i._position)&&(i._position=0)}}function b(a){j.playEmptySound(),"running"!=j.context.state&&void 0!==j.context.state||(r.preventDefaultOnUnmute&&a.preventDefault(),document.removeEventListener("touchstart",b),document.removeEventListener("touchend",b),document.removeEventListener("mousedown",b),r.systemMuted=!1,r.trigger("systemUnmuted"))}function c(a){return"string"==typeof a}function d(a){return"function"==typeof a}function o(){g||(include("springroll.Debug",!1),f=include("springroll.SoundContext"),g=include("springroll.SoundInstance")),i.call(this),this._sounds={},this._fades=[],this._pool=[],this.supportedSound=null,this._contexts={},this._update=this._update.bind(this),this._markLoaded=this._markLoaded.bind(this),this._playAfterLoad=this._playAfterLoad.bind(this),this.isSupported=!0,this.systemMuted=createjs.BrowserDetect.isIOS,this.preventDefaultOnUnmute=!0}var f,g,h=include("springroll.Application"),i=include("springroll.EventDispatcher"),j=include("createjs.WebAudioPlugin"),k=include("createjs.CordovaAudioPlugin",!1),l=include("createjs.FlashAudioPlugin",!1),m=include("createjs.Sound"),n=include("springroll.Enum"),p=i.prototype,q=i.extend(o),r=null,s=new n("unloaded","loading","loaded");o.init=function(a,c){var e=h.instance.options;d(a)&&(a={ready:a});var f={plugins:l?[j,l]:[j],types:["ogg","mp3"],swfPath:"assets/swfs/",ready:null};if(a=Object.merge({},f,a),e.forceFlashAudio&&(a.plugins=[l]),k&&(e.forceNativeAudio||0<=a.plugins.indexOf(k)))try{(window.top?window.top.springroll.forceNativeAudio:window.springroll.forceNativeAudio)&&(a.plugins=[k])}catch(p){}if(a.ready=a.ready||c,!a.ready)throw"springroll.Sound.init requires a ready callback";if(l){var g=e.basePath;l.swfPath=(g||"")+a.swfPath}if(m.registerPlugins(a.plugins),createjs.BrowserDetect.isIOS&&m.activePlugin instanceof j&&"running"!=m.activePlugin.context.state?(document.addEventListener("touchstart",b),document.addEventListener("touchend",b),document.addEventListener("mousedown",b)):this.systemMuted=!1,r=new o,m.getCapabilities())r._initComplete(a.types,a.ready);else if(m.activePlugin){var i;i=function(){try{var b=window.plugins.NativeAudio||window.top.plugins.NativeAudio||null;b&&b.getCapabilities(function(b){b,h.instance.off("update",i),r._initComplete(a.types,a.ready)},function(a){a})}catch(p){}},h.instance.on("update",i)}else r.isSupported=!1,a.ready&&a.ready();return r},q._initComplete=function(a,b){if(l&&m.activePlugin instanceof l)r.supportedSound=".mp3";else for(var c,d=0,e=a.length;d<e;++d)if(c=a[d],m.getCapability(c)){r.supportedSound="."+c;break}this._fixAndroidAudio=createjs.BrowserDetect.isAndroid&&m.activePlugin instanceof j&&!(-1<navigator.userAgent.indexOf("Gecko")&&-1<navigator.userAgent.indexOf("Firefox")),this._fixAndroidAudio&&(this._numPlayingAudio=0,this._lastAudioTime=Date.now()),b&&b()},Object.defineProperty(o,"instance",{get:function(){return r}}),q.addContext=function(a){if(a){for(var b,d=a.soundManifest||a.sounds||[],e=a.path||"",g=!0===a.preload||!1,h=a.context,i={},j=0,k=d.length;j<k;++j)c(b=d[j])&&(b={id:b}),(i=this._sounds[b.id]={id:b.id,src:e+(b.src?b.src:b.id)+this.supportedSound,volume:b.volume?b.volume:1,loop:!!b.loop,loadState:s.unloaded,playing:[],waitingToPlay:[],context:b.context||h,playAfterLoad:!1,preloadCallback:null,data:b,duration:0}).context&&(this._contexts[i.context]||(this._contexts[i.context]=new f(i.context)),this._contexts[i.context].sounds.push(i)),!g&&!0!==b.preload||this.preload(i.id);return this}},q.linkContexts=function(a,b){if(this._contexts[a]||(this._contexts[a]=new f(a)),a=this._contexts[a],Array.isArray(b))for(var c=0;c<b.length;++c)a.subContexts.indexOf(b[c])<0&&a.subContexts.push(b[c]);else a.subContexts.indexOf(b)<0&&a.subContexts.push(b)},q.exists=function(a){return!!this._sounds[a]},q.contextExists=function(a){return!!this._contexts[a]},q.isUnloaded=function(a){return!!this._sounds[a]&&this._sounds[a].loadState==s.unloaded},q.isLoaded=function(a){return!!this._sounds[a]&&this._sounds[a].loadState==s.loaded},q.isLoading=function(a){return!!this._sounds[a]&&this._sounds[a].loadState==s.loading},q.isPlaying=function(a){var b=this._sounds[a];return!!b&&0<b.playing.length+b.waitingToPlay.length},q.getDuration=function(a){var b=this._sounds[a];if(!b)return null;if(!b.duration&&b.loadState==s.loaded){var c=m.play(a,null,null,null,null,0);b.duration=c.getDuration(),c.stop()}return b.duration},q.fadeIn=function(a,b,d,e){var f,g;if(c(a)){if(!(f=this._sounds[a]))return;f.playing.length&&(g=f.playing[f.playing.length-1])}else g=a,f=this._sounds[g.alias];if(g&&g._channel){g._fTime=0,g._fDur=0<b?b:500,g._fEnd=d||g.curVol,g._fStop=!1;var i=0<e?e:0;g.volume=g._fStart=i,-1==this._fades.indexOf(g)&&(this._fades.push(g),1==this._fades.length&&h.instance.on("update",this._update))}},q.fadeOut=function(a,b,d,e,f){var g,i;if(c(a)){if(!(g=this._sounds[a]))return;if(g.playing.length)i=g.playing[g.playing.length-1];else if(p.loadState==s.loading)return void this.stop(a)}else i=a;i&&i._channel&&(i._fTime=0,i._fDur=0<b?b:500,0<e?(i.volume=e,i._fStart=e):i._fStart=i.volume,i._fEnd=d||0,f=void 0===f?0===i._fEnd:!!f,i._fStop=f,-1==this._fades.indexOf(i)&&(this._fades.push(i),1==this._fades.length&&h.instance.on("update",this._update)))},q._update=function(a){for(var b,c,d,e,f,g=this._fades,i=g.length-1;0<=i;--i)(b=g[i]).paused||((c=b._fTime+=a)>=b._fDur?b._fStop?((d=this._sounds[b.alias])&&d.playing.splice(d.playing.indexOf(b),1),this._stopInst(b)):(b.curVol=b._fEnd,b.updateVolume(),g.splice(i,1)):(e=c/b._fDur,f=b._fEnd>b._fStart?b._fStart+(b._fEnd-b._fStart)*e:b._fEnd+(b._fStart-b._fEnd)*e,b.curVol=f,b.updateVolume()));0===g.length&&h.instance.off("update",this._update)},q.play=function(b,c,e,f,g,h,i,j,k){var l;if(c&&d(c)&&(l=c,c=null),l=(c?c.complete:l)||null,e=(c?c.start:e)||null,f=!!(c?c.interrupt:f),g=(c?c.delay:g)||0,h=(c?c.offset:h)||0,i=c?c.loop:i,j=c?c.volume:j,k=(c?c.pan:k)||0,this.isSupported){!0===i&&(i=-1);var n=this._sounds[b];if(n){(n.loop&&void 0===i||null===i)&&(i=-1),j="number"==typeof j?j:n.volume;var o,p,q=n.loadState;if(q!=s.loaded)return q==s.unloaded?(n.playAfterLoad=!0,(o=this._getSoundInst(null,n.id)).curVol=j,o._pan=k,n.waitingToPlay.push(o),o._endCallback=l,o._startFunc=e,o._startParams?((p=o._startParams)[0]=f,p[1]=g,p[2]=h,p[3]=i):o._startParams=[f,g,h,i],this.preload(n.id),o):q==s.loading?(n.playAfterLoad=!0,(o=this._getSoundInst(null,n.id)).curVol=j,o._pan=k,n.waitingToPlay.push(o),o._endCallback=l,o._startFunc=e,o._startParams?((p=o._startParams)[0]=f,p[1]=g,p[2]=h,p[3]=i):o._startParams=[f,g,h,i],o):void 0;this._fixAndroidAudio&&(this._numPlayingAudio?this._numPlayingAudio++:(3e4<=Date.now()-this._lastAudioTime&&a(),this._numPlayingAudio=1),this._lastAudioTime=-1);var r=m.play(b,f,g,h,i,j,k);return r&&r.playState!=m.PLAY_FAILED?(o=this._getSoundInst(r,n.id),r.handleExtraData&&r.handleExtraData(n.data),o.curVol=j,o._pan=k,n.playing.push(o),o._endCallback=l,o.updateVolume(),o.length=r.getDuration(),n.duration||(n.duration=o.length),o._channel.addEventListener("complete",o._endFunc),e&&setTimeout(e,0),o):(l&&l(),null)}l&&l()}else l&&setTimeout(l,0)},q._getSoundInst=function(a,b){var c;return this._pool.length?c=this._pool.pop():(c=new g)._endFunc=this._onSoundComplete.bind(this,c),c._channel=a,c.alias=b,c.length=a?a.getDuration():0,c.isValid=!0,c},q._playAfterLoad=function(b){var d=c(b)?b:b.data.id,e=this._sounds[d];if(e.loadState=s.loaded,e.playAfterLoad){this._fixAndroidAudio&&0<this._lastAudioTime&&3e4<=Date.now()-this._lastAudioTime&&a();for(var f,g,h,i,j,k=e.waitingToPlay,l=0,n=k.length;l<n;++l)g=(f=k[l])._startParams,h=f.curVol,j=f._pan,(i=m.play(d,g[0],g[1],g[2],g[3],h,j))&&i.playState!=m.PLAY_FAILED?(this._fixAndroidAudio&&(this._numPlayingAudio?this._numPlayingAudio++:this._numPlayingAudio=1,this._lastAudioTime=-1),e.playing.push(f),(f._channel=i).handleExtraData&&i.handleExtraData(e.data),f.length=i.getDuration(),e.duration||(e.duration=f.length),f.updateVolume(),i.addEventListener("complete",f._endFunc),f._startFunc&&f._startFunc(),f.paused&&i.pause()):(f._endCallback&&f._endCallback(),this._poolInst(f));k.length=0}},q._onSoundComplete=function(a){if(a._channel){this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now()),a._channel.removeEventListener("complete",a._endFunc);var b=this._sounds[a.alias],c=b.playing.indexOf(a);-1<c&&b.playing.splice(c,1);var d=a._endCallback;this._poolInst(a),d&&d()}},q.stop=function(a){var b=this._sounds[a];if(b)if(b.playing.length)this._stopSound(b);else if(b.loadState==s.loading){b.playAfterLoad=!1;for(var c,d=b.waitingToPlay,e=0,f=d.length;e<f;++e)c=d[e],this._poolInst(c);d.length=0}},q._stopSound=function(a){for(var b=a.playing,c=b.length-1;0<=c;--c)this._stopInst(b[c]);b.length=0},q._stopInst=function(a){a._channel&&(!a.paused&&this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now()),a._channel.removeEventListener("complete",a._endFunc),a._channel.stop());var b=this._fades.indexOf(a);-1<b&&this._fades.splice(b,1),this._poolInst(a)},q.stopContext=function(a){if(a=this._contexts[a]){var b,c,d=a.sounds;for(c=d.length-1;0<=c;--c)(b=d[c]).playing.length?this._stopSound(b):b.loadState==s.loading&&(b.playAfterLoad=!1);for(c=0;c<a.subContexts.length;++c)this.stopContext(a.subContexts[c])}},q.stopAll=function(){for(var a in this._sounds)this.stop(a)},q.pause=function(a,b){c(a)&&(a=this._sounds[a]),b=!!b;var d,e=a.playing;for(d=e.length-1;0<=d;--d)e[d].paused||(e[d].pause(),e[d].globallyPaused=b);for(d=(e=a.waitingToPlay).length-1;0<=d;--d)e[d].paused||(e[d].pause(),e[d].globallyPaused=b)},q.resume=function(a,b){c(a)&&(a=this._sounds[a]);var d,e=a.playing;for(d=e.length-1;0<=d;--d)e[d].globallyPaused==b&&e[d].resume();for(d=(e=a.waitingToPlay).length-1;0<=d;--d)e[d].globallyPaused==b&&e[d].resume()},q.pauseContext=function(a){if(a=this._contexts[a]){var b,c,d=a.sounds;for(c=d.length-1;0<=c;--c){var e;for(e=(b=d[c]).playing.length-1;0<=e;--e)b.playing[e].pause();for(e=b.waitingToPlay.length-1;0<=e;--e)b.waitingToPlay[e].pause()}for(c=0;c<a.subContexts.length;++c)this.pauseContext(a.subContexts[c])}},q.resumeContext=function(a){if(a=this._contexts[a]){var b,c,d=a.sounds;for(c=d.length-1;0<=c;--c){var e;for(e=(b=d[c]).playing.length-1;0<=e;--e)b.playing[e].resume();for(e=b.waitingToPlay.length-1;0<=e;--e)b.waitingToPlay[e].resume()}for(c=0;c<a.subContexts.length;++c)this.resumeContext(a.subContexts[c])}},q.pauseAll=function(){var a=this._sounds;for(var b in a)this.pause(a[b],!0)},q.resumeAll=function(){var a=this._sounds;for(var b in a)this.resume(a[b],!0)},q._onInstancePaused=function(){this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now())},q._onInstanceResume=function(){this._fixAndroidAudio&&(0<this._lastAudioTime&&3e4<Date.now()-this._lastAudioTime&&a(),this._numPlayingAudio++,this._lastAudioTime=-1)},q.setContextMute=function(a,b){if(a=this._contexts[a]){a.muted=b;var c,d,e,f,g=a.volume,h=a.sounds;for(f=h.length-1;0<=f;--f)if((c=h[f]).playing.length)for(e=(d=c.playing).length-1;0<=e;--e)d[e].updateVolume(b?0:g);for(f=0;f<a.subContexts.length;++f)this.setContextMute(a.subContexts[f],b)}},Object.defineProperty(q,"muteAll",{set:function(a){m.setMute(!!a)}}),q.setContextVolume=function(a,b){if(a=this._contexts[a]){var c=a.muted;a.volume=b;for(var d,e,f,g=a.sounds,h=g.length-1;0<=h;--h)if((d=g[h]).playing.length)for(f=(e=d.playing).length-1;0<=f;--f)e[f].updateVolume(c?0:b)}},q.preload=function(a,b){if(this.isSupported)if(c(a)&&(a=[a]),a&&0!==a.length){for(var d,e=[],f=0,g=a.length;f<g;++f)(d=this._sounds[a[f]])&&d.loadState==s.unloaded&&(d.loadState=s.loading,e.push({id:d.id,src:d.src,complete:this._markLoaded,data:d,advanced:!0}));0<e.length?h.instance.load(e,b):b&&b()}else b&&b();else b&&setTimeout(b,0)},q._markLoaded=function(a){var b=a.data.id,c=this._sounds[b];c&&(c.loadState=s.loaded,c.playAfterLoad&&this._playAfterLoad(b));var d=c.preloadCallback;d&&(c.preloadCallback=null,d())},q.unload=function(a){if(a)for(var b,c=0,d=a.length;c<d;++c)(b=this._sounds[a[c]])&&(this._stopSound(b),b.loadState=s.unloaded),m.removeSound(b.src)},q.unloadAll=function(){var a=[];for(var b in this._sounds)a.push(b);this.unload(a)},q._poolInst=function(a){-1==this._pool.indexOf(a)&&(a._endCallback=a.alias=a._channel=a._startFunc=null,a.curVol=0,a.globallyPaused=a.paused=a.isValid=!1,this._pool.push(a))},q.destroy=function(){if(this.stopAll(),m.removeAllSounds(),l&&m.activePlugin instanceof l){var a=document.getElementById("SoundJSFlashContainer");a&&a.parentNode&&a.parentNode.removeChild(a)}r=null,this._sounds=null,this._volumes=null,this._fades=null,this._contexts=null,this._pool=null},namespace("springroll").Sound=o}(),function(){function e(){d.call(this),a||(a=include("springroll.Captions",!1)),this._onSoundFinished=this._onSoundFinished.bind(this),this._updateSilence=this._updateSilence.bind(this),this._updateSoloCaption=this._updateSoloCaption.bind(this),this._syncCaptionToSound=this._syncCaptionToSound.bind(this),this._listHelper=[],this.trackSound=!1,this.paused=!1,this.voList=null,this._listCounter=0,this._currentVO=null,this._soundInstance=null,this._callback=null,this._cancelledCallback=null,this._trackedSounds=[],this._timer=0,this._captions=null}var a,b=include("springroll.Sound"),c=include("springroll.Application"),d=include("springroll.EventDispatcher"),f=extend(e,d);Object.defineProperty(f,"playing",{get:function(){return null!==this._currentVO||0<this._timer}}),Object.defineProperty(f,"currentVO",{get:function(){return this._currentVO}}),Object.defineProperty(f,"captions",{set:function(a){(this._captions=a)&&(a.selfUpdate=!1)},get:function(){return this._captions}}),Object.defineProperty(f,"currentPosition",{get:function(){return this.playing?this._soundInstance?this._soundInstance.position:this._currentVO?this._timer:this.voList[this._listCounter]-this._timer:0}}),Object.defineProperty(f,"currentDuration",{get:function(){return this.playing?this._soundInstance?b.instance.getDuration(this._soundInstance.alias):this._currentVO&&this._captions?this._captions.currentDuration:this.voList[this._listCounter]:0}}),f.getElapsed=function(){var a,c,d=0;if(!this.voList)return 0;for(c=0;c<this._listCounter;++c)"string"==typeof(a=this.voList[c])?d+=b.instance.getDuration(a):"number"==typeof a&&(d+=a);return(c=this._listCounter)<this.voList.length&&("string"==typeof(a=this.voList[c])?d+=this._soundInstance.position:"number"==typeof a&&(d+=a-this._timer)),d},f.pause=function(){!this.paused&&this.playing&&(this.paused=!0,this._soundInstance&&this._soundInstance.pause(),c.instance.off("update",[this._updateSoloCaption,this._syncCaptionToSound,this._updateSilence]))},f.resume=function(){this.paused&&(this.paused=!1,this._soundInstance&&this._soundInstance.resume(),this._captions.playing?this._soundInstance?c.instance.on("update",this._syncCaptionToSound):c.instance.on("update",this._updateSoloCaption):c.instance.on("update",this._updateSilence))},f.play=function(a,b,c){this.stop(),this.playing&&this.stop(),this._listCounter=-1,"string"==typeof a?(this._listHelper.length=0,this._listHelper[0]=a,this.voList=this._listHelper):this.voList=a,this._callback=b,this._cancelledCallback=!0===c?b:c,this._onSoundFinished()},f._onSoundFinished=function(){if(0<=this._listCounter&&this.trigger("end",this._currentVO),c.instance.off("update",[this._updateSoloCaption,this._syncCaptionToSound,this._updateSilence]),this._captions&&this._soundInstance&&this._captions.seek(this._soundInstance.length),this._soundInstance=null,++this._listCounter>=this.voList.length){this._captions&&this._captions.stop(),this._currentVO=null,this._cancelledCallback=null;var a=this._callback;this._callback=null,a&&a()}else this._currentVO=this.voList[this._listCounter],"string"==typeof this._currentVO?(this._playSound(),this.trigger("start",this._currentVO)):"function"==typeof this._currentVO?(this._currentVO(),this._onSoundFinished()):(this._timer=this._currentVO,this._currentVO=null,c.instance.on("update",this._updateSilence),this.trigger("start",null))},f._updateSilence=function(a){this._timer-=a,this._timer<=0&&this._onSoundFinished()},f._updateSoloCaption=function(a){this._timer+=a,this._captions.seek(this._timer),this._timer>=this._captions.currentDuration&&this._onSoundFinished()},f._syncCaptionToSound=function(a){this._soundInstance&&this._captions.seek(this._soundInstance.position)},f._playSound=function(){this.trackSound&&-1==this._trackedSounds.indexOf(this._currentVO)&&this._trackedSounds.push(this._currentVO);var a=b.instance;!a.exists(this._currentVO)&&this._captions&&this._captions.hasCaption(this._currentVO)?(this._captions.play(this._currentVO),this._timer=0,c.instance.on("update",this._updateSoloCaption)):(this._soundInstance=a.play(this._currentVO,this._onSoundFinished),this._captions&&(this._captions.play(this._currentVO),c.instance.on("update",this._syncCaptionToSound)));for(var d,e=this.voList.length,f=this._listCounter+1;f<e;++f)if("string"==typeof(d=this.voList[f])){a.exists(d)&&!a.isLoaded(d)&&a.preload(d);break}},f.stop=function(){this.paused=!1,this._soundInstance&&(this._soundInstance.stop(),this._soundInstance=null),this._currentVO=null,this._captions&&this._captions.stop(),c.instance.off("update",[this._updateSoloCaption,this._syncCaptionToSound,this._updateSilence]),this.voList=null,this._timer=0,this._callback=null;var a=this._cancelledCallback;this._cancelledCallback=null,a&&a()},f.unloadSound=function(){b.instance.unload(this._trackedSounds),this._trackedSounds.length=0},f.destroy=function(){this.stop(),this.voList=null,this._listHelper=null,this._currentVO=null,this._soundInstance=null,this._callback=null,this._cancelledCallback=null,this._trackedSounds=null,this._captions=null,d.prototype.destroy.call(this)},namespace("springroll").VOPlayer=e,namespace("springroll").Sound.VOPlayer=e}(),function(){var a=include("springroll.ApplicationPlugin"),b=include("springroll.Sound"),c=include("springroll.VOPlayer"),d=include("createjs.WebAudioPlugin"),e=include("createjs.FlashAudioPlugin",!1),f=new a(90);f.setup=function(){this.options.add("audioPlugins",e?[d,e]:[d],!0),this.options.add("swfPath","assets/swfs/",!0),this.options.add("forceFlashAudio",!1,!0),this.options.add("forceNativeAudio",!1,!0),this.options.add("audioTypes",["ogg","mp3"],!0),this._music=null,this._musicInstance=null,this.voPlayer=new c,this.sound=null,this.assetManager.register("springroll.SoundTask"),Object.defineProperty(this,"music",{set:function(a){if(a!=this._music){var b=this.sound;this._music&&(b.fadeOut(this._music),this._musicInstance=null),(this._music=a)&&(this._musicInstance=b.play(this._music,{start:b.fadeIn.bind(b,a),loop:-1}))}},get:function(){return this._music}}),Object.defineProperty(this,"musicInstance",{get:function(){return this._musicInstance}}),this.once("configLoaded",function(a){var b=a.sounds,c=this.sound;b&&(b.vo&&c.addContext(b.vo),b.sfx&&c.addContext(b.sfx),b.music&&c.addContext(b.music))})},f.preload=function(a){b.init({plugins:this.options.audioPlugins,swfPath:this.options.swfPath,types:this.options.audioTypes,ready:function(){if(!this.destroyed){var c=this.sound=b.instance;this.on({paused:function(){c.pauseAll()},resumed:function(){c.resumeAll()}}),this.trigger("soundReady"),a()}}.bind(this)})},f.teardown=function(){this.voPlayer&&(this.voPlayer.destroy(),this.voPlayer=null),this.sound&&(this.sound.destroy(),this.sound=null)}}(),function(){var a=include("springroll.Sound"),b=include("springroll.SoundInstance"),c=include("springroll.VOPlayer"),d=a.prototype;Object.defineProperty(d,"soundEnabled",{get:function(){return this.isSupported}}),d.loadConfig=function(a){return this.addContext(a)},d.preloadSound=function(a,b){this.preload(a,b)},d.unpauseAll=function(){this.resumeAll()},d.unpauseSound=function(a){this.resume(a)},d.pauseSound=function(a){this.pause(a)},(d=b.prototype).unpause=function(){this.resume()},d=c.prototype,Object.defineProperty(d,"soundList",{get:function(){return this.voList}})}()}(),function(){"use strict";var a,b,c;!function(){function b(a){var b=a.lastIndexOf("."),c=parseInt(a.substr(b+1),10),d=a.substr(0,b).split(":");return 36e5*parseInt(d[0],10)+6e3*parseInt(d[1],10)+1e3*parseInt(d[2],10)+c}var d=include("springroll.Application"),e=function(b,d,e){include("springroll.Debug",!1),this._data=null,this._textField=null,this._completeCallback=null,this._lines=[],this._currentAlias=0,this._currentDuration=0,this._currentTime=0,this._currentLine=-1,this._lastActiveLine=-1,this._playing=!1,this._destroyed=!1,this._selfUpdate=!0,this._mute=!1,this.update=this.update.bind(this),this.data=b||{},this.textField=d||null,this.selfUpdate=void 0===e||!!e},f=extend(e);Object.defineProperty(f,"mute",{get:function(){return this._mute},set:function(a){this._mute=a,this._updateCaptions()}}),Object.defineProperty(f,"selfUpdate",{set:function(a){this._selfUpdate=!!a,d.instance.off("update",this.update),this._selfUpdate&&d.instance.on("update",this.update)},get:function(){return this._selfUpdate}}),Object.defineProperty(f,"data",{set:function(a){if(this._data=a){var c,d,e,f,g=/[0-9]+\:[0-9]{2}\:[0-9]{2}\.[0-9]{3}/;for(var h in a)if(Array.isArray(a[h])&&(a[h]={lines:a[h]}),c=a[h].lines)for(f=c.length,d=0;d<f;++d)"string"==typeof(e=c[d]).start&&(g.test(e.start)?e.start=b(e.start):e.start=parseInt(e.start,10)),"string"==typeof e.end&&(g.test(e.end)?e.end=b(e.end):e.end=parseInt(e.end,10))}},get:function(){return this._data}}),Object.defineProperty(f,"textField",{set:function(a){g(this._textField,""),this._textField="string"==typeof a?document.getElementById(a):a||null},get:function(){return this._textField}});var g=function(a,b){if(a){if(a.nodeName)a.innerHTML=b;else{if(!a.constructor.prototype.hasOwnProperty("text")&&!a.hasOwnProperty("text"))throw"Unrecognizable captions text field";a.text=b}return a}};f.hasCaption=function(a){return!!this._data&&!!this._data[a]},f.getFullCaption=function(a,b){if(this._data){var c,d,e;if(b=b||" ",Array.isArray(a))for(e=0;e<a.length;e++)"string"==typeof a[e]&&(d=this.getFullCaption(a[e],b),c?c+=b+d:c=d);else{if(!this._data[a])return a;var f=this._data[a].lines;for(e=0;e<f.length;e++)d=f[e].content,c?c+=b+d:c=d}return c}},f._load=function(a){if(!this._destroyed){if(this._reset(),!a)return void(this._lines=null);this._lines=a.lines}},f._reset=function(){this._currentLine=-1,this._lastActiveLine=-1},Object.defineProperty(f,"playing",{get:function(){return this._playing}}),f._getTotalDuration=function(){var a=this._lines;return a?a[a.length-1].end:0},Object.defineProperty(f,"currentDuration",{get:function(){return this._currentDuration}}),Object.defineProperty(f,"currentAlias",{get:function(){return this._currentAlias}}),f.play=function(a,b){this.stop(),this._completeCallback=b,this._playing=!0,this._currentAlias=a,this._load(this._data[a]),this._currentDuration=this._getTotalDuration(),this.seek(0)},f.stop=function(){this._playing=!1,this._currentAlias=null,this._lines=null,this._completeCallback=null,this._reset(),this._updateCaptions()},f.seek=function(a){var b=this._currentTime=a,c=this._lines;if(c){if(b<c[0].start)return this._currentLine=this._lastActiveLine=-1,void this._updateCaptions();for(var d=c.length,e=0;e<d;e++){if(b>=c[e].start&&b<=c[e].end){this._currentLine=this._lastActiveLine=e,this._updateCaptions();break}b>c[e].end?(this._lastActiveLine=e,this._currentLine=-1,this._updateCaptions()):b<c[e].start&&(this._lastActiveLine=e-1,this._currentLine=-1,this._updateCaptions())}}else this._updateCaptions()},f._updatePercent=function(a){this._destroyed||(this._currentTime=a*this._currentDuration,this._calcUpdate())},f.update=function(a){!this._destroyed&&this._playing&&(this._currentTime+=a,this._calcUpdate())},f._calcUpdate=function(){var a=this._lines;if(a){var b=a.length,c=this._lastActiveLine+1,d=b-1,e=this._currentTime;e>=a[d].end?this.stop():c<=d&&e>=a[c].start&&e<=a[c].end?(this._currentLine=this._lastActiveLine=c,this._updateCaptions()):-1!=this._currentLine&&e>a[this._currentLine].end&&(this._lastActiveLine=this._currentLine,this._currentLine=-1,this._updateCaptions())}},f._updateCaptions=function(){g(this._textField,-1==this._currentLine||this._mute?"":this._lines[this._currentLine].content)},f.getLength=function(a){var b=0;if(Array.isArray(a))for(var c=0,d=a.length;c<d;c++)"string"==typeof a[c]?b+=this.getLength(a[c]):"number"==typeof a[c]&&(b+=a[c]);else{if(!this._data[a])return b;var e=this._data[a].lines;b+=e[e.length-1].end}return parseInt(b)},f.destroy=function(){this._destroyed||(this._destroyed=!0,this._data=null,this._lines=null)},namespace("springroll").Captions=e}(),a=include("springroll.ApplicationPlugin"),b=include("springroll.Captions"),include("springroll.Debug",!1),(c=new a(60)).setup=function(){this.options.add("captions","captions",!0),this.options.add("captionsPath",null,!0),this.captions=new b},c.preload=function(a){this.voPlayer&&(this.voPlayer.captions=this.captions),this.captions.textField=this.options.captions;var b=this.options.captionsPath;b?this.load(b,function(b){this.captions.data=b,a()}.bind(this)):a()},c.teardown=function(){this.captions&&(this.captions.destroy(),this.captions=null)}}(),function(){"use strict";var b;!function(){var b=include("PIXI.BaseTexture",!1);if(b){var c=b.prototype,d=c.destroy;c.destroy=function(){this._destroyed||(d.call(this),setTimeout(function(){var a=PIXI.utils.TextureCache;for(var b in a){var c=a[b];c?c.baseTexture===this&&c.destroy():delete a[b]}},0))}}}(),function(){var b=include("PIXI.extras.BitmapText",!1);if(b){var c=b.prototype;c.setPivotToAlign=!1,c._orig_updateText=c.updateText,c.updateText=function(){if(this._orig_updateText(),this.setPivotToAlign)switch(this.align){case"center":this.pivot.x=this.textWidth/2;break;case"right":this.pivot.x=this.textWidth;break;default:this.pivot.x=0}}}}(),function(){var b=include("PIXI.Container",!1);if(b){var c=b.prototype;c.useBoundsForSize=!0,c._width=0,c._height=0,Object.getOwnPropertyDescriptor(c,"width").configurable&&(Object.defineProperty(c,"width",{configurable:!0,get:function(){return this.useBoundsForSize?this.scale.x*this.getLocalBounds().width:this.scale.x*this._width},set:function(a){if(this.useBoundsForSize){var b=this.getLocalBounds().width;this.scale.x=0!==b?a/b:1,this._width=a}else 0===this._width?this._width=a/this.scale.x:this.scale.x=a/this._width}}),Object.defineProperty(c,"height",{configurable:!0,get:function(){return this.useBoundsForSize?this.scale.y*this.getLocalBounds().height:this.scale.y*this._height},set:function(a){if(this.useBoundsForSize){var b=this.getLocalBounds().height;this.scale.y=0!==b?a/b:1,this._height=a}else 0===this._height?this._height=a/this.scale.y:this.scale.y=a/this._height}}))}}(),(b=include("PIXI.interaction.InteractionManager",!1))&&(b.prototype.removeClickEvents=function(){this.interactionDOMElement&&(core.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),window.removeEventListener("mouseup",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0))}),function(){var b=include("PIXI.Point",!1);if(b){var c=b.prototype;c.dotProd=function(a){return this.x*a.x+this.y*a.y},c.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},c.lengthSq=function(){return this.x*this.x+this.y*this.y},c.normalize=function(){var a=1/this.length();this.x*=a,this.y*=a},c.subtract=function(a){this.x-=a.x,this.y-=a.y},c.add=function(a){this.x+=a.x,this.y+=a.y},c.truncate=function(a){var b=this.length();if(a<b){var c=a/b;this.x*=c,this.y*=c}},c.scaleBy=function(a){this.x*=a,this.y*=a},c.distance=function(a){var b=this.x-a.x,c=this.y-a.y;return Math.sqrt(b*b+c*c)},c.distanceSq=function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},b.localToGlobal=function(a,b,c,d){return d||(d=new PIXI.Point),d.x=b,d.y=c,a.toGlobal(d,d)},b.globalToLocal=function(a,b,c,d){return d||(d=new PIXI.Point),d.x=b,d.y=c,a.toLocal(d,null,d)},b.localToLocal=function(a,b,c,d,e){return e||(e=new PIXI.Point),e.x=c,e.y=d,b.toLocal(e,a,e)},c.toString=function(){return"("+this.x+", "+this.y+")"}}}(),function(){var b=180/Math.PI,c=function(a,b,c,d,e){for(this.x=a||0,this.y=b||0,this.radius=c||0,this.startAngle=d||0;this.startAngle<0;)this.startAngle+=360;this.endAngle=e||0,this.endAngle<this.startAngle&&(this.endAngle+=360)},d=c.prototype;d.clone=function(){return new PIXI.Sector(this.x,this.y,this.radius,this.startAngle,this.endAngle)},d.contains=function(a,c){if(this.radius<=0)return!1;var d=this.x-a,e=this.y-c;if(this.radius*this.radius<(d*=d)+(e*=e))return!1;for(var g=Math.atan2(c-this.y,a-this.x)*b;g<this.startAngle;)g+=360;return g>=this.startAngle&&g<=this.endAngle},d.constructor=c,namespace("PIXI").Sector=c}(),function(){var b=include("PIXI.Text",!1);if(b){var c=b.prototype;c.setPivotToAlign=!1,c._orig_updateText=c.updateText,c.updateText=function(){if(this._orig_updateText(),this.setPivotToAlign)switch(this.style.align){case"center":this.pivot.x=this._width/2;break;case"right":this.pivot.x=this._width;break;default:this.pivot.x=0}}}}(),namespace("springroll.pixi").enableLegacy=function(a){var b=a.plugins.interaction;b&&(b.on("pointerdown",function(a){b.emit("stagedown",a)}),b.on("pointerup",function(a){b.emit("stageup",a)}),b.on("pointermove",function(a){b.emit("stagemove",a)}),b.on("pointerover",function(a){b.emit("stageover",a)}),b.on("pointerout",function(a){b.emit("stageout",a)}),Object.defineProperty(b,"handleCursorChange",{get:function(){return this.cursorStyles.default},set:function(a){this.cursorStyles.default=a,this.cursorStyles.pointer=a}}),Object.defineProperty(PIXI.interaction.InteractionData.prototype,"id",{get:function(){return this.identifier}}))},function(){function h(b,d){a||(a=include("springroll.pixi.PixiDisplay")),c.call(this,b,d||b.image),this.image=this.filter(b.image),this.color=this.filter(b.color),this.alpha=this.filter(b.alpha),this.uploadToGPU=!!b.uploadToGPU}var a,b=include("springroll.ColorAlphaTask"),c=include("springroll.Task"),d=include("PIXI.Texture"),e=include("PIXI.BaseTexture"),f=include("PIXI.utils"),g=include("springroll.Application"),i=c.extend(h);h.test=function(a){return"pixi"==a.type&&(!!a.image||!!a.alpha&&!!a.color)},i.start=function(a){this.loadImage({},a)},i.loadImage=function(c,h,i){this.image?c._image=this.image:(c._color=this.color,c._alpha=this.alpha),this.load(c,function(c){var j;j=c._image?c._image:b.mergeAlpha(c._color,c._alpha);var k=this.original.scale;k&&1!==k||(k=f.getResolutionOfUrl(this.image||this.color));var l=new d(new e(j,null,k));if(l.baseTexture.imageUrl=this.image,this.cache&&!i&&(this.id,d.addToCache(l,this.id),e.addToCache(l.baseTexture,this.id),l.__T_destroy=l.destroy,l.destroy=function(){this.destroy=this.__T_destroy,this.destroy(!0)}),this.uploadToGPU){var m=g.instance.displays;for(var n in m){var o=m[n];if(o instanceof a&&o.isWebGL){o.renderer.updateTexture(l);break}}}h(l,c)}.bind(this))},i.destroy=function(){c.prototype.destroy.call(this)},namespace("springroll.pixi").TextureTask=h}(),function(){var b=include("PIXI.Spritesheet"),c=include("PIXI.Texture"),d=(include("PIXI.utils"),function(a,c){this.spritesheet=new b(a.baseTexture,c),this.frames={}}),e=extend(d);e.parse=function(a){this.spritesheet.parse(function(b){for(var d in b){var e=d,f=b[d],g=d.lastIndexOf(".");0<g&&(d=d.substring(0,g)),0<=(g=d.lastIndexOf("/"))&&(d=d.substring(g+1)),this.frames[d]=f,e!=d&&c.addToCache(f,d)}a()}.bind(this))},e.getFrame=function(a){return this.frames[a]||null},e.getFrames=function(b,c,d,e,f){void 0===e&&(e=4),e<0&&(e=0),f||(f=[]);var g,h,i=[],j=[];for(g=1;g<e;++g){var k="";h=1;for(var l=0;l<g;++l)k+="0",h*=10;i.unshift(k),j.push(h)}var m,n,o=j.length;for(g=c,n=d;g<=n;++g){var p=null;for(h=0;h<o;++h)if(g<j[h]){p=i[h]+g;break}p||(p=g.toString());var q=b.replace("#",p),r=this.frames[q];r&&(m=r),m&&f.push(m)}return f},e.destroy=function(){this.spritesheet.destroy(!0),this.spritesheet=null,this.frames=null},namespace("springroll.pixi").TextureAtlas=d}(),function(){var a=include("springroll.pixi.TextureTask"),b=(include("PIXI.Texture"),include("springroll.pixi.TextureAtlas")),c=(include("PIXI.utils"),function(b,c){a.call(this,b,c||b.atlas),this.atlas=this.filter(b.atlas)}),d=a.extend(c);c.test=function(b){return!!b.atlas&&a.test(b)},d.start=function(a){this.loadAtlas({},a)},d.loadAtlas=function(a,c,d){a._atlas=this.atlas,this.loadImage(a,function(a,e){var f=e._atlas,g=new b(a,f,this.cache&&!d);g.parse(function(){c(g,e)})}.bind(this),!0)},namespace("springroll.pixi").TextureAtlasTask=c}(),function(){var a=include("springroll.pixi.TextureTask"),b=(include("PIXI.Texture"),include("PIXI.Rectangle"),include("PIXI.extras.BitmapText",!1));if(include("PIXI.utils"),b){var c=function(b){a.call(this,b,b.font),this.font=this.filter(b.font)},d=a.extend(c);c.test=function(b){return!!b.font&&a.test(b)},d.start=function(a){this.loadImage({_font:this.font},function(c,d){var e=d._font,f=b.registerFont(e,c);f.destroy=function(){delete b.fonts[f.font],f.chars=null,c.destroy()},a(f,d)}.bind(this),!0)},namespace("springroll.pixi").BitmapFontTask=c}}(),(new(include("springroll.ApplicationPlugin"))).setup=function(){this.assetManager.register("springroll.pixi.TextureTask",60),this.assetManager.register("springroll.pixi.TextureAtlasTask",70),this.assetManager.register("springroll.pixi.BitmapFontTask",80),this.once("displayAdded",function(a){var b=this.options;!b.defaultAssetType&&a instanceof include("springroll.PixiDisplay")&&(b.defaultAssetType="pixi")})},function(a){var b={};b.Circle=include("PIXI.Circle"),b.Ellipse=include("PIXI.Ellipse"),b.Rectangle=include("PIXI.Rectangle"),b.Sector=include("PIXI.Sector"),b.Point=include("PIXI.Point"),b.Polygon=include("PIXI.Polygon"),b.useRadians=!0,b.getLocalBounds=function(a){var b,c=a.width,d=a.height;return(b=c&&d?new PIXI.Rectangle(-a.pivot.x,-a.pivot.y,c/a.scale.x,d/a.scale.y):new PIXI.Rectangle).right=b.x+b.width,b.bottom=b.y+b.height,b},b.getScale=function(b,c){return c!==a?b.scale[c]:b.scale},b.setPosition=function(b,c,d){return d!==a?b.position[d]=c:(c.x!==a&&(b.position.x=c.x),c.y!==a&&(b.position.y=c.y)),b},b.getPosition=function(b,c){return c!==a?b.position[c]:b.position},b.setScale=function(b,c,d){return d!==a?b.scale[d]=c:b.scale.x=b.scale.y=c,b},b.setPivot=function(b,c,d){return d!==a&&(b.pivot[d]=c),b.pivot=c,b},b.setHitArea=function(a,b){return a.hitArea=b,a},b.getBitmapSize=function(a){return{h:a.height/a.scale.y,w:a.width/a.scale.x}},b.removeChildren=function(a){a.removeChildren()},b.contains=function(a,b){for(;b;){if(b==a)return!0;b=b.parent}return!1},namespace("springroll.pixi").DisplayAdapter=b}(),function(){var b=include("springroll.AbstractDisplay"),c=include("PIXI.Container"),d=include("PIXI.CanvasRenderer"),e=include("PIXI.WebGLRenderer"),f=include("PIXI.autoDetectRenderer"),g=include("springroll.pixi.enableLegacy"),h=function(a,h){b.call(this,a,h),h=h||{},this.keepMouseover=h.keepMouseover||!1,this._autoPreventDefault=!h.hasOwnProperty("autoPreventDefault")||h.autoPreventDefault,this.stage=new c,this.renderer=null;var i={view:this.canvas,transparent:!!h.transparent,antialias:!!h.antiAlias,preserveDrawingBuffer:!!h.preserveDrawingBuffer,clearBeforeRender:!!h.clearView,backgroundColor:h.backgroundColor||0,autoResize:!1,legacy:!!h.legacy},j=!!h.preMultAlpha;i.transparent&&!j&&(i.transparent="notMultiplied"),"webgl"==h.forceContext||0<window.navigator.userAgent.indexOf("Trident/7.0")&&(h.forceContext="canvas2d"),"canvas2d"==h.forceContext?this.renderer=new d(this.width,this.height,i):"webgl"==h.forceContext?this.renderer=new e(this.width,this.height,i):this.renderer=f(this.width,this.height,i),this.isWebGL=this.renderer instanceof e,this.adapter=include("springroll.pixi.DisplayAdapter"),this.autoPreventDefault=this._autoPreventDefault,h.legacy&&g(this.renderer)},i=b.prototype,j=b.extend(h);Object.defineProperty(j,"enabled",{get:function(){return this._enabled},set:function(a){Object.getOwnPropertyDescriptor(i,"enabled").set.call(this,a);var b=this.renderer.plugins.interaction;b&&(a?b.setTargetElement(this.canvas):this.keepMouseover?b.removeClickEvents():b.removeEvents())}}),Object.defineProperty(j,"autoPreventDefault",{get:function(){return this._autoPreventDefault},set:function(a){this._autoPreventDefault=!!a;var b=this.renderer.plugins.interaction;b&&(b.autoPreventDefault=this._autoPreventDefault)}}),j.resize=function(a,b){i.resize.call(this,a,b),this.renderer.resize(a,b)},j.render=function(a,b){(b||!this.paused&&this._visible)&&this.renderer.render(this.stage)},j.destroy=function(){this.stage.destroy(),i.destroy.call(this),this.renderer.destroy(),this.renderer=null},namespace("springroll").PixiDisplay=h,namespace("springroll.pixi").PixiDisplay=h}(),function(){function a(a){e+=a,b.update(e)}var b=include("PIXI.ticker.shared",!1),c=include("springroll.ApplicationPlugin");if(b){var d=new c,e=0;b.autoStart=!1,b.stop(),d.setup=function(){this.on("update",a,300)}}}()}(),function(){"use strict";function b(a,b){return a.position-b.position}function c(b,c,d,f,g){f===a&&(f=4),f<0&&(f=0),g||(g=[]);var h,i,j=[],k=[];for(h=1;h<f;++h){var l="";i=1;for(var m=0;m<h;++m)l+="0",i*=10;j.unshift(l),k.push(i)}var n,o,p=k.length,q=e.fromFrame;for(h=c,o=d;h<=o;++h){var r=null;for(i=0;i<p;++i)if(h<k[i]){r=j[i]+h;break}r||(r=h.toString());var t=q(b.replace("#",r),!0);t&&(n=t),n&&g.push(n)}return g}function f(a,b){d.call(this),this.currentFrame=0,this._framerate=0,this._duration=0,this._t=0,this._labels=0,this._events=0,this._textures=null,a&&this.init(a,b)}var a,d,e,g,h;(new(include("springroll.ApplicationPlugin"))).setup=function(){this.assetManager.register("springroll.pixi.AdvancedMovieClipTask",80),this.animator.register("springroll.pixi.AdvancedMovieClipInstance",10)},d=include("PIXI.Sprite"),e=include("PIXI.Texture"),g=extend(f,d),h=d.prototype,Object.defineProperty(g,"framerate",{get:function(){return this._framerate},set:function(a){0<a?(this._framerate=a,this._duration=a?this._textures.length/a:0):this._framerate=this._duration=0}}),Object.defineProperty(g,"elapsedTime",{get:function(){return this._t},set:function(a){this._t=a,this._t>this._duration&&(this._t=this._duration),this.currentFrame=Math.floor(this._t*this._framerate+1e-7),this.currentFrame>=this._textures.length&&(this.currentFrame=this._textures.length-1),this.texture=this._textures[this.currentFrame]||e.EMPTY}}),Object.defineProperty(g,"totalFrames",{get:function(){return this._textures.length}}),g.gotoAndStop=function(a){var b=null;if("string"==typeof a){for(var c=this._labels,d=0,f=c.length;d<f;++d)if(c[d].label==a){b=c[d].position;break}}else b=a;null!==b&&(b>=this._textures.length&&(b=this._textures.length-1),this.currentFrame=b,0<this._framerate?this._t=b/this._framerate:this._t=0,this.texture=this._textures[b]||e.EMPTY)},g.advance=function(a){0<this._framerate&&a&&(this._t+=.001*a,this._t>this._duration&&(this._t=this._duration),this.currentFrame=Math.floor(this._t*this._framerate+1e-7),this.currentFrame>=this._textures.length&&(this.currentFrame=this._textures.length-1),this.texture=this._textures[this.currentFrame]||e.EMPTY)},g.getLabels=function(){return this._labels},g.getEvents=function(){return this._events},g.getCurrentLabel=function(){for(var a=this._labels,b=null,c=0,d=a.length;c<d&&a[c].position<=this.currentFrame;++c)b=a[c].label;return b},g.init=function(a,d){var e,f=this._labels=[],g=this._events=[];if(a.labels){var h={};for(e in a.labels){var i={label:e,position:a.labels[e],length:1};h[e]=i.position,/_(loop|stop)$/.test(e)||g.push(i),f.push(i)}for(var j=null,k=0;k<g.length;k++){var l=g[k];j=l.position,l.length=h[e+"_stop"]-j||h[e+"_loop"]-j||0}f.sort(b),g.sort(b)}this._textures=[];for(var m,n=0;n<a.frames.length;++n){var o=a.frames[n];0<=(m=(e=o.name).lastIndexOf("/"))&&(e=e.substring(m+1)),d?d.getFrames(e,o.min,o.max,o.digits,this._textures):c(e,o.min,o.max,o.digits,this._textures)}a.fps?this.framerate=a.fps:this._framerate&&(this.framerate=this._framerate),a.origin?(this.pivot.x=a.origin.x,this.pivot.y=a.origin.y):this.pivot.x=this.pivot.y=0,this.gotoAndStop(0)},g.copyFrom=function(a){this._textures=a._textures,this._labels=a._labels,this._events=a._events,this.pivot.x=a.pivot.x,this.pivot.y=a.pivot.y,this._framerate=a._framerate,this._duration=a._duration},g.destroy=function(){this._labels=this._events=null,h.destroy.call(this)},namespace("springroll.pixi").AdvancedMovieClip=f,function(){function e(){c.call(this),this.startTime=0,this.length=0,this.firstFrame=-1,this.lastFrame=-1}var b=include("springroll.Application"),c=include("springroll.AnimatorInstance"),d=include("springroll.pixi.AdvancedMovieClip"),f=c.extend(e);f.init=function(a){a.framerate||(a.framerate=b.instance.options.fps||15),a.tickEnabled=!1,this.clip=a,this.isLooping=!1,this.currentName=null,this.position=this.duration=0,this.lastFrame=a.currentFrame},f.beginAnim=function(a,b){var c,d=this.currentName=a.anim,e=-1,f=-1,g=!1;if("*"==d)e=0,f=this.clip.totalFrames-1,g=!!a.loop;else for(var h=this.clip.getLabels(),i=d+"_stop",j=d+"_loop",k=0,l=h.length;k<l;++k)if((c=h[k]).label==d)e=c.position;else{if(c.label==i){f=c.position;break}if(c.label==j){f=c.position,g=!0;break}}this.firstFrame=e,this.lastFrame=f,this.length=f-e,this.isLooping=g;var m=this.clip.framerate;if(this.startTime=this.firstFrame/m,this.duration=this.length/m,b)this.position=0;else{var n=a.start||0;this.position=n<0?Math.random()*this.duration:n}this.clip.elapsedTime=this.startTime+this.position},f.endAnim=function(){this.clip.gotoAndStop(this.lastFrame)},f.setPosition=function(a){this.position=a,this.clip.elapsedTime=this.startTime+a},e.test=function(a){return a instanceof d},e.hasAnimation=function(a,b){if("*"==b)return!0;for(var c,d=a.getLabels(),e=-1,f=-1,g=b+"_stop",h=b+"_loop",i=0,j=d.length;i<j;++i)if((c=d[i]).label==b)e=c.position;else if(c.label==g||c.label==h){f=c.position;break}return 0<=e&&0<f},e.getDuration=function(a,c){if(a.framerate||(a.framerate=b.instance.options.fps||15),"*"==c)return a.totalFrames/a.framerate;for(var d,e=a.getLabels(),f=-1,g=-1,h=c+"_stop",i=c+"_loop",j=0,k=e.length;j<k;++j)if((d=e[j]).label==c)f=d.position;else if(d.label==h||d.label==i){g=d.position;break}return 0<=f&&0<g?(g-f)/a.framerate*1e3:0},f.destroy=function(){this.clip=null},namespace("springroll.pixi").AdvancedMovieClipInstance=e}(),function(){function c(b){a.call(this,b,b.anim),this.anim=this.filter(b.anim)}var a=include("springroll.pixi.TextureAtlasTask"),b=include("springroll.pixi.AdvancedMovieClip"),d=a.extend(c);c.test=function(b){return!!b.anim&&a.test(b)},d.start=function(a){this.loadAtlas({_anim:this.anim},function(c,d){var e=new b(d._anim,c);e.__AMC_destroy=e.destroy,e.destroy=function(){e.__AMC_destroy(),c.destroy()},a(e,d)},!0)},namespace("springroll.pixi").AdvancedMovieClipTask=c}()}(),function(){"use strict";var a;!function(a){function b(a){if(!a||"object"!=typeof a)return null;var b=a.constructor();for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var e=include("PIXI.Container"),f=include("PIXI.Point"),g=include("PIXI.Sprite"),h=include("PIXI.extras.BitmapText",!1),i=include("PIXI.Text"),j=include("PIXI.Texture"),k=function(c,k,l){include("springroll.Debug",!1),e.call(this),this.back=new g,this.label=null,this._stateFlags={},this._statePriority=c.priority||n,this._stateData=null,this._currentLabelStyle=null,this._offset=new f,this._width=0,this._height=0,this.addChild(this.back),this._onOver=this._onOver.bind(this),this._onOut=this._onOut.bind(this),this._onDown=this._onDown.bind(this),this._onUp=this._onUp.bind(this),this._onUpOutside=this._onUpOutside.bind(this),this._emitPress=this._emitPress.bind(this);var m,o=this._stateData={};if(k){delete(m=b(k)).text,delete m.type,m.x===a&&(m.x="center"),m.y===a&&(m.y="center");var p=m.style=b(k.style);"bitmap"==k.type?p.align=p.align||"left":(p.font=p.font||"bold 20pt Arial",p.fill=p.fill||"black",p.align=p.align||"left",p.stroke=p.stroke||"black",p.strokeThickness=p.strokeThickness||0,p.wordWrap=p.wordWrap||!1,p.wordWrapWidth=p.wordWrapWidth||100)}for(var q=this._statePriority.length-1;0<=q;--q){var r=this._statePriority[q];this._addProperty(r),"disabled"!=r&&"up"!=r&&(this._stateFlags[r]=!1);var s=c[r];if(s?(s.tex?o[r]={tex:s.tex}:o[r]={tex:s},"string"==typeof o[r].tex&&(o[r].tex=j.fromImage(o[r].tex))):o[r]=o.up,k)if(s&&s.label){s=s.label;var t=o[r].label={};t.style=s.style||m.style,t.x=s.x||m.x,t.y=s.y||m.y}else o[r].label=m}if(o.up,o.over||(o.over=o.up),o.down||(o.down=o.up),o.disabled||(o.disabled=o.up),c.offset?(this._offset.x=c.offset.x,this._offset.y=c.offset.y):this._offset.x=this._offset.y=0,c.scale){var u=c.scale||1;this.back.scale.x=this.back.scale.y=u}k&&(this.label="bitmap"==k.type&&h?new h(k.text,m.style):new i(k.text,m.style),this.label.setPivotToAlign=!0,this.addChild(this.label)),this.back.x=this._offset.x,this.back.y=this._offset.y,this._width=this.back.width,this._height=this.back.height,this.enabled=l===a||!!l},l=extend(k,e);k.BUTTON_PRESS="buttonPress",k.BUTTON_OVER="buttonOver",k.BUTTON_OUT="buttonOut";var m=["disabled","enabled","up","over","down"],n=["disabled","down","over","up"];Object.defineProperty(l,"width",{get:function(){return this._width*this.scale.x},set:function(a){this.scale.x=a/this._width}}),Object.defineProperty(l,"height",{get:function(){return this._height*this.scale.y},set:function(a){this.scale.y=a/this._height}}),l.setText=function(a){if(this.label){this.label.text=a,this.label instanceof i?this.label.updateText():this.label.validate();for(var b,c=0;c<this._statePriority.length;++c)if(this._stateFlags[this._statePriority[c]]){b=this._stateData[this._statePriority[c]];break}if(b||(b=this._stateData.up),"center"==(b=b.label).x){var d=this.back.width,e=this.label.width;switch(this._currentLabelStyle.align){case"center":this.label.position.x=.5*d;break;case"right":this.label.position.x=bw-.5*(d-e);break;default:this.label.position.x=.5*(d-e)}}else this.label.position.x=b.x+this._offset.x;"center"==b.y?this.label.position.y=.5*(this.back.height-this.label.height):this.label.position.y=b.y+this._offset.y}},Object.defineProperty(l,"enabled",{get:function(){return!this._stateFlags.disabled},set:function(a){this._stateFlags.disabled=!a,this.buttonMode=a,this.interactive=a,this.off("pointerdown",this._onDown),this.off("pointerover",this._onOver),this.off("pointerout",this._onOut),a?(this.on("pointerdown",this._onDown),this.on("pointerover",this._onOver),this.on("pointerout",this._onOut)):(this.off("pointerupoutside",this._onUpOutside),this.off("pointercancel",this._onUpOutside),this.off("pointerup",this._onUp),this._stateFlags.down=this._stateFlags.over=!1,this._over=!1,this._touchDown=!1),this._updateState()}}),l._addProperty=function(a){0<=m.indexOf(a)||Object.defineProperty(this,a,{get:function(){return this._stateFlags[a]},set:function(b){this._stateFlags[a]=b,this._updateState()}})},l._updateState=function(){if(this.back){for(var a,b=0;b<this._statePriority.length;++b)if(this._stateFlags[this._statePriority[b]]){a=this._stateData[this._statePriority[b]];break}if(a||(a=this._stateData.up),this.back.texture=a.tex,this.label){var d=a.label,e=this.label;if(this._currentLabelStyle&&function(a,b){if(a===b)return!0;for(var c in a)if(a[c]!=b[c])return!1;return!0}(this._currentLabelStyle,d.style)||(e.font=d.style.font,e.align=d.style.align,this._currentLabelStyle=d.style,e instanceof i?e.updateText():e.validate()),"center"==d.x){var f=this.back.width,g=e.width;switch(this._currentLabelStyle.align){case"center":e.position.x=.5*f;break;case"right":e.position.x=f-.5*(f-g);break;default:e.position.x=.5*(f-g)}}else e.position.x=d.x+this._offset.x;"center"==d.y?e.position.y=.5*(this.back.height-e.height):e.position.y=d.y+this._offset.y}return a}},l._onOver=function(a){this._stateFlags.over=!0,this._updateState(),this.emit(k.BUTTON_OVER,this)},l._onOut=function(a){this._stateFlags.over=!1,this._updateState(),this.emit(k.BUTTON_OUT,this)},l._onDown=function(a){this._stateFlags.down=!0,this._updateState(),this.on("pointerupoutside",this._onUpOutside),this.on("pointercancel",this._onUpOutside),this.on("pointerup",this._onUp)},l._onUp=function(a){this._stateFlags.down=!1,this.off("pointerupoutside",this._onUpOutside),this.off("pointercancel",this._onUpOutside),this.off("pointerup",this._onUp),this._updateState(),setTimeout(this._emitPress,0)},l._emitPress=function(){this.emit(k.BUTTON_PRESS,this)},l._onUpOutside=function(a){this._stateFlags.down=!1,this.off("pointerupoutside",this._onUpOutside),this.off("pointercancel",this._onUpOutside),this.off("pointerup",this._onUp),this._updateState()},l.destroy=function(){this.removeAllListeners(),this.removeChildren(),this.label=null,this.back=null,this._stateData=null,this._stateFlags=null,this._statePriority=null},namespace("springroll").Button=k,namespace("springroll.pixi").Button=k}(),a=function(a){this.obj=a,this.mouseDownObjPos={x:0,y:0},this.dragOffset=new PIXI.Point,this.mouseDownStagePos={x:0,y:0}},namespace("springroll").DragData=a,namespace("springroll.pixi").DragData=a,function(){var a,b,c,d=include("springroll.pixi.DragData"),e=function(d,e,f){a||(a=include("springroll.Application"),b=include("createjs.Tween",!1),c=include("PIXI.Point")),"function"!=typeof d||f||(f=e,e=d,d=a.instance.display),this.draggedObj=null,this.dragStartThreshold=20,this.mouseDownStagePos=new c(0,0),this.mouseDownObjPos=new c(0,0),this.allowStickyClick=!0,this.isTouchMove=!1,this.isHeldDrag=!1,this.isStickyClick=!1,this.snapSettings=null,this._interaction=d.renderer.plugins.interaction,this._dragOffset=null,this._dragStartCallback=e,this._dragEndCallback=f,this._triggerHeldDrag=this._triggerHeldDrag.bind(this),this._triggerStickyClick=this._triggerStickyClick.bind(this),this._stopDrag=this._stopDrag.bind(this),this._updateObjPosition=this._updateObjPosition.bind(this),this._draggableObjects=[],this._multitouch=!1,this._addedDragListeners=!1,this.helperPoint=new c(0,0)},f=extend(e);Object.defineProperty(f,"multitouch",{get:function(){return this._multitouch},set:function(a){if(this.draggedObj)if(this._multitouch)for(var b in this.draggedObj)this._stopDrag(b,!0);else this._stopDrag(null,!0);this._multitouch=!!a,this.draggedObj=a?{}:null}}),f.startDrag=function(a,b){this._objMouseDown(a,b)},f._objMouseDown=function(a,e){var g,h,i,j,f=e.data;!this._multitouch&&this.draggedObj||this._multitouch&&!f||(j=this._multitouch?(g=new d(a),h=(this.draggedObj[f.identifier]=g).mouseDownObjPos,i=g.mouseDownStagePos,g.dragOffset):(this.draggedObj=a,h=this.mouseDownObjPos,i=this.mouseDownStagePos,this._dragOffset=new c),b&&(b.removeTweens(a),b.removeTweens(a.position)),a._dragOffset?(j.x=a._dragOffset.x,j.y=a._dragOffset.y):(f.getLocalPosition(a.parent,j),j.x-=a.position.x,j.y-=a.position.y),h.x=a.position.x,h.y=a.position.y,f?(i.x=f.global.x,i.y=f.global.y,this.allowStickyClick&&"touch"!=f.pointerType?(this._interaction.on("pointermove",this._triggerHeldDrag),this._interaction.on("pointerup",this._triggerStickyClick)):(this.isTouchMove="touch"==f.pointerType,this.isHeldDrag=!0,this._startDrag(f))):(this.isHeldDrag=!0,this._startDrag()))},f._triggerStickyClick=function(a){var b=a.data;this.isStickyClick=!0,this._multitouch?this.draggedObj[b.identifier].obj:this.draggedObj,this._interaction.off("pointermove",this._triggerHeldDrag),this._interaction.off("pointerup",this._triggerStickyClick),this._startDrag(b)},f._triggerHeldDrag=function(a){var b,c=a.data;b=this._multitouch?(this.draggedObj[c.identifier].obj,this.draggedObj[c.identifier].mouseDownStagePos):(this.draggedObj,this.mouseDownStagePos);var d=c.global.x-b.x,e=c.global.y-b.y;d*d+e*e>=this.dragStartThreshold*this.dragStartThreshold&&(this.isHeldDrag=!0,this._interaction.off("pointermove",this._triggerHeldDrag),this._interaction.off("pointerup",this._triggerStickyClick),this._startDrag(c))},f._startDrag=function(a){var b;b=this._multitouch?this.draggedObj[a.identifier].obj:this.draggedObj,this._updateObjPosition({data:a}),this._addedDragListeners||(this._addedDragListeners=!0,this._interaction.on("pointermove",this._updateObjPosition),this._interaction.on("pointerup",this._stopDrag),this._interaction.on("pointerupoutside",this._stopDrag),this._interaction.on("pointerupcancel",this._stopDrag)),this._dragStartCallback(b)},f.stopDrag=function(a,b){var c=null;if(this._multitouch&&b)for(var d in this.draggedObj)if(this.draggedObj[d].obj==b){c=d;break}this._stopDrag(c,!0===a)},f._stopDrag=function(a,b){var c,d=null;if("number"==typeof a?d=a:a&&(d=a.data.identifier),this._multitouch){if(null===d){for(d in this.draggedObj)this._stopDrag(d,b);return}var e=this.draggedObj[d];if(!e)return;c=e.obj,this.mouseDownObjPos.x=e.mouseDownObjPos.x,this.mouseDownObjPos.y=e.mouseDownObjPos.y,delete this.draggedObj[d]}else c=this.draggedObj,this.draggedObj=null;if(c){var f=!this._multitouch;if(this._multitouch){var g=!1;for(d in this.draggedObj){g=!0;break}f=!g}f&&this._addedDragListeners&&(this._addedDragListeners=!1,this._interaction.off("pointermove",this._updateObjPosition),this._interaction.off("pointerup",this._stopDrag),this._interaction.off("pointerupoutside",this._stopDrag),this._interaction.off("pointerupcancel",this._stopDrag)),this.isTouchMove=!1,this.isStickyClick=!1,(this.isHeldMove=!1)!==b&&this._dragEndCallback(c)}},f._updateObjPosition=function(a){var b,c,d=a.data;if(this._multitouch){var e=this.draggedObj[d.identifier];b=e.obj,c=e.dragOffset}else b=this.draggedObj,c=this._dragOffset;if(b&&b.parent){var f=d.getLocalPosition(b.parent,this.helperPoint),g=b._dragBounds;if(g?(b.position.x=Math.clamp(f.x-c.x,g.x,g.right),b.position.y=Math.clamp(f.y-c.y,g.y,g.bottom)):(b.position.x=f.x-c.x,b.position.y=f.y-c.y),this.snapSettings)switch(this.snapSettings.mode){case"points":this._handlePointSnap(f,c,b)}}else this.stopDrag(!1,b)},f._handlePointSnap=function(a,b,c){for(var d=this.snapSettings,e=d.dist*d.dist,f=d.points,g=a.x-b.x,h=a.y-b.y,i=-1,j=null,k=f.length-1;0<=k;--k){var l=f[k],m=Math.distSq(g,h,l.x,l.y);m<=e&&(m<i||-1==i)&&(i=m,j=l)}j&&(draggedObj.position.x=j.x,draggedObj.position.y=j.y)};function g(){this.on("pointerdown",this._onMouseDownListener),this.buttonMode=this.interactive=!0}function h(){this.off("pointerdown",this._onMouseDownListener),this.buttonMode=this.interactive=!1}f.addObject=function(a,b,c){b&&(b.right=b.x+b.width,b.bottom=b.y+b.height),a._dragBounds=b,a._dragOffset=c||null,0<=this._draggableObjects.indexOf(a)||(a.enableDrag=g,a.disableDrag=h,a._onMouseDownListener=function(a){this._dragMan._objMouseDown(this,a)}.bind(a),(a._dragMan=this)._draggableObjects.push(a))},f.removeObject=function(a){var b=this._draggableObjects.indexOf(a);0<=b&&(a.disableDrag(),delete a.enableDrag,delete a.disableDrag,delete a._onMouseDownListener,delete a._dragMan,delete a._dragBounds,delete a._dragOffset,this._draggableObjects.splice(b,1))},f.destroy=function(){this.stopDrag(!1),this._updateObjPosition=null,this._dragStartCallback=null,this._dragEndCallback=null,this._triggerHeldDrag=null,this._triggerStickyClick=null,this._stopDrag=null,this._interaction=null;for(var a=this._draggableObjects.length-1;0<=a;--a){var b=this._draggableObjects[a];b.disableDrag(),delete b.enableDrag,delete b.disableDrag,delete b._onMouseDownListener,delete b._dragMan,delete b._dragBounds,delete b._dragOffset}this._draggableObjects=null},namespace("springroll").DragManager=e,namespace("springroll.pixi").DragManager=e}()}(),function(){var userAgent=navigator.userAgent;0<=userAgent.indexOf("Safari")?browser="Safari":0<=userAgent.indexOf("Firefox")?browser="Firefox":0<=userAgent.indexOf("IE")||userAgent.indexOf("Edge")?browser="IE":browser="Chrome",0<=userAgent.indexOf("Windows")?os="Windows":0<=userAgent.indexOf("Mac")?os="Mac":0<=userAgent.indexOf("iOS")||0<=userAgent.indexOf("iPhone")||0<=userAgent.indexOf("iPad")?os="Mac":os="Linux";var i,USLocale={cancel:3,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":"Mac"==os&&"Firefox"!=browser?126:19,caps_lock:20,esc:27,spacebar:32,pageup:33,pagedown:34,end:35,home:36,arrow_left:37,arrow_up:38,arrow_right:39,arrow_down:40,print_screen:"Linux"==os?42:"Mac"==os&&"Firefox"!=browser?124:44,insert:45,delete:46,scroll_lock:"Mac"==os&&"Firefox"!=browser?125:145,OS:"Firefox"==browser?"Mac"==os?224:91:[91,"Mac"==os?93:92],context_menu:"Mac"==os?0:93,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"\\":220,"[":219,"]":221,"'":222,"num_*":106,"num_+":107,num_enter:108,"num_-":109,"num_.":110,"num_/":111,num_lock:"Mac"==os?12:144,clear:"Mac"==os?12:144};for(i=65;i<=90;++i)USLocale[String.fromCharCode(i+32)]=i;for(i=48;i<=57;++i)USLocale[String.fromCharCode(i)]=i;for(i=96;i<=105;++i)USLocale["num_"+(i-96)]=i;for(i=112;i<=123;++i)USLocale["F"+(i-111)]=i;"Mac"==os?USLocale.meta=USLocale.command=USLocale.OS:(USLocale.meta=USLocale.ctrl,USLocale.command=0),namespace("springroll.keyboard").USLocale=USLocale}(),function(){function Keyboard(target,locale){this._onFocusLost=this._onFocusLost.bind(this),this._onPaused=this._onPaused.bind(this),this._onResumed=this._onResumed.bind(this),this._update=this._update.bind(this),this._keyDown=this._keyDown.bind(this),this._keyUp=this._keyUp.bind(this),(this.target=target).addEventListener("onblur",this._onFocusLost);var _keysByCode=this._keysByCode={},_keysByName=this._keysByName={};for(var keyName in this._activeCombos=[],this._updatedKeys=[],this.detectKeyCallback=null,this.detectCancelKey=null,this.detectModifiers=!1,this.modifiers=["ctrl","alt","shift","command"],this.scrollKeys=["arrow_down","arrow_up","arrow_left","arrow_right","spacebar"],locale){var codes=locale[keyName];Array.isArray(codes)||(codes=[codes]);var i,key=null;for(i=0;i<codes.length;++i)if(_keysByCode[codes[i]]){key=_keysByCode[codes[i]];break}for(key||(key=new Key),key.addName(keyName),key.addCode(codes),_keysByName[keyName]=key,i=0;i<codes.length;++i)_keysByCode[codes[i]]=key}this.enabled=!0;var app=Application.instance;app.on("paused",this._onPaused),app.on("resumed",this._onResumed),app.options.preventScrollingKeys&&this.restrictScrollingKeys()}var Application=include("springroll.Application"),Debug=include("springroll.Debug",!1),p=Keyboard.prototype;p.addKeyDown=function(keyName,callback,preventDefault){if(Array.isArray(keyName))for(var i=0;i<keyName.length;++i)this.addKeyDown(keyName[i],callback,preventDefault);else{var key=this._keysByName[keyName];key?key.addListener(callback,1,keyName,!!preventDefault):Debug&&Debug.warn("No key found with name '"+keyName+"'")}},p.removeKeyDown=function(keyName,callback){if(Array.isArray(keyName))for(var i=0;i<keyName.length;++i)this.removeKeyDown(keyName[i],callback,preventDefault);else{var key=this._keysByName[keyName];key&&key.removeListener(callback,1)}},p.addKeyRepeat=function(keyName,callback,preventDefault){if(Array.isArray(keyName))for(var i=0;i<keyName.length;++i)this.addKeyRepeat(keyName[i],callback,preventDefault);else{var key=this._keysByName[keyName];key?key.addListener(callback,2,keyName,!!preventDefault):Debug&&Debug.warn("No key found with name '"+keyName+"'")}},p.removeKeyRepeat=function(keyName,callback){if(Array.isArray(keyName))for(var i=0;i<keyName.length;++i)this.removeKeyRepeat(keyName[i],callback,preventDefault);else{var key=this._keysByName[keyName];key&&key.removeListener(callback,2)}},p.addKeyUp=function(keyName,callback,preventDefault){if(Array.isArray(keyName))for(var i=0;i<keyName.length;++i)this.addKeyUp(keyName[i],callback,preventDefault);else{var key=this._keysByName[keyName];key?key.addListener(callback,3,keyName,!!preventDefault):Debug&&Debug.warn("No key found with name '"+keyName+"'")}},p.removeKeyUp=function(keyName,callback){if(Array.isArray(keyName))for(var i=0;i<keyName.length;++i)this.removeKeyUp(keyName[i],callback,preventDefault);else{var key=this._keysByName[keyName];key&&key.removeListener(callback,3)}},p.setPreventDefaultOnKey=function(keyName,preventDefault){if(Array.isArray(keyName))for(var i=0;i<keyName.length;++i)this.setPreventDefaultOnKey(keyName[i],preventDefault);else{var key=this._keysByName[keyName];key&&key.setManualPreventDefault(preventDefault)}},p.restrictScrollingKeys=function(){this.setPreventDefaultOnKey(this.scrollKeys,!0)},p.addCombo=function(comboString,callback,preventDefault){!1!==preventDefault&&(preventDefault=!0);for(var combo,_activeCombos=this._activeCombos,i=_activeCombos.length-1;0<=i;--i)if(_activeCombos[i].name==comboString&&_activeCombos[i].preventDefault==preventDefault){combo=_activeCombos[i];break}combo||(combo=new Combo(comboString,preventDefault,this._keysByName),_activeCombos.push(combo)),combo.addListener(callback)},p.removeCombo=function(comboString,callback){for(var _activeCombos=this._activeCombos,i=_activeCombos.length-1;0<=i;--i)_activeCombos[i].name==comboString&&_activeCombos[i].removeListener(callback)&&(i==_activeCombos.length-1?_activeCombos.pop():_activeCombos.splice(i,1))},p.detectNextKey=function(callback,cancelKey,allowModifiers){void 0===cancelKey?cancelKey=this._keysByName.esc:cancelKey&&(cancelKey=this._keysByName[cancelKey]),this.detectKeyCallback=callback,this.detectCancelKey=cancelKey||null,this.detectModifiers=!!allowModifiers},p.stopDetecting=function(){this.detectKeyCallback=null,this.detectCancelKey=null},p.justPressed=function(keyName){var key=this._keysByName[keyName];return!!key&&key.justDown},p.isDown=function(keyName){var key=this._keysByName[keyName];return!!key&&key.isDown},p.justReleased=function(keyName){var key=this._keysByName[keyName];return!!key&&key.justUp},Object.defineProperty(p,"enabled",{get:function(){return this._enabled},set:function(value){this._enabled=value;var target=this.target;target.removeEventListener("keydown",this._keyDown,!0),target.removeEventListener("keyup",this._keyUp,!0),Application.instance.off("update",this._update),value?(target.addEventListener("keydown",this._keyDown,!0),target.addEventListener("keyup",this._keyUp,!0),Application.instance.on("update",this._update,-1e3)):this.clearKeys()}}),p.clearKeys=function(){var _keysByCode=this._keysByCode;if(_keysByCode)for(var code in _keysByCode){var key=_keysByCode[code];key.isDown=key.justDown=key.justUp=!1}},p._onFocusLost=function(ev){this.clearKeys()},p._onPaused=function(){this.enabled=!1},p._onResumed=function(){this.enabled=!0;var target=this.target;target&&target.focus&&target.focus()},p._update=function(elapsed){var _updatedKeys=this._updatedKeys;if(_updatedKeys&&_updatedKeys.length){for(var i=_updatedKeys.length-1;0<=i;--i){var key=_updatedKeys[i];key.justDown=key.justUp=!1}_updatedKeys.length=0}},p._keyDown=function(ev){var i,key=this._keysByCode[ev.keyCode];if(this.detectKeyCallback){var callback=this.detectKeyCallback;if(key&&key==this.detectCancelKey)callback(this.detectKeyCallback=null);else{var wasModifier=!1,modifiers=this.modifiers;if(this.detectModifiers)for(i=0;i<modifiers.length;++i)if(key===this._keysByName[modifiers[i]]){wasModifier=!0;break}if(!wasModifier){this.detectKeyCallback=null,key||(key=new Key(ev.keyCode,"key_"+ev.keyCode),this._keysByCode[ev.keyCode]=key,this._keysByName[key.name]=key);var detected=key.preferredName;if(this.detectModifiers)for(i=0;i<modifiers.length;++i)this._keysByName[modifiers[i]].isDown&&(detected=modifiers[i]+" + "+detected);callback(detected)}}}if(key){var preventDefault=!1;if(key.isDown)key.trigger(2);else for(key.isDown=key.justDown=!0,-1==this._updatedKeys.indexOf(key)&&this._updatedKeys.push(key),key.trigger(1),i=this._activeCombos.length-1;0<=i;--i)this._activeCombos[i].testKeyDown(ev.keyCode)&&(preventDefault=!0);if(key.shouldPreventDefault||preventDefault)return ev.preventDefault(),!0}},p._keyUp=function(ev){var key=this._keysByCode[ev.keyCode];if(key){var preventDefault=!1;if(key.isDown){key.isDown=!1,key.justUp=!0,-1==this._updatedKeys.indexOf(key)&&this._updatedKeys.push(key),key.trigger(3);for(var i=this._activeCombos.length-1;0<=i;--i)this._activeCombos[i].testKeyUp(ev.keyCode)&&(preventDefault=!0)}if(key.shouldPreventDefault||preventDefault)return ev.preventDefault(),!0}},p.destroy=function(){this.enabled=!1;var i,app=Application.instance;for(i in app&&(app.off("paused",this._onPaused),app.off("resumed",this._onResumed)),this.target.removeEventListener("onblur",this._onFocusLost),this._keysByCode)this._keysByCode[i].destroy();for(i=this._activeCombos.length-1;0<=i;--i)this._activeCombos[i].destroy();this._keysByCode=this._keysByName=this._updatedKeys=this._activeCombos=this.target=null,this._update=this._keyDown=this._keyUp=this._onResumed=this._onPaused=this._onFocusLost=null},namespace("springroll").Keyboard=Keyboard;var Key=function(){this.codes=[],this.names=[],this.preferredName=null,this.upListeners=[],this.repeatListeners=[],this.downListeners=[],this.manualPreventDefault=!1,this.shouldPreventDefault=!1,this.isDown=!1,this.justDown=!1,this.justUp=!1};(p=Key.prototype).addCode=function(code){if(Array.isArray(code))for(var i=0;i<code.length;++i)this.codes.push(code[i]);else this.codes.push(code)},p.addName=function(name){this.names.length||(this.preferredName=name),this.names.push(name)},p.setManualPreventDefault=function(preventDefault){if(this.manualPreventDefault=preventDefault)this.shouldPreventDefault=!0;else{preventDefault=!1;for(var listenerList=[this.downListeners,this.repeatListeners,this.upListeners],i=0;i<listenerList.length&&!preventDefault;++i)for(var listeners=listenerList[i],index=listeners.length-1;0<=index;--index)if(listeners[index]&&listeners[index].preventDefault){preventDefault=!0;break}this.shouldPreventDefault=preventDefault}},p.addListener=function(listener,type,requestedName,preventDefault){var listeners;switch(type){case 1:listeners=this.downListeners;break;case 2:listeners=this.repeatListeners;break;case 3:listeners=this.upListeners}-1==listeners.indexOf(listener)&&listeners.push(listener),this.preferredName!=requestedName&&(this.preferredName=requestedName),(listener.preventDefault=preventDefault)&&(this.shouldPreventDefault=!0)},p.removeListener=function(listener,type){var listeners;switch(type){case 1:listeners=this.downListeners;break;case 2:listeners=this.repeatListeners;break;case 3:listeners=this.upListeners}var index=listeners.indexOf(listener);0<=index&&(index<1?listeners.shift():listeners.splice(index,1)),this.setManualPreventDefault(this.manualPreventDefault)},p.trigger=function(type){var listeners;switch(type){case 1:listeners=this.downListeners;break;case 2:listeners=this.repeatListeners;break;case 3:listeners=this.upListeners}for(var i=0;i<listeners.length;++i)listeners[i](this.preferredName)},p.destroy=function(){this.codes=this.names=this.upListeners=this.repeatListeners=this.downListeners=null};var Combo=function(name,preventDefault,keysByNameRef){this.name=name,this.listeners=[],this.steps=[],this.currentStep=0,this.preventDefault=preventDefault;for(var steps=name.split(/\s+>\s+/g),i=0;i<steps.length;++i){for(var stepNames=steps[i].split(/\s+\+\s+/g),step=[],j=0;j<stepNames.length;++j){var keyName=stepNames[j];"\\>"==keyName?keyName=">":"\\+"==keyName&&(keyName="+");var key=keysByNameRef[keyName];key?step.push({sated:!1,released:!1,codes:key.codes}):Debug&&Debug.warn("Issue while creating combo - no key with name "+keyName)}step.length&&this.steps.push(step)}};(p=Combo.prototype).testKeyDown=function(keyCode){var i,key,step=this.steps[this.currentStep],found=!1;for(i=0;i<step.length;++i)if(0<=(key=step[i]).codes.indexOf(keyCode)){if(key.sated)break;found=key.sated=!0;break}if(!found)return this.resetStep(),this.currentStep=0,!1;var allSuccess=!0;for(i=0;i<step.length;++i)if(!(key=step[i]).sated){allSuccess=!1;break}return allSuccess&&this.currentStep+1==this.steps.length&&(this.trigger(),this.resetStep(),this.currentStep=0),this.preventDefault},p.testKeyUp=function(keyCode){var i,key,step=this.steps[this.currentStep],found=!1;for(i=0;i<step.length;++i)if((key=step[i]).sated&&0<=key.codes.indexOf(keyCode)){found=key.released=!0;break}if(found){var allReleased=!0;for(i=0;i<step.length;++i)if(!step[i].released){allReleased=!1;break}allReleased&&(this.resetStep(),++this.currentStep)}return found&&this.preventDefault},p.resetStep=function(){var step=this.steps[this.currentStep];for(i=0;i<step.length;++i)key=step[i],key.sated=key.released=!1},p.trigger=function(){for(var listeners=this.listeners,i=0;i<listeners.length;++i)listeners[i](this.name)},p.addListener=function(listener){var listeners=this.listeners;-1==listeners.indexOf(listener)&&listeners.push(listener)},p.removeListener=function(listener){var listeners=this.listeners,index=listeners.indexOf(listener);return 0<=index&&(index<1?listeners.shift():listeners.splice(index,1)),listeners.length<1},p.destroy=function(){this.listeners=this.steps=null}}(),function(){var Keyboard=include("springroll.Keyboard"),ApplicationPlugin=include("springroll.ApplicationPlugin"),USLocale=include("springroll.keyboard.USLocale"),plugin=new ApplicationPlugin;plugin.setup=function(){this.options.add("keyboardLocale",USLocale,!0),this.options.add("keyboardTarget",null,!0),this.options.add("preventScrollingKeys",!1,!0)},plugin.preload=function(done){var options=this.options;options.asDOMElement("keyboardTarget"),options.keepFocus=!0;var target=options.keyboardTarget||document,locale=options.keyboardLocale||USLocale;this.keyboard=new Keyboard(target,locale),done()},plugin.teardown=function(){this.keyboard.destroy(),this.keyboard=null}}();var _Group=function(){this._tweens={},this._tweensAddedDuringUpdate={}};_Group.prototype={getAll:function(){return Object.keys(this._tweens).map(function(tweenId){return this._tweens[tweenId]}.bind(this))},removeAll:function(){this._tweens={}},add:function(tween){this._tweens[tween.getId()]=tween,this._tweensAddedDuringUpdate[tween.getId()]=tween},remove:function(tween){delete this._tweens[tween.getId()],delete this._tweensAddedDuringUpdate[tween.getId()]},update:function(time,preserve){var tweenIds=Object.keys(this._tweens);if(0===tweenIds.length)return!1;for(time=void 0!==time?time:TWEEN.now();0<tweenIds.length;){this._tweensAddedDuringUpdate={};for(var i=0;i<tweenIds.length;i++){var tween=this._tweens[tweenIds[i]];tween&&!1===tween.update(time)&&(tween._isPlaying=!1,preserve||delete this._tweens[tweenIds[i]])}tweenIds=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var TWEEN=new _Group;TWEEN.Group=_Group,TWEEN._nextId=0,TWEEN.nextId=function(){return TWEEN._nextId++},"undefined"==typeof window&&"undefined"!=typeof process&&process.hrtime?TWEEN.now=function(){var time=process.hrtime();return 1e3*time[0]+time[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?TWEEN.now=window.performance.now.bind(window.performance):void 0!==Date.now?TWEEN.now=Date.now:TWEEN.now=function(){return(new Date).getTime()},TWEEN.Tween=function(object,group){this._object=object,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=TWEEN.Easing.Linear.None,this._interpolationFunction=TWEEN.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=group||TWEEN,this._id=TWEEN.nextId()},TWEEN.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(properties,duration){return this._valuesEnd=properties,void 0!==duration&&(this._duration=duration),this},start:function(time){for(var property in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==time?"string"==typeof time?TWEEN.now()+parseFloat(time):time:TWEEN.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[property]instanceof Array){if(0===this._valuesEnd[property].length)continue;this._valuesEnd[property]=[this._object[property]].concat(this._valuesEnd[property])}void 0!==this._object[property]&&(this._valuesStart[property]=this._object[property],this._valuesStart[property]instanceof Array==!1&&(this._valuesStart[property]*=1),this._valuesStartRepeat[property]=this._valuesStart[property]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(this._startTime+this._duration),this},stopChainedTweens:function(){for(var i=0,numChainedTweens=this._chainedTweens.length;i<numChainedTweens;i++)this._chainedTweens[i].stop()},group:function(group){return this._group=group,this},delay:function(amount){return this._delayTime=amount,this},repeat:function(times){return this._repeat=times,this},repeatDelay:function(amount){return this._repeatDelayTime=amount,this},yoyo:function(yy){return this._yoyo=yy,this},easing:function(eas){return this._easingFunction=eas,this},interpolation:function(inter){return this._interpolationFunction=inter,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(callback){return this._onStartCallback=callback,this},onUpdate:function(callback){return this._onUpdateCallback=callback,this},onComplete:function(callback){return this._onCompleteCallback=callback,this},onStop:function(callback){return this._onStopCallback=callback,this},update:function(time){var property,elapsed,value;if(time<this._startTime)return!0;for(property in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),elapsed=(time-this._startTime)/this._duration,elapsed=0===this._duration||1<elapsed?1:elapsed,value=this._easingFunction(elapsed),this._valuesEnd)if(void 0!==this._valuesStart[property]){var start=this._valuesStart[property]||0,end=this._valuesEnd[property];end instanceof Array?this._object[property]=this._interpolationFunction(end,value):("string"==typeof end&&(end="+"===end.charAt(0)||"-"===end.charAt(0)?start+parseFloat(end):parseFloat(end)),"number"==typeof end&&(this._object[property]=start+(end-start)*value))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object),1!==elapsed)return!0;if(0<this._repeat){for(property in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[property]&&(this._valuesStartRepeat[property]=this._valuesStartRepeat[property]+parseFloat(this._valuesEnd[property])),this._yoyo){var tmp=this._valuesStartRepeat[property];this._valuesStartRepeat[property]=this._valuesEnd[property],this._valuesEnd[property]=tmp}this._valuesStart[property]=this._valuesStartRepeat[property]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=time+this._repeatDelayTime:this._startTime=time+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var i=0,numChainedTweens=this._chainedTweens.length;i<numChainedTweens;i++)this._chainedTweens[i].start(this._startTime+this._duration);return!1}},TWEEN.Easing={Linear:{None:function(k){return k}},Quadratic:{In:function(k){return k*k},Out:function(k){return k*(2-k)},InOut:function(k){return(k*=2)<1?.5*k*k:-.5*(--k*(k-2)-1)}},Cubic:{In:function(k){return k*k*k},Out:function(k){return--k*k*k+1},InOut:function(k){return(k*=2)<1?.5*k*k*k:.5*((k-=2)*k*k+2)}},Quartic:{In:function(k){return k*k*k*k},Out:function(k){return 1- --k*k*k*k},InOut:function(k){return(k*=2)<1?.5*k*k*k*k:-.5*((k-=2)*k*k*k-2)}},Quintic:{In:function(k){return k*k*k*k*k},Out:function(k){return--k*k*k*k*k+1},InOut:function(k){return(k*=2)<1?.5*k*k*k*k*k:.5*((k-=2)*k*k*k*k+2)}},Sinusoidal:{In:function(k){return 1-Math.cos(k*Math.PI/2)},Out:function(k){return Math.sin(k*Math.PI/2)},InOut:function(k){return.5*(1-Math.cos(Math.PI*k))}},Exponential:{In:function(k){return 0===k?0:Math.pow(1024,k-1)},Out:function(k){return 1===k?1:1-Math.pow(2,-10*k)},InOut:function(k){return 0===k?0:1===k?1:(k*=2)<1?.5*Math.pow(1024,k-1):.5*(2-Math.pow(2,-10*(k-1)))}},Circular:{In:function(k){return 1-Math.sqrt(1-k*k)},Out:function(k){return Math.sqrt(1- --k*k)},InOut:function(k){return(k*=2)<1?-.5*(Math.sqrt(1-k*k)-1):.5*(Math.sqrt(1-(k-=2)*k)+1)}},Elastic:{In:function(k){return 0===k?0:1===k?1:-Math.pow(2,10*(k-1))*Math.sin(5*(k-1.1)*Math.PI)},Out:function(k){return 0===k?0:1===k?1:Math.pow(2,-10*k)*Math.sin(5*(k-.1)*Math.PI)+1},InOut:function(k){return 0===k?0:1===k?1:(k*=2)<1?-.5*Math.pow(2,10*(k-1))*Math.sin(5*(k-1.1)*Math.PI):.5*Math.pow(2,-10*(k-1))*Math.sin(5*(k-1.1)*Math.PI)+1}},Back:{In:function(k){var s=1.70158;return k*k*((1+s)*k-s)},Out:function(k){var s=1.70158;return--k*k*((1+s)*k+s)+1},InOut:function(k){var s=2.5949095;return(k*=2)<1?k*k*((1+s)*k-s)*.5:.5*((k-=2)*k*((1+s)*k+s)+2)}},Bounce:{In:function(k){return 1-TWEEN.Easing.Bounce.Out(1-k)},Out:function(k){return k<1/2.75?7.5625*k*k:k<2/2.75?7.5625*(k-=1.5/2.75)*k+.75:k<2.5/2.75?7.5625*(k-=2.25/2.75)*k+.9375:7.5625*(k-=2.625/2.75)*k+.984375},InOut:function(k){return k<.5?.5*TWEEN.Easing.Bounce.In(2*k):.5*TWEEN.Easing.Bounce.Out(2*k-1)+.5}}},TWEEN.Interpolation={Linear:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f),fn=TWEEN.Interpolation.Utils.Linear;return k<0?fn(v[0],v[1],f):1<k?fn(v[m],v[m-1],m-f):fn(v[i],v[m<i+1?m:i+1],f-i)},Bezier:function(v,k){for(var b=0,n=v.length-1,pw=Math.pow,bn=TWEEN.Interpolation.Utils.Bernstein,i=0;i<=n;i++)b+=pw(1-k,n-i)*pw(k,i)*v[i]*bn(n,i);return b},CatmullRom:function(v,k){var m=v.length-1,f=m*k,i=Math.floor(f),fn=TWEEN.Interpolation.Utils.CatmullRom;return v[0]===v[m]?(k<0&&(i=Math.floor(f=m*(1+k))),fn(v[(i-1+m)%m],v[i],v[(i+1)%m],v[(i+2)%m],f-i)):k<0?v[0]-(fn(v[0],v[0],v[1],v[1],-f)-v[0]):1<k?v[m]-(fn(v[m],v[m],v[m-1],v[m-1],f-m)-v[m]):fn(v[i?i-1:0],v[i],v[m<i+1?m:i+1],v[m<i+2?m:i+2],f-i)},Utils:{Linear:function(p0,p1,t){return(p1-p0)*t+p0},Bernstein:function(n,i){var fc=TWEEN.Interpolation.Utils.Factorial;return fc(n)/fc(i)/fc(n-i)},Factorial:function(){var a=[1];return function(n){var s=1;if(a[n])return a[n];for(var i=n;1<i;i--)s*=i;return a[n]=s}}(),CatmullRom:function(p0,p1,p2,p3,t){var v0=.5*(p2-p0),v1=.5*(p3-p1),t2=t*t;return(2*p1-2*p2+v0+v1)*(t*t2)+(-3*p1+3*p2-2*v0-v1)*t2+v0*t+p1}}},function(root){"function"==typeof define&&define.amd?define([],function(){return TWEEN}):"undefined"!=typeof module&&"object"==typeof exports?module.exports=TWEEN:void 0!==root&&(root.TWEEN=TWEEN)}(this),function(k,h){"object"==typeof exports&&"undefined"!=typeof module?h(exports):"function"==typeof define&&define.amd?define("rxjs",["exports"],h):h(k.rxjs={})}(this,function(k){function h(c,a){function b(){this.constructor=c}Mb(c,a),c.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)}function Q(c){return"function"==typeof c}function R(c){setTimeout(function(){throw c},0)}function sa(c){return null!==c&&"object"==typeof c}function Ma(c){return Error.call(this),this.message=c?c.length+" errors occurred during unsubscription:\n"+c.map(function(a,b){return b+1+") "+a.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=c,this}function Na(c){return c.reduce(function(a,b){return a.concat(b instanceof Y?b.errors:b)},[])}function ta(c){for(;c;){var a=c.destination,b=c.isStopped;if(c.closed||b)return!1;c=a&&a instanceof m?a:null}return!0}function D(){}function ua(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return Oa(c)}function Oa(c){return c?1===c.length?c[0]:function(a){return c.reduce(function(b,a){return a(b)},a)}:D}function Pa(c){if(c||(c=C.Promise||Promise),!c)throw Error("no Promise impl found");return c}function E(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}function va(){return function(c){return c.lift(new Nb(c))}}function S(c){return c?function(c){return new n(function(a){return c.schedule(function(){return a.complete()})})}(c):T}function A(c){return c&&"function"==typeof c.schedule}function wa(c,a){return new n(function(b){var d=new t,e=0;return d.add(a.schedule(function(){e===c.length?b.complete():(b.next(c[e++]),b.closed||d.add(this.schedule()))})),d})}function Z(c,a){return a?wa(c,a):new n(Qa(c))}function ha(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return A(a=c[c.length-1])?(c.pop(),wa(c,a)):Z(c)}function xa(c,a){return new n(a?function(b){return a.schedule(Pb,0,{error:c,subscriber:b})}:function(b){return b.error(c)})}function Pb(c){c.subscriber.error(c.error)}function J(c){return c}function K(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}function Ra(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}function ya(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}function B(c,a){return function(b){if("function"!=typeof c)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return b.lift(new Qb(c,a))}}function Rb(c){var a=this,b=c.args,d=c.subscriber,e=(c=c.params).callbackFunc,f=c.context,g=c.scheduler,l=c.subject;if(!l){l=c.subject=new U;try{e.apply(f,b.concat([function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];a.add(g.schedule(Sb,0,{value:b.length<=1?b[0]:b,subject:l}))}]))}catch(u){l.error(u)}}this.add(l.subscribe(d))}function Sb(c){var a=c.subject;a.next(c.value),a.complete()}function Tb(c){var a=this,b=c.params,d=c.subscriber;c=c.context;var e=b.callbackFunc,f=b.args,g=b.scheduler,l=b.subject;if(!l){l=b.subject=new U;try{e.apply(c,f.concat([function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];(c=b.shift())?a.add(g.schedule(Ua,0,{err:c,subject:l})):a.add(g.schedule(Ub,0,{value:b.length<=1?b[0]:b,subject:l}))}]))}catch(u){this.add(g.schedule(Ua,0,{err:u,subject:l}))}}this.add(l.subscribe(d))}function Ub(c){var a=c.subject;a.next(c.value),a.complete()}function Ua(c){c.subject.error(c.err)}function Va(c){return!!c&&"function"!=typeof c.subscribe&&"function"==typeof c.then}function p(c,a,b,d,e){if(void 0===e&&(e=new H(c,b,d)),!e.closed)return a instanceof n?a.subscribe(e):ia(a)(e)}function Wa(c,a){if(null!=c){if(c&&"function"==typeof c[V])return function(c,a){return new n(function(b){var d=new t;return d.add(a.schedule(function(){var e=c[V]();d.add(e.subscribe({next:function(c){d.add(a.schedule(function(){return b.next(c)}))},error:function(c){d.add(a.schedule(function(){return b.error(c)}))},complete:function(){d.add(a.schedule(function(){return b.complete()}))}}))})),d})}(c,a);if(Va(c))return function(c,a){return new n(function(b){var d=new t;return d.add(a.schedule(function(){return c.then(function(c){d.add(a.schedule(function(){b.next(c),d.add(a.schedule(function(){return b.complete()}))}))},function(c){d.add(a.schedule(function(){return b.error(c)}))})})),d})}(c,a);if(Xa(c))return wa(c,a);if(c&&"function"==typeof c[F]||"string"==typeof c)return function(c,a){if(!c)throw Error("Iterable cannot be null");return new n(function(b){var e,d=new t;return d.add(function(){e&&"function"==typeof e.return&&e.return()}),d.add(a.schedule(function(){e=c[F](),d.add(a.schedule(function(){if(!b.closed){var a,c;try{var d=e.next();a=d.value,c=d.done}catch(u){return void b.error(u)}c?b.complete():(b.next(a),this.schedule())}}))})),d})}(c,a)}throw new TypeError((null!==c&&typeof c||c)+" is not observable")}function G(c,a){return a?Wa(c,a):c instanceof n?c:new n(ia(c))}function M(c,a,b){return void 0===b&&(b=Number.POSITIVE_INFINITY),"function"==typeof a?function(d){return d.pipe(M(function(b,d){return G(c(b,d)).pipe(B(function(c,e){return a(b,c,d,e)}))},b))}:("number"==typeof a&&(b=a),function(a){return a.lift(new Yb(c,b))})}function za(c){return void 0===c&&(c=Number.POSITIVE_INFINITY),M(J,c)}function Ya(){return za(1)}function aa(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return Ya()(ha.apply(void 0,c))}function Aa(c){return new n(function(a){var b;try{b=c()}catch(d){return void a.error(d)}return(b?G(b):S()).subscribe(a)})}function ja(c,a){return new n(function(b){var d=c.length;if(0===d)b.complete();else for(var e=Array(d),f=0,g=0,l=function(l){var h=G(c[l]),u=!1;b.add(h.subscribe({next:function(b){u||(u=!0,g++),e[l]=b},error:function(a){return b.error(a)},complete:function(){++f!==d&&u||(g===d&&b.next(a?a.reduce(function(b,a,c){return b[a]=e[c],b},{}):e),b.complete())}}))},h=0;h<d;h++)l(h)})}function bc(c){var a=c.subscriber,b=c.condition;if(!a.closed){if(c.needIterate)try{c.state=c.iterate(c.state)}catch(f){return void a.error(f)}else c.needIterate=!0;if(b){var d=void 0;try{d=b(c.state)}catch(f){return void a.error(f)}if(!d)return void a.complete();if(a.closed)return}var e;try{e=c.resultSelector(c.state)}catch(f){return void a.error(f)}if(!a.closed&&(a.next(e),!a.closed))return this.schedule(c)}}function W(c){return!x(c)&&0<=c-parseFloat(c)+1}function cc(c){var a=c.subscriber,b=c.counter;c=c.period,a.next(b),this.schedule({subscriber:a,counter:b+1,period:c},c)}function bb(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];a=Number.POSITIVE_INFINITY;var b=null,d=c[c.length-1];return A(d)?(b=c.pop(),1<c.length&&"number"==typeof c[c.length-1]&&(a=c.pop())):"number"==typeof d&&(a=c.pop()),null===b&&1===c.length&&c[0]instanceof n?c[0]:za(a)(Z(c,b))}function dc(c){var a=c.keys,b=c.index,d=c.subscriber,e=c.subscription;if(c=c.obj,!d.closed)if(b<a.length){var f=a[b];d.next([f,c[f]]),e.add(this.schedule({keys:a,index:b+1,subscriber:d,subscription:e,obj:c}))}else d.complete()}function cb(c,a){function b(){return!b.pred.apply(b.thisArg,arguments)}return b.pred=c,b.thisArg=a,b}function I(c,a){return function(b){return b.lift(new ec(c,a))}}function db(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];if(1===c.length){if(!x(c[0]))return c[0];c=c[0]}return Z(c,void 0).lift(new fc)}function gc(c){var a=c.start,b=c.index,d=c.subscriber;b>=c.count?d.complete():(d.next(a),d.closed||(c.index=b+1,c.start=a+1,this.schedule(c)))}function eb(c,a,b){void 0===c&&(c=0);var d=-1;return W(a)?d=Number(a)<1?1:Number(a):A(a)&&(b=a),A(b)||(b=y),new n(function(a){var e=W(c)?c:+c-b.now();return b.schedule(hc,e,{index:0,period:d,subscriber:a})})}function hc(c){var a=c.index,b=c.period,d=c.subscriber;if(d.next(a),!d.closed){if(-1===b)return d.complete();c.index=a+1,this.schedule(c,b)}}function fb(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return"function"==typeof(a=c[c.length-1])&&c.pop(),Z(c,void 0).lift(new gb(a))}function hb(c){return function(a){return a.lift(new ic(c))}}function ib(c){var a=c.subscriber,b=c.context;b&&a.closeContext(b),a.closed||(c.context=a.openContext(),c.context.closeAction=this.schedule(c,c.bufferTimeSpan))}function jc(c){var a=c.bufferCreationInterval,b=c.bufferTimeSpan,d=c.subscriber,e=c.scheduler,f=d.openContext();d.closed||(d.add(f.closeAction=e.schedule(jb,b,{subscriber:d,context:f})),this.schedule(c,a))}function jb(c){c.subscriber.closeContext(c.context)}function kb(c,a){return M(c,a,1)}function kc(c){c.debouncedNext()}function ba(c){return void 0===c&&(c=null),function(a){return a.lift(new lc(c))}}function lb(c,a){return function(b){return b.lift(new mc(c,a))}}function ka(c){return void 0===c&&(c=nc),function(a){return a.lift(new oc(c))}}function nc(){return new ca}function Ca(c){return function(a){return 0===c?S():a.lift(new pc(c))}}function la(c){return function(a){return 0===c?S():a.lift(new rc(c))}}function ma(c,a){var b=!1;return 2<=arguments.length&&(b=!0),function(d){return d.lift(new sc(c,a,b))}}function na(c,a){return 2<=arguments.length?function(b){return ua(ma(c,a),la(1),ba(a))(b)}:function(b){return ua(ma(function(b,a,f){return c(b,a,f+1)}),la(1))(b)}}function N(c,a){return function(b){var d;if(d="function"==typeof c?c:function(){return c},"function"==typeof a)return b.lift(new tc(d,a));var e=Object.create(b,uc);return e.source=b,e.subjectFactory=d,e}}function wc(c){var a=c.period;c.subscriber.notifyNext(),this.schedule(c,a)}function xc(){return new v}function da(c,a){return"function"==typeof a?function(b){return b.pipe(da(function(b,e){return G(c(b,e)).pipe(B(function(c,d){return a(b,c,e,d)}))}))}:function(b){return b.lift(new zc(c))}}function Ac(c){c.subscriber.clearThrottle()}function nb(c,a,b){return void 0===b&&(b=y),function(d){var e=c instanceof Date&&!isNaN(+c),f=e?+c-b.now():Math.abs(c);return d.lift(new Bc(f,e,a,b))}}function Cc(c,a,b){return 0===b?[a]:(c.push(a),c)}function Dc(c){var a=c.subscriber,b=c.windowTimeSpan,d=c.window;d&&a.closeWindow(d),c.window=a.openWindow(),this.schedule(c,b)}function Ec(c){var a=c.windowTimeSpan,b=c.subscriber,d=c.scheduler,e=c.windowCreationInterval,f=b.openWindow(),g={action:this,subscription:null};g.subscription=d.schedule(ob,a,{subscriber:b,window:f,context:g}),this.add(g.subscription),this.schedule(c,e)}function ob(c){var a=c.subscriber,b=c.window;(c=c.context)&&c.action&&c.subscription&&c.action.remove(c.subscription),a.closeWindow(b)}function pb(c,a){for(var b=0,d=a.length;b<d;b++)for(var e=a[b],f=Object.getOwnPropertyNames(e.prototype),g=0,l=f.length;g<l;g++){var h=f[g];c.prototype[h]=e.prototype[h]}}function Fc(c,a){return void 0===a&&(a=null),new O({method:"GET",url:c,headers:a})}function Gc(c,a,b){return new O({method:"POST",url:c,body:a,headers:b})}function Hc(c,a){return new O({method:"DELETE",url:c,headers:a})}function Ic(c,a,b){return new O({method:"PUT",url:c,body:a,headers:b})}function Jc(c,a,b){return new O({method:"PATCH",url:c,body:a,headers:b})}function Kc(c,a){return Lc(new O({method:"GET",url:c,responseType:"json",headers:a}))}function qb(c,a,b){return Error.call(this),this.message=c,this.name="AjaxError",this.xhr=a,this.request=b,this.status=a.status,this.responseType=a.responseType||b.responseType,this.response=rb(this.responseType,a),this}function rb(c,a){switch(c){case"json":return c="response"in a?a.responseType?a.response:JSON.parse(a.response||a.responseText||"null"):JSON.parse(a.responseText||"null");case"xml":return a.responseXML;default:return"response"in a?a.response:a.responseText}}var Mb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,a){c.__proto__=a}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])},Mc=Object.assign||function(c){for(var a,b=1,d=arguments.length;b<d;b++)for(var e in a=arguments[b])Object.prototype.hasOwnProperty.call(a,e)&&(c[e]=a[e]);return c},Da=!1,C={Promise:void 0,set useDeprecatedSynchronousErrorHandling(c){c?console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+Error().stack):Da&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),Da=c},get useDeprecatedSynchronousErrorHandling(){return Da}},oa={closed:!0,next:function(c){},error:function(c){if(C.useDeprecatedSynchronousErrorHandling)throw c;R(c)},complete:function(){}},x=Array.isArray||function(c){return c&&"number"==typeof c.length};Ma.prototype=Object.create(Error.prototype);var a,Y=Ma,t=(c.prototype.unsubscribe=function(){var a;if(!this.closed){var b=this._parentOrParents,d=this._unsubscribe,e=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,b instanceof c)b.remove(this);else if(null!==b)for(var f=0;f<b.length;++f)b[f].remove(this);if(Q(d))try{d.call(this)}catch(g){a=g instanceof Y?Na(g.errors):[g]}if(x(e))for(f=-1,b=e.length;++f<b;)if(sa(d=e[f]))try{d.unsubscribe()}catch(g){a=a||[],g instanceof Y?a=a.concat(Na(g.errors)):a.push(g)}if(a)throw new Y(a)}},c.prototype.add=function(a){var b=a;if(!a)return c.EMPTY;switch(typeof a){case"function":b=new c(a);case"object":if(b===this||b.closed||"function"!=typeof b.unsubscribe)return b;if(this.closed)return b.unsubscribe(),b;b instanceof c||(a=b,(b=new c)._subscriptions=[a]);break;default:throw Error("unrecognized teardown "+a+" added to Subscription.")}if(null===(a=b._parentOrParents))b._parentOrParents=this;else if(a instanceof c){if(a===this)return b;b._parentOrParents=[a,this]}else{if(-1!==a.indexOf(this))return b;a.push(this)}return null===(a=this._subscriptions)?this._subscriptions=[b]:a.push(b),b},c.prototype.remove=function(a){var b=this._subscriptions;!b||-1!==(a=b.indexOf(a))&&b.splice(a,1)},c.EMPTY=((a=new c).closed=!0,a),c),pa="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),m=function(c){function a(b,d,e){var f=c.call(this)||this;switch(f.syncErrorValue=null,f.syncErrorThrown=!1,f.syncErrorThrowable=!1,f.isStopped=!1,arguments.length){case 0:f.destination=oa;break;case 1:if(!b){f.destination=oa;break}if("object"==typeof b){b instanceof a?(f.syncErrorThrowable=b.syncErrorThrowable,(f.destination=b).add(f)):(f.syncErrorThrowable=!0,f.destination=new sb(f,b));break}default:f.syncErrorThrowable=!0,f.destination=new sb(f,b,d,e)}return f}return h(a,c),a.prototype[pa]=function(){return this},a.create=function(b,c,e){return(b=new a(b,c,e)).syncErrorThrowable=!1,b},a.prototype.next=function(b){this.isStopped||this._next(b)},a.prototype.error=function(b){this.isStopped||(this.isStopped=!0,this._error(b))},a.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},a.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,c.prototype.unsubscribe.call(this))},a.prototype._next=function(b){this.destination.next(b)},a.prototype._error=function(b){this.destination.error(b),this.unsubscribe()},a.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},a.prototype._unsubscribeAndRecycle=function(){var b=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=b,this},a}(t),sb=function(c){function a(b,a,e,f){var l,d=c.call(this)||this;return d._parentSubscriber=b,b=d,Q(a)?l=a:a&&(l=a.next,e=a.error,f=a.complete,a!==oa&&(Q((b=Object.create(a)).unsubscribe)&&d.add(b.unsubscribe.bind(b)),b.unsubscribe=d.unsubscribe.bind(d))),d._context=b,d._next=l,d._error=e,d._complete=f,d}return h(a,c),a.prototype.next=function(b){if(!this.isStopped&&this._next){var a=this._parentSubscriber;C.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable?this.__tryOrSetError(a,this._next,b)&&this.unsubscribe():this.__tryOrUnsub(this._next,b)}},a.prototype.error=function(b){if(!this.isStopped){var a=this._parentSubscriber,c=C.useDeprecatedSynchronousErrorHandling;if(this._error)c&&a.syncErrorThrowable?this.__tryOrSetError(a,this._error,b):this.__tryOrUnsub(this._error,b),this.unsubscribe();else if(a.syncErrorThrowable)c?(a.syncErrorValue=b,a.syncErrorThrown=!0):R(b),this.unsubscribe();else{if(this.unsubscribe(),c)throw b;R(b)}}},a.prototype.complete=function(){var b=this;if(!this.isStopped){var a=this._parentSubscriber;if(this._complete){function c(){return b._complete.call(b._context)}C.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable?this.__tryOrSetError(a,c):this.__tryOrUnsub(c)}this.unsubscribe()}},a.prototype.__tryOrUnsub=function(b,a){try{b.call(this._context,a)}catch(e){if(this.unsubscribe(),C.useDeprecatedSynchronousErrorHandling)throw e;R(e)}},a.prototype.__tryOrSetError=function(b,a,c){if(!C.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{a.call(this._context,c)}catch(f){return C.useDeprecatedSynchronousErrorHandling?(b.syncErrorValue=f,b.syncErrorThrown=!0):R(f),!0}return!1},a.prototype._unsubscribe=function(){var b=this._parentSubscriber;this._parentSubscriber=this._context=null,b.unsubscribe()},a}(m),V="function"==typeof Symbol&&Symbol.observable||"@@observable",n=function(){function c(a){this._isScalar=!1,a&&(this._subscribe=a)}return c.prototype.lift=function(a){var b=new c;return b.source=this,b.operator=a,b},c.prototype.subscribe=function(a,b,c){var d=this.operator;a:{if(a){if(a instanceof m)break a;if(a[pa]){a=a[pa]();break a}}a=a||b||c?new m(a,b,c):new m(oa)}if(d?a.add(d.call(a,this.source)):a.add(this.source||C.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),C.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a},c.prototype._trySubscribe=function(a){try{return this._subscribe(a)}catch(b){C.useDeprecatedSynchronousErrorHandling&&(a.syncErrorThrown=!0,a.syncErrorValue=b),ta(a)?a.error(b):console.warn(b)}},c.prototype.forEach=function(a,b){var c=this;return new(b=Pa(b))(function(b,d){var e;e=c.subscribe(function(b){try{a(b)}catch(u){d(u),e&&e.unsubscribe()}},d,b)})},c.prototype._subscribe=function(a){var b=this.source;return b&&b.subscribe(a)},c.prototype[V]=function(){return this},c.prototype.pipe=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return 0===a.length?this:Oa(a)(this)},c.prototype.toPromise=function(a){var b=this;return new(a=Pa(a))(function(a,c){var d;b.subscribe(function(b){return d=b},function(b){return c(b)},function(){return a(d)})})},c.create=function(a){return new c(a)},c}();function c(a){this.closed=!1,this._subscriptions=this._parentOrParents=null,a&&(this._unsubscribe=a)}E.prototype=Object.create(Error.prototype);var tb=function(c){function a(b,a){var d=c.call(this)||this;return d.subject=b,d.subscriber=a,d.closed=!1,d}return h(a,c),a.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var b=this.subject,a=b.observers;this.subject=null,!a||0===a.length||b.isStopped||b.closed||-1!==(b=a.indexOf(this.subscriber))&&a.splice(b,1)}},a}(t),ub=function(c){function a(b){var a=c.call(this,b)||this;return a.destination=b,a}return h(a,c),a}(m),v=function(c){function a(){var b=c.call(this)||this;return b.observers=[],b.closed=!1,b.isStopped=!1,b.hasError=!1,b.thrownError=null,b}return h(a,c),a.prototype[pa]=function(){return new ub(this)},a.prototype.lift=function(b){var a=new Ea(this,this);return a.operator=b,a},a.prototype.next=function(b){if(this.closed)throw new E;if(!this.isStopped)for(var c=(a=this.observers).length,a=a.slice(),f=0;f<c;f++)a[f].next(b)},a.prototype.error=function(b){if(this.closed)throw new E;this.hasError=!0,this.thrownError=b,this.isStopped=!0;for(var c=(a=this.observers).length,a=a.slice(),f=0;f<c;f++)a[f].error(b);this.observers.length=0},a.prototype.complete=function(){if(this.closed)throw new E;this.isStopped=!0;for(var a=(b=this.observers).length,b=b.slice(),c=0;c<a;c++)b[c].complete();this.observers.length=0},a.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},a.prototype._trySubscribe=function(b){if(this.closed)throw new E;return c.prototype._trySubscribe.call(this,b)},a.prototype._subscribe=function(b){if(this.closed)throw new E;return this.hasError?(b.error(this.thrownError),t.EMPTY):this.isStopped?(b.complete(),t.EMPTY):(this.observers.push(b),new tb(this,b))},a.prototype.asObservable=function(){var b=new n;return b.source=this,b},a.create=function(b,a){return new Ea(b,a)},a}(n),Ea=function(c){function a(b,a){var d=c.call(this)||this;return d.destination=b,d.source=a,d}return h(a,c),a.prototype.next=function(b){var a=this.destination;a&&a.next&&a.next(b)},a.prototype.error=function(b){var a=this.destination;a&&a.error&&this.destination.error(b)},a.prototype.complete=function(){var b=this.destination;b&&b.complete&&this.destination.complete()},a.prototype._subscribe=function(b){return this.source?this.source.subscribe(b):t.EMPTY},a}(v),Nb=function(){function c(a){this.connectable=a}return c.prototype.call=function(a,b){var c=this.connectable;return c._refCount++,a=new Nc(a,c),b=b.subscribe(a),a.closed||(a.connection=c.connect()),b},c}(),Nc=function(c){function a(b,a){return(b=c.call(this,b)||this).connectable=a,b}return h(a,c),a.prototype._unsubscribe=function(){var b=this.connectable;if(b){this.connectable=null;var a=b._refCount;a<=0?this.connection=null:(b._refCount=a-1,1<a?this.connection=null:(a=this.connection,b=b._connection,this.connection=null,!b||a&&b!==a||b.unsubscribe()))}else this.connection=null},a}(m),vb=function(c){function a(b,a){var d=c.call(this)||this;return d.source=b,d.subjectFactory=a,d._refCount=0,d._isComplete=!1,d}return h(a,c),a.prototype._subscribe=function(b){return this.getSubject().subscribe(b)},a.prototype.getSubject=function(){var b=this._subject;return b&&!b.isStopped||(this._subject=this.subjectFactory()),this._subject},a.prototype.connect=function(){var b=this._connection;return b||(this._isComplete=!1,(b=this._connection=new t).add(this.source.subscribe(new Oc(this.getSubject(),this))),b.closed&&(this._connection=null,b=t.EMPTY)),b},a.prototype.refCount=function(){return va()(this)},a}(n),ea=vb.prototype,uc={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:ea._subscribe},_isComplete:{value:ea._isComplete,writable:!0},getSubject:{value:ea.getSubject},connect:{value:ea.connect},refCount:{value:ea.refCount}},Oc=function(c){function a(b,a){return(b=c.call(this,b)||this).connectable=a,b}return h(a,c),a.prototype._error=function(b){this._unsubscribe(),c.prototype._error.call(this,b)},a.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),c.prototype._complete.call(this)},a.prototype._unsubscribe=function(){var b=this.connectable;if(b){this.connectable=null;var a=b._connection;b._refCount=0,b._subject=null,b._connection=null,a&&a.unsubscribe()}},a}(ub);!function(c){function a(b,a){return(b=c.call(this,b)||this).connectable=a,b}h(a,c),a.prototype._unsubscribe=function(){var b=this.connectable;if(b){this.connectable=null;var a=b._refCount;a<=0?this.connection=null:(b._refCount=a-1,1<a?this.connection=null:(a=this.connection,b=b._connection,this.connection=null,!b||a&&b!==a||b.unsubscribe()))}else this.connection=null}}(m);var Qc=function(){function c(a,b,c,e){this.keySelector=a,this.elementSelector=b,this.durationSelector=c,this.subjectSelector=e}return c.prototype.call=function(a,b){return b.subscribe(new Pc(a,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},c}(),Pc=function(c){function a(b,a,e,f,g){return(b=c.call(this,b)||this).keySelector=a,b.elementSelector=e,b.durationSelector=f,b.subjectSelector=g,b.groups=null,b.attemptedToUnsubscribe=!1,b.count=0,b}return h(a,c),a.prototype._next=function(b){var a;try{a=this.keySelector(b)}catch(e){return void this.error(e)}this._group(b,a)},a.prototype._group=function(b,a){var c=this.groups;c||(c=this.groups=new Map);var g,d=c.get(a);if(this.elementSelector)try{g=this.elementSelector(b)}catch(l){this.error(l)}else g=b;if(!d&&(d=this.subjectSelector?this.subjectSelector():new v,c.set(a,d),b=new Fa(a,d,this),this.destination.next(b),this.durationSelector)){b=void 0;try{b=this.durationSelector(new Fa(a,d))}catch(l){return void this.error(l)}this.add(b.subscribe(new Rc(a,d,this)))}d.closed||d.next(g)},a.prototype._error=function(b){var a=this.groups;a&&(a.forEach(function(a,c){a.error(b)}),a.clear()),this.destination.error(b)},a.prototype._complete=function(){var b=this.groups;b&&(b.forEach(function(b,a){b.complete()}),b.clear()),this.destination.complete()},a.prototype.removeGroup=function(b){this.groups.delete(b)},a.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&c.prototype.unsubscribe.call(this))},a}(m),Rc=function(c){function a(b,a,e){var d=c.call(this,a)||this;return d.key=b,d.group=a,d.parent=e,d}return h(a,c),a.prototype._next=function(b){this.complete()},a.prototype._unsubscribe=function(){var b=this.parent,a=this.key;this.key=this.parent=null,b&&b.removeGroup(a)},a}(m),Fa=function(c){function a(b,a,e){var d=c.call(this)||this;return d.key=b,d.groupSubject=a,d.refCountSubscription=e,d}return h(a,c),a.prototype._subscribe=function(b){var a=new t,c=this.refCountSubscription,f=this.groupSubject;return c&&!c.closed&&a.add(new Sc(c)),a.add(f.subscribe(b)),a},a}(n),Sc=function(c){function a(b){var a=c.call(this)||this;return(a.parent=b).count++,a}return h(a,c),a.prototype.unsubscribe=function(){var b=this.parent;b.closed||this.closed||(c.prototype.unsubscribe.call(this),--b.count,0===b.count&&b.attemptedToUnsubscribe&&b.unsubscribe())},a}(t),wb=function(c){function a(b){var a=c.call(this)||this;return a._value=b,a}return h(a,c),Object.defineProperty(a.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),a.prototype._subscribe=function(b){var a=c.prototype._subscribe.call(this,b);return a&&!a.closed&&b.next(this._value),a},a.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new E;return this._value},a.prototype.next=function(b){c.prototype.next.call(this,this._value=b)},a}(v),fa=function(c){function a(b,a){var d=c.call(this,b,a)||this;return d.scheduler=b,d.work=a,d.pending=!1,d}return h(a,c),a.prototype.schedule=function(b,a){if(void 0===a&&(a=0),this.closed)return this;this.state=b,b=this.id;var c=this.scheduler;return null!=b&&(this.id=this.recycleAsyncId(c,b,a)),this.pending=!0,this.delay=a,this.id=this.id||this.requestAsyncId(c,this.id,a),this},a.prototype.requestAsyncId=function(b,a,c){return void 0===c&&(c=0),setInterval(b.flush.bind(b,this),c)},a.prototype.recycleAsyncId=function(b,a,c){if(void 0===c&&(c=0),null!==c&&this.delay===c&&!1===this.pending)return a;clearInterval(a)},a.prototype.execute=function(b,a){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(b=this._execute(b,a))?b:void(!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},a.prototype._execute=function(b,a){a=!1;var c=void 0;try{this.work(b)}catch(f){a=!0,c=!!f&&f||Error(f)}if(a)return this.unsubscribe(),c},a.prototype._unsubscribe=function(){var b=this.id,a=this.scheduler,c=a.actions,f=c.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,-1!==f&&c.splice(f,1),null!=b&&(this.id=this.recycleAsyncId(a,b,null)),this.delay=null},a}(function(c){function a(b,a){return c.call(this)||this}return h(a,c),a.prototype.schedule=function(b,a){return this},a}(t)),Tc=function(c){function a(b,a){var d=c.call(this,b,a)||this;return d.scheduler=b,d.work=a,d}return h(a,c),a.prototype.schedule=function(b,a){return void 0===a&&(a=0),0<a?c.prototype.schedule.call(this,b,a):(this.delay=a,this.state=b,this.scheduler.flush(this),this)},a.prototype.execute=function(b,a){return 0<a||this.closed?c.prototype.execute.call(this,b,a):this._execute(b,a)},a.prototype.requestAsyncId=function(b,a,e){return void 0===e&&(e=0),null!==e&&0<e||null===e&&0<this.delay?c.prototype.requestAsyncId.call(this,b,a,e):b.flush(this)},a}(fa),Ga=function(){function c(a,b){void 0===b&&(b=c.now),this.SchedulerAction=a,this.now=b}return c.prototype.schedule=function(a,b,c){return void 0===b&&(b=0),new this.SchedulerAction(this,a).schedule(c,b)},c.now=function(){return Date.now()},c}(),P=function(c){function a(b,d){void 0===d&&(d=Ga.now);var e=c.call(this,b,function(){return a.delegate&&a.delegate!==e?a.delegate.now():d()})||this;return e.actions=[],e.active=!1,e.scheduled=void 0,e}return h(a,c),a.prototype.schedule=function(b,d,e){return void 0===d&&(d=0),a.delegate&&a.delegate!==this?a.delegate.schedule(b,d,e):c.prototype.schedule.call(this,b,d,e)},a.prototype.flush=function(b){var a=this.actions;if(this.active)a.push(b);else{var c;this.active=!0;do{if(c=b.execute(b.state,b.delay))break}while(b=a.shift());if(this.active=!1,c){for(;b=a.shift();)b.unsubscribe();throw c}}},a}(Ga),xb=new(function(c){function a(){return null!==c&&c.apply(this,arguments)||this}return h(a,c),a}(P))(Tc),T=new n(function(c){return c.complete()}),Qa=function(c){return function(a){for(var b=0,d=c.length;b<d&&!a.closed;b++)a.next(c[b]);a.complete()}};!function(c){c.NEXT="N",c.ERROR="E",c.COMPLETE="C"}(k.NotificationKind||(k.NotificationKind={}));var w=function(){function c(a,b,c){this.kind=a,this.value=b,this.error=c,this.hasValue="N"===a}return c.prototype.observe=function(a){switch(this.kind){case"N":return a.next&&a.next(this.value);case"E":return a.error&&a.error(this.error);case"C":return a.complete&&a.complete()}},c.prototype.do=function(a,b,c){switch(this.kind){case"N":return a&&a(this.value);case"E":return b&&b(this.error);case"C":return c&&c()}},c.prototype.accept=function(a,b,c){return a&&"function"==typeof a.next?this.observe(a):this.do(a,b,c)},c.prototype.toObservable=function(){switch(this.kind){case"N":return ha(this.value);case"E":return xa(this.error);case"C":return S()}throw Error("unexpected notification kind value")},c.createNext=function(a){return void 0!==a?new c("N",a):c.undefinedValueNotification},c.createError=function(a){return new c("E",void 0,a)},c.createComplete=function(){return c.completeNotification},c.completeNotification=new c("C"),c.undefinedValueNotification=new c("N",void 0),c}(),Uc=function(){function c(a,b){void 0===b&&(b=0),this.scheduler=a,this.delay=b}return c.prototype.call=function(a,b){return b.subscribe(new yb(a,this.scheduler,this.delay))},c}(),yb=function(c){function a(b,a,e){return void 0===e&&(e=0),(b=c.call(this,b)||this).scheduler=a,b.delay=e,b}return h(a,c),a.dispatch=function(b){b.notification.observe(b.destination),this.unsubscribe()},a.prototype.scheduleMessage=function(b){this.destination.add(this.scheduler.schedule(a.dispatch,this.delay,new Vc(b,this.destination)))},a.prototype._next=function(b){this.scheduleMessage(w.createNext(b))},a.prototype._error=function(b){this.scheduleMessage(w.createError(b)),this.unsubscribe()},a.prototype._complete=function(){this.scheduleMessage(w.createComplete()),this.unsubscribe()},a}(m),Vc=function(c,a){this.notification=c,this.destination=a},X=function(c){function a(b,a,e){void 0===b&&(b=Number.POSITIVE_INFINITY),void 0===a&&(a=Number.POSITIVE_INFINITY);var d=c.call(this)||this;return d.scheduler=e,d._events=[],d._infiniteTimeWindow=!1,d._bufferSize=b<1?1:b,d._windowTime=a<1?1:a,a===Number.POSITIVE_INFINITY?(d._infiniteTimeWindow=!0,d.next=d.nextInfiniteTimeWindow):d.next=d.nextTimeWindow,d}return h(a,c),a.prototype.nextInfiniteTimeWindow=function(b){var a=this._events;a.push(b),a.length>this._bufferSize&&a.shift(),c.prototype.next.call(this,b)},a.prototype.nextTimeWindow=function(b){this._events.push(new Wc(this._getNow(),b)),this._trimBufferThenGetEvents(),c.prototype.next.call(this,b)},a.prototype._subscribe=function(b){var l,a=this._infiniteTimeWindow,c=a?this._events:this._trimBufferThenGetEvents(),f=this.scheduler,g=c.length;if(this.closed)throw new E;if(l=this.isStopped||this.hasError?t.EMPTY:(this.observers.push(b),new tb(this,b)),f&&b.add(b=new yb(b,f)),a)for(a=0;a<g&&!b.closed;a++)b.next(c[a]);else for(a=0;a<g&&!b.closed;a++)b.next(c[a].value);return this.hasError?b.error(this.thrownError):this.isStopped&&b.complete(),l},a.prototype._getNow=function(){return(this.scheduler||xb).now()},a.prototype._trimBufferThenGetEvents=function(){for(var b=this._getNow(),a=this._bufferSize,c=this._windowTime,f=this._events,g=f.length,l=0;l<g&&!(b-f[l].time<c);)l++;return a<g&&(l=Math.max(l,g-a)),0<l&&f.splice(0,l),f},a}(v),Wc=function(c,a){this.time=c,this.value=a},U=function(c){function a(){var b=null!==c&&c.apply(this,arguments)||this;return b.value=null,b.hasNext=!1,b.hasCompleted=!1,b}return h(a,c),a.prototype._subscribe=function(b){return this.hasError?(b.error(this.thrownError),t.EMPTY):this.hasCompleted&&this.hasNext?(b.next(this.value),b.complete(),t.EMPTY):c.prototype._subscribe.call(this,b)},a.prototype.next=function(b){this.hasCompleted||(this.value=b,this.hasNext=!0)},a.prototype.error=function(b){this.hasCompleted||c.prototype.error.call(this,b)},a.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&c.prototype.next.call(this,this.value),c.prototype.complete.call(this)},a}(v),Xc=1,Ha={},zb_setImmediate=function(c){var a=Xc++;return Ha[a]=c,Promise.resolve().then(function(){var b=Ha[a];b&&b()}),a},zb_clearImmediate=function(c){delete Ha[c]},Yc=function(c){function a(b,a){var d=c.call(this,b,a)||this;return d.scheduler=b,d.work=a,d}return h(a,c),a.prototype.requestAsyncId=function(b,a,e){return void 0===e&&(e=0),null!==e&&0<e?c.prototype.requestAsyncId.call(this,b,a,e):(b.actions.push(this),b.scheduled||(b.scheduled=zb_setImmediate(b.flush.bind(b,null))))},a.prototype.recycleAsyncId=function(b,a,e){if(void 0===e&&(e=0),null!==e&&0<e||null===e&&0<this.delay)return c.prototype.recycleAsyncId.call(this,b,a,e);0===b.actions.length&&(zb_clearImmediate(a),b.scheduled=void 0)},a}(fa),qa=new(function(c){function a(){return null!==c&&c.apply(this,arguments)||this}return h(a,c),a.prototype.flush=function(b){this.active=!0,this.scheduled=void 0;var c,a=this.actions,f=-1,g=a.length;b=b||a.shift();do{if(c=b.execute(b.state,b.delay))break}while(++f<g&&(b=a.shift()));if(this.active=!1,c){for(;++f<g&&(b=a.shift());)b.unsubscribe();throw c}},a}(P))(Yc),y=new P(fa),Zc=function(c){function a(b,a){var d=c.call(this,b,a)||this;return d.scheduler=b,d.work=a,d}return h(a,c),a.prototype.requestAsyncId=function(b,a,e){return void 0===e&&(e=0),null!==e&&0<e?c.prototype.requestAsyncId.call(this,b,a,e):(b.actions.push(this),b.scheduled||(b.scheduled=requestAnimationFrame(function(){return b.flush(null)})))},a.prototype.recycleAsyncId=function(b,a,e){if(void 0===e&&(e=0),null!==e&&0<e||null===e&&0<this.delay)return c.prototype.recycleAsyncId.call(this,b,a,e);0===b.actions.length&&(cancelAnimationFrame(a),b.scheduled=void 0)},a}(fa),$c=new(function(c){function a(){return null!==c&&c.apply(this,arguments)||this}return h(a,c),a.prototype.flush=function(b){this.active=!0,this.scheduled=void 0;var c,a=this.actions,f=-1,g=a.length;b=b||a.shift();do{if(c=b.execute(b.state,b.delay))break}while(++f<g&&(b=a.shift()));if(this.active=!1,c){for(;++f<g&&(b=a.shift());)b.unsubscribe();throw c}},a}(P))(Zc),Ab=function(c){function a(b,a){void 0===b&&(b=Ia),void 0===a&&(a=Number.POSITIVE_INFINITY);var d=c.call(this,b,function(){return d.frame})||this;return d.maxFrames=a,d.frame=0,d.index=-1,d}return h(a,c),a.prototype.flush=function(){for(var c,f,b=this.actions,a=this.maxFrames;(f=b[0])&&f.delay<=a&&(b.shift(),this.frame=f.delay,!(c=f.execute(f.state,f.delay))););if(c){for(;f=b.shift();)f.unsubscribe();throw c}},a.frameTimeFactor=10,a}(P),Ia=function(c){function a(b,a,e){void 0===e&&(e=b.index+=1);var d=c.call(this,b,a)||this;return d.scheduler=b,d.work=a,d.index=e,d.active=!0,d.index=b.index=e,d}return h(a,c),a.prototype.schedule=function(b,d){if(void 0===d&&(d=0),!this.id)return c.prototype.schedule.call(this,b,d);this.active=!1;var e=new a(this.scheduler,this.work);return this.add(e),e.schedule(b,d)},a.prototype.requestAsyncId=function(b,c,e){return void 0===e&&(e=0),this.delay=b.frame+e,(b=b.actions).push(this),b.sort(a.sortActions),!0},a.prototype.recycleAsyncId=function(b,a,c){},a.prototype._execute=function(b,a){if(!0===this.active)return c.prototype._execute.call(this,b,a)},a.sortActions=function(b,a){return b.delay===a.delay?b.index===a.index?0:b.index>a.index?1:-1:b.delay>a.delay?1:-1},a}(fa);K.prototype=Object.create(Error.prototype),Ra.prototype=Object.create(Error.prototype);var ca=Ra;ya.prototype=Object.create(Error.prototype);var F,Qb=function(){function c(a,b){this.project=a,this.thisArg=b}return c.prototype.call=function(a,b){return b.subscribe(new ad(a,this.project,this.thisArg))},c}(),ad=function(c){function a(b,a,e){return(b=c.call(this,b)||this).project=a,b.count=0,b.thisArg=e||b,b}return h(a,c),a.prototype._next=function(b){var a;try{a=this.project.call(this.thisArg,b,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(a)},a}(m),q=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}return h(a,c),a.prototype.notifyNext=function(b,a,c,f,g){this.destination.next(a)},a.prototype.notifyError=function(b,a){this.destination.error(b)},a.prototype.notifyComplete=function(b){this.destination.complete()},a}(m),H=function(c){function a(b,a,e){var d=c.call(this)||this;return d.parent=b,d.outerValue=a,d.outerIndex=e,d.index=0,d}return h(a,c),a.prototype._next=function(b){this.parent.notifyNext(this.outerValue,b,this.outerIndex,this.index++,this)},a.prototype._error=function(b){this.parent.notifyError(b,this),this.unsubscribe()},a.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},a}(m);F="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";var Xa=function(c){return c&&"number"==typeof c.length&&"function"!=typeof c},ia=function(c){if(c&&"function"==typeof c[V])return function(c){return function(a){var b=c[V]();if("function"!=typeof b.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return b.subscribe(a)}}(c);if(Xa(c))return Qa(c);if(Va(c))return function(c){return function(a){return c.then(function(b){a.closed||(a.next(b),a.complete())},function(b){return a.error(b)}).then(null,R),a}}(c);if(c&&"function"==typeof c[F])return function(c){return function(a){for(var b=c[F]();;){var d=b.next();if(d.done){a.complete();break}if(a.next(d.value),a.closed)break}return"function"==typeof b.return&&a.add(function(){b.return&&b.return()}),a}}(c);throw c=sa(c)?"an invalid object":"'"+c+"'",new TypeError("You provided "+c+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Bb={},Ja=function(){function c(a){this.resultSelector=a}return c.prototype.call=function(a,b){return b.subscribe(new ed(a,this.resultSelector))},c}(),ed=function(c){function a(b,a){return(b=c.call(this,b)||this).resultSelector=a,b.active=0,b.values=[],b.observables=[],b}return h(a,c),a.prototype._next=function(b){this.values.push(Bb),this.observables.push(b)},a.prototype._complete=function(){var b=this.observables,a=b.length;if(0===a)this.destination.complete();else{this.toRespond=this.active=a;for(var c=0;c<a;c++){var f=b[c];this.add(p(this,f,f,c))}}},a.prototype.notifyComplete=function(b){0==--this.active&&this.destination.complete()},a.prototype.notifyNext=function(b,a,c,f,g){f=(b=this.values)[c],f=this.toRespond?f===Bb?--this.toRespond:this.toRespond:0,b[c]=a,0===f&&(this.resultSelector?this._tryResultSelector(b):this.destination.next(b.slice()))},a.prototype._tryResultSelector=function(b){var a;try{a=this.resultSelector.apply(this,b)}catch(e){return void this.destination.error(e)}this.destination.next(a)},a}(q),Yb=function(){function c(a,b){void 0===b&&(b=Number.POSITIVE_INFINITY),this.project=a,this.concurrent=b}return c.prototype.call=function(a,b){return b.subscribe(new fd(a,this.project,this.concurrent))},c}(),fd=function(c){function a(b,a,e){return void 0===e&&(e=Number.POSITIVE_INFINITY),(b=c.call(this,b)||this).project=a,b.concurrent=e,b.hasCompleted=!1,b.buffer=[],b.active=0,b.index=0,b}return h(a,c),a.prototype._next=function(b){this.active<this.concurrent?this._tryNext(b):this.buffer.push(b)},a.prototype._tryNext=function(b){var a,c=this.index++;try{a=this.project(b,c)}catch(f){return void this.destination.error(f)}this.active++,this._innerSub(a,b,c)},a.prototype._innerSub=function(b,a,c){var d=new H(this,void 0,void 0);this.destination.add(d),p(this,b,a,c,d)},a.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},a.prototype.notifyNext=function(b,a,c,f,g){this.destination.next(a)},a.prototype.notifyComplete=function(b){var a=this.buffer;this.remove(b),this.active--,0<a.length?this._next(a.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},a}(q),Cb=new n(D),ec=function(){function c(a,b){this.predicate=a,this.thisArg=b}return c.prototype.call=function(a,b){return b.subscribe(new gd(a,this.predicate,this.thisArg))},c}(),gd=function(c){function a(b,a,e){return(b=c.call(this,b)||this).predicate=a,b.thisArg=e,b.count=0,b}return h(a,c),a.prototype._next=function(b){var a;try{a=this.predicate.call(this.thisArg,b,this.count++)}catch(e){return void this.destination.error(e)}a&&this.destination.next(b)},a}(m),fc=function(){function c(){}return c.prototype.call=function(a,b){return b.subscribe(new hd(a))},c}(),hd=function(c){function a(b){return(b=c.call(this,b)||this).hasFirst=!1,b.observables=[],b.subscriptions=[],b}return h(a,c),a.prototype._next=function(b){this.observables.push(b)},a.prototype._complete=function(){var b=this.observables,a=b.length;if(0===a)this.destination.complete();else{for(var c=0;c<a&&!this.hasFirst;c++){var f=p(this,f=b[c],f,c);this.subscriptions&&this.subscriptions.push(f),this.add(f)}this.observables=null}},a.prototype.notifyNext=function(b,a,c,f,g){if(!this.hasFirst){for(this.hasFirst=!0,b=0;b<this.subscriptions.length;b++)b!==c&&((f=this.subscriptions[b]).unsubscribe(),this.remove(f));this.subscriptions=null}this.destination.next(a)},a}(q),gb=function(){function c(a){this.resultSelector=a}return c.prototype.call=function(a,b){return b.subscribe(new id(a,this.resultSelector))},c}(),id=function(c){function a(b,a,e){return void 0===e&&(e=Object.create(null)),(b=c.call(this,b)||this).iterators=[],b.active=0,b.resultSelector="function"==typeof a?a:null,b.values=e,b}return h(a,c),a.prototype._next=function(b){var a=this.iterators;x(b)?a.push(new jd(b)):"function"==typeof b[F]?a.push(new kd(b[F]())):a.push(new ld(this.destination,this,b))},a.prototype._complete=function(){var b=this.iterators,a=b.length;if(this.unsubscribe(),0===a)this.destination.complete();else{this.active=a;for(var c=0;c<a;c++){var f=b[c];f.stillUnsubscribed?this.destination.add(f.subscribe(f,c)):this.active--}}},a.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},a.prototype.checkIterators=function(){for(var b=this.iterators,a=b.length,c=this.destination,f=0;f<a;f++){if("function"==typeof(g=b[f]).hasValue&&!g.hasValue())return}var l=!1,h=[];for(f=0;f<a;f++){var g,k=(g=b[f]).next();if(g.hasCompleted()&&(l=!0),k.done)return void c.complete();h.push(k.value)}this.resultSelector?this._tryresultSelector(h):c.next(h),l&&c.complete()},a.prototype._tryresultSelector=function(b){var a;try{a=this.resultSelector.apply(this,b)}catch(e){return void this.destination.error(e)}this.destination.next(a)},a}(m),kd=function(){function c(a){this.iterator=a,this.nextResult=a.next()}return c.prototype.hasValue=function(){return!0},c.prototype.next=function(){var a=this.nextResult;return this.nextResult=this.iterator.next(),a},c.prototype.hasCompleted=function(){var a=this.nextResult;return a&&a.done},c}(),jd=function(){function c(a){this.array=a,this.length=this.index=0,this.length=a.length}return c.prototype[F]=function(){return this},c.prototype.next=function(a){a=this.index++;var b=this.array;return a<this.length?{value:b[a],done:!1}:{value:null,done:!0}},c.prototype.hasValue=function(){return this.array.length>this.index},c.prototype.hasCompleted=function(){return this.array.length===this.index},c}(),ld=function(c){function a(b,a,e){return(b=c.call(this,b)||this).parent=a,b.observable=e,b.stillUnsubscribed=!0,b.buffer=[],b.isComplete=!1,b}return h(a,c),a.prototype[F]=function(){return this},a.prototype.next=function(){var b=this.buffer;return 0===b.length&&this.isComplete?{value:null,done:!0}:{value:b.shift(),done:!1}},a.prototype.hasValue=function(){return 0<this.buffer.length},a.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},a.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},a.prototype.notifyNext=function(b,a,c,f,g){this.buffer.push(a),this.parent.checkIterators()},a.prototype.subscribe=function(b,a){return p(this,this.observable,this,a)},a}(q),ic=function(){function c(a){this.durationSelector=a}return c.prototype.call=function(a,b){return b.subscribe(new md(a,this.durationSelector))},c}(),md=function(c){function a(b,a){return(b=c.call(this,b)||this).durationSelector=a,b.hasValue=!1,b}return h(a,c),a.prototype._next=function(b){if(this.value=b,this.hasValue=!0,!this.throttled){var a=void 0;try{a=(0,this.durationSelector)(b)}catch(f){return this.destination.error(f)}!(b=p(this,a))||b.closed?this.clearThrottle():this.add(this.throttled=b)}},a.prototype.clearThrottle=function(){var b=this.value,a=this.hasValue,c=this.throttled;c&&(this.remove(c),this.throttled=null,c.unsubscribe()),a&&(this.value=null,this.hasValue=!1,this.destination.next(b))},a.prototype.notifyNext=function(b,a,c,f){this.clearThrottle()},a.prototype.notifyComplete=function(){this.clearThrottle()},a}(q),od=function(){function c(a){this.closingNotifier=a}return c.prototype.call=function(a,b){return b.subscribe(new nd(a,this.closingNotifier))},c}(),nd=function(c){function a(b,a){return(b=c.call(this,b)||this).buffer=[],b.add(p(b,a)),b}return h(a,c),a.prototype._next=function(b){this.buffer.push(b)},a.prototype.notifyNext=function(b,a,c,f,g){b=this.buffer,this.buffer=[],this.destination.next(b)},a}(q),rd=function(){function c(a,b){this.bufferSize=a,this.subscriberClass=(this.startBufferEvery=b)&&a!==b?pd:qd}return c.prototype.call=function(a,b){return b.subscribe(new this.subscriberClass(a,this.bufferSize,this.startBufferEvery))},c}(),qd=function(c){function a(b,a){return(b=c.call(this,b)||this).bufferSize=a,b.buffer=[],b}return h(a,c),a.prototype._next=function(b){var a=this.buffer;a.push(b),a.length==this.bufferSize&&(this.destination.next(a),this.buffer=[])},a.prototype._complete=function(){var b=this.buffer;0<b.length&&this.destination.next(b),c.prototype._complete.call(this)},a}(m),pd=function(c){function a(b,a,e){return(b=c.call(this,b)||this).bufferSize=a,b.startBufferEvery=e,b.buffers=[],b.count=0,b}return h(a,c),a.prototype._next=function(b){var a=this.bufferSize,c=this.startBufferEvery,f=this.buffers,g=this.count;for(this.count++,0==g%c&&f.push([]),c=f.length;c--;)(g=f[c]).push(b),g.length===a&&(f.splice(c,1),this.destination.next(g))},a.prototype._complete=function(){for(var b=this.buffers,a=this.destination;0<b.length;){var e=b.shift();0<e.length&&a.next(e)}c.prototype._complete.call(this)},a}(m),td=function(){function c(a,b,c,e){this.bufferTimeSpan=a,this.bufferCreationInterval=b,this.maxBufferSize=c,this.scheduler=e}return c.prototype.call=function(a,b){return b.subscribe(new sd(a,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},c}(),ud=function(){this.buffer=[]},sd=function(c){function a(b,a,e,f,g){if((b=c.call(this,b)||this).bufferTimeSpan=a,b.bufferCreationInterval=e,b.maxBufferSize=f,b.scheduler=g,b.contexts=[],f=b.openContext(),b.timespanOnly=null==e||e<0,b.timespanOnly)b.add(f.closeAction=g.schedule(ib,a,{subscriber:b,context:f,bufferTimeSpan:a}));else{var d={bufferTimeSpan:a,bufferCreationInterval:e,subscriber:b,scheduler:g};b.add(f.closeAction=g.schedule(jb,a,{subscriber:b,context:f})),b.add(g.schedule(jc,e,d))}return b}return h(a,c),a.prototype._next=function(b){for(var f,a=this.contexts,c=a.length,g=0;g<c;g++){var l=a[g],h=l.buffer;h.push(b),h.length==this.maxBufferSize&&(f=l)}f&&this.onBufferFull(f)},a.prototype._error=function(b){this.contexts.length=0,c.prototype._error.call(this,b)},a.prototype._complete=function(){for(var b=this.contexts,a=this.destination;0<b.length;){var e=b.shift();a.next(e.buffer)}c.prototype._complete.call(this)},a.prototype._unsubscribe=function(){this.contexts=null},a.prototype.onBufferFull=function(b){if(this.closeContext(b),(b=b.closeAction).unsubscribe(),this.remove(b),!this.closed&&this.timespanOnly){b=this.openContext();var a=this.bufferTimeSpan;this.add(b.closeAction=this.scheduler.schedule(ib,a,{subscriber:this,context:b,bufferTimeSpan:a}))}},a.prototype.openContext=function(){var b=new ud;return this.contexts.push(b),b},a.prototype.closeContext=function(b){this.destination.next(b.buffer);var a=this.contexts;0<=(a?a.indexOf(b):-1)&&a.splice(a.indexOf(b),1)},a}(m),wd=function(){function c(a,b){this.openings=a,this.closingSelector=b}return c.prototype.call=function(a,b){return b.subscribe(new vd(a,this.openings,this.closingSelector))},c}(),vd=function(c){function a(b,a,e){return(b=c.call(this,b)||this).openings=a,b.closingSelector=e,b.contexts=[],b.add(p(b,a)),b}return h(a,c),a.prototype._next=function(b){for(var a=this.contexts,c=a.length,f=0;f<c;f++)a[f].buffer.push(b)},a.prototype._error=function(b){for(var a=this.contexts;0<a.length;){var e=a.shift();e.subscription.unsubscribe(),e.buffer=null,e.subscription=null}this.contexts=null,c.prototype._error.call(this,b)},a.prototype._complete=function(){for(var b=this.contexts;0<b.length;){var a=b.shift();this.destination.next(a.buffer),a.subscription.unsubscribe(),a.buffer=null,a.subscription=null}this.contexts=null,c.prototype._complete.call(this)},a.prototype.notifyNext=function(b,a,c,f,g){b?this.closeBuffer(b):this.openBuffer(a)},a.prototype.notifyComplete=function(b){this.closeBuffer(b.context)},a.prototype.openBuffer=function(b){try{var a=this.closingSelector.call(this,b);a&&this.trySubscribe(a)}catch(e){this._error(e)}},a.prototype.closeBuffer=function(b){var a=this.contexts;if(a&&b){var c=b.subscription;this.destination.next(b.buffer),a.splice(a.indexOf(b),1),this.remove(c),c.unsubscribe()}},a.prototype.trySubscribe=function(b){var a=this.contexts,c=new t,f={buffer:[],subscription:c};a.push(f),!(b=p(this,b,f))||b.closed?this.closeBuffer(f):(b.context=f,this.add(b),c.add(b))},a}(q),yd=function(){function c(a){this.closingSelector=a}return c.prototype.call=function(a,b){return b.subscribe(new xd(a,this.closingSelector))},c}(),xd=function(c){function a(b,a){return(b=c.call(this,b)||this).closingSelector=a,b.subscribing=!1,b.openBuffer(),b}return h(a,c),a.prototype._next=function(b){this.buffer.push(b)},a.prototype._complete=function(){var b=this.buffer;b&&this.destination.next(b),c.prototype._complete.call(this)},a.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},a.prototype.notifyNext=function(b,a,c,f,g){this.openBuffer()},a.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},a.prototype.openBuffer=function(){var a,b=this.closingSubscription;b&&(this.remove(b),b.unsubscribe()),(b=this.buffer)&&this.destination.next(b),this.buffer=[];try{a=(0,this.closingSelector)()}catch(f){return this.error(f)}this.closingSubscription=b=new t,this.add(b),this.subscribing=!0,b.add(p(this,a)),this.subscribing=!1},a}(q),Ad=function(){function c(a){this.selector=a}return c.prototype.call=function(a,b){return b.subscribe(new zd(a,this.selector,this.caught))},c}(),zd=function(c){function a(b,a,e){return(b=c.call(this,b)||this).selector=a,b.caught=e,b}return h(a,c),a.prototype.error=function(b){if(!this.isStopped){var a=void 0;try{a=this.selector(b,this.caught)}catch(e){return void c.prototype.error.call(this,e)}this._unsubscribeAndRecycle(),b=new H(this,void 0,void 0),this.add(b),p(this,a,void 0,void 0,b)}},a}(q),Cd=function(){function c(a,b){this.predicate=a,this.source=b}return c.prototype.call=function(a,b){return b.subscribe(new Bd(a,this.predicate,this.source))},c}(),Bd=function(c){function a(b,a,e){return(b=c.call(this,b)||this).predicate=a,b.source=e,b.count=0,b.index=0,b}return h(a,c),a.prototype._next=function(b){this.predicate?this._tryPredicate(b):this.count++},a.prototype._tryPredicate=function(b){var a;try{a=this.predicate(b,this.index++,this.source)}catch(e){return void this.destination.error(e)}a&&this.count++},a.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},a}(m),Ed=function(){function c(a){this.durationSelector=a}return c.prototype.call=function(a,b){return b.subscribe(new Dd(a,this.durationSelector))},c}(),Dd=function(c){function a(b,a){return(b=c.call(this,b)||this).durationSelector=a,b.hasValue=!1,b.durationSubscription=null,b}return h(a,c),a.prototype._next=function(b){try{var a=this.durationSelector.call(this,b);a&&this._tryNext(b,a)}catch(e){this.destination.error(e)}},a.prototype._complete=function(){this.emitValue(),this.destination.complete()},a.prototype._tryNext=function(b,a){var c=this.durationSubscription;this.value=b,this.hasValue=!0,c&&(c.unsubscribe(),this.remove(c)),(c=p(this,a))&&!c.closed&&this.add(this.durationSubscription=c)},a.prototype.notifyNext=function(b,a,c,f,g){this.emitValue()},a.prototype.notifyComplete=function(){this.emitValue()},a.prototype.emitValue=function(){if(this.hasValue){var b=this.value,a=this.durationSubscription;a&&(this.durationSubscription=null,a.unsubscribe(),this.remove(a)),this.value=null,this.hasValue=!1,c.prototype._next.call(this,b)}},a}(q),Gd=function(){function c(a,b){this.dueTime=a,this.scheduler=b}return c.prototype.call=function(a,b){return b.subscribe(new Fd(a,this.dueTime,this.scheduler))},c}(),Fd=function(c){function a(b,a,e){return(b=c.call(this,b)||this).dueTime=a,b.scheduler=e,b.debouncedSubscription=null,b.lastValue=null,b.hasValue=!1,b}return h(a,c),a.prototype._next=function(b){this.clearDebounce(),this.lastValue=b,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(kc,this.dueTime,this))},a.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},a.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var b=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(b)}},a.prototype.clearDebounce=function(){var b=this.debouncedSubscription;null!==b&&(this.remove(b),b.unsubscribe(),this.debouncedSubscription=null)},a}(m),lc=function(){function c(a){this.defaultValue=a}return c.prototype.call=function(a,b){return b.subscribe(new Hd(a,this.defaultValue))},c}(),Hd=function(c){function a(b,a){return(b=c.call(this,b)||this).defaultValue=a,b.isEmpty=!0,b}return h(a,c),a.prototype._next=function(b){this.isEmpty=!1,this.destination.next(b)},a.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},a}(m),Jd=function(){function c(a,b){this.delay=a,this.scheduler=b}return c.prototype.call=function(a,b){return b.subscribe(new Id(a,this.delay,this.scheduler))},c}(),Id=function(c){function a(b,a,e){return(b=c.call(this,b)||this).delay=a,b.scheduler=e,b.queue=[],b.active=!1,b.errored=!1,b}return h(a,c),a.dispatch=function(b){for(var a=b.source,c=a.queue,f=b.scheduler,g=b.destination;0<c.length&&c[0].time-f.now()<=0;)c.shift().notification.observe(g);0<c.length?(a=Math.max(0,c[0].time-f.now()),this.schedule(b,a)):(this.unsubscribe(),a.active=!1)},a.prototype._schedule=function(b){this.active=!0,this.destination.add(b.schedule(a.dispatch,this.delay,{source:this,destination:this.destination,scheduler:b}))},a.prototype.scheduleNotification=function(b){if(!0!==this.errored){var a=this.scheduler;b=new Kd(a.now()+this.delay,b),this.queue.push(b),!1===this.active&&this._schedule(a)}},a.prototype._next=function(b){this.scheduleNotification(w.createNext(b))},a.prototype._error=function(b){this.errored=!0,this.queue=[],this.destination.error(b),this.unsubscribe()},a.prototype._complete=function(){this.scheduleNotification(w.createComplete()),this.unsubscribe()},a}(m),Kd=function(c,a){this.time=c,this.notification=a},Db=function(){function c(a){this.delayDurationSelector=a}return c.prototype.call=function(a,b){return b.subscribe(new Ld(a,this.delayDurationSelector))},c}(),Ld=function(c){function a(b,a){return(b=c.call(this,b)||this).delayDurationSelector=a,b.completed=!1,b.delayNotifierSubscriptions=[],b.index=0,b}return h(a,c),a.prototype.notifyNext=function(b,a,c,f,g){this.destination.next(b),this.removeSubscription(g),this.tryComplete()},a.prototype.notifyError=function(b,a){this._error(b)},a.prototype.notifyComplete=function(b){(b=this.removeSubscription(b))&&this.destination.next(b),this.tryComplete()},a.prototype._next=function(b){var a=this.index++;try{var c=this.delayDurationSelector(b,a);c&&this.tryDelay(c,b)}catch(f){this.destination.error(f)}},a.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},a.prototype.removeSubscription=function(b){b.unsubscribe();var a=this.delayNotifierSubscriptions.indexOf(b);return-1!==a&&this.delayNotifierSubscriptions.splice(a,1),b.outerValue},a.prototype.tryDelay=function(b,a){(b=p(this,b,a))&&!b.closed&&(this.destination.add(b),this.delayNotifierSubscriptions.push(b))},a.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},a}(q),Nd=function(c){function a(b,a){var d=c.call(this)||this;return d.source=b,d.subscriptionDelay=a,d}return h(a,c),a.prototype._subscribe=function(b){this.subscriptionDelay.subscribe(new Md(b,this.source))},a}(n),Md=function(c){function a(b,a){var d=c.call(this)||this;return d.parent=b,d.source=a,d.sourceSubscribed=!1,d}return h(a,c),a.prototype._next=function(b){this.subscribeToSource()},a.prototype._error=function(b){this.unsubscribe(),this.parent.error(b)},a.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},a.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},a}(m),Pd=function(){function c(){}return c.prototype.call=function(a,b){return b.subscribe(new Od(a))},c}(),Od=function(c){function a(b){return c.call(this,b)||this}return h(a,c),a.prototype._next=function(b){b.observe(this.destination)},a}(m),Rd=function(){function c(a,b){this.keySelector=a,this.flushes=b}return c.prototype.call=function(a,b){return b.subscribe(new Qd(a,this.keySelector,this.flushes))},c}(),Qd=function(c){function a(b,a,e){return(b=c.call(this,b)||this).keySelector=a,b.values=new Set,e&&b.add(p(b,e)),b}return h(a,c),a.prototype.notifyNext=function(b,a,c,f,g){this.values.clear()},a.prototype.notifyError=function(b,a){this._error(b)},a.prototype._next=function(b){this.keySelector?this._useKeySelector(b):this._finalizeNext(b,b)},a.prototype._useKeySelector=function(b){var a,c=this.destination;try{a=this.keySelector(b)}catch(f){return void c.error(f)}this._finalizeNext(a,b)},a.prototype._finalizeNext=function(b,a){var c=this.values;c.has(b)||(c.add(b),this.destination.next(a))},a}(q),mc=function(){function c(a,b){this.compare=a,this.keySelector=b}return c.prototype.call=function(a,b){return b.subscribe(new Sd(a,this.compare,this.keySelector))},c}(),Sd=function(c){function a(b,a,e){return(b=c.call(this,b)||this).keySelector=e,b.hasKey=!1,"function"==typeof a&&(b.compare=a),b}return h(a,c),a.prototype.compare=function(b,a){return b===a},a.prototype._next=function(b){var a;try{a=(c=this.keySelector)?c(b):b}catch(g){return this.destination.error(g)}if(c=!1,this.hasKey)try{var c=(0,this.compare)(this.key,a)}catch(g){return this.destination.error(g)}else this.hasKey=!0;c||(this.key=a,this.destination.next(b))},a}(m),oc=function(){function c(a){this.errorFactory=a}return c.prototype.call=function(a,b){return b.subscribe(new Td(a,this.errorFactory))},c}(),Td=function(c){function a(b,a){return(b=c.call(this,b)||this).errorFactory=a,b.hasValue=!1,b}return h(a,c),a.prototype._next=function(b){this.hasValue=!0,this.destination.next(b)},a.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var b=void 0;try{b=this.errorFactory()}catch(d){b=d}this.destination.error(b)},a}(m),pc=function(){function c(a){if(this.total=a,this.total<0)throw new K}return c.prototype.call=function(a,b){return b.subscribe(new Ud(a,this.total))},c}(),Ud=function(c){function a(b,a){return(b=c.call(this,b)||this).total=a,b.count=0,b}return h(a,c),a.prototype._next=function(b){var a=this.total,c=++this.count;c<=a&&(this.destination.next(b),c===a&&(this.destination.complete(),this.unsubscribe()))},a}(m),Wd=function(){function c(a,b,c){this.predicate=a,this.thisArg=b,this.source=c}return c.prototype.call=function(a,b){return b.subscribe(new Vd(a,this.predicate,this.thisArg,this.source))},c}(),Vd=function(c){function a(b,a,e,f){return(b=c.call(this,b)||this).predicate=a,b.thisArg=e,b.source=f,b.index=0,b.thisArg=e||b,b}return h(a,c),a.prototype.notifyComplete=function(b){this.destination.next(b),this.destination.complete()},a.prototype._next=function(b){var a=!1;try{a=this.predicate.call(this.thisArg,b,this.index++,this.source)}catch(e){return void this.destination.error(e)}a||this.notifyComplete(!1)},a.prototype._complete=function(){this.notifyComplete(!0)},a}(m),Yd=function(){function c(){}return c.prototype.call=function(a,b){return b.subscribe(new Xd(a))},c}(),Xd=function(c){function a(b){return(b=c.call(this,b)||this).hasCompleted=!1,b.hasSubscription=!1,b}return h(a,c),a.prototype._next=function(b){this.hasSubscription||(this.hasSubscription=!0,this.add(p(this,b)))},a.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},a.prototype.notifyComplete=function(b){this.remove(b),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},a}(q),qc=function(){function c(a){this.project=a}return c.prototype.call=function(a,b){return b.subscribe(new Zd(a,this.project))},c}(),Zd=function(c){function a(b,a){return(b=c.call(this,b)||this).project=a,b.hasSubscription=!1,b.hasCompleted=!1,b.index=0,b}return h(a,c),a.prototype._next=function(b){this.hasSubscription||this.tryNext(b)},a.prototype.tryNext=function(b){var a,c=this.index++;try{a=this.project(b,c)}catch(f){return void this.destination.error(f)}this.hasSubscription=!0,this._innerSub(a,b,c)},a.prototype._innerSub=function(b,a,c){var d=new H(this,void 0,void 0);this.destination.add(d),p(this,b,a,c,d)},a.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},a.prototype.notifyNext=function(b,a,c,f,g){this.destination.next(a)},a.prototype.notifyError=function(b){this.destination.error(b)},a.prototype.notifyComplete=function(b){this.destination.remove(b),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},a}(q),ae=function(){function c(a,b,c){this.project=a,this.concurrent=b,this.scheduler=c}return c.prototype.call=function(a,b){return b.subscribe(new $d(a,this.project,this.concurrent,this.scheduler))},c}(),$d=function(c){function a(b,a,e,f){return(b=c.call(this,b)||this).project=a,b.concurrent=e,b.scheduler=f,b.index=0,b.active=0,b.hasCompleted=!1,e<Number.POSITIVE_INFINITY&&(b.buffer=[]),b}return h(a,c),a.dispatch=function(b){b.subscriber.subscribeToProjection(b.result,b.value,b.index)},a.prototype._next=function(b){var c=this.destination;if(c.closed)this._complete();else{var e=this.index++;if(this.active<this.concurrent){c.next(b);try{var g=(0,this.project)(b,e);this.scheduler?this.destination.add(this.scheduler.schedule(a.dispatch,0,{subscriber:this,result:g,value:b,index:e})):this.subscribeToProjection(g,b,e)}catch(l){c.error(l)}}else this.buffer.push(b)}},a.prototype.subscribeToProjection=function(b,a,c){this.active++,this.destination.add(p(this,b,a,c))},a.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&this.destination.complete(),this.unsubscribe()},a.prototype.notifyNext=function(b,a,c,f,g){this._next(a)},a.prototype.notifyComplete=function(b){var a=this.buffer;this.destination.remove(b),this.active--,a&&0<a.length&&this._next(a.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},a}(q),ce=function(){function c(a){this.callback=a}return c.prototype.call=function(a,b){return b.subscribe(new be(a,this.callback))},c}(),be=function(c){function a(b,a){return(b=c.call(this,b)||this).add(new t(a)),b}return h(a,c),a}(m),Eb=function(){function c(a,b,c,e){this.predicate=a,this.source=b,this.yieldIndex=c,this.thisArg=e}return c.prototype.call=function(a,b){return b.subscribe(new de(a,this.predicate,this.source,this.yieldIndex,this.thisArg))},c}(),de=function(c){function a(b,a,e,f,g){return(b=c.call(this,b)||this).predicate=a,b.source=e,b.yieldIndex=f,b.thisArg=g,b.index=0,b}return h(a,c),a.prototype.notifyComplete=function(b){var a=this.destination;a.next(b),a.complete(),this.unsubscribe()},a.prototype._next=function(b){var a=this.predicate,c=this.thisArg,f=this.index++;try{a.call(c||this,b,f,this.source)&&this.notifyComplete(this.yieldIndex?f:b)}catch(g){this.destination.error(g)}},a.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},a}(m),fe=function(){function c(){}return c.prototype.call=function(a,b){return b.subscribe(new ee(a))},c}(),ee=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}return h(a,c),a.prototype._next=function(b){},a}(m),he=function(){function c(){}return c.prototype.call=function(a,b){return b.subscribe(new ge(a))},c}(),ge=function(c){function a(b){return c.call(this,b)||this}return h(a,c),a.prototype.notifyComplete=function(b){var a=this.destination;a.next(b),a.complete()},a.prototype._next=function(b){this.notifyComplete(!1)},a.prototype._complete=function(){this.notifyComplete(!0)},a}(m),rc=function(){function c(a){if(this.total=a,this.total<0)throw new K}return c.prototype.call=function(a,b){return b.subscribe(new ie(a,this.total))},c}(),ie=function(c){function a(b,a){return(b=c.call(this,b)||this).total=a,b.ring=[],b.count=0,b}return h(a,c),a.prototype._next=function(b){var a=this.ring,c=this.total,f=this.count++;a.length<c?a.push(b):a[f%c]=b},a.prototype._complete=function(){var b=this.destination,a=this.count;if(0<a)for(var c=this.count>=this.total?this.total:this.count,f=this.ring,g=0;g<c;g++){var l=a++%c;b.next(f[l])}b.complete()},a}(m),ke=function(){function c(a){this.value=a}return c.prototype.call=function(a,b){return b.subscribe(new je(a,this.value))},c}(),je=function(c){function a(b,a){return(b=c.call(this,b)||this).value=a,b}return h(a,c),a.prototype._next=function(b){this.destination.next(this.value)},a}(m),me=function(){function c(){}return c.prototype.call=function(a,b){return b.subscribe(new le(a))},c}(),le=function(c){function a(b){return c.call(this,b)||this}return h(a,c),a.prototype._next=function(b){this.destination.next(w.createNext(b))},a.prototype._error=function(b){var a=this.destination;a.next(w.createError(b)),a.complete()},a.prototype._complete=function(){var b=this.destination;b.next(w.createComplete()),b.complete()},a}(m),sc=function(){function c(a,b,c){void 0===c&&(c=!1),this.accumulator=a,this.seed=b,this.hasSeed=c}return c.prototype.call=function(a,b){return b.subscribe(new ne(a,this.accumulator,this.seed,this.hasSeed))},c}(),ne=function(c){function a(b,a,e,f){return(b=c.call(this,b)||this).accumulator=a,b._seed=e,b.hasSeed=f,b.index=0,b}return h(a,c),Object.defineProperty(a.prototype,"seed",{get:function(){return this._seed},set:function(b){this.hasSeed=!0,this._seed=b},enumerable:!0,configurable:!0}),a.prototype._next=function(b){if(this.hasSeed)return this._tryNext(b);this.seed=b,this.destination.next(b)},a.prototype._tryNext=function(b){var c,a=this.index++;try{c=this.accumulator(this.seed,b,a)}catch(f){this.destination.error(f)}this.seed=c,this.destination.next(c)},a}(m),pe=function(){function c(a,b,c){this.accumulator=a,this.seed=b,this.concurrent=c}return c.prototype.call=function(a,b){return b.subscribe(new oe(a,this.accumulator,this.seed,this.concurrent))},c}(),oe=function(c){function a(b,a,e,f){return(b=c.call(this,b)||this).accumulator=a,b.acc=e,b.concurrent=f,b.hasValue=!1,b.hasCompleted=!1,b.buffer=[],b.active=0,b.index=0,b}return h(a,c),a.prototype._next=function(b){if(this.active<this.concurrent){var a=this.index++,c=this.destination,f=void 0;try{f=(0,this.accumulator)(this.acc,b,a)}catch(l){return c.error(l)}this.active++,this._innerSub(f,b,a)}else this.buffer.push(b)},a.prototype._innerSub=function(b,a,c){var d=new H(this,void 0,void 0);this.destination.add(d),p(this,b,a,c,d)},a.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},a.prototype.notifyNext=function(b,a,c,f,g){b=this.destination,this.acc=a,this.hasValue=!0,b.next(a)},a.prototype.notifyComplete=function(b){var a=this.buffer;this.destination.remove(b),this.active--,0<a.length?this._next(a.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},a}(q),tc=function(){function c(a,b){this.subjectFactory=a,this.selector=b}return c.prototype.call=function(a,b){var c=this.selector,e=this.subjectFactory();return(a=c(e).subscribe(a)).add(b.subscribe(e)),a},c}(),re=function(){function c(a){this.nextSources=a}return c.prototype.call=function(a,b){return b.subscribe(new qe(a,this.nextSources))},c}(),qe=function(c){function a(b,a){var d=c.call(this,b)||this;return d.destination=b,d.nextSources=a,d}return h(a,c),a.prototype.notifyError=function(b,a){this.subscribeToNextSource()},a.prototype.notifyComplete=function(b){this.subscribeToNextSource()},a.prototype._error=function(b){this.subscribeToNextSource(),this.unsubscribe()},a.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},a.prototype.subscribeToNextSource=function(){var b=this.nextSources.shift();if(b){var a=new H(this,void 0,void 0);this.destination.add(a),p(this,b,void 0,void 0,a)}else this.destination.complete()},a}(q),te=function(){function c(){}return c.prototype.call=function(a,b){return b.subscribe(new se(a))},c}(),se=function(c){function a(b){return(b=c.call(this,b)||this).hasPrev=!1,b}return h(a,c),a.prototype._next=function(b){var a;this.hasPrev?a=[this.prev,b]:this.hasPrev=!0,this.prev=b,a&&this.destination.next(a)},a}(m),Fb=function(){function c(a,b){this.count=a,this.source=b}return c.prototype.call=function(a,b){return b.subscribe(new ue(a,this.count,this.source))},c}(),ue=function(c){function a(b,a,e){return(b=c.call(this,b)||this).count=a,b.source=e,b}return h(a,c),a.prototype.complete=function(){if(!this.isStopped){var b=this.source,a=this.count;if(0===a)return c.prototype.complete.call(this);-1<a&&(this.count=a-1),b.subscribe(this._unsubscribeAndRecycle())}},a}(m),we=function(){function c(a){this.notifier=a}return c.prototype.call=function(a,b){return b.subscribe(new ve(a,this.notifier,b))},c}(),ve=function(c){function a(b,a,e){return(b=c.call(this,b)||this).notifier=a,b.source=e,b.sourceIsBeingSubscribedTo=!0,b}return h(a,c),a.prototype.notifyNext=function(b,a,c,f,g){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},a.prototype.notifyComplete=function(b){if(!1===this.sourceIsBeingSubscribedTo)return c.prototype.complete.call(this)},a.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return c.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next()}},a.prototype._unsubscribe=function(){var b=this.notifications,a=this.retriesSubscription;b&&(b.unsubscribe(),this.notifications=null),a&&(a.unsubscribe(),this.retriesSubscription=null),this.retries=null},a.prototype._unsubscribeAndRecycle=function(){var b=this._unsubscribe;return this._unsubscribe=null,c.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=b,this},a.prototype.subscribeToRetries=function(){var b;this.notifications=new v;try{b=(0,this.notifier)(this.notifications)}catch(e){return c.prototype.complete.call(this)}this.retries=b,this.retriesSubscription=p(this,b)},a}(q),ye=function(){function c(a,b){this.count=a,this.source=b}return c.prototype.call=function(a,b){return b.subscribe(new xe(a,this.count,this.source))},c}(),xe=function(c){function a(b,a,e){return(b=c.call(this,b)||this).count=a,b.source=e,b}return h(a,c),a.prototype.error=function(b){if(!this.isStopped){var a=this.source,e=this.count;if(0===e)return c.prototype.error.call(this,b);-1<e&&(this.count=e-1),a.subscribe(this._unsubscribeAndRecycle())}},a}(m),Ae=function(){function c(a,b){this.notifier=a,this.source=b}return c.prototype.call=function(a,b){return b.subscribe(new ze(a,this.notifier,this.source))},c}(),ze=function(c){function a(b,a,e){return(b=c.call(this,b)||this).notifier=a,b.source=e,b}return h(a,c),a.prototype.error=function(b){if(!this.isStopped){var a=this.errors,e=this.retries,f=this.retriesSubscription;if(e)this.retriesSubscription=this.errors=null;else{a=new v;try{e=(0,this.notifier)(a)}catch(l){return c.prototype.error.call(this,l)}f=p(this,e)}this._unsubscribeAndRecycle(),this.errors=a,this.retries=e,this.retriesSubscription=f,a.next(b)}},a.prototype._unsubscribe=function(){var b=this.errors,a=this.retriesSubscription;b&&(b.unsubscribe(),this.errors=null),a&&(a.unsubscribe(),this.retriesSubscription=null),this.retries=null},a.prototype.notifyNext=function(b,a,c,f,g){b=this._unsubscribe,this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=b,this.source.subscribe(this)},a}(q),Ce=function(){function c(a){this.notifier=a}return c.prototype.call=function(a,b){return a=new Be(a),(b=b.subscribe(a)).add(p(a,this.notifier)),b},c}(),Be=function(c){function a(){var b=null!==c&&c.apply(this,arguments)||this;return b.hasValue=!1,b}return h(a,c),a.prototype._next=function(b){this.value=b,this.hasValue=!0},a.prototype.notifyNext=function(b,a,c,f,g){this.emitValue()},a.prototype.notifyComplete=function(){this.emitValue()},a.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},a}(q),Ee=function(){function c(a,b){this.period=a,this.scheduler=b}return c.prototype.call=function(a,b){return b.subscribe(new De(a,this.period,this.scheduler))},c}(),De=function(c){function a(b,a,e){return(b=c.call(this,b)||this).period=a,b.scheduler=e,b.hasValue=!1,b.add(e.schedule(wc,a,{subscriber:b,period:a})),b}return h(a,c),a.prototype._next=function(b){this.lastValue=b,this.hasValue=!0},a.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},a}(m),Ge=function(){function c(a,b){this.compareTo=a,this.comparator=b}return c.prototype.call=function(a,b){return b.subscribe(new Fe(a,this.compareTo,this.comparator))},c}(),Fe=function(c){function a(b,a,e){var d=c.call(this,b)||this;return d.compareTo=a,d.comparator=e,d._a=[],d._b=[],d._oneComplete=!1,d.destination.add(a.subscribe(new He(b,d))),d}return h(a,c),a.prototype._next=function(b){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(b),this.checkValues())},a.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},a.prototype.checkValues=function(){for(var b=this._a,a=this._b,c=this.comparator;0<b.length&&0<a.length;){var f=b.shift(),g=a.shift(),l=!1;try{l=c?c(f,g):f===g}catch(u){this.destination.error(u)}l||this.emit(!1)}},a.prototype.emit=function(b){var a=this.destination;a.next(b),a.complete()},a.prototype.nextB=function(b){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(b),this.checkValues())},a.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},a}(m),He=function(c){function a(b,a){return(b=c.call(this,b)||this).parent=a,b}return h(a,c),a.prototype._next=function(b){this.parent.nextB(b)},a.prototype._error=function(b){this.parent.error(b),this.unsubscribe()},a.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},a}(m),Je=function(){function c(a,b){this.predicate=a,this.source=b}return c.prototype.call=function(a,b){return b.subscribe(new Ie(a,this.predicate,this.source))},c}(),Ie=function(c){function a(b,a,e){return(b=c.call(this,b)||this).predicate=a,b.source=e,b.seenValue=!1,b.index=0,b}return h(a,c),a.prototype.applySingleValue=function(b){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=b)},a.prototype._next=function(b){var a=this.index++;this.predicate?this.tryNext(b,a):this.applySingleValue(b)},a.prototype.tryNext=function(b,a){try{this.predicate(b,a,this.source)&&this.applySingleValue(b)}catch(e){this.destination.error(e)}},a.prototype._complete=function(){var b=this.destination;0<this.index?(b.next(this.seenValue?this.singleValue:void 0),b.complete()):b.error(new ca)},a}(m),Le=function(){function c(a){this.total=a}return c.prototype.call=function(a,b){return b.subscribe(new Ke(a,this.total))},c}(),Ke=function(c){function a(b,a){return(b=c.call(this,b)||this).total=a,b.count=0,b}return h(a,c),a.prototype._next=function(b){++this.count>this.total&&this.destination.next(b)},a}(m),Ne=function(){function c(a){if(this._skipCount=a,this._skipCount<0)throw new K}return c.prototype.call=function(a,b){return 0===this._skipCount?b.subscribe(new m(a)):b.subscribe(new Me(a,this._skipCount))},c}(),Me=function(c){function a(b,a){return(b=c.call(this,b)||this)._skipCount=a,b._count=0,b._ring=Array(a),b}return h(a,c),a.prototype._next=function(b){var a=this._skipCount;if((c=this._count++)<a)this._ring[c]=b;else{a=c%a;var c,f=(c=this._ring)[a];c[a]=b,this.destination.next(f)}},a}(m),Pe=function(){function c(a){this.notifier=a}return c.prototype.call=function(a,b){return b.subscribe(new Oe(a,this.notifier))},c}(),Oe=function(c){function a(b,a){(b=c.call(this,b)||this).hasValue=!1;var d=new H(b,void 0,void 0);return b.add(d),b.innerSubscription=d,p(b,a,void 0,void 0,d),b}return h(a,c),a.prototype._next=function(a){this.hasValue&&c.prototype._next.call(this,a)},a.prototype.notifyNext=function(a,c,e,f,g){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},a.prototype.notifyComplete=function(){},a}(q),Re=function(){function c(a){this.predicate=a}return c.prototype.call=function(a,b){return b.subscribe(new Qe(a,this.predicate))},c}(),Qe=function(c){function a(a,d){return(a=c.call(this,a)||this).predicate=d,a.skipping=!0,a.index=0,a}return h(a,c),a.prototype._next=function(a){var b=this.destination;this.skipping&&this.tryCallPredicate(a),this.skipping||b.next(a)},a.prototype.tryCallPredicate=function(a){try{this.skipping=!!this.predicate(a,this.index++)}catch(d){this.destination.error(d)}},a}(m),Se=function(c){function a(a,d,e){void 0===d&&(d=0),void 0===e&&(e=qa);var b=c.call(this)||this;return b.source=a,b.delayTime=d,b.scheduler=e,(!W(d)||d<0)&&(b.delayTime=0),e&&"function"==typeof e.schedule||(b.scheduler=qa),b}return h(a,c),a.create=function(b,c,e){return void 0===c&&(c=0),void 0===e&&(e=qa),new a(b,c,e)},a.dispatch=function(a){return this.add(a.source.subscribe(a.subscriber))},a.prototype._subscribe=function(b){return this.scheduler.schedule(a.dispatch,this.delayTime,{source:this.source,subscriber:b})},a}(n),Te=function(){function c(a,b){this.scheduler=a,this.delay=b}return c.prototype.call=function(a,b){return new Se(b,this.delay,this.scheduler).subscribe(a)},c}(),zc=function(){function c(a){this.project=a}return c.prototype.call=function(a,b){return b.subscribe(new Ue(a,this.project))},c}(),Ue=function(c){function a(a,d){return(a=c.call(this,a)||this).project=d,a.index=0,a}return h(a,c),a.prototype._next=function(a){var b,c=this.index++;try{b=this.project(a,c)}catch(f){return void this.destination.error(f)}this._innerSub(b,a,c)},a.prototype._innerSub=function(a,c,e){var b=this.innerSubscription;b&&b.unsubscribe(),b=new H(this,void 0,void 0),this.destination.add(b),this.innerSubscription=p(this,a,c,e,b)},a.prototype._complete=function(){var a=this.innerSubscription;a&&!a.closed||c.prototype._complete.call(this),this.unsubscribe()},a.prototype._unsubscribe=function(){this.innerSubscription=null},a.prototype.notifyComplete=function(a){this.destination.remove(a),this.innerSubscription=null,this.isStopped&&c.prototype._complete.call(this)},a.prototype.notifyNext=function(a,c,e,f,g){this.destination.next(c)},a}(q),We=function(){function c(a){this.notifier=a}return c.prototype.call=function(a,b){var c=p(a=new Ve(a),this.notifier);return c&&!a.seenValue?(a.add(c),b.subscribe(a)):a},c}(),Ve=function(c){function a(a){return(a=c.call(this,a)||this).seenValue=!1,a}return h(a,c),a.prototype.notifyNext=function(a,c,e,f,g){this.seenValue=!0,this.complete()},a.prototype.notifyComplete=function(){},a}(q),Ye=function(){function c(a,b){this.predicate=a,this.inclusive=b}return c.prototype.call=function(a,b){return b.subscribe(new Xe(a,this.predicate,this.inclusive))},c}(),Xe=function(c){function a(a,d,e){return(a=c.call(this,a)||this).predicate=d,a.inclusive=e,a.index=0,a}return h(a,c),a.prototype._next=function(a){var c,b=this.destination;try{c=this.predicate(a,this.index++)}catch(f){return void b.error(f)}this.nextOrComplete(a,c)},a.prototype.nextOrComplete=function(a,c){var b=this.destination;c?b.next(a):(this.inclusive&&b.next(a),b.complete())},a}(m),$e=function(){function c(a,b,c){this.nextOrObserver=a,this.error=b,this.complete=c}return c.prototype.call=function(a,b){return b.subscribe(new Ze(a,this.nextOrObserver,this.error,this.complete))},c}(),Ze=function(c){function a(a,d,e,f){return(a=c.call(this,a)||this)._tapNext=D,a._tapError=D,a._tapComplete=D,a._tapError=e||D,a._tapComplete=f||D,Q(d)?(a._context=a)._tapNext=d:d&&(a._context=d,a._tapNext=d.next||D,a._tapError=d.error||D,a._tapComplete=d.complete||D),a}return h(a,c),a.prototype._next=function(a){try{this._tapNext.call(this._context,a)}catch(d){return void this.destination.error(d)}this.destination.next(a)},a.prototype._error=function(a){try{this._tapError.call(this._context,a)}catch(d){return void this.destination.error(d)}this.destination.error(a)},a.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(b){return void this.destination.error(b)}return this.destination.complete()},a}(m),Gb={leading:!0,trailing:!1},bf=function(){function c(a,b,c){this.durationSelector=a,this.leading=b,this.trailing=c}return c.prototype.call=function(a,b){return b.subscribe(new af(a,this.durationSelector,this.leading,this.trailing))},c}(),af=function(c){function a(a,d,e,f){var b=c.call(this,a)||this;return b.destination=a,b.durationSelector=d,b._leading=e,b._trailing=f,b._hasValue=!1,b}return h(a,c),a.prototype._next=function(a){this._hasValue=!0,this._sendValue=a,this._throttled||(this._leading?this.send():this.throttle(a))},a.prototype.send=function(){var a=this._sendValue;this._hasValue&&(this.destination.next(a),this.throttle(a)),this._hasValue=!1,this._sendValue=null},a.prototype.throttle=function(a){(a=this.tryDurationSelector(a))&&this.add(this._throttled=p(this,a))},a.prototype.tryDurationSelector=function(a){try{return this.durationSelector(a)}catch(d){return this.destination.error(d),null}},a.prototype.throttlingDone=function(){var a=this._throttled,c=this._trailing;a&&a.unsubscribe(),this._throttled=null,c&&this.send()},a.prototype.notifyNext=function(a,c,e,f,g){this.throttlingDone()},a.prototype.notifyComplete=function(){this.throttlingDone()},a}(q),df=function(){function c(a,b,c,e){this.duration=a,this.scheduler=b,this.leading=c,this.trailing=e}return c.prototype.call=function(a,b){return b.subscribe(new cf(a,this.duration,this.scheduler,this.leading,this.trailing))},c}(),cf=function(c){function a(a,d,e,f,g){return(a=c.call(this,a)||this).duration=d,a.scheduler=e,a.leading=f,a.trailing=g,a._hasTrailingValue=!1,a._trailingValue=null,a}return h(a,c),a.prototype._next=function(a){this.throttled?this.trailing&&(this._trailingValue=a,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Ac,this.duration,{subscriber:this})),this.leading?this.destination.next(a):this.trailing&&(this._trailingValue=a,this._hasTrailingValue=!0))},a.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},a.prototype.clearThrottle=function(){var a=this.throttled;a&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),a.unsubscribe(),this.remove(a),this.throttled=null)},a}(m),ef=function(c,a){this.value=c,this.interval=a},Bc=function(){function c(a,b,c,e){this.waitFor=a,this.absoluteTimeout=b,this.withObservable=c,this.scheduler=e}return c.prototype.call=function(a,b){return b.subscribe(new ff(a,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},c}(),ff=function(c){function a(a,d,e,f,g){return(a=c.call(this,a)||this).absoluteTimeout=d,a.waitFor=e,a.withObservable=f,a.scheduler=g,a.action=null,a.scheduleTimeout(),a}return h(a,c),a.dispatchTimeout=function(a){var b=a.withObservable;a._unsubscribeAndRecycle(),a.add(p(a,b))},a.prototype.scheduleTimeout=function(){var b=this.action;b?this.action=b.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(a.dispatchTimeout,this.waitFor,this))},a.prototype._next=function(a){this.absoluteTimeout||this.scheduleTimeout(),c.prototype._next.call(this,a)},a.prototype._unsubscribe=function(){this.withObservable=this.scheduler=this.action=null},a}(q),gf=function(c,a){this.value=c,this.timestamp=a},jf=function(){function c(a){this.windowBoundaries=a}return c.prototype.call=function(a,b){return a=new hf(a),(b=b.subscribe(a)).closed||a.add(p(a,this.windowBoundaries)),b},c}(),hf=function(c){function a(a){var b=c.call(this,a)||this;return b.window=new v,a.next(b.window),b}return h(a,c),a.prototype.notifyNext=function(a,c,e,f,g){this.openWindow()},a.prototype.notifyError=function(a,c){this._error(a)},a.prototype.notifyComplete=function(a){this._complete()},a.prototype._next=function(a){this.window.next(a)},a.prototype._error=function(a){this.window.error(a),this.destination.error(a)},a.prototype._complete=function(){this.window.complete(),this.destination.complete()},a.prototype._unsubscribe=function(){this.window=null},a.prototype.openWindow=function(){(a=this.window)&&a.complete();var a=this.destination,c=this.window=new v;a.next(c)},a}(q),lf=function(){function c(a,b){this.windowSize=a,this.startWindowEvery=b}return c.prototype.call=function(a,b){return b.subscribe(new kf(a,this.windowSize,this.startWindowEvery))},c}(),kf=function(c){function a(a,d,e){var b=c.call(this,a)||this;return b.destination=a,b.windowSize=d,b.startWindowEvery=e,b.windows=[new v],b.count=0,a.next(b.windows[0]),b}return h(a,c),a.prototype._next=function(a){for(var b=0<this.startWindowEvery?this.startWindowEvery:this.windowSize,c=this.destination,f=this.windowSize,g=this.windows,l=g.length,h=0;h<l&&!this.closed;h++)g[h].next(a);0<=(a=this.count-f+1)&&0==a%b&&!this.closed&&g.shift().complete(),0!=++this.count%b||this.closed||(b=new v,g.push(b),c.next(b))},a.prototype._error=function(a){var b=this.windows;if(b)for(;0<b.length&&!this.closed;)b.shift().error(a);this.destination.error(a)},a.prototype._complete=function(){var a=this.windows;if(a)for(;0<a.length&&!this.closed;)a.shift().complete();this.destination.complete()},a.prototype._unsubscribe=function(){this.count=0,this.windows=null},a}(m),nf=function(){function c(a,b,c,e){this.windowTimeSpan=a,this.windowCreationInterval=b,this.maxWindowSize=c,this.scheduler=e}return c.prototype.call=function(a,b){return b.subscribe(new mf(a,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},c}(),of=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;return a._numberOfNextedValues=0,a}return h(a,c),a.prototype.next=function(a){this._numberOfNextedValues++,c.prototype.next.call(this,a)},Object.defineProperty(a.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),a}(v),mf=function(c){function a(a,d,e,f,g){var b=c.call(this,a)||this;return b.destination=a,b.windowTimeSpan=d,b.windowCreationInterval=e,b.maxWindowSize=f,b.scheduler=g,b.windows=[],a=b.openWindow(),null!==e&&0<=e?(f={windowTimeSpan:d,windowCreationInterval:e,subscriber:b,scheduler:g},b.add(g.schedule(ob,d,{subscriber:b,window:a,context:null})),b.add(g.schedule(Ec,e,f))):b.add(g.schedule(Dc,d,{subscriber:b,window:a,windowTimeSpan:d})),b}return h(a,c),a.prototype._next=function(a){for(var b=this.windows,c=b.length,f=0;f<c;f++){var g=b[f];g.closed||(g.next(a),g.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(g))}},a.prototype._error=function(a){for(var b=this.windows;0<b.length;)b.shift().error(a);this.destination.error(a)},a.prototype._complete=function(){for(var a=this.windows;0<a.length;){var c=a.shift();c.closed||c.complete()}this.destination.complete()},a.prototype.openWindow=function(){var a=new of;return this.windows.push(a),this.destination.next(a),a},a.prototype.closeWindow=function(a){a.complete();var b=this.windows;b.splice(b.indexOf(a),1)},a}(m),qf=function(){function c(a,b){this.openings=a,this.closingSelector=b}return c.prototype.call=function(a,b){return b.subscribe(new pf(a,this.openings,this.closingSelector))},c}(),pf=function(c){function a(a,d,e){return(a=c.call(this,a)||this).openings=d,a.closingSelector=e,a.contexts=[],a.add(a.openSubscription=p(a,d,d)),a}return h(a,c),a.prototype._next=function(a){var b=this.contexts;if(b)for(var c=b.length,f=0;f<c;f++)b[f].window.next(a)},a.prototype._error=function(a){var b=this.contexts;if(this.contexts=null,b)for(var e=b.length,f=-1;++f<e;){var g=b[f];g.window.error(a),g.subscription.unsubscribe()}c.prototype._error.call(this,a)},a.prototype._complete=function(){var a=this.contexts;if(this.contexts=null,a)for(var d=a.length,e=-1;++e<d;){var f=a[e];f.window.complete(),f.subscription.unsubscribe()}c.prototype._complete.call(this)},a.prototype._unsubscribe=function(){var a=this.contexts;if(this.contexts=null,a)for(var c=a.length,e=-1;++e<c;){var f=a[e];f.window.unsubscribe(),f.subscription.unsubscribe()}},a.prototype.notifyNext=function(a,c,e,f,g){if(a===this.openings){a=void 0;try{var b=this.closingSelector;a=b(c)}catch(u){return this.error(u)}e={window:c=new v,subscription:b=new t},this.contexts.push(e),(a=p(this,a,e)).closed?this.closeWindow(this.contexts.length-1):(a.context=e,b.add(a)),this.destination.next(c)}else this.closeWindow(this.contexts.indexOf(a))},a.prototype.notifyError=function(a){this.error(a)},a.prototype.notifyComplete=function(a){a!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(a.context))},a.prototype.closeWindow=function(a){if(-1!==a){var b=this.contexts,f=(c=b[a]).window,c=c.subscription;b.splice(a,1),f.complete(),c.unsubscribe()}},a}(q),sf=function(){function c(a){this.closingSelector=a}return c.prototype.call=function(a,b){return b.subscribe(new rf(a,this.closingSelector))},c}(),rf=function(c){function a(a,d){var b=c.call(this,a)||this;return b.destination=a,b.closingSelector=d,b.openWindow(),b}return h(a,c),a.prototype.notifyNext=function(a,c,e,f,g){this.openWindow(g)},a.prototype.notifyError=function(a,c){this._error(a)},a.prototype.notifyComplete=function(a){this.openWindow(a)},a.prototype._next=function(a){this.window.next(a)},a.prototype._error=function(a){this.window.error(a),this.destination.error(a),this.unsubscribeClosingNotification()},a.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},a.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},a.prototype.openWindow=function(a){var b;void 0===a&&(a=null),a&&(this.remove(a),a.unsubscribe()),(a=this.window)&&a.complete(),a=this.window=new v,this.destination.next(a);try{b=(0,this.closingSelector)()}catch(f){return this.destination.error(f),void this.window.error(f)}this.add(this.closingNotification=p(this,b))},a}(q),uf=function(){function c(a,b){this.observables=a,this.project=b}return c.prototype.call=function(a,b){return b.subscribe(new tf(a,this.observables,this.project))},c}(),tf=function(c){function a(a,d,e){(a=c.call(this,a)||this).observables=d,a.project=e,a.toRespond=[],e=d.length,a.values=Array(e);for(var b=0;b<e;b++)a.toRespond.push(b);for(b=0;b<e;b++){var g=d[b];a.add(p(a,g,g,b))}return a}return h(a,c),a.prototype.notifyNext=function(a,c,e,f,g){this.values[e]=c,0<(a=this.toRespond).length&&(-1!==(e=a.indexOf(e))&&a.splice(e,1))},a.prototype.notifyComplete=function(){},a.prototype._next=function(a){0===this.toRespond.length&&(a=[a].concat(this.values),this.project?this._tryProject(a):this.destination.next(a))},a.prototype._tryProject=function(a){var b;try{b=this.project.apply(this,a)}catch(e){return void this.destination.error(e)}this.destination.next(b)},a}(q),vf=Object.freeze({audit:hb,auditTime:function(c,a){return void 0===a&&(a=y),hb(function(){return eb(c,a)})},buffer:function(c){return function(a){return a.lift(new od(c))}},bufferCount:function(c,a){return void 0===a&&(a=null),function(b){return b.lift(new rd(c,a))}},bufferTime:function(c){var a=arguments.length,b=y;A(arguments[arguments.length-1])&&(b=arguments[arguments.length-1],a--);var d=null;2<=a&&(d=arguments[1]);var e=Number.POSITIVE_INFINITY;return 3<=a&&(e=arguments[2]),function(a){return a.lift(new td(c,d,e,b))}},bufferToggle:function(c,a){return function(b){return b.lift(new wd(c,a))}},bufferWhen:function(c){return function(a){return a.lift(new yd(c))}},catchError:function(c){return function(a){var b=new Ad(c);return a=a.lift(b),b.caught=a}},combineAll:function(c){return function(a){return a.lift(new Ja(c))}},combineLatest:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];var b=null;return"function"==typeof c[c.length-1]&&(b=c.pop()),1===c.length&&x(c[0])&&(c=c[0].slice()),function(a){return a.lift.call(G([a].concat(c)),new Ja(b))}},concat:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return function(a){return a.lift.call(aa.apply(void 0,[a].concat(c)))}},concatAll:Ya,concatMap:kb,concatMapTo:function(c,a){return kb(function(){return c},a)},count:function(c){return function(a){return a.lift(new Cd(c,a))}},debounce:function(c){return function(a){return a.lift(new Ed(c))}},debounceTime:function(c,a){return void 0===a&&(a=y),function(b){return b.lift(new Gd(c,a))}},defaultIfEmpty:ba,delay:function(c,a){void 0===a&&(a=y);var b=c instanceof Date&&!isNaN(+c)?+c-a.now():Math.abs(c);return function(c){return c.lift(new Jd(b,a))}},delayWhen:function(c,a){return a?function(b){return new Nd(b,a).lift(new Db(c))}:function(a){return a.lift(new Db(c))}},dematerialize:function(){return function(c){return c.lift(new Pd)}},distinct:function(c,a){return function(b){return b.lift(new Rd(c,a))}},distinctUntilChanged:lb,distinctUntilKeyChanged:function(c,a){return lb(function(b,d){return a?a(b[c],d[c]):b[c]===d[c]})},elementAt:function(c,a){if(c<0)throw new K;var b=2<=arguments.length;return function(d){return d.pipe(I(function(a,b){return b===c}),Ca(1),b?ba(a):ka(function(){return new K}))}},endWith:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return function(a){return aa(a,ha.apply(void 0,c))}},every:function(c,a){return function(b){return b.lift(new Wd(c,a,b))}},exhaust:function(){return function(c){return c.lift(new Yd)}},exhaustMap:function mb(c,a){return a?function(b){return b.pipe(mb(function(b,e){return G(c(b,e)).pipe(B(function(c,d){return a(b,c,e,d)}))}))}:function(b){return b.lift(new qc(c))}},expand:function(c,a,b){return void 0===a&&(a=Number.POSITIVE_INFINITY),void 0===b&&(b=void 0),a=(a||0)<1?Number.POSITIVE_INFINITY:a,function(d){return d.lift(new ae(c,a,b))}},filter:I,finalize:function(c){return function(a){return a.lift(new ce(c))}},find:function(c,a){if("function"!=typeof c)throw new TypeError("predicate is not a function");return function(b){return b.lift(new Eb(c,b,!1,a))}},findIndex:function(c,a){return function(b){return b.lift(new Eb(c,b,!0,a))}},first:function(c,a){var b=2<=arguments.length;return function(d){return d.pipe(c?I(function(a,b){return c(a,b,d)}):J,Ca(1),b?ba(a):ka(function(){return new ca}))}},groupBy:function(c,a,b,d){return function(e){return e.lift(new Qc(c,a,b,d))}},ignoreElements:function(){return function(c){return c.lift(new fe)}},isEmpty:function(){return function(c){return c.lift(new he)}},last:function(c,a){var b=2<=arguments.length;return function(d){return d.pipe(c?I(function(a,b){return c(a,b,d)}):J,la(1),b?ba(a):ka(function(){return new ca}))}},map:B,mapTo:function(c){return function(a){return a.lift(new ke(c))}},materialize:function(){return function(c){return c.lift(new me)}},max:function(c){return na("function"==typeof c?function(a,b){return 0<c(a,b)?a:b}:function(a,b){return b<a?a:b})},merge:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return function(a){return a.lift.call(bb.apply(void 0,[a].concat(c)))}},mergeAll:za,mergeMap:M,flatMap:M,mergeMapTo:function(c,a,b){return void 0===b&&(b=Number.POSITIVE_INFINITY),"function"==typeof a?M(function(){return c},a,b):("number"==typeof a&&(b=a),M(function(){return c},b))},mergeScan:function(c,a,b){return void 0===b&&(b=Number.POSITIVE_INFINITY),function(d){return d.lift(new pe(c,a,b))}},min:function(c){return na("function"==typeof c?function(a,b){return c(a,b)<0?a:b}:function(a,b){return a<b?a:b})},multicast:N,observeOn:function(c,a){return void 0===a&&(a=0),function(b){return b.lift(new Uc(c,a))}},onErrorResumeNext:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return 1===c.length&&x(c[0])&&(c=c[0]),function(a){return a.lift(new re(c))}},pairwise:function(){return function(c){return c.lift(new te)}},partition:function(c,a){return function(b){return[I(c,a)(b),I(cb(c,a))(b)]}},pluck:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];var b=c.length;if(0===b)throw Error("list of properties cannot be empty.");return function(a){return B(function(c,a){return function(b){var d=b;for(b=0;b<a;b++)if(void 0===(d=d[c[b]]))return;return d}}(c,b))(a)}},publish:function(c){return c?N(function(){return new v},c):N(new v)},publishBehavior:function(c){return function(a){return N(new wb(c))(a)}},publishLast:function(){return function(c){return N(new U)(c)}},publishReplay:function(c,a,b,d){b&&"function"!=typeof b&&(d=b);var e="function"==typeof b?b:void 0,f=new X(c,a,d);return function(a){return N(function(){return f},e)(a)}},race:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return function(a){return 1===c.length&&x(c[0])&&(c=c[0]),a.lift.call(db.apply(void 0,[a].concat(c)))}},reduce:na,repeat:function(c){return void 0===c&&(c=-1),function(a){return 0===c?S():c<0?a.lift(new Fb(-1,a)):a.lift(new Fb(c-1,a))}},repeatWhen:function(c){return function(a){return a.lift(new we(c))}},retry:function(c){return void 0===c&&(c=-1),function(a){return a.lift(new ye(c,a))}},retryWhen:function(c){return function(a){return a.lift(new Ae(c,a))}},refCount:va,sample:function(c){return function(a){return a.lift(new Ce(c))}},sampleTime:function(c,a){return void 0===a&&(a=y),function(b){return b.lift(new Ee(c,a))}},scan:ma,sequenceEqual:function(c,a){return function(b){return b.lift(new Ge(c,a))}},share:function(){return function(c){return va()(N(xc)(c))}},shareReplay:function(c,a,b){var d;return d=c&&"object"==typeof c?c:{bufferSize:c,windowTime:a,refCount:!1,scheduler:b},function(a){return a.lift(function(c){var a,g,h,b=void 0===(a=c.bufferSize)?Number.POSITIVE_INFINITY:a,d=void 0===(a=c.windowTime)?Number.POSITIVE_INFINITY:a,e=c.refCount,f=c.scheduler,l=0,k=!1,r=!1;return function(a){l++,g&&!k||(k=!1,g=new X(b,d,f),h=a.subscribe({next:function(b){g.next(b)},error:function(b){k=!0,g.error(b)},complete:function(){r=!0,g.complete()}}));var c=g.subscribe(this);this.add(function(){l--,c.unsubscribe(),h&&!r&&e&&0===l&&(h.unsubscribe(),g=h=void 0)})}}(d))}},single:function(c){return function(a){return a.lift(new Je(c,a))}},skip:function(c){return function(a){return a.lift(new Le(c))}},skipLast:function(c){return function(a){return a.lift(new Ne(c))}},skipUntil:function(c){return function(a){return a.lift(new Pe(c))}},skipWhile:function(c){return function(a){return a.lift(new Re(c))}},startWith:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];var b=c[c.length-1];return A(b)?(c.pop(),function(a){return aa(c,a,b)}):function(a){return aa(c,a)}},subscribeOn:function(c,a){return void 0===a&&(a=0),function(b){return b.lift(new Te(c,a))}},switchAll:function(){return da(J)},switchMap:da,switchMapTo:function(c,a){return a?da(function(){return c},a):da(function(){return c})},take:Ca,takeLast:la,takeUntil:function(c){return function(a){return a.lift(new We(c))}},takeWhile:function(c,a){return void 0===a&&(a=!1),function(b){return b.lift(new Ye(c,a))}},tap:function(c,a,b){return function(d){return d.lift(new $e(c,a,b))}},throttle:function(c,a){return void 0===a&&(a=Gb),function(b){return b.lift(new bf(c,a.leading,a.trailing))}},throttleTime:function(c,a,b){return void 0===a&&(a=y),void 0===b&&(b=Gb),function(d){return d.lift(new df(c,a,b.leading,b.trailing))}},throwIfEmpty:ka,timeInterval:function(c){return void 0===c&&(c=y),function(a){return Aa(function(){return a.pipe(ma(function(a,d){return a=a.current,{value:d,current:c.now(),last:a}},{current:c.now(),value:void 0,last:void 0}),B(function(a){return new ef(a.value,a.current-a.last)}))})}},timeout:function(c,a){return void 0===a&&(a=y),nb(c,xa(new ya),a)},timeoutWith:nb,timestamp:function(c){return void 0===c&&(c=y),B(function(a){return new gf(a,c.now())})},toArray:function(){return na(Cc,[])},window:function(c){return function(a){return a.lift(new jf(c))}},windowCount:function(c,a){return void 0===a&&(a=0),function(b){return b.lift(new lf(c,a))}},windowTime:function(c,a,b,d){var e=y,f=null,g=Number.POSITIVE_INFINITY;return A(d)&&(e=d),A(b)?e=b:W(b)&&(g=b),A(a)?e=a:W(a)&&(f=a),function(a){return a.lift(new nf(c,f,g,e))}},windowToggle:function(c,a){return function(b){return b.lift(new qf(c,a))}},windowWhen:function(c){return function(a){return a.lift(new sf(c))}},withLatestFrom:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return function(a){var b;return"function"==typeof c[c.length-1]&&(b=c.pop()),a.lift(new uf(c,b))}},zip:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];return function(a){return a.lift.call(fb.apply(void 0,[a].concat(c)))}},zipAll:function(c){return function(a){return a.lift(new gb(c))}}}),ga=function(c,a){void 0===a&&(a=Number.POSITIVE_INFINITY),this.subscribedFrame=c,this.unsubscribedFrame=a},Hb=function(){function c(){this.subscriptions=[]}return c.prototype.logSubscribedFrame=function(){return this.subscriptions.push(new ga(this.scheduler.now())),this.subscriptions.length-1},c.prototype.logUnsubscribedFrame=function(a){var b=this.subscriptions;b[a]=new ga(b[a].subscribedFrame,this.scheduler.now())},c}(),Ka=function(c){function a(a,d){var b=c.call(this,function(a){var b=this,c=b.logSubscribedFrame(),d=new t;return d.add(new t(function(){b.logUnsubscribedFrame(c)})),b.scheduleMessages(a),d})||this;return b.messages=a,b.subscriptions=[],b.scheduler=d,b}return h(a,c),a.prototype.scheduleMessages=function(a){for(var b=this.messages.length,c=0;c<b;c++){var f=this.messages[c];a.add(this.scheduler.schedule(function(a){a.message.notification.observe(a.subscriber)},f.frame,{message:f,subscriber:a}))}},a}(n);pb(Ka,[Hb]);var Ib=function(c){function a(a,d){var b=c.call(this)||this;return b.messages=a,b.subscriptions=[],b.scheduler=d,b}return h(a,c),a.prototype._subscribe=function(a){var b=this,e=b.logSubscribedFrame(),f=new t;return f.add(new t(function(){b.logUnsubscribedFrame(e)})),f.add(c.prototype._subscribe.call(this,a)),f},a.prototype.setup=function(){for(var a=this,c=a.messages.length,e=0;e<c;e++)!function(){var b=a.messages[e];a.scheduler.schedule(function(){b.notification.observe(a)},b.frame)}()},a}(v);pb(Ib,[Hb]);var xf=function(c){function a(a){var b=c.call(this,Ia,750)||this;return b.assertDeepEqual=a,b.hotObservables=[],b.coldObservables=[],b.flushTests=[],b.runMode=!1,b}return h(a,c),a.prototype.createTime=function(b){if(-1===(b=b.indexOf("|")))throw Error('marble diagram for time should have a completion marker "|"');return b*a.frameTimeFactor},a.prototype.createColdObservable=function(b,c,e){if(-1!==b.indexOf("^"))throw Error('cold observable cannot have subscription offset "^"');if(-1!==b.indexOf("!"))throw Error('cold observable cannot have unsubscription marker "!"');return b=a.parseMarbles(b,c,e,void 0,this.runMode),b=new Ka(b,this),this.coldObservables.push(b),b},a.prototype.createHotObservable=function(b,c,e){if(-1!==b.indexOf("!"))throw Error('hot observable cannot have unsubscription marker "!"');return b=a.parseMarbles(b,c,e,void 0,this.runMode),b=new Ib(b,this),this.hotObservables.push(b),b},a.prototype.materializeInnerObservable=function(a,c){var b=this,d=[];return a.subscribe(function(a){d.push({frame:b.frame-c,notification:w.createNext(a)})},function(a){d.push({frame:b.frame-c,notification:w.createError(a)})},function(){d.push({frame:b.frame-c,notification:w.createComplete()})}),d},a.prototype.expectObservable=function(b,c){var d=this;void 0===c&&(c=null);var k,f=[],g={actual:f,ready:!1},h=(c=a.parseMarblesAsSubscriptions(c,this.runMode)).unsubscribedFrame;this.schedule(function(){k=b.subscribe(function(a){var b=a;a instanceof n&&(b=d.materializeInnerObservable(b,d.frame)),f.push({frame:d.frame,notification:w.createNext(b)})},function(a){f.push({frame:d.frame,notification:w.createError(a)})},function(){f.push({frame:d.frame,notification:w.createComplete()})})},c.subscribedFrame===Number.POSITIVE_INFINITY?0:c.subscribedFrame),h!==Number.POSITIVE_INFINITY&&this.schedule(function(){return k.unsubscribe()},h),this.flushTests.push(g);var m=this.runMode;return{toBe:function(b,c,d){g.ready=!0,g.expected=a.parseMarbles(b,c,d,!0,m)}}},a.prototype.expectSubscriptions=function(b){var c={actual:b,ready:!1};this.flushTests.push(c);var e=this.runMode;return{toBe:function(b){b="string"==typeof b?[b]:b,c.ready=!0,c.expected=b.map(function(b){return a.parseMarblesAsSubscriptions(b,e)})}}},a.prototype.flush=function(){for(var a=this,d=this.hotObservables;0<d.length;)d.shift().setup();c.prototype.flush.call(this),this.flushTests=this.flushTests.filter(function(b){return!b.ready||(a.assertDeepEqual(b.actual,b.expected),!1)})},a.parseMarblesAsSubscriptions=function(a,c){var b=this;if(void 0===c&&(c=!1),"string"!=typeof a)return new ga(Number.POSITIVE_INFINITY);for(var p,d=a.length,g=-1,h=Number.POSITIVE_INFINITY,k=Number.POSITIVE_INFINITY,m=0,r=function(d){function f(a){e+=a*b.frameTimeFactor}var e=m;switch(l=a[d]){case" ":c||f(1);break;case"-":f(1);break;case"(":g=m,f(1);break;case")":g=-1,f(1);break;case"^":if(h!==Number.POSITIVE_INFINITY)throw Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");h=-1<g?g:m,f(1);break;case"!":if(k!==Number.POSITIVE_INFINITY)throw Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");k=-1<g?g:m;break;default:if(c&&l.match(/^[0-9]$/)&&(0===d||" "===a[d-1])){var r=a.slice(d).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(r){d+=r[0].length-1;var l=parseFloat(r[1]),u=void 0;switch(r[2]){case"ms":u=l;break;case"s":u=1e3*l;break;case"m":u=6e4*l}f(u/n.frameTimeFactor);break}}throw Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+l+"'.")}m=e,p=d},n=this,q=0;q<d;q++)r(q),q=p;return k<0?new ga(h):new ga(h,k)},a.parseMarbles=function(a,c,e,f,g){var b=this;if(void 0===f&&(f=!1),void 0===g&&(g=!1),-1!==a.indexOf("!"))throw Error('conventional marble diagrams cannot have the unsubscription marker "!"');for(var t,d=a.length,h=[],m=-1===(k=g?a.replace(/^[ ]+/,"").indexOf("^"):a.indexOf("^"))?0:k*-this.frameTimeFactor,n="object"!=typeof c?function(a){return a}:function(a){return f&&c[a]instanceof Ka?c[a].messages:c[a]},p=-1,k=function(c){function f(a){d+=a*b.frameTimeFactor}var d=m,l=void 0;switch(k=a[c]){case" ":g||f(1);break;case"-":f(1);break;case"(":p=m,f(1);break;case")":p=-1,f(1);break;case"|":l=w.createComplete(),f(1);break;case"^":f(1);break;case"#":l=w.createError(e||"error"),f(1);break;default:if(g&&k.match(/^[0-9]$/)&&(0===c||" "===a[c-1])){var u=a.slice(c).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(u){c+=u[0].length-1;var k=parseFloat(u[1]),r=void 0;switch(u[2]){case"ms":r=k;break;case"s":r=1e3*k;break;case"m":r=6e4*k}f(r/q.frameTimeFactor);break}}l=w.createNext(n(k)),f(1)}l&&h.push({frame:-1<p?p:m,notification:l}),m=d,t=c},q=this,v=0;v<d;v++)k(v),v=t;return h},a.prototype.run=function(b){var c=a.frameTimeFactor,e=this.maxFrames;a.frameTimeFactor=1,this.maxFrames=Number.POSITIVE_INFINITY,this.runMode=!0;var f={cold:(P.delegate=this).createColdObservable.bind(this),hot:this.createHotObservable.bind(this),flush:this.flush.bind(this),expectObservable:this.expectObservable.bind(this),expectSubscriptions:this.expectSubscriptions.bind(this)};try{var g=b(f);return this.flush(),g}finally{a.frameTimeFactor=c,this.maxFrames=e,this.runMode=!1,P.delegate=void 0}},a}(Ab),yf=Object.freeze({TestScheduler:xf}),zf="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Af="undefined"!=typeof global&&global,z="undefined"!=typeof window&&window||Af||zf;if(!z)throw Error("RxJS could not find any global context (window, self, global)");var Lc=B(function(c,a){return c.response}),O=function(c){function a(a){var b=c.call(this)||this,e={async:!0,createXHR:function(){var a;if(this.crossDomain)if(z.XMLHttpRequest)a=new z.XMLHttpRequest;else{if(!z.XDomainRequest)throw Error("CORS is not supported by your browser");a=new z.XDomainRequest}else if(z.XMLHttpRequest)a=new z.XMLHttpRequest;else{var b=void 0;try{for(var c=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],d=0;d<3;d++)try{b=c[d],new z.ActiveXObject(b);break}catch(r){}a=new z.ActiveXObject(b)}catch(r){throw Error("XMLHttpRequest is not supported by your browser")}}return a},crossDomain:!0,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof a)e.url=a;else for(var f in a)a.hasOwnProperty(f)&&(e[f]=a[f]);return b.request=e,b}var b;return h(a,c),a.prototype._subscribe=function(a){return new Bf(a,this.request)},a.create=((b=function(b){return new a(b)}).get=Fc,b.post=Gc,b.delete=Hc,b.put=Ic,b.patch=Jc,b.getJSON=Kc,b),a}(n),Bf=function(c){function a(a,d){(a=c.call(this,a)||this).request=d,a.done=!1;var b=d.headers=d.headers||{};return d.crossDomain||a.getHeader(b,"X-Requested-With")||(b["X-Requested-With"]="XMLHttpRequest"),a.getHeader(b,"Content-Type")||z.FormData&&d.body instanceof z.FormData||void 0===d.body||(b["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),d.body=a.serializeBody(d.body,a.getHeader(d.headers,"Content-Type")),a.send(),a}return h(a,c),a.prototype.next=function(a){this.done=!0;var g,b=this.xhr,c=this.request,f=this.destination;try{g=new Jb(a,b,c)}catch(l){return f.error(l)}f.next(g)},a.prototype.send=function(){var a=this.request,e=(c=this.request).user,f=c.method,g=c.url,h=c.async,k=c.password,m=c.headers,c=c.body;try{var r=this.xhr=a.createXHR();this.setupEvents(r,a),e?r.open(f,g,h,e,k):r.open(f,g,h),h&&(r.timeout=a.timeout,r.responseType=a.responseType),"withCredentials"in r&&(r.withCredentials=!!a.withCredentials),this.setHeaders(r,m),c?r.send(c):r.send()}catch(Zb){this.error(Zb)}},a.prototype.serializeBody=function(a,c){if(!a||"string"==typeof a||z.FormData&&a instanceof z.FormData)return a;if(c){var b=c.indexOf(";");-1!==b&&(c=c.substring(0,b))}switch(c){case"application/x-www-form-urlencoded":return Object.keys(a).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&");case"application/json":return JSON.stringify(a);default:return a}},a.prototype.setHeaders=function(a,c){for(var b in c)c.hasOwnProperty(b)&&a.setRequestHeader(b,c[b])},a.prototype.getHeader=function(a,c){for(var b in a)if(b.toLowerCase()===c.toLowerCase())return a[b]},a.prototype.setupEvents=function(a,c){function b(a){var f,c=b.subscriber,d=b.progressSubscriber,e=b.request;d&&d.error(a);try{f=new Kb(this,e)}catch(La){f=La}c.error(f)}function d(a){}function g(a){var b=g.subscriber,c=g.progressSubscriber,d=g.request;if(4===this.readyState){var e=1223===this.status?204:this.status,f="text"===this.responseType?this.response||this.responseText:this.response;if(0===e&&(e=f?200:0),e<400)c&&c.complete(),b.next(a),b.complete();else{c&&c.error(a),a=void 0;try{a=new ra("ajax error "+e,this,d)}catch(wf){a=wf}b.error(a)}}}var h=c.progressSubscriber;if((a.ontimeout=b).request=c,b.subscriber=this,b.progressSubscriber=h,a.upload&&"withCredentials"in a){var k,m;if(h)k=function(a){k.progressSubscriber.next(a)},z.XDomainRequest?a.onprogress=k:a.upload.onprogress=k,k.progressSubscriber=h;m=function(a){var e,b=m.progressSubscriber,c=m.subscriber,d=m.request;b&&b.error(a);try{e=new ra("ajax error",this,d)}catch(La){e=La}c.error(e)},(a.onerror=m).request=c,m.subscriber=this,m.progressSubscriber=h}(a.onreadystatechange=d).subscriber=this,d.progressSubscriber=h,d.request=c,(a.onload=g).subscriber=this,g.progressSubscriber=h,g.request=c},a.prototype.unsubscribe=function(){var a=this.xhr;!this.done&&a&&4!==a.readyState&&"function"==typeof a.abort&&a.abort(),c.prototype.unsubscribe.call(this)},a}(m),Jb=function(c,a,b){this.originalEvent=c,this.xhr=a,this.request=b,this.status=a.status,this.responseType=a.responseType||b.responseType,this.response=rb(this.responseType,a)};qb.prototype=Object.create(Error.prototype);var ra=qb,Kb=function(c,a){return ra.call(this,"ajax timeout",c,a),this.name="AjaxTimeoutError",this},Cf=Object.freeze({ajax:O.create,AjaxResponse:Jb,AjaxError:ra,AjaxTimeoutError:Kb}),Df={url:"",deserializer:function(c){return JSON.parse(c.data)},serializer:function(c){return JSON.stringify(c)}},Lb=function(c){function a(a,d){var b=c.call(this)||this;if(a instanceof n)b.destination=d,b.source=a;else{if(d=b._config=Mc({},Df),b._output=new v,"string"==typeof a)d.url=a;else for(var f in a)a.hasOwnProperty(f)&&(d[f]=a[f]);if(!d.WebSocketCtor&&WebSocket)d.WebSocketCtor=WebSocket;else if(!d.WebSocketCtor)throw Error("no WebSocket constructor can be found");b.destination=new X}return b}return h(a,c),a.prototype.lift=function(b){var c=new a(this._config,this.destination);return c.operator=b,c.source=this,c},a.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new X),this._output=new v},a.prototype.multiplex=function(a,c,e){var b=this;return new n(function(d){try{b.next(a())}catch(u){d.error(u)}var f=b.subscribe(function(a){try{e(a)&&d.next(a)}catch(L){d.error(L)}},function(a){return d.error(a)},function(){return d.complete()});return function(){try{b.next(c())}catch(u){d.error(u)}f.unsubscribe()}})},a.prototype._connectSocket=function(){var a=this,e=(c=this._config).WebSocketCtor,f=c.protocol,g=c.url,c=c.binaryType,h=this._output,k=null;try{this._socket=k=f?new e(g,f):new e(g),c&&(this._socket.binaryType=c)}catch(r){return void h.error(r)}var n=new t(function(){a._socket=null,k&&1===k.readyState&&k.close()});k.onopen=function(b){if(a._socket){var c=a._config.openObserver;c&&c.next(b),b=a.destination,a.destination=m.create(function(b){if(1===k.readyState)try{var c=a._config.serializer;k.send(c(b))}catch(ac){a.destination.error(ac)}},function(b){var c=a._config.closingObserver;c&&c.next(void 0),b&&b.code?k.close(b.code,b.reason):h.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),a._resetState()},function(){var b=a._config.closingObserver;b&&b.next(void 0),k.close(),a._resetState()}),b&&b instanceof X&&n.add(b.subscribe(a.destination))}else k.close(),a._resetState()},k.onerror=function(b){a._resetState(),h.error(b)},k.onclose=function(b){a._resetState();var c=a._config.closeObserver;c&&c.next(b),b.wasClean?h.complete():h.error(b)},k.onmessage=function(b){try{var c=a._config.deserializer;h.next(c(b))}catch($b){h.error($b)}}},a.prototype._subscribe=function(a){var b=this,c=this.source;return c?c.subscribe(a):(this._socket||this._connectSocket(),this._output.subscribe(a),a.add(function(){var a=b._socket;0===b._output.observers.length&&(a&&1===a.readyState&&a.close(),b._resetState())}),a)},a.prototype.unsubscribe=function(){var a=this._socket;a&&1===a.readyState&&a.close(),this._resetState(),c.prototype.unsubscribe.call(this)},a}(Ea),Ef=Object.freeze({webSocket:function(c){return new Lb(c)},WebSocketSubject:Lb}),Ff=Object.freeze({fromFetch:function(c,a){return new n(function(b){var d=new AbortController,e=d.signal,f=!0,g=!1;return a?(a.signal&&a.signal.addEventListener("abort",function(){e.aborted||d.abort()}),a.signal=e):a={signal:e},fetch(c,a).then(function(a){f=!1,b.next(a),b.complete()}).catch(function(a){f=!1,g||b.error(a)}),function(){g=!0,f&&d.abort()}})}});k.operators=vf,k.testing=yf,k.ajax=Cf,k.webSocket=Ef,k.fetch=Ff,k.Observable=n,k.ConnectableObservable=vb,k.GroupedObservable=Fa,k.observable=V,k.Subject=v,k.BehaviorSubject=wb,k.ReplaySubject=X,k.AsyncSubject=U,k.asapScheduler=qa,k.asyncScheduler=y,k.queueScheduler=xb,k.animationFrameScheduler=$c,k.VirtualTimeScheduler=Ab,k.VirtualAction=Ia,k.Scheduler=Ga,k.Subscription=t,k.Subscriber=m,k.Notification=w,k.pipe=ua,k.noop=D,k.identity=J,k.isObservable=function(c){return!!c&&(c instanceof n||"function"==typeof c.lift&&"function"==typeof c.subscribe)},k.ArgumentOutOfRangeError=K,k.EmptyError=ca,k.ObjectUnsubscribedError=E,k.UnsubscriptionError=Y,k.TimeoutError=ya,k.bindCallback=function Sa(c,a,b){if(a){if(!A(a))return function(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];return Sa(c,b).apply(void 0,d).pipe(B(function(b){return x(b)?a.apply(void 0,b):a(b)}))};b=a}return function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];var g,f=this,l={context:f,subject:g,callbackFunc:c,scheduler:b};return new n(function(d){if(b)return b.schedule(Rb,0,{args:a,subscriber:d,params:l});if(!g){g=new U;try{c.apply(f,a.concat([function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];g.next(b.length<=1?b[0]:b),g.complete()}]))}catch(L){ta(g)?g.error(L):console.warn(L)}}return g.subscribe(d)})}},k.bindNodeCallback=function Ta(c,a,b){if(a){if(!A(a))return function(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];return Ta(c,b).apply(void 0,d).pipe(B(function(b){return x(b)?a.apply(void 0,b):a(b)}))};b=a}return function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];var f={subject:void 0,args:a,callbackFunc:c,scheduler:b,context:this};return new n(function(d){var e=f.context,g=f.subject;if(b)return b.schedule(Tb,0,{params:f,subscriber:d,context:e});if(!g){g=f.subject=new U;try{c.apply(e,a.concat([function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];(a=b.shift())?g.error(a):(g.next(b.length<=1?b[0]:b),g.complete())}]))}catch(L){ta(g)?g.error(L):console.warn(L)}}return g.subscribe(d)})}},k.combineLatest=function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];var b=a=null;return A(c[c.length-1])&&(b=c.pop()),"function"==typeof c[c.length-1]&&(a=c.pop()),1===c.length&&x(c[0])&&(c=c[0]),Z(c,b).lift(new Ja(a))},k.concat=aa,k.defer=Aa,k.empty=S,k.forkJoin=function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];if(1===c.length){var b=c[0];if(x(b))return ja(b,null);if(sa(b)&&Object.getPrototypeOf(b)===Object.prototype)return ja((c=Object.keys(b)).map(function(a){return b[a]}),c)}if("function"!=typeof c[c.length-1])return ja(c,null);var d=c.pop();return ja(c=1===c.length&&x(c[0])?c[0]:c,null).pipe(B(function(a){return d.apply(void 0,a)}))},k.from=G,k.fromEvent=function Za(c,a,b,d){return Q(b)&&(d=b,b=void 0),d?Za(c,a,b).pipe(B(function(b){return x(b)?d.apply(void 0,b):d(b)})):new n(function(d){!function $a(c,a,b,d,e){var f;if(c&&"function"==typeof c.addEventListener&&"function"==typeof c.removeEventListener)c.addEventListener(a,b,e),f=function(){return c.removeEventListener(a,b,e)};else if(c&&"function"==typeof c.on&&"function"==typeof c.off)c.on(a,b),f=function(){return c.off(a,b)};else if(c&&"function"==typeof c.addListener&&"function"==typeof c.removeListener)c.addListener(a,b),f=function(){return c.removeListener(a,b)};else{if(!c||!c.length)throw new TypeError("Invalid event target");for(var g=0,l=c.length;g<l;g++)$a(c[g],a,b,d,e)}d.add(f)}(c,a,function(b){1<arguments.length?d.next(Array.prototype.slice.call(arguments)):d.next(b)},d,b)})},k.fromEventPattern=function ab(c,a,b){return b?ab(c,a).pipe(B(function(a){return x(a)?b.apply(void 0,a):b(a)})):new n(function(b){function d(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b.next(1===a.length?a[0]:a)}var f;try{f=c(d)}catch(g){return void b.error(g)}if(Q(a))return function(){return a(d,f)}})},k.generate=function(c,a,b,d,e){var f,g;return 1==arguments.length?(g=c.initialState,a=c.condition,b=c.iterate,f=c.resultSelector||J,e=c.scheduler):void 0===d||A(d)?(g=c,f=J,e=d):(g=c,f=d),new n(function(c){var d=g;if(e)return e.schedule(bc,0,{subscriber:c,iterate:b,condition:a,resultSelector:f,state:d});for(;;){if(a){var h=void 0;try{h=a(d)}catch(r){c.error(r);break}if(!h){c.complete();break}}h=void 0;try{h=f(d)}catch(r){c.error(r);break}if(c.next(h),c.closed)break;try{d=b(d)}catch(r){c.error(r);break}}})},k.iif=function(c,a,b){return void 0===a&&(a=T),void 0===b&&(b=T),Aa(function(){return c()?a:b})},k.interval=function(c,a){return void 0===c&&(c=0),void 0===a&&(a=y),(!W(c)||c<0)&&(c=0),a&&"function"==typeof a.schedule||(a=y),new n(function(b){return b.add(a.schedule(cc,c,{subscriber:b,counter:0,period:c})),b})},k.merge=bb,k.never=function(){return Cb},k.of=ha,k.onErrorResumeNext=function Ba(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];if(0===c.length)return T;var b=c[0],d=c.slice(1);return 1===c.length&&x(b)?Ba.apply(void 0,b):new n(function(a){function c(){return a.add(Ba.apply(void 0,d).subscribe(a))}return G(b).subscribe({next:function(b){a.next(b)},error:c,complete:c})})},k.pairs=function(c,a){return new n(a?function(b){var d=Object.keys(c),e=new t;return e.add(a.schedule(dc,0,{keys:d,index:0,subscriber:b,subscription:e,obj:c})),e}:function(a){for(var b=Object.keys(c),e=0;e<b.length&&!a.closed;e++){var f=b[e];c.hasOwnProperty(f)&&a.next([f,c[f]])}a.complete()})},k.partition=function(c,a,b){return[I(a,b)(new n(ia(c))),I(cb(a,b))(new n(ia(c)))]},k.race=db,k.range=function(c,a,b){return void 0===c&&(c=0),new n(function(d){void 0===a&&(a=c,c=0);var e=0,f=c;if(b)return b.schedule(gc,0,{index:e,count:a,start:c,subscriber:d});for(;;){if(e++>=a){d.complete();break}if(d.next(f++),d.closed)break}})},k.throwError=xa,k.timer=eb,k.using=function(c,a){return new n(function(b){var d,e;try{d=c()}catch(g){return void b.error(g)}try{e=a(d)}catch(g){return void b.error(g)}var f=(e?G(e):T).subscribe(b);return function(){f.unsubscribe(),d&&d.unsubscribe()}})},k.zip=fb,k.scheduled=Wa,k.EMPTY=T,k.NEVER=Cb,k.config=C,Object.defineProperty(k,"__esModule",{value:!0})}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.decomp=e()}}(function(){return function e(f,o,n){function d(t,l){if(!o[t]){if(!f[t]){var u="function"==typeof require&&require;if(!l&&u)return u(t,!0);if(i)return i(t,!0);throw new Error("Cannot find module '"+t+"'")}var p=o[t]={exports:{}};f[t][0].call(p.exports,function(e){var o=f[t][1][e];return d(o||e)},p,p.exports,e,f,o,n)}return o[t].exports}for(var i="function"==typeof require&&require,t=0;t<n.length;t++)d(n[t]);return d}({1:[function(e,f,o){function n(e,f,o){o=o||0;var n,d,i,t,l,u,p,s=[0,0];return n=e[1][1]-e[0][1],d=e[0][0]-e[1][0],i=n*e[0][0]+d*e[0][1],t=f[1][1]-f[0][1],l=f[0][0]-f[1][0],u=t*f[0][0]+l*f[0][1],D(p=n*l-t*d,0,o)||(s[0]=(l*i-d*u)/p,s[1]=(n*u-t*i)/p),s}function d(e,f,o,n){var d=f[0]-e[0],i=f[1]-e[1],t=n[0]-o[0],l=n[1]-o[1];if(t*i-l*d==0)return!1;var u=(d*(o[1]-e[1])+i*(e[0]-o[0]))/(t*i-l*d),p=(t*(e[1]-o[1])+l*(o[0]-e[0]))/(l*d-t*i);return 0<=u&&u<=1&&0<=p&&p<=1}function i(e,f,o){return(f[0]-e[0])*(o[1]-e[1])-(o[0]-e[0])*(f[1]-e[1])}function t(e,f,o){return 0<i(e,f,o)}function l(e,f,o){return 0<=i(e,f,o)}function u(e,f,o){return i(e,f,o)<0}function p(e,f,o){return i(e,f,o)<=0}function s(e,f,o,n){if(n){var d=F,t=G;d[0]=f[0]-e[0],d[1]=f[1]-e[1],t[0]=o[0]-f[0],t[1]=o[1]-f[1];var l=d[0]*t[0]+d[1]*t[1],u=Math.sqrt(d[0]*d[0]+d[1]*d[1]),p=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return Math.acos(l/(u*p))<n}return 0===i(e,f,o)}function c(e,f){var o=f[0]-e[0],n=f[1]-e[1];return o*o+n*n}function y(e,f){var o=e.length;return e[f<0?f%o+o:f%o]}function m(e,f,o,n){for(var d=o;d<n;d++)e.push(f[d])}function b(e,f){return u(y(e,f-1),y(e,f),y(e,f+1))}function g(e,f,o){var d,i,t=H,u=I;if(l(y(e,f+1),y(e,f),y(e,o))&&p(y(e,f-1),y(e,f),y(e,o)))return!1;i=c(y(e,f),y(e,o));for(var s=0;s!==e.length;++s)if((s+1)%e.length!==f&&s!==f&&l(y(e,f),y(e,o),y(e,s+1))&&p(y(e,f),y(e,o),y(e,s))&&(t[0]=y(e,f),t[1]=y(e,o),u[0]=y(e,s),u[1]=y(e,s+1),d=n(t,u),c(y(e,f),d)<i))return!1;return!0}function x(e,f,o){for(var n=0;n!==e.length;++n)if(n!==f&&n!==o&&(n+1)%e.length!==f&&(n+1)%e.length!==o&&d(y(e,f),y(e,o),y(e,n),y(e,n+1)))return!1;return!0}function j(e,f,o,n){var d=n||[];if(function(e){e.length=0}(d),f<o)for(var i=f;i<=o;i++)d.push(e[i]);else{for(i=0;i<=o;i++)d.push(e[i]);for(i=f;i<e.length;i++)d.push(e[i])}return d}function z(e,f,o,n,d){d=d||0;var i=f[1]-e[1],t=e[0]-f[0],l=i*e[0]+t*e[1],u=n[1]-o[1],p=o[0]-n[0],s=u*o[0]+p*o[1],c=i*p-u*t;return D(c,0,d)?[0,0]:[(p*l-t*s)/c,(i*s-u*l)/c]}function D(e,f,o){return o=o||0,Math.abs(e-f)<=o}function E(e,f,o){return D(e[0],f[0],o)&&D(e[1],f[1],o)}f.exports={decomp:function(e){var f=function v(e){for(var f=[],o=[],n=[],d=[],i=Number.MAX_VALUE,t=0;t<e.length;++t)if(b(e,t))for(var l=0;l<e.length;++l)if(g(e,t,l)){o=v(j(e,t,l,d)),n=v(j(e,l,t,d));for(var u=0;u<n.length;u++)o.push(n[u]);o.length<i&&(i=(f=o).length,f.push([y(e,t),y(e,l)]))}return f}(e);return 0<f.length?function k(e,f){if(0===f.length)return[e];if(f instanceof Array&&f.length&&f[0]instanceof Array&&2===f[0].length&&f[0][0]instanceof Array){for(var o=[e],n=0;n<f.length;n++)for(var d=f[n],i=0;i<o.length;i++){var t=o[i],l=k(t,d);if(l){o.splice(i,1),o.push(l[0],l[1]);break}}return o}var d=f,n=e.indexOf(d[0]),i=e.indexOf(d[1]);return-1!==n&&-1!==i&&[j(e,n,i),j(e,i,n)]}(e,f):[e]},quickDecomp:function A(e,f,o,n,d,i,s){i=i||100,s=s||0,d=d||25,f=void 0!==f?f:[],o=o||[],n=n||[];var a=[0,0],r=[0,0],w=[0,0],g=0,j=0,v=0,h=0,k=0,q=0,B=0,C=[],D=[],E=e,F=e;if(F.length<3)return f;if(i<++s)return console.warn("quickDecomp: max level ("+i+") reached."),f;for(var G=0;G<e.length;++G)if(b(E,G)){o.push(E[G]),g=j=Number.MAX_VALUE;for(var H=0;H<e.length;++H)t(y(E,G-1),y(E,G),y(E,H))&&p(y(E,G-1),y(E,G),y(E,H-1))&&(w=z(y(E,G-1),y(E,G),y(E,H),y(E,H-1)),u(y(E,G+1),y(E,G),w)&&(v=c(E[G],w))<j&&(j=v,r=w,q=H)),t(y(E,G+1),y(E,G),y(E,H+1))&&p(y(E,G+1),y(E,G),y(E,H))&&(w=z(y(E,G+1),y(E,G),y(E,H),y(E,H+1)),t(y(E,G-1),y(E,G),w)&&(v=c(E[G],w))<g&&(g=v,a=w,k=H));if(q===(k+1)%e.length)w[0]=(r[0]+a[0])/2,w[1]=(r[1]+a[1])/2,n.push(w),G<k?(m(C,E,G,k+1),C.push(w),D.push(w),0!==q&&m(D,E,q,E.length),m(D,E,0,G+1)):(0!==G&&m(C,E,G,E.length),m(C,E,0,k+1),C.push(w),D.push(w),m(D,E,q,G+1));else{if(k<q&&(k+=e.length),h=Number.MAX_VALUE,k<q)return f;for(H=q;H<=k;++H)l(y(E,G-1),y(E,G),y(E,H))&&p(y(E,G+1),y(E,G),y(E,H))&&(v=c(y(E,G),y(E,H)))<h&&x(E,G,H)&&(h=v,B=H%e.length);G<B?(m(C,E,G,B+1),0!==B&&m(D,E,B,F.length),m(D,E,0,G+1)):(0!==G&&m(C,E,G,F.length),m(C,E,0,B+1),m(D,E,B,G+1))}return C.length<D.length?(A(C,f,o,n,d,i,s),A(D,f,o,n,d,i,s)):(A(D,f,o,n,d,i,s),A(C,f,o,n,d,i,s)),f}return f.push(e),f},isSimple:function(e){var f,o=e;for(f=0;f<o.length-1;f++)for(var n=0;n<f-1;n++)if(d(o[f],o[f+1],o[n],o[n+1]))return!1;for(f=1;f<o.length-2;f++)if(d(o[0],o[o.length-1],o[f],o[f+1]))return!1;return!0},removeCollinearPoints:function(e,f){for(var o=0,n=e.length-1;3<e.length&&0<=n;--n)s(y(e,n-1),y(e,n),y(e,n+1),f)&&(e.splice(n%e.length,1),o++);return o},removeDuplicatePoints:function(e,f){for(var o=e.length-1;1<=o;--o)for(var n=e[o],d=o-1;0<=d;--d)E(n,e[d],f)&&e.splice(o,1)},makeCCW:function(e){for(var f=0,o=e,n=1;n<e.length;++n)(o[n][1]<o[f][1]||o[n][1]===o[f][1]&&o[n][0]>o[f][0])&&(f=n);return!t(y(e,f-1),y(e,f),y(e,f+1))&&(function(e){for(var f=[],o=e.length,n=0;n!==o;n++)f.push(e.pop());for(n=0;n!==o;n++)e[n]=f[n]}(e),!0)}};var F=[],G=[],H=[],I=[]},{}]},{},[1])(1)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Matter=e()}}(function(){return function e(t,n,o){function i(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){return i(t[s][1][e]||e)},d,d.exports,e,t,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Vertices"),r=e("../geometry/Vector"),s=e("../core/Sleeping"),a=(e("../render/Render"),e("../core/Common")),l=e("../geometry/Bounds"),c=e("../geometry/Axes");!function(){o._inertiaScale=4,o._nextCollidingGroupId=1,o._nextNonCollidingGroupId=-1,o._nextCategory=1,o.create=function(t){var n={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:i.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},o=a.extend(n,t);return e(o,t),o},o.nextGroup=function(e){return e?o._nextNonCollidingGroupId--:o._nextCollidingGroupId++},o.nextCategory=function(){return o._nextCategory=o._nextCategory<<1,o._nextCategory};var e=function(e,t){t=t||{},o.set(e,{bounds:e.bounds||l.create(e.vertices),positionPrev:e.positionPrev||r.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),i.rotate(e.vertices,e.angle,e.position),c.rotate(e.axes,e.angle),l.update(e.bounds,e.vertices,e.velocity),o.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var n=e.isStatic?"#2e2b44":a.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]);e.render.fillStyle=e.render.fillStyle||n,e.render.strokeStyle=e.render.strokeStyle||"#000",e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};o.set=function(e,t,n){var i;for(i in"string"==typeof t&&(i=t,(t={})[i]=n),t)if(n=t[i],t.hasOwnProperty(i))switch(i){case"isStatic":o.setStatic(e,n);break;case"isSleeping":s.set(e,n);break;case"mass":o.setMass(e,n);break;case"density":o.setDensity(e,n);break;case"inertia":o.setInertia(e,n);break;case"vertices":o.setVertices(e,n);break;case"position":o.setPosition(e,n);break;case"angle":o.setAngle(e,n);break;case"velocity":o.setVelocity(e,n);break;case"angularVelocity":o.setAngularVelocity(e,n);break;case"parts":o.setParts(e,n);break;default:e[i]=n}},o.setStatic=function(e,t){for(var n=0;n<e.parts.length;n++){var o=e.parts[n];(o.isStatic=t)?(o._original={restitution:o.restitution,friction:o.friction,mass:o.mass,inertia:o.inertia,density:o.density,inverseMass:o.inverseMass,inverseInertia:o.inverseInertia},o.restitution=0,o.friction=1,o.mass=o.inertia=o.density=1/0,o.inverseMass=o.inverseInertia=0,o.positionPrev.x=o.position.x,o.positionPrev.y=o.position.y,o.anglePrev=o.angle,o.angularVelocity=0,o.speed=0,o.angularSpeed=0,o.motion=0):o._original&&(o.restitution=o._original.restitution,o.friction=o._original.friction,o.mass=o._original.mass,o.inertia=o._original.inertia,o.density=o._original.density,o.inverseMass=o._original.inverseMass,o.inverseInertia=o._original.inverseInertia,delete o._original)}},o.setMass=function(e,t){var n=e.inertia/(e.mass/6);e.inertia=t/6*n,e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},o.setDensity=function(e,t){o.setMass(e,t*e.area),e.density=t},o.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},o.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=i.create(t,e),e.axes=c.fromVertices(e.vertices),e.area=i.area(e.vertices),o.setMass(e,e.density*e.area);var n=i.centre(e.vertices);i.translate(e.vertices,n,-1),o.setInertia(e,o._inertiaScale*i.inertia(e.vertices,e.mass)),i.translate(e.vertices,e.position),l.update(e.bounds,e.vertices,e.velocity)},o.setParts=function(e,t,n){var r;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,r=0;r<t.length;r++){var s=t[r];s!==e&&(s.parent=e).parts.push(s)}if(1!==e.parts.length){if(n=void 0===n||n){var a=[];for(r=0;r<t.length;r++)a=a.concat(t[r].vertices);i.clockwiseSort(a);var l=i.hull(a),c=i.centre(l);o.setVertices(e,l),i.translate(e.vertices,c)}var d=o._totalProperties(e);e.area=d.area,(e.parent=e).position.x=d.centre.x,e.position.y=d.centre.y,e.positionPrev.x=d.centre.x,e.positionPrev.y=d.centre.y,o.setMass(e,d.mass),o.setInertia(e,d.inertia),o.setPosition(e,d.centre)}},o.setPosition=function(e,t){var n=r.sub(t,e.position);e.positionPrev.x+=n.x,e.positionPrev.y+=n.y;for(var o=0;o<e.parts.length;o++){var s=e.parts[o];s.position.x+=n.x,s.position.y+=n.y,i.translate(s.vertices,n),l.update(s.bounds,s.vertices,e.velocity)}},o.setAngle=function(e,t){var n=t-e.angle;e.anglePrev+=n;for(var o=0;o<e.parts.length;o++){var s=e.parts[o];s.angle+=n,i.rotate(s.vertices,n,e.position),c.rotate(s.axes,n),l.update(s.bounds,s.vertices,e.velocity),0<o&&r.rotateAbout(s.position,n,e.position,s.position)}},o.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=r.magnitude(e.velocity)},o.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=Math.abs(e.angularVelocity)},o.translate=function(e,t){o.setPosition(e,r.add(e.position,t))},o.rotate=function(e,t,n){if(n){var i=Math.cos(t),r=Math.sin(t),s=e.position.x-n.x,a=e.position.y-n.y;o.setPosition(e,{x:n.x+(s*i-a*r),y:n.y+(s*r+a*i)}),o.setAngle(e,e.angle+t)}else o.setAngle(e,e.angle+t)},o.scale=function(e,t,n,r){var s=0,a=0;r=r||e.position;for(var d=0;d<e.parts.length;d++){var u=e.parts[d];i.scale(u.vertices,t,n,r),u.axes=c.fromVertices(u.vertices),u.area=i.area(u.vertices),o.setMass(u,e.density*u.area),i.translate(u.vertices,{x:-u.position.x,y:-u.position.y}),o.setInertia(u,o._inertiaScale*i.inertia(u.vertices,u.mass)),i.translate(u.vertices,{x:u.position.x,y:u.position.y}),0<d&&(s+=u.area,a+=u.inertia),u.position.x=r.x+(u.position.x-r.x)*t,u.position.y=r.y+(u.position.y-r.y)*n,l.update(u.bounds,u.vertices,e.velocity)}1<e.parts.length&&(e.area=s,e.isStatic||(o.setMass(e,e.density*s),o.setInertia(e,a))),e.circleRadius&&(t===n?e.circleRadius*=t:e.circleRadius=null)},o.update=function(e,t,n,o){var s=Math.pow(t*n*e.timeScale,2),a=1-e.frictionAir*n*e.timeScale,d=e.position.x-e.positionPrev.x,u=e.position.y-e.positionPrev.y;e.velocity.x=d*a*o+e.force.x/e.mass*s,e.velocity.y=u*a*o+e.force.y/e.mass*s,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*a*o+e.torque/e.inertia*s,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=r.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var p=0;p<e.parts.length;p++){var f=e.parts[p];i.translate(f.vertices,e.velocity),0<p&&(f.position.x+=e.velocity.x,f.position.y+=e.velocity.y),0!==e.angularVelocity&&(i.rotate(f.vertices,e.angularVelocity,e.position),c.rotate(f.axes,e.angularVelocity),0<p&&r.rotateAbout(f.position,e.angularVelocity,e.position,f.position)),l.update(f.bounds,f.vertices,e.velocity)}},o.applyForce=function(e,t,n){e.force.x+=n.x,e.force.y+=n.y;var o_x=t.x-e.position.x,o_y=t.y-e.position.y;e.torque+=o_x*n.y-o_y*n.x},o._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===e.parts.length?0:1;n<e.parts.length;n++){var o=e.parts[n],i=o.mass!==1/0?o.mass:1;t.mass+=i,t.area+=o.area,t.inertia+=o.inertia,t.centre=r.add(t.centre,r.mult(o.position,i))}return t.centre=r.div(t.centre,t.mass),t}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(e,t,n){var o={};t.exports=o;var i=e("../core/Events"),r=e("../core/Common"),s=e("../geometry/Bounds"),a=e("./Body");o.create=function(e){return r.extend({id:r.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},e)},o.setModified=function(e,t,n,i){if(e.isModified=t,n&&e.parent&&o.setModified(e.parent,t,n,i),i)for(var r=0;r<e.composites.length;r++){var s=e.composites[r];o.setModified(s,t,n,i)}},o.add=function(e,t){var n=[].concat(t);i.trigger(e,"beforeAdd",{object:t});for(var s=0;s<n.length;s++){var a=n[s];switch(a.type){case"body":if(a.parent!==a){r.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}o.addBody(e,a);break;case"constraint":o.addConstraint(e,a);break;case"composite":o.addComposite(e,a);break;case"mouseConstraint":o.addConstraint(e,a.constraint)}}return i.trigger(e,"afterAdd",{object:t}),e},o.remove=function(e,t,n){var r=[].concat(t);i.trigger(e,"beforeRemove",{object:t});for(var s=0;s<r.length;s++){var a=r[s];switch(a.type){case"body":o.removeBody(e,a,n);break;case"constraint":o.removeConstraint(e,a,n);break;case"composite":o.removeComposite(e,a,n);break;case"mouseConstraint":o.removeConstraint(e,a.constraint)}}return i.trigger(e,"afterRemove",{object:t}),e},o.addComposite=function(e,t){return e.composites.push(t),t.parent=e,o.setModified(e,!0,!0,!1),e},o.removeComposite=function(e,t,n){var i=r.indexOf(e.composites,t);if(-1!==i&&(o.removeCompositeAt(e,i),o.setModified(e,!0,!0,!1)),n)for(var s=0;s<e.composites.length;s++)o.removeComposite(e.composites[s],t,!0);return e},o.removeCompositeAt=function(e,t){return e.composites.splice(t,1),o.setModified(e,!0,!0,!1),e},o.addBody=function(e,t){return e.bodies.push(t),o.setModified(e,!0,!0,!1),e},o.removeBody=function(e,t,n){var i=r.indexOf(e.bodies,t);if(-1!==i&&(o.removeBodyAt(e,i),o.setModified(e,!0,!0,!1)),n)for(var s=0;s<e.composites.length;s++)o.removeBody(e.composites[s],t,!0);return e},o.removeBodyAt=function(e,t){return e.bodies.splice(t,1),o.setModified(e,!0,!0,!1),e},o.addConstraint=function(e,t){return e.constraints.push(t),o.setModified(e,!0,!0,!1),e},o.removeConstraint=function(e,t,n){var i=r.indexOf(e.constraints,t);if(-1!==i&&o.removeConstraintAt(e,i),n)for(var s=0;s<e.composites.length;s++)o.removeConstraint(e.composites[s],t,!0);return e},o.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),o.setModified(e,!0,!0,!1),e},o.clear=function(e,t,n){if(n)for(var i=0;i<e.composites.length;i++)o.clear(e.composites[i],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,o.setModified(e,!0,!0,!1),e},o.allBodies=function(e){for(var t=[].concat(e.bodies),n=0;n<e.composites.length;n++)t=t.concat(o.allBodies(e.composites[n]));return t},o.allConstraints=function(e){for(var t=[].concat(e.constraints),n=0;n<e.composites.length;n++)t=t.concat(o.allConstraints(e.composites[n]));return t},o.allComposites=function(e){for(var t=[].concat(e.composites),n=0;n<e.composites.length;n++)t=t.concat(o.allComposites(e.composites[n]));return t},o.get=function(e,t,n){var i,r;switch(n){case"body":i=o.allBodies(e);break;case"constraint":i=o.allConstraints(e);break;case"composite":i=o.allComposites(e).concat(e)}return i?0===(r=i.filter(function(e){return e.id.toString()===t.toString()})).length?null:r[0]:null},o.move=function(e,t,n){return o.remove(e,t),o.add(n,t),e},o.rebase=function(e){for(var t=o.allBodies(e).concat(o.allConstraints(e)).concat(o.allComposites(e)),n=0;n<t.length;n++)t[n].id=r.nextId();return o.setModified(e,!0,!0,!1),e},o.translate=function(e,t,n){for(var i=n?o.allBodies(e):e.bodies,r=0;r<i.length;r++)a.translate(i[r],t);return o.setModified(e,!0,!0,!1),e},o.rotate=function(e,t,n,i){for(var r=Math.cos(t),s=Math.sin(t),l=i?o.allBodies(e):e.bodies,c=0;c<l.length;c++){var d=l[c],u=d.position.x-n.x,p=d.position.y-n.y;a.setPosition(d,{x:n.x+(u*r-p*s),y:n.y+(u*s+p*r)}),a.rotate(d,t)}return o.setModified(e,!0,!0,!1),e},o.scale=function(e,t,n,i,r){for(var s=r?o.allBodies(e):e.bodies,l=0;l<s.length;l++){var c=s[l],d=c.position.x-i.x,u=c.position.y-i.y;a.setPosition(c,{x:i.x+d*t,y:i.y+u*n}),a.scale(c,t,n)}return o.setModified(e,!0,!0,!1),e},o.bounds=function(e){for(var t=o.allBodies(e),n=[],i=0;i<t.length;i+=1){var r=t[i];n.push(r.bounds.min,r.bounds.max)}return s.create(n)}},{"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"./Body":1}],3:[function(e,t,n){var o={};t.exports=o;var i=e("./Composite"),r=(e("../constraint/Constraint"),e("../core/Common"));o.create=function(e){var t=i.create();return r.extend(t,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}},e)}},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(e,t,n){var o={};(t.exports=o).create=function(e){return{id:o.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}},o.id=function(e){return e.body.id+"_"+e.index}},{}],5:[function(e,t,n){var o={};t.exports=o;var i=e("./SAT"),r=e("./Pair"),s=e("../geometry/Bounds");o.collisions=function(e,t){for(var n=[],a=t.pairs.table,l=0;l<e.length;l++){var c=e[l][0],d=e[l][1];if((!c.isStatic&&!c.isSleeping||!d.isStatic&&!d.isSleeping)&&o.canCollide(c.collisionFilter,d.collisionFilter)&&s.overlaps(c.bounds,d.bounds))for(var u=1<c.parts.length?1:0;u<c.parts.length;u++)for(var p=c.parts[u],f=1<d.parts.length?1:0;f<d.parts.length;f++){var m=d.parts[f];if(p===c&&m===d||s.overlaps(p.bounds,m.bounds)){var v,g=a[r.id(p,m)];v=g&&g.isActive?g.collision:null;var x=i.collides(p,m,v);x.collided&&n.push(x)}}}return n},o.canCollide=function(e,t){return e.group===t.group&&0!==e.group?0<e.group:0!=(e.mask&t.category)&&0!=(t.mask&e.category)}},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(e,t,n){var o={};t.exports=o;var i=e("./Pair"),r=e("./Detector"),s=e("../core/Common");o.create=function(e){var t={controller:o,detector:r.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return s.extend(t,e)},o.update=function(e,t,n,i){var r,s,a,l,c,d=n.world,u=e.buckets,p=!1;for(r=0;r<t.length;r++){var f=t[r];if((!f.isSleeping||i)&&!(f.bounds.max.x<d.bounds.min.x||f.bounds.min.x>d.bounds.max.x||f.bounds.max.y<d.bounds.min.y||f.bounds.min.y>d.bounds.max.y)){var m=o._getRegion(e,f);if(!f.region||m.id!==f.region.id||i){f.region&&!i||(f.region=m);var v=o._regionUnion(m,f.region);for(s=v.startCol;s<=v.endCol;s++)for(a=v.startRow;a<=v.endRow;a++){l=u[c=o._getBucketId(s,a)];var y=s>=m.startCol&&s<=m.endCol&&a>=m.startRow&&a<=m.endRow,g=s>=f.region.startCol&&s<=f.region.endCol&&a>=f.region.startRow&&a<=f.region.endRow;!y&&g&&g&&l&&o._bucketRemoveBody(e,l,f),(f.region===m||y&&!g||i)&&(l||(l=o._createBucket(u,c)),o._bucketAddBody(e,l,f))}f.region=m,p=!0}}}p&&(e.pairsList=o._createActivePairsList(e))},o.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},o._regionUnion=function(e,t){var n=Math.min(e.startCol,t.startCol),i=Math.max(e.endCol,t.endCol),r=Math.min(e.startRow,t.startRow),s=Math.max(e.endRow,t.endRow);return o._createRegion(n,i,r,s)},o._getRegion=function(e,t){var n=t.bounds,i=Math.floor(n.min.x/e.bucketWidth),r=Math.floor(n.max.x/e.bucketWidth),s=Math.floor(n.min.y/e.bucketHeight),a=Math.floor(n.max.y/e.bucketHeight);return o._createRegion(i,r,s,a)},o._createRegion=function(e,t,n,o){return{id:e+","+t+","+n+","+o,startCol:e,endCol:t,startRow:n,endRow:o}},o._getBucketId=function(e,t){return"C"+e+"R"+t},o._createBucket=function(e,t){return e[t]=[]},o._bucketAddBody=function(e,t,n){for(var o=0;o<t.length;o++){var r=t[o];if(!(n.id===r.id||n.isStatic&&r.isStatic)){var s=i.id(n,r),a=e.pairs[s];a?a[2]+=1:e.pairs[s]=[n,r,1]}}t.push(n)},o._bucketRemoveBody=function(e,t,n){t.splice(s.indexOf(t,n),1);for(var o=0;o<t.length;o++){var r=t[o],a=i.id(n,r),l=e.pairs[a];l&&(l[2]-=1)}},o._createActivePairsList=function(e){var t,n,o=[];t=s.keys(e.pairs);for(var i=0;i<t.length;i++)0<(n=e.pairs[t[i]])[2]?o.push(n):delete e.pairs[t[i]];return o}},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(e,t,n){var o={};t.exports=o;var i=e("./Contact");o.create=function(e,t){var n=e.bodyA,i=e.bodyB,r=e.parentA,s=e.parentB,a={id:o.id(n,i),bodyA:n,bodyB:i,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:n.isSensor||i.isSensor,timeCreated:t,timeUpdated:t,inverseMass:r.inverseMass+s.inverseMass,friction:Math.min(r.friction,s.friction),frictionStatic:Math.max(r.frictionStatic,s.frictionStatic),restitution:Math.max(r.restitution,s.restitution),slop:Math.max(r.slop,s.slop)};return o.update(a,e,t),a},o.update=function(e,t,n){var r=e.contacts,s=t.supports,a=e.activeContacts,l=t.parentA,c=t.parentB;if(e.collision=t,e.inverseMass=l.inverseMass+c.inverseMass,e.friction=Math.min(l.friction,c.friction),e.frictionStatic=Math.max(l.frictionStatic,c.frictionStatic),e.restitution=Math.max(l.restitution,c.restitution),e.slop=Math.max(l.slop,c.slop),a.length=0,t.collided){for(var d=0;d<s.length;d++){var u=s[d],p=i.id(u),f=r[p];f?a.push(f):a.push(r[p]=i.create(u))}e.separation=t.depth,o.setActive(e,!0,n)}else!0===e.isActive&&o.setActive(e,!1,n)},o.setActive=function(e,t,n){t?(e.isActive=!0,e.timeUpdated=n):(e.isActive=!1,e.activeContacts.length=0)},o.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},{"./Contact":4}],8:[function(e,t,n){var o={};t.exports=o;var i=e("./Pair"),r=e("../core/Common");o._pairMaxIdleLife=1e3,o.create=function(e){return r.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},o.update=function(e,t,n){var o,s,a,l,c=e.list,d=e.table,u=e.collisionStart,p=e.collisionEnd,f=e.collisionActive,m=[];for(u.length=0,p.length=0,l=f.length=0;l<t.length;l++)(o=t[l]).collided&&(s=i.id(o.bodyA,o.bodyB),m.push(s),(a=d[s])?(a.isActive?f.push(a):u.push(a),i.update(a,o,n)):(a=i.create(o,n),d[s]=a,u.push(a),c.push(a)));for(l=0;l<c.length;l++)(a=c[l]).isActive&&-1===r.indexOf(m,a.id)&&(i.setActive(a,!1,n),p.push(a))},o.removeOld=function(e,t){var n,i,r,s,a=e.list,l=e.table,c=[];for(s=0;s<a.length;s++)(i=(n=a[s]).collision).bodyA.isSleeping||i.bodyB.isSleeping?n.timeUpdated=t:t-n.timeUpdated>o._pairMaxIdleLife&&c.push(s);for(s=0;s<c.length;s++)delete l[(n=a[r=c[s]-s]).id],a.splice(r,1)},o.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},{"../core/Common":14,"./Pair":7}],9:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Vector"),r=e("./SAT"),s=e("../geometry/Bounds"),a=e("../factory/Bodies"),l=e("../geometry/Vertices");o.collides=function(e,t){for(var n=[],o=0;o<t.length;o++){var i=t[o];if(s.overlaps(i.bounds,e.bounds))for(var a=1===i.parts.length?0:1;a<i.parts.length;a++){var l=i.parts[a];if(s.overlaps(l.bounds,e.bounds)){var c=r.collides(l,e);if(c.collided){n.push(c);break}}}}return n},o.ray=function(e,t,n,r){r=r||1e-100;for(var s=i.angle(t,n),l=i.magnitude(i.sub(t,n)),c=.5*(n.x+t.x),d=.5*(n.y+t.y),u=a.rectangle(c,d,l,r,{angle:s}),p=o.collides(u,e),f=0;f<p.length;f+=1){var m=p[f];m.body=m.bodyB=m.bodyA}return p},o.region=function(e,t,n){for(var o=[],i=0;i<e.length;i++){var r=e[i],a=s.overlaps(r.bounds,t);(a&&!n||!a&&n)&&o.push(r)}return o},o.point=function(e,t){for(var n=[],o=0;o<e.length;o++){var i=e[o];if(s.contains(i.bounds,t))for(var r=1===i.parts.length?0:1;r<i.parts.length;r++){var a=i.parts[r];if(s.contains(a.bounds,t)&&l.contains(a.vertices,t)){n.push(i);break}}}return n}},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Vertices"),r=e("../geometry/Vector"),s=e("../core/Common"),a=e("../geometry/Bounds");o._restingThresh=4,o._restingThreshTangent=6,o._positionDampen=.9,o._positionWarming=.8,o._frictionNormalMultiplier=5,o.preSolvePosition=function(e){var t,n,o;for(t=0;t<e.length;t++)(n=e[t]).isActive&&(o=n.activeContacts.length,n.collision.parentA.totalContacts+=o,n.collision.parentB.totalContacts+=o)},o.solvePosition=function(e,t){var n,i,s,a,l,c,d,u,p,f=r._temp[0],m=r._temp[1],v=r._temp[2],y=r._temp[3];for(n=0;n<e.length;n++)(i=e[n]).isActive&&!i.isSensor&&(a=(s=i.collision).parentA,l=s.parentB,c=s.normal,d=r.sub(r.add(l.positionImpulse,l.position,f),r.add(a.positionImpulse,r.sub(l.position,s.penetration,m),v),y),i.separation=r.dot(c,d));for(n=0;n<e.length;n++)(i=e[n]).isActive&&!i.isSensor&&(a=(s=i.collision).parentA,l=s.parentB,c=s.normal,p=(i.separation-i.slop)*t,(a.isStatic||l.isStatic)&&(p*=2),a.isStatic||a.isSleeping||(u=o._positionDampen/a.totalContacts,a.positionImpulse.x+=c.x*p*u,a.positionImpulse.y+=c.y*p*u),l.isStatic||l.isSleeping||(u=o._positionDampen/l.totalContacts,l.positionImpulse.x-=c.x*p*u,l.positionImpulse.y-=c.y*p*u))},o.postSolvePosition=function(e){for(var t=0;t<e.length;t++){var n=e[t];if((n.totalContacts=0)!==n.positionImpulse.x||0!==n.positionImpulse.y){for(var s=0;s<n.parts.length;s++){var l=n.parts[s];i.translate(l.vertices,n.positionImpulse),a.update(l.bounds,l.vertices,n.velocity),l.position.x+=n.positionImpulse.x,l.position.y+=n.positionImpulse.y}n.positionPrev.x+=n.positionImpulse.x,n.positionPrev.y+=n.positionImpulse.y,r.dot(n.positionImpulse,n.velocity)<0?(n.positionImpulse.x=0,n.positionImpulse.y=0):(n.positionImpulse.x*=o._positionWarming,n.positionImpulse.y*=o._positionWarming)}}},o.preSolveVelocity=function(e){var t,n,o,i,s,a,l,c,d,u,p,f,m,v,y=r._temp[0],g=r._temp[1];for(t=0;t<e.length;t++)if((o=e[t]).isActive&&!o.isSensor)for(i=o.activeContacts,a=(s=o.collision).parentA,l=s.parentB,c=s.normal,d=s.tangent,n=0;n<i.length;n++)p=(u=i[n]).vertex,f=u.normalImpulse,m=u.tangentImpulse,0===f&&0===m||(y.x=c.x*f+d.x*m,y.y=c.y*f+d.y*m,a.isStatic||a.isSleeping||(v=r.sub(p,a.position,g),a.positionPrev.x+=y.x*a.inverseMass,a.positionPrev.y+=y.y*a.inverseMass,a.anglePrev+=r.cross(v,y)*a.inverseInertia),l.isStatic||l.isSleeping||(v=r.sub(p,l.position,g),l.positionPrev.x-=y.x*l.inverseMass,l.positionPrev.y-=y.y*l.inverseMass,l.anglePrev-=r.cross(v,y)*l.inverseInertia))},o.solveVelocity=function(e,t){for(var n=t*t,i=r._temp[0],a=r._temp[1],l=r._temp[2],c=r._temp[3],d=r._temp[4],u=r._temp[5],p=0;p<e.length;p++){var f=e[p];if(f.isActive&&!f.isSensor){var m=f.collision,v=m.parentA,y=m.parentB,g=m.normal,x=m.tangent,h=f.activeContacts,b=1/h.length;v.velocity.x=v.position.x-v.positionPrev.x,v.velocity.y=v.position.y-v.positionPrev.y,y.velocity.x=y.position.x-y.positionPrev.x,y.velocity.y=y.position.y-y.positionPrev.y,v.angularVelocity=v.angle-v.anglePrev,y.angularVelocity=y.angle-y.anglePrev;for(var w=0;w<h.length;w++){var S=h[w],C=S.vertex,A=r.sub(C,v.position,a),P=r.sub(C,y.position,l),B=r.add(v.velocity,r.mult(r.perp(A),v.angularVelocity),c),M=r.add(y.velocity,r.mult(r.perp(P),y.angularVelocity),d),k=r.sub(B,M,u),I=r.dot(g,k),_=r.dot(x,k),T=Math.abs(_),R=s.sign(_),V=(1+f.restitution)*I,E=s.clamp(f.separation+I,0,1)*o._frictionNormalMultiplier,L=_,F=1/0;T>f.friction*f.frictionStatic*E*n&&(F=T,L=s.clamp(f.friction*R*n,-F,F));var O=r.cross(A,g),q=r.cross(P,g),W=b/(v.inverseMass+y.inverseMass+v.inverseInertia*O*O+y.inverseInertia*q*q);if(V*=W,L*=W,I<0&&I*I>o._restingThresh*n)S.normalImpulse=0;else{var D=S.normalImpulse;S.normalImpulse=Math.min(S.normalImpulse+V,0),V=S.normalImpulse-D}if(_*_>o._restingThreshTangent*n)S.tangentImpulse=0;else{var N=S.tangentImpulse;S.tangentImpulse=s.clamp(S.tangentImpulse+L,-F,F),L=S.tangentImpulse-N}i.x=g.x*V+x.x*L,i.y=g.y*V+x.y*L,v.isStatic||v.isSleeping||(v.positionPrev.x+=i.x*v.inverseMass,v.positionPrev.y+=i.y*v.inverseMass,v.anglePrev+=r.cross(A,i)*v.inverseInertia),y.isStatic||y.isSleeping||(y.positionPrev.x-=i.x*y.inverseMass,y.positionPrev.y-=i.y*y.inverseMass,y.anglePrev-=r.cross(P,i)*y.inverseInertia)}}}}},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Vertices"),r=e("../geometry/Vector");o.collides=function(e,t,n){var s,a,l,c,d=!1;if(n){var u=e.parent,p=t.parent,f=u.speed*u.speed+u.angularSpeed*u.angularSpeed+p.speed*p.speed+p.angularSpeed*p.angularSpeed;d=n&&n.collided&&f<.2,c=n}else c={collided:!1,bodyA:e,bodyB:t};if(n&&d){var m=c.axisBody,v=m===e?t:e,y=[m.axes[n.axisNumber]];if(l=o._overlapAxes(m.vertices,v.vertices,y),c.reused=!0,l.overlap<=0)return c.collided=!1,c}else{if((s=o._overlapAxes(e.vertices,t.vertices,e.axes)).overlap<=0)return c.collided=!1,c;if((a=o._overlapAxes(t.vertices,e.vertices,t.axes)).overlap<=0)return c.collided=!1,c;s.overlap<a.overlap?(l=s,c.axisBody=e):(l=a,c.axisBody=t),c.axisNumber=l.axisNumber}c.bodyA=e.id<t.id?e:t,c.bodyB=e.id<t.id?t:e,c.collided=!0,c.depth=l.overlap,c.parentA=c.bodyA.parent,c.parentB=c.bodyB.parent,e=c.bodyA,t=c.bodyB,r.dot(l.axis,r.sub(t.position,e.position))<0?c.normal={x:l.axis.x,y:l.axis.y}:c.normal={x:-l.axis.x,y:-l.axis.y},c.tangent=r.perp(c.normal),c.penetration=c.penetration||{},c.penetration.x=c.normal.x*c.depth,c.penetration.y=c.normal.y*c.depth;var g=o._findSupports(e,t,c.normal),x=[];if(i.contains(e.vertices,g[0])&&x.push(g[0]),i.contains(e.vertices,g[1])&&x.push(g[1]),x.length<2){var h=o._findSupports(t,e,r.neg(c.normal));i.contains(t.vertices,h[0])&&x.push(h[0]),x.length<2&&i.contains(t.vertices,h[1])&&x.push(h[1])}return x.length<1&&(x=[g[0]]),c.supports=x,c},o._overlapAxes=function(e,t,n){for(var i,s,a=r._temp[0],l=r._temp[1],c={overlap:Number.MAX_VALUE},d=0;d<n.length;d++){if(s=n[d],o._projectToAxis(a,e,s),o._projectToAxis(l,t,s),(i=Math.min(a.max-l.min,l.max-a.min))<=0)return c.overlap=i,c;i<c.overlap&&(c.overlap=i,c.axis=s,c.axisNumber=d)}return c},o._projectToAxis=function(e,t,n){for(var o=r.dot(t[0],n),i=o,s=1;s<t.length;s+=1){var a=r.dot(t[s],n);i<a?i=a:a<o&&(o=a)}e.min=o,e.max=i},o._findSupports=function(e,t,n){for(var o,i,s,a,l=Number.MAX_VALUE,c=r._temp[0],d=t.vertices,u=e.position,p=0;p<d.length;p++)i=d[p],c.x=i.x-u.x,c.y=i.y-u.y,(o=-r.dot(n,c))<l&&(l=o,s=i);return i=d[0<=s.index-1?s.index-1:d.length-1],c.x=i.x-u.x,c.y=i.y-u.y,l=-r.dot(n,c),a=i,i=d[(s.index+1)%d.length],c.x=i.x-u.x,c.y=i.y-u.y,(o=-r.dot(n,c))<l&&(a=i),[s,a]}},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Vertices"),r=e("../geometry/Vector"),s=e("../core/Sleeping"),a=e("../geometry/Bounds"),l=e("../geometry/Axes"),c=e("../core/Common");o._warming=.4,o._torqueDampen=1,o._minLength=1e-6,o.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var n=t.bodyA?r.add(t.bodyA.position,t.pointA):t.pointA,o=t.bodyB?r.add(t.bodyB.position,t.pointB):t.pointB,i=r.magnitude(r.sub(n,o));t.length=void 0!==t.length?t.length:i,t.id=t.id||c.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(0<t.length?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var s={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&.1<t.stiffness?(s.type="pin",s.anchors=!1):t.stiffness<.9&&(s.type="spring"),t.render=c.extend(s,t.render),t},o.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var n=e[t],o=n.constraintImpulse;n.isStatic||0===o.x&&0===o.y&&0===o.angle||(n.position.x+=o.x,n.position.y+=o.y,n.angle+=o.angle)}},o.solveAll=function(e,t){for(var n=0;n<e.length;n+=1){var i=e[n],r=!i.bodyA||i.bodyA&&i.bodyA.isStatic,s=!i.bodyB||i.bodyB&&i.bodyB.isStatic;(r||s)&&o.solve(e[n],t)}for(n=0;n<e.length;n+=1)r=!(i=e[n]).bodyA||i.bodyA&&i.bodyA.isStatic,s=!i.bodyB||i.bodyB&&i.bodyB.isStatic,r||s||o.solve(e[n],t)},o.solve=function(e,t){var n=e.bodyA,i=e.bodyB,s=e.pointA,a=e.pointB;if(n||i){n&&!n.isStatic&&(r.rotate(s,n.angle-e.angleA,s),e.angleA=n.angle),i&&!i.isStatic&&(r.rotate(a,i.angle-e.angleB,a),e.angleB=i.angle);var l=s,c=a;if(n&&(l=r.add(n.position,s)),i&&(c=r.add(i.position,a)),l&&c){var d=r.sub(l,c),u=r.magnitude(d);u<o._minLength&&(u=o._minLength);var p,f,m,v,y,g=(u-e.length)/u,x=e.stiffness<1?e.stiffness*t:e.stiffness,h=r.mult(d,g*x),b=(n?n.inverseMass:0)+(i?i.inverseMass:0),S=b+((n?n.inverseInertia:0)+(i?i.inverseInertia:0));if(e.damping){var C=r.create();m=r.div(d,u),y=r.sub(i&&r.sub(i.position,i.positionPrev)||C,n&&r.sub(n.position,n.positionPrev)||C),v=r.dot(m,y)}n&&!n.isStatic&&(f=n.inverseMass/b,n.constraintImpulse.x-=h.x*f,n.constraintImpulse.y-=h.y*f,n.position.x-=h.x*f,n.position.y-=h.y*f,e.damping&&(n.positionPrev.x-=e.damping*m.x*v*f,n.positionPrev.y-=e.damping*m.y*v*f),p=r.cross(s,h)/S*o._torqueDampen*n.inverseInertia*(1-e.angularStiffness),n.constraintImpulse.angle-=p,n.angle-=p),i&&!i.isStatic&&(f=i.inverseMass/b,i.constraintImpulse.x+=h.x*f,i.constraintImpulse.y+=h.y*f,i.position.x+=h.x*f,i.position.y+=h.y*f,e.damping&&(i.positionPrev.x+=e.damping*m.x*v*f,i.positionPrev.y+=e.damping*m.y*v*f),p=r.cross(a,h)/S*o._torqueDampen*i.inverseInertia*(1-e.angularStiffness),i.constraintImpulse.angle+=p,i.angle+=p)}}},o.postSolveAll=function(e){for(var t=0;t<e.length;t++){var n=e[t],c=n.constraintImpulse;if(!(n.isStatic||0===c.x&&0===c.y&&0===c.angle)){s.set(n,!1);for(var d=0;d<n.parts.length;d++){var u=n.parts[d];i.translate(u.vertices,c),0<d&&(u.position.x+=c.x,u.position.y+=c.y),0!==c.angle&&(i.rotate(u.vertices,c.angle,n.position),l.rotate(u.axes,c.angle),0<d&&r.rotateAbout(u.position,c.angle,n.position,u.position)),a.update(u.bounds,u.vertices,n.velocity)}c.angle*=o._warming,c.x*=o._warming,c.y*=o._warming}}}},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Vertices"),r=e("../core/Sleeping"),s=e("../core/Mouse"),a=e("../core/Events"),l=e("../collision/Detector"),c=e("./Constraint"),d=e("../body/Composite"),u=e("../core/Common"),p=e("../geometry/Bounds");o.create=function(e,t){var n=(e?e.mouse:null)||(t?t.mouse:null);n||(e&&e.render&&e.render.canvas?n=s.create(e.render.canvas):t&&t.element?n=s.create(t.element):(n=s.create(),u.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var r={type:"mouseConstraint",mouse:n,element:null,body:null,constraint:c.create({label:"Mouse Constraint",pointA:n.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},l=u.extend(r,t);return a.on(e,"beforeUpdate",function(){var t=d.allBodies(e.world);o.update(l,t),o._triggerEvents(l)}),l},o.update=function(e,t){var n=e.mouse,o=e.constraint,s=e.body;if(0===n.button){if(o.bodyB)r.set(o.bodyB,!1),o.pointA=n.position;else for(var c=0;c<t.length;c++)if(s=t[c],p.contains(s.bounds,n.position)&&l.canCollide(s.collisionFilter,e.collisionFilter))for(var d=1<s.parts.length?1:0;d<s.parts.length;d++){var u=s.parts[d];if(i.contains(u.vertices,n.position)){o.pointA=n.position,o.bodyB=e.body=s,o.pointB={x:n.position.x-s.position.x,y:n.position.y-s.position.y},o.angleB=s.angle,r.set(s,!1),a.trigger(e,"startdrag",{mouse:n,body:s});break}}}else o.bodyB=e.body=null,o.pointB=null,s&&a.trigger(e,"enddrag",{mouse:n,body:s})},o._triggerEvents=function(e){var t=e.mouse,n=t.sourceEvents;n.mousemove&&a.trigger(e,"mousemove",{mouse:t}),n.mousedown&&a.trigger(e,"mousedown",{mouse:t}),n.mouseup&&a.trigger(e,"mouseup",{mouse:t}),s.clearSourceEvents(t)}},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(e,t,n){(function(n){var o={};t.exports=o,function(){o._nextId=0,o._seed=0,o._nowStartTime=+new Date,o.extend=function(e,t){var n,i;i="boolean"==typeof t?(n=2,t):(n=1,!0);for(var r=n;r<arguments.length;r++){var s=arguments[r];if(s)for(var a in s)i&&s[a]&&s[a].constructor===Object?e[a]&&e[a].constructor!==Object?e[a]=s[a]:(e[a]=e[a]||{},o.extend(e[a],i,s[a])):e[a]=s[a]}return e},o.clone=function(e,t){return o.extend({},t,e)},o.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},o.values=function(e){var t=[];if(Object.keys){for(var n=Object.keys(e),o=0;o<n.length;o++)t.push(e[n[o]]);return t}for(var i in e)t.push(e[i]);return t},o.get=function(e,t,n,o){t=t.split(".").slice(n,o);for(var i=0;i<t.length;i+=1)e=e[t[i]];return e},o.set=function(e,t,n,i,r){var s=t.split(".").slice(i,r);return o.get(e,t,0,-1)[s[s.length-1]]=n},o.shuffle=function(e){for(var t=e.length-1;0<t;t--){var n=Math.floor(o.random()*(t+1)),i=e[t];e[t]=e[n],e[n]=i}return e},o.choose=function(e){return e[Math.floor(o.random()*e.length)]},o.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},o.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.isFunction=function(e){return"function"==typeof e},o.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},o.isString=function(e){return"[object String]"===toString.call(e)},o.clamp=function(e,t,n){return e<t?t:n<e?n:e},o.sign=function(e){return e<0?-1:1},o.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-o._nowStartTime},o.random=function(e,n){return n=void 0!==n?n:1,(e=void 0!==e?e:0)+t()*(n-e)};var t=function(){return o._seed=(9301*o._seed+49297)%233280,o._seed/233280};o.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},o.logLevel=1,o.log=function(){console&&0<o.logLevel&&o.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},o.info=function(){console&&0<o.logLevel&&o.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},o.warn=function(){console&&0<o.logLevel&&o.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},o.nextId=function(){return o._nextId++},o.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},o.map=function(e,t){if(e.map)return e.map(t);for(var n=[],o=0;o<e.length;o+=1)n.push(t(e[o]));return n},o.topologicalSort=function(e){var t=[],n=[],i=[];for(var r in e)n[r]||i[r]||o._topologicalSort(r,n,i,e,t);return t},o._topologicalSort=function(e,t,n,i,r){var s=i[e]||[];n[e]=!0;for(var a=0;a<s.length;a+=1){var l=s[a];n[l]||t[l]||o._topologicalSort(l,t,n,i,r)}n[e]=!1,t[e]=!0,r.push(e)},o.chain=function(){for(var e=[],t=0;t<arguments.length;t+=1){var n=arguments[t];n._chained?e.push.apply(e,n._chained):e.push(n)}var o=function(){for(var t,n=new Array(arguments.length),o=0,i=arguments.length;o<i;o++)n[o]=arguments[o];for(o=0;o<e.length;o+=1){var r=e[o].apply(t,n);void 0!==r&&(t=r)}return t};return o._chained=e,o},o.chainPathBefore=function(e,t,n){return o.set(e,t,o.chain(n,o.get(e,t)))},o.chainPathAfter=function(e,t,n){return o.set(e,t,o.chain(o.get(e,t),n))},o._requireGlobal=function(t,o){return("undefined"!=typeof window?window[t]:void 0!==n?n[t]:null)||e(o)}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(e,t,n){var o={};t.exports=o;var i=e("../body/World"),r=e("./Sleeping"),s=e("../collision/Resolver"),a=e("../render/Render"),l=e("../collision/Pairs"),c=(e("./Metrics"),e("../collision/Grid")),d=e("./Events"),u=e("../body/Composite"),p=e("../constraint/Constraint"),f=e("./Common"),m=e("../body/Body");o.create=function(e,t){t=(t=f.isElement(e)?t:e)||{},((e=f.isElement(e)?e:null)||t.render)&&f.warn("Engine.create: engine.render is deprecated (see docs)");var n={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:c}},o=f.extend(n,t);if(e||o.render){var r={element:e,controller:a};o.render=f.extend(r,o.render)}return o.render&&o.render.controller&&(o.render=o.render.controller.create(o.render)),o.render&&(o.render.engine=o),o.world=t.world||i.create(o.world),o.pairs=l.create(),o.broadphase=o.broadphase.controller.create(o.broadphase),o.metrics=o.metrics||{extended:!1},o},o.update=function(e,t,n){t=t||1e3/60,n=n||1;var i,a=e.world,c=e.timing,f=e.broadphase,m=[];c.timestamp+=t*c.timeScale;var v={timestamp:c.timestamp};d.trigger(e,"beforeUpdate",v);var y=u.allBodies(a),g=u.allConstraints(a);for(e.enableSleeping&&r.update(y,c.timeScale),o._bodiesApplyGravity(y,a.gravity),o._bodiesUpdate(y,t,c.timeScale,n,a.bounds),p.preSolveAll(y),i=0;i<e.constraintIterations;i++)p.solveAll(g,c.timeScale);p.postSolveAll(y),m=f.controller?(a.isModified&&f.controller.clear(f),f.controller.update(f,y,e,a.isModified),f.pairsList):y,a.isModified&&u.setModified(a,!1,!1,!0);var x=f.detector(m,e),h=e.pairs,b=c.timestamp;for(l.update(h,x,b),l.removeOld(h,b),e.enableSleeping&&r.afterCollisions(h.list,c.timeScale),0<h.collisionStart.length&&d.trigger(e,"collisionStart",{pairs:h.collisionStart}),s.preSolvePosition(h.list),i=0;i<e.positionIterations;i++)s.solvePosition(h.list,c.timeScale);for(s.postSolvePosition(y),p.preSolveAll(y),i=0;i<e.constraintIterations;i++)p.solveAll(g,c.timeScale);for(p.postSolveAll(y),s.preSolveVelocity(h.list),i=0;i<e.velocityIterations;i++)s.solveVelocity(h.list,c.timeScale);return 0<h.collisionActive.length&&d.trigger(e,"collisionActive",{pairs:h.collisionActive}),0<h.collisionEnd.length&&d.trigger(e,"collisionEnd",{pairs:h.collisionEnd}),o._bodiesClearForces(y),d.trigger(e,"afterUpdate",v),e},o.merge=function(e,t){if(f.extend(e,t),t.world){e.world=t.world,o.clear(e);for(var n=u.allBodies(e.world),i=0;i<n.length;i++){var s=n[i];r.set(s,!1),s.id=f.nextId()}}},o.clear=function(e){var t=e.world;l.clear(e.pairs);var n=e.broadphase;if(n.controller){var o=u.allBodies(t);n.controller.clear(n),n.controller.update(n,o,e,!0)}},o._bodiesClearForces=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.force.x=0,n.force.y=0,n.torque=0}},o._bodiesApplyGravity=function(e,t){var n=void 0!==t.scale?t.scale:.001;if((0!==t.x||0!==t.y)&&0!==n)for(var o=0;o<e.length;o++){var i=e[o];i.isStatic||i.isSleeping||(i.force.y+=i.mass*t.y*n,i.force.x+=i.mass*t.x*n)}},o._bodiesUpdate=function(e,t,n,o,i){for(var r=0;r<e.length;r++){var s=e[r];s.isStatic||s.isSleeping||m.update(s,t,n,o)}}},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(e,t,n){var o={};t.exports=o;var i=e("./Common");o.on=function(e,t,n){for(var o,i=t.split(" "),r=0;r<i.length;r++)o=i[r],e.events=e.events||{},e.events[o]=e.events[o]||[],e.events[o].push(n);return n},o.off=function(e,t,n){if(t){"function"==typeof t&&(n=t,t=i.keys(e.events).join(" "));for(var o=t.split(" "),r=0;r<o.length;r++){var s=e.events[o[r]],a=[];if(n&&s)for(var l=0;l<s.length;l++)s[l]!==n&&a.push(s[l]);e.events[o[r]]=a}}else e.events={}},o.trigger=function(e,t,n){var o,r,s,a;if(e.events){n||(n={}),o=t.split(" ");for(var l=0;l<o.length;l++)if(r=o[l],s=e.events[r]){(a=i.clone(n,!1)).name=r,a.source=e;for(var c=0;c<s.length;c++)s[c].apply(e,[a])}}}},{"./Common":14}],17:[function(e,t,n){var o={};t.exports=o;var i=e("./Plugin"),r=e("./Common");o.name="matter-js",o.version="0.14.2",o.uses=[],o.used=[],o.use=function(){i.use(o,Array.prototype.slice.call(arguments))},o.before=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathBefore(o,e,t)},o.after=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathAfter(o,e,t)}},{"./Common":14,"./Plugin":20}],18:[function(e,t,n){},{"../body/Composite":2,"./Common":14}],19:[function(e,t,n){var o={};t.exports=o;var i=e("../core/Common");o.create=function(e){var t={};return e||i.log("Mouse.create: element was undefined, defaulting to document.body","warn"),t.element=e||document.body,t.absolute={x:0,y:0},t.position={x:0,y:0},t.mousedownPosition={x:0,y:0},t.mouseupPosition={x:0,y:0},t.offset={x:0,y:0},t.scale={x:1,y:1},t.wheelDelta=0,t.button=-1,t.pixelRatio=t.element.getAttribute("data-pixel-ratio")||1,t.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},t.mousemove=function(e){var n=o._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&(t.button=0,e.preventDefault()),t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.sourceEvents.mousemove=e},t.mousedown=function(e){var n=o._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches?(t.button=0,e.preventDefault()):t.button=e.button,t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mousedownPosition.x=t.position.x,t.mousedownPosition.y=t.position.y,t.sourceEvents.mousedown=e},t.mouseup=function(e){var n=o._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&e.preventDefault(),t.button=-1,t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mouseupPosition.x=t.position.x,t.mouseupPosition.y=t.position.y,t.sourceEvents.mouseup=e},t.mousewheel=function(e){t.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},o.setElement(t,t.element),t},o.setElement=function(e,t){(e.element=t).addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},o.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},o.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},o.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},o._getRelativeMousePosition=function(e,t,n){var o,i,r=t.getBoundingClientRect(),s=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:s.scrollLeft,l=void 0!==window.pageYOffset?window.pageYOffset:s.scrollTop,c=e.changedTouches;return i=c?(o=c[0].pageX-r.left-a,c[0].pageY-r.top-l):(o=e.pageX-r.left-a,e.pageY-r.top-l),{x:o/(t.clientWidth/(t.width||t.clientWidth)*n),y:i/(t.clientHeight/(t.height||t.clientHeight)*n)}}},{"../core/Common":14}],20:[function(e,t,n){var o={};t.exports=o;var i=e("./Common");o._registry={},o.register=function(e){if(o.isPlugin(e)||i.warn("Plugin.register:",o.toString(e),"does not implement all required fields."),e.name in o._registry){var t=o._registry[e.name],n=o.versionParse(e.version).number,r=o.versionParse(t.version).number;r<n?(i.warn("Plugin.register:",o.toString(t),"was upgraded to",o.toString(e)),o._registry[e.name]=e):n<r?i.warn("Plugin.register:",o.toString(t),"can not be downgraded to",o.toString(e)):e!==t&&i.warn("Plugin.register:",o.toString(e),"is already registered to different plugin object")}else o._registry[e.name]=e;return e},o.resolve=function(e){return o._registry[o.dependencyParse(e).name]},o.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},o.isPlugin=function(e){return e&&e.name&&e.version&&e.install},o.isUsed=function(e,t){return-1<e.used.indexOf(t)},o.isFor=function(e,t){var n=e.for&&o.dependencyParse(e.for);return!e.for||t.name===n.name&&o.versionSatisfies(t.version,n.range)},o.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var n=o.dependencies(e),r=i.topologicalSort(n),s=[],a=0;a<r.length;a+=1)if(r[a]!==e.name){var l=o.resolve(r[a]);l?o.isUsed(e,l.name)||(o.isFor(l,e)||(i.warn("Plugin.use:",o.toString(l),"is for",l.for,"but installed on",o.toString(e)+"."),l._warned=!0),l.install?l.install(e):(i.warn("Plugin.use:",o.toString(l),"does not specify an install function."),l._warned=!0),l._warned?(s.push(" "+o.toString(l)),delete l._warned):s.push(" "+o.toString(l)),e.used.push(l.name)):s.push(" "+r[a])}0<s.length&&i.info(s.join("  "))}else i.warn("Plugin.use:",o.toString(e),"does not specify any dependencies to install.")},o.dependencies=function(e,t){var n=o.dependencyParse(e),r=n.name;if(!(r in(t=t||{}))){e=o.resolve(e)||e,t[r]=i.map(e.uses||[],function(t){o.isPlugin(t)&&o.register(t);var r=o.dependencyParse(t),s=o.resolve(t);return s&&!o.versionSatisfies(s.version,r.range)?(i.warn("Plugin.dependencies:",o.toString(s),"does not satisfy",o.toString(r),"used by",o.toString(n)+"."),s._warned=!0,e._warned=!0):s||(i.warn("Plugin.dependencies:",o.toString(t),"used by",o.toString(n),"could not be resolved."),e._warned=!0),r.name});for(var s=0;s<t[r].length;s+=1)o.dependencies(t[r][s],t);return t}},o.dependencyParse=function(e){return i.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(e)||i.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},o.versionParse=function(e){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(e)||i.warn("Plugin.versionParse:",e,"is not a valid version or range.");var t=e.split("-");e=t[0];var n=isNaN(Number(e[0])),o=n?e.substr(1):e,r=i.map(o.split("."),function(e){return Number(e)});return{isRange:n,version:o,range:e,operator:n?e[0]:"",parts:r,prerelease:t[1],number:1e8*r[0]+1e4*r[1]+r[2]}},o.versionSatisfies=function(e,t){t=t||"*";var n=o.versionParse(t),i=n.parts,r=o.versionParse(e),s=r.parts;if(n.isRange){if("*"===n.operator||"*"===e)return!0;if("~"===n.operator)return s[0]===i[0]&&s[1]===i[1]&&s[2]>=i[2];if("^"===n.operator)return 0<i[0]?s[0]===i[0]&&r.number>=n.number:0<i[1]?s[1]===i[1]&&s[2]>=i[2]:s[2]===i[2]}return e===t||"*"===e}},{"./Common":14}],21:[function(e,t,n){var o={};t.exports=o;var i=e("./Events"),r=e("./Engine"),s=e("./Common");!function(){var e,t,n;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e||(e=function(e){n=setTimeout(function(){e(s.now())},1e3/60)},t=function(){clearTimeout(n)});o.create=function(e){var n=s.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return n.delta=n.delta||1e3/n.fps,n.deltaMin=n.deltaMin||1e3/n.fps,n.deltaMax=n.deltaMax||1e3/(.5*n.fps),n.fps=1e3/n.delta,n},o.run=function(t,n){return void 0!==t.positionIterations&&(n=t,t=o.create()),function i(r){t.frameRequestId=e(i),r&&t.enabled&&o.tick(t,n,r)}(),t},o.tick=function(e,t,n){var o,s=t.timing,a=1,l={timestamp:s.timestamp};i.trigger(e,"beforeTick",l),i.trigger(t,"beforeTick",l),e.isFixed?o=e.delta:(o=n-e.timePrev||e.delta,e.timePrev=n,e.deltaHistory.push(o),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),a=(o=(o=(o=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:o)>e.deltaMax?e.deltaMax:o)/e.delta,e.delta=o),0!==e.timeScalePrev&&(a*=s.timeScale/e.timeScalePrev),0===s.timeScale&&(a=0),e.timeScalePrev=s.timeScale,e.correction=a,e.frameCounter+=1,1e3<=n-e.counterTimestamp&&(e.fps=e.frameCounter*((n-e.counterTimestamp)/1e3),e.counterTimestamp=n,e.frameCounter=0),i.trigger(e,"tick",l),i.trigger(t,"tick",l),t.world.isModified&&t.render&&t.render.controller&&t.render.controller.clear&&t.render.controller.clear(t.render),i.trigger(e,"beforeUpdate",l),r.update(t,o,a),i.trigger(e,"afterUpdate",l),t.render&&t.render.controller&&(i.trigger(e,"beforeRender",l),i.trigger(t,"beforeRender",l),t.render.controller.world(t.render),i.trigger(e,"afterRender",l),i.trigger(t,"afterRender",l)),i.trigger(e,"afterTick",l),i.trigger(t,"afterTick",l)},o.stop=function(e){t(e.frameRequestId)},o.start=function(e,t){o.run(e,t)}}()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(e,t,n){var o={};t.exports=o;var i=e("./Events");o._motionWakeThreshold=.18,o._motionSleepThreshold=.08,o._minBias=.9,o.update=function(e,t){for(var n=t*t*t,i=0;i<e.length;i++){var r=e[i],s=r.speed*r.speed+r.angularSpeed*r.angularSpeed;if(0===r.force.x&&0===r.force.y){var a=Math.min(r.motion,s),l=Math.max(r.motion,s);r.motion=o._minBias*a+(1-o._minBias)*l,0<r.sleepThreshold&&r.motion<o._motionSleepThreshold*n?(r.sleepCounter+=1,r.sleepCounter>=r.sleepThreshold&&o.set(r,!0)):0<r.sleepCounter&&(r.sleepCounter-=1)}else o.set(r,!1)}},o.afterCollisions=function(e,t){for(var n=t*t*t,i=0;i<e.length;i++){var r=e[i];if(r.isActive){var s=r.collision,a=s.bodyA.parent,l=s.bodyB.parent;if(!(a.isSleeping&&l.isSleeping||a.isStatic||l.isStatic)&&(a.isSleeping||l.isSleeping)){var c=a.isSleeping&&!a.isStatic?a:l,d=c===a?l:a;!c.isStatic&&d.motion>o._motionWakeThreshold*n&&o.set(c,!1)}}}},o.set=function(e,t){var n=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,n||i.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,n&&i.trigger(e,"sleepEnd"))}},{"./Events":16}],23:[function(e,t,n){var o={};t.exports=o;var i,r=e("../geometry/Vertices"),s=e("../core/Common"),a=e("../body/Body"),l=e("../geometry/Bounds"),c=e("../geometry/Vector");o.rectangle=function(e,t,n,o,i){i=i||{};var l={label:"Rectangle Body",position:{x:e,y:t},vertices:r.fromPath("L 0 0 L "+n+" 0 L "+n+" "+o+" L 0 "+o)};if(i.chamfer){var c=i.chamfer;l.vertices=r.chamfer(l.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete i.chamfer}return a.create(s.extend({},l,i))},o.trapezoid=function(e,t,n,o,i,l){l=l||{};var c,u=n*(i*=.5),p=u+(1-2*i)*n,f=p+u;c=i<.5?"L 0 0 L "+u+" "+-o+" L "+p+" "+-o+" L "+f+" 0":"L 0 0 L "+p+" "+-o+" L "+f+" 0";var m={label:"Trapezoid Body",position:{x:e,y:t},vertices:r.fromPath(c)};if(l.chamfer){var v=l.chamfer;m.vertices=r.chamfer(m.vertices,v.radius,v.quality,v.qualityMin,v.qualityMax),delete l.chamfer}return a.create(s.extend({},m,l))},o.circle=function(e,t,n,i,r){i=i||{};var a={label:"Circle Body",circleRadius:n};r=r||25;var l=Math.ceil(Math.max(10,Math.min(r,n)));return l%2==1&&(l+=1),o.polygon(e,t,l,n,s.extend({},a,i))},o.polygon=function(e,t,n,i,l){if(l=l||{},n<3)return o.circle(e,t,i,l);for(var c=2*Math.PI/n,d="",u=.5*c,p=0;p<n;p+=1){var f=u+p*c,m=Math.cos(f)*i,v=Math.sin(f)*i;d+="L "+m.toFixed(3)+" "+v.toFixed(3)+" "}var y={label:"Polygon Body",position:{x:e,y:t},vertices:r.fromPath(d)};if(l.chamfer){var g=l.chamfer;y.vertices=r.chamfer(y.vertices,g.radius,g.quality,g.qualityMin,g.qualityMax),delete l.chamfer}return a.create(s.extend({},y,l))},o.fromVertices=function(e,t,n,o,d,u,p){var f,m,v,y,g,x,h,b,w;for(i||(i=s._requireGlobal("decomp","poly-decomp")),o=o||{},m=[],d=void 0!==d&&d,u=void 0!==u?u:.01,p=void 0!==p?p:10,i||s.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),s.isArray(n[0])||(n=[n]),b=0;b<n.length;b+=1)if(y=n[b],(v=r.isConvex(y))||!i)y=v?r.clockwiseSort(y):r.hull(y),m.push({position:{x:e,y:t},vertices:y});else{var S=y.map(function(e){return[e.x,e.y]});i.makeCCW(S),!1!==u&&i.removeCollinearPoints(S,u);var C=i.quickDecomp(S);for(g=0;g<C.length;g++){var P=C[g].map(function(e){return{x:e[0],y:e[1]}});0<p&&r.area(P)<p||m.push({position:r.centre(P),vertices:P})}}for(g=0;g<m.length;g++)m[g]=a.create(s.extend(m[g],o));if(d)for(g=0;g<m.length;g++){var B=m[g];for(x=g+1;x<m.length;x++){var M=m[x];if(l.overlaps(B.bounds,M.bounds)){var k=B.vertices,I=M.vertices;for(h=0;h<B.vertices.length;h++)for(w=0;w<M.vertices.length;w++){var _=c.magnitudeSquared(c.sub(k[(h+1)%k.length],I[w])),T=c.magnitudeSquared(c.sub(k[h],I[(w+1)%I.length]));_<5&&T<5&&(k[h].isInternal=!0,I[w].isInternal=!0)}}}}return 1<m.length?(f=a.create(s.extend({parts:m.slice(0)},o)),a.setPosition(f,{x:e,y:t}),f):m[0]}},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(e,t,n){var o={};t.exports=o;var i=e("../body/Composite"),r=e("../constraint/Constraint"),s=e("../core/Common"),a=e("../body/Body"),l=e("./Bodies");o.stack=function(e,t,n,o,r,s,l){for(var c,d=i.create({label:"Stack"}),u=e,p=t,f=0,m=0;m<o;m++){for(var v=0,y=0;y<n;y++){var g=l(u,p,y,m,c,f);if(g){var x=g.bounds.max.y-g.bounds.min.y,h=g.bounds.max.x-g.bounds.min.x;v<x&&(v=x),a.translate(g,{x:.5*h,y:.5*x}),u=g.bounds.max.x+r,i.addBody(d,g),c=g,f+=1}else u+=r}p+=v+s,u=e}return d},o.chain=function(e,t,n,o,a,l){for(var c=e.bodies,d=1;d<c.length;d++){var u=c[d-1],p=c[d],f=u.bounds.max.y-u.bounds.min.y,m=u.bounds.max.x-u.bounds.min.x,v=p.bounds.max.y-p.bounds.min.y,g={bodyA:u,pointA:{x:m*t,y:f*n},bodyB:p,pointB:{x:(p.bounds.max.x-p.bounds.min.x)*o,y:v*a}},x=s.extend(g,l);i.addConstraint(e,r.create(x))}return e.label+=" Chain",e},o.mesh=function(e,t,n,o,a){var l,c,d,u,p,f=e.bodies;for(l=0;l<n;l++){for(c=1;c<t;c++)d=f[c-1+l*t],u=f[c+l*t],i.addConstraint(e,r.create(s.extend({bodyA:d,bodyB:u},a)));if(0<l)for(c=0;c<t;c++)d=f[c+(l-1)*t],u=f[c+l*t],i.addConstraint(e,r.create(s.extend({bodyA:d,bodyB:u},a))),o&&0<c&&(p=f[c-1+(l-1)*t],i.addConstraint(e,r.create(s.extend({bodyA:p,bodyB:u},a)))),o&&c<t-1&&(p=f[c+1+(l-1)*t],i.addConstraint(e,r.create(s.extend({bodyA:p,bodyB:u},a))))}return e.label+=" Mesh",e},o.pyramid=function(e,t,n,i,r,s,l){return o.stack(e,t,n,i,r,s,function(t,o,s,c,d,u){var p=Math.min(i,Math.ceil(n/2)),f=d?d.bounds.max.x-d.bounds.min.x:0;if(!(p<c||s<(c=p-c)||n-1-c<s))return 1===u&&a.translate(d,{x:(s+(n%2==1?1:-1))*f,y:0}),l(e+(d?s*f:0)+s*r,o,s,c,d,u)})},o.newtonsCradle=function(e,t,n,o,s){for(var a=i.create({label:"Newtons Cradle"}),c=0;c<n;c++){var d=l.circle(e+c*(1.9*o),t+s,o,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),u=r.create({pointA:{x:e+c*(1.9*o),y:t},bodyB:d});i.addBody(a,d),i.addConstraint(a,u)}return a},o.car=function(e,t,n,o,s){var c=a.nextGroup(!0),d=.5*-n+20,u=.5*n-20,p=i.create({label:"Car"}),f=l.rectangle(e,t,n,o,{collisionFilter:{group:c},chamfer:{radius:.5*o},density:2e-4}),m=l.circle(e+d,t+0,s,{collisionFilter:{group:c},friction:.8}),v=l.circle(e+u,t+0,s,{collisionFilter:{group:c},friction:.8}),y=r.create({bodyB:f,pointB:{x:d,y:0},bodyA:m,stiffness:1,length:0}),g=r.create({bodyB:f,pointB:{x:u,y:0},bodyA:v,stiffness:1,length:0});return i.addBody(p,f),i.addBody(p,m),i.addBody(p,v),i.addConstraint(p,y),i.addConstraint(p,g),p},o.softBody=function(e,t,n,i,r,a,c,d,u,p){u=s.extend({inertia:1/0},u),p=s.extend({stiffness:.2,render:{type:"line",anchors:!1}},p);var f=o.stack(e,t,n,i,r,a,function(e,t){return l.circle(e,t,d,u)});return o.mesh(f,n,i,c,p),f.label="Soft Body",f}},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Vector"),r=e("../core/Common");o.fromVertices=function(e){for(var t={},n=0;n<e.length;n++){var o=(n+1)%e.length,s=i.normalise({x:e[o].y-e[n].y,y:e[n].x-e[o].x}),a=0===s.y?1/0:s.x/s.y;t[a=a.toFixed(3).toString()]=s}return r.values(t)},o.rotate=function(e,t){if(0!==t)for(var n=Math.cos(t),o=Math.sin(t),i=0;i<e.length;i++){var r,s=e[i];r=s.x*n-s.y*o,s.y=s.x*o+s.y*n,s.x=r}}},{"../core/Common":14,"../geometry/Vector":28}],26:[function(e,t,n){var o={};(t.exports=o).create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&o.update(t,e),t},o.update=function(e,t,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var o=0;o<t.length;o++){var i=t[o];i.x>e.max.x&&(e.max.x=i.x),i.x<e.min.x&&(e.min.x=i.x),i.y>e.max.y&&(e.max.y=i.y),i.y<e.min.y&&(e.min.y=i.y)}n&&(0<n.x?e.max.x+=n.x:e.min.x+=n.x,0<n.y?e.max.y+=n.y:e.min.y+=n.y)},o.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},o.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},o.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},o.shift=function(e,t){var n=e.max.x-e.min.x,o=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+n,e.min.y=t.y,e.max.y=t.y+o}},{}],27:[function(e,t,n){var o={};t.exports=o;var i=(e("../geometry/Bounds"),e("../core/Common"));o.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||i.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,r,s,a,l,c,d,u,p,m,v,y=[],g=0,x=0,h=0;function b(e,t,n){var o=n%2==1&&1<n;if(!p||e!=p.x||t!=p.y){v=p&&o?(m=p.x,p.y):m=0;var i={x:m+e,y:v+t};!o&&p||(p=i),y.push(i),x=m+e,h=v+t}}function w(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":x=e.x,h=e.y;break;case"H":x=e.x;break;case"V":h=e.y}b(x,h,e.pathSegType)}}for(t=t||15,o._svgPathToAbsolute(e),s=e.getTotalLength(),c=[],n=0;n<e.pathSegList.numberOfItems;n+=1)c.push(e.pathSegList.getItem(n));for(d=c.concat();g<s;){if((l=c[e.getPathSegAtLength(g)])!=u){for(;d.length&&d[0]!=l;)w(d.shift());u=l}switch(l.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=e.getPointAtLength(g),b(a.x,a.y,0)}g+=t}for(n=0,r=d.length;n<r;++n)w(d[n]);return y},o._svgPathToAbsolute=function(e){for(var t,n,o,i,r,s,a=e.pathSegList,l=0,c=0,d=a.numberOfItems,u=0;u<d;++u){var p=a.getItem(u),f=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(f))"x"in p&&(l=p.x),"y"in p&&(c=p.y);else switch("x1"in p&&(o=l+p.x1),"x2"in p&&(r=l+p.x2),"y1"in p&&(i=c+p.y1),"y2"in p&&(s=c+p.y2),"x"in p&&(l+=p.x),"y"in p&&(c+=p.y),f){case"m":a.replaceItem(e.createSVGPathSegMovetoAbs(l,c),u);break;case"l":a.replaceItem(e.createSVGPathSegLinetoAbs(l,c),u);break;case"h":a.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(l),u);break;case"v":a.replaceItem(e.createSVGPathSegLinetoVerticalAbs(c),u);break;case"c":a.replaceItem(e.createSVGPathSegCurvetoCubicAbs(l,c,o,i,r,s),u);break;case"s":a.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(l,c,r,s),u);break;case"q":a.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(l,c,o,i),u);break;case"t":a.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(l,c),u);break;case"a":a.replaceItem(e.createSVGPathSegArcAbs(l,c,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),u);break;case"z":case"Z":l=t,c=n}"M"!=f&&"m"!=f||(t=l,n=c)}}},{"../core/Common":14,"../geometry/Bounds":26}],28:[function(e,t,n){var o={};(t.exports=o).create=function(e,t){return{x:e||0,y:t||0}},o.clone=function(e){return{x:e.x,y:e.y}},o.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},o.rotate=function(e,t,n){var o=Math.cos(t),i=Math.sin(t);n||(n={});var r=e.x*o-e.y*i;return n.y=e.x*i+e.y*o,n.x=r,n},o.rotateAbout=function(e,t,n,o){var i=Math.cos(t),r=Math.sin(t);o||(o={});var s=n.x+((e.x-n.x)*i-(e.y-n.y)*r);return o.y=n.y+((e.x-n.x)*r+(e.y-n.y)*i),o.x=s,o},o.normalise=function(e){var t=o.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},o.dot=function(e,t){return e.x*t.x+e.y*t.y},o.cross=function(e,t){return e.x*t.y-e.y*t.x},o.cross3=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)},o.add=function(e,t,n){return n||(n={}),n.x=e.x+t.x,n.y=e.y+t.y,n},o.sub=function(e,t,n){return n||(n={}),n.x=e.x-t.x,n.y=e.y-t.y,n},o.mult=function(e,t){return{x:e.x*t,y:e.y*t}},o.div=function(e,t){return{x:e.x/t,y:e.y/t}},o.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},o.neg=function(e){return{x:-e.x,y:-e.y}},o.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},o._temp=[o.create(),o.create(),o.create(),o.create(),o.create(),o.create()]},{}],29:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Vector"),r=e("../core/Common");o.create=function(e,t){for(var n=[],o=0;o<e.length;o++){var i=e[o],r={x:i.x,y:i.y,index:o,body:t,isInternal:!1};n.push(r)}return n},o.fromPath=function(e,t){var i=[];return e.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(e,t,n){i.push({x:parseFloat(t),y:parseFloat(n)})}),o.create(i,t)},o.centre=function(e){for(var t,n,r,s=o.area(e,!0),a={x:0,y:0},l=0;l<e.length;l++)r=(l+1)%e.length,t=i.cross(e[l],e[r]),n=i.mult(i.add(e[l],e[r]),t),a=i.add(a,n);return i.div(a,6*s)},o.mean=function(e){for(var t={x:0,y:0},n=0;n<e.length;n++)t.x+=e[n].x,t.y+=e[n].y;return i.div(t,e.length)},o.area=function(e,t){for(var n=0,o=e.length-1,i=0;i<e.length;i++)n+=(e[o].x-e[i].x)*(e[o].y+e[i].y),o=i;return t?n/2:Math.abs(n)/2},o.inertia=function(e,t){for(var n,o,r=0,s=0,a=e,l=0;l<a.length;l++)o=(l+1)%a.length,r+=(n=Math.abs(i.cross(a[o],a[l])))*(i.dot(a[o],a[o])+i.dot(a[o],a[l])+i.dot(a[l],a[l])),s+=n;return t/6*(r/s)},o.translate=function(e,t,n){var o;if(n)for(o=0;o<e.length;o++)e[o].x+=t.x*n,e[o].y+=t.y*n;else for(o=0;o<e.length;o++)e[o].x+=t.x,e[o].y+=t.y;return e},o.rotate=function(e,t,n){if(0!==t){for(var o=Math.cos(t),i=Math.sin(t),r=0;r<e.length;r++){var s=e[r],a=s.x-n.x,l=s.y-n.y;s.x=n.x+(a*o-l*i),s.y=n.y+(a*i+l*o)}return e}},o.contains=function(e,t){for(var n=0;n<e.length;n++){var o=e[n],i=e[(n+1)%e.length];if(0<(t.x-o.x)*(i.y-o.y)+(t.y-o.y)*(o.x-i.x))return!1}return!0},o.scale=function(e,t,n,r){if(1===t&&1===n)return e;r=r||o.centre(e);for(var s,a,l=0;l<e.length;l++)s=e[l],a=i.sub(s,r),e[l].x=r.x+a.x*t,e[l].y=r.y+a.y*n;return e},o.chamfer=function(e,t,n,o,s){t="number"==typeof t?[t]:t||[8],n=void 0!==n?n:-1,o=o||2,s=s||14;for(var a=[],l=0;l<e.length;l++){var c=e[0<=l-1?l-1:e.length-1],d=e[l],u=e[(l+1)%e.length],p=t[l<t.length?l:t.length-1];if(0!==p){var f=i.normalise({x:d.y-c.y,y:c.x-d.x}),m=i.normalise({x:u.y-d.y,y:d.x-u.x}),v=Math.sqrt(2*Math.pow(p,2)),y=i.mult(r.clone(f),p),g=i.normalise(i.mult(i.add(f,m),.5)),x=i.sub(d,i.mult(g,v)),h=n;-1===n&&(h=1.75*Math.pow(p,.32)),(h=r.clamp(h,o,s))%2==1&&(h+=1);for(var w=Math.acos(i.dot(f,m))/h,S=0;S<h;S++)a.push(i.add(i.rotate(y,w*S),x))}else a.push(d)}return a},o.clockwiseSort=function(e){var t=o.mean(e);return e.sort(function(e,n){return i.angle(t,e)-i.angle(t,n)}),e},o.isConvex=function(e){var t,n,o,i,r=0,s=e.length;if(s<3)return null;for(t=0;t<s;t++)if(o=(t+2)%s,i=(e[n=(t+1)%s].x-e[t].x)*(e[o].y-e[n].y),(i-=(e[n].y-e[t].y)*(e[o].x-e[n].x))<0?r|=1:0<i&&(r|=2),3===r)return!1;return 0!==r||null},o.hull=function(e){var t,n,o=[],r=[];for((e=e.slice(0)).sort(function(e,t){var n=e.x-t.x;return 0!=n?n:e.y-t.y}),n=0;n<e.length;n+=1){for(t=e[n];2<=r.length&&i.cross3(r[r.length-2],r[r.length-1],t)<=0;)r.pop();r.push(t)}for(n=e.length-1;0<=n;n-=1){for(t=e[n];2<=o.length&&i.cross3(o[o.length-2],o[o.length-1],t)<=0;)o.pop();o.push(t)}return o.pop(),r.pop(),o.concat(r)}},{"../core/Common":14,"../geometry/Vector":28}],30:[function(e,t,n){var o=t.exports=e("../core/Matter");o.Body=e("../body/Body"),o.Composite=e("../body/Composite"),o.World=e("../body/World"),o.Contact=e("../collision/Contact"),o.Detector=e("../collision/Detector"),o.Grid=e("../collision/Grid"),o.Pairs=e("../collision/Pairs"),o.Pair=e("../collision/Pair"),o.Query=e("../collision/Query"),o.Resolver=e("../collision/Resolver"),o.SAT=e("../collision/SAT"),o.Constraint=e("../constraint/Constraint"),o.MouseConstraint=e("../constraint/MouseConstraint"),o.Common=e("../core/Common"),o.Engine=e("../core/Engine"),o.Events=e("../core/Events"),o.Mouse=e("../core/Mouse"),o.Runner=e("../core/Runner"),o.Sleeping=e("../core/Sleeping"),o.Plugin=e("../core/Plugin"),o.Bodies=e("../factory/Bodies"),o.Composites=e("../factory/Composites"),o.Axes=e("../geometry/Axes"),o.Bounds=e("../geometry/Bounds"),o.Svg=e("../geometry/Svg"),o.Vector=e("../geometry/Vector"),o.Vertices=e("../geometry/Vertices"),o.Render=e("../render/Render"),o.RenderPixi=e("../render/RenderPixi"),o.World.add=o.Composite.add,o.World.remove=o.Composite.remove,o.World.addComposite=o.Composite.addComposite,o.World.addBody=o.Composite.addBody,o.World.addConstraint=o.Composite.addConstraint,o.World.clear=o.Composite.clear,o.Engine.run=o.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(e,t,n){var o={};t.exports=o;var i=e("../core/Common"),r=e("../body/Composite"),s=e("../geometry/Bounds"),a=e("../core/Events"),l=e("../collision/Grid"),c=e("../geometry/Vector"),d=e("../core/Mouse");!function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(i.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),o.create=function(e){var t={controller:o,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},r=i.extend(t,e);return r.canvas&&(r.canvas.width=r.options.width||r.canvas.width,r.canvas.height=r.options.height||r.canvas.height),r.mouse=e.mouse,r.engine=e.engine,r.canvas=r.canvas||n(r.options.width,r.options.height),r.context=r.canvas.getContext("2d"),r.textures={},r.bounds=r.bounds||{min:{x:0,y:0},max:{x:r.canvas.width,y:r.canvas.height}},1!==r.options.pixelRatio&&o.setPixelRatio(r,r.options.pixelRatio),i.isElement(r.element)?r.element.appendChild(r.canvas):r.canvas.parentNode||i.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),r},o.run=function(t){!function n(i){t.frameRequestId=e(n),o.world(t)}()},o.stop=function(e){t(e.frameRequestId)},o.setPixelRatio=function(e,t){var n=e.options,o=e.canvas;"auto"===t&&(t=u(o)),n.pixelRatio=t,o.setAttribute("data-pixel-ratio",t),o.width=n.width*t,o.height=n.height*t,o.style.width=n.width+"px",o.style.height=n.height+"px",e.context.scale(t,t)},o.lookAt=function(e,t,n,o){o=void 0===o||o,t=i.isArray(t)?t:[t],n=n||{x:0,y:0};for(var r={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},s=0;s<t.length;s+=1){var a=t[s],l=a.bounds?a.bounds.min:a.min||a.position||a,c=a.bounds?a.bounds.max:a.max||a.position||a;l&&c&&(l.x<r.min.x&&(r.min.x=l.x),c.x>r.max.x&&(r.max.x=c.x),l.y<r.min.y&&(r.min.y=l.y),c.y>r.max.y&&(r.max.y=c.y))}var u=r.max.x-r.min.x+2*n.x,p=r.max.y-r.min.y+2*n.y,f=e.canvas.height,v=e.canvas.width/f,y=u/p,g=1,x=1;v<y?x=y/v:g=v/y,e.options.hasBounds=!0,e.bounds.min.x=r.min.x,e.bounds.max.x=r.min.x+u*g,e.bounds.min.y=r.min.y,e.bounds.max.y=r.min.y+p*x,o&&(e.bounds.min.x+=.5*u-u*g*.5,e.bounds.max.x+=.5*u-u*g*.5,e.bounds.min.y+=.5*p-p*x*.5,e.bounds.max.y+=.5*p-p*x*.5),e.bounds.min.x-=n.x,e.bounds.max.x-=n.x,e.bounds.min.y-=n.y,e.bounds.max.y-=n.y,e.mouse&&(d.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),d.setOffset(e.mouse,e.bounds.min))},o.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,n=e.bounds.max.y-e.bounds.min.y,o=t/e.options.width,i=n/e.options.height;e.context.scale(1/o,1/i),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},o.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},o.world=function(e){var t,n=e.engine,i=n.world,u=e.canvas,p=e.context,m=e.options,v=r.allBodies(i),y=r.allConstraints(i),g=m.wireframes?m.wireframeBackground:m.background,x=[],h=[],b={timestamp:n.timing.timestamp};if(a.trigger(e,"beforeRender",b),e.currentBackground!==g&&f(e,g),p.globalCompositeOperation="source-in",p.fillStyle="transparent",p.fillRect(0,0,u.width,u.height),p.globalCompositeOperation="source-over",m.hasBounds){for(t=0;t<v.length;t++){var w=v[t];s.overlaps(w.bounds,e.bounds)&&x.push(w)}for(t=0;t<y.length;t++){var S=y[t],C=S.bodyA,A=S.bodyB,P=S.pointA,B=S.pointB;C&&(P=c.add(C.position,S.pointA)),A&&(B=c.add(A.position,S.pointB)),P&&B&&(s.contains(e.bounds,P)||s.contains(e.bounds,B))&&h.push(S)}o.startViewTransform(e),e.mouse&&(d.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),d.setOffset(e.mouse,e.bounds.min))}else h=y,x=v;!m.wireframes||n.enableSleeping&&m.showSleeping?o.bodies(e,x,p):(m.showConvexHulls&&o.bodyConvexHulls(e,x,p),o.bodyWireframes(e,x,p)),m.showBounds&&o.bodyBounds(e,x,p),(m.showAxes||m.showAngleIndicator)&&o.bodyAxes(e,x,p),m.showPositions&&o.bodyPositions(e,x,p),m.showVelocity&&o.bodyVelocity(e,x,p),m.showIds&&o.bodyIds(e,x,p),m.showSeparations&&o.separations(e,n.pairs.list,p),m.showCollisions&&o.collisions(e,n.pairs.list,p),m.showVertexNumbers&&o.vertexNumbers(e,x,p),m.showMousePosition&&o.mousePosition(e,e.mouse,p),o.constraints(h,p),m.showBroadphase&&n.broadphase.controller===l&&o.grid(e,n.broadphase,p),m.showDebug&&o.debug(e,p),m.hasBounds&&o.endViewTransform(e),a.trigger(e,"afterRender",b)},o.debug=function(e,t){var n=t,o=e.engine,i=o.world,s=o.metrics,a=e.options;if(r.allBodies(i),500<=o.timing.timestamp-(e.debugTimestamp||0)){var l="";s.timing&&(l+="fps: "+Math.round(s.timing.fps)+"    "),e.debugString=l,e.debugTimestamp=o.timing.timestamp}if(e.debugString){n.font="12px Arial",a.wireframes?n.fillStyle="rgba(255,255,255,0.5)":n.fillStyle="rgba(0,0,0,0.5)";for(var c=e.debugString.split("\n"),d=0;d<c.length;d++)n.fillText(c[d],50,50+18*d)}},o.constraints=function(e,t){for(var n=t,o=0;o<e.length;o++){var r=e[o];if(r.render.visible&&r.pointA&&r.pointB){var s,a,l=r.bodyA,d=r.bodyB;if(s=l?c.add(l.position,r.pointA):r.pointA,"pin"===r.render.type)n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.closePath();else{if(a=d?c.add(d.position,r.pointB):r.pointB,n.beginPath(),n.moveTo(s.x,s.y),"spring"===r.render.type)for(var u,p=c.sub(a,s),f=c.perp(c.normalise(p)),m=Math.ceil(i.clamp(r.length/5,12,20)),v=1;v<m;v+=1)u=v%2==0?1:-1,n.lineTo(s.x+p.x*(v/m)+f.x*u*4,s.y+p.y*(v/m)+f.y*u*4);n.lineTo(a.x,a.y)}r.render.lineWidth&&(n.lineWidth=r.render.lineWidth,n.strokeStyle=r.render.strokeStyle,n.stroke()),r.render.anchors&&(n.fillStyle=r.render.strokeStyle,n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.arc(a.x,a.y,3,0,2*Math.PI),n.closePath(),n.fill())}}},o.bodyShadows=function(e,t,n){for(var o=n,i=(e.engine,0);i<t.length;i++){var r=t[i];if(r.render.visible){if(r.circleRadius)o.beginPath(),o.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI),o.closePath();else{o.beginPath(),o.moveTo(r.vertices[0].x,r.vertices[0].y);for(var s=1;s<r.vertices.length;s++)o.lineTo(r.vertices[s].x,r.vertices[s].y);o.closePath()}var a=r.position.x-.5*e.options.width,l=r.position.y-.2*e.options.height,c=Math.abs(a)+Math.abs(l);o.shadowColor="rgba(0,0,0,0.15)",o.shadowOffsetX=.05*a,o.shadowOffsetY=.05*l,o.shadowBlur=1+12*Math.min(1,c/1e3),o.fill(),o.shadowColor=null,o.shadowOffsetX=null,o.shadowOffsetY=null,o.shadowBlur=null}}},o.bodies=function(e,t,n){var o,i,r,s,a=n,l=(e.engine,e.options),c=l.showInternalEdges||!l.wireframes;for(r=0;r<t.length;r++)if((o=t[r]).render.visible)for(s=1<o.parts.length?1:0;s<o.parts.length;s++)if((i=o.parts[s]).render.visible){if(l.showSleeping&&o.isSleeping?a.globalAlpha=.5*i.render.opacity:1!==i.render.opacity&&(a.globalAlpha=i.render.opacity),i.render.sprite&&i.render.sprite.texture&&!l.wireframes){var d=i.render.sprite,u=p(e,d.texture);a.translate(i.position.x,i.position.y),a.rotate(i.angle),a.drawImage(u,u.width*-d.xOffset*d.xScale,u.height*-d.yOffset*d.yScale,u.width*d.xScale,u.height*d.yScale),a.rotate(-i.angle),a.translate(-i.position.x,-i.position.y)}else{if(i.circleRadius)a.beginPath(),a.arc(i.position.x,i.position.y,i.circleRadius,0,2*Math.PI);else{a.beginPath(),a.moveTo(i.vertices[0].x,i.vertices[0].y);for(var f=1;f<i.vertices.length;f++)!i.vertices[f-1].isInternal||c?a.lineTo(i.vertices[f].x,i.vertices[f].y):a.moveTo(i.vertices[f].x,i.vertices[f].y),i.vertices[f].isInternal&&!c&&a.moveTo(i.vertices[(f+1)%i.vertices.length].x,i.vertices[(f+1)%i.vertices.length].y);a.lineTo(i.vertices[0].x,i.vertices[0].y),a.closePath()}l.wireframes?(a.lineWidth=1,a.strokeStyle="#bbb",a.stroke()):(a.fillStyle=i.render.fillStyle,i.render.lineWidth&&(a.lineWidth=i.render.lineWidth,a.strokeStyle=i.render.strokeStyle,a.stroke()),a.fill())}a.globalAlpha=1}},o.bodyWireframes=function(e,t,n){var o,i,r,s,a,l=n,c=e.options.showInternalEdges;for(l.beginPath(),r=0;r<t.length;r++)if((o=t[r]).render.visible)for(a=1<o.parts.length?1:0;a<o.parts.length;a++){for(i=o.parts[a],l.moveTo(i.vertices[0].x,i.vertices[0].y),s=1;s<i.vertices.length;s++)!i.vertices[s-1].isInternal||c?l.lineTo(i.vertices[s].x,i.vertices[s].y):l.moveTo(i.vertices[s].x,i.vertices[s].y),i.vertices[s].isInternal&&!c&&l.moveTo(i.vertices[(s+1)%i.vertices.length].x,i.vertices[(s+1)%i.vertices.length].y);l.lineTo(i.vertices[0].x,i.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()},o.bodyConvexHulls=function(e,t,n){var o,i,r,s=n;for(s.beginPath(),i=0;i<t.length;i++)if((o=t[i]).render.visible&&1!==o.parts.length){for(s.moveTo(o.vertices[0].x,o.vertices[0].y),r=1;r<o.vertices.length;r++)s.lineTo(o.vertices[r].x,o.vertices[r].y);s.lineTo(o.vertices[0].x,o.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},o.vertexNumbers=function(e,t,n){var o,i,r,s=n;for(o=0;o<t.length;o++){var a=t[o].parts;for(r=1<a.length?1:0;r<a.length;r++){var l=a[r];for(i=0;i<l.vertices.length;i++)s.fillStyle="rgba(255,255,255,0.2)",s.fillText(o+"_"+i,l.position.x+.8*(l.vertices[i].x-l.position.x),l.position.y+.8*(l.vertices[i].y-l.position.y))}}},o.mousePosition=function(e,t,n){var o=n;o.fillStyle="rgba(255,255,255,0.8)",o.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},o.bodyBounds=function(e,t,n){var o=n,i=(e.engine,e.options);o.beginPath();for(var r=0;r<t.length;r++)if(t[r].render.visible)for(var s=t[r].parts,a=1<s.length?1:0;a<s.length;a++){var l=s[a];o.rect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}i.wireframes?o.strokeStyle="rgba(255,255,255,0.08)":o.strokeStyle="rgba(0,0,0,0.1)",o.lineWidth=1,o.stroke()},o.bodyAxes=function(e,t,n){var o,i,r,s,a=n,l=(e.engine,e.options);for(a.beginPath(),i=0;i<t.length;i++){var c=t[i],d=c.parts;if(c.render.visible)if(l.showAxes)for(r=1<d.length?1:0;r<d.length;r++)for(o=d[r],s=0;s<o.axes.length;s++){var u=o.axes[s];a.moveTo(o.position.x,o.position.y),a.lineTo(o.position.x+20*u.x,o.position.y+20*u.y)}else for(r=1<d.length?1:0;r<d.length;r++)for(o=d[r],s=0;s<o.axes.length;s++)a.moveTo(o.position.x,o.position.y),a.lineTo((o.vertices[0].x+o.vertices[o.vertices.length-1].x)/2,(o.vertices[0].y+o.vertices[o.vertices.length-1].y)/2)}l.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},o.bodyPositions=function(e,t,n){var o,i,r,s,a=n,l=(e.engine,e.options);for(a.beginPath(),r=0;r<t.length;r++)if((o=t[r]).render.visible)for(s=0;s<o.parts.length;s++)i=o.parts[s],a.arc(i.position.x,i.position.y,3,0,2*Math.PI,!1),a.closePath();for(l.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),r=0;r<t.length;r++)(o=t[r]).render.visible&&(a.arc(o.positionPrev.x,o.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},o.bodyVelocity=function(e,t,n){var o=n;o.beginPath();for(var i=0;i<t.length;i++){var r=t[i];r.render.visible&&(o.moveTo(r.position.x,r.position.y),o.lineTo(r.position.x+2*(r.position.x-r.positionPrev.x),r.position.y+2*(r.position.y-r.positionPrev.y)))}o.lineWidth=3,o.strokeStyle="cornflowerblue",o.stroke()},o.bodyIds=function(e,t,n){var o,i,r=n;for(o=0;o<t.length;o++)if(t[o].render.visible){var s=t[o].parts;for(i=1<s.length?1:0;i<s.length;i++){var a=s[i];r.font="12px Arial",r.fillStyle="rgba(255,255,255,0.5)",r.fillText(a.id,a.position.x+10,a.position.y-10)}}},o.collisions=function(e,t,n){var o,i,r,s,a=n,l=e.options;for(a.beginPath(),r=0;r<t.length;r++)if((o=t[r]).isActive)for(i=o.collision,s=0;s<o.activeContacts.length;s++){var d=o.activeContacts[s].vertex;a.rect(d.x-1.5,d.y-1.5,3.5,3.5)}for(l.wireframes?a.fillStyle="rgba(255,255,255,0.7)":a.fillStyle="orange",a.fill(),a.beginPath(),r=0;r<t.length;r++)if((o=t[r]).isActive&&(i=o.collision,0<o.activeContacts.length)){var u=o.activeContacts[0].vertex.x,p=o.activeContacts[0].vertex.y;2===o.activeContacts.length&&(u=(o.activeContacts[0].vertex.x+o.activeContacts[1].vertex.x)/2,p=(o.activeContacts[0].vertex.y+o.activeContacts[1].vertex.y)/2),i.bodyB===i.supports[0].body||!0===i.bodyA.isStatic?a.moveTo(u-8*i.normal.x,p-8*i.normal.y):a.moveTo(u+8*i.normal.x,p+8*i.normal.y),a.lineTo(u,p)}l.wireframes?a.strokeStyle="rgba(255,165,0,0.7)":a.strokeStyle="orange",a.lineWidth=1,a.stroke()},o.separations=function(e,t,n){var o,i,r,s,a,l=n,c=e.options;for(l.beginPath(),a=0;a<t.length;a++)if((o=t[a]).isActive){r=(i=o.collision).bodyA;var d=1;(s=i.bodyB).isStatic||r.isStatic||(d=.5),s.isStatic&&(d=0),l.moveTo(s.position.x,s.position.y),l.lineTo(s.position.x-i.penetration.x*d,s.position.y-i.penetration.y*d),d=1,s.isStatic||r.isStatic||(d=.5),r.isStatic&&(d=0),l.moveTo(r.position.x,r.position.y),l.lineTo(r.position.x+i.penetration.x*d,r.position.y+i.penetration.y*d)}c.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},o.grid=function(e,t,n){var o=n;e.options.wireframes?o.strokeStyle="rgba(255,180,0,0.1)":o.strokeStyle="rgba(255,180,0,0.5)",o.beginPath();for(var r=i.keys(t.buckets),s=0;s<r.length;s++){var a=r[s];if(!(t.buckets[a].length<2)){var l=a.split(/C|R/);o.rect(.5+parseInt(l[1],10)*t.bucketWidth,.5+parseInt(l[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}}o.lineWidth=1,o.stroke()},o.inspector=function(e,t){var n,o=(e.engine,e.selected),i=e.render,r=i.options;if(r.hasBounds){var s=i.bounds.max.x-i.bounds.min.x,a=i.bounds.max.y-i.bounds.min.y,l=s/i.options.width,c=a/i.options.height;t.scale(1/l,1/c),t.translate(-i.bounds.min.x,-i.bounds.min.y)}for(var d=0;d<o.length;d++){var u=o[d].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),u.type){case"body":n=u.bounds,t.beginPath(),t.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var p=u.pointA;u.bodyA&&(p=u.pointB),t.beginPath(),t.arc(p.x,p.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",n=e.selectBounds,t.beginPath(),t.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),r.hasBounds&&t.setTransform(1,0,0,1,0,0)};var n=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},u=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},p=function(e,t){var n=e.textures[t];return n||((n=e.textures[t]=new Image).src=t,n)},f=function(e,t){var n=t;/(jpg|gif|png)$/.test(t)&&(n="url("+t+")"),e.canvas.style.background=n,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(e,t,n){var o={};t.exports=o;var i=e("../geometry/Bounds"),r=e("../body/Composite"),s=e("../core/Common"),a=e("../core/Events"),l=e("../geometry/Vector");!function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(s.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),o.create=function(e){s.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var t={controller:o,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},n=s.extend(t,e),i=!n.options.wireframes&&"transparent"===n.options.background;return n.pixiOptions=n.pixiOptions||{view:n.canvas,transparent:i,antialias:!0,backgroundColor:e.background},n.mouse=e.mouse,n.engine=e.engine,n.renderer=n.renderer||new PIXI.WebGLRenderer(n.options.width,n.options.height,n.pixiOptions),n.container=n.container||new PIXI.Container,n.spriteContainer=n.spriteContainer||new PIXI.Container,n.canvas=n.canvas||n.renderer.view,n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.options.width,y:n.options.height}},a.on(n.engine,"beforeUpdate",function(){o.clear(n)}),n.textures={},n.sprites={},n.primitives={},n.container.addChild(n.spriteContainer),s.isElement(n.element)?n.element.appendChild(n.canvas):s.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),n.canvas.oncontextmenu=function(){return!1},n.canvas.onselectstart=function(){return!1},n},o.run=function(t){!function n(i){t.frameRequestId=e(n),o.world(t)}()},o.stop=function(e){t(e.frameRequestId)},o.clear=function(e){for(var t=e.container,n=e.spriteContainer;t.children[0];)t.removeChild(t.children[0]);for(;n.children[0];)n.removeChild(n.children[0]);var o=e.sprites["bg-0"];e.textures={},e.sprites={},e.primitives={},(e.sprites["bg-0"]=o)&&t.addChildAt(o,0),e.container.addChild(e.spriteContainer),e.currentBackground=null,t.scale.set(1,1),t.position.set(0,0)},o.setBackground=function(e,t){if(e.currentBackground!==t){var n=t.indexOf&&-1!==t.indexOf("#"),o=e.sprites["bg-0"];if(n){var i=s.colorToNumber(t);e.renderer.backgroundColor=i,o&&e.container.removeChild(o)}else if(!o){var r=d(e,t);(o=e.sprites["bg-0"]=new PIXI.Sprite(r)).position.x=0,o.position.y=0,e.container.addChildAt(o,0)}e.currentBackground=t}},o.world=function(e){var t,s=e.engine.world,a=e.renderer,c=e.container,d=e.options,u=r.allBodies(s),p=r.allConstraints(s),f=[];d.wireframes?o.setBackground(e,d.wireframeBackground):o.setBackground(e,d.background);var m=e.bounds.max.x-e.bounds.min.x,v=e.bounds.max.y-e.bounds.min.y,y=m/e.options.width,g=v/e.options.height;if(d.hasBounds){for(t=0;t<u.length;t++){var x=u[t];x.render.sprite.visible=i.overlaps(x.bounds,e.bounds)}for(t=0;t<p.length;t++){var h=p[t],b=h.bodyA,w=h.bodyB,S=h.pointA,C=h.pointB;b&&(S=l.add(b.position,h.pointA)),w&&(C=l.add(w.position,h.pointB)),S&&C&&(i.contains(e.bounds,S)||i.contains(e.bounds,C))&&f.push(h)}c.scale.set(1/y,1/g),c.position.set(-e.bounds.min.x*(1/y),-e.bounds.min.y*(1/g))}else f=p;for(t=0;t<u.length;t++)o.body(e,u[t]);for(t=0;t<f.length;t++)o.constraint(e,f[t]);a.render(c)},o.constraint=function(e,t){var n=(e.engine,t.bodyA),o=t.bodyB,i=t.pointA,r=t.pointB,a=e.container,l=t.render,c="c-"+t.id,d=e.primitives[c];d||(d=e.primitives[c]=new PIXI.Graphics),l.visible&&t.pointA&&t.pointB?(-1===s.indexOf(a.children,d)&&a.addChild(d),d.clear(),d.beginFill(0,0),d.lineStyle(l.lineWidth,s.colorToNumber(l.strokeStyle),1),n?d.moveTo(n.position.x+i.x,n.position.y+i.y):d.moveTo(i.x,i.y),o?d.lineTo(o.position.x+r.x,o.position.y+r.y):d.lineTo(r.x,r.y),d.endFill()):d.clear()},o.body=function(e,t){var o=(e.engine,t.render);if(o.visible)if(o.sprite&&o.sprite.texture){var i="b-"+t.id,r=e.sprites[i],a=e.spriteContainer;r||(r=e.sprites[i]=n(e,t)),-1===s.indexOf(a.children,r)&&a.addChild(r),r.position.x=t.position.x,r.position.y=t.position.y,r.rotation=t.angle,r.scale.x=o.sprite.xScale||1,r.scale.y=o.sprite.yScale||1}else{var l="b-"+t.id,d=e.primitives[l],u=e.container;d||((d=e.primitives[l]=c(e,t)).initialAngle=t.angle),-1===s.indexOf(u.children,d)&&u.addChild(d),d.position.x=t.position.x,d.position.y=t.position.y,d.rotation=t.angle-d.initialAngle}};var n=function(e,t){var o=t.render.sprite.texture,i=d(e,o),r=new PIXI.Sprite(i);return r.anchor.x=t.render.sprite.xOffset,r.anchor.y=t.render.sprite.yOffset,r},c=function(e,t){var n,o=t.render,i=e.options,r=new PIXI.Graphics,a=s.colorToNumber(o.fillStyle),l=s.colorToNumber(o.strokeStyle),c=s.colorToNumber(o.strokeStyle),d=s.colorToNumber("#bbb"),u=s.colorToNumber("#CD5C5C");r.clear();for(var p=1<t.parts.length?1:0;p<t.parts.length;p++){n=t.parts[p],i.wireframes?(r.beginFill(0,0),r.lineStyle(1,d,1)):(r.beginFill(a,1),r.lineStyle(o.lineWidth,l,1)),r.moveTo(n.vertices[0].x-t.position.x,n.vertices[0].y-t.position.y);for(var f=1;f<n.vertices.length;f++)r.lineTo(n.vertices[f].x-t.position.x,n.vertices[f].y-t.position.y);r.lineTo(n.vertices[0].x-t.position.x,n.vertices[0].y-t.position.y),r.endFill(),(i.showAngleIndicator||i.showAxes)&&(r.beginFill(0,0),i.wireframes?r.lineStyle(1,u,1):r.lineStyle(1,c),r.moveTo(n.position.x-t.position.x,n.position.y-t.position.y),r.lineTo((n.vertices[0].x+n.vertices[n.vertices.length-1].x)/2-t.position.x,(n.vertices[0].y+n.vertices[n.vertices.length-1].y)/2-t.position.y),r.endFill())}return r},d=function(e,t){var n=e.textures[t];return n||(n=e.textures[t]=PIXI.Texture.fromImage(t)),n}}()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["pixi-tiledmap"]=e():t["pixi-tiledmap"]=e()}(window,function(){return t=[function(t,e){var n,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,l=[],h=!1,f=-1;function c(){h&&u&&(h=!1,u.length?l=u.concat(l):f=-1,l.length&&d())}function d(){if(!h){var t=o(c);h=!0;for(var e=l.length;e;){for(u=l,l=[];++f<e;)u&&u[f].run();f=-1,e=l.length}u=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function _(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||h||o(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||eval("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){var r=n(27),i=n(28),a=n(14);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"!=typeof t)return l(this,t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}function l(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=c(t,e),t}(t,e,n,r):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=o(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|d(e.length);return 0===(t=o(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?o(t,0):c(t,e);if("Buffer"===e.type&&a(e.data))return c(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(h(e),t=o(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function c(t,e){var n=e.length<0?0:0|d(e.length);t=o(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(r)return z(t).length;e=(""+e).toLowerCase(),r=!0}}function _(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){var a,s=1,o=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o/=s=2,u/=2,n/=2}function l(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var h=-1;for(a=n;a<o;a++)if(l(t,a)===l(e,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===u)return h*s}else-1!==h&&(a-=a-h),h=-1}else for(o<n+u&&(n=o-u),a=n;0<=a;a--){for(var f=!0,c=0;c<u;c++)if(l(t,a+c)!==l(e,c)){f=!1;break}if(f)return a}return-1}function m(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");a/2<r&&(r=a/2);for(var s=0;s<r;++s){var o=parseInt(e.substr(2*s,2),16);if(isNaN(o))return s;t[n+s]=o}return s}function y(t,e,n,r){return Z(z(e,t.length-n),t,n,r)}function w(t,e,n,r){return Z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function v(t,e,n,r){return w(t,e,n,r)}function E(t,e,n,r){return Z(j(e),t,n,r)}function T(t,e,n,r){return Z(function(t,e){for(var n,r,i,a=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,a.push(i),a.push(r);return a}(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function k(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var a,s,o,u,l=t[i],h=null,f=239<l?4:223<l?3:191<l?2:1;if(i+f<=n)switch(f){case 1:l<128&&(h=l);break;case 2:128==(192&(a=t[i+1]))&&127<(u=(31&l)<<6|63&a)&&(h=u);break;case 3:a=t[i+1],s=t[i+2],128==(192&a)&&128==(192&s)&&2047<(u=(15&l)<<12|(63&a)<<6|63&s)&&(u<55296||57343<u)&&(h=u);break;case 4:a=t[i+1],s=t[i+2],o=t[i+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&65535<(u=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&o)&&u<1114112&&(h=u)}null===h?(h=65533,f=1):65535<h&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=f}return function(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=I));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){return+t!=t&&(t=0),u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return l(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return h(e),e<=0?o(t,e):void 0!==n?"string"==typeof r?o(t,e).fill(n,r):o(t,e).fill(n):o(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return f(null,t)},u.allocUnsafeSlow=function(t){return f(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(n=e=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_(this,e,e+3),_(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_(this,e,e+7),_(this,e+1,e+6),_(this,e+2,e+5),_(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?k(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,n);case"utf8":case"utf-8":return k(this,e,n);case"ascii":return S(this,e,n);case"latin1":case"binary":return x(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=e)return 0;if(i<=r)return-1;if(n<=e)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),o=Math.min(a,s),l=this.slice(r,i),h=t.slice(e,n),f=0;f<o;++f)if(l[f]!==h[f]){a=l[f],s=h[f];break}return a<s?-1:s<a?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||i<n)&&(n=i),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return m(this,t,e,n);case"utf8":case"utf-8":return y(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return v(this,t,e,n);case"base64":return E(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function S(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function x(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function O(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||r<n)&&(n=r);for(var i="",a=e;a<n;++a)i+=U(t[a]);return i}function N(t,e,n){for(var r=t.slice(e,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,n,r,i,a){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-n,2);i<a;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function P(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-n,4);i<a;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function C(t,e,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(t,e,n,r,a){return a||C(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function M(t,e,n,r,a){return a||C(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t+--e],i=1;0<e&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=e,i=1,a=this[t+--r];0<r&&(i*=256);)a+=this[t+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},u.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||L(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||L(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[e+i]=255&t;0<=--i&&(a*=256);)this[e+i]=t/a&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):P(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);L(this,t,e,n,i-1,-i)}var a=0,s=1,o=0;for(this[e]=255&t;++a<n&&(s*=256);)t<0&&0===o&&0!==this[e+a-1]&&(o=1),this[e+a]=(t/s>>0)-o&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);L(this,t,e,n,i-1,-i)}var a=n-1,s=1,o=0;for(this[e+a]=255&t;0<=--a&&(s*=256);)t<0&&0===o&&0!==this[e+a+1]&&(o=1),this[e+a]=(t/s>>0)-o&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):P(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return F(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return F(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return M(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return M(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),0<r&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,a=r-n;if(this===t&&n<e&&e<r)for(i=a-1;0<=i;--i)t[i+e]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var s=u.isBuffer(t)?t:z(new u(t,r).toString()),o=s.length;for(a=0;a<n-e;++a)this[a+e]=s[a%o]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var n;e=e||1/0;for(var r=t.length,i=null,a=[],s=0;s<r;++s){if(55295<(n=t.charCodeAt(s))&&n<57344){if(!i){if(56319<n){-1<(e-=3)&&a.push(239,191,189);continue}if(s+1===r){-1<(e-=3)&&a.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(e-=3)&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(e-=3)&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function j(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(1))},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;function n(){}n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";var r=n(6),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=f;var a=n(5);a.inherits=n(3);var s=n(16),o=n(12);a.inherits(f,s);for(var u=i(o.prototype),l=0;l<u.length;l++){var h=u[l];f.prototype[h]||(f.prototype[h]=o.prototype[h])}function f(t){if(!(this instanceof f))return new f(t);s.call(this,t),o.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c)}function c(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),f.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,n){(function(t){function n(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===n(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===n(t)},e.isError=function(t){return"[object Error]"===n(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(2).Buffer)},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var a,s,o=arguments.length;switch(o){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(a=new Array(o-1),s=0;s<a.length;)a[s++]=arguments[s];return e.nextTick(function(){t.apply(null,a)})}}}:t.exports=e}).call(this,n(0))},function(t,e,n){var r=n(2),i=r.Buffer;function a(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(a(r,e),e.Buffer=s),a(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(t[r]=n[r])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){var e,n,r,i,a,s;for(e=r=0,n=t.length;e<n;e++)r+=t[e].length;for(s=new Uint8Array(r),e=i=0,n=t.length;e<n;e++)a=t[e],s.set(a,i),i+=a.length;return s}},s={arraySet:function(t,e,n,r,i){for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,a)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(r)},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;0<=r;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;)t.unshift("..");return t}function i(t){return r.exec(t).slice(1)}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function a(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,i=arguments.length-1;-1<=i&&!r;i--){var s=0<=i?arguments[i]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(e=s+"/"+e,r="/"===s.charAt(0))}return(r?"/":"")+(e=n(a(e.split("/"),function(t){return!!t}),!r).join("/"))||"."},e.normalize=function(t){var r=e.isAbsolute(t),i="/"===s(t,-1);return(t=n(a(t.split("/"),function(t){return!!t}),!r).join("/"))||r||(t="."),t&&i&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(a(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;0<=n&&""===t[n];n--);return n<e?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),a=r(n.split("/")),s=Math.min(i.length,a.length),o=s,u=0;u<s;u++)if(i[u]!==a[u]){o=u;break}var l=[];for(u=o;u<i.length;u++)l.push("..");return(l=l.concat(a.slice(o))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=i(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},e.basename=function(t,e){var n=i(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return i(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(0))},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,s,o,u,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var h=new Error('Uncaught, unspecified "error" event. ('+e+")");throw h.context=e,h}if(a(n=this._events[t]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(i(n))for(o=Array.prototype.slice.call(arguments,1),s=(l=n.slice()).length,u=0;u<s;u++)l[u].apply(this,o);return!0},n.prototype.on=n.prototype.addListener=function(t,e){var s;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(s=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<s&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},n.prototype.removeListener=function(t,e){var n,a,s,o;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,a=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(o=s;0<o--;)if(n[o]===e||n[o].listener&&n[o].listener===e){a=o;break}if(a<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(a,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){(((e=t.exports=n(16)).Stream=e).Readable=e).Writable=n(12),e.Duplex=n(4),e.Transform=n(19),e.PassThrough=n(36)},function(t,e,n){"use strict";(function(e,r,i){var a=n(6);function s(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(void 0),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=m;var o,u=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?r:a.nextTick;m.WritableState=b;var l=n(5);l.inherits=n(3);var p,h={deprecate:n(35)},f=n(17),c=n(7).Buffer,d=i.Uint8Array||function(){},_=n(18);function g(){}function b(t,e){o=o||n(4),t=t||{};var r=e instanceof o;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,l=t.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(l||0===l)?l:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=(this.destroyed=!1)===t.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(a.nextTick(i,r),a.nextTick(A,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),A(t,e))}(t,n,r,e,i);else{var s=E(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||v(t,n),r?u(w,t,n,s,i):w(t,n,s,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function m(t){if(o=o||n(4),!(p.call(m,this)||this instanceof o))return new m(t);this._writableState=new b(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),f.call(this)}function y(t,e,n,r,i,a,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,a,e.onwrite),e.sync=!1}function w(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),A(t,e)}function v(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),a=e.corkedRequestsFree;a.entry=n;for(var o=0,u=!0;n;)(i[o]=n).isBuf||(u=!1),n=n.next,o+=1;i.allBuffers=u,y(t,e,!0,e.length,i,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new s(e),e.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,h=n.encoding,f=n.callback;if(y(t,e,!1,e.objectMode?1:l.length,l,h,f),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function E(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function T(t,e){t._final(function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),A(t,e)})}function A(t,e){var n=E(e);return n&&(function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,a.nextTick(T,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}l.inherits(m,f),b.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(b.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(t){return!!p.call(this,t)||this===m&&t&&t._writableState instanceof b}})):p=function(t){return t instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(t,e,n){var r=this._writableState,i=!1,s=!r.objectMode&&function(t){return c.isBuffer(t)||t instanceof d}(t);return s&&!c.isBuffer(t)&&(t=function(t){return c.from(t)}(t)),"function"==typeof e&&(n=e,e=null),s?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=g),r.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),a.nextTick(e,n)}(this,n):(s||function(t,e,n,r){var i=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),a.nextTick(r,s),i=!1),i}(this,r,t,n))&&(r.pendingcb++,i=function(t,e,n,r,i,a){if(!n){var s=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=c.from(e,n)),e}(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var o=e.objectMode?1:r.length;e.length+=o;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else y(t,e,!1,o,r,i,a);return u}(this,r,s,t,e,n)),i},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||v(this,t))},m.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,e=t=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,A(t,e),n&&(e.finished?a.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),m.prototype.destroy=_.destroy,m.prototype._undestroy=_.undestroy,m.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(0),n(33).setImmediate,n(1))},function(t,e,n){"use strict";var r=n(7).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=l,e=4;break;case"utf8":this.fillLast=o,e=4;break;case"base64":this.text=h,this.end=f,e=3;break;default:return this.write=c,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function o(t){var e=this.lastTotal-this.lastNeed,n=function(t,e){if(128!=(192&e[0]))return t.lastNeed=0,"";if(1<t.lastNeed&&1<e.length){if(128!=(192&e[1]))return t.lastNeed=1,"";if(2<t.lastNeed&&2<e.length&&128!=(192&e[2]))return t.lastNeed=2,""}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){if((t.length-e)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1);var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}function l(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function h(t,e){var n=(t.length-e)%3;return 0==n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function f(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function c(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}(e.StringDecoder=a).prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},a.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e},a.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);return 0<=i?(0<i&&(t.lastNeed=i-1),i):--r<n||-2===i?0:0<=(i=s(e[r]))?(0<i&&(t.lastNeed=i-2),i):--r<n||-2===i?0:0<=(i=s(e[r]))?(0<i&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){t.exports=i;var r=n(10).EventEmitter;function i(){r.call(this)}n(3)(i,r),i.Readable=n(11),i.Writable=n(37),i.Duplex=n(38),i.Transform=n(39),i.PassThrough=n(40),(i.Stream=i).prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",a),t._isStdio||e&&!1===e.end||(n.on("end",o),n.on("close",u));var s=!1;function o(){s||(s=!0,t.end())}function u(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function l(t){if(h(),0===r.listenerCount(this,"error"))throw t}function h(){n.removeListener("data",i),t.removeListener("drain",a),n.removeListener("end",o),n.removeListener("close",u),n.removeListener("error",l),t.removeListener("error",l),n.removeListener("end",h),n.removeListener("close",h),t.removeListener("close",h)}return n.on("error",l),t.on("error",l),n.on("end",h),n.on("close",h),t.on("close",h),t.emit("pipe",n),t}},function(t,e,n){"use strict";(function(e,r){var i=n(6);t.exports=y;var a,s=n(14);y.ReadableState=m,n(10).EventEmitter;function o(t,e){return t.listeners(e).length}var u=n(17),l=n(7).Buffer,h=e.Uint8Array||function(){},f=n(5);f.inherits=n(3);var c=n(30),d=void 0;d=c&&c.debuglog?c.debuglog("stream"):function(){};var p,_=n(31),g=n(18);f.inherits(y,u);var b=["error","close","destroy","pause","resume"];function m(t,e){t=t||{};var r=e instanceof(a=a||n(4));this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,s=t.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new _,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=n(13).StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function y(t){if(a=a||n(4),!(this instanceof y))return new y(t);this._readableState=new m(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function w(t,e,n,r,i){var a,s=t._readableState;return null===e?(s.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,A(t)}}(t,s)):(i||(a=function(t,e){var n;return function(t){return l.isBuffer(t)||t instanceof h}(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(s,e)),a?t.emit("error",a):s.objectMode||e&&0<e.length?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===l.prototype||(e=function(t){return l.from(t)}(e)),r?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):v(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?v(t,s,e,!1):I(t,s)):v(t,s,e,!1))):r||(s.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(s)}function v(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&A(t)),I(t,e)}Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),y.prototype.destroy=g.destroy,y.prototype._undestroy=g.undestroy,y.prototype._destroy=function(t,e){this.push(null),e(t)},y.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=l.from(t,e),e=""),n=!0),w(this,t,e,!1,n)},y.prototype.unshift=function(t){return w(this,t,null,!0,!1)},y.prototype.isPaused=function(){return!1===this._readableState.flowing},y.prototype.setEncoding=function(t){return p||(p=n(13).StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};var E=8388608;function T(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return E<=t?t=E:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function A(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(d("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(k,t):k(t))}function k(t){d("emit readable"),t.emit("readable"),N(t)}function I(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(S,t,e))}function S(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(d("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function x(t){d("readable nexttick read 0"),t.read(0)}function O(t,e){e.reading||(d("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),N(t),e.flowing&&!e.reading&&t.read(0)}function N(t){var e=t._readableState;for(d("flow",e.flowing);e.flowing&&null!==t.read(););}function R(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;for(t-=i.length;n=n.next;){var a=n.data,s=t>a.length?a.length:t;if(s===a.length?i+=a:i+=a.slice(0,t),0==(t-=s)){s===a.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n).data=a.slice(s);break}++r}return e.length-=r,i}(t,e):function(t,e){var n=l.allocUnsafe(t),r=e.head,i=1;for(r.data.copy(n),t-=r.data.length;r=r.next;){var a=r.data,s=t>a.length?a.length:t;if(a.copy(n,n.length-t,0,s),0==(t-=s)){s===a.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r).data=a.slice(s);break}++i}return e.length-=i,n}(t,e),r}(t,e.buffer,e.decoder),n);var n}function L(t){var e=t._readableState;if(0<e.length)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(D,e,t))}function D(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function P(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}y.prototype.read=function(t){d("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return d("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?L(this):A(this),null;if(0===(t=T(t,e))&&e.ended)return 0===e.length&&L(this),null;var r,i=e.needReadable;return d("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&d("length less than watermark",i=!0),e.ended||e.reading?d("reading or ended",i=!1):i&&(d("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=T(n,e))),null===(r=0<t?R(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&L(this)),null!==r&&this.emit("data",r),r},y.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},y.prototype.pipe=function(t,e){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=t;break;case 1:a.pipes=[a.pipes,t];break;default:a.pipes.push(t)}a.pipesCount+=1,d("pipe count=%d opts=%j",a.pipesCount,e);var u=e&&!1===e.end||t===r.stdout||t===r.stderr?y:h;function h(){d("onend"),t.end()}a.endEmitted?i.nextTick(u):n.once("end",u),t.on("unpipe",function l(e,r){d("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,d("cleanup"),t.removeListener("close",b),t.removeListener("finish",m),t.removeListener("drain",f),t.removeListener("error",g),t.removeListener("unpipe",l),n.removeListener("end",h),n.removeListener("end",y),n.removeListener("data",_),c=!0,!a.awaitDrain||t._writableState&&!t._writableState.needDrain||f())});var f=function(t){return function(){var e=t._readableState;d("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,N(t))}}(n);t.on("drain",f);var c=!1,p=!1;function _(e){d("ondata"),(p=!1)!==t.write(e)||p||((1===a.pipesCount&&a.pipes===t||1<a.pipesCount&&-1!==P(a.pipes,t))&&!c&&(d("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(e){d("onerror",e),y(),t.removeListener("error",g),0===o(t,"error")&&t.emit("error",e)}function b(){t.removeListener("finish",m),y()}function m(){d("onfinish"),t.removeListener("close",b),y()}function y(){d("unpipe"),n.unpipe(t)}return n.on("data",_),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?s(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",g),t.once("close",b),t.once("finish",m),t.emit("pipe",n),a.flowing||(d("pipe resume"),n.resume()),t},y.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var s=P(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},y.prototype.addListener=y.prototype.on=function(t,e){var n=u.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&A(this):i.nextTick(x,this))}return n},y.prototype.resume=function(){var t=this._readableState;return t.flowing||(d("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(O,t,e))}(this,t)),this},y.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},y.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",function(){if(d("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){d("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||!(n.objectMode||i&&i.length)||e.push(i)||(r=!0,t.pause())}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var a=0;a<b.length;a++)t.on(b[a],this.emit.bind(this,b[a]));return this._read=function(e){d("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),y._fromList=R}).call(this,n(1),n(0))},function(t,e,n){t.exports=n(10).EventEmitter},function(t,e,n){"use strict";var r=n(6);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,a=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return a||s?e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";t.exports=a;var r=n(4),i=n(5);function a(t){if(!(this instanceof a))return new a(t);r.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,(n.writecb=null)!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush(function(e,n){o(t,e,n)}):o(this,null,null)}function o(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(3),i.inherits(a,r),a.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},a.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},a.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},function(t,e,n){"use strict";(function(e){function r(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=n(21),s=Object.prototype.hasOwnProperty,o=Array.prototype.slice,u="foo"===function(){}.name;function l(t){return Object.prototype.toString.call(t)}function h(t){return!i(t)&&"function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var f=t.exports=b,c=/\s*function\s+([^\(\s]*)\s*/;function d(t){if(a.isFunction(t)){if(u)return t.name;var e=t.toString().match(c);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function _(t){if(u||!a.isFunction(t))return a.inspect(t);var e=d(t);return"[Function"+(e?": "+e:"")+"]"}function g(t,e,n,r,i){throw new f.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function b(t,e){t||g(t,!0,e,"==",f.ok)}function m(t,e,n,s){if(t===e)return!0;if(i(t)&&i(e))return 0===r(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(h(t)&&h(e)&&l(t)===l(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;var u=(s=s||{actual:[],expected:[]}).actual.indexOf(t);return-1!==u&&u===s.expected.indexOf(e)||(s.actual.push(t),s.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=y(t),s=y(e);if(i&&!s||!i&&s)return!1;if(i)return m(t=o.call(t),e=o.call(e),n);var u,l,h=E(t),f=E(e);if(h.length!==f.length)return!1;for(h.sort(),f.sort(),l=h.length-1;0<=l;l--)if(h[l]!==f[l])return!1;for(l=h.length-1;0<=l;l--)if(!m(t[u=h[l]],e[u],n,r))return!1;return!0}(t,e,n,s))}return n?t===e:t==e}function y(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function w(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function v(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&g(i,n,"Missing expected exception"+r);var s="string"==typeof r,u=!t&&i&&!n;if((!t&&a.isError(i)&&s&&w(i,n)||u)&&g(i,n,"Got unwanted exception"+r),t&&i&&n&&!w(i,n)||!t&&i)throw i}f.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return p(_(t.actual),128)+" "+t.operator+" "+p(_(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=d(e),a=r.indexOf("\n"+i);if(0<=a){var s=r.indexOf("\n",a+1);r=r.substring(s+1)}this.stack=r}}},a.inherits(f.AssertionError,Error),f.fail=g,f.ok=b,f.equal=function(t,e,n){t!=e&&g(t,e,n,"==",f.equal)},f.notEqual=function(t,e,n){t==e&&g(t,e,n,"!=",f.notEqual)},f.deepEqual=function(t,e,n){m(t,e,!1)||g(t,e,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(t,e,n){m(t,e,!0)||g(t,e,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(t,e,n){m(t,e,!1)&&g(t,e,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function t(e,n,r){m(e,n,!0)&&g(e,n,r,"notDeepStrictEqual",t)},f.strictEqual=function(t,e,n){t!==e&&g(t,e,n,"===",f.strictEqual)},f.notStrictEqual=function(t,e,n){t===e&&g(t,e,n,"!==",f.notStrictEqual)},f.throws=function(t,e,n){v(!0,t,e,n)},f.doesNotThrow=function(t,e,n){v(!1,t,e,n)},f.ifError=function(t){if(t)throw t};var E=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n(1))},function(t,e,n){(function(t,r){var i=/%[sdj%]/g;e.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,a=r.length,s=String(t).replace(i,function(t){if("%%"===t)return"%";if(a<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),u=r[n];n<a;u=r[++n])_(u)||!w(u)?s+=" "+u:s+=" "+o(u);return s},e.deprecate=function(n,i){if(m(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var a=!1;return function(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return n.apply(this,arguments)}};var a,s={};function o(t,n){var r={seen:[],stylize:l};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),m(r.showHidden)&&(r.showHidden=!1),m(r.depth)&&(r.depth=2),m(r.colors)&&(r.colors=!1),m(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),h(r,t,r.depth)}function u(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function l(t,e){return t}function h(t,n,r){if(t.customInspect&&n&&T(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return b(i)||(i=h(t,i,r)),i}var a=function(t,e){if(m(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):p(e)?t.stylize(""+e,"boolean"):_(e)?t.stylize("null","null"):void 0}(t,n);if(a)return a;var s=Object.keys(n),o=function(){var e={};return s.forEach(function(t,n){e[t]=!0}),e}();if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),E(n)&&(0<=s.indexOf("message")||0<=s.indexOf("description")))return f(n);if(0===s.length){if(T(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(y(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(v(n))return t.stylize(Date.prototype.toString.call(n),"date");if(E(n))return f(n)}var l,w="",A=!1,k=["{","}"];return d(n)&&(A=!0,k=["[","]"]),T(n)&&(w=" [Function"+(n.name?": "+n.name:"")+"]"),y(n)&&(w=" "+RegExp.prototype.toString.call(n)),v(n)&&(w=" "+Date.prototype.toUTCString.call(n)),E(n)&&(w=" "+f(n)),0!==s.length||A&&0!=n.length?r<0?y(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=A?function(t,e,n,r,i){for(var a=[],s=0,o=e.length;s<o;++s)S(e,String(s))?a.push(c(t,e,n,r,String(s),!0)):a.push("");return i.forEach(function(i){i.match(/^\d+$/)||a.push(c(t,e,n,r,i,!0))}),a}(t,n,r,o,s):s.map(function(e){return c(t,n,r,o,e,A)}),t.seen.pop(),function(t,e,n){return 60<t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(l,w,k)):k[0]+w+k[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function c(t,e,n,r,i,a){var s,o,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?o=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(o=t.stylize("[Setter]","special")),S(r,i)||(s="["+i+"]"),o||(t.seen.indexOf(u.value)<0?-1<(o=_(n)?h(t,u.value,null):h(t,u.value,n-1)).indexOf("\n")&&(o=a?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=t.stylize("[Circular]","special")),m(s)){if(a&&i.match(/^\d+$/))return o;s=(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(s,"string"))}return s+": "+o}function d(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function _(t){return null===t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function m(t){return void 0===t}function y(t){return w(t)&&"[object RegExp]"===A(t)}function w(t){return"object"==typeof t&&null!==t}function v(t){return w(t)&&"[object Date]"===A(t)}function E(t){return w(t)&&("[object Error]"===A(t)||t instanceof Error)}function T(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function k(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(m(a)&&(a=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(a)){var n=r.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},(e.inspect=o).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=p,e.isNull=_,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=b,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=m,e.isRegExp=y,e.isObject=w,e.isDate=v,e.isError=E,e.isFunction=T,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(44);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[k(t.getHours()),k(t.getMinutes()),k(t.getSeconds())].join(":");return[t.getDate(),I[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(3),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(1),n(0))},function(t,e,n){"use strict";t.exports=function(t,e,n,r){for(var i=65535&t|0,a=t>>>16&65535|0,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;a=a+(i=i+e[r++]|0)|0,--s;);i%=65521,a%=65521}return i|a<<16|0}},function(t,e,n){"use strict";var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=function(t,e,n,i){var a=r,s=i+n;t^=-1;for(var o=i;o<s;o++)t=t>>>8^a[255&(t^e[o])];return-1^t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(25)),i=a(n(54));function a(t){return t&&t.__esModule?t:{default:t}}PIXI.loaders.Loader.addPixiMiddleware(r.default),PIXI.loader.use((0,r.default)()),e.default=PIXI.extras.TiledMap=i.default,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(9)),i=a(n(26));function a(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){var n=this;if(!t.data||t.type!==PIXI.loaders.Resource.TYPE.XML||!t.data.childNodes[0].getElementsByTagName("tileset"))return e();var a=r.default.dirname(t.url.replace(this.baseUrl,"")),s={crossOrigin:t.crossOrigin,loadType:PIXI.loaders.Resource.LOAD_TYPE.IMAGE,parentResource:t};i.default.parse(t.xhr.responseText,a,function(r,i){if(r)throw r;i.tileSets.forEach(function(t){t.image.source in n.resources||n.add(t.image.source,a+"/"+t.image.source,s)}),t.data=i,e()})}},t.exports=e.default},function(t,e,n){(function(t){var r=n(29),i=n(41),a=n(9),s=n(42),o=n(53);e.readFile=function(t,e){i.readFile(t,{encoding:"utf8"},e)},e.parseFile=D,e.parse=L,e.Map=U,e.TileSet=z,e.Image=j,e.Tile=Z,e.TileLayer=G,e.ObjectLayer=Y,e.ImageLayer=H,e.TmxObject=W,e.Terrain=q;var u=2147483648,l=1073741824,h=536870912,f=0,c=f++,d=f++,p=f++,_=f++,g=f++,b=f++,m=f++,y=f++,w=f++,v=f++,E=f++,T=f++,A=f++,k=f++,I=f++,S=f++,x=f++,O=f++,N=f++,R=f++;function L(e,n,i){var L,V,X,K,Q,J,$=a.dirname(n),tt=r.parser(),et=null,nt=c,rt=new Array(f),it=0,at=0,st=null,ot=0,ut=null,lt=0,ht=null,ft=0,ct=0,dt=null,pt=0,_t=new o,gt=[];function bt(t){return dt.terrainTypes[parseInt(t,10)]}function mt(t){X.horizontalFlips[ct]=!!(t&u),X.verticalFlips[ct]=!!(t&l),X.diagonalFlips[ct]=!!(t&h),t&=~(u|l|h),J.tiles[ct]=t,ct+=1}function yt(t){var e=new j;return e.format=t.attributes.FORMAT,e.source=t.attributes.SOURCE,e.trans=t.attributes.TRANS,e.width=F(t.attributes.WIDTH),e.height=F(t.attributes.HEIGHT),Et(),e}function wt(t,e){(dt=new z).firstGid=F(t.attributes.FIRSTGID),dt.source=t.attributes.SOURCE,dt.name=t.attributes.NAME,dt.tileWidth=F(t.attributes.TILEWIDTH),dt.tileHeight=F(t.attributes.TILEHEIGHT),dt.spacing=F(t.attributes.SPACING),dt.margin=F(t.attributes.MARGIN),dt.source&&_t.go(function(t){!function(t,e){D(a.join($,t.source),function(n,r){n?e(n):(r.mergeTo(t),e())})}(dt,t)}),nt=m,pt=e}function vt(t){st=t,ot=nt,nt=p}function Et(){it=nt,nt=b,at=1}function Tt(t){tt.onerror=null,tt.onopentag=null,tt.onclosetag=null,tt.ontext=null,tt.onend=null,i(t)}function At(t){for(var e=0;e<t.tiles.length;e+=1)for(var n=t.tiles[e],r=L.tileSets.length-1;0<=r;r-=1){var i=L.tileSets[r];if(i.firstGid<=n){var a=n-i.firstGid,s=i.tiles[a];s||((s=new Z).id=a,i.tiles[a]=s),s.gid=n,t.layer.tiles[e]=s;break}}}function kt(t){var e=L.width*L.height*4;if(t.length===e)for(var n=ct=0;n<e;n+=4)mt(t.readUInt32LE(n));else Tt(new Error("Expected "+e+" bytes of tile data; received "+t.length))}rt[c]={opentag:function(t){"MAP"===t.name?(L=new U,(et=L).version=t.attributes.VERSION,L.orientation=t.attributes.ORIENTATION,L.width=F(t.attributes.WIDTH),L.height=F(t.attributes.HEIGHT),L.tileWidth=F(t.attributes.TILEWIDTH),L.tileHeight=F(t.attributes.TILEHEIGHT),L.backgroundColor=t.attributes.BACKGROUNDCOLOR,nt=d):"TILESET"===t.name?(wt(t,c),et=dt):Et()},closetag:C,text:C},rt[d]={opentag:function(t){switch(t.name){case"PROPERTIES":vt(L.properties);break;case"TILESET":wt(t,d),L.tileSets.push(dt);break;case"LAYER":X=new G(L),ct=0,X.name=t.attributes.NAME,X.opacity=B(t.attributes.OPACITY,1),X.visible=M(t.attributes.VISIBLE,!0),L.layers.push(X),J={layer:X,tiles:new Array(L.width*L.height)},gt.push(J),nt=w;break;case"OBJECTGROUP":(X=new Y).name=t.attributes.NAME,X.color=t.attributes.COLOR,X.opacity=B(t.attributes.OPACITY,1),X.visible=M(t.attributes.VISIBLE,!0),L.layers.push(X),nt=v;break;case"IMAGELAYER":(X=new H).name=t.attributes.NAME,X.x=F(t.attributes.X),X.y=F(t.attributes.Y),X.opacity=B(t.attributes.OPACITY,1),X.visible=M(t.attributes.VISIBLE,!0),L.layers.push(X),nt=A;break;default:Et()}},closetag:C,text:C},rt[m]={opentag:function(t){switch(t.name){case"TILEOFFSET":dt.tileOffset.x=F(t.attributes.X),dt.tileOffset.y=F(t.attributes.Y),Et();break;case"PROPERTIES":vt(dt.properties);break;case"IMAGE":dt.image=yt(t);break;case"TERRAINTYPES":nt=N;break;case"TILE":if((V=new Z).id=F(t.attributes.ID),t.attributes.TYPE&&(V.type=t.attributes.TYPE),t.attributes.TERRAIN){var e=t.attributes.TERRAIN.split(",");V.terrain=e.map(bt)}V.probability=B(t.attributes.PROBABILITY),dt.tiles[V.id]=V,nt=y;break;default:Et()}},closetag:function(t){nt=pt},text:C},rt[p]={opentag:function(t){"PROPERTY"===t.name&&(st[t.attributes.NAME]=function(t,e){switch(e){case"int":return parseInt(t,10);case"float":return parseFloat(t,2);case"bool":return"true"===t;default:return t}}(t.attributes.VALUE,t.attributes.TYPE)),Et()},closetag:function(t){nt=ot},text:C},rt[_]={opentag:function(t){"FRAME"===t.name&&ut.push({tileId:t.attributes.TILEID,duration:t.attributes.DURATION}),Et()},closetag:function(t){nt=lt},text:C},rt[g]={opentag:function(t){"OBJECT"===t.name?((K=new W).name=t.attributes.NAME,K.type=t.attributes.TYPE,K.x=F(t.attributes.X),K.y=F(t.attributes.Y),K.width=F(t.attributes.WIDTH,0),K.height=F(t.attributes.HEIGHT,0),K.rotation=B(t.attributes.ROTATION,0),K.gid=F(t.attributes.GID),K.visible=M(t.attributes.VISIBLE,!0),ht.push(K),nt=T):Et()},closetag:function(t){nt=ft},text:C},rt[b]={opentag:function(t){at+=1},closetag:function(t){0==(at-=1)&&(nt=it)},text:C},rt[y]={opentag:function(t){"PROPERTIES"===t.name?vt(V.properties):"IMAGE"===t.name?V.image=yt(t):"ANIMATION"===t.name?V.animation=function(t){ut=t,lt=nt,nt=_}(V.animations):"OBJECTGROUP"===t.name?V.objectGroup=function(t){ht=t,ft=nt,nt=g}(V.objectGroups):Et()},closetag:function(t){nt=m},text:C},rt[w]={opentag:function(t){if("PROPERTIES"===t.name)vt(X.properties);else if("DATA"===t.name){var e=t.attributes.ENCODING,n=t.attributes.COMPRESSION;switch(e){case void 0:case null:nt=k;break;case"csv":nt=I;break;case"base64":switch(n){case void 0:case null:nt=S;break;case"gzip":nt=x;break;case"zlib":nt=O;break;default:return void Tt(new Error("unsupported data compression: "+n))}break;default:return void Tt(new Error("unsupported data encoding: "+e))}}else Et()},closetag:function(t){nt=d},text:C},rt[v]={opentag:function(t){"PROPERTIES"===t.name?vt(X.properties):"OBJECT"===t.name?((K=new W).name=t.attributes.NAME,K.type=t.attributes.TYPE,K.x=F(t.attributes.X),K.y=F(t.attributes.Y),K.width=F(t.attributes.WIDTH,0),K.height=F(t.attributes.HEIGHT,0),K.rotation=B(t.attributes.ROTATION,0),K.gid=F(t.attributes.GID),K.visible=M(t.attributes.VISIBLE,!0),X.objects.push(K),nt=E):Et()},closetag:function(t){nt=d},text:C},rt[A]={opentag:function(t){"PROPERTIES"===t.name?vt(X.properties):"IMAGE"===t.name?X.image=yt(t):Et()},closetag:function(t){nt=d},text:C},rt[E]={opentag:function(t){switch(t.name){case"PROPERTIES":vt(K.properties);break;case"ELLIPSE":K.ellipse=!0,Et();break;case"POLYGON":K.polygon=P(t.attributes.POINTS),Et();break;case"POLYLINE":K.polyline=P(t.attributes.POINTS),Et();break;case"IMAGE":K.image=yt(t);break;default:Et()}},closetag:function(t){nt=v},text:C},rt[T]={opentag:function(t){switch(t.name){case"PROPERTIES":vt(K.properties);break;case"ELLIPSE":K.ellipse=!0,Et();break;case"POLYGON":K.polygon=P(t.attributes.POINTS),Et();break;case"POLYLINE":K.polyline=P(t.attributes.POINTS),Et();break;case"IMAGE":K.image=yt(t);break;default:Et()}},closetag:function(t){nt=g},text:C},rt[k]={opentag:function(t){"TILE"===t.name&&mt(F(t.attributes.GID,0)),Et()},closetag:function(t){nt=w},text:C},rt[I]={opentag:function(t){Et()},closetag:function(t){nt=w},text:function(t){t.split(",").forEach(function(t){mt(parseInt(t,10))})}},rt[S]={opentag:function(t){Et()},closetag:function(t){nt=w},text:function(e){kt(new t(e.trim(),"base64"))}},rt[x]={opentag:function(t){Et()},closetag:function(t){nt=w},text:function(e){var n=new t(e.trim(),"base64"),r=J,i=X;_t.go(function(t){s.gunzip(n,function(e,n){e?t(e):(J=r,X=i,kt(n),t())})})}},rt[O]={opentag:function(t){Et()},closetag:function(t){nt=w},text:function(e){var n=new t(e.trim(),"base64"),r=J,i=X;_t.go(function(t){s.inflate(n,function(e,n){e?t(e):(X=i,J=r,kt(n),t())})})}},rt[N]={opentag:function(t){"TERRAIN"===t.name?((Q=new q).name=t.attributes.NAME,Q.tile=F(t.attributes.TILE),dt.terrainTypes.push(Q),nt=R):Et()},closetag:function(t){nt=m},text:C},rt[R]={opentag:function(t){"PROPERTIES"===t.name?vt(Q.properties):Et()},closetag:function(t){nt=N},text:C},tt.onerror=i,tt.onopentag=function(t){rt[nt].opentag(t)},tt.onclosetag=function(t){rt[nt].closetag(t)},tt.ontext=function(t){rt[nt].text(t)},tt.onend=function(){_t.wait(function(t){t?i(t):(gt.forEach(At),i(null,et))})},tt.write(e).close()}function D(t,n){e.readFile(t,function(e,r){e?n(e):L(r,t,n)})}function P(t){return t.split(" ").map(function(t){var e=t.split(",");return{x:e[0],y:e[1]}})}function C(){}function F(t,e){return e=null==e?null:e,null==t?e:parseInt(t,10)}function M(t,e){return e=null==e?null:e,null==t?e:!!parseInt(t,10)}function B(t,e){return e=null==e?null:e,null==t?e:parseFloat(t,10)}function U(){this.version=null,this.orientation="orthogonal",this.width=0,this.height=0,this.tileWidth=0,this.tileHeight=0,this.backgroundColor=null,this.layers=[],this.properties={},this.tileSets=[]}function z(){this.firstGid=0,this.source="",this.name="",this.tileWidth=0,this.tileHeight=0,this.spacing=0,this.margin=0,this.tileOffset={x:0,y:0},this.properties={},this.image=null,this.tiles=[],this.terrainTypes=[]}function j(){this.format=null,this.source="",this.trans=null,this.width=0,this.height=0}function Z(){this.id=0,this.type=null,this.terrain=[],this.probability=null,this.properties={},this.animations=[],this.objectGroups=[],this.image=null}function G(t){var e=t.width*t.height;this.map=t,this.type="tile",this.name=null,this.opacity=1,this.visible=!0,this.properties={},this.tiles=new Array(e),this.horizontalFlips=new Array(e),this.verticalFlips=new Array(e),this.diagonalFlips=new Array(e)}function Y(){this.type="object",this.name=null,this.color=null,this.opacity=1,this.visible=!0,this.properties={},this.objects=[]}function H(){this.type="image",this.name=null,this.x=0,this.y=0,this.opacity=1,this.visible=!0,this.properties={},this.image=null}function W(){this.name=null,this.type=null,this.x=0,this.y=0,this.width=0,this.height=0,this.rotation=0,this.properties={},this.gid=null,this.visible=!0,this.ellipse=!1,this.polygon=null,this.polyline=null}function q(){this.name="",this.tile=0,this.properties={}}z.prototype.mergeTo=function(t){t.firstGid=null==this.firstGid?t.firstGid:this.firstGid,t.source=null==this.source?t.source:this.source,t.name=null==this.name?t.name:this.name,t.tileWidth=null==this.tileWidth?t.tileWidth:this.tileWidth,t.tileHeight=null==this.tileHeight?t.tileHeight:this.tileHeight,t.spacing=null==this.spacing?t.spacing:this.spacing,t.margin=null==this.margin?t.margin:this.margin,t.tileOffset=null==this.tileOffset?t.tileOffset:this.tileOffset,t.properties=null==this.properties?t.properties:this.properties,t.image=null==this.image?t.image:this.image,t.tiles=null==this.tiles?t.tiles:this.tiles,t.terrainTypes=null==this.terrainTypes?t.terrainTypes:this.terrainTypes},G.prototype.tileAt=function(t,e){return this.tiles[e*this.map.width+t]},G.prototype.setTileAt=function(t,e,n){this.tiles[e*this.map.width+t]=n}}).call(this,n(2).Buffer)},function(t,e,n){"use strict";e.byteLength=function(t){var e=l(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=l(t),r=n[0],s=n[1],o=new a(3*(r+s)/4-s),u=0,h=0<s?r-4:r,f=0;f<h;f+=4)e=i[t.charCodeAt(f)]<<18|i[t.charCodeAt(f+1)]<<12|i[t.charCodeAt(f+2)]<<6|i[t.charCodeAt(f+3)],o[u++]=e>>16&255,o[u++]=e>>8&255,o[u++]=255&e;return 2===s&&(e=i[t.charCodeAt(f)]<<2|i[t.charCodeAt(f+1)]>>4,o[u++]=255&e),1===s&&(e=i[t.charCodeAt(f)]<<10|i[t.charCodeAt(f+1)]<<4|i[t.charCodeAt(f+2)]>>2,o[u++]=e>>8&255,o[u++]=255&e),o},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,a=[],s=0,o=n-i;s<o;s+=16383)a.push(f(t,s,o<s+16383?o:s+16383));return 1==i?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2==i&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,u=s.length;o<u;++o)r[o]=s[o],i[s.charCodeAt(o)]=o;function l(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function f(t,e,n){for(var r,i=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),i.push(h(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var a,s,o=8*i-r-1,u=(1<<o)-1,l=u>>1,h=-7,f=n?i-1:0,c=n?-1:1,d=t[e+f];for(f+=c,a=d&(1<<-h)-1,d>>=-h,h+=o;0<h;a=256*a+t[e+f],f+=c,h-=8);for(s=a&(1<<-h)-1,a>>=-h,h+=r;0<h;s=256*s+t[e+f],f+=c,h-=8);if(0===a)a=1-l;else{if(a===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),a-=l}return(d?-1:1)*s*Math.pow(2,a-r)},e.write=function(t,e,n,r,i,a){var s,o,u,l=8*a-i-1,h=(1<<l)-1,f=h>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1,_=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),2<=(e+=1<=s+f?c/u:c*Math.pow(2,1-f))*u&&(s++,u/=2),h<=s+f?(o=0,s=h):1<=s+f?(o=(e*u-1)*Math.pow(2,i),s+=f):(o=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));8<=i;t[n+d]=255&o,d+=p,o/=256,i-=8);for(s=s<<i|o,l+=i;0<l;t[n+d]=255&s,d+=p,s/=256,l-=8);t[n+d-p]|=128*_}},function(t,e,n){(function(t){!function(e){e.parser=function(t,e){return new a(t,e)},e.SAXParser=a,e.SAXStream=o,e.createStream=function(t,e){return new o(t,e)},e.MAX_BUFFER_LENGTH=65536;var r,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function a(t,n){if(!(this instanceof a))return new a(t,n);!function(t){for(var e=0,n=i.length;e<n;e++)t[i[e]]=""}(this),this.q=this.c="",this.bufferCheckPosition=e.MAX_BUFFER_LENGTH,this.opt=n||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!t,this.noscript=!(!t&&!this.opt.noscript),this.state=k.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(b)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),S(this,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}),a.prototype={end:function(){L(this)},write:function(t){if(this.error)throw this.error;if(this.closed)return R(this,"Cannot write after close. Assign an onready handler.");if(null===t)return L(this);"object"==typeof t&&(t=t.toString());for(var n=0,r="";r=j(t,n++),this.c=r;)switch(this.trackPosition&&(this.position++,"\n"===r?(this.line++,this.column=0):this.column++),this.state){case k.BEGIN:if(this.state=k.BEGIN_WHITESPACE,"\ufeff"===r)continue;z(this,r);continue;case k.BEGIN_WHITESPACE:z(this,r);continue;case k.TEXT:if(this.sawRoot&&!this.closedRoot){for(var a=n-1;r&&"<"!==r&&"&"!==r;)(r=j(t,n++))&&this.trackPosition&&(this.position++,"\n"===r?(this.line++,this.column=0):this.column++);this.textNode+=t.substring(a,n-1)}"<"!==r||this.sawRoot&&this.closedRoot&&!this.strict?(!A(u,r)||this.sawRoot&&!this.closedRoot||D(this,"Text data outside of root node."),"&"===r?this.state=k.TEXT_ENTITY:this.textNode+=r):(this.state=k.OPEN_WAKA,this.startTagPosition=this.position);continue;case k.SCRIPT:"<"===r?this.state=k.SCRIPT_ENDING:this.script+=r;continue;case k.SCRIPT_ENDING:"/"===r?this.state=k.CLOSE_TAG:(this.script+="<"+r,this.state=k.SCRIPT);continue;case k.OPEN_WAKA:if("!"===r)this.state=k.SGML_DECL,this.sgmlDecl="";else if(T(u,r));else if(T(m,r))this.state=k.OPEN_TAG,this.tagName=r;else if("/"===r)this.state=k.CLOSE_TAG,this.tagName="";else if("?"===r)this.state=k.PROC_INST,this.procInstName=this.procInstBody="";else{if(D(this,"Unencoded <"),this.startTagPosition+1<this.position){var s=this.position-this.startTagPosition;r=new Array(s).join(" ")+r}this.textNode+="<"+r,this.state=k.TEXT}continue;case k.SGML_DECL:(this.sgmlDecl+r).toUpperCase()===d?(x(this,"onopencdata"),this.state=k.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+r==="--"?(this.state=k.COMMENT,this.comment="",this.sgmlDecl=""):(this.sgmlDecl+r).toUpperCase()===p?(this.state=k.DOCTYPE,(this.doctype||this.sawRoot)&&D(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===r?(x(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=k.TEXT):(T(f,r)&&(this.state=k.SGML_DECL_QUOTED),this.sgmlDecl+=r);continue;case k.SGML_DECL_QUOTED:r===this.q&&(this.state=k.SGML_DECL,this.q=""),this.sgmlDecl+=r;continue;case k.DOCTYPE:">"===r?(this.state=k.TEXT,x(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=r,"["===r?this.state=k.DOCTYPE_DTD:T(f,r)&&(this.state=k.DOCTYPE_QUOTED,this.q=r));continue;case k.DOCTYPE_QUOTED:this.doctype+=r,r===this.q&&(this.q="",this.state=k.DOCTYPE);continue;case k.DOCTYPE_DTD:this.doctype+=r,"]"===r?this.state=k.DOCTYPE:T(f,r)&&(this.state=k.DOCTYPE_DTD_QUOTED,this.q=r);continue;case k.DOCTYPE_DTD_QUOTED:this.doctype+=r,r===this.q&&(this.state=k.DOCTYPE_DTD,this.q="");continue;case k.COMMENT:"-"===r?this.state=k.COMMENT_ENDING:this.comment+=r;continue;case k.COMMENT_ENDING:"-"===r?(this.state=k.COMMENT_ENDED,this.comment=N(this.opt,this.comment),this.comment&&x(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+r,this.state=k.COMMENT);continue;case k.COMMENT_ENDED:">"!==r?(D(this,"Malformed comment"),this.comment+="--"+r,this.state=k.COMMENT):this.state=k.TEXT;continue;case k.CDATA:"]"===r?this.state=k.CDATA_ENDING:this.cdata+=r;continue;case k.CDATA_ENDING:"]"===r?this.state=k.CDATA_ENDING_2:(this.cdata+="]"+r,this.state=k.CDATA);continue;case k.CDATA_ENDING_2:">"===r?(this.cdata&&x(this,"oncdata",this.cdata),x(this,"onclosecdata"),this.cdata="",this.state=k.TEXT):"]"===r?this.cdata+="]":(this.cdata+="]]"+r,this.state=k.CDATA);continue;case k.PROC_INST:"?"===r?this.state=k.PROC_INST_ENDING:T(u,r)?this.state=k.PROC_INST_BODY:this.procInstName+=r;continue;case k.PROC_INST_BODY:if(!this.procInstBody&&T(u,r))continue;"?"===r?this.state=k.PROC_INST_ENDING:this.procInstBody+=r;continue;case k.PROC_INST_ENDING:">"===r?(x(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=k.TEXT):(this.procInstBody+="?"+r,this.state=k.PROC_INST_BODY);continue;case k.OPEN_TAG:T(y,r)?this.tagName+=r:(P(this),">"===r?M(this):"/"===r?this.state=k.OPEN_TAG_SLASH:(A(u,r)&&D(this,"Invalid character in tag name"),this.state=k.ATTRIB));continue;case k.OPEN_TAG_SLASH:">"===r?(M(this,!0),B(this)):(D(this,"Forward-slash in opening tag not followed by >"),this.state=k.ATTRIB);continue;case k.ATTRIB:if(T(u,r))continue;">"===r?M(this):"/"===r?this.state=k.OPEN_TAG_SLASH:T(m,r)?(this.attribName=r,this.attribValue="",this.state=k.ATTRIB_NAME):D(this,"Invalid attribute name");continue;case k.ATTRIB_NAME:"="===r?this.state=k.ATTRIB_VALUE:">"===r?(D(this,"Attribute without value"),this.attribValue=this.attribName,F(this),M(this)):T(u,r)?this.state=k.ATTRIB_NAME_SAW_WHITE:T(y,r)?this.attribName+=r:D(this,"Invalid attribute name");continue;case k.ATTRIB_NAME_SAW_WHITE:if("="===r)this.state=k.ATTRIB_VALUE;else{if(T(u,r))continue;D(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",x(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===r?M(this):T(m,r)?(this.attribName=r,this.state=k.ATTRIB_NAME):(D(this,"Invalid attribute name"),this.state=k.ATTRIB)}continue;case k.ATTRIB_VALUE:if(T(u,r))continue;T(f,r)?(this.q=r,this.state=k.ATTRIB_VALUE_QUOTED):(D(this,"Unquoted attribute value"),this.state=k.ATTRIB_VALUE_UNQUOTED,this.attribValue=r);continue;case k.ATTRIB_VALUE_QUOTED:if(r!==this.q){"&"===r?this.state=k.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=r;continue}F(this),this.q="",this.state=k.ATTRIB_VALUE_CLOSED;continue;case k.ATTRIB_VALUE_CLOSED:T(u,r)?this.state=k.ATTRIB:">"===r?M(this):"/"===r?this.state=k.OPEN_TAG_SLASH:T(m,r)?(D(this,"No whitespace between attributes"),this.attribName=r,this.attribValue="",this.state=k.ATTRIB_NAME):D(this,"Invalid attribute name");continue;case k.ATTRIB_VALUE_UNQUOTED:if(A(c,r)){"&"===r?this.state=k.ATTRIB_VALUE_ENTITY_U:this.attribValue+=r;continue}F(this),">"===r?M(this):this.state=k.ATTRIB;continue;case k.CLOSE_TAG:if(this.tagName)">"===r?B(this):T(y,r)?this.tagName+=r:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=k.SCRIPT):(A(u,r)&&D(this,"Invalid tagname in closing tag"),this.state=k.CLOSE_TAG_SAW_WHITE);else{if(T(u,r))continue;A(m,r)?this.script?(this.script+="</"+r,this.state=k.SCRIPT):D(this,"Invalid tagname in closing tag."):this.tagName=r}continue;case k.CLOSE_TAG_SAW_WHITE:if(T(u,r))continue;">"===r?B(this):D(this,"Invalid characters in closing tag");continue;case k.TEXT_ENTITY:case k.ATTRIB_VALUE_ENTITY_Q:case k.ATTRIB_VALUE_ENTITY_U:var o,l;switch(this.state){case k.TEXT_ENTITY:o=k.TEXT,l="textNode";break;case k.ATTRIB_VALUE_ENTITY_Q:o=k.ATTRIB_VALUE_QUOTED,l="attribValue";break;case k.ATTRIB_VALUE_ENTITY_U:o=k.ATTRIB_VALUE_UNQUOTED,l="attribValue"}";"===r?(this[l]+=U(this),this.entity="",this.state=o):T(this.entity.length?v:w,r)?this.entity+=r:(D(this,"Invalid character in entity name"),this[l]+="&"+this.entity+r,this.entity="",this.state=o);continue;default:throw new Error(this,"Unknown state: "+this.state)}return this.position>=this.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),r=0,a=0,s=i.length;a<s;a++){var o=t[i[a]].length;if(n<o)switch(i[a]){case"textNode":O(t);break;case"cdata":x(t,"oncdata",t.cdata),t.cdata="";break;case"script":x(t,"onscript",t.script),t.script="";break;default:R(t,"Max buffer length exceeded: "+i[a])}r=Math.max(r,o)}var u=e.MAX_BUFFER_LENGTH-r;t.bufferCheckPosition=u+t.position}(this),this},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;O(t=this),""!==t.cdata&&(x(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(x(t,"onscript",t.script),t.script="")}};try{r=n(15).Stream}catch(t){r=function(){}}var s=e.EVENTS.filter(function(t){return"error"!==t&&"end"!==t});function o(t,e){if(!(this instanceof o))return new o(t,e);r.apply(this),this._parser=new a(t,e),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(t){n.emit("error",t),n._parser.error=null},this._decoder=null,s.forEach(function(t){Object.defineProperty(n,"on"+t,{get:function(){return n._parser["on"+t]},set:function(e){if(!e)return n.removeAllListeners(t),n._parser["on"+t]=e;n.on(t,e)},enumerable:!0,configurable:!1})})}(o.prototype=Object.create(r.prototype,{constructor:{value:o}})).write=function(e){if("function"==typeof t&&"function"==typeof t.isBuffer&&t.isBuffer(e)){if(!this._decoder){var r=n(13).StringDecoder;this._decoder=new r("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},o.prototype.on=function(t,e){var n=this;return n._parser["on"+t]||-1===s.indexOf(t)||(n._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),n.emit.apply(n,e)}),r.prototype.on.call(n,t,e)};var u="\r\n\t ",l="0124356789",h="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",f="'\"",c=u+">",d="[CDATA[",p="DOCTYPE",_="http://www.w3.org/XML/1998/namespace",g="http://www.w3.org/2000/xmlns/",b={xml:_,xmlns:g};u=E(u),l=E(l),h=E(h);var m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,w=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function E(t){return t.split("").reduce(function(t,e){return t[e]=!0,t},{})}function T(t,e){return function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}(t)?!!e.match(t):t[e]}function A(t,e){return!T(t,e)}f=E(f),c=E(c);var k=0;for(var I in e.STATE={BEGIN:k++,BEGIN_WHITESPACE:k++,TEXT:k++,TEXT_ENTITY:k++,OPEN_WAKA:k++,SGML_DECL:k++,SGML_DECL_QUOTED:k++,DOCTYPE:k++,DOCTYPE_QUOTED:k++,DOCTYPE_DTD:k++,DOCTYPE_DTD_QUOTED:k++,COMMENT_STARTING:k++,COMMENT:k++,COMMENT_ENDING:k++,COMMENT_ENDED:k++,CDATA:k++,CDATA_ENDING:k++,CDATA_ENDING_2:k++,PROC_INST:k++,PROC_INST_BODY:k++,PROC_INST_ENDING:k++,OPEN_TAG:k++,OPEN_TAG_SLASH:k++,ATTRIB:k++,ATTRIB_NAME:k++,ATTRIB_NAME_SAW_WHITE:k++,ATTRIB_VALUE:k++,ATTRIB_VALUE_QUOTED:k++,ATTRIB_VALUE_CLOSED:k++,ATTRIB_VALUE_UNQUOTED:k++,ATTRIB_VALUE_ENTITY_Q:k++,ATTRIB_VALUE_ENTITY_U:k++,CLOSE_TAG:k++,CLOSE_TAG_SAW_WHITE:k++,SCRIPT:k++,SCRIPT_ENDING:k++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var n=e.ENTITIES[t],r="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r}),e.STATE)e.STATE[e.STATE[I]]=I;function S(t,e,n){t[e]&&t[e](n)}function x(t,e,n){t.textNode&&O(t),S(t,e,n)}function O(t){t.textNode=N(t.opt,t.textNode),t.textNode&&S(t,"ontext",t.textNode),t.textNode=""}function N(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function R(t,e){return O(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,S(t,"onerror",e),t}function L(t){return t.sawRoot&&!t.closedRoot&&D(t,"Unclosed root tag"),t.state!==k.BEGIN&&t.state!==k.BEGIN_WHITESPACE&&t.state!==k.TEXT&&R(t,"Unexpected end"),O(t),t.c="",t.closed=!0,S(t,"onend"),a.call(t,t.strict,t.opt),t}function D(t,e){if("object"!=typeof t||!(t instanceof a))throw new Error("bad call to strictFail");t.strict&&R(t,e)}function P(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,n=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(n.ns=e.ns),t.attribList.length=0}function C(t,e){var n=t.indexOf(":")<0?["",t]:t.split(":"),r=n[0],i=n[1];return e&&"xmlns"===t&&(r="xmlns",i=""),{prefix:r,local:i}}function F(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=C(t.attribName,!0),n=e.prefix,r=e.local;if("xmlns"===n)if("xml"===r&&t.attribValue!==_)D(t,"xml: prefix must be bound to "+_+"\nActual: "+t.attribValue);else if("xmlns"===r&&t.attribValue!==g)D(t,"xmlns: prefix must be bound to "+g+"\nActual: "+t.attribValue);else{var i=t.tag,a=t.tags[t.tags.length-1]||t;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,x(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function M(t,e){if(t.opt.xmlns){var n=t.tag,r=C(t.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(D(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),n.uri=r.prefix);var i=t.tags[t.tags.length-1]||t;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach(function(e){x(t,"onopennamespace",{prefix:e,uri:n.ns[e]})});for(var a=0,s=t.attribList.length;a<s;a++){var o=t.attribList[a],u=o[0],l=o[1],h=C(u,!0),f=h.prefix,c=h.local,d=""===f?"":n.ns[f]||"",p={name:u,value:l,prefix:f,local:c,uri:d};f&&"xmlns"!==f&&!d&&(D(t,"Unbound namespace prefix: "+JSON.stringify(f)),p.uri=f),t.tag.attributes[u]=p,x(t,"onattribute",p)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),x(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=k.TEXT:t.state=k.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function B(t){if(!t.tagName)return D(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=k.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=k.SCRIPT);x(t,"onscript",t.script),t.script=""}var e=t.tags.length,n=t.tagName;t.strict||(n=n[t.looseCase]());for(var r=n;e--&&t.tags[e].name!==r;)D(t,"Unexpected close tag");if(e<0)return D(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=k.TEXT);t.tagName=n;for(var i=t.tags.length;i-- >e;){var a=t.tag=t.tags.pop();t.tagName=t.tag.name,x(t,"onclosetag",t.tagName);var s={};for(var o in a.ns)s[o]=a.ns[o];var u=t.tags[t.tags.length-1]||t;t.opt.xmlns&&a.ns!==u.ns&&Object.keys(a.ns).forEach(function(e){var n=a.ns[e];x(t,"onclosenamespace",{prefix:e,uri:n})})}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=k.TEXT}function U(t){var e,n=t.entity,r=n.toLowerCase(),i="";return t.ENTITIES[n]?t.ENTITIES[n]:t.ENTITIES[r]?t.ENTITIES[r]:("#"===(n=r).charAt(0)&&(i="x"===n.charAt(1)?(n=n.slice(2),(e=parseInt(n,16)).toString(16)):(n=n.slice(1),(e=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),i.toLowerCase()!==n?(D(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function z(t,e){"<"===e?(t.state=k.OPEN_WAKA,t.startTagPosition=t.position):A(u,e)&&(D(t,"Non-whitespace before first tag."),t.textNode=e,t.state=k.TEXT)}function j(t,e){var n="";return e<t.length&&(n=t.charAt(e)),n}k=e.STATE,String.fromCodePoint||function(){var t=String.fromCharCode,e=Math.floor,n=function(){var n,r,i=[],a=-1,s=arguments.length;if(!s)return"";for(var o="";++a<s;){var u=Number(arguments[a]);if(!isFinite(u)||u<0||1114111<u||e(u)!==u)throw RangeError("Invalid code point: "+u);u<=65535?i.push(u):(n=55296+((u-=65536)>>10),r=u%1024+56320,i.push(n,r)),(a+1===s||16384<i.length)&&(o+=t.apply(null,i),i.length=0)}return o};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:n,configurable:!0,writable:!0}):String.fromCodePoint=n}()}(e)}).call(this,n(2).Buffer)},function(t,e){},function(t,e,n){"use strict";var r=n(7).Buffer,i=n(32);function a(t,e,n){t.copy(e,n)}t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e=r.allocUnsafe(t>>>0),n=this.head,i=0;n;)a(n.data,e,i),i+=n.data.length,n=n.next;return e},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function a(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(34),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(1))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i=1,a={},s=!1,o=t.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(t);u=u&&u.setTimeout?u:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){h(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&h(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),r=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){h(t.data)},r=function(e){t.port2.postMessage(e)}}():o&&"onreadystatechange"in o.createElement("script")?function(){var t=o.documentElement;r=function(e){var n=o.createElement("script");n.onreadystatechange=function(){h(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():r=function(t){setTimeout(h,0,t)},u.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var s={callback:t,args:e};return a[i]=s,r(i),i++},u.clearImmediate=l}function l(t){delete a[t]}function h(t){if(s)setTimeout(h,0,t);else{var e=a[t];if(e){s=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{l(t),s=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(1),n(0))},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,n(1))},function(t,e,n){"use strict";t.exports=a;var r=n(19),i=n(5);function a(t){if(!(this instanceof a))return new a(t);r.call(this,t)}i.inherits=n(3),i.inherits(a,r),a.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(12)},function(t,e,n){t.exports=n(4)},function(t,e,n){t.exports=n(11).Transform},function(t,e,n){t.exports=n(11).PassThrough},function(t,e){},function(t,e,n){"use strict";(function(t){var r=n(2).Buffer,i=n(15).Transform,a=n(43),s=n(21),o=n(20).ok,u=n(2).kMaxLength,l="Cannot create final Buffer. It would be larger than 0x"+u.toString(16)+" bytes";a.Z_MIN_WINDOWBITS=8,a.Z_MAX_WINDOWBITS=15,a.Z_DEFAULT_WINDOWBITS=15,a.Z_MIN_CHUNK=64,a.Z_MAX_CHUNK=1/0,a.Z_DEFAULT_CHUNK=16384,a.Z_MIN_MEMLEVEL=1,a.Z_MAX_MEMLEVEL=9,a.Z_DEFAULT_MEMLEVEL=8,a.Z_MIN_LEVEL=-1,a.Z_MAX_LEVEL=9,a.Z_DEFAULT_LEVEL=a.Z_DEFAULT_COMPRESSION;for(var h=Object.keys(a),f=0;f<h.length;f++){var c=h[f];c.match(/^Z/)&&Object.defineProperty(e,c,{enumerable:!0,value:a[c],writable:!1})}for(var d={Z_OK:a.Z_OK,Z_STREAM_END:a.Z_STREAM_END,Z_NEED_DICT:a.Z_NEED_DICT,Z_ERRNO:a.Z_ERRNO,Z_STREAM_ERROR:a.Z_STREAM_ERROR,Z_DATA_ERROR:a.Z_DATA_ERROR,Z_MEM_ERROR:a.Z_MEM_ERROR,Z_BUF_ERROR:a.Z_BUF_ERROR,Z_VERSION_ERROR:a.Z_VERSION_ERROR},p=Object.keys(d),_=0;_<p.length;_++){var g=p[_];d[d[g]]=g}function b(t,e,n){var i=[],a=0;function s(){for(var e;null!==(e=t.read());)i.push(e),a+=e.length;t.once("readable",s)}function o(){var e,s=null;u<=a?s=new RangeError(l):e=r.concat(i,a),i=[],t.close(),n(s,e)}t.on("error",function(e){t.removeListener("end",o),t.removeListener("readable",s),n(e)}),t.on("end",o),t.end(e),s()}function m(t,e){if("string"==typeof e&&(e=r.from(e)),!r.isBuffer(e))throw new TypeError("Not a string or buffer");var n=t._finishFlushFlag;return t._processChunk(e,n)}function y(t){if(!(this instanceof y))return new y(t);S.call(this,t,a.DEFLATE)}function w(t){if(!(this instanceof w))return new w(t);S.call(this,t,a.INFLATE)}function v(t){if(!(this instanceof v))return new v(t);S.call(this,t,a.GZIP)}function E(t){if(!(this instanceof E))return new E(t);S.call(this,t,a.GUNZIP)}function T(t){if(!(this instanceof T))return new T(t);S.call(this,t,a.DEFLATERAW)}function A(t){if(!(this instanceof A))return new A(t);S.call(this,t,a.INFLATERAW)}function k(t){if(!(this instanceof k))return new k(t);S.call(this,t,a.UNZIP)}function I(t){return t===a.Z_NO_FLUSH||t===a.Z_PARTIAL_FLUSH||t===a.Z_SYNC_FLUSH||t===a.Z_FULL_FLUSH||t===a.Z_FINISH||t===a.Z_BLOCK}function S(t,n){var s=this;if(this._opts=t=t||{},this._chunkSize=t.chunkSize||e.Z_DEFAULT_CHUNK,i.call(this,t),t.flush&&!I(t.flush))throw new Error("Invalid flush flag: "+t.flush);if(t.finishFlush&&!I(t.finishFlush))throw new Error("Invalid flush flag: "+t.finishFlush);if(this._flushFlag=t.flush||a.Z_NO_FLUSH,this._finishFlushFlag=void 0!==t.finishFlush?t.finishFlush:a.Z_FINISH,t.chunkSize&&(t.chunkSize<e.Z_MIN_CHUNK||t.chunkSize>e.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+t.chunkSize);if(t.windowBits&&(t.windowBits<e.Z_MIN_WINDOWBITS||t.windowBits>e.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+t.windowBits);if(t.level&&(t.level<e.Z_MIN_LEVEL||t.level>e.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+t.level);if(t.memLevel&&(t.memLevel<e.Z_MIN_MEMLEVEL||t.memLevel>e.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+t.memLevel);if(t.strategy&&t.strategy!=e.Z_FILTERED&&t.strategy!=e.Z_HUFFMAN_ONLY&&t.strategy!=e.Z_RLE&&t.strategy!=e.Z_FIXED&&t.strategy!=e.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+t.strategy);if(t.dictionary&&!r.isBuffer(t.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new a.Zlib(n);var o=this;this._hadError=!1,this._handle.onerror=function(t,n){x(o),o._hadError=!0;var r=new Error(t);r.errno=n,r.code=e.codes[n],o.emit("error",r)};var u=e.Z_DEFAULT_COMPRESSION;"number"==typeof t.level&&(u=t.level);var l=e.Z_DEFAULT_STRATEGY;"number"==typeof t.strategy&&(l=t.strategy),this._handle.init(t.windowBits||e.Z_DEFAULT_WINDOWBITS,u,t.memLevel||e.Z_DEFAULT_MEMLEVEL,l,t.dictionary),this._buffer=r.allocUnsafe(this._chunkSize),this._offset=0,this._level=u,this._strategy=l,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!s._handle},configurable:!0,enumerable:!0})}function x(e,n){n&&t.nextTick(n),e._handle&&(e._handle.close(),e._handle=null)}function O(t){t.emit("close")}Object.defineProperty(e,"codes",{enumerable:!0,value:Object.freeze(d),writable:!1}),e.Deflate=y,e.Inflate=w,e.Gzip=v,e.Gunzip=E,e.DeflateRaw=T,e.InflateRaw=A,e.Unzip=k,e.createDeflate=function(t){return new y(t)},e.createInflate=function(t){return new w(t)},e.createDeflateRaw=function(t){return new T(t)},e.createInflateRaw=function(t){return new A(t)},e.createGzip=function(t){return new v(t)},e.createGunzip=function(t){return new E(t)},e.createUnzip=function(t){return new k(t)},e.deflate=function(t,e,n){return"function"==typeof e&&(n=e,e={}),b(new y(e),t,n)},e.deflateSync=function(t,e){return m(new y(e),t)},e.gzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),b(new v(e),t,n)},e.gzipSync=function(t,e){return m(new v(e),t)},e.deflateRaw=function(t,e,n){return"function"==typeof e&&(n=e,e={}),b(new T(e),t,n)},e.deflateRawSync=function(t,e){return m(new T(e),t)},e.unzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),b(new k(e),t,n)},e.unzipSync=function(t,e){return m(new k(e),t)},e.inflate=function(t,e,n){return"function"==typeof e&&(n=e,e={}),b(new w(e),t,n)},e.inflateSync=function(t,e){return m(new w(e),t)},e.gunzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),b(new E(e),t,n)},e.gunzipSync=function(t,e){return m(new E(e),t)},e.inflateRaw=function(t,e,n){return"function"==typeof e&&(n=e,e={}),b(new A(e),t,n)},e.inflateRawSync=function(t,e){return m(new A(e),t)},s.inherits(S,i),S.prototype.params=function(n,r,i){if(n<e.Z_MIN_LEVEL||n>e.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+n);if(r!=e.Z_FILTERED&&r!=e.Z_HUFFMAN_ONLY&&r!=e.Z_RLE&&r!=e.Z_FIXED&&r!=e.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+r);if(this._level!==n||this._strategy!==r){var s=this;this.flush(a.Z_SYNC_FLUSH,function(){o(s._handle,"zlib binding closed"),s._handle.params(n,r),s._hadError||(s._level=n,s._strategy=r,i&&i())})}else t.nextTick(i)},S.prototype.reset=function(){return o(this._handle,"zlib binding closed"),this._handle.reset()},S.prototype._flush=function(t){this._transform(r.alloc(0),"",t)},S.prototype.flush=function(e,n){var i=this,s=this._writableState;"function"!=typeof e&&(void 0!==e||n)||(n=e,e=a.Z_FULL_FLUSH),s.ended?n&&t.nextTick(n):s.ending?n&&this.once("end",n):s.needDrain?n&&this.once("drain",function(){return i.flush(e,n)}):(this._flushFlag=e,this.write(r.alloc(0),"",n))},S.prototype.close=function(e){x(this,e),t.nextTick(O,this)},S.prototype._transform=function(t,e,n){var i,s=this._writableState,o=(s.ending||s.ended)&&(!t||s.length===t.length);return null===t||r.isBuffer(t)?this._handle?(o?i=this._finishFlushFlag:(i=this._flushFlag,t.length>=s.length&&(this._flushFlag=this._opts.flush||a.Z_NO_FLUSH)),void this._processChunk(t,i,n)):n(new Error("zlib binding closed")):n(new Error("invalid input"))},S.prototype._processChunk=function(t,e,n){var i=t&&t.length,a=this._chunkSize-this._offset,s=0,h=this,f="function"==typeof n;if(!f){var c,d=[],p=0;this.on("error",function(t){c=t}),o(this._handle,"zlib binding closed");do{var _=this._handle.writeSync(e,t,s,i,this._buffer,this._offset,a)}while(!this._hadError&&m(_[0],_[1]));if(this._hadError)throw c;if(u<=p)throw x(this),new RangeError(l);var g=r.concat(d,p);return x(this),g}o(this._handle,"zlib binding closed");var b=this._handle.write(e,t,s,i,this._buffer,this._offset,a);function m(u,l){if(this&&(this.buffer=null,this.callback=null),!h._hadError){var c=a-l;if(o(0<=c,"have should not go down"),0<c){var _=h._buffer.slice(h._offset,h._offset+c);h._offset+=c,f?h.push(_):(d.push(_),p+=_.length)}if((0===l||h._offset>=h._chunkSize)&&(a=h._chunkSize,h._offset=0,h._buffer=r.allocUnsafe(h._chunkSize)),0===l){if(s+=i-u,i=u,!f)return!0;var g=h._handle.write(e,t,s,i,h._buffer,h._offset,h._chunkSize);return g.callback=m,void(g.buffer=t)}if(!f)return!1;n()}}b.buffer=t,b.callback=m},s.inherits(y,S),s.inherits(w,S),s.inherits(v,S),s.inherits(E,S),s.inherits(T,S),s.inherits(A,S),s.inherits(k,S)}).call(this,n(0))},function(t,e,n){"use strict";(function(t,r){var i=n(20),a=n(45),s=n(46),o=n(49),u=n(52);for(var l in u)e[l]=u[l];function h(t){if("number"!=typeof t||t<e.DEFLATE||t>e.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}e.NONE=0,e.DEFLATE=1,e.INFLATE=2,e.GZIP=3,e.GUNZIP=4,e.DEFLATERAW=5,e.INFLATERAW=6,e.UNZIP=7,h.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,i(this.init_done,"close before init"),i(this.mode<=e.UNZIP),this.mode===e.DEFLATE||this.mode===e.GZIP||this.mode===e.DEFLATERAW?s.deflateEnd(this.strm):this.mode!==e.INFLATE&&this.mode!==e.GUNZIP&&this.mode!==e.INFLATERAW&&this.mode!==e.UNZIP||o.inflateEnd(this.strm),this.mode=e.NONE,this.dictionary=null)},h.prototype.write=function(t,e,n,r,i,a,s){return this._write(!0,t,e,n,r,i,a,s)},h.prototype.writeSync=function(t,e,n,r,i,a,s){return this._write(!1,t,e,n,r,i,a,s)},h.prototype._write=function(n,a,s,o,u,l,h,f){if(i.equal(arguments.length,8),i(this.init_done,"write before init"),i(this.mode!==e.NONE,"already finalized"),i.equal(!1,this.write_in_progress,"write already in progress"),i.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,i.equal(!1,void 0===a,"must provide flush value"),this.write_in_progress=!0,a!==e.Z_NO_FLUSH&&a!==e.Z_PARTIAL_FLUSH&&a!==e.Z_SYNC_FLUSH&&a!==e.Z_FULL_FLUSH&&a!==e.Z_FINISH&&a!==e.Z_BLOCK)throw new Error("Invalid flush value");if(null==s&&(s=t.alloc(0),o=u=0),this.strm.avail_in=u,this.strm.input=s,this.strm.next_in=o,this.strm.avail_out=f,this.strm.output=l,this.strm.next_out=h,this.flush=a,!n)return this._process(),this._checkError()?this._afterSync():void 0;var c=this;return r.nextTick(function(){c._process(),c._after()}),this},h.prototype._afterSync=function(){var t=this.strm.avail_out,e=this.strm.avail_in;return this.write_in_progress=!1,[e,t]},h.prototype._process=function(){var t=null;switch(this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=s.deflate(this.strm,this.flush);break;case e.UNZIP:switch(0<this.strm.avail_in&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=e.INFLATE;break}if(t++,(this.gzip_id_bytes_read=1)===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=e.GUNZIP):this.mode=e.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:for(this.err=o.inflate(this.strm,this.flush),this.err===e.Z_NEED_DICT&&this.dictionary&&(this.err=o.inflateSetDictionary(this.strm,this.dictionary),this.err===e.Z_OK?this.err=o.inflate(this.strm,this.flush):this.err===e.Z_DATA_ERROR&&(this.err=e.Z_NEED_DICT));0<this.strm.avail_in&&this.mode===e.GUNZIP&&this.err===e.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=o.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},h.prototype._checkError=function(){switch(this.err){case e.Z_OK:case e.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===e.Z_FINISH)return this._error("unexpected end of file"),!1;break;case e.Z_STREAM_END:break;case e.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},h.prototype._after=function(){if(this._checkError()){var t=this.strm.avail_out,e=this.strm.avail_in;this.write_in_progress=!1,this.callback(e,t),this.pending_close&&this.close()}},h.prototype._error=function(t){this.strm.msg&&(t=this.strm.msg),this.onerror(t,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},h.prototype.init=function(t,n,r,a,s){i(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),i(8<=t&&t<=15,"invalid windowBits"),i(-1<=n&&n<=9,"invalid compression level"),i(1<=r&&r<=9,"invalid memlevel"),i(a===e.Z_FILTERED||a===e.Z_HUFFMAN_ONLY||a===e.Z_RLE||a===e.Z_FIXED||a===e.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(n,t,r,a,s),this._setDictionary()},h.prototype.params=function(){throw new Error("deflateParams Not supported")},h.prototype.reset=function(){this._reset(),this._setDictionary()},h.prototype._init=function(t,n,r,i,u){switch(this.level=t,this.windowBits=n,this.memLevel=r,this.strategy=i,this.flush=e.Z_NO_FLUSH,this.err=e.Z_OK,this.mode!==e.GZIP&&this.mode!==e.GUNZIP||(this.windowBits+=16),this.mode===e.UNZIP&&(this.windowBits+=32),this.mode!==e.DEFLATERAW&&this.mode!==e.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new a,this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=s.deflateInit2(this.strm,this.level,e.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:case e.UNZIP:this.err=o.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==e.Z_OK&&this._error("Init error"),this.dictionary=u,this.write_in_progress=!1,this.init_done=!0},h.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:this.err=s.deflateSetDictionary(this.strm,this.dictionary)}this.err!==e.Z_OK&&this._error("Failed to set dictionary")}},h.prototype._reset=function(){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:case e.GZIP:this.err=s.deflateReset(this.strm);break;case e.INFLATE:case e.INFLATERAW:case e.GUNZIP:this.err=o.inflateReset(this.strm)}this.err!==e.Z_OK&&this._error("Failed to reset stream")},e.Zlib=h}).call(this,n(2).Buffer,n(0))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,n){"use strict";var r,i=n(8),a=n(47),s=n(22),o=n(23),u=n(48),l=0,p=0,g=-2,k=2,C=3,F=258,M=F+C+1,U=42,G=103,Y=113,H=666;function Q(t,e){return t.msg=u[e],e}function J(t){return(t<<1)-(4<t?9:0)}function $(t){for(var e=t.length;0<=--e;)t[e]=0}function tt(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function et(t,e){a._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function nt(t,e){t.pending_buf[t.pending++]=e}function rt(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function it(t,e,n,r){var a=t.avail_in;return r<a&&(a=r),0===a?0:(t.avail_in-=a,i.arraySet(e,t.input,t.next_in,a,n),1===t.state.wrap?t.adler=s(t.adler,e,a,n):2===t.state.wrap&&(t.adler=o(t.adler,e,a,n)),t.next_in+=a,t.total_in+=a,a)}function at(t,e){var n,r,i=t.max_chain_length,a=t.strstart,s=t.prev_length,o=t.nice_match,u=t.strstart>t.w_size-M?t.strstart-(t.w_size-M):0,l=t.window,h=t.w_mask,f=t.prev,c=t.strstart+F,d=l[a+s-1],p=l[a+s];t.prev_length>=t.good_match&&(i>>=2),o>t.lookahead&&(o=t.lookahead);do{if(l[(n=e)+s]===p&&l[n+s-1]===d&&l[n]===l[a]&&l[++n]===l[a+1]){a+=2,n++;do{}while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<c);if(r=F-(c-a),a=c-F,s<r){if(t.match_start=e,o<=(s=r))break;d=l[a+s-1],p=l[a+s]}}}while((e=f[e&h])>u&&0!=--i);return s<=t.lookahead?s:t.lookahead}function st(t){var e,n,r,a,s,o=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=o+(o-M)){for(i.arraySet(t.window,t.window,o,o,0),t.match_start-=o,t.strstart-=o,t.block_start-=o,e=n=t.hash_size;r=t.head[--e],t.head[e]=o<=r?r-o:0,--n;);for(e=n=o;r=t.prev[--e],t.prev[e]=o<=r?r-o:0,--n;);a+=o}if(0===t.strm.avail_in)break;if(n=it(t.strm,t.window,t.strstart+t.lookahead,a),t.lookahead+=n,t.lookahead+t.insert>=C)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+C-1])&t.hash_mask,t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<C)););}while(t.lookahead<M&&0!==t.strm.avail_in)}function ot(t,e){for(var n,r;;){if(t.lookahead<M){if(st(t),t.lookahead<M&&e===l)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=C&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+C-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-M&&(t.match_length=at(t,n)),t.match_length>=C)if(r=a._tr_tally(t,t.strstart-t.match_start,t.match_length-C),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=C){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+C-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(et(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<C-1?t.strstart:C-1,4===e?(et(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?1:2}function ut(t,e){for(var n,r,i;;){if(t.lookahead<M){if(st(t),t.lookahead<M&&e===l)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=C&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+C-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=C-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-M&&(t.match_length=at(t,n),t.match_length<=5&&(1===t.strategy||t.match_length===C&&4096<t.strstart-t.match_start)&&(t.match_length=C-1)),t.prev_length>=C&&t.match_length<=t.prev_length){for(i=t.strstart+t.lookahead-C,r=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-C),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+C-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=C-1,t.strstart++,r&&(et(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=a._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<C-1?t.strstart:C-1,4===e?(et(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?1:2}function lt(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function ht(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=k,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?U:Y,t.adler=2===e.wrap?0:1,e.last_flush=l,a._tr_init(e),p):Q(t,g)}function ft(t){var e=ht(t);return e===p&&function(t){t.window_size=2*t.w_size,$(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=C-1,t.match_available=0,t.ins_h=0}(t.state),e}function ct(t,e,n,r,a,s){if(!t)return g;var o=1;if(-1===e&&(e=6),r<0?(o=0,r=-r):15<r&&(o=2,r-=16),a<1||9<a||8!==n||r<8||15<r||e<0||9<e||s<0||4<s)return Q(t,g);8===r&&(r=9);var u=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return(t.state=u).strm=t,u.wrap=o,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=a+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+C-1)/C),u.window=new i.Buf8(2*u.w_size),u.head=new i.Buf16(u.hash_size),u.prev=new i.Buf16(u.w_size),u.lit_bufsize=1<<a+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new i.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=s,u.method=n,ft(t)}r=[new lt(0,0,0,0,function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(st(t),0===t.lookahead&&e===l)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,et(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-M&&(et(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(et(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),1)}),new lt(4,4,8,4,ot),new lt(4,5,16,8,ot),new lt(4,6,32,32,ot),new lt(4,4,16,16,ut),new lt(8,16,32,32,ut),new lt(8,16,128,128,ut),new lt(8,32,128,256,ut),new lt(32,128,258,1024,ut),new lt(32,258,258,4096,ut)],e.deflateInit=function(t,e){return ct(t,e,8,15,8,0)},e.deflateInit2=ct,e.deflateReset=ft,e.deflateResetKeep=ht,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?g:(t.state.gzhead=e,p):g},e.deflate=function(t,e){var n,i,s,u;if(!t||!t.state||5<e||e<0)return t?Q(t,g):g;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||i.status===H&&4!==e)return Q(t,0===t.avail_out?-5:g);if(i.strm=t,n=i.last_flush,i.last_flush=e,i.status===U)if(2===i.wrap)t.adler=0,nt(i,31),nt(i,139),nt(i,8),i.gzhead?(nt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),nt(i,255&i.gzhead.time),nt(i,i.gzhead.time>>8&255),nt(i,i.gzhead.time>>16&255),nt(i,i.gzhead.time>>24&255),nt(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),nt(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(nt(i,255&i.gzhead.extra.length),nt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=o(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(nt(i,0),nt(i,0),nt(i,0),nt(i,0),nt(i,0),nt(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),nt(i,3),i.status=Y);else{var b=8+(i.w_bits-8<<4)<<8;b|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(b|=32),b+=31-b%31,i.status=Y,rt(i,b),0!==i.strstart&&(rt(i,t.adler>>>16),rt(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),tt(t),s=i.pending,i.pending!==i.pending_buf_size));)nt(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),tt(t),s=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,nt(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),0===u&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),tt(t),s=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,nt(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),0===u&&(i.status=G)}else i.status=G;if(i.status===G&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&tt(t),i.pending+2<=i.pending_buf_size&&(nt(i,255&t.adler),nt(i,t.adler>>8&255),t.adler=0,i.status=Y)):i.status=Y),0!==i.pending){if(tt(t),0===t.avail_out)return i.last_flush=-1,p}else if(0===t.avail_in&&J(e)<=J(n)&&4!==e)return Q(t,-5);if(i.status===H&&0!==t.avail_in)return Q(t,-5);if(0!==t.avail_in||0!==i.lookahead||e!==l&&i.status!==H){var y=2===i.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(st(t),0===t.lookahead)){if(e===l)return 1;break}if(t.match_length=0,n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(et(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?1:2}(i,e):3===i.strategy?function(t,e){for(var n,r,i,s,o=t.window;;){if(t.lookahead<=F){if(st(t),t.lookahead<=F&&e===l)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=C&&0<t.strstart&&(r=o[i=t.strstart-1])===o[++i]&&r===o[++i]&&r===o[++i]){s=t.strstart+F;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<s);t.match_length=F-(s-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=C?(n=a._tr_tally(t,1,t.match_length-C),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(et(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(et(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?1:2}(i,e):r[i.level].func(i,e);if(3!==y&&4!==y||(i.status=H),1===y||3===y)return 0===t.avail_out&&(i.last_flush=-1),p;if(2===y&&(1===e?a._tr_align(i):5!==e&&(a._tr_stored_block(i,0,0,!1),3===e&&($(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),tt(t),0===t.avail_out))return i.last_flush=-1,p}return 4!==e?p:i.wrap<=0?1:(2===i.wrap?(nt(i,255&t.adler),nt(i,t.adler>>8&255),nt(i,t.adler>>16&255),nt(i,t.adler>>24&255),nt(i,255&t.total_in),nt(i,t.total_in>>8&255),nt(i,t.total_in>>16&255),nt(i,t.total_in>>24&255)):(rt(i,t.adler>>>16),rt(i,65535&t.adler)),tt(t),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?p:1)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==U&&69!==e&&73!==e&&91!==e&&e!==G&&e!==Y&&e!==H?Q(t,g):(t.state=null,e===Y?Q(t,-3):p):g},e.deflateSetDictionary=function(t,e){var n,r,a,o,u,l,h,f,c=e.length;if(!t||!t.state)return g;if(2===(o=(n=t.state).wrap)||1===o&&n.status!==U||n.lookahead)return g;for(1===o&&(t.adler=s(t.adler,e,c,0)),n.wrap=0,c>=n.w_size&&(0===o&&($(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new i.Buf8(n.w_size),i.arraySet(f,e,c-n.w_size,n.w_size,0),e=f,c=n.w_size),u=t.avail_in,l=t.next_in,h=t.input,t.avail_in=c,t.next_in=0,t.input=e,st(n);n.lookahead>=C;){for(r=n.strstart,a=n.lookahead-(C-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+C-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--a;);n.strstart=r,n.lookahead=C-1,st(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=C-1,n.match_available=0,t.next_in=l,t.input=h,t.avail_in=u,n.wrap=o,p},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,n){"use strict";var r=n(8);function u(t){for(var e=t.length;0<=--e;)t[e]=0}var d=256,p=286,_=30,m=15,y=16,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=new Array(576);u(O);var N=new Array(60);u(N);var R=new Array(512);u(R);var L=new Array(256);u(L);var D=new Array(29);u(D);var P,C,F,M=new Array(_);function B(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function U(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function z(t){return t<256?R[t]:R[256+(t>>>7)]}function j(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function Z(t,e,n){t.bi_valid>y-n?(t.bi_buf|=e<<t.bi_valid&65535,j(t,t.bi_buf),t.bi_buf=e>>y-t.bi_valid,t.bi_valid+=n-y):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function G(t,e,n){Z(t,n[2*e],n[2*e+1])}function Y(t,e){for(var n=0;n|=1&t,t>>>=1,n<<=1,0<--e;);return n>>>1}function H(t,e,n){var r,i,a=new Array(m+1),s=0;for(r=1;r<=m;r++)a[r]=s=s+n[r-1]<<1;for(i=0;i<=e;i++){var o=t[2*i+1];0!==o&&(t[2*i]=Y(a[o]++,o))}}function W(t){var e;for(e=0;e<p;e++)t.dyn_ltree[2*e]=0;for(e=0;e<_;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function q(t){8<t.bi_valid?j(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function V(t,e,n,r){var i=2*e,a=2*n;return t[i]<t[a]||t[i]===t[a]&&r[e]<=r[n]}function X(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&V(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!V(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function K(t,e,n){var r,i,a,s,o=0;if(0!==t.last_lit)for(;r=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],i=t.pending_buf[t.l_buf+o],o++,0===r?G(t,i,e):(G(t,(a=L[i])+d+1,e),0!==(s=k[a])&&Z(t,i-=D[a],s),G(t,a=z(--r),n),0!==(s=I[a])&&Z(t,r-=M[a],s)),o<t.last_lit;);G(t,256,e)}function Q(t,e){var n,r,i,a=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,u=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<u;n++)0!==a[2*n]?(t.heap[++t.heap_len]=l=n,t.depth[n]=0):a[2*n+1]=0;for(;t.heap_len<2;)a[2*(i=t.heap[++t.heap_len]=l<2?++l:0)]=1,t.depth[i]=0,t.opt_len--,o&&(t.static_len-=s[2*i+1]);for(e.max_code=l,n=t.heap_len>>1;1<=n;n--)X(t,a,n);for(i=u;n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],X(t,a,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,a[2*i]=a[2*n]+a[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,a[2*n+1]=a[2*r+1]=i,t.heap[1]=i++,X(t,a,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,r,i,a,s,o,u=e.dyn_tree,l=e.max_code,h=e.stat_desc.static_tree,f=e.stat_desc.has_stree,c=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,p=e.stat_desc.max_length,_=0;for(a=0;a<=m;a++)t.bl_count[a]=0;for(u[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)(a=u[2*u[2*(r=t.heap[n])+1]+1]+1)>p&&(a=p,_++),u[2*r+1]=a,l<r||(t.bl_count[a]++,s=0,d<=r&&(s=c[r-d]),o=u[2*r],t.opt_len+=o*(a+s),f&&(t.static_len+=o*(h[2*r+1]+s)));if(0!==_){do{for(a=p-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[p]--,_-=2}while(0<_);for(a=p;0!==a;a--)for(r=t.bl_count[a];0!==r;)(i=t.heap[--n])>l||(u[2*i+1]!==a&&(t.opt_len+=(a-u[2*i+1])*u[2*i],u[2*i+1]=a),r--)}}(t,e),H(a,l,t.bl_count)}function J(t,e,n){var r,i,a=-1,s=e[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=e[2*(r+1)+1],++o<u&&i===s||(o<l?t.bl_tree[2*i]+=o:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=i,l=(o=0)===s?(u=138,3):i===s?(u=6,3):(u=7,4))}function $(t,e,n){var r,i,a=-1,s=e[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),r=0;r<=n;r++)if(i=s,s=e[2*(r+1)+1],!(++o<u&&i===s)){if(o<l)for(;G(t,i,t.bl_tree),0!=--o;);else 0!==i?(i!==a&&(G(t,i,t.bl_tree),o--),G(t,16,t.bl_tree),Z(t,o-3,2)):o<=10?(G(t,17,t.bl_tree),Z(t,o-3,3)):(G(t,18,t.bl_tree),Z(t,o-11,7));a=i,l=(o=0)===s?(u=138,3):i===s?(u=6,3):(u=7,4)}}u(M);var tt=!1;function et(t,e,n,i){Z(t,0+(i?1:0),3),function(t,e,n){q(t),j(t,n),j(t,~n),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n)}e._tr_init=function(t){tt||(function(){var t,e,n,r,i,a=new Array(m+1);for(r=n=0;r<28;r++)for(D[r]=n,t=0;t<1<<k[r];t++)L[n++]=r;for(L[n-1]=r,r=i=0;r<16;r++)for(M[r]=i,t=0;t<1<<I[r];t++)R[i++]=r;for(i>>=7;r<_;r++)for(M[r]=i<<7,t=0;t<1<<I[r]-7;t++)R[256+i++]=r;for(e=0;e<=m;e++)a[e]=0;for(t=0;t<=143;)O[2*t+1]=8,t++,a[8]++;for(;t<=255;)O[2*t+1]=9,t++,a[9]++;for(;t<=279;)O[2*t+1]=7,t++,a[7]++;for(;t<=287;)O[2*t+1]=8,t++,a[8]++;for(H(O,287,a),t=0;t<_;t++)N[2*t+1]=5,N[2*t]=Y(t,5);P=new B(O,k,257,p,m),C=new B(N,I,0,_,m),F=new B(new Array(0),S,0,19,7)}(),tt=!0),t.l_desc=new U(t.dyn_ltree,P),t.d_desc=new U(t.dyn_dtree,C),t.bl_desc=new U(t.bl_tree,F),t.bi_buf=0,t.bi_valid=0,W(t)},e._tr_stored_block=et,e._tr_flush_block=function(t,e,n,r){var u,l,c=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<d;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),Q(t,t.l_desc),Q(t,t.d_desc),c=function(t){var e;for(J(t,t.dyn_ltree,t.l_desc.max_code),J(t,t.dyn_dtree,t.d_desc.max_code),Q(t,t.bl_desc),e=18;3<=e&&0===t.bl_tree[2*x[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),u=t.opt_len+3+7>>>3,(l=t.static_len+3+7>>>3)<=u&&(u=l)):u=l=n+5,n+4<=u&&-1!==e?et(t,e,n,r):4===t.strategy||l===u?(Z(t,2+(r?1:0),3),K(t,O,N)):(Z(t,4+(r?1:0),3),function(t,e,n,r){var i;for(Z(t,e-257,5),Z(t,n-1,5),Z(t,r-4,4),i=0;i<r;i++)Z(t,t.bl_tree[2*x[i]+1],3);$(t,t.dyn_ltree,e-1),$(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,c+1),K(t,t.dyn_ltree,t.dyn_dtree)),W(t),r&&q(t)},e._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(L[n]+d+1)]++,t.dyn_dtree[2*z(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){Z(t,2,3),G(t,256,O),function(t){16===t.bi_valid?(j(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,n){"use strict";var r=n(8),i=n(22),a=n(23),s=n(50),o=n(51),l=1,h=2,p=0,b=-2,E=1,D=12,Q=30,tt=852,et=592;function rt(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function it(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=E,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(tt),e.distcode=e.distdyn=new r.Buf32(et),e.sane=1,e.back=-1,p):b}function at(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,it(t)):b}function st(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?b:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,at(t))):b}function ot(t,e){var n,i;return t?(i=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},(t.state=i).window=null,(n=st(t,e))!==p&&(t.state=null),n):b}var ut,lt,ht=!0;function ft(t){if(ht){var e;for(ut=new r.Buf32(512),lt=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(l,t.lens,0,288,ut,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(h,t.lens,0,32,lt,0,t.work,{bits:5}),ht=!1}t.lencode=ut,t.lenbits=9,t.distcode=lt,t.distbits=5}function ct(t,e,n,i){var a,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),i>=s.wsize?(r.arraySet(s.window,e,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((a=s.wsize-s.wnext)>i&&(a=i),r.arraySet(s.window,e,n-i,a,s.wnext),(i-=a)?(r.arraySet(s.window,e,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}e.inflateReset=at,e.inflateReset2=st,e.inflateResetKeep=it,e.inflateInit=function(t){return ot(t,15)},e.inflateInit2=ot,e.inflate=function(t,e){var n,tt,et,nt,it,at,st,ot,ut,lt,ht,dt,pt,_t,gt,bt,mt,yt,wt,vt,Et,Tt,At,kt,It=0,St=new r.Buf8(4),xt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return b;(n=t.state).mode===D&&(n.mode=13),it=t.next_out,et=t.output,st=t.avail_out,nt=t.next_in,tt=t.input,at=t.avail_in,ot=n.hold,ut=n.bits,lt=at,ht=st,Tt=p;t:for(;;)switch(n.mode){case E:if(0===n.wrap){n.mode=13;break}for(;ut<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(2&n.wrap&&35615===ot){St[n.check=0]=255&ot,St[1]=ot>>>8&255,n.check=a(n.check,St,2,0),ut=ot=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&ot)<<8)+(ot>>8))%31){t.msg="incorrect header check",n.mode=Q;break}if(8!=(15&ot)){t.msg="unknown compression method",n.mode=Q;break}if(ut-=4,Et=8+(15&(ot>>>=4)),0===n.wbits)n.wbits=Et;else if(Et>n.wbits){t.msg="invalid window size",n.mode=Q;break}n.dmax=1<<Et,t.adler=n.check=1,n.mode=512&ot?10:D,ut=ot=0;break;case 2:for(;ut<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(n.flags=ot,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=Q;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=Q;break}n.head&&(n.head.text=ot>>8&1),512&n.flags&&(St[0]=255&ot,St[1]=ot>>>8&255,n.check=a(n.check,St,2,0)),ut=ot=0,n.mode=3;case 3:for(;ut<32;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}n.head&&(n.head.time=ot),512&n.flags&&(St[0]=255&ot,St[1]=ot>>>8&255,St[2]=ot>>>16&255,St[3]=ot>>>24&255,n.check=a(n.check,St,4,0)),ut=ot=0,n.mode=4;case 4:for(;ut<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}n.head&&(n.head.xflags=255&ot,n.head.os=ot>>8),512&n.flags&&(St[0]=255&ot,St[1]=ot>>>8&255,n.check=a(n.check,St,2,0)),ut=ot=0,n.mode=5;case 5:if(1024&n.flags){for(;ut<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}n.length=ot,n.head&&(n.head.extra_len=ot),512&n.flags&&(St[0]=255&ot,St[1]=ot>>>8&255,n.check=a(n.check,St,2,0)),ut=ot=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((dt=n.length)>at&&(dt=at),dt&&(n.head&&(Et=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,tt,nt,dt,Et)),512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,n.length-=dt),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===at)break t;for(dt=0;Et=tt[nt+dt++],n.head&&Et&&n.length<65536&&(n.head.name+=String.fromCharCode(Et)),Et&&dt<at;);if(512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,Et)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===at)break t;for(dt=0;Et=tt[nt+dt++],n.head&&Et&&n.length<65536&&(n.head.comment+=String.fromCharCode(Et)),Et&&dt<at;);if(512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,Et)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;ut<16;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(ot!==(65535&n.check)){t.msg="header crc mismatch",n.mode=Q;break}ut=ot=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=D;break;case 10:for(;ut<32;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}t.adler=n.check=rt(ot),ut=ot=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=it,t.avail_out=st,t.next_in=nt,t.avail_in=at,n.hold=ot,n.bits=ut,2;t.adler=n.check=1,n.mode=D;case D:if(5===e||6===e)break t;case 13:if(n.last){ot>>>=7&ut,ut-=7&ut,n.mode=27;break}for(;ut<3;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}switch(n.last=1&ot,ut-=1,3&(ot>>>=1)){case 0:n.mode=14;break;case 1:if(ft(n),n.mode=20,6!==e)break;ot>>>=2,ut-=2;break t;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=Q}ot>>>=2,ut-=2;break;case 14:for(ot>>>=7&ut,ut-=7&ut;ut<32;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if((65535&ot)!=(ot>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Q;break}if(n.length=65535&ot,ut=ot=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(dt=n.length){if(at<dt&&(dt=at),st<dt&&(dt=st),0===dt)break t;r.arraySet(et,tt,nt,dt,it),at-=dt,nt+=dt,st-=dt,it+=dt,n.length-=dt;break}n.mode=D;break;case 17:for(;ut<14;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(n.nlen=257+(31&ot),ot>>>=5,ut-=5,n.ndist=1+(31&ot),ot>>>=5,ut-=5,n.ncode=4+(15&ot),ot>>>=4,ut-=4,286<n.nlen||30<n.ndist){t.msg="too many length or distance symbols",n.mode=Q;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;ut<3;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}n.lens[xt[n.have++]]=7&ot,ot>>>=3,ut-=3}for(;n.have<19;)n.lens[xt[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,At={bits:n.lenbits},Tt=o(0,n.lens,0,19,n.lencode,0,n.work,At),n.lenbits=At.bits,Tt){t.msg="invalid code lengths set",n.mode=Q;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;bt=(It=n.lencode[ot&(1<<n.lenbits)-1])>>>16&255,mt=65535&It,!((gt=It>>>24)<=ut);){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(mt<16)ot>>>=gt,ut-=gt,n.lens[n.have++]=mt;else{if(16===mt){for(kt=gt+2;ut<kt;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(ot>>>=gt,ut-=gt,0===n.have){t.msg="invalid bit length repeat",n.mode=Q;break}Et=n.lens[n.have-1],dt=3+(3&ot),ot>>>=2,ut-=2}else if(17===mt){for(kt=gt+3;ut<kt;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}ut-=gt,Et=0,dt=3+(7&(ot>>>=gt)),ot>>>=3,ut-=3}else{for(kt=gt+7;ut<kt;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}ut-=gt,Et=0,dt=11+(127&(ot>>>=gt)),ot>>>=7,ut-=7}if(n.have+dt>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Q;break}for(;dt--;)n.lens[n.have++]=Et}}if(n.mode===Q)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=Q;break}if(n.lenbits=9,At={bits:n.lenbits},Tt=o(l,n.lens,0,n.nlen,n.lencode,0,n.work,At),n.lenbits=At.bits,Tt){t.msg="invalid literal/lengths set",n.mode=Q;break}if(n.distbits=6,n.distcode=n.distdyn,At={bits:n.distbits},Tt=o(h,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,At),n.distbits=At.bits,Tt){t.msg="invalid distances set",n.mode=Q;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(6<=at&&258<=st){t.next_out=it,t.avail_out=st,t.next_in=nt,t.avail_in=at,n.hold=ot,n.bits=ut,s(t,ht),it=t.next_out,et=t.output,st=t.avail_out,nt=t.next_in,tt=t.input,at=t.avail_in,ot=n.hold,ut=n.bits,n.mode===D&&(n.back=-1);break}for(n.back=0;bt=(It=n.lencode[ot&(1<<n.lenbits)-1])>>>16&255,mt=65535&It,!((gt=It>>>24)<=ut);){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(bt&&0==(240&bt)){for(yt=gt,wt=bt,vt=mt;bt=(It=n.lencode[vt+((ot&(1<<yt+wt)-1)>>yt)])>>>16&255,mt=65535&It,!(yt+(gt=It>>>24)<=ut);){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}ot>>>=yt,ut-=yt,n.back+=yt}if(ot>>>=gt,ut-=gt,n.back+=gt,n.length=mt,0===bt){n.mode=26;break}if(32&bt){n.back=-1,n.mode=D;break}if(64&bt){t.msg="invalid literal/length code",n.mode=Q;break}n.extra=15&bt,n.mode=22;case 22:if(n.extra){for(kt=n.extra;ut<kt;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}n.length+=ot&(1<<n.extra)-1,ot>>>=n.extra,ut-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;bt=(It=n.distcode[ot&(1<<n.distbits)-1])>>>16&255,mt=65535&It,!((gt=It>>>24)<=ut);){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(0==(240&bt)){for(yt=gt,wt=bt,vt=mt;bt=(It=n.distcode[vt+((ot&(1<<yt+wt)-1)>>yt)])>>>16&255,mt=65535&It,!(yt+(gt=It>>>24)<=ut);){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}ot>>>=yt,ut-=yt,n.back+=yt}if(ot>>>=gt,ut-=gt,n.back+=gt,64&bt){t.msg="invalid distance code",n.mode=Q;break}n.offset=mt,n.extra=15&bt,n.mode=24;case 24:if(n.extra){for(kt=n.extra;ut<kt;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}n.offset+=ot&(1<<n.extra)-1,ot>>>=n.extra,ut-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Q;break}n.mode=25;case 25:if(0===st)break t;if(dt=ht-st,n.offset>dt){if((dt=n.offset-dt)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Q;break}pt=dt>n.wnext?(dt-=n.wnext,n.wsize-dt):n.wnext-dt,dt>n.length&&(dt=n.length),_t=n.window}else _t=et,pt=it-n.offset,dt=n.length;for(st<dt&&(dt=st),st-=dt,n.length-=dt;et[it++]=_t[pt++],--dt;);0===n.length&&(n.mode=21);break;case 26:if(0===st)break t;et[it++]=n.length,st--,n.mode=21;break;case 27:if(n.wrap){for(;ut<32;){if(0===at)break t;at--,ot|=tt[nt++]<<ut,ut+=8}if(ht-=st,t.total_out+=ht,n.total+=ht,ht&&(t.adler=n.check=n.flags?a(n.check,et,ht,it-ht):i(n.check,et,ht,it-ht)),ht=st,(n.flags?ot:rt(ot))!==n.check){t.msg="incorrect data check",n.mode=Q;break}ut=ot=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;ut<32;){if(0===at)break t;at--,ot+=tt[nt++]<<ut,ut+=8}if(ot!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=Q;break}ut=ot=0}n.mode=29;case 29:Tt=1;break t;case Q:Tt=-3;break t;case 31:return-4;case 32:default:return b}return t.next_out=it,t.avail_out=st,t.next_in=nt,t.avail_in=at,n.hold=ot,n.bits=ut,(n.wsize||ht!==t.avail_out&&n.mode<Q&&(n.mode<27||4!==e))&&ct(t,t.output,t.next_out,ht-t.avail_out)?(n.mode=31,-4):(lt-=t.avail_in,ht-=t.avail_out,t.total_in+=lt,t.total_out+=ht,n.total+=ht,n.wrap&&ht&&(t.adler=n.check=n.flags?a(n.check,et,ht,t.next_out-ht):i(n.check,et,ht,t.next_out-ht)),t.data_type=n.bits+(n.last?64:0)+(n.mode===D?128:0)+(20===n.mode||15===n.mode?256:0),(0===lt&&0===ht||4===e)&&Tt===p&&(Tt=-5),Tt)},e.inflateEnd=function(t){if(!t||!t.state)return b;var e=t.state;return e.window&&(e.window=null),t.state=null,p},e.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?b:((n.head=e).done=!1,p):b},e.inflateSetDictionary=function(t,e){var n,r=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?b:11===n.mode&&i(1,e,r,0)!==n.check?-3:ct(t,e,r,r)?(n.mode=31,-4):(n.havedict=1,p):b},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,n){"use strict";t.exports=function(t,e){var n,r,i,a,s,o,u,l,h,f,c,d,p,_,g,b,m,y,w,v,E,T,A,k,I;n=t.state,r=t.next_in,k=t.input,i=r+(t.avail_in-5),a=t.next_out,I=t.output,s=a-(e-t.avail_out),o=a+(t.avail_out-257),u=n.dmax,l=n.wsize,h=n.whave,f=n.wnext,c=n.window,d=n.hold,p=n.bits,_=n.lencode,g=n.distcode,b=(1<<n.lenbits)-1,m=(1<<n.distbits)-1;t:do{p<15&&(d+=k[r++]<<p,p+=8,d+=k[r++]<<p,p+=8),y=_[d&b];e:for(;;){if(d>>>=w=y>>>24,p-=w,0==(w=y>>>16&255))I[a++]=65535&y;else{if(!(16&w)){if(0==(64&w)){y=_[(65535&y)+(d&(1<<w)-1)];continue e}if(32&w){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}v=65535&y,(w&=15)&&(p<w&&(d+=k[r++]<<p,p+=8),v+=d&(1<<w)-1,d>>>=w,p-=w),p<15&&(d+=k[r++]<<p,p+=8,d+=k[r++]<<p,p+=8),y=g[d&m];n:for(;;){if(d>>>=w=y>>>24,p-=w,!(16&(w=y>>>16&255))){if(0==(64&w)){y=g[(65535&y)+(d&(1<<w)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(E=65535&y,p<(w&=15)&&(d+=k[r++]<<p,(p+=8)<w&&(d+=k[r++]<<p,p+=8)),(E+=d&(1<<w)-1)>u){t.msg="invalid distance too far back",n.mode=30;break t}if(d>>>=w,p-=w,E>(w=a-s)){if((w=E-w)>h&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(A=c,(T=0)===f){if(T+=l-w,w<v){for(v-=w;I[a++]=c[T++],--w;);T=a-E,A=I}}else if(f<w){if(T+=l+f-w,(w-=f)<v){for(v-=w;I[a++]=c[T++],--w;);if(T=0,f<v){for(v-=w=f;I[a++]=c[T++],--w;);T=a-E,A=I}}}else if(T+=f-w,w<v){for(v-=w;I[a++]=c[T++],--w;);T=a-E,A=I}for(;2<v;)I[a++]=A[T++],I[a++]=A[T++],I[a++]=A[T++],v-=3;v&&(I[a++]=A[T++],1<v&&(I[a++]=A[T++]))}else{for(T=a-E;I[a++]=I[T++],I[a++]=I[T++],I[a++]=I[T++],2<(v-=3););v&&(I[a++]=I[T++],1<v&&(I[a++]=I[T++]))}break}}break}}while(r<i&&a<o);r-=v=p>>3,d&=(1<<(p-=v<<3))-1,t.next_in=r,t.next_out=a,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=a<o?o-a+257:257-(a-o),n.hold=d,n.bits=p}},function(t,e,n){"use strict";var r=n(8),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,n,u,l,h,f,c){var d,p,_,g,b,m,y,w,v,E=c.bits,T=0,A=0,k=0,I=0,S=0,x=0,O=0,N=0,R=0,L=0,D=null,P=0,C=new r.Buf16(16),F=new r.Buf16(16),M=null,B=0;for(T=0;T<=15;T++)C[T]=0;for(A=0;A<u;A++)C[e[n+A]]++;for(S=E,I=15;1<=I&&0===C[I];I--);if(I<S&&(S=I),0===I)return l[h++]=20971520,l[h++]=20971520,c.bits=1,0;for(k=1;k<I&&0===C[k];k++);for(S<k&&(S=k),T=N=1;T<=15;T++)if(N<<=1,(N-=C[T])<0)return-1;if(0<N&&(0===t||1!==I))return-1;for(F[1]=0,T=1;T<15;T++)F[T+1]=F[T]+C[T];for(A=0;A<u;A++)0!==e[n+A]&&(f[F[e[n+A]]++]=A);if(m=0===t?(D=M=f,19):1===t?(D=i,P-=257,M=a,B-=257,256):(D=s,M=o,-1),T=k,b=h,O=A=L=0,_=-1,g=(R=1<<(x=S))-1,1===t&&852<R||2===t&&592<R)return 1;for(;;){for(y=T-O,v=f[A]<m?(w=0,f[A]):f[A]>m?(w=M[B+f[A]],D[P+f[A]]):(w=96,0),d=1<<T-O,k=p=1<<x;l[b+(L>>O)+(p-=d)]=y<<24|w<<16|v|0,0!==p;);for(d=1<<T-1;L&d;)d>>=1;if(0!==d?(L&=d-1,L+=d):L=0,A++,0==--C[T]){if(T===I)break;T=e[n+f[A]]}if(S<T&&(L&g)!==_){for(0===O&&(O=S),b+=k,N=1<<(x=T-O);x+O<I&&!((N-=C[x+O])<=0);)x++,N<<=1;if(R+=1<<x,1===t&&852<R||2===t&&592<R)return 1;l[_=L&g]=S<<24|x<<16|b-h|0}}return 0!==L&&(l[b+L]=T-O<<24|64<<16|0),c.bits=S,0}},function(t,e,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e){function n(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}function r(t){t.pending+=1;var e=!1;return function(r){if(e)throw new Error("callback called twice");if(e=!0,t.error=t.error||r,t.pending-=1,0<t.waiting.length&&t.pending<t.max)i(t,t.waiting.shift());else if(0===t.pending){var a=t.listeners;t.listeners=[],a.forEach(n)}};function n(e){e(t.error)}}function i(t,e){e(r(t))}(t.exports=n).prototype.go=function(t){this.pending<this.max?i(this,t):this.waiting.push(t)},n.prototype.wait=function(t){0===this.pending?t(this.error):this.listeners.push(t)},n.prototype.hold=function(){return r(this)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=u(n(55)),a=u(n(56)),s=u(n(58)),o=u(n(9));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.resourceUrl=t,n.tileSets=[],n.layers=[],n.background=new PIXI.Graphics,n.create(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,PIXI.Container),r(e,[{key:"create",value:function(){var t=this,e=o.default.dirname(PIXI.loader.resources[this.resourceUrl].url),n=PIXI.loader.resources[this.resourceUrl].data;Object.assign(this,n),this.background.beginFill(0,0),this.background.drawRect(0,0,this._width*this.tileWidth,this._height*this.tileHeight),this.background.endFill(),this.addChild(this.background),this.tileSets=[],n.tileSets.forEach(function(n){t.tileSets.push(new i.default(e,n))},this),this.layers=[],n.layers.forEach(function(n){switch(n.type){case"tile":var r=new a.default(n,t.tileSets);t.layers[n.name]=r,t.addChild(r);break;case"image":var i=new s.default(n,e);t.layers[n.name]=i,t.addChild(i);break;default:t.layers[n.name]=n}})}},{key:"destroy",value:function(){this.tileSets.forEach(function(t){t.destroy()})}}]),e}();e.default=l,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.assign(this,n),this.baseTexture=PIXI.Texture.fromImage(e+"/"+n.image.source,!1,PIXI.SCALE_MODES.NEAREST),this.textures=[];for(var r=this.margin;r<this.image.height;r+=this.tileHeight+this.spacing)for(var i=this.margin;i<this.image.width;i+=this.tileWidth+this.spacing)this.textures.push(new PIXI.Texture(this.baseTexture,new PIXI.Rectangle(i,r,this.tileWidth,this.tileHeight)))}return r(t,[{key:"destroy",value:function(){this.textures.forEach(function(t){t&&t.destroy(!0)}),this.baseTexture&&this.baseTexture.destroy()}}]),t}();e.default=i,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(n(57)),a=function(){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.layer=t,r.tileSets=n,r.alpha=parseFloat(t.opacity),r.tiles=[],Object.assign(r,t),r.create(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,PIXI.Container),r(e,[{key:"create",value:function(){for(var t=0;t<this.layer.map.height;t++)for(var n=0;n<this.layer.map.width;n++){var r=n+t*this.layer.map.width;if(this.layer.tiles[r]&&this.layer.tiles[r].gid&&0!==this.layer.tiles[r].gid){var a=e.findTileset(this.layer.tiles[r].gid,this.tileSets),s=new i.default(this.layer.tiles[r],a,this.layer.horizontalFlips[r],this.layer.verticalFlips[r],this.layer.diagonalFlips[r]);s.x=n*this.layer.map.tileWidth,s.y=t*this.layer.map.tileHeight+(this.layer.map.tileHeight-s.textures[0].height),s._x=n,s._y=t,a.tileOffset&&(s.x+=a.tileOffset.x,s.y+=a.tileOffset.y),1<s.textures.length&&(s.animationSpeed=1e3/60/s.animations[0].duration,s.gotoAndPlay(0)),this.tiles.push(s),this.addChild(s)}}}},{key:"destroy",value:function(){this.tileSets.null,this.tiles.forEach(function(t){t.destroy(!0)})}}],[{key:"findTileset",value:function(t,e){for(var n=void 0,r=e.length-1;0<=r&&!((n=e[r]).firstGid<=t);r--);return n}}]),e}();e.default=a,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function e(t,n,r,i,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=[];t.animations.length?t.animations.forEach(function(t){s.push(n.textures[t.tileId])}):s.push(n.textures[t.gid-n.firstGid]);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s));return o.textures=s,o.tile=t,o.tileSet=n,o.horizontalFlip=r,o.verticalFlip=i,o.diagonalFlip=a,Object.assign(o,t),o.flip(),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,PIXI.extras.AnimatedSprite),r(e,[{key:"flip",value:function(){this.horizontalFlip&&(this.anchor.x=1,this.scale.x=-1),this.verticalFlip&&(this.anchor.y=1,this.scale.y=-1),this.diagonalFlip&&(this.horizontalFlip&&(this.anchor.x=0,this.scale.x=1,this.anchor.y=1,this.scale.y=1,this.rotation=90*PIXI.DEG_TO_RAD),this.verticalFlip&&(this.anchor.x=1,this.scale.x=1,this.anchor.y=0,this.scale.y=1,this.rotation=-90*PIXI.DEG_TO_RAD))}}]),e}();e.default=i,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return Object.assign(r,t),r.alpha=parseFloat(t.opacity),t.image&&t.image.source&&r.addChild(new PIXI.Sprite.fromImage(n+"/"+t.image.source)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,PIXI.Container),e}();e.default=r,t.exports=e.default}],e={},n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=24);function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var t,e});__extends=this&&this.__extends||function(){var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(item){item.hasOwnProperty("append")||Object.defineProperty(item,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var argArr=Array.prototype.slice.call(arguments),docFrag=document.createDocumentFragment();argArr.forEach(function(argItem){var isNode=argItem instanceof Node;docFrag.appendChild(isNode?argItem:document.createTextNode(String(argItem)))}),this.appendChild(docFrag)}})}),function(Array,Object,window){function isArray(array){return array&&array.constructor===Array}window.isArray=isArray;function arrayify(obj){return isArray(obj)?obj:[obj]}window.arrayify=arrayify,Object.defineProperty(Array.prototype,"clone",{enumerable:!1,writable:!1,value:function(isDeepCopy){if(isDeepCopy){var clonedArray=[];return this.forEach(function(element){clonedArray.push(Object.clone(element,!0))}),clonedArray}return this.slice()}});function removeItemFromArray(array,item){if(isFunction(Array.prototype.indexOf)){var itemIndex=array.indexOf(item);return-1<itemIndex?array.splice(itemIndex,1)[0]:void 0}}Object.defineProperty(Array.prototype,"remove",{enumerable:!1,writable:!1,value:function(items){if(isArray(items)){var removedItems=[],self=this;return items.forEach(function(item){var removedItem=removeItemFromArray(self,item);removedItem&&removedItems.push(removedItem)}),removedItems}return removeItemFromArray(this,items)}}),Object.defineProperty(Array.prototype,"clear",{enumerable:!1,writable:!1,value:function(){this.splice(0,this.length)}}),Array.prototype.hasItems||Object.defineProperty(Array.prototype,"hasItems",{get:function(){return 0<this.length}}),Array.prototype.append||Object.defineProperty(Array.prototype,"append",{enumerable:!1,writable:!1,value:function(items){this.push.apply(this,arrayify(items))}}),Array.prototype.first||Object.defineProperty(Array.prototype,"first",{enumerable:!1,writable:!1,value:function(){return this[0]}}),Array.prototype.middle||Object.defineProperty(Array.prototype,"middle",{enumerable:!1,writable:!1,value:function(){return this[this.middleIndex]}}),Array.prototype.wrapIndex||Object.defineProperty(Array.prototype,"wrapIndex",{enumerable:!1,writable:!1,value:function(index,min,max){return min=min||0,max=max||this.length,Math.wrap(index,min,max)}}),Array.prototype.clampIndex||Object.defineProperty(Array.prototype,"clampIndex",{enumerable:!1,writable:!1,value:function(index,min,max){return min=min||0,max=max||this.length-1,Math.clamp(index,min,max)}}),Array.prototype.middleIndex||Object.defineProperty(Array.prototype,"middleIndex",{get:function(){return Math.max(Math.ceil(.5*this.length-1),0)}}),Array.prototype.lastIndex||Object.defineProperty(Array.prototype,"lastIndex",{get:function(){return this.length-1}}),Array.prototype.containsIndex||Object.defineProperty(Array.prototype,"containsIndex",{enumerable:!1,writable:!1,value:function(index){return Math.isInRange(index,0,this.length-1)}}),Array.prototype.randomIndex||Object.defineProperty(Array.prototype,"randomIndex",{enumerable:!1,writable:!1,value:function(previousIndex){if(0===this.length)return-1;var randomIndex,separateLastIndex=!1;for(void 0!==previousIndex&&0<=previousIndex&&previousIndex<this.length&&(separateLastIndex=!0);randomIndex=Math.floor(Math.random()*this.length),separateLastIndex&&randomIndex===previousIndex;);return randomIndex}}),Array.prototype.count||Object.defineProperty(Array.prototype,"count",{value:function(elementCallback,thisArg){if(elementCallback){thisArg||(thisArg=this);for(var count=0,i=0;i<this.length;i++)elementCallback.call(this,this[i],i,this)&&count++;return count}}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(predicate){if(null===this)throw new TypeError('"this" is null or not defined');var o=Object(this),len=o.length>>>0;if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var thisArg=arguments[1],k=0;k<len;){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o))return kValue;k++}}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(predicate){if(null===this)throw new TypeError('"this" is null or not defined');var o=Object(this),len=o.length>>>0;if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var thisArg=arguments[1],k=0;k<len;){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o))return k;k++}return-1}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement,fromIndex){var k;if(null===this)throw new TypeError('"this" is null or not defined');var o=Object(this),len=o.length>>>0;if(0==len)return-1;var n=0|fromIndex;if(len<=n)return-1;for(k=Math.max(0<=n?n:len-Math.abs(n),0);k<len;){if(k in o&&o[k]===searchElement)return k;k++}return-1}),Array.prototype.contains||Object.defineProperty(Array.prototype,"contains",{value:function(item){for(var i=0;i<this.length;i++)if(this[i]===item)return!0;return!1}}),Array.prototype.reverseForEach||Object.defineProperty(Array.prototype,"reverseForEach",{value:function(elementCallback,thisArg){if(elementCallback){thisArg||(thisArg=this);for(var i=this.length-1;0<=i;i--)elementCallback.call(thisArg,this[i],i,this)}}}),Array.prototype.filterOutDuplicates||Object.defineProperty(Array.prototype,"filterOutDuplicates",{value:function(){return this.filter(function(item,i,items){return items.indexOf(item)==i})}}),Array.prototype.filterOutNulls||Object.defineProperty(Array.prototype,"filterOutNulls",{value:function(){return this.filter(function(item,i,items){return!!item})}}),Array.prototype.filterOutItems||Object.defineProperty(Array.prototype,"filterOutItems",{value:function(itemsToExclude){return itemsToExclude=arrayify(itemsToExclude),this.filter(function(item,i,items){return!itemsToExclude.contains(item)})}})}(Array,Object,window),function(Boolean){Boolean.toSignedInt||(Boolean.toSignedInt=function(val){return val?1:-1}),Boolean.toUnsignedInt||(Boolean.toUnsignedInt=function(val){return val?1:0})}(Boolean),HTMLAudioElement,HTMLAudioElement.prototype.stop||Object.defineProperty(HTMLAudioElement.prototype,"stop",{value:function(){this.pause(),this.currentTime=0,this.src=""}}),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(callback,type,quality){var canvas=this;setTimeout(function(){for(var binStr=atob(canvas.toDataURL(type,quality).split(",")[1]),len=binStr.length,arr=new Uint8Array(len),i=0;i<len;i++)arr[i]=binStr.charCodeAt(i);callback(new Blob([arr],{type:type||"image/png"}))})}}),function(Math){var RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;Math.QUARTER_PI=.25*Math.PI,Math.HALF_PI=.5*Math.PI,Math.TWO_PI=2*Math.PI,Math.toDegrees=function(radians){return radians*RAD_TO_DEG},Math.toRadians=function(degrees){return degrees*DEG_TO_RAD},Math.lerp=function(a,b,amount){return(1-amount)*a+amount*b},Math.inverseLerp=function(start,end,value){return(value-start)/(end-start)},Math.wrap=function(value,min,max){var actualMin=Math.min(min,max),actualMax=Math.max(min,max),range=Math.abs(actualMax-actualMin);if(range<1e-4)return actualMin;var result=(value-actualMin)/range;return result=actualMin+(result-=Math.floor(result))*range},Math.clamp=function(value,min,max){return Math.min(Math.max(value,min),max)},Math.saturate=function(value){return Math.clamp(value,0,1)},Math.isInRange=function(value,min,max){return void 0===max&&(max=min,min=0),value<=max&&min<=value},Math.mapValueToRange=function(value,range1Min,range1Max,range2Min,range2Max){var lerpFactor=Math.inverseLerp(range1Min,range1Max,value);return Math.lerp(range2Min,range2Max,lerpFactor)},Math.sign||(Math.sign=function(x){return(0<x)-(x<0)||+x}),Math.trunc||(Math.trunc=function(v){return v=+v,isFinite(v)?v-v%1||(v<0?-0:0===v?v:0):v})}(Math),function(window){window.instanceOf=function(obj,constructor){if(!obj)return!1;if(obj instanceof constructor)return!0;var k,b=!0,po=obj.constructor.prototype,pc=constructor.prototype;for(k in pc)b=b&&k in po;return!!k&&b};window.isDefined=function(variable){return void 0!==variable};window.isFunction=function(Function){return"function"==typeof Function};window.isNumber=function(number){return"number"==typeof number};window.isString=function(str){return"string"==typeof str};window.isBoolean=function(boolVal){return"boolean"==typeof boolVal};window.isObject=function(obj){return null!==obj&&"object"==typeof obj};function nullify(val){return val||null}window.nullify=nullify;window.getProperty=function(obj,propertyString,throwErrorOnNull){throwErrorOnNull=!!throwErrorOnNull;var errorString="Cannot get property '"+propertyString+"'.",parent=obj;if(parent)for(var parts=propertyString?propertyString.split("."):[],i=0;i<parts.length;i++){var part=parts[i];if(!(parent=part?parent[part]:null))break}if(!parent&&throwErrorOnNull)throw errorString;return nullify(parent)},window.EmptyFunction=function(){},window.TrueFunction=function(){return!0},window.FalseFunction=function(){return!1},window.NullFunction=function(){return null}}(window),function(Number){Number.isInteger=Number.isInteger||function(value){return"number"==typeof value&&isFinite(value)&&Math.floor(value)===value},Number.isZero=function(num,threshold){return Number.isInteger(num)?0===num:(isDefined(threshold)||(threshold=1e-4),Math.abs(num)<threshold)},Number.equals=function(value1,value2,threshold){return Number.isInteger(value1)&&Number.isInteger(value2)?value1===value2:(isDefined(threshold)||(threshold=1e-4),Number.isZero(Math.abs(value1-value2),threshold))},Number.isEven=function(value){return value%2==0},Number.isOdd=function(value){return!Number.isEven(value)},Number.prototype.mod=function(n){return(this%n+n)%n}}(Number),function(Object){Object.extend=function(obj,isDeepCopy){var argsStart,args,deepClone;deepClone="boolean"==typeof isDeepCopy?(argsStart=2,isDeepCopy):(argsStart=1,!0),obj=obj||{},args=Array.prototype.slice.call(arguments,argsStart);for(var i=0;i<args.length;i++){var source=args[i];if(source)for(var prop in source)deepClone?source[prop]&&source[prop].constructor===Object?obj[prop]&&obj[prop].constructor!==Object?obj[prop]=source[prop]:(obj[prop]=obj[prop]||{},Object.extend(obj[prop],deepClone,source[prop])):(isArray(source[prop]),obj[prop]=source[prop]):isArray(source[prop])?obj[prop]=source[prop].clone():obj[prop]=source[prop]}return obj},Object.clone=function(obj,isDeepCopy){return Object.extend({},isDeepCopy,obj)},Object.values=function(obj){var values=[];if(obj=obj||{},Object.keys){for(var keys=Object.keys(obj),i=0;i<keys.length;i++)values.push(obj[keys[i]]);return values}for(var key in obj)values.push(obj[key]);return values},Object.omitProperties=function(obj,omittedProps){var result={},omittedProperties=omittedProps||[];if(omittedProperties.constructor!==Array)return result;for(var x in obj=obj||{})-1==omittedProperties.indexOf(x)&&(result[x]=obj[x]);return result},Object.defineProperty(Object.prototype,"forIn",{enumerable:!1,writable:!0,value:function(propertyCallback,thisArg){if(propertyCallback)for(var propID in thisArg||(thisArg=this),this)propertyCallback.call(thisArg,this[propID],propID)}}),Object.defineProperty(Object.prototype,"reverseForIn",{enumerable:!1,writable:!0,value:function(propertyCallback,thisArg){if(propertyCallback){var propID;thisArg||(thisArg=this);var propIDs=[];for(propID in this)propIDs.push(propID);for(var index=propIDs.length-1;0<=index;index--)propID=propIDs[index],propertyCallback.call(thisArg,this[propID],propID)}}}),Object.defineProperty(Object.prototype,"arrayify",{enumerable:!1,writable:!0,value:function(){return Object.keys(this).map(function(key){return this[key]},this)}}),Object.defineProperty(Object.prototype,"map",{enumerable:!1,writable:!0,value:function(propertyCallback,thisArg){if(!propertyCallback)return Object.clone(this,!0);thisArg||(thisArg=this);var obj={};for(var propID in this)obj[propID]=propertyCallback.call(thisArg,this[propID],propID);return obj}})}(Object),function(String){String.prototype.padStart||(String.prototype.padStart=function(targetLength,padString){return targetLength>>=0,padString=String(padString||" "),this.length>targetLength?String(this):((targetLength-=this.length)>padString.length&&(padString+=padString.repeat(targetLength/padString.length)),padString.slice(0,targetLength)+String(this))}),String.prototype.padEnd||(String.prototype.padEnd=function(targetLength,padString){return targetLength>>=0,padString=String(padString||" "),this.length>targetLength?String(this):((targetLength-=this.length)>padString.length&&(padString+=padString.repeat(targetLength/padString.length)),String(this)+padString.slice(0,targetLength))})}(String),function(){var MathExt={};MathExt.QUARTER_PI=Math.QUARTER_PI,MathExt.HALF_PI=Math.HALF_PI,MathExt.PI=Math.PI,MathExt.TWO_PI=Math.TWO_PI,MathExt.toDegrees=Math.toDegrees,MathExt.toRadians=Math.toRadians,MathExt.lerp=Math.lerp,MathExt.inverseLerp=Math.inverseLerp,MathExt.wrap=Math.wrap,MathExt.clamp=Math.clamp,MathExt.saturate=Math.saturate,MathExt.isInRange=Math.isInRange,MathExt.mapValueToRange=Math.mapValueToRange,MathExt.sign=Math.sign,MathExt.randomInt=Math.randomInt,MathExt.randomFloat=Math.randomFloat,window.MathExt=MathExt}(),function(){var SavedData=include("springroll.SavedData"),WEB_STORAGE_SUPPORT=void 0!==window.Storage;SavedData.removeAll=function(){WEB_STORAGE_SUPPORT&&(localStorage.clear(),sessionStorage.clear())},SavedData.removeAllPersistent=function(){WEB_STORAGE_SUPPORT&&localStorage.clear()},SavedData.removeAllTemp=function(){WEB_STORAGE_SUPPORT&&sessionStorage.clear()}}(),function(){var TimeUtils=include("springroll.TimeUtils");TimeUtils.minFrameRate=30,TimeUtils._frameTime=0,TimeUtils._maxFrameTime=1/TimeUtils.minFrameRate,Object.defineProperty(TimeUtils,"frameTime",{get:function(){return Math.min(TimeUtils._frameTime,TimeUtils._maxFrameTime)}})}(),function(){function BaseFactory(){this._creators={}}var p=BaseFactory.prototype;p.registerCreator=function(creatorKey,creatorFunc){this._creators[creatorKey]=creatorFunc},p.registerCreators=function(creators){var self=this;(creators=creators||[]).forEach(function(creator){self._creators[creator.creatorKey]=creator.creatorFunc})},p.deregisterCreator=function(creatorKey){delete this._creators[creatorKey]},p.deregisterCreators=function(){this._creators={}},p.defaultCreator=function(Type){return function(config,callingFunc){return new Type(config)}},namespace("framework").BaseFactory=BaseFactory}(),function(){function _hueToRgbComponent(p,q,t){return t<0&&(t+=1),1<t&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var ColourUtils={colourToNumber:function(colourString){return 3==(colourString=colourString.replace("#","")).length&&(colourString=colourString.charAt(0)+colourString.charAt(0)+colourString.charAt(1)+colourString.charAt(1)+colourString.charAt(2)+colourString.charAt(2)),parseInt(colourString,16)},numberToColour:function(colourNum){return"#"+colourNum.toString(16)},rgbToHex:function(rgb){return parseInt(("0"+rgb.r.toString(16)).slice(-2)+("0"+rgb.g.toString(16)).slice(-2)+("0"+rgb.b.toString(16)).slice(-2),16)},hexToRGB:function(hex){return{r:(hex>>16&255)/255,g:(hex>>8&255)/255,b:(255&hex)/255}},cssColourToRGB:function(cssColour){var out={r:0,g:0,b:0,a:1},result=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(cssColour);return result&&(out.r=parseInt(result[1],10),out.g=parseInt(result[2],10),out.b=parseInt(result[3],10),out.a=void 0!==result[4]?parseFloat(result[4]):1),out},rgbFloatToHex:function(red,green,blue){var rgb={r:red,g:green,b:blue};if(isDefined(red)){isDefined(green)||isDefined(blue)||(rgb={r:red.r,g:red.g,b:red.b}),rgb.r=Math.floor(255*rgb.r),rgb.g=Math.floor(255*rgb.g),rgb.b=Math.floor(255*rgb.b);var hexString=rgb.r.toString(16).padStart(2,"0")+rgb.g.toString(16).padStart(2,"0")+rgb.b.toString(16).padStart(2,"0");return ColourUtils.colourToNumber(hexString)}},rgbHexToFloat:function(rgbHex){return isDefined(rgbHex)?{r:(rgbHex>>16&&255)/255,g:(rgbHex>>8&&255)/255,b:(rgbHex&&255)/255}:null}};ColourUtils.hslToRgb=function(hue,saturation,lightness){isDefined(lightness)||(lightness=.5),isDefined(saturation)||(saturation=1);var outputColour={r:0,g:0,b:0};if(1e-4<saturation){var q=lightness<.5?lightness*(1+saturation):lightness+saturation-lightness*saturation,p=2*lightness-q;outputColour.r=_hueToRgbComponent(p,q,hue+1/3),outputColour.g=_hueToRgbComponent(p,q,hue),outputColour.b=_hueToRgbComponent(p,q,hue-1/3)}else red=lightness,green=lightness,blue=lightness;return outputColour},ColourUtils.biasHueAngle=function(hue){hue-=1/12;var angleBias=.5*Math.cos(6*hue*Math.PI)+.5;return angleBias*=1/12,hue+(angleBias+=1/12*.5)},ColourUtils.lerp=function(colour1,colour2,lerpFactor){return ColourUtils.lerpArray([colour1,colour2],lerpFactor)},ColourUtils.lerpArray=function(colours,lerpFactor){if(!isArray(colours)||!colours.hasItems)return null;if(1==colours.length||lerpFactor<=0)return colours[0];if(1<=lerpFactor)return colours.last();var numSections=colours.length-1,startColourIndex=Math.floor(lerpFactor*numSections),endColourIndex=startColourIndex+1,startColourRGB=ColourUtils.hexToRGB(colours[startColourIndex]),endColourRGB=ColourUtils.hexToRGB(colours[endColourIndex]),segmentMin=startColourIndex/numSections,segmentMax=endColourIndex/numSections,segmentLerpFactor=Math.inverseLerp(segmentMin,segmentMax,lerpFactor),outputRGB={r:Math.lerp(startColourRGB.r,endColourRGB.r,segmentLerpFactor),g:Math.lerp(startColourRGB.g,endColourRGB.g,segmentLerpFactor),b:Math.lerp(startColourRGB.b,endColourRGB.b,segmentLerpFactor)};return ColourUtils.rgbFloatToHex(outputRGB)},namespace("framework").ColourUtils=ColourUtils}(),function(){var DeviceUtils={};Object.defineProperty(DeviceUtils,"isTouchDevice",{get:function(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints}}),Object.defineProperty(DeviceUtils,"isDesktop",{get:function(){return!DeviceUtils.isTouchDevice}}),Object.defineProperty(DeviceUtils,"isWindowsPhone",{get:function(){var ua=navigator.userAgent;return/Windows Phone/i.test(ua)||/IEMobile/i.test(ua)}}),Object.defineProperty(DeviceUtils,"isChrome",{get:function(){var ua=navigator.userAgent;return/Chrome\/(\d+)/.test(ua)&&!DeviceUtils.isWindowsPhone}}),Object.defineProperty(DeviceUtils,"isIE11",{get:function(){return 0<navigator.userAgent.indexOf("Trident/7.0")}}),namespace("framework").DeviceUtils=DeviceUtils}(),function(){var GeneralUtils={},guid=0;GeneralUtils.generateGUID=function(){return guid++},GeneralUtils.generateGUIDString=function(){return""+guid++},namespace("framework").GeneralUtils=GeneralUtils}(),function(){function ObjectPool(config){var finalConfig=Object.extend({createFunc:function(createArgs,index){return{}},destroyFunc:null,initFunc:null,deinitFunc:null,createArgs:{},destroyArgs:{},initArgs:{},deinitArgs:{},capacity:5},config);if(!finalConfig.createFunc)throw"ObjectPool: createFunc is null.";this._defaultGrowCapacity=finalConfig.capacity,this._createFunc=finalConfig.createFunc,this._destroyFunc=finalConfig.destroyFunc,this._initFunc=finalConfig.initFunc,this._deinitFunc=finalConfig.deinitFunc,this._createArgs=finalConfig.createArgs,this._destroyArgs=finalConfig.destroyArgs,this._initArgs=finalConfig.initArgs,this._deinitArgs=finalConfig.deinitArgs,this._objs=[],this._usedIndices=[],this.grow(this._defaultGrowCapacity)}var p=ObjectPool.prototype;p.destroy=function(){this.clear(),this._objs=null,this._usedIndices=null,this._createFunc=null,this._destroyFunc=null,this._initFunc=null,this._deinitFunc=null,this._createArgs=null,this._destroyArgs=null,this._initArgs=null,this._deinitArgs=null},p.get=function(initArgs){if(initArgs=initArgs||this._initArgs,this.isAtFullCapacity()){var numElements=this.capacity()||this._defaultGrowCapacity;this.grow(numElements)}var currentIndex=this.getNextAvailableIndex();this._usedIndices.push(currentIndex),this._usedIndices.sort(function(a,b){return a-b});var obj=this._objs[currentIndex];return this._initFunc&&this._initFunc(obj,initArgs,currentIndex),obj},p.release=function(obj,deinitArgs){deinitArgs=deinitArgs||this._deinitArgs;var currentIndex=this._objs.indexOf(obj),usedIndex=this._usedIndices.indexOf(currentIndex);-1!=usedIndex&&(this._deinitFunc&&this._deinitFunc(obj,deinitArgs,usedIndex),this._usedIndices.splice(usedIndex,1))},p.grow=function(numElements){if(0<(numElements=numElements||this.capacity())){var currentCapacity=this.capacity();this._objs.length+=Number(numElements);for(var i=currentCapacity;i<this.capacity();i++)this._objs[i]=this._createFunc(this._createArgs,i)}return this.capacity()},p.clear=function(){this._usedIndices.reverseForEach(function(usedIndex){var obj=this._objs[usedIndex];this.release(obj)},this),this._usedIndices=[],this._destroyFunc&&this._objs.reverseForEach(function(obj,i){this._destroyFunc(obj,this._destroyArgs,i)},this),this._objs=[]},p.numUsed=function(){return this._usedIndices.length},p.capacity=function(){return this._objs.length},p.isAtFullCapacity=function(){return this.numUsed()==this.capacity()},p.getNextAvailableIndex=function(){var _this=this,nextIndex=0;return this.isAtFullCapacity()?nextIndex=-1:this._usedIndices.hasItems&&(nextIndex=1+this._usedIndices.find(function(usedIndex,i,arr){return 1<(i==arr.lastIndex?_this._objs.lastIndex+1:arr[i+1])-usedIndex})),nextIndex},namespace("framework").ObjectPool=ObjectPool}(),function(){var WindowUtils={registerMouseOut:function(callback){document.addEventListener("mouseout",callback,!1)},deregisterMouseOut:function(callback){document.removeEventListener("mouseout",callback,!1)}};namespace("framework").WindowUtils=WindowUtils}(),function(){var DeviceUtils=include("framework.DeviceUtils"),AudioUtils={getRandomisedVO:function(voList,index,probability){isDefined(index)||(index=Math.randomInt(Math.max(voList.length-1,0))),isDefined(probability)||(probability=1);var randomVO=voList[index].name;randomVO&&voList[index].platformSpecific&&(randomVO+=DeviceUtils.isDesktop?"-desktop":"-mobile");return probability<1&&(randomVO=Math.random()<probability?randomVO:null),randomVO}};namespace("framework").AudioUtils=AudioUtils}(),function(){function AudioRecorder(userAudio,stream,workerPaths){if(!userAudio)throw"AudioRecorder: userAudio is null.";if(!stream)throw"AudioRecorder: stream is null.";this._audioContext=userAudio.context;var createProcessorNode=this._audioContext.createScriptProcessor||this._audioContext.createJavaScriptNode;this._getBufferCallback=null,this._exportCallback=null,this._lastRecordBuffer=[],workerPaths=Object.extend({recorder:"assets/js/audio/RecorderWorker.js",encoder:"assets/js/audio/EncoderWorker.js"},workerPaths),this._recorderWorker=new Worker(workerPaths.recorder),this._encoderWorker=new Worker(workerPaths.encoder),this._recorderWorker.addEventListener("message",this._handleRecorderWorkerMessage.bind(this)),this._recorderWorker.postMessage({command:"init",sampleRate:this._audioContext.sampleRate}),this._sourceNode=this._audioContext.createMediaStreamSource(stream),this._processorNode=createProcessorNode.call(this._audioContext,4096,1,1),this._destinationNode=this._audioContext.destination,this._analyserNode=this._audioContext.createAnalyser(),this._analyserNode.fftSize=2048,this._sourceNode.connect(this._processorNode),this._sourceNode.connect(this._analyserNode),this._processorNode.connect(this._destinationNode)}var p=AudioRecorder.prototype;AudioRecorder.base64PrefixWAV="data:audio/wav;base64,",AudioRecorder.base64PrefixMP3="data:audio/mpeg;base64,",Object.defineProperty(p,"sourceNode",{get:function(){return this._sourceNode}}),Object.defineProperty(p,"processorNode",{get:function(){return this._processorNode}}),Object.defineProperty(p,"destinationNode",{get:function(){return this._destinationNode}}),Object.defineProperty(p,"analyserNode",{get:function(){return this._analyserNode}}),Object.defineProperty(p,"lastRecordBuffer",{get:function(){return this._lastRecordBuffer}}),p.destroy=function(){this._recorderWorker.postMessage({command:"destroy"}),this._sourceNode.disconnect(),this._processorNode.disconnect()},p.start=function(){this._processorNode.onaudioprocess=this._updateRecord.bind(this)},p.stop=function(){this._processorNode.onaudioprocess=null},p.clear=function(){this._recorderWorker.postMessage({command:"clear"})},p.getBuffer=function(returnCallback){this._getBufferCallback=returnCallback,this._recorderWorker.postMessage({command:"getBuffer"})},p.exportBlob=function(exportCallback,mimeType){this._exportCallback=exportCallback,this._recorderWorker.postMessage({command:"exportBlob",type:mimeType||""})},p.exportWAV=function(returnCallback){var fileLoadEndFunc=function(fileReader){return function(){var wavBuffer=new Uint8Array(fileReader.result);if(returnCallback){var encodedBuffer=this._encode64(wavBuffer);returnCallback(encodedBuffer)}}.bind(this)}.bind(this),exportCallback=function(blob){var fileReader=new FileReader;fileReader.addEventListener("loadend",fileLoadEndFunc(fileReader)),fileReader.readAsArrayBuffer(blob)}.bind(this);this.exportBlob(exportCallback,"audio/wav")},p.exportMP3=function(returnCallback){var handleEncoderWorkerMessage=function(event){if("data"===event.data.command&&returnCallback){var encodedBuffer=this._encode64(event.data.buffer);returnCallback(encodedBuffer)}}.bind(this),fileLoadEndFunc=function(fileReader){return function(){var wavBuffer=new Uint8Array(fileReader.result),wavData=this._parseWav(wavBuffer);this._encoderWorker.addEventListener("message",handleEncoderWorkerMessage,{once:!0}),this._encoderWorker.postMessage({command:"init",config:{mode:3,channels:1,sampleRate:wavData.sampleRate,bitRate:wavData.bitsPerSample}}),this._encoderWorker.postMessage({command:"encode",buffer:this._uint8ArrayToFloat32Array(wavData.samples)}),this._encoderWorker.postMessage({command:"finish"})}.bind(this)}.bind(this),exportCallback=function(blob){var fileReader=new FileReader;fileReader.addEventListener("loadend",fileLoadEndFunc(fileReader)),fileReader.readAsArrayBuffer(blob)}.bind(this);this.exportBlob(exportCallback,"audio/mp3")},p._updateRecord=function(event){this._lastRecordBuffer=event.inputBuffer.getChannelData(0),this._recorderWorker.postMessage({command:"record",buffer:this._lastRecordBuffer})},p._handleRecorderWorkerMessage=function(event){switch(event.data.from){case"getBuffer":this._getBufferCallback&&this._getBufferCallback(event.data.buffer);break;case"exportBlob":this._exportCallback&&this._exportCallback(event.data.blob)}},p._encode64=function(buffer){for(var binary="",bytes=new Uint8Array(buffer),length=bytes.byteLength,i=0;i<length;i++)binary+=String.fromCharCode(bytes[i]);return btoa(binary)},p._parseWav=function(wav){function readInt(i,bytes){for(var retValue=0,shift=0;bytes;)retValue+=wav[i]<<shift,shift+=8,i++,bytes--;return retValue}if(1!==readInt(20,2))throw"AudioRecorder._parseWav(): invalid compression code, not PCM.";if(1!==readInt(22,2))throw"AudioRecorder._parseWav(): invalid number of channels, not 1.";return{sampleRate:readInt(24,4),bitsPerSample:readInt(34,2),samples:wav.subarray(44)}},p._uint8ArrayToFloat32Array=function(uint8Array){for(var float32Array=new Float32Array(uint8Array.length),i=0;i<uint8Array.length;i++){var value=uint8Array[i<<1]+(uint8Array[1+(i<<1)]<<8);32768<=value&&(value|=-32768),float32Array[i]=value/32768}return float32Array},namespace("framework").AudioRecorder=AudioRecorder}(),function(){function UserAudio(destroyCompleteCallback){this._destroyCompleteCallback=destroyCompleteCallback||EmptyFunction,this._context=null,this._reusesContext=!1,this._enabled=!0,this._prepareMedia(),this._initAudioContext(),this._initCallbacks()}var p=UserAudio.prototype;Object.defineProperty(p,"context",{get:function(){return this._context}}),p.destroy=function(){this._deinitCallbacks(),this._deinitAudioContext()},p.getAudioStream=function(returnCallback){if(!returnCallback)throw"UserAudio.getAudioStream(): parameter 'returnCallback' is null.";navigator.mediaDevices.getUserMedia({audio:!0}).then(function(stream){returnCallback(stream,null)}).catch(function(error){returnCallback(null,error)})},p.play=function(){this._enabled=!0,this._context.resume()},p.pause=function(){this._enabled=!1,this._context.suspend()},p._prepareMedia=function(){isDefined(navigator.mediaDevices)||(navigator.mediaDevices={}),isDefined(navigator.mediaDevices.getUserMedia)||(navigator.mediaDevices.getUserMedia=function(constraints){var getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return getUserMedia?new Promise(function(resolve,reject){getUserMedia.call(navigator,constraints,resolve,reject)}):Promise.reject(new Error("getUserMedia is not implemented in this browser."))}),window.AudioContext=window.AudioContext||window.webkitAudioContext},p._initAudioContext=function(){return window.createjs&&window.createjs.WebAudioPlugin&&window.createjs.WebAudioPlugin.context?(this._context=window.createjs.WebAudioPlugin.context,this._reusesContext=!0):(this._context=new AudioContext,this._reusesContext=!1),null},p._initCallbacks=function(){this._onPauseInternal||this._onResumeInternal||(this._onPauseInternal=this._onPause.bind(this),this._onResumeInternal=this._onResume.bind(this),app.on("paused",this._onPauseInternal),app.on("resumed",this._onResumeInternal))},p._deinitAudioContext=function(){if(this._reusesContext)this._destroyCompleteCallback();else if(this._context){var context=this._context;this._context=null,context.close().then(this._destroyCompleteCallback)}},p._deinitCallbacks=function(){this._onPauseInternal&&this._onResumeInternal&&(app.off("resumed",this._onResumeInternal),app.off("paused",this._onPauseInternal),this._onResumeInternal=null,this._onPauseInternal=null)},p._onPause=function(){this._reusesContext||this._context.suspend()},p._onResume=function(){!this._reusesContext&&this._enabled&&this._context.resume()},namespace("framework").UserAudio=UserAudio}(),function(){function VCTransition(config){var finalConfig=Object.extend({parent:null,from:null,to:null,action:null},config);this._parent=finalConfig.parent,this._from=finalConfig.from,this._to=finalConfig.to,this._action=finalConfig.action}var p=VCTransition.prototype;Object.defineProperty(p,"parent",{set:function(parent){this._parent=parent},get:function(parent){return this._parent}}),Object.defineProperty(p,"from",{set:function(from){this._from=from},get:function(from){return this._from}}),Object.defineProperty(p,"to",{set:function(to){this._to=to},get:function(to){return this._to}}),Object.defineProperty(p,"action",{set:function(action){this._action=action},get:function(action){return this._action}}),Object.defineProperty(p,"isValid",{get:function(){return this._to!==this._from&&!!this._parent}}),p.has=function(from,to){return from===this._from&&to===this._to},p.start=function(finishedCallback){var transitionFinished=function(){this._from&&this._parent.removeChild(this._from),finishedCallback&&finishedCallback()}.bind(this);this.isValid?(this._to&&(this._to.parentView=this._parent.view,this._parent.addChild(this._to)),this._action=this.createAction(),this._action?(this._parent.cancelAction(this._action),this._parent.runUniqueAction(this._action,transitionFinished)):transitionFinished()):transitionFinished()},p.createAction=function(){return this._action},namespace("framework").VCTransition=VCTransition}(),function(){function Vector(){this.x=0,this.y=0}Vector.create=function(x,y){return{x:x=x||0,y:y=y||(0!==y?x:0)}},Vector.createFromPoints=function(startPoint,endPoint){return Vector.sub(endPoint,startPoint)},Vector.createFromRotation=function(rotation,zeroRotationDir,length){zeroRotationDir=zeroRotationDir||Vector.create(1,0);var baseRotationDir=Vector.normalise(zeroRotationDir),orientationVec=Vector.rotate(baseRotationDir,rotation);return isDefined(length)&&(orientationVec=Vector.mult(orientationVec,length)),orientationVec},Vector.createFromIndex=function(index,width){var xIndex=index%width,yIndex=Math.floor(index/width);return Vector.create(xIndex,yIndex)},Vector.convertToIndex=function(vector,width){return vector.y*width+vector.x},Vector.clone=function(vector){return{x:vector.x,y:vector.y}},Vector.isVector=function(obj){return isDefined(obj.x)&&isDefined(obj.y)},Vector.setEqual=function(vectorA,vectorB){vectorA.x=vectorB.x,vectorA.y=vectorB.y},Vector.magnitude=function(vector){return Math.sqrt(vector.x*vector.x+vector.y*vector.y)},Vector.magnitudeSquared=function(vector){return vector.x*vector.x+vector.y*vector.y},Vector.setMagnitude=function(vector,magnitude){var currentMagnitude=Vector.magnitude(vector);return 0===currentMagnitude?Vector.create(0,0):Vector.mult(vector,magnitude/currentMagnitude)},Vector.setMagnitudeSquared=function(vector,magnitudeSquared){var currentMagnitudeSquared=Vector.magnitudeSquared(vector);return 0===currentMagnitudeSquared?Vector.create(0,0):Vector.mult(vector,Math.sqrt(magnitudeSquared/currentMagnitudeSquared))},Vector.rotate=function(vector,angle){var cos=Math.cos(angle),sin=Math.sin(angle);return{x:vector.x*cos-vector.y*sin,y:vector.x*sin+vector.y*cos}},Vector.rotateAbout=function(vector,angle,point,output){var cos=Math.cos(angle),sin=Math.sin(angle);point||(point=Vector.create(0,0)),output||(output={});var x=point.x+((vector.x-point.x)*cos-(vector.y-point.y)*sin);return output.y=point.y+((vector.x-point.x)*sin+(vector.y-point.y)*cos),output.x=x,output},Vector.normalise=function(vector){var magnitude=Vector.magnitude(vector);return 0===magnitude?{x:0,y:0}:{x:vector.x/magnitude,y:vector.y/magnitude}},Vector.dot=function(vectorA,vectorB){return vectorA.x*vectorB.x+vectorA.y*vectorB.y},Vector.cross=function(vectorA,vectorB){return vectorA.x*vectorB.y-vectorA.y*vectorB.x},Vector.cross3=function(vectorA,vectorB,vectorC){return(vectorB.x-vectorA.x)*(vectorC.y-vectorA.y)-(vectorB.y-vectorA.y)*(vectorC.x-vectorA.x)},Vector.lerp=function(vectorA,vectorB,amount){return Vector.create(Math.lerp(vectorA.x,vectorB.x,amount),Math.lerp(vectorA.y,vectorB.y,amount))},Vector.inverseLerp=function(vectorA,vectorB,lerpedVector){var xLerp=Number.equals(vectorA.x,vectorB.x)?1/0:Math.inverseLerp(vectorA.x,vectorB.x,lerpVector.x),yLerp=Number.equals(vectorA.y,vectorB.y)?1/0:Math.inverseLerp(vectorA.y,vectorB.y,lerpVector.y);return Math.max(xLerp,yLerp)},Vector.add=function(vectorA,vectorB,output){return output||(output={}),output.x=vectorA.x+vectorB.x,output.y=vectorA.y+vectorB.y,output},Vector.sub=function(vectorA,vectorB,output){return output||(output={}),output.x=vectorA.x-vectorB.x,output.y=vectorA.y-vectorB.y,output},Vector.mult=function(vector,scalar){return{x:vector.x*scalar,y:vector.y*scalar}},Vector.componentMult=function(vector1,vector2){return{x:vector1.x*vector2.x,y:vector1.y*vector2.y}},Vector.div=function(vector,scalar){return{x:vector.x/scalar,y:vector.y/scalar}},Vector.componentDiv=function(vector1,vector2){return{x:vector1.x/vector2.x,y:vector1.y/vector2.y}},Vector.perp=function(vector,negate){return{x:(negate=!0===negate?-1:1)*-vector.y,y:negate*vector.x}},Vector.neg=function(vector){return{x:-vector.x,y:-vector.y}},Vector.angle=function(vectorA,vectorB){return Math.atan2(vectorB.y-vectorA.y,vectorB.x-vectorA.x)},Vector.angleBetween=function(vectorA,vectorB){var angleA=Math.atan2(vectorA.y,vectorA.x),angleBetween=Math.atan2(vectorB.y,vectorB.x)-angleA;return angleBetween>Math.PI?angleBetween-=Math.TWO_PI:angleBetween<-Math.PI&&(angleBetween+=Math.TWO_PI),angleBetween},Vector.toAngle=function(vector){return Math.atan2(vector.y,vector.x)},Vector.rotateAroundPoint=function(point,orbitCentre,angle){var displacementVec=Vector.sub(point,orbitCentre),rotatedVec=Vector.rotate(displacementVec,angle);return Vector.add(orbitCentre,rotatedVec)},Vector.scalarProjectOntoLine=function(lineMinPoint,lineMaxPoint,point){var lineVec=Vector.sub(lineMaxPoint,lineMinPoint),lineVecUnit=Vector.normalise(lineVec),lineMinToPointVec=Vector.sub(point,lineMinPoint);return Vector.dot(lineVecUnit,lineMinToPointVec)},Vector.scalarProjectOntoNormal=function(vector,normal){return Vector.dot(normal,vector)},Vector.vectorProjectOntoNormal=function(vector,normal){return Vector.mult(normal,Vector.scalarProjectOntoNormal(vector,normal))},Vector.progressAlongLine=function(lineMinPoint,lineMaxPoint,point){var lineVec=Vector.sub(lineMaxPoint,lineMinPoint),lineVecLen=Vector.magnitude(lineVec),lineVecUnit=Vector.normalise(lineVec),lineMinToPointVec=Vector.sub(point,lineMinPoint);return Vector.dot(lineVecUnit,lineMinToPointVec)/lineVecLen},Vector.closestPointToLine=function(lineMinPoint,lineMaxPoint,point){var lineVec=Vector.sub(lineMaxPoint,lineMinPoint),lineLength=Vector.magnitude(lineVec),lineVecUnit=Vector.div(lineVec,lineLength),lineMinToPointVec=Vector.sub(point,lineMinPoint),scalarProj=Vector.dot(lineVecUnit,lineMinToPointVec);return scalarProj<0&&(scalarProj=0),lineLength<scalarProj&&(scalarProj=lineLength),Vector.add(lineMinPoint,Vector.mult(lineVecUnit,scalarProj))},Vector.distanceFromLine=function(lineMinPoint,lineMaxPoint,point){var closestPoint=Vector.closestPointToLine(lineMinPoint,lineMaxPoint,point);return Vector.magnitude(Vector.sub(point,closestPoint))},Vector.distanceFromLineSquared=function(lineMinPoint,lineMaxPoint,point){var closestPoint=Vector.closestPointToLine(lineMinPoint,lineMaxPoint,point);return Vector.magnitudeSquared(Vector.sub(point,closestPoint))},Vector.reflect=function(incomingVec,normal){return Vector.sub(incomingVec,Vector.mult(Vector.mult(normal,Vector.dot(incomingVec,normal)),2))},Vector.floor=function(vector){return Vector.create(Math.floor(vector.x),Math.floor(vector.y))},Vector.ceil=function(vector){return Vector.create(Math.ceil(vector.x),Math.ceil(vector.y))},Vector.abs=function(vector){return Vector.create(Math.abs(vector.x),Math.abs(vector.y))},Vector.equalTo=function(vectorA,vectorB,threshold){return Number.equals(vectorA.x,vectorB.x,threshold)&&Number.equals(vectorA.y,vectorB.y,threshold)},Vector.lessThan=function(vectorA,vectorB){return vectorA.x<vectorB.x&&vectorB.y<vectorB.y},Vector.lessEqualTo=function(vectorA,vectorB){return vectorA.x<=vectorB.x&&vectorB.y<=vectorB.y},Vector.greaterThan=function(vectorA,vectorB){return vectorA.x>vectorB.x&&vectorB.y>vectorB.y},Vector.greaterEqualTo=function(vectorA,vectorB){return vectorA.x>=vectorB.x&&vectorB.y>=vectorB.y},Vector.addTo=function(vectorA,vectorB){vectorA.x+=vectorB.x,vectorA.y+=vectorB.y},Vector.subtractFrom=function(vectorA,vectorB){vectorA.x-=vectorB.x,vectorA.y-=vectorB.y},Vector.getGlobalPos=function(view){return view?view.toGlobal(new PIXI.Point(0,0)):null},Vector.transformGlobalToChild=function(globalPos,newParentView){return globalPos&&newParentView?newParentView.toLocal(globalPos):globalPos},Vector.transformTo=function(view,newParentView){var globalPos=Vector.getGlobalPos(view);return Vector.transformGlobalToChild(globalPos,newParentView)},Vector.Zero=Vector.create(0,0),Vector.Up=Vector.create(0,-1),Vector.Down=Vector.create(0,1),Vector.Left=Vector.create(-1,0),Vector.Right=Vector.create(1,0),namespace("framework").Vector=Vector}(),function(){function BezierCurve(points){this._points=isDefined(points)?arrayify(points):[],this.isValid()||console.warn("BezierCurve: point list is invalid.")}var p=BezierCurve.prototype;Object.defineProperty(p,"points",{set:function(newPoints){this._points=isDefined(points)?arrayify(points):[],this.isValid()||console.warn("BezierCurve: provided point list is invalid.")},get:function(){return this._points}}),Object.defineProperty(p,"segmentCount",{get:function(){return this.isValid()?Math.floor(this._points.length/3):0}}),p.getPositionAt=function(t){if(!this.isValid())return null;if(t<=0)return this._points.first();if(t>=this.segmentCount)return this._points.last();var startIndex=3*Math.floor(t),unitT=t-Math.floor(t),startPoint=this._points[startIndex],controlPoint1=this._points[1+startIndex],controlPoint2=this._points[2+startIndex],endPoint=this._points[3+startIndex],x=this._solve(startPoint.x,controlPoint1.x,controlPoint2.x,endPoint.x,unitT),y=this._solve(startPoint.y,controlPoint1.y,controlPoint2.y,endPoint.y,unitT);return isDefined(x)&&isDefined(y)?{x:x,y:y}:null},p.getPositionAtUnit=function(unitT){return this.getPositionAt(unitT*this.segmentCount)},p.getXAt=function(y,stopAtFirstResult){},p.getYAt=function(x,stopAtFirstResult){},p.isValid=function(){return 4<=this._points.length&&this._points.length%3==1},p._solve=function(start,cp1,cp2,end,unitT){if(this.isValid()&&Math.isInRange(unitT,0,1)){var displacement=unitT*(end-3*cp2+3*cp1-start);return displacement+=3*cp2-6*cp1+3*start,displacement*=unitT,displacement+=3*cp1-3*start,start+(displacement*=unitT)}},namespace("framework").BezierCurve=BezierCurve}(),function(){function BezierCurveApprox(points,subdivisionsPerSegment){BezierCurve.call(this,points),this._subdivisionsPerSegment=subdivisionsPerSegment||20,this._precomputedLUT=[],this._precomputedRanges=[],this._createLUT()}var BezierCurve=include("framework.BezierCurve"),p=(BezierCurve.prototype,extend(BezierCurveApprox,BezierCurve));Object.defineProperty(p,"points",{set:function(newPoints){this._points=isDefined(points)?arrayify(points):[],this.isValid()||console.warn("BezierCurve: provided point list is invalid."),this._createLUT()},get:function(){return this._points}}),Object.defineProperty(p,"precomputedLUT",{get:function(){return this._precomputedLUT}}),p.getXAt=function(y,stopAtFirstResult){if(this.isValid()){isDefined(stopAtFirstResult)||(stopAtFirstResult=!1);var i,matchingSegment=-1,lowest={segmentIndex:-1,value:Number.POSITIVE_INFINITY},highest={segmentIndex:-1,value:Number.NEGATIVE_INFINITY};for(i=0;i<this.segmentCount;i++){var segmentBounds=this._getSegmentBounds(i);if(segmentBounds&&(segmentBounds.minY<lowest.value&&(lowest.segmentIndex=i,lowest.value=segmentBounds.minY),segmentBounds.maxY>highest.value&&(highest.segmentIndex=i,highest.value=segmentBounds.maxY),Math.isInRange(y,segmentBounds.minY,segmentBounds.maxY))){matchingSegment=i;break}}-1===matchingSegment&&(y<lowest.value?(matchingSegment=lowest.segmentIndex,y=lowest.value):y>highest.value&&(matchingSegment=highest.segmentIndex,y=highest.value));var startIndex=matchingSegment*this._subdivisionsPerSegment,results=[];for(i=0;i<this._subdivisionsPerSegment;i++){var currentIndex=startIndex+i,startPos=this._precomputedLUT[currentIndex],endPos=this._precomputedLUT[currentIndex+1],localT=Math.inverseLerp(startPos.y,endPos.y,y);if(Math.isInRange(localT,0,1)){var result=startPos.x+localT*(endPos.x-startPos.x);if(stopAtFirstResult)return result;results.push(result)}}return results}},p.getYAt=function(x,stopAtFirstResult){if(this.isValid()){isDefined(stopAtFirstResult)||(stopAtFirstResult=!1);var i,matchingSegment=-1,lowest={segmentIndex:-1,value:Number.POSITIVE_INFINITY},highest={segmentIndex:-1,value:Number.NEGATIVE_INFINITY};for(i=0;i<this.segmentCount;i++){var segmentBounds=this._getSegmentBounds(i);if(segmentBounds&&(segmentBounds.minX<lowest.value&&(lowest.segmentIndex=i,lowest.value=segmentBounds.minX),segmentBounds.maxX>highest.value&&(highest.segmentIndex=i,highest.value=segmentBounds.maxX),Math.isInRange(x,segmentBounds.minX,segmentBounds.maxX))){matchingSegment=i;break}}-1===matchingSegment&&(x<lowest.value?(matchingSegment=lowest.segmentIndex,x=lowest.value):x>highest.value&&(matchingSegment=highest.segmentIndex,x=highest.value));var startIndex=matchingSegment*this._subdivisionsPerSegment,results=[];for(i=0;i<this._subdivisionsPerSegment;i++){var currentIndex=startIndex+i,startPos=this._precomputedLUT[currentIndex],endPos=this._precomputedLUT[currentIndex+1],localT=Math.inverseLerp(startPos.x,endPos.x,x);if(Math.isInRange(localT,0,1)){var result=startPos.y+localT*(endPos.y-startPos.y);if(stopAtFirstResult)return result;results.push(result)}}return results}},p._createLUT=function(){this._precomputedLUT.clear(),this._precomputedRanges.clear(),this._precomputedLUT.push(this.getPositionAt(0));for(var i=0;i<this.segmentCount;i++){for(var j=1;j<=this._subdivisionsPerSegment;j++){var t=i+j/this._subdivisionsPerSegment,currentPos=this.getPositionAt(t);currentPos?this._precomputedLUT.push(currentPos):console.warn("Calculated curve position is invalid.")}var segmentStartIndex=this._subdivisionsPerSegment*i,segmentEndIndex=this._precomputedLUT.length,segmentPoints=this._precomputedLUT.slice(segmentStartIndex,segmentEndIndex),segmentRange=this._createRangeFromPoints(segmentPoints);this._precomputedRanges.push(segmentRange)}},p._getSegmentBounds=function(segmentIndex){return Math.isInRange(segmentIndex,0,this.segmentCount-1)?this._precomputedRanges[segmentIndex]:null},p._createRangeFromPoints=function(points){return{minX:points.map(function(point){return point.x}).reduce(function(a,b){return Math.min(a,b)}),maxX:points.map(function(point){return point.x}).reduce(function(a,b){return Math.max(a,b)}),minY:points.map(function(point){return point.y}).reduce(function(a,b){return Math.min(a,b)}),maxY:points.map(function(point){return point.y}).reduce(function(a,b){return Math.max(a,b)})}},namespace("framework").BezierCurveApprox=BezierCurveApprox}(),function(){function LinearCurve(points,usePrecomputedRanges){this._points=isDefined(points)?arrayify(points):[],this._precomputedRanges=[],this._usePrecomputedRanges=!!usePrecomputedRanges,this.isValid()||console.warn("LinearCurve: point list is invalid."),this._usePrecomputedRanges&&this._precomputeRanges()}var p=LinearCurve.prototype;Object.defineProperty(p,"points",{set:function(newPoints){this._points=isDefined(points)?arrayify(points):[],this.isValid()||console.warn("LinearCurve: provided point list is invalid."),this._usePrecomputedRanges&&this._precomputeRanges()},get:function(){return this._points}}),Object.defineProperty(p,"segmentCount",{get:function(){return this.isValid()?this._points.length-1:0}}),p.getPositionAt=function(t){if(!this.isValid())return null;if(t<=0)return this._points.first();if(t>=this.segmentCount)return this._points.last();var startIndex=Math.floor(t),unitT=t-Math.floor(t),startPoint=this._points[startIndex],endPoint=this._points[startIndex+1],x=this._solve(startPoint.x,endPoint.x,unitT),y=this._solve(startPoint.y,endPoint.y,unitT);return isDefined(x)&&isDefined(y)?{x:x,y:y}:null},p.getPositionAtUnit=function(unitT){return this.getPositionAt(unitT*this.segmentCount)},p.getXAt=function(y){if(this.isValid()){var i,matchingSegment=-1,lowest={segmentIndex:-1,value:Number.POSITIVE_INFINITY},highest={segmentIndex:-1,value:Number.NEGATIVE_INFINITY};for(i=0;i<this.segmentCount;i++){var segmentBounds=this._getSegmentBounds(i);if(segmentBounds&&(segmentBounds.minY<lowest.value&&(lowest.segmentIndex=i,lowest.value=segmentBounds.minY),segmentBounds.maxY>highest.value&&(highest.segmentIndex=i,highest.value=segmentBounds.maxY),Math.isInRange(y,segmentBounds.minY,segmentBounds.maxY))){matchingSegment=i;break}}-1===matchingSegment&&(y<lowest.value?(matchingSegment=lowest.segmentIndex,y=lowest.value):y>highest.value&&(matchingSegment=highest.segmentIndex,y=highest.value));var startPos=this._points[matchingSegment],endPos=this._points[matchingSegment+1],localT=Math.inverseLerp(startPos.y,endPos.y,y);return startPos.x+localT*(endPos.x-startPos.x)}},p.getYAt=function(x){if(this.isValid()){var i,matchingSegment=-1,lowest={segmentIndex:-1,value:Number.POSITIVE_INFINITY},highest={segmentIndex:-1,value:Number.NEGATIVE_INFINITY};for(i=0;i<this.segmentCount;i++){var segmentBounds=this._getSegmentBounds(i);if(segmentBounds&&(segmentBounds.minX<lowest.value&&(lowest.segmentIndex=i,lowest.value=segmentBounds.minX),segmentBounds.maxX>highest.value&&(highest.segmentIndex=i,highest.value=segmentBounds.maxX),Math.isInRange(x,segmentBounds.minX,segmentBounds.maxX))){matchingSegment=i;break}}-1===matchingSegment&&(x<lowest.value?(matchingSegment=lowest.segmentIndex,x=lowest.value):x>highest.value&&(matchingSegment=highest.segmentIndex,x=highest.value));var startPos=this._points[matchingSegment],endPos=this._points[matchingSegment+1],localT=Math.inverseLerp(startPos.x,endPos.x,x);return startPos.y+localT*(endPos.y-startPos.y)}},p.isValid=function(){return 2<=this._points.length},p._solve=function(start,end,unitT){if(this.isValid()&&Math.isInRange(unitT,0,1))return Math.lerp(start,end,unitT)},p._precomputeRanges=function(){this._precomputedRanges.clear();for(var i=0;i<this.segmentCount;i++){var segmentPoints=[this._points[i],this._points[i+1]],segmentRange=this._createRangeFromPoints(segmentPoints);this._precomputedRanges.push(segmentRange)}},p._getSegmentBounds=function(segmentIndex){return Math.isInRange(segmentIndex,0,this.segmentCount-1)?this._usePrecomputedRanges?this._precomputedRanges[segmentIndex]:this._createRangeFromPoints([this._points[segmentIndex],this._points[segmentIndex+1]]):null},p._createRangeFromPoints=function(points){return{minX:points.map(function(point){return point.x}).reduce(function(a,b){return Math.min(a,b)}),maxX:points.map(function(point){return point.x}).reduce(function(a,b){return Math.max(a,b)}),minY:points.map(function(point){return point.y}).reduce(function(a,b){return Math.min(a,b)}),maxY:points.map(function(point){return point.y}).reduce(function(a,b){return Math.max(a,b)})}},namespace("framework").LinearCurve=LinearCurve}(),function(){function MinMax(min,max){this.min=min||0,this.max=max||0}var Vector=include("framework.Vector"),p=MinMax.prototype;MinMax.from=function(minMax){return minMax=minMax||new MinMax(0,0),new MinMax(minMax.min,minMax.max)},p.toVector=function(){return Vector.create(this.min,this.max)},p.lerp=function(amount){return Math.lerp(this.min,this.max,amount)},p.inverseLerp=function(value){return Math.inverseLerp(this.min,this.max,value)},p.wrap=function(value){return Math.wrap(value,this.min,this.max)},p.clamp=function(value){return Math.clamp(value,this.min,this.max)},p.isInRange=function(value){return Math.isInRange(value,this.min,this.max)},p.mapFrom=function(value,otherMin,otherMax){return Math.mapValueToRange(value,otherMin,otherMax,this.min,this.max)},p.mapFromOther=function(value,minMax){return minMax=minMax||new MinMax(0,0),this.mapFrom(value,minMax.min,minMax.max)},namespace("framework").MinMax=MinMax}(),function(){function TransformModel(config){var finalConfig=Object.extend({position:{x:0,y:0},rotation:0,scale:{x:1,y:1}},config);this._position=finalConfig.position,this._rotation=finalConfig.rotation,this._scale=finalConfig.scale}var p=TransformModel.prototype;Object.defineProperty(p,"position",{set:function(newPosition){this._position=newPosition},get:function(){return this._position}}),Object.defineProperty(p,"rotation",{set:function(newRotation){this._rotation=newRotation},get:function(){return this._rotation}}),Object.defineProperty(p,"scale",{set:function(newScale){this._scale=newScale},get:function(){return this._scale}}),namespace("framework").TransformModel=TransformModel}(),function(){function KinematicModel(config){var finalConfig=Object.extend({velocity:{x:0,y:0},rotationSpeed:0,maxSpeed:999999.9,maxRotationSpeed:999999.9},config);TransformModel.call(this,finalConfig),this._velocity=finalConfig.velocity,this._rotationSpeed=finalConfig.rotationSpeed,this._maxSpeed=finalConfig.maxSpeed,this._maxRotationSpeed=finalConfig.maxRotationSpeed}var TransformModel=include("framework.TransformModel"),p=(TransformModel.prototype,extend(KinematicModel,TransformModel));Object.defineProperty(p,"velocity",{set:function(newVelocity){this._velocity=newVelocity},get:function(){return this._velocity}}),Object.defineProperty(p,"rotationSpeed",{set:function(newRotationSpeed){this._rotationSpeed=newRotationSpeed},get:function(){return this._rotationSpeed}}),Object.defineProperty(p,"maxSpeed",{set:function(newMaxSpeed){this._maxSpeed=newMaxSpeed},get:function(){return this._maxSpeed}}),Object.defineProperty(p,"maxRotationSpeed",{set:function(newMaxRotationSpeed){this._maxRotationSpeed=newMaxRotationSpeed},get:function(){return this._maxRotationSpeed}}),namespace("framework").KinematicModel=KinematicModel}(),function(){function BoundsModel(config){var finalConfig=Object.extend({position:{x:0,y:0},rotation:0,scale:{x:1,y:1},anchor:{x:0,y:0},width:app.windowRect.width,height:app.windowRect.height},config);this._position=finalConfig.position,this._rotation=Math.wrap(finalConfig.rotation,0,Math.TWO_PI),this._scale=finalConfig.scale,this._anchor=finalConfig.anchor,this._width=finalConfig.width,this._height=finalConfig.height,this._localMinPoint=Vector.create(),this._localMaxPoint=Vector.create(),this.recalculate()}var Enum=include("springroll.Enum"),Vector=include("framework.Vector"),p=BoundsModel.prototype;BoundsModel.Edge=new Enum("Top","Right","Bottom","Left"),(BoundsModel._normals={})[BoundsModel.Edge.Top]=Vector.create(0,-1),BoundsModel._normals[BoundsModel.Edge.Right]=Vector.create(1,0),BoundsModel._normals[BoundsModel.Edge.Bottom]=Vector.create(0,1),BoundsModel._normals[BoundsModel.Edge.Left]=Vector.create(-1,1),Object.defineProperty(p,"position",{set:function(newPosition){this._position=newPosition},get:function(){return this._position}}),Object.defineProperty(p,"rotation",{set:function(newRotation){this._rotation=Math.wrap(newRotation,0,Math.TWO_PI)},get:function(){return this._rotation}}),Object.defineProperty(p,"scale",{set:function(newScale){this._scale=newScale},get:function(){return this._scale}}),Object.defineProperty(p,"anchor",{set:function(newAnchor){this._anchor=anchor},get:function(){return this._anchor}}),Object.defineProperty(p,"width",{set:function(newWidth){this._width=newWidth/this._scale.x},get:function(){return this._width*this._scale.x}}),Object.defineProperty(p,"height",{set:function(newHeight){this._height=newHeight/this._scale.y},get:function(){return this._height*this._scale.y}}),Object.defineProperty(p,"topLeft",{get:function(){return this._localMinPoint}}),Object.defineProperty(p,"topRight",{get:function(){return this._getTopRightCorner()}}),Object.defineProperty(p,"bottomLeft",{get:function(){return this._getBottomLeftCorner()}}),Object.defineProperty(p,"bottomRight",{get:function(){return this._localMaxPoint}}),Object.defineProperty(p,"range",{get:function(){var corners=[this.topLeft,this.topRight,this.bottomLeft,this.bottomRight];return{minX:corners.map(function(corner){return corner.x}).reduce(function(a,b){return Math.min(a,b)}),maxX:corners.map(function(corner){return corner.x}).reduce(function(a,b){return Math.max(a,b)}),minY:corners.map(function(corner){return corner.y}).reduce(function(a,b){return Math.min(a,b)}),maxY:corners.map(function(corner){return corner.y}).reduce(function(a,b){return Math.max(a,b)})}}}),p.overlaps=function(bounds){var allNormals=this.getAllEdgeNormals().concat(bounds.getAllEdgeNormals()),self=this;return allNormals.filter(function(normal){var projections=self.getAllCornerPoints().map(function(point){return Vector.scalarProjectOntoLine(Vector.Zero,normal,point)}),otherProjections=bounds.getAllCornerPoints().map(function(point){return Vector.scalarProjectOntoLine(Vector.Zero,normal,point)}),thisMin=projections.reduce(function(a,b){return Math.min(a,b)}),thisMax=projections.reduce(function(a,b){return Math.max(a,b)}),otherMin=otherProjections.reduce(function(a,b){return Math.min(a,b)}),otherMax=otherProjections.reduce(function(a,b){return Math.max(a,b)});return Math.isInRange(otherMin,thisMin,thisMax)||Math.isInRange(thisMin,otherMin,otherMax)}).length===allNormals.length},p.noLongerContains=function(bounds){return!this.overlaps(bounds)},p.containsPoint=function(point){var xProgress=Vector.progressAlongLine(this._localMinPoint,this._getTopRightCorner(),point),yProgress=Vector.progressAlongLine(this._localMinPoint,this._getBottomLeftCorner(),point);return Math.isInRange(xProgress,0,1)&&Math.isInRange(yProgress,0,1)},p.recalculate=function(){var scaledWidth=this._width*this._scale.x,scaledHeight=this._height*this._scale.y;this._localMinPoint=Vector.create(0,0),this._localMaxPoint=Vector.create(scaledWidth,scaledHeight);var anchorDisplacement=Vector.componentMult(Vector.create(scaledWidth,scaledHeight),this._anchor);this._localMinPoint=Vector.sub(this._localMinPoint,anchorDisplacement),this._localMaxPoint=Vector.sub(this._localMaxPoint,anchorDisplacement),this._localMinPoint=Vector.rotate(this._localMinPoint,this._rotation),this._localMaxPoint=Vector.rotate(this._localMaxPoint,this._rotation),this._localMinPoint=Vector.add(this._localMinPoint,this._position),this._localMaxPoint=Vector.add(this._localMaxPoint,this._position)},p.getEdgeNormal=function(eEdge){var normal=Vector.create(),unrotatedNormal=BoundsModel._normals[eEdge];return isDefined(unrotatedNormal)?Number.isZero(this._rotation)?unrotatedNormal:Vector.rotate(unrotatedNormal,this._rotation):normal},p.getAllEdgeNormals=function(){var edgeNormals=[],self=this;return BoundsModel.Edge.forIn(function(edge){edgeNormals.push(self.getEdgeNormal(edge))}),edgeNormals},p.getAllCornerPoints=function(){var cornerPoints=[];return cornerPoints.push(this._localMinPoint),cornerPoints.push(this._getTopRightCorner()),cornerPoints.push(this._localMaxPoint),cornerPoints.push(this._getBottomLeftCorner()),cornerPoints},p._getTopRightCorner=function(){var xDisplacement=Vector.mult(this.getEdgeNormal(BoundsModel.Edge.Right),this._width);return Vector.add(this._localMinPoint,xDisplacement)},p._getBottomLeftCorner=function(){var yDisplacement=Vector.mult(this.getEdgeNormal(BoundsModel.Edge.Bottom),this._height);return Vector.add(this._localMinPoint,yDisplacement)},namespace("framework").BoundsModel=BoundsModel}(),function(){function CurveModel(config){var finalConfig=Object.extend({position:{x:0,y:0},precomputeLUT:!0,points:[],subdivisionsPerSegment:20},config);this._topLeftPosition=finalConfig.position,this._precomputeLUT=finalConfig.precomputeLUT;var CurveClass=this._precomputeLUT?BezierCurveApprox:BezierCurve;this._curve=new CurveClass(finalConfig.points,finalConfig.subdivisionsPerSegment)}var BezierCurve=include("framework.BezierCurve"),BezierCurveApprox=include("framework.BezierCurveApprox"),Vector=include("framework.Vector"),p=CurveModel.prototype;Object.defineProperty(p,"position",{set:function(newPosition){this._topLeftPosition=newPosition},get:function(){return this._topLeftPosition}}),Object.defineProperty(p,"curve",{get:function(){return this._curve}}),Object.defineProperty(p,"points",{set:function(newPoints){this._curve.points=newPoints},get:function(){return this._curve.points}}),Object.defineProperty(p,"segmentCount",{get:function(){return this._curve.segmentCount}}),p.getPositionAt=function(t){var position=this._curve.getPositionAt(t);return position&&(position=Vector.add(position,this._topLeftPosition)),position},p.getPositionAtUnit=function(unitT){return this._curve.getPositionAtUnit(unitT)},p.getXAt=function(y,stopAtFirstResult){var localY=y-this._topLeftPosition.y,localX=this._curve.getXAt(localY,stopAtFirstResult);if(isArray(localX)){var self=this;localX.forEach(function(x){self._topLeftPosition.x})}else localX+=this._topLeftPosition.x;return localX},p.getYAt=function(x,stopAtFirstResult){var localX=x-this._topLeftPosition.x,localY=this._curve.getYAt(localX,stopAtFirstResult);if(isArray(localY)){var self=this;localY.forEach(function(y){self._topLeftPosition.y})}else localY+=this._topLeftPosition.y;return localY},namespace("framework").CurveModel=CurveModel}(),function(){function LineModel(config){var finalConfig=Object.extend({position:{x:0,y:0},points:[],usePrecomputedRanges:!1},config);this._topLeftPosition=finalConfig.position,this._curve=new LinearCurve(finalConfig.points,finalConfig.usePrecomputedRanges)}var LinearCurve=include("framework.LinearCurve"),Vector=include("framework.Vector"),p=LineModel.prototype;Object.defineProperty(p,"position",{set:function(newPosition){this._topLeftPosition=newPosition},get:function(){return this._topLeftPosition}}),Object.defineProperty(p,"curve",{get:function(){return this._curve}}),Object.defineProperty(p,"points",{set:function(newPoints){this._curve.points=newPoints},get:function(){return this._curve.points}}),Object.defineProperty(p,"segmentCount",{get:function(){return this._curve.segmentCount}}),p.getPositionAt=function(t){var position=this._curve.getPositionAt(t);return position&&(position=Vector.add(position,this._topLeftPosition)),position},p.getPositionAtUnit=function(unitT){return this._curve.getPositionAtUnit(unitT)},p.getXAt=function(y){var localY=y-this._topLeftPosition.y;return this._curve.getXAt(localY)+this._topLeftPosition.x},p.getYAt=function(x){var localX=x-this._topLeftPosition.x;return this._curve.getYAt(localX)+this._topLeftPosition.y},namespace("framework").LineModel=LineModel}(),function(){function PhysicsModel(config){var finalConfig=Object.extend({linearAcceleration:{x:0,y:0},maxLinearAcceleration:999999.9,maxLinearDeceleration:999999.9,linearDrag:1,collisionShapeType:"circle",collisionShapeConfig:{},collisionResponseConfig:{enable:!1,restitution:0}},config);KinematicModel.call(this,finalConfig),this._linearAcceleration=finalConfig.linearAcceleration,this._maxLinearAcceleration=finalConfig.maxLinearAcceleration,this._maxLinearDeceleration=finalConfig.maxLinearDeceleration,this._linearDrag=finalConfig.linearDrag,this._collisionShapeType=finalConfig.collisionShapeType,this._collisionShapeConfig=finalConfig.collisionShapeConfig,this._collisionResponseConfig=finalConfig.collisionResponseConfig}var KinematicModel=include("framework.KinematicModel"),p=(KinematicModel.prototype,extend(PhysicsModel,KinematicModel));Object.defineProperty(p,"linearAcceleration",{set:function(newLinearAcceleration){this._linearAcceleration=newLinearAcceleration},get:function(){return this._linearAcceleration}}),Object.defineProperty(p,"linearDrag",{set:function(newLinearDrag){this._linearDrag=newLinearDrag},get:function(){return this._linearDrag}}),Object.defineProperty(p,"maxLinearAcceleration",{set:function(newMaxLinearAcceleration){this._maxLinearAcceleration=newMaxLinearAcceleration},get:function(){return this._maxLinearAcceleration}}),Object.defineProperty(p,"maxLinearDeceleration",{set:function(newMaxLinearDeceleration){this._maxLinearDeceleration=newMaxLinearDeceleration},get:function(){return this._maxLinearDeceleration}}),Object.defineProperty(p,"collisionShapeType",{set:function(newCollisionShapeType){this._collisionShapeType=newCollisionShapeType},get:function(){return this._collisionShapeType}}),Object.defineProperty(p,"collisionShapeConfig",{set:function(newCollisionShapeConfig){this._collisionShapeConfig=Object.clone(newCollisionShapeConfig,!0)},get:function(){return this._collisionShapeConfig}}),Object.defineProperty(p,"collisionResponseConfig",{set:function(newCollisionResponseConfig){this._collisionResponseConfig=Object.clone(newCollisionResponseConfig,!0)},get:function(){return this._collisionResponseConfig}}),namespace("framework").PhysicsModel=PhysicsModel}(),function(){function ModelFactory(){BaseFactory.call(this),this.registerCreators([{creatorKey:"transform",creatorFunc:this.defaultCreator(TransformModel).bind(this)},{creatorKey:"kinematic",creatorFunc:this.defaultCreator(KinematicModel).bind(this)},{creatorKey:"physics",creatorFunc:this.defaultCreator(PhysicsModel).bind(this)},{creatorKey:"bounds",creatorFunc:this.defaultCreator(BoundsModel).bind(this)},{creatorKey:"line",creatorFunc:this.defaultCreator(LineModel).bind(this)},{creatorKey:"curve",creatorFunc:this.defaultCreator(CurveModel).bind(this)}])}var BaseFactory=include("framework.BaseFactory"),TransformModel=include("framework.TransformModel"),KinematicModel=include("framework.KinematicModel"),PhysicsModel=include("framework.PhysicsModel"),BoundsModel=include("framework.BoundsModel"),LineModel=include("framework.LineModel"),CurveModel=include("framework.CurveModel"),p=(BaseFactory.prototype,extend(ModelFactory,BaseFactory));p.create=function(config){var model=null;if(config&&config.type){var modelCreatorFunc=this._creators[config.type];if(modelCreatorFunc){if(config.modelConfig)throw"ModelFactory: 'modelConfig' property of config is deprecated (just remove it).";model=modelCreatorFunc(config,this.create.bind(this))}}return model},p.createModelFromConfig=function(config){throw"ModelFactory: createModelFromConfig() is deprecated. Use create() instead."},namespace("framework").ModelFactory=ModelFactory}(),function(){function Action(){}var p=Action.prototype;p.reset=function(){},p.update=function(delta,deltaMS){},namespace("framework").Action=Action}(),function(){var Actions=Actions||{};Actions.register=function(key,creatorFunc){key&&creatorFunc&&(isDefined(Actions[key])&&console.warn("Overriding Actions."+key+" factory method."),Actions[key]=creatorFunc)},namespace("framework").Actions=Actions}(),function(){function BlockingFuncAction(func,isLooped){Action.call(this),this.func=func||function(parent,delta,deltaMS){parent.finish()},this.loop=isLooped,this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(BlockingFuncAction,Action));p.reset=function(){this._hasExecutedOnce=!1,this._finished=!1},p.update=function(delta,deltaMS){return this._finished?(this.reset(),!0):(!this.loop&&this._hasExecutedOnce||(this.func(this,delta,deltaMS),this._hasExecutedOnce=!0),!1)},p.finish=function(){this._finished=!0},Actions.register("BlockingFunc",function(func,isLooped){return new BlockingFuncAction(func,isLooped)}),namespace("framework").BlockingFuncAction=BlockingFuncAction}(),function(){function DelayAction(time){Action.call(this),this.time=time,this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(DelayAction,Action));p.reset=function(){this._time=this.time},p.update=function(delta,deltaMS){return this._time-=delta,this._time<=0&&(this.reset(),!0)},Actions.register("Delay",function(time){return new DelayAction(time)}),namespace("framework").DelayAction=DelayAction}(),function(){function VOAction(voName){this._voName=voName,this._isPlaying=!1,BlockingFuncAction.call(this,this._playVO.bind(this),!1)}var BlockingFuncAction=include("framework.BlockingFuncAction"),Actions=include("framework.Actions"),s=BlockingFuncAction.prototype,p=extend(VOAction,BlockingFuncAction);p.reset=function(){s.reset.call(this),this._stopVO()},p._playVO=function(parent,delta,deltaMS){this._stopVO(),this._voName&&app.voPlayer?(this._isPlaying=!0,app.voPlayer.play(this._voName,function(){this._isPlaying=!1,parent.finish()}.bind(this),!0)):parent.finish()},p._stopVO=function(){this._thisVOIsPlaying()&&(app.voPlayer.stop(),this._isPlaying=!1)},p._thisVOIsPlaying=function(){return this._isPlaying&&!!app.voPlayer&&isArray(app.voPlayer.voList)&&1<=app.voPlayer.voList.length&&app.voPlayer.voList[0]===this._voName},Actions.register("VO",function(voName){return new VOAction(voName)}),namespace("framework").VOAction=VOAction}(),function(){function TweenAction(obj,tweenParams){if(tweenParams=Object.extend({from:{},to:{},duration:1,easing:Easing.Linear.None,delayTime:void 0,repeat:void 0,repeatDelayTime:void 0,yoyo:!1,interpolationFunc:Interpolation.Linear,onStart:null,onUpdate:null,onComplete:null,onStop:null,endOnCancel:!1,resetValuesOnStop:!1},tweenParams),!obj)throw"TweenAction: obj is null.";this._obj=obj,this._tweenParams=tweenParams,this._tween=null,BlockingFuncAction.call(this,this._startTween.bind(this),!1)}var BlockingFuncAction=include("framework.BlockingFuncAction"),Actions=include("framework.Actions"),Tween=include("TWEEN.Tween"),Easing=include("TWEEN.Easing"),Interpolation=include("TWEEN.Interpolation"),s=BlockingFuncAction.prototype,p=extend(TweenAction,BlockingFuncAction);Object.defineProperty(p,"tween",{get:function(){return this._tween}}),p.reset=function(){s.reset.call(this),this._stopTween()},p._startTween=function(parent,delta,deltaMS){var tweenParams=this._tweenParams;this._stopTween(),this._tween=new Tween(this._obj),Object.extend(this._obj,tweenParams.from),this._tween.to(tweenParams.to,1e3*tweenParams.duration),this._tween.easing(tweenParams.easing).interpolation(tweenParams.interpolationFunc).onStop(function(obj){this._tween=null,parent.finish(),tweenParams.resetValuesOnStop&&Object.extend(this._obj,tweenParams.from),tweenParams.onStop&&tweenParams.onStop(obj)}.bind(this)).onComplete(function(obj){this._tween.stop(),tweenParams.onComplete&&tweenParams.onComplete(obj)}.bind(this)),isDefined(tweenParams.delayTime)&&this._tween.delay(1e3*tweenParams.delayTime),isDefined(tweenParams.repeat)&&this._tween.repeat(tweenParams.repeat),isDefined(tweenParams.repeatDelayTime)&&this._tween.repeatDelay(1e3*tweenParams.repeatDelayTime),tweenParams.yoyo&&this._tween.yoyo(tweenParams.yoyo),tweenParams.onStart&&this._tween.onStart(tweenParams.onStart),tweenParams.onUpdate&&this._tween.onUpdate(tweenParams.onUpdate),this._tween.start()},p._stopTween=function(){this._tween&&(this._tweenParams.endOnCancel?this._tween.end():this._tween.stop())},Actions.register("Tween",function(obj,tweenParams){return new TweenAction(obj,tweenParams)}),namespace("framework").TweenAction=TweenAction}(),function(){function AnimateSpriteAction(animatedSprite,animationName,params){this._animatedSprite=animatedSprite,this._animationName=animationName,this._params=params,this._isPlaying=!1,BlockingFuncAction.call(this,this._playAnimation.bind(this),!1)}var BlockingFuncAction=include("framework.BlockingFuncAction"),Actions=include("framework.Actions"),s=BlockingFuncAction.prototype,p=extend(AnimateSpriteAction,BlockingFuncAction);p.reset=function(){s.reset.call(this),this._stopAnimation()},p._playAnimation=function(parent,delta,deltaMS){this._stopAnimation(),this._animatedSprite&&this._animationName&&(this._isPlaying=!0,this._animatedSprite.play(this._animationName,this._params,function(){parent.finish()}.bind(this)))},p._stopAnimation=function(){this._isPlaying&&this._animatedSprite&&(this._animatedSprite.stop(),this._isPlaying=!1)},Actions.register("AnimateSprite",function(animatedSprite,animationName,params){return new AnimateSpriteAction(animatedSprite,animationName,params)}),namespace("framework").AnimateSpriteAction=AnimateSpriteAction}(),function(){function BlockingAction(action,isLooped){Action.call(this),this.action=action,this.loop=isLooped,this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(BlockingAction,Action));p.reset=function(){this._hasExecutedOnce=!1,this._finished=!1},p.update=function(delta,deltaMS){!this.loop&&this._hasExecutedOnce||this.action.update(delta,deltaMS)&&(this._hasExecutedOnce=!0,this.action.reset());return!!this._finished&&(this.reset(),!0)},p.finish=function(){this._finished=!0},Actions.register("Blocking",function(action,isLooped){return new BlockingAction(action,isLooped)}),namespace("framework").BlockingAction=BlockingAction}(),function(){function CounterAction(startNum,endNum,duration,onUpdate,tweenParams){if(Action.call(this),!onUpdate)throw"CounterAction: onUpdate(val: number) callback is null.";this._startNum=startNum,this._endNum=endNum,this._duration=duration,this.onUpdate=onUpdate;var finalTweenParams=this._createTweenParams(tweenParams);this._dummyObj={val:0},this._tweenAction=new TweenAction(this._dummyObj,finalTweenParams),this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),TweenAction=include("framework.TweenAction"),p=(Action.prototype,extend(CounterAction,Action));Object.defineProperty(p,"startNum",{get:function(){return this._startNum}}),Object.defineProperty(p,"endNum",{get:function(){return this._endNum}}),Object.defineProperty(p,"duration",{get:function(){return this._duration}}),Object.defineProperty(p,"tweenAction",{get:function(){return this._tweenAction}}),p.reset=function(){this.tweenAction.reset()},p.update=function(delta,deltaMS){return!!this.tweenAction.update(delta,deltaMS)&&(this.reset(),!0)},p._createTweenParams=function(inputTweenParams){var params=Object.extend({},inputTweenParams),onUpdateCallback=params.onUpdate;return Object.extend(params,{from:{val:this._startNum},to:{val:this._endNum},duration:this._duration,onUpdate:function(obj){onUpdateCallback&&onUpdateCallback(obj),this.onUpdate&&this.onUpdate(obj.val)}.bind(this)})},Actions.register("Counter",function(startNum,endNum,duration,onUpdate,tweenParams){return new CounterAction(startNum,endNum,duration,onUpdate,tweenParams)}),namespace("framework").CounterAction=CounterAction}(),function(){function FuncAction(func){Action.call(this),this.func=func||function(){},this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(FuncAction,Action));p.reset=function(){},p.update=function(delta,deltaMS){return this.func(),this.reset(),!0},Actions.register("Func",function(func){return new FuncAction(func)}),namespace("framework").FuncAction=FuncAction}(),function(){function ParallelAction(actions,endOnFirstComplete){Action.call(this),this.actions=actions,this.endOnNextAction=endOnFirstComplete,this._endOnFirstComplete=endOnFirstComplete,this._originalActions=[],this._cacheActions(),this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(ParallelAction,Action));p.reset=function(){this.actions=this._originalActions.slice();for(var i=0;i<this.actions.length;i++){this.actions[i].reset()}this.endOnNextAction=this._endOnFirstComplete},p.update=function(delta,deltaMS){if(!this.actions||!this.actions.length)return!0;for(var result=!0,i=this.actions.length-1;0<=i;i--){var action=this.actions[i];if(action.update(delta,deltaMS)){if(action.reset(),this.actions.splice(i,1),this.endOnNextAction)return!0}else result=!1}return result},p._cacheActions=function(){var actions=this.actions||[];this._originalActions=actions.slice()},Actions.register("Parallel",function(actions,endOnFirstComplete){return new ParallelAction(actions,endOnFirstComplete)}),namespace("framework").ParallelAction=ParallelAction}(),function(){function ParticlesAction(particlesView){if(Action.call(this),!particlesView)throw"ParticlesAction: particlesView is null.";this.particles=particlesView,this._started=!1,this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(ParticlesAction,Action));p.reset=function(){this.particles.enable=!1,this.particles.clear(),this._started=!1},p.update=function(delta,deltaMS){return this._started||(this.particles.enable=!0,this._started=!0),this.particles.update(delta),!!this._particlesFinished()&&(this.reset(),!0)},p._particlesFinished=function(){return!this._emitterIsActive()&&!this._hasActiveParticles()},p._emitterIsActive=function(){return this.particles.enable},p._hasActiveParticles=function(){return 0<this.particles.emitter.particleCount},Actions.register("Particles",function(particlesView){return new ParticlesAction(particlesView)}),namespace("framework").ParticlesAction=ParticlesAction}(),function(){function RandomDelayAction(minTime,maxTime){DelayAction.call(this,0),this.minTime=minTime,this.maxTime=maxTime,this.reset()}var DelayAction=include("framework.DelayAction"),Actions=include("framework.Actions"),s=DelayAction.prototype;extend(RandomDelayAction,DelayAction).reset=function(){var randomFloat=Math.randomFloat(0,1);this.time=Math.lerp(this.minTime,this.maxTime,randomFloat),s.reset.call(this)},Actions.register("RandomDelay",function(minTime,maxTime){return new RandomDelayAction(minTime,maxTime)}),namespace("framework").RandomDelayAction=RandomDelayAction}(),function(){function RandomVOAction(voList){this._voList=voList,VOAction.call(this,null)}var VOAction=include("framework.VOAction"),Actions=include("framework.Actions"),AudioUtils=include("framework.AudioUtils"),p=(VOAction.prototype,extend(RandomVOAction,VOAction));p._playVO=function(parent,delta,deltaMS){this._stopVO(),this._voName=this._getRandomVOName(),this._voName&&app.voPlayer&&(this._isPlaying=!0,app.voPlayer.play(this._voName,function(){this._isPlaying=!1,parent.finish()}.bind(this),!0))},p._getRandomVOName=function(){return AudioUtils.getRandomisedVO(this._voList)},Actions.register("RandomVO",function(voList){return new RandomVOAction(voList)}),namespace("framework").RandomVOAction=RandomVOAction}(),function(){function RepeatAction(action,count,onLoopFinished){Action.call(this),this.action=action,this.count=count,this.onLoopFinished=onLoopFinished||function(count){},this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(RepeatAction,Action));p.reset=function(){this._count=this.count,this._count||(this._count=1/0),this.action.reset()},p.update=function(delta,deltaMS){return this.action.update(delta,deltaMS)&&(this.action.reset(),this._count=this._count-1,this.onLoopFinished&&this.onLoopFinished(this._count)),this._count<=0&&(this.reset(),!0)},Actions.register("Repeat",function(action,count,onLoopFinished){return new RepeatAction(action,count,onLoopFinished)}),namespace("framework").RepeatAction=RepeatAction}(),function(){function SequenceAction(actions){Action.call(this),this.actions=actions,this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(SequenceAction,Action));p.reset=function(){for(var i=this._index=0;i<this.actions.length;i++){this.actions[i].reset()}},p.update=function(delta,deltaMS){if(this._index>=this.actions.length)return!0;var action=this.actions[this._index];return action.update(delta,deltaMS)&&(action.reset(),this._index++),!1},Actions.register("Sequence",function(actions){return new SequenceAction(actions)}),namespace("framework").SequenceAction=SequenceAction}(),function(){function SpineAction(spine,animName,options){var finalOptions=Object.extend({loop:!1,trackIndex:0,endOnCancel:!1,resetValuesOnStop:!1},options);if(Action.call(this),!spine)throw"SpineAction: spine is null.";this.spine=spine,this.animName=animName,this.loop=finalOptions.loop,this.trackIndex=finalOptions.trackIndex,this.endOnCancel=finalOptions.endOnCancel,this.resetValuesOnStop=finalOptions.resetValuesOnStop,this.running=!1,this._action=this._createAction(),this.reset()}var Action=include("framework.Action"),Actions=include("framework.Actions"),p=(Action.prototype,extend(SpineAction,Action));p.reset=function(){this._action.reset(),this._stopAnimation()},p.update=function(delta,deltaMS){return this.running||(this.running=!0),this.spine.autoUpdate||this.spine.update(delta),!!this._action.update(delta,deltaMS)&&(this._finished(),!0)},p._createAction=function(){var delayAction=null;if(this.loop)delayAction=Actions.Repeat(Actions.Func());else{var animation=this.spine.state.data.skeletonData.findAnimation(this.animName);if(!animation)throw"SpineAction: could not find animation for animName '"+this.animName+"'.";var animTime=animation.duration;delayAction=Actions.Delay(animTime)}return Actions.Parallel([Actions.Func(this._playAnimation.bind(this)),delayAction])},p._playAnimation=function(){this.spine.state.setAnimation(this.trackIndex,this.animName,this.loop),this.running=!0},p._stopAnimation=function(){this.running&&(this.endOnCancel?this._endAnimation():this.resetValuesOnStop?this._resetAnimation():this._pauseAnimation(),this.running=!1)},p._endAnimation=function(){var trackEntry=this.spine.state.expandToIndex(this.trackIndex);trackEntry&&(trackEntry.trackTime=trackEntry.trackEnd,this.spine.update(0))},p._resetAnimation=function(){this.spine.state.setAnimation(this.trackIndex,this.animName,!1),this.spine.update(0),this.spine.state.clearTrack(this.trackIndex)},p._pauseAnimation=function(){this.spine.state.clearTrack(this.trackIndex)},p._finished=function(){this.running=!1,this._action.reset()},Actions.register("Spine",function(spine,animName,options){return new SpineAction(spine,animName,options)}),namespace("framework").SpineAction=SpineAction}(),function(){function ActionInstance(action){EventEmitter.call(this),this._id=GeneralUtils.generateGUIDString(),this.action=action,this._started=!1,this._ended=!1,this._active=!1}var EventEmitter=include("PIXI.utils.EventEmitter"),GeneralUtils=include("framework.GeneralUtils"),p=(EventEmitter.prototype,extend(ActionInstance,EventEmitter));p.reset=function(){this._started=!1,this._ended=!1,this._active=!1},p.update=function(delta,deltaMS){this._started||(this.emit("start"),this._started=!0,this._active=!0),this.action.update(delta,deltaMS)&&this._active&&this.end()},p.end=function(){this._ended||(this._finish(),this.emit("end"))},p.cancel=function(){this._ended||(this._finish(),this.action.reset(),this.emit("cancel"))},p.isEnded=function(){return this._ended},p._finish=function(){this._started=!1,this._ended=!0,this._active=!1},namespace("framework").ActionInstance=ActionInstance}(),function(){function ActionManager(){this.actions={},this._actionsToDelete=[],this._last=0}var ActionInstance=include("framework.ActionInstance"),p=ActionManager.prototype;p.update=function(delta){var deltaMS;for(var id in delta||0===delta?deltaMS=1e3*delta:delta=(deltaMS=this._getDeltaMS())/1e3,this.actions)if(Object.prototype.hasOwnProperty.call(this.actions,id)){var actionInstance=this.actions[id];if(this._isQueuedForDeletion(actionInstance))continue;actionInstance.update(delta,deltaMS),actionInstance.isEnded()&&this._actionsToDelete.push(actionInstance)}if(this._actionsToDelete.length){for(var i=0;i<this._actionsToDelete.length;i++)this._deleteAction(this._actionsToDelete[i]);this._actionsToDelete.length=0}},p.runAction=function(action){var actionInstance=new ActionInstance(action);return actionInstance.update(0,0),this.actions[actionInstance._id]=actionInstance},p.cancelAction=function(actionInstance){actionInstance&&(actionInstance.cancel(),this._deleteAction(actionInstance))},p._getDeltaMS=function(){0===this._last&&(this._last=Date.now());var now=Date.now(),deltaMS=now-this._last;return this._last=now,deltaMS},p._isQueuedForDeletion=function(actionInstance){return-1!==this._actionsToDelete.indexOf(actionInstance)},p._deleteAction=function(actionInstance){actionInstance&&this.actions[actionInstance._id]&&delete this.actions[actionInstance._id]},namespace("framework").ActionManager=ActionManager}(),function(){var EventDispatcher=include("springroll.EventDispatcher"),PixiInput=PixiInput||{};PixiInput.Zoomed=!1,PixiInput.KeyboardOpen=!1,PixiInput.onKeyboardEvent=new EventDispatcher,window.PixiInput=PixiInput}(),function(){include("springroll.Application"),include("springroll.EventDispatcher");var Enum=include("springroll.Enum"),InputType=(include("framework.DeviceUtils"),new Enum("text","password","number"));namespace("PixiInput").InputType=InputType;function BaseInputElement(id,type,value,focusEvent){void 0===type&&(type=InputType.text),void 0===value&&(value=""),this.id=id,this.type=type,this.focusEvent=focusEvent,this.keyUpCallback=null,this.element=null}var p=BaseInputElement.prototype;Object.defineProperty(p,"value",{get:function(){return this.element.value},set:function(value){this.element.value=value},enumerable:!0,configurable:!0}),Object.defineProperty(p,"hasSelection",{get:function(){return this.type!==InputType.number&&this.element.selectionStart!==this.element.selectionEnd},enumerable:!0,configurable:!0}),Object.defineProperty(p,"caretStart",{get:function(){return this.element.selectionEnd},enumerable:!0,configurable:!0}),Object.defineProperty(p,"caretEnd",{get:function(){return this.element.selectionStart},enumerable:!0,configurable:!0}),p.preventKeyPropagation=function(evt){evt.stopPropagation?evt.stopPropagation():event.cancelBubble=!0},p.addKeyUpListener=function(callback){this.keyUpCallback=callback},p.removeEventListener=function(){this.keyUpCallback=null},p.blockKeyDownEvents=function(){},p.unblockKeyDownEvents=function(){},p.destroy=function(){},p.focus=function(){},p.blur=function(){},p.setMax=function(max,min){if(void 0!==max)if(this.type===InputType.text||this.type===InputType.password)this.element.maxLength=parseInt(max,10);else if(this.type===InputType.number){if(this.element.max=max,void 0===min)return;this.element.min=min}},p.getCaretPosition=function(){return this.type===InputType.number?-1:this.element.selectionStart},p.setCaretPosition=function(pos){this.type!==InputType.number&&setTimeout(function(){this.element.setSelectionRange(pos,pos)}.bind(this),0)},namespace("PixiInput").BaseInputElement=BaseInputElement}(),function(){function InputElement(id,type,value,focusEvent){BaseInputElement.call(this,id,type,value,focusEvent);var _this=this,canvasTopX=Application.instance.display.canvas.getBoundingClientRect().top+document.body.scrollTop;this.element=document.createElement("input"),this.element.id=id,this.element.style.position="absolute",this.element.style.top=canvasTopX+"px",this.element.style.left=(-40).toString()+"px",this.element.style.width=10..toString()+"px",this.element.style.height=10..toString()+"px",this.element.style.border="0px",this.element.value=this.value,this.element.type=InputType[type],this.element.addEventListener("focusin",function(){_this.focusEvent instanceof EventDispatcher&&_this.focusEvent.trigger("focusIn")}),this.element.addEventListener("focusout",function(){_this.focusEvent instanceof EventDispatcher&&_this.focusEvent.trigger("focusOut")}),document.body.appendChild(this.element)}var BaseInputElement=include("PixiInput.BaseInputElement"),InputType=include("PixiInput.InputType"),Application=include("springroll.Application"),EventDispatcher=include("springroll.EventDispatcher"),DeviceUtils=(include("springroll.Enum"),include("framework.DeviceUtils")),s=BaseInputElement.prototype,p=extend(InputElement,BaseInputElement);p.addKeyUpListener=function(callback){s.addKeyUpListener.call(this,callback),document.addEventListener("keyup",this.keyUpCallback),this.element.addEventListener("input",this.keyUpCallback)},p.removeEventListener=function(){document.removeEventListener("keyup",this.keyUpCallback),this.element.removeEventListener("input",this.keyUpCallback),s.removeEventListener.call(this)},p.blockKeyDownEvents=function(){document.addEventListener("keydown",this.preventKeyPropagation)},p.unblockKeyDownEvents=function(){document.removeEventListener("keydown",this.preventKeyPropagation)},p.destroy=function(){document.body.removeChild(this.element)},p.focus=function(){var _this=this;if(this.element.focus(),!DeviceUtils.isDesktop&&DeviceUtils.isChrome)var originalWidth_1=window.innerWidth,originalHeight_1=window.innerHeight,kbAppeared_1=!1,interval_1=setInterval(function(){(originalWidth_1>window.innerWidth||originalHeight_1>window.innerHeight)&&(kbAppeared_1=!0),kbAppeared_1&&originalWidth_1===window.innerWidth&&originalHeight_1===window.innerHeight&&(_this.focusEvent instanceof EventDispatcher&&_this.focusEvent.trigger("focusOut"),clearInterval(interval_1))},50)},p.blur=function(){this.element.blur()},namespace("PixiInput").InputElement=InputElement}(),function(){function MockDomElement(id,type,value){this.id=id,this.type=InputType[type],this.selectionStart=0,this.selectionEnd=0,this.maxLength=Number.POSITIVE_INFINITY,this.max=Number.POSITIVE_INFINITY,this.min=Number.NEGATIVE_INFINITY,this._value="",this._setValue(value)}var BaseInputElement=include("PixiInput.BaseInputElement"),InputType=include("PixiInput.InputType"),Application=include("springroll.Application");include("springroll.EventDispatcher"),include("springroll.Enum"),include("framework.DeviceUtils");Object.defineProperty(MockDomElement.prototype,"value",{set:function(value){this._setValue(value)},get:function(){return this._value}}),MockDomElement.prototype.setSelectionRange=function(start,end){this.selectionStart=Math.max(start,0),this.selectionEnd=Math.min(end,this._value.length)},MockDomElement.prototype.focus=function(){var app=Application.instance;app.virtualKeyboard&&app.virtualKeyboard.open()},MockDomElement.prototype.blur=function(){var app=Application.instance;app.virtualKeyboard&&app.virtualKeyboard.close()},MockDomElement.prototype._setValue=function(value){this._value;this._value=value;var caretPos=this._value.length;this.setSelectionRange(caretPos,caretPos)};function NonNativeInputElement(id,type,value,focusEvent){BaseInputElement.call(this,id,type,value,focusEvent),this.element=new MockDomElement(id,type,value),this._onKeyDownCallback=null,this._onKeyUpCallback=this._onKeyUp.bind(this);var app=Application.instance;app.virtualKeyboard&&app.virtualKeyboard.events.on("keyUp",this._onKeyUpCallback)}BaseInputElement.prototype;var p=extend(NonNativeInputElement,BaseInputElement);p.blockKeyDownEvents=function(){if(!this._onKeyDownCallback){var app=Application.instance;app.virtualKeyboard&&(this._onKeyDownCallback=this._onKeyDown.bind(this),app.virtualKeyboard.events.on("keyDown",this._onKeyDownCallback))}},p.unblockKeyDownEvents=function(){if(this._onKeyDownCallback){var app=Application.instance;app.virtualKeyboard&&(app.virtualKeyboard.events.off("keyDown",this._onKeyDownCallback),this._onKeyDownCallback=null)}},p.destroy=function(){this.unblockKeyDownEvents();var app=Application.instance;app.virtualKeyboard&&app.virtualKeyboard.events.off("keyUp",this._onKeyUpCallback)},p.focus=function(){this.element.focus()},p.blur=function(){this.element.blur()},p._onKeyDown=function(event,key){this.preventKeyPropagation(event)},p._onKeyUp=function(event,key){if(this.keyUpCallback){event.keyCode=-1,event.preventDefault||(event.preventDefault=function(){});var oldValue=this.element.value,valueStart=oldValue.slice(0,this.element.selectionStart),valueEnd=(oldValue.slice(this.element.selectionStart,this.element.selectionEnd),oldValue.slice(this.element.selectionEnd,oldValue.length)),newCaretIndex=this.element.selectionStart;switch(key){case"backspace":this.element.value=valueStart.slice(0,-1)+valueEnd,newCaretIndex-=1;break;case"enter":this.element.value=valueStart+"\n"+valueEnd,newCaretIndex+=1;break;case"done":event.keyCode=13;break;case"spacebar":this.element.value=valueStart+" "+valueEnd,newCaretIndex+=1;break;default:this.element.value=valueStart+key+valueEnd,newCaretIndex+=1}newCaretIndex=Math.max(Math.min(newCaretIndex,this.element.value.length),0),this.element.setSelectionRange(newCaretIndex,newCaretIndex),this.keyUpCallback(event)}},namespace("PixiInput").NonNativeInputElement=NonNativeInputElement}(),function(){function InputBox(inputOptions){Graphics.call(this),this.bgColor=inputOptions.backgroundColor?parseInt(inputOptions.backgroundColor.slice(1),16):16777215,this.borderRadius=inputOptions.borderRadius||0,this.borderWidth=inputOptions.borderWidth||1,this.borderColor=inputOptions.borderColor?parseInt(inputOptions.borderColor.slice(1),16):9803157,this.boxAlpha=inputOptions.fillAlpha,this.padding=inputOptions.padding;var height=inputOptions.fontSize||inputOptions.height,width=inputOptions.width;this.boxHeight=2*this.padding+height,this.boxWidth=2*this.padding+width,this.drawBox()}var Graphics=include("PIXI.Graphics"),p=(Graphics.prototype,extend(InputBox,Graphics));p.resize=function(newWidth,newHeight){this.boxWidth=2*this.padding+newWidth,this.boxHeight=2*this.padding+newHeight,this.drawBox()},p.drawBox=function(){this.clear().beginFill(this.bgColor,this.boxAlpha).lineStyle(this.borderWidth,this.borderColor,this.boxAlpha),0<this.borderRadius?this.drawRoundedRect(0,0,this.boxWidth,this.boxHeight,this.borderRadius):this.drawRect(0,0,this.boxWidth,this.boxHeight),this.endFill()},namespace("PixiInput").InputBox=InputBox}(),function(){function SelectionHighlight(inputOptions){Graphics.call(this),this.position.x=inputOptions.padding,this.position.y=inputOptions.padding,this.inputOptions=inputOptions}var Graphics=include("PIXI.Graphics"),ColourUtils=include("framework.ColourUtils");Graphics.prototype;extend(SelectionHighlight,Graphics).updateSelection=function(rect){var colour=ColourUtils.cssColourToRGB(this.inputOptions.selectionColor);this.clear().beginFill(ColourUtils.rgbToHex(colour),colour.a).drawRect(rect.x,rect.y,rect.width,rect.height-this.inputOptions.padding)},namespace("PixiInput").SelectionHighlight=SelectionHighlight}(),function(){function TextMask(inputOptions){Graphics.call(this),this.position.x=inputOptions.padding,this.position.y=inputOptions.padding;var height=inputOptions.fontSize||inputOptions.height;this.maskWidth=inputOptions.width,this.maskHeight=1.3*height,this.drawMask()}var Graphics=include("PIXI.Graphics"),p=(Graphics.prototype,extend(TextMask,Graphics));p.resize=function(newWidth,newHeight){this.maskWidth=newWidth,this.maskHeight=1.3*newHeight,this.drawMask()},p.drawMask=function(){this.clear().beginFill(0).drawRect(0,0,this.maskWidth,this.maskHeight).endFill()},namespace("PixiInput").TextMask=TextMask}(),function(){function Cursor(inputOptions,inputField){Text.call(this,"|",{fontFamily:inputOptions.fontFamily||"Arial",fontSize:inputOptions.fontSize||14,fontWeight:inputOptions.fontWeight||"normal",fill:inputOptions.cursorColor||"#000000"}),this._inputOptions=inputOptions,this._inputField=inputField}var Text=include("PIXI.Text");Text.prototype,extend(Cursor,Text);namespace("PixiInput").Cursor=Cursor}(),function(){var Container=include("PIXI.Container"),Text=include("PIXI.Text"),Point=include("PIXI.Point"),TextMetrics=include("PIXI.TextMetrics"),PixiInput=include("PixiInput"),Application=include("springroll.Application"),EventDispatcher=include("springroll.EventDispatcher"),Enum=include("springroll.Enum"),DelayedCall=include("springroll.DelayedCall"),DeviceUtils=include("framework.DeviceUtils"),GeneralUtils=(include("framework.ColourUtils"),include("framework.GeneralUtils")),ForceCase=new Enum("none","lower","upper");namespace("PixiInput").ForceCase=ForceCase;function InputField(inputOptions){void 0===inputOptions&&(inputOptions={}),Container.call(this);var _this=this;this._focus=!1,this.focusOutOnEnter=!0,this.placeHolder=null,this.box=null,this.value="",this.windowScale=1,this.blockInput=!0,this.focusEvent=new EventDispatcher,this.onFocusChanged=new EventDispatcher,this.blink=!0,this.timeSinceLastBlink=0,this._canEdit=!inputOptions.initiallyDisabled,inputOptions.textAlign=inputOptions.align||inputOptions.textAlign,this.inputOptions=inputOptions,this.inputOptions.width="number"==typeof inputOptions.width?inputOptions.width:150,this.inputOptions.padding="number"==typeof inputOptions.padding?inputOptions.padding:0,this.inputOptions.textAlign=inputOptions.textAlign||"left",this.inputOptions.type=PixiInput.InputType[inputOptions.type]||PixiInput.InputType.text,this.inputOptions.forceCase=inputOptions.forceCase?ForceCase[inputOptions.forceCase]:ForceCase.none,this.inputOptions.borderRadius="number"==typeof inputOptions.borderRadius?inputOptions.borderRadius:0,this.inputOptions.height="number"==typeof inputOptions.height?inputOptions.height:14,this.inputOptions.fillAlpha=void 0===inputOptions.fillAlpha?1:inputOptions.fillAlpha,this.inputOptions.selectionColor=inputOptions.selectionColor||"rgba(179, 212, 253, 0.8)",this.inputOptions.zoom=inputOptions.zoom||!1,this.inputOptions.blinkTime="number"==typeof inputOptions.blinkTime?inputOptions.blinkTime:.5,this.inputOptions.moveFieldOnZoom=inputOptions.moveFieldOnZoom||!1,this.inputOptions.focusedTextHeight="number"==typeof inputOptions.focusedTextHeight?inputOptions.focusedTextHeight:50,this.inputOptions.disableTextMask=inputOptions.disableTextMask||!1,this.inputOptions.preventTextScrolling=inputOptions.preventTextScrolling||!1,this.inputOptions.useInAppKeyboard=!DeviceUtils.isDesktop&&(inputOptions.useInAppKeyboard||!1),this.inputOptions.pinCursorToEnd=inputOptions.pinCursorToEnd||!1,this.box=new PixiInput.InputBox(inputOptions),this.addChild(this.box),this.textMask=new PixiInput.TextMask(inputOptions),this.inputOptions.disableTextMask||this.addChild(this.textMask);var InputElementClass=this.inputOptions.useInAppKeyboard?PixiInput.NonNativeInputElement:PixiInput.InputElement;this.domElement=new InputElementClass("pixi-input-"+GeneralUtils.generateGUIDString(),this.inputOptions.type,this.value,this.focusEvent),this.domElement.setMax(this.inputOptions.max,this.inputOptions.min),this.selection=new PixiInput.SelectionHighlight(this.inputOptions),this.addChild(this.selection),this.placeHolder=new Text(inputOptions.placeHolder||"",{fontFamily:inputOptions.fontFamily||"Arial",fontSize:inputOptions.fontSize||14,fontWeight:inputOptions.fontWeight||"normal",fill:inputOptions.placeHolderColor||"#bfbebd"}),this.placeHolder.position.x=this.inputOptions.padding,this.placeHolder.position.y=this.inputOptions.padding,this.addChild(this.placeHolder),this.cursor=new PixiInput.Cursor(inputOptions,this),this.cursor.position.x=this.inputOptions.padding,this.cursor.position.y=this.inputOptions.padding-2,this.cursor.visible=!1,this.addChild(this.cursor),this.text=new Text("",{fontFamily:inputOptions.fontFamily||"Arial",fontSize:inputOptions.fontSize||14,fontWeight:inputOptions.fontWeight||"normal",fill:inputOptions.fill||"#000000",breakWords:!0,wordWrap:!0,wordWrapWidth:inputOptions.width,align:this.inputOptions.textAlign}),this.text.position.x=this.inputOptions.padding,this.text.position.y=this.inputOptions.padding,this.addChild(this.text),this.offscreenText=new Text("",{fontFamily:inputOptions.fontFamily||"Arial",fontSize:inputOptions.fontSize||14,fontWeight:inputOptions.fontWeight||"normal",fill:inputOptions.fill||"#000000",breakWords:!0,wordWrap:!0,wordWrapWidth:inputOptions.width,align:this.inputOptions.textAlign}),this.offscreenText.position.x=this.inputOptions.padding,this.offscreenText.position.y=this.inputOptions.padding,this.inputOptions.disableTextMask||(this.selection.mask=this.textMask,this.placeHolder.mask=this.textMask,this.text.mask=this.textMask),this.updateTextAlignment(),this._checkDownCallback=null,this._enableCheckDownCallback(this._canEdit),this.focusEvent.on("focusOut",function(){PixiInput.KeyboardOpen&&(_this.focus=!1)}),this._oldPosition=new Point(this.position.x,this.position.y),this._oldRotation=this.rotation,this._oldScale=new Point(this.scale.x,this.scale.y)}var s=Container.prototype,p=extend(InputField,Container);Object.defineProperty(p,"width",{get:function(){return this.inputOptions.width},set:function(width){this.inputOptions.width=width,this.box.resize(width,this.box.boxHeight),this.textMask.resize(width,this.textMask.maskHeight),this.updateTextAlignment()},enumerable:!0,configurable:!0}),Object.defineProperty(p,"fontSize",{get:function(){return this.text.style.fontSize},set:function(fontSize){this.placeHolder.style.fontSize=fontSize,this.cursor.style.fontSize=fontSize,this.text.style.fontSize=fontSize,this.offscreenText.style.fontSize=fontSize,this.box.resize(this.box.boxWidth,fontSize),this.textMask.resize(this.textMask.maskWidth,fontSize)}}),Object.defineProperty(p,"focus",{get:function(){return this._focus},set:function(focus){this._setFocus(focus)},enumerable:!0,configurable:!0}),Object.defineProperty(p,"canEdit",{get:function(){return this._canEdit},set:function(canEdit){this._canEdit=canEdit,this._enableCheckDownCallback(canEdit)}}),Object.defineProperty(p,"isEmpty",{get:function(){return 0===this.text.text.replace(/\s+/,"").length}}),p.destroy=function(options){this._enableCheckDownCallback(!1),this.focusEvent.off("focusIn"),this.focusEvent.off("focusOut"),this.domElement.destroy(),s.destroy.call(this,options)},p.update=function(frameTime){this._focus&&(this._textIsEmpty()&&(this.timeSinceLastBlink+=frameTime,this.timeSinceLastBlink>this.inputOptions.blinkTime&&this._showCursor(!this.cursor.visible)),this.inputOptions.pinCursorToEnd&&(this.domElement.setCaretPosition(9999999),this.updateCursor()))},p.updateTextAlignment=function(){switch(this.inputOptions.textAlign){case"left":this.text.anchor.set(0,0),this.text.x=this.inputOptions.padding,null!==this.placeHolder&&this.placeHolder.anchor.set(0,0);break;case"center":this.text.anchor.set(.5,0),this.text.x=this.inputOptions.padding+this.inputOptions.width/2,null!==this.placeHolder&&(this.placeHolder.anchor.set(.5,0),this.placeHolder.x=this.inputOptions.padding+this.inputOptions.width/2);break;case"right":this.text.anchor.set(1,0),this.text.x=this.inputOptions.padding+this.inputOptions.width,null!==this.placeHolder&&(this.placeHolder.anchor.set(1,0),this.placeHolder.x=this.inputOptions.padding+this.inputOptions.width)}this.cursor.position.copy(this.getCaretPosition())},p.checkDown=function(e){var touchPos=e.data.global,touchCollided=this.getBounds().contains(touchPos.x,touchPos.y);touchCollided&&this.setCaretOnClick(e),this.focus=touchCollided},p.startFocus=function(){var _this=this;this._focus||(this._focus=!0,this.prepareFocus(),DeviceUtils.isDesktop?new DelayedCall(function(){_this.keyUpProcessor()},0):this.keyUpProcessor(),this.onFocusChanged.trigger("onFocusIn"),DeviceUtils.isDesktop||(PixiInput.KeyboardOpen=!0,PixiInput.onKeyboardEvent.trigger("onKeyboardOpen")))},p.endFocus=function(){var _this=this;this._focus&&(this._focus=!1,this.domElement.removeEventListener(),this.blockInput&&this.domElement.unblockKeyDownEvents(),this.unprepareFocus(),DeviceUtils.isDesktop?new DelayedCall(function(){_this.domElement.blur()},0):this.domElement.blur(),this.onFocusChanged.trigger("onFocusOut"),DeviceUtils.isDesktop||(PixiInput.KeyboardOpen=!1,PixiInput.onKeyboardEvent.trigger("onKeyboardClose")))},p.prepareFocus=function(){this._showCursor(this._textIsEmpty()),null!==this.placeHolder&&(this.placeHolder.visible=!1)},p.unprepareFocus=function(){0===this.value.length&&null!==this.placeHolder&&(this.placeHolder.visible=!0),this._showCursor(!1)},p.keyUpProcessor=function(){this.domElement.addKeyUpListener(this.keyListener.bind(this)),this.domElement.focus(),this.blockInput&&this.domElement.blockKeyDownEvents()},p.updateText=function(){var text="";if(this.inputOptions.type===PixiInput.InputType.password)for(var i=0;i<this.value.length;i++)text+="*";else if(this.inputOptions.type===PixiInput.InputType.number){var val=parseInt(this.value);text=val<parseInt(this.inputOptions.min)?this.value=this.domElement.value=this.inputOptions.min:val>parseInt(this.inputOptions.max)?this.value=this.domElement.value=this.inputOptions.max:this.value}else text=this.value;if(this.text.text=text,this.text.width>this.inputOptions.width)this.text.anchor.x=1,this.text.x=this.inputOptions.padding+this.inputOptions.width;else switch(this.inputOptions.textAlign){case"left":this.text.anchor.set(0,0),this.text.x=this.inputOptions.padding;break;case"center":this.text.anchor.set(.5,0),this.text.x=this.inputOptions.padding+this.inputOptions.width/2;break;case"right":this.text.anchor.set(1,0),this.text.x=this.inputOptions.padding+this.inputOptions.width}},p.updateCursor=function(){this.cursor.position.copy(this.getCaretPosition())},p.getCaretPosition=function(){var caretIndex1D=this.domElement.getCaretPosition(),caretIndex2D=this._convert1Dto2DCaretIndex(caretIndex1D),cursorPos=this._convert2DCaretIndexToCursorPos(caretIndex2D);cursorPos.x-=.5*this.cursor.width;var textMetrics=TextMetrics.measureText(this.text.text,this.text.style,this.text.style.wordWrap,this.text.canvas);return this.pivot.y=textMetrics.lineHeight*caretIndex2D.line,cursorPos},p.setCaretOnClick=function(e){if(!this.inputOptions.pinCursorToEnd){var cursorPos=this._convertClickPosToCursorPos(e.data.global),sampleLine=TextMetrics.measureText(this.text.text,this.text.style,this.text.style.wordWrap,this.text.canvas).lines.find(function(line){return 0<line.length});this.offscreenText.text=sampleLine;var characterWidth=this.offscreenText.width/sampleLine.length;cursorPos.x+=.5*characterWidth;var caretIndex2D=this._convertCursorPosTo2DCaretIndex(cursorPos),caretIndex1D=this._convert2Dto1DCaretIndex(caretIndex2D);this.domElement.setCaretPosition(caretIndex1D),this.updateCursor()}},p.updateSelection=function(){if(this.domElement.hasSelection){var text=this.value;if(this.inputOptions.type===PixiInput.InputType.password){text="";for(var i=0;i<this.value.length;i++)text+="*"}switch(text=text.substring(this.domElement.caretStart,this.domElement.caretEnd),this.offscreenText.text=text,this.selection.updateSelection(this.offscreenText.getLocalBounds()),this.inputOptions.textAlign){case"left":this.selection.x=this.inputOptions.padding;break;case"center":this.selection.x=this.inputOptions.padding+this.inputOptions.width/2-this.text.width/2}}else this.selection.clear()},p.zoomIn=function(){if(!PixiInput.Zoomed&&!DeviceUtils.isDesktop){var display=Application.instance.display,stage=display.stage,bounds=this.getBounds();if(this.inputOptions.moveFieldOnZoom){this._oldPosition=new Point(this.position.x,this.position.y),this._oldRotation=this.rotation,this._oldScale=new Point(this.scale.x,this.scale.y);var centredPosition=new Point(display.width/2-bounds.width/2,(this.inputOptions.padding+20)*stage.scale.y),parentView=this.parent||this;this.position.copy(parentView.worldTransform.applyInverse(centredPosition)),this.rotation=0;var scaleFactor=this.inputOptions.focusedTextHeight/this.fontSize;this.scale.x*=scaleFactor,this.scale.y*=scaleFactor}else{window.innerHeight>window.innerWidth?this.windowScale=display.width/(1.5*bounds.width):this.windowScale=display.width/2/(1.5*bounds.width);var offsetX=(display.width-1.5*bounds.width)/2/this.windowScale;stage.pivot.set((bounds.x-offsetX)/stage.scale.x,bounds.y/stage.scale.y-this.inputOptions.padding-20),stage.scale.set(stage.scale.x*this.windowScale,stage.scale.y*this.windowScale)}PixiInput.Zoomed=!0}},p.zoomOut=function(){if(PixiInput.Zoomed&&!DeviceUtils.isDesktop){if(this.inputOptions.moveFieldOnZoom)this.position.copy(this._oldPosition),this.rotation=this._oldRotation,this.scale.copy(this._oldScale);else{var stage=Application.instance.display.stage;stage.scale.set(stage.scale.x/this.windowScale,stage.scale.y/this.windowScale),stage.pivot.set(0,0)}PixiInput.Zoomed=!1}},p.keyListener=function(evt){switch(this.setText(this.domElement.value),evt.keyCode){case 13:return void(this.focusOutOnEnter&&(this.focus=!1));case 38:case 40:var textMetrics=TextMetrics.measureText(this.text.text,this.text.style,this.text.style.wordWrap,this.text.canvas),yDisplacement=0;38===evt.keyCode?yDisplacement=-textMetrics.lineHeight:40===evt.keyCode&&(yDisplacement=textMetrics.lineHeight);var predictedCursorPos={x:this.cursor.x,y:this.cursor.y+yDisplacement},caretIndex2D=this._convertCursorPosTo2DCaretIndex(predictedCursorPos),cursorPos=this._convert2DCaretIndexToCursorPos(caretIndex2D);this.cursor.position.copy(cursorPos)}this.updateSelection(),evt.preventDefault()},p.resetText=function(){this.setText()},p.setText=function(text,skipDomElement){if(void 0===text&&(text=""),this.placeHolder.visible=!this.focus&&0===text.length,this._showCursor(this.focus&&0===text.length),this.value=this.getFormattedText(text),!skipDomElement){var caretPosition=this.domElement.getCaretPosition();this.domElement.value=this.value,this.inputOptions.pinCursorToEnd||this.domElement.setCaretPosition(caretPosition)}this.updateText(),this.updateCursor()},p.getFormattedText=function(text){switch(this.inputOptions.forceCase){default:case ForceCase.none:return text;case ForceCase.lower:return text.toLowerCase();case ForceCase.upper:return text.toUpperCase()}},p._textIsEmpty=function(){return" "===this.text.text},p._setFocus=function(focus){focus?this._focus||(this.inputOptions.zoom&&!PixiInput.Zoomed&&this.zoomIn(),this.startFocus()):this._focus&&(this.endFocus(),this.inputOptions.zoom&&this.zoomOut())},p._showCursor=function(show){this.cursor.visible=show,this.blink=!show,this.timeSinceLastBlink=0},p._textExceedsMaxWidth=function(text){return this.offscreenText.text=text.slice(),this.offscreenText.width>this.inputOptions.width},p._enableCheckDownCallback=function(enable){var stage=Application.instance.display.stage;enable&&!this._checkDownCallback?(this._checkDownCallback=this.checkDown.bind(this),stage.interactive=!0,stage.on("mousedown",this._checkDownCallback),stage.on("touchstart",this._checkDownCallback)):this._checkDownCallback&&(stage.removeListener("mousedown",this._checkDownCallback),stage.removeListener("touchstart",this._checkDownCallback),this._checkDownCallback=null)},p._convertClickPosToCursorPos=function(clickPos){return this.worldTransform.applyInverse(clickPos)},p._convertCursorPosTo2DCaretIndex=function(cursorPos){var caretIndex2D={line:0,char:0},textMetrics=TextMetrics.measureText(this.text.text,this.text.style,this.text.style.wordWrap,this.text.canvas);caretIndex2D.line=Math.floor((cursorPos.y-this.text.y)/textMetrics.lineHeight),caretIndex2D.line=Math.clamp(caretIndex2D.line,0,textMetrics.lines.length-1);var lineWidth=textMetrics.lineWidths[caretIndex2D.line],line=textMetrics.lines[caretIndex2D.line],characterWidth=lineWidth/line.length,lineStartX=0;switch(this.inputOptions.textAlign){case"left":lineStartX=this.text.x;break;case"center":lineStartX=this.text.x-.5*lineWidth;break;case"right":lineStartX=this.text.x-lineWidth}for(var cursorLocalX=cursorPos.x-lineStartX,index=0,i=0;i<=line.length;i++)if(i*characterWidth<=cursorLocalX&&cursorLocalX<=(i+1)*characterWidth){index=i;break}return cursorLocalX>line.length*characterWidth&&(index=line.length),caretIndex2D.char=index,caretIndex2D},p._convert2Dto1DCaretIndex=function(caretIndex2D){for(var textMetrics=TextMetrics.measureText(this.text.text,this.text.style,this.text.style.wordWrap,this.text.canvas),index=0,lineIndex=Math.clamp(caretIndex2D.line,0,textMetrics.lines.length-1),i=0;i<lineIndex;i++)index+=textMetrics.lines[i].length;return index+=caretIndex2D.char},p._convert1Dto2DCaretIndex=function(caretIndex1D){for(var textMetrics=TextMetrics.measureText(this.text.text,this.text.style,this.text.style.wordWrap,this.text.canvas),lineStartCaretIndex=0,lineEndCaretIndex=0,lineIndex=0;lineIndex<textMetrics.lines.length;){if(caretIndex1D<(lineEndCaretIndex=lineStartCaretIndex+textMetrics.lines[lineIndex].length+1))break;lineStartCaretIndex=lineEndCaretIndex,lineIndex++}return 9999999===caretIndex1D&&(lineIndex=Math.max(textMetrics.lines.length-1,0)),{line:lineIndex,char:caretIndex1D-lineStartCaretIndex}},p._convert2DCaretIndexToCursorPos=function(caretIndex2D){var pos={x:0,y:0},textMetrics=TextMetrics.measureText(this.text.text,this.text.style,this.text.style.wordWrap,this.text.canvas),lineIndex=Math.clamp(caretIndex2D.line,0,textMetrics.lines.length-1);pos.y=this.text.y+textMetrics.lineHeight*lineIndex;var lineWidth=textMetrics.lineWidths[lineIndex],lineStartX=0;switch(this.inputOptions.textAlign){case"left":lineStartX=this.text.x;break;case"center":lineStartX=this.text.x-.5*lineWidth;break;case"right":lineStartX=this.text.x-lineWidth}var line=textMetrics.lines[lineIndex];return this.offscreenText.text=line.slice(0,caretIndex2D.char),pos.x=lineStartX+this.offscreenText.width,pos},namespace("PixiInput").InputField=InputField}(),function(){function ContainerView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,predicate:this._sortZIndexAsc.bind(this)},config);if(Container.call(this),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.predicate=finalConfig.predicate,finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var Container=include("PIXI.Container"),s=Container.prototype,p=extend(ContainerView,Container);p.postInit=function(){this._postInitHelper(this)},p.getChildByName=function(name){return this._getChildByNameHelper(this,name)},p.clear=function(){this.removeChildren()},p.addChild=function(child){[].slice.call(arguments).forEach(function(childToAdd){var index=this.computeOrderedIndex(childToAdd);s.addChildAt.call(this,childToAdd,index)},this)},p.addChildAt=function(child,index){if(!(!child||index<0||index>this.children.length)){var zIndex=0;if(0<this.children.length){var lowerIndex=Math.clamp(index-1,0,this.children.length-1),upperIndex=Math.clamp(index,0,this.children.length-1),lowerZIndex=this._getZIndex(this.children[lowerIndex]),diff=this._getZIndex(this.children[upperIndex])-lowerZIndex;zIndex=Math.floor(lowerZIndex+.5*diff)}child.zIndex=zIndex,s.addChildAt.call(this,child,index)}},p.refreshOrder=function(){this.children.sort(this.predicate)},p.computeOrderedIndex=function(child){for(var i=0;i<this.children.length&&0<=this.predicate(child,this.children[i]);)i++;return i},p._postInitImpl=function(){},p._postInitHelper=function(view){if(view.children&&view.children.length&&0<view.children.length)for(var i=0;i<view.children.length;i++)this._postInitHelper(view.children[i]);"function"==typeof view._postInitImpl&&view._postInitImpl()},p._getChildByNameHelper=function(view,name){if(view.children&&view.children.length&&0<view.children.length)for(var i=0;i<view.children.length;i++){var childView=this._getChildByNameHelper(view.children[i],name);if(childView)return childView}return view.name&&view.name===name?view:null},p._sortZIndexAsc=function(a,b){return this._getZIndex(a)-this._getZIndex(b)},p._getZIndex=function(child){return child&&child.zIndex?child.zIndex:0},namespace("framework").ContainerView=ContainerView}(),function(){function GraphicsView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff"},config);if(Graphics.call(this),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.tint=ColourUtils.colourToNumber(finalConfig.colourTint),finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var Graphics=include("PIXI.Graphics"),ColourUtils=include("framework.ColourUtils");Graphics.prototype,extend(GraphicsView,Graphics);namespace("framework").GraphicsView=GraphicsView}(),function(){function SpriteView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff",textureName:null,texture:null,anchor:{x:0,y:0},blendMode:"NORMAL"},config),texture=finalConfig.textureName?app.getCache(finalConfig.textureName):finalConfig.texture;if(Sprite.call(this,texture),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.tint=ColourUtils.colourToNumber(finalConfig.colourTint),this.anchor.x=finalConfig.anchor.x,this.anchor.y=finalConfig.anchor.y,this.blendMode=BlendModes[finalConfig.blendMode],finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var Sprite=include("PIXI.Sprite"),Rectangle=include("PIXI.Rectangle"),BlendModes=include("PIXI.BLEND_MODES"),ColourUtils=include("framework.ColourUtils"),s=Sprite.prototype,p=extend(SpriteView,Sprite);p.updateTexture=function(textureName){this.texture=textureName?app.getCache(textureName):null},p.postInit=function(){this._postInitImpl()},p.getLocalBounds=function(rect){return rect=rect||new Rectangle,s.getLocalBounds.call(this,rect),0===this.children.length&&(this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),rect.height=this._bounds.maxY-this._bounds.minY),rect},p._postInitImpl=function(){},namespace("framework").SpriteView=SpriteView}(),function(){function AnimatedSpriteView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff",textureName:null,anchor:{x:0,y:0},blendMode:"NORMAL",playAnimationOnInit:!1,initialAnimationParams:{animationName:null,soundName:null,startAtRandomTime:!1}},config);AdvancedMovieClip.call(this);var movieClipInstance=finalConfig.textureName?app.getCache(finalConfig.textureName):null;if(movieClipInstance&&this.copyFrom(movieClipInstance),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.tint=ColourUtils.colourToNumber(finalConfig.colourTint),this.anchor.x=finalConfig.anchor.x,this.anchor.y=finalConfig.anchor.y,this.blendMode=BlendModes[finalConfig.blendMode],this._currentTimeline=null,finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}finalConfig.playAnimationOnInit&&finalConfig.initialAnimationParams.animationName?this.play(finalConfig.initialAnimationParams.animationName,{soundName:finalConfig.initialAnimationParams.soundName,startAtRandomTime:finalConfig.initialAnimationParams.startAtRandomTime}):this.gotoAndStop(0)}var AdvancedMovieClip=include("springroll.pixi.AdvancedMovieClip"),Rectangle=include("PIXI.Rectangle"),BlendModes=include("PIXI.BLEND_MODES"),ColourUtils=include("framework.ColourUtils"),s=AdvancedMovieClip.prototype,p=extend(AnimatedSpriteView,AdvancedMovieClip);p.destroy=function(){this.stop(!0),this._currentTimeline=null,s.destroy.call(this)},p.play=function(animationName,optionalParams,completeCallback,cancelledCallback){function onCompleteFunc(thisArg,callback){return function(){optionalParams&&optionalParams.gotoFrameZeroOnStop&&this.gotoAndStop(0),this._currentTimeline=null,callback&&callback()}.bind(thisArg)}var params;isDefined(completeCallback)||(completeCallback=null),cancelledCallback||(cancelledCallback=completeCallback),params=optionalParams?{anim:animationName,start:optionalParams.startAtRandomTime?-1:0,speed:1,audio:{alias:optionalParams.soundName,delay:0}}:animationName;var completeFunc=this.isLoopedAnim(animationName)?null:onCompleteFunc(this,completeCallback),cancelledFunc=onCompleteFunc(this,cancelledCallback);this._currentTimeline=app.animator.play(this,params,completeFunc,cancelledFunc)},p.stop=function(removeCallbacks){app.animator.stop(this,removeCallbacks),this._currentTimeline=null},p.isLooping=function(){return this._currentTimeline&&this._currentTimeline.isLooping},p.isLoopedAnim=function(animName){var labelDatas=this._labels||[],animLabel=animName+"_loop";return labelDatas.find(function(labelData){return labelData&&labelData.label==animLabel})},p.postInit=function(){this._postInitImpl()},p.getLocalBounds=function(rect){return rect=rect||new Rectangle,s.getLocalBounds.call(this,rect),0===this.children.length&&(this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),rect.height=this._bounds.maxY-this._bounds.minY),rect},p._postInitImpl=function(){},namespace("framework").AnimatedSpriteView=AnimatedSpriteView}(),function(){function BinarySpriteView(config){var finalConfig=Object.extend({textureName:null,enabledTextureName:null,initiallyEnabled:!1},config);SpriteView.call(this,config),this._offTexture=finalConfig.textureName?app.getCache(finalConfig.textureName):null,this._onTexture=finalConfig.enabledTextureName?app.getCache(finalConfig.enabledTextureName):null,this._isOn=finalConfig.initiallyEnabled,this.texture=this._isOn?this._onTexture:this._offTexture}var SpriteView=include("framework.SpriteView"),p=(SpriteView.prototype,extend(BinarySpriteView,SpriteView));Object.defineProperty(p,"enable",{set:function(turnOn){this.texture=turnOn?this._onTexture:this._offTexture,this._isOn=turnOn},get:function(){return this._isOn}}),Object.defineProperty(p,"offTexture",{set:function(offTexture){this._offTexture=offTexture?app.getCache(offTexture):null}}),Object.defineProperty(p,"onTexture",{set:function(onTexture){this._onTexture=onTexture?app.getCache(onTexture):null}}),namespace("framework").BinarySpriteView=BinarySpriteView}(),function(){function ButtonView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},anchor:null,alpha:1,isInteractive:!0,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff",textureName:null,labelTextView:null,isEnabled:!0,imageFrameNames:{up:"",over:"",down:"",disabled:""},clickSoundName:null},config);if(!finalConfig.textureName)throw"ButtonView: textureName is null.";var imageFrames={up:null,over:null,down:null,disabled:null},buttonSpriteSheet=app.getCache(finalConfig.textureName);if(!buttonSpriteSheet)throw"ButtonView: could not find button sprite sheet for '"+finalConfig.textureName+"'.";if(imageFrames.up=buttonSpriteSheet.getFrame(finalConfig.imageFrameNames.up),imageFrames.over=buttonSpriteSheet.getFrame(finalConfig.imageFrameNames.over),imageFrames.down=buttonSpriteSheet.getFrame(finalConfig.imageFrameNames.down),imageFrames.disabled=buttonSpriteSheet.getFrame(finalConfig.imageFrameNames.disabled),!imageFrames.up)throw"ButtonView: could not find button up frame '"+finalConfig.imageFrameNames.up+"'.";if(Button.call(this,imageFrames,finalConfig.labelTextView,finalConfig.isEnabled),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.back.tint=ColourUtils.colourToNumber(finalConfig.colourTint),finalConfig.anchor&&this._setAnchor(finalConfig.anchor),this.clickSoundName=finalConfig.clickSoundName,!this.clickSoundName||void 0!==this.clickSoundName.length&&0!==this.clickSoundName.length||(this.clickSoundName=null),finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var Button=include("springroll.pixi.Button"),ColourUtils=include("framework.ColourUtils"),s=Button.prototype,p=extend(ButtonView,Button);Object.defineProperty(p,"tint",{set:function(tint){this.back.tint=tint},get:function(){return this.back.tint}}),Object.defineProperty(p,"anchor",{set:function(anchor){this._setAnchor(anchor)},get:function(){return this.back.anchor}}),p._onUp=function(event){s._onUp.call(this,event),this.clickSoundName&&app.sound.play(this.clickSoundName)},p._setAnchor=function(anchor){this.back.anchor.copy(anchor),this.label&&this.label.anchor.copy(anchor)},namespace("framework").ButtonView=ButtonView}(),function(){function CircleView(config){var finalConfig=Object.extend({fillColour:"#ffffff",fillAlpha:1,lineWidth:1,lineColour:"#ffffff",lineAlpha:1,isWireframe:!1,radius:10},config);GraphicsView.call(this,finalConfig),this.fillColour=ColourUtils.colourToNumber(finalConfig.fillColour),this.fillAlpha=finalConfig.fillAlpha,this.lineWidth=finalConfig.lineWidth,this.lineColour=ColourUtils.colourToNumber(finalConfig.lineColour),this.lineAlpha=finalConfig.lineAlpha,this.isWireframe=finalConfig.isWireframe,this.radius=finalConfig.radius,this._fillCircle()}var GraphicsView=include("framework.GraphicsView"),ColourUtils=include("framework.ColourUtils");GraphicsView.prototype;extend(CircleView,GraphicsView)._fillCircle=function(){var fillColour=this.isWireframe?0:this.fillColour,fillAlpha=this.isWireframe?0:this.fillAlpha;this.clear().beginFill(fillColour,fillAlpha).lineStyle(this.lineWidth,this.lineColour,this.lineAlpha).drawCircle(0,0,this.radius).endFill()},namespace("framework").CircleView=CircleView}(),function(){function CurveView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff",curveColour:"#ffffff",curveAlpha:1,curveWidth:1,curveIsVisible:!0,approximatedPointsColour:"#00ff00",approximatedPointsAlpha:1,approximatedPointsRadius:10,approximatedPointsAreVisible:!1,controlPointColour:"#ff0000",controlPointAlpha:1,controlPointRadius:10,controlPointsAreVisible:!1,tangentColour:"#0000ff",tangentAlpha:1,tangentWidth:1,tangentsAreVisible:!1,vertexList:[],precomputedLUT:[]},config);if(Graphics.call(this),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.tint=ColourUtils.colourToNumber(finalConfig.colourTint),this.curveColour=ColourUtils.colourToNumber(finalConfig.curveColour),this.curveAlpha=finalConfig.curveAlpha,this.curveWidth=finalConfig.curveWidth,this.curveIsVisible=finalConfig.curveIsVisible,this.approximatedPointsColour=ColourUtils.colourToNumber(finalConfig.approximatedPointsColour),this.approximatedPointsAlpha=finalConfig.approximatedPointsAlpha,this.approximatedPointsRadius=finalConfig.approximatedPointsRadius,this.approximatedPointsAreVisible=finalConfig.approximatedPointsAreVisible,this.controlPointColour=ColourUtils.colourToNumber(finalConfig.controlPointColour),this.controlPointAlpha=finalConfig.controlPointAlpha,this.controlPointRadius=finalConfig.controlPointRadius,this.controlPointsAreVisible=finalConfig.controlPointsAreVisible,this.tangentColour=ColourUtils.colourToNumber(finalConfig.tangentColour),this.tangentAlpha=finalConfig.tangentAlpha,this.tangentWidth=finalConfig.tangentWidth,this.tangentsAreVisible=finalConfig.tangentsAreVisible,this._curve=new Graphics,this._approximatedPoints=new Graphics,this._controlPoints=new Graphics,this._tangents=new Graphics,this._curve.visible=this.curveIsVisible,this._approximatedPoints.visible=this.approximatedPointsAreVisible,this._controlPoints.visible=this.controlPointsAreVisible,this._tangents.visible=this.tangentsAreVisible,this.addChild(this._curve),this.addChild(this._tangents),this.addChild(this._approximatedPoints),this.addChild(this._controlPoints),this._vertexList=finalConfig.vertexList,this._precomputedLUT=finalConfig.precomputedLUT,this._refreshCanvas(),finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var Graphics=include("PIXI.Graphics"),ColourUtils=include("framework.ColourUtils"),p=(Graphics.prototype,extend(CurveView,Graphics));Object.defineProperty(p,"vertexList",{set:function(newVertexList){this._vertexList=newVertexList,this._refreshCanvas()},get:function(){return this._vertexList}}),Object.defineProperty(p,"precomputedLUT",{set:function(newPrecomputedLUT){this._precomputedLUT=newPrecomputedLUT,this._refreshCanvas()},get:function(){return this._precomputedLUT}}),p._refreshCanvas=function(){if(this._curve.clear(),this._approximatedPoints.clear(),this._controlPoints.clear(),this._tangents.clear(),this._vertexList&&this._vertexList.length&&!(this._vertexList.length<4)&&this._vertexList.length%3==1){var i,startIndex,controlPoint1,controlPoint2,endPoint,curveSegmentCount=Math.floor(this._vertexList.length/3);for(this._curve.lineStyle(this.curveWidth,this.curveColour,this.curveAlpha),this._curve.moveTo(this._vertexList[0].x,this._vertexList[0].y),i=0;i<curveSegmentCount;i++)startIndex=3*i,controlPoint1=this._vertexList[startIndex+1],controlPoint2=this._vertexList[startIndex+2],endPoint=this._vertexList[startIndex+3],this._curve.bezierCurveTo(controlPoint1.x,controlPoint1.y,controlPoint2.x,controlPoint2.y,endPoint.x,endPoint.y);if(this._precomputedLUT){for(this._approximatedPoints.beginFill(this.approximatedPointsColour,this.approximatedPointsAlpha),this._approximatedPoints.lineStyle(1,this.approximatedPointsColour,this.approximatedPointsAlpha),i=0;i<this._precomputedLUT.length;i++)this._approximatedPoints.drawCircle(this._precomputedLUT[i].x,this._precomputedLUT[i].y,this.approximatedPointsRadius);this._approximatedPoints.endFill()}for(this._tangents.lineStyle(this.tangentWidth,this.tangentColour,this.tangentAlpha),i=0;i<curveSegmentCount;i++){startIndex=3*i;var startPoint=this._vertexList[startIndex];controlPoint1=this._vertexList[startIndex+1],controlPoint2=this._vertexList[startIndex+2],endPoint=this._vertexList[startIndex+3],this._tangents.moveTo(startPoint.x,startPoint.y),this._tangents.lineTo(controlPoint1.x,controlPoint1.y),this._tangents.moveTo(controlPoint2.x,controlPoint2.y),this._tangents.lineTo(endPoint.x,endPoint.y)}for(this._controlPoints.beginFill(this.controlPointColour,this.controlPointAlpha),this._controlPoints.lineStyle(1,this.controlPointColour,this.controlPointAlpha),i=0;i<this._vertexList.length;i++)this._controlPoints.drawCircle(this._vertexList[i].x,this._vertexList[i].y,this.controlPointRadius);this._controlPoints.endFill()}},namespace("framework").CurveView=CurveView}(),function(){function DualSpriteView(config){var finalConfig=Object.extend({initiallyEnabled:!1},config);ContainerView.call(this,config),this.initiallyEnabled=finalConfig.initiallyEnabled}var ContainerView=include("framework.ContainerView"),p=(ContainerView.prototype,extend(DualSpriteView,ContainerView));Object.defineProperty(p,"enable",{set:function(turnOn){this.front.visible=turnOn},get:function(){return this.front.visible}}),p._postInitImpl=function(){if(this.back=this.getChildByName("back"),this.front=this.getChildByName("front"),!this.back)throw"DualSpriteView: could not find 'back' child.";if(!this.front)throw"DualSpriteView: could not find 'front' child.";this.back.visible=!0,this.front.visible=this.initiallyEnabled},namespace("framework").DualSpriteView=DualSpriteView}(),function(){function EditTextView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff",style:{fill:"#ffffff"}},config);if(isDefined(finalConfig.canvasModeColour)&&!app.display.isWebGL&&(finalConfig.style.fill=finalConfig.canvasModeColour),InputField.call(this,finalConfig.style),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.tint=ColourUtils.colourToNumber(finalConfig.colourTint),finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var InputField=include("PixiInput.InputField"),ColourUtils=include("framework.ColourUtils");InputField.prototype,extend(EditTextView,InputField);namespace("framework").EditTextView=EditTextView}(),function(){function KeyboardKeyView(config){var finalConfig=Object.extend({kind:"",value:""},config);ContainerView.call(this,finalConfig),this._kind=finalConfig.kind,this._value=finalConfig.value,this._buildView(finalConfig)}var ContainerView=include("framework.ContainerView"),Rectangle=include("PIXI.Rectangle"),Sprite=include("PIXI.Sprite"),p=(ContainerView.prototype,extend(KeyboardKeyView,ContainerView));Object.defineProperty(p,"kind",{get:function(){return this._kind}}),Object.defineProperty(p,"value",{get:function(){return this._value}}),p.setHighlighted=function(isHighlighted){this.children.forEach(function(child){child.setHighlighted(isHighlighted)})},p._buildView=function(config){switch(config.kind){case"alpha":this._buildTextButton(config,70,80,40);break;case"backspace":this._buildBackspaceButton(config,110,80);break;case"enter":case"done":this._buildTextButton(config,110,80,35);break;case"spacebar":this._buildTextButton(config,360,80,35);break;case"goToPunc":case"goToAlpha":this._buildTextButton(config,110,80,35);break;case"shiftOn":this._buildShiftButton(config,110,80,!0);break;case"shiftOff":this._buildShiftButton(config,110,80,!1);break;case"punc1":case"punc2":this._buildTextButton(config,110,80,35)}},p._buildTextButton=function(config,width,height,fontSize){this.addChild(this._createShadowView(width,25,30)),this.addChild(this._createBackView(width,height)),this.addChild(this._createFrontTextView(config.value,fontSize)),this.hitArea=this._createHitArea(width,height,10)},p._buildShiftButton=function(config,width,height,isOn){this.addChild(this._createShadowView(width,25,30)),this.addChild(this._createBackView(width,height)),this.addChild(this._createShiftView(isOn)),this.hitArea=this._createHitArea(width,height,10)},p._buildBackspaceButton=function(config,width,height){this.addChild(this._createShadowView(width,25,30)),this.addChild(this._createBackView(width,height)),this.addChild(this._createBackspaceView()),this.addChild(this._createFrontTextView("X",20,{x:10,y:0})),this.hitArea=this._createHitArea(width,height,10)},p._createShadowView=function(width,height,yPos){var shadowView=app.viewFactory.create({type:"rectangle",position:{x:0,y:yPos},fillColour:"#aaaaaa",lineWidth:0,width:width,height:height,cornerRadius:12.5});return shadowView.setHighlighted=function(isHighlighted){},shadowView},p._createBackView=function(width,height){function createRectConfig(fillColour,visible){return{type:"rectangle",isVisible:visible,fillColour:fillColour,lineWidth:0,width:width,height:height,cornerRadius:12.5}}var backViewTint_highlighted="#999999",backViewTint_unhighlighted="#ffffff",highlightedView=app.viewFactory.create(createRectConfig(backViewTint_highlighted,!1)),unhighlightedView=app.viewFactory.create(createRectConfig(backViewTint_unhighlighted,!0)),backView=app.viewFactory.create({type:"container"});return backView.addChild(highlightedView),backView.addChild(unhighlightedView),backView.setHighlighted=function(isHighlighted){highlightedView.visible=isHighlighted,unhighlightedView.visible=!isHighlighted},backView},p._createFrontTextView=function(value,fontSize,position){var frontViewTint_highlighted="#ffffff",frontViewTint_unhighlighted="#444444";position=position||{x:0,y:0};function createTextConfig(fillColour){return{type:"text",initialText:value,style:{fontSize:fontSize,fill:fillColour,align:"center"}}}var highlightedView=app.viewFactory.create(createTextConfig(frontViewTint_highlighted)),unhighlightedView=app.viewFactory.create(createTextConfig(frontViewTint_unhighlighted)),highlightedSpriteView=this._convertTextToSprite(highlightedView,!1),unhighlightedSpriteView=this._convertTextToSprite(unhighlightedView,!0),frontView=app.viewFactory.create({type:"container"});return frontView.position.copy(position),frontView.addChild(highlightedSpriteView),frontView.addChild(unhighlightedSpriteView),highlightedView.destroy(!0),unhighlightedView.destroy(!0),frontView.setHighlighted=function(isHighlighted){highlightedSpriteView.visible=isHighlighted,unhighlightedSpriteView.visible=!isHighlighted},frontView},p._createShiftView=function(isOn){function createShiftIconConfig(colour,isWireframe,visible){return{type:"primitive",isVisible:visible,fillColour:colour,lineColour:colour,lineWidth:4,isWireframe:isWireframe,vertexList:[{x:0,y:-20},{x:20,y:0},{x:10,y:0},{x:10,y:20},{x:-10,y:20},{x:-10,y:0},{x:-20,y:0}]}}var filledIconConfig=createShiftIconConfig("#444444",!1,isOn),wireframeIconConfig=createShiftIconConfig("#444444",!0,!0),highlightedConfig=filledIconConfig,unhighlightConfig=isOn?filledIconConfig:wireframeIconConfig,highlightedView=app.viewFactory.create(highlightedConfig),unhighlightedView=app.viewFactory.create(unhighlightConfig),shiftView=app.viewFactory.create({type:"container"});return shiftView.addChild(highlightedView),shiftView.addChild(unhighlightedView),shiftView.setHighlighted=function(isHighlighted){highlightedView.visible=isHighlighted,unhighlightedView.visible=!isHighlighted},shiftView},p._createBackspaceView=function(){function createBackspaceIconConfig(colour,isWireframe,visible){return{type:"primitive",isVisible:visible,fillColour:colour,lineColour:colour,lineWidth:4,isWireframe:isWireframe,vertexList:[{x:-30,y:0},{x:-10,y:-15},{x:30,y:-15},{x:30,y:15},{x:-10,y:15}]}}var highlightedView=app.viewFactory.create(createBackspaceIconConfig("#444444",!1,!1)),unhighlightedView=app.viewFactory.create(createBackspaceIconConfig("#444444",!0,!0)),backspaceView=app.viewFactory.create({type:"container"});return backspaceView.addChild(highlightedView),backspaceView.addChild(unhighlightedView),backspaceView.setHighlighted=function(isHighlighted){highlightedView.visible=isHighlighted,unhighlightedView.visible=!isHighlighted},backspaceView},p._createHitArea=function(width,height,padding){return new Rectangle(.5*-width-padding,.5*-height-padding,width+2*padding,height+2*padding)},p._convertTextToSprite=function(textView,visible){var texture=app.display.renderer.generateTexture(textView),textSprite=new Sprite(texture);return textSprite.anchor.set(.5),textSprite.visible=visible,textSprite},namespace("framework").KeyboardKeyView=KeyboardKeyView}(),function(){function LineView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff",lineColour:"#ffffff",lineAlpha:1,lineWidth:1,lineIsVisible:!0,pointsColour:"#00ff00",pointsAlpha:1,pointsRadius:10,pointsAreVisible:!1,vertexList:[]},config);if(Graphics.call(this),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.tint=ColourUtils.colourToNumber(finalConfig.colourTint),this.lineColour=ColourUtils.colourToNumber(finalConfig.lineColour),this.lineAlpha=finalConfig.lineAlpha,this.lineWidth=finalConfig.lineWidth,this.lineIsVisible=finalConfig.lineIsVisible,this.pointsColour=ColourUtils.colourToNumber(finalConfig.pointsColour),this.pointsAlpha=finalConfig.pointsAlpha,this.pointsRadius=finalConfig.pointsRadius,this.pointsAreVisible=finalConfig.pointsAreVisible,this._vertexList=finalConfig.vertexList,this._refreshCanvas(),finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var Graphics=include("PIXI.Graphics"),ColourUtils=include("framework.ColourUtils"),p=(Graphics.prototype,extend(LineView,Graphics));Object.defineProperty(p,"vertexList",{set:function(newVertexList){this._vertexList=newVertexList,this._refreshCanvas()},get:function(){return this._vertexList}}),p._refreshCanvas=function(){var lineWidth=this.lineWidth;if(this.clear(),this._vertexList&&this._vertexList.length&&2<=this._vertexList.length){if(this.lineIsVisible)for(this.lineStyle(lineWidth,this.lineColour,this.lineAlpha),this.moveTo(this._vertexList[0].x,this._vertexList[0].y),i=1;i<this._vertexList.length;i++)this.lineTo(this._vertexList[i].x,this._vertexList[i].y);if(this.pointsAreVisible){for(this.beginFill(this.pointsColour,this.pointsAlpha),this.lineStyle(1,this.pointsColour,this.pointsAlpha),i=0;i<this._vertexList.length;i++)this.drawCircle(this._vertexList[i].x,this._vertexList[i].y,this.pointsRadius);this.endFill()}}this.lineWidth=lineWidth},namespace("framework").LineView=LineView}(),function(){function ParticlesView(config){var finalConfig=Object.extend({textureNames:[],config:null,configProp:"",initiallyEnabled:!1},config);ContainerView.call(this,config);var textures=finalConfig.textureNames.map(function(textureName){return app.getCache(textureName)});if(!ParticlesEmitter)throw"ParticlesView: need to include 'pixi-particles' library to use this class.";var emitterConfig=finalConfig.config;emitterConfig||(emitterConfig=getProperty(Application,"instance.config."+finalConfig.configProp)),this._emitter=new ParticlesEmitter(this,textures,emitterConfig),this._emitter.emit=finalConfig.initiallyEnabled}var ContainerView=include("framework.ContainerView"),ParticlesEmitter=include("PIXI.particles.Emitter",!1),Application=include("springroll.Application"),s=ContainerView.prototype,p=extend(ParticlesView,ContainerView);p.destroy=function(options){app.display.isWebGL&&(app.display.renderer.plugins.sprite.sprites.length=0),s.destroy.call(this,options)},Object.defineProperty(p,"emitter",{get:function(){return this._emitter}}),Object.defineProperty(p,"enable",{set:function(turnOn){this._emitter.emit=turnOn},get:function(){return this._emitter.emit}}),p.update=function(frameTime){this._emitter.update(frameTime)},p.clear=function(){this._emitter.cleanup()},namespace("framework").ParticlesView=ParticlesView}(),function(){function PieView(config){var finalConfig=Object.extend({front:{},back:null,radius:10,startAngle:0,anticlockwise:!1,fillInverse:!1,initialProgress:0},config);if(ContainerView.call(this,config),this._maskView=app.viewFactory.create({type:"graphics"}),this._maskHolderView=app.viewFactory.create({type:"container"}),this._frontView=app.viewFactory.create(finalConfig.front),this._backView=finalConfig.back?app.viewFactory.create(finalConfig.back):null,!this._maskView)throw"PieView: maskView is null.";if(!this._frontView)throw"PieView: frontView is null.";this._maskHolderView.scale.x*=Boolean.toSignedInt(!finalConfig.anticlockwise),this._maskView.rotation=-Math.HALF_PI+finalConfig.startAngle,this._radius=finalConfig.radius,this._startAngle=finalConfig.startAngle,this._fillInverse=finalConfig.fillInverse,this._frontView.mask=this._maskView,this._maskHolderView.addChild(this._maskView),this._backView&&this.addChild(this._backView),this.addChild(this._frontView),this.addChild(this._maskHolderView),this._updateProgress(finalConfig.initialProgress)}var ContainerView=include("framework.ContainerView"),p=(ContainerView.prototype,extend(PieView,ContainerView));Object.defineProperty(p,"progress",{set:function(progress){this._updateProgress(progress)},get:function(){return this._progress}}),Object.defineProperty(p,"mask",{get:function(){return this._maskView}}),Object.defineProperty(p,"front",{get:function(){return this._frontView}}),Object.defineProperty(p,"back",{get:function(){return this._backView}}),p._updateProgress=function(progress){this._progress=Math.clamp(progress,0,1);var angle=this._progress*Math.TWO_PI;this._maskView.clear().beginFill(16777215,1).moveTo(0,0).arc(0,0,this._radius,0,angle,this._fillInverse).closePath().endFill()},namespace("framework").PieView=PieView}(),include("PIXI.Rectangle").prototype.overlapsRect=function(rect){return!(this.right<rect.left||rect.right<this.left||this.bottom<rect.top||rect.bottom<this.top)},function(){function PrimitiveView(config){var finalConfig=Object.extend({fillColour:"#ffffff",fillAlpha:1,lineWidth:1,lineColour:"#ffffff",lineAlpha:1,isWireframe:!1,vertexList:[]},config);GraphicsView.call(this,finalConfig),this.fillColour=ColourUtils.colourToNumber(finalConfig.fillColour),this.fillAlpha=finalConfig.fillAlpha,this._lineWidth=finalConfig.lineWidth,this.lineColour=ColourUtils.colourToNumber(finalConfig.lineColour),this.lineAlpha=finalConfig.lineAlpha,this.isWireframe=finalConfig.isWireframe,this._vertexList=finalConfig.vertexList,this._fillPrimitive()}var GraphicsView=include("framework.GraphicsView"),ColourUtils=include("framework.ColourUtils"),p=(GraphicsView.prototype,extend(PrimitiveView,GraphicsView));Object.defineProperty(p,"vertexList",{set:function(newVertexList){this._vertexList=newVertexList,this._fillPrimitive()},get:function(){return this._vertexList}}),p._fillPrimitive=function(){if(this.clear(),this._vertexList&&this._vertexList.length&&!(this._vertexList.length<3)){var fillColour=this.isWireframe?0:this.fillColour,fillAlpha=this.isWireframe?0:this.fillAlpha;this.beginFill(fillColour,fillAlpha),this.lineStyle(this._lineWidth,this.lineColour,this.lineAlpha),this.moveTo(this._vertexList[0].x,this._vertexList[0].y);for(var i=1;i<this._vertexList.length;i++)this.lineTo(this._vertexList[i].x,this._vertexList[i].y);this.lineTo(this._vertexList[0].x,this._vertexList[0].y),this.endFill()}},namespace("framework").PrimitiveView=PrimitiveView}(),function(){function RectangleView(config){var finalConfig=Object.extend({anchor:{x:0,y:0},fillColour:"#ffffff",fillAlpha:1,lineWidth:0,lineColour:"#ffffff",lineAlpha:1,isWireframe:!1,width:10,height:10,cornerRadius:0},config);GraphicsView.call(this,finalConfig),this._anchor={x:finalConfig.anchor.x,y:finalConfig.anchor.y},this.fillColour=ColourUtils.colourToNumber(finalConfig.fillColour),this.fillAlpha=finalConfig.fillAlpha,this.lineWidth=finalConfig.lineWidth,this.lineColour=ColourUtils.colourToNumber(finalConfig.lineColour),this.lineAlpha=finalConfig.lineAlpha,this.isWireframe=finalConfig.isWireframe,this.rectWidth=finalConfig.width,this.rectHeight=finalConfig.height,this.cornerRadius=finalConfig.cornerRadius,this._fillRoundedRect()}var GraphicsView=include("framework.GraphicsView"),ColourUtils=include("framework.ColourUtils");GraphicsView.prototype;extend(RectangleView,GraphicsView)._fillRoundedRect=function(){var fillColour=this.isWireframe?0:this.fillColour,fillAlpha=this.isWireframe?0:this.fillAlpha,minX=-this.rectWidth*this._anchor.x,minY=-this.rectHeight*this._anchor.y;this.clear().beginFill(fillColour,fillAlpha).lineStyle(this.lineWidth,this.lineColour,this.lineAlpha).drawRoundedRect(minX,minY,this.rectWidth,this.rectHeight,this.cornerRadius).endFill()},namespace("framework").RectangleView=RectangleView}(),function(){function ScreenshotView(config){config&&config.textureName&&(config.textureName,config.textureName=null);var finalConfig=Object.extend({width:512,height:512},config);SpriteView.call(this,config),this.width=finalConfig.width,this.height=finalConfig.height,this._renderTexture=RenderTexture.create(this.width,this.height),this.texture=this._renderTexture}var SpriteView=include("framework.SpriteView"),RenderTexture=include("PIXI.RenderTexture");SpriteView.prototype;extend(ScreenshotView,SpriteView).takeScreenshot=function(view){app.display.renderer.render(view,this._renderTexture)},namespace("framework").ScreenshotView=ScreenshotView}(),function(){function SpineView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff",spineName:null,autoUpdate:!1,skinName:null,attachments:[],animations:[]},config);isDefined(config.autoUpdate)||finalConfig.autoUpdate||console.warn("autoUpdate is false by default now. If your Spine has stopped working, try explicitly passing in 'autoUpdate: true' to fix it.");var spineData=finalConfig.spineName?app.getCache(finalConfig.spineName):null;if(Spine.call(this,spineData),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.tint=ColourUtils.colourToNumber(finalConfig.colourTint),this.autoUpdate=finalConfig.autoUpdate,finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}finalConfig.skinName&&this.skeleton.setSkinByName(finalConfig.skinName),isArray(finalConfig.attachments)&&finalConfig.attachments.forEach(function(attachment){this.skeleton.setAttachment(attachment.slotName,attachment.attachmentName)}.bind(this)),isArray(finalConfig.animations)&&finalConfig.animations.forEach(function(animation,i){var trackIndex=0,animationName=animation,loop=!1,startTime=0;isObject(animation)&&(trackIndex=animation.trackIndex||i,animationName=animation.animationName||"",loop=animation.loop||!1,startTime=animation.startTime||0),this.state.setAnimation(trackIndex,animationName,loop),this.state.tracks[trackIndex]&&0<startTime&&(this.state.tracks[trackIndex].trackTime=startTime)}.bind(this)),this.autoUpdate||this.update(0)}var Spine=include("PIXI.spine.Spine",!1),ColourUtils=include("framework.ColourUtils"),p=(Spine.prototype,extend(SpineView,Spine));p.postInit=function(){this._postInitImpl()},p._postInitImpl=function(){},namespace("framework").SpineView=SpineView}(),function(){function SpriteSheetView(config){var textureName=null,finalConfig=Object.extend({startingFrameName:null},config);finalConfig.textureName&&(textureName=config.textureName,finalConfig.textureName=null),SpriteView.call(this,finalConfig),this.spriteSheet=null,this.updateTexture(textureName),this.updateFrame(finalConfig.startingFrameName)}var SpriteView=include("framework.SpriteView"),p=(SpriteView.prototype,extend(SpriteSheetView,SpriteView));p.updateTexture=function(textureName){this.spriteSheet=textureName?app.getCache(textureName):null},p.updateFrame=function(frameName){if(this.spriteSheet){var frameTexture=this.spriteSheet.getFrame(frameName);frameTexture&&(this.texture=frameTexture)}},namespace("framework").SpriteSheetView=SpriteSheetView}(),function(){function TextView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,colourTint:"#ffffff",anchor:{x:0,y:0},initialText:"",style:{fill:"#ffffff"}},config);if(isDefined(finalConfig.canvasModeColour)&&!app.display.isWebGL&&(finalConfig.style.fill=finalConfig.canvasModeColour),Text.call(this,finalConfig.initialText,finalConfig.style),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.tint=ColourUtils.colourToNumber(finalConfig.colourTint),this.anchor.x=finalConfig.anchor.x,this.anchor.y=finalConfig.anchor.y,finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var Text=include("PIXI.Text"),ColourUtils=include("framework.ColourUtils"),s=Text.prototype;extend(TextView,Text).destroy=function(options){s.destroy.call(this,!0)},namespace("framework").TextView=TextView}(),function(){function TileSpriteView(config){var finalConfig=Object.extend({name:"",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},pivot:{x:0,y:0},alpha:1,isInteractive:!1,isVisible:!0,mask:null,zIndex:0,textureName:null,anchor:{x:0,y:0},tileSize:{width:100,height:100},tilePosition:{x:0,y:0},tileScale:{x:1,y:1}},config),texture=finalConfig.textureName?app.getCache(config.textureName):null;if(TilingSprite.call(this,texture,finalConfig.tileSize.width,finalConfig.tileSize.height),this.name=finalConfig.name,this.position.x=finalConfig.position.x,this.position.y=finalConfig.position.y,this.rotation=finalConfig.rotation,this.scale.x=finalConfig.scale.x,this.scale.y=finalConfig.scale.y,this.pivot.x=finalConfig.pivot.x,this.pivot.y=finalConfig.pivot.y,this.alpha=finalConfig.alpha,this.interactive=finalConfig.isInteractive,this.visible=finalConfig.isVisible,this.zIndex=finalConfig.zIndex,this.anchor.x=finalConfig.anchor.x,this.anchor.y=finalConfig.anchor.y,this.tilePosition.x=finalConfig.tilePosition.x,this.tilePosition.y=finalConfig.tilePosition.y,this.tileScale.x=finalConfig.tileScale.x,this.tileScale.y=finalConfig.tileScale.y,finalConfig.mask){var mask=app.viewFactory.create(finalConfig.mask,null);mask&&(this.addChild(mask),this.mask=mask)}}var TilingSprite=include("PIXI.extras.TilingSprite");TilingSprite.prototype;extend(TileSpriteView,TilingSprite).setMask=function(newMaskView){newMaskView&&(this.mask&&this.removeChild(this.mask),this.mask=newMaskView,this.addChild(this.mask))},namespace("framework").TileSpriteView=TileSpriteView}(),function(){var ViewUtils=ViewUtils||{};ViewUtils.convertViewToBase64PNG=function(view,quality){return ViewUtils.convertViewToCanvas(view).toDataURL("image/png",quality)},ViewUtils.convertViewToBase64JPEG=function(view,quality){return ViewUtils.convertViewToCanvas(view).toDataURL("image/jpeg",quality)},ViewUtils.convertViewToImage=function(view){return app.display.renderer.extract.image(view)},ViewUtils.convertViewToCanvas=function(view){return console.warn("ViewUtils.convertViewToCanvas() does not work in canvas mode."),app.display.renderer.extract.canvas(view)},ViewUtils.getTextureDataFromView=function(view){return console.warn("ViewUtils.getTextureDataFromView() does not work in both WebGL and canvas mode."),app.display.renderer.extract.pixels(view)},ViewUtils.downloadViewAsPNG=function(view,fileName,finishedCallback,quality){downloadView(view,fileName=fileName||"output.png",finishedCallback,quality,"image/png")},ViewUtils.downloadViewAsJPEG=function(view,fileName,finishedCallback,quality){downloadView(view,fileName=fileName||"output.jpeg",finishedCallback,quality,"image/jpeg")};var downloadView=function(view,fileName,finishedCallback,quality,type){ViewUtils.convertViewToCanvas(view).toBlob(function(blob){var anchor=document.createElement("a");document.body.append(anchor),anchor.download=fileName,anchor.href=URL.createObjectURL(blob),anchor.click(),anchor.remove(),finishedCallback&&finishedCallback(view,fileName)},type,quality)};namespace("framework").ViewUtils=ViewUtils}(),function(){function TransparencyHitArea(sprite,alphaThreshold){if(!sprite)throw"TransparencyHitArea: sprite is null.";this.sprite=sprite,this.alphaThreshold=isDefined(alphaThreshold)?alphaThreshold:2,this.textureData=null,this._init()}var p=TransparencyHitArea.prototype;p.contains=function(x,y){return 0!==Math.abs(this.sprite.width)&&0!==Math.abs(this.sprite.height)&&(x=this._translateXForAnchor(this.sprite,x,this.sprite.scale.x),y=this._translateYForAnchor(this.sprite,y,this.sprite.scale.y),!!this._isInRenderedBounds(x,y,this.sprite)&&!this.isTextureTransparentAt(Math.round(x),Math.round(y),this.sprite))},p.clone=function(){return new TransparencyHitArea(this.sprite)},p.isTextureTransparentAt=function(x,y,sprite){var index=4*(x+y*sprite.texture.width)+3;return this.textureData[index]<this.alphaThreshold},p.getTexture=function(){return this.sprite?this.sprite.texture.baseTexture.source:null},p._init=function(){if(!this.textureData){var texture=this.getTexture();this.textureData=this._createTextureData(texture)}},p._translateXForAnchor=function(sprite,x,scale){return x+sprite.texture.width*sprite.anchor.x},p._translateYForAnchor=function(sprite,y,scale){return y+sprite.texture.height*sprite.anchor.y},p._isInRenderedBounds=function(x,y,sprite){var xInTexture=Math.round(x),yInTexture=Math.round(y),w=sprite.texture.width,h=sprite.texture.height;return 0<=xInTexture&&xInTexture<=w&&0<=yInTexture&&yInTexture<=h},p._createTextureData=function(texture){var canvas=document.createElement("canvas"),spriteTexture=this.sprite.texture,x=spriteTexture.orig.x,y=spriteTexture.orig.y,width=spriteTexture.orig.width,height=spriteTexture.orig.height;canvas.width=width,canvas.height=height;var ctx=canvas.getContext("2d");return ctx.clearRect(0,0,width,height),ctx.drawImage(texture,x,y,width,height,0,0,width,height),ctx.getImageData(0,0,width,height).data},namespace("framework").TransparencyHitArea=TransparencyHitArea}(),function(){function SpineLoaderTask(asset,fallbackId){Task.call(this,asset,fallbackId),this.asset=asset}var Task=include("springroll.Task"),p=(Task.prototype,extend(SpineLoaderTask,Task));SpineLoaderTask.test=function(asset){return isDefined(asset.spine)},p.start=function(callback){PIXI.loader.add(this.asset.id,this.asset.spine).load(function(loader,resources){var spineData=null;resources.forIn(function(resource){isDefined(resource.spineData)&&(spineData=resource.spineData)}),spineData.destroy=function(){delete PIXI.loader.resources[this.asset.id],delete PIXI.loader.resources[this.asset.id+"_atlas"],delete this.destroy}.bind(this),callback(spineData)}.bind(this))},namespace("framework").SpineLoaderTask=SpineLoaderTask}(),function(){function ViewFactory(){BaseFactory.call(this),this.registerCreators([{creatorKey:"container",creatorFunc:this.defaultTreeCreator(ContainerView).bind(this)},{creatorKey:"sprite",creatorFunc:this.defaultTreeCreator(SpriteView).bind(this)},{creatorKey:"spriteSheet",creatorFunc:this.defaultTreeCreator(SpriteSheetView).bind(this)},{creatorKey:"animatedSprite",creatorFunc:this.defaultCreator(AnimatedSpriteView).bind(this)},{creatorKey:"particles",creatorFunc:this.defaultTreeCreator(ParticlesView).bind(this)},{creatorKey:"spine",creatorFunc:this.defaultTreeCreator(SpineView).bind(this)},{creatorKey:"tileSprite",creatorFunc:this.defaultTreeCreator(TileSpriteView).bind(this)},{creatorKey:"screenshot",creatorFunc:this.defaultTreeCreator(ScreenshotView).bind(this)},{creatorKey:"text",creatorFunc:this.defaultCreator(TextView).bind(this)},{creatorKey:"editText",creatorFunc:this.defaultTreeCreator(EditTextView).bind(this)},{creatorKey:"button",creatorFunc:this.defaultTreeCreator(ButtonView).bind(this)},{creatorKey:"graphics",creatorFunc:this.defaultTreeCreator(GraphicsView).bind(this)},{creatorKey:"primitive",creatorFunc:this.defaultTreeCreator(PrimitiveView).bind(this)},{creatorKey:"circle",creatorFunc:this.defaultTreeCreator(CircleView).bind(this)},{creatorKey:"rectangle",creatorFunc:this.defaultTreeCreator(RectangleView).bind(this)},{creatorKey:"line",creatorFunc:this.defaultTreeCreator(LineView).bind(this)},{creatorKey:"curve",creatorFunc:this.defaultTreeCreator(CurveView).bind(this)},{creatorKey:"binarySprite",creatorFunc:this.defaultTreeCreator(BinarySpriteView).bind(this)},{creatorKey:"dualSprite",creatorFunc:this.defaultTreeCreator(DualSpriteView).bind(this)},{creatorKey:"pie",creatorFunc:this.defaultTreeCreator(PieView).bind(this)},{creatorKey:"keyboardKey",creatorFunc:this.defaultTreeCreator(KeyboardKeyView).bind(this)},{creatorKey:"circleMask",creatorFunc:this._circleMaskViewCreator.bind(this)},{creatorKey:"polygonMask",creatorFunc:this._polygonMaskViewCreator.bind(this)}])}var BaseFactory=include("framework.BaseFactory"),ContainerView=include("framework.ContainerView"),SpriteView=include("framework.SpriteView"),SpriteSheetView=include("framework.SpriteSheetView"),AnimatedSpriteView=include("framework.AnimatedSpriteView"),ParticlesView=include("framework.ParticlesView"),SpineView=include("framework.SpineView"),TileSpriteView=include("framework.TileSpriteView"),ScreenshotView=include("framework.ScreenshotView"),TextView=include("framework.TextView"),EditTextView=include("framework.EditTextView"),ButtonView=include("framework.ButtonView"),GraphicsView=include("framework.GraphicsView"),PrimitiveView=include("framework.PrimitiveView"),CircleView=include("framework.CircleView"),RectangleView=include("framework.RectangleView"),LineView=include("framework.LineView"),CurveView=include("framework.CurveView"),BinarySpriteView=include("framework.BinarySpriteView"),DualSpriteView=include("framework.DualSpriteView"),PieView=include("framework.PieView"),KeyboardKeyView=include("framework.KeyboardKeyView"),PIXIGraphics=include("PIXI.Graphics"),p=(BaseFactory.prototype,extend(ViewFactory,BaseFactory));p.create=function(config){var view=null;if(config&&isObject(config)&&config.type){var viewCreatorFunc=this._creators[config.type];if(viewCreatorFunc){if(config.viewConfig)throw"ViewFactory: 'viewConfig' property of config is deprecated (just remove it).";view=viewCreatorFunc(config,this.create.bind(this))}}return view&&isFunction(view.postInit)&&view.postInit(),view},p.createChildren=function(config,parent,skipIgnores){if(config){var children=Object.values(config).filter(function(viewConfig){return viewConfig&&(skipIgnores||!viewConfig.ignore)},this).map(function(viewConfig){return this.create(viewConfig)},this).filter(function(view){return!!view});return parent&&parent.addChild.apply(parent,children),children}},p.createViewFromConfig=function(config,respectIgnores){throw"ViewFactory: createViewFromConfig() is deprecated. Use create() instead."},p.traverseChildren=function(view,viewConfig,callingFunc,respectIgnores){view&&viewConfig&&viewConfig.children&&viewConfig.children.length&&0<viewConfig.children.length&&viewConfig.children.forEach(function(childConfig){var childView=callingFunc(childConfig,respectIgnores);childView&&view.addChild(childView)})},p.defaultTreeCreator=function(ViewType){return function(viewConfig,callingFunc,respectIgnores){var view=new ViewType(viewConfig);return this.traverseChildren(view,viewConfig,callingFunc,respectIgnores),view}},p._circleMaskViewCreator=function(viewConfig,callingFunc){if(!viewConfig)return null;var view=(new PIXIGraphics).beginFill(0,1).drawCircle(viewConfig.x,viewConfig.y,viewConfig.radius);return view.name=viewConfig.name||"",view},p._polygonMaskViewCreator=function(viewConfig,callingFunc){if(!viewConfig||!viewConfig.pointNumberList)return null;var view=(new PIXIGraphics).beginFill(0,1).drawPolygon(viewConfig.pointNumberList);return view.name=viewConfig.name||"",view},namespace("framework").ViewFactory=ViewFactory}(),function(){function Script(config){var finalConfig=Object.extend({isActive:!0},config);this._isActive=finalConfig.isActive,this._isInitialised=!1}var p=Script.prototype;Object.defineProperty(p,"isActive",{set:function(isActive){this._isActive=isActive},get:function(){return this._isActive}}),Object.defineProperty(p,"isInitialised",{set:function(isInitialised){this._isInitialised=isInitialised},get:function(){return this._isInitialised}}),p.init=function(){this._isInitialised=!0},p.deinit=function(){this._isInitialised=!1},p.update=function(frameTime){this._isActive&&this._updateImpl(frameTime)},p._updateImpl=function(frameTime){},namespace("framework").Script=Script}(),function(){function CompositeScript(config){var finalConfig=Object.extend({scripts:[],skipInitScripts:!1,initiallyIsRecursive:!0},config);Script.call(this,finalConfig),this._scripts=[],this.addScripts(finalConfig.scripts.slice(),finalConfig.skipInitScripts),this.enable(this._isActive,finalConfig.initiallyIsRecursive)}var Script=include("framework.Script"),s=Script.prototype,p=extend(CompositeScript,Script);Object.defineProperty(p,"isActive",{set:function(isActive){this.enable(isActive,!0,!0)},get:function(){return this._isActive}}),Object.defineProperty(p,"scripts",{get:function(){return this._scripts}}),p.init=function(){s.init.call(this),this._scripts.forEach(function(script){script&&!script.isInitialised&&script.init()},this)},p.deinit=function(){this.removeScripts(),s.deinit.call(this)},p.update=function(frameTime){s.update.call(this,frameTime),this._isActive&&this._scripts.forEach(function(script){script&&script.update(frameTime)},this)},p.enable=function(isActive,isRecursive,includeSelf){void 0===isActive&&(isActive=!0),void 0===isRecursive&&(isRecursive=!0),void 0===includeSelf&&(includeSelf=!0),includeSelf&&(this._isActive=isActive),this._scripts.forEach(function(script){script&&(script.isActive=isActive,isRecursive&&isFunction(script.enable)&&script.enable(isActive,!0,!1))},this)},p.addScript=function(script,skipInit){this.addScripts(script,skipInit)},p.addScripts=function(scripts,skipInit){arrayify(scripts).filter(function(script){return!!script},this).forEach(function(script){skipInit||script.isInitialised||script.init(),this._scripts.contains(script)||this._scripts.push(script)},this)},p.removeScript=function(script,skipDeinit){this.removeScripts(script,skipDeinit)},p.removeScripts=function(scripts,skipDeinit){var scriptsToRemove=scripts?arrayify(scripts):this._scripts;this._scripts.filter(function(script){return scriptsToRemove.contains(script)},this).forEach(function(script){!skipDeinit&&script.isInitialised&&script.deinit(),this._scripts.remove(script)},this)},p.addDebugScript=function(script,skipInit){this.addDebugScripts(script,skipInit)},p.addDebugScripts=function(scripts,skipInit){app.options.debug&&this.addScripts(scripts,skipInit)},p.removeDebugScript=function(script,skipDeinit){this.removeDebugScripts(script,skipDeinit)},p.removeDebugScripts=function(scripts,skipDeinit){app.options.debug&&this.removeScripts(scripts,skipDeinit)},namespace("framework").CompositeScript=CompositeScript}(),function(){function ModelScript(config){var finalConfig=Object.extend({model:null},config);CompositeScript.call(this,finalConfig),this._model=finalConfig.model}var CompositeScript=include("framework.CompositeScript"),p=(CompositeScript.prototype,extend(ModelScript,CompositeScript));Object.defineProperty(p,"model",{set:function(newModel){this._model=newModel},get:function(){return this._model}}),p.update=function(frameTime){this._isActive&&(this._model&&this._updateImpl(frameTime),this._scripts.forEach(function(script){script&&script.update(frameTime)},this))},namespace("framework").ModelScript=ModelScript}(),function(){function ViewTransformer(config){var finalConfig=Object.extend({helper:null,view:null},config);this._helper=finalConfig.helper,this._view=finalConfig.view}var p=ViewTransformer.prototype;Object.defineProperty(p,"helper",{set:function(helper){this._helper=helper},get:function(){return this._helper}}),Object.defineProperty(p,"view",{set:function(view){this._view=view},get:function(){return this._view}}),p.captureState=function(){},p.updateState=function(frameTime){},p.restoreState=function(){},namespace("framework").ViewTransformer=ViewTransformer}(),function(){function PositionViewTransformer(config){var finalConfig=Object.extend({clampXMovement:!1,clampYMovement:!1,xRange:null,yRange:null,returnToOldPosOnDrop:!1,onUpdateCallback:function(view,frameTime){}},config);ViewTransformer.call(this,finalConfig),this._xMovementScale=finalConfig.clampXMovement?0:1,this._yMovementScale=finalConfig.clampYMovement?0:1,this._xRange=finalConfig.xRange?MinMax.from(finalConfig.xRange):null,this._yRange=finalConfig.yRange?MinMax.from(finalConfig.yRange):null,this._returnToOldPosOnDrop=finalConfig.returnToOldPosOnDrop,this._onUpdateCallback=finalConfig.onUpdateCallback,this._viewOldPosition=Vector.create(0,0)}var ViewTransformer=include("framework.ViewTransformer"),Vector=include("framework.Vector"),MinMax=include("framework.MinMax"),p=(ViewTransformer.prototype,extend(PositionViewTransformer,ViewTransformer));Object.defineProperty(p,"viewInitialPosition",{get:function(){return Vector.clone(this._viewOldPosition)}}),p.captureState=function(){this._viewOldPosition=Vector.clone(this._view.position)},p.updateState=function(frameTime){var newPosition=this._helper.getLocalMousePosition();newPosition=Vector.sub(newPosition,this._helper.mouseOffsetVec);var oldViewPosition=Vector.clone(this._view.position);this._view.position.x=Math.lerp(oldViewPosition.x,newPosition.x,this._xMovementScale),this._view.position.y=Math.lerp(oldViewPosition.y,newPosition.y,this._yMovementScale),this._xRange&&(this._view.position.x=this._xRange.clamp(this._view.position.x)),this._yRange&&(this._view.position.y=this._yRange.clamp(this._view.position.y)),this._onUpdateCallback&&this._onUpdateCallback(this._view,frameTime)},p.restoreState=function(){this._returnToOldPosOnDrop&&(this._view.x=this._viewOldPosition.x,this._view.y=this._viewOldPosition.y)},namespace("framework").PositionViewTransformer=PositionViewTransformer}(),function(){function ViewScript(config){var finalConfig=Object.extend({view:null},config);CompositeScript.call(this,finalConfig),this._view=finalConfig.view}var CompositeScript=include("framework.CompositeScript"),p=(CompositeScript.prototype,extend(ViewScript,CompositeScript));Object.defineProperty(p,"view",{set:function(view){this._view=view},get:function(){return this._view}}),p.update=function(frameTime){this._isActive&&(this._view&&this._updateImpl(frameTime),this._scripts.forEach(function(script){script&&script.update(frameTime)},this))},namespace("framework").ViewScript=ViewScript}(),function(){function DragViewScript(config){var finalConfig=Object.extend({dragStartedCallback:function(event,view){},dragMovedCallback:function(event,view){},dragEndedCallback:function(event,view){},stopPropagation:!0,viewDragRescale:1,viewTransformer:null,sourceView:null},config);if(ViewScript.call(this,finalConfig),this._dragStartedCallback=finalConfig.dragStartedCallback,this._dragMovedCallback=finalConfig.dragMovedCallback,this._dragEndedCallback=finalConfig.dragEndedCallback,this._stopPropagation=finalConfig.stopPropagation,this._viewDragRescale=finalConfig.viewDragRescale,this._sourceView=finalConfig.sourceView?finalConfig.sourceView:this.view,this._viewInitiallyInteractive=this._sourceView.interactive,this._viewIsSelected=!1,this._mouseOffsetVec=Vector.create(0,0),this._lastMousePosition=Vector.create(0,0),this._pointerID=0,this._viewTransformer=null,finalConfig.viewTransformer){if(!instanceOf(finalConfig.viewTransformer,ViewTransformer))throw"DragViewScript: viewTransformerClass must be an instance of ViewTransformer.";this._viewTransformer=finalConfig.viewTransformer}else this._viewTransformer=new PositionViewTransformer(Object.extend({helper:this,view:this._view}));this._viewTransformer.helper=this._viewTransformer.helper||this,this._viewTransformer.view=this._viewTransformer.view||this._view,this._onViewMouseDown=this._onViewMouseDown.bind(this),this._onViewMouseUp=this._onViewMouseUp.bind(this),this._onViewMouseUpOutside=this._onViewMouseUpOutside.bind(this),this._onViewMouseMove=this._onViewMouseMove.bind(this),this._onViewMouseMoveOutOfWindow=this._onViewMouseMoveOutOfWindow.bind(this)}var ViewScript=include("framework.ViewScript"),WindowUtils=include("framework.WindowUtils"),Vector=include("framework.Vector"),ViewTransformer=include("framework.ViewTransformer"),PositionViewTransformer=include("framework.PositionViewTransformer"),s=ViewScript.prototype,p=extend(DragViewScript,ViewScript);Object.defineProperty(p,"isActive",{set:function(isActive){this._setActive(isActive)},get:function(){return this._isActive}}),Object.defineProperty(p,"view",{set:function(view){this._setView(view)},get:function(){return this._view}}),Object.defineProperty(p,"dragStartedCallback",{set:function(callback){this._dragStartedCallback=callback},get:function(){return this._dragStartedCallback}}),Object.defineProperty(p,"dragMovedCallback",{set:function(callback){this._dragMovedCallback=callback},get:function(){return this._dragMovedCallback}}),Object.defineProperty(p,"dragEndedCallback",{set:function(callback){this._dragEndedCallback=callback},get:function(){return this._dragEndedCallback}}),Object.defineProperty(p,"stopPropagation",{set:function(callback){this._stopPropagation=callback},get:function(){return this._stopPropagation}}),Object.defineProperty(p,"viewDragRescale",{set:function(callback){this._viewDragRescale=callback},get:function(){return this._viewDragRescale}}),Object.defineProperty(p,"viewTransformer",{get:function(){return this._viewTransformer}}),Object.defineProperty(p,"mouseOffsetVec",{get:function(){return this._mouseOffsetVec}}),p.init=function(){s.init.call(this),this._sourceView.interactive=!0,this._registerInteractionEvents()},p.deinit=function(){this._viewIsSelected&&this._endDrag(null),this._deregisterInteractionEvents(),this._sourceView.interactive=this._viewInitiallyInteractive,s.deinit.call(this)},p._updateImpl=function(frameTime){this._viewIsSelected&&this._viewTransformer.updateState(frameTime)},p.startDrag=function(event){this._onViewMouseDown(event)},p.stopDrag=function(event){this._onViewMouseUp(event)},p.getLocalMousePosition=function(){var viewParent=this._viewTransformer.view.parent||this._view.parent||this._view;return Vector.transformGlobalToChild(this._lastMousePosition,viewParent)},p._setActive=function(isActive){this._isActive=isActive,this._isActive||this._endDrag(null)},p._setView=function(view){this._view=view,this._viewTransformer&&(this._viewTransformer.view=view)},p._registerInteractionEvents=function(){this._sourceView.on("mousedown",this._onViewMouseDown),this._sourceView.on("touchstart",this._onViewMouseDown),this._sourceView.on("mouseup",this._onViewMouseUp),this._sourceView.on("touchend",this._onViewMouseUp),this._sourceView.on("mouseupoutside",this._onViewMouseUpOutside),this._sourceView.on("touchendoutside",this._onViewMouseUpOutside),this._sourceView.on("mousemove",this._onViewMouseMove),this._sourceView.on("touchmove",this._onViewMouseMove),WindowUtils.registerMouseOut(this._onViewMouseMoveOutOfWindow)},p._deregisterInteractionEvents=function(){WindowUtils.deregisterMouseOut(this._onViewMouseMoveOutOfWindow),this._sourceView.removeListener("touchmove",this._onViewMouseMove),this._sourceView.removeListener("mousemove",this._onViewMouseMove),this._sourceView.removeListener("touchendoutside",this._onViewMouseUpOutside),this._sourceView.removeListener("mouseupoutside",this._onViewMouseUpOutside),this._sourceView.removeListener("touchend",this._onViewMouseUp),this._sourceView.removeListener("mouseup",this._onViewMouseUp),this._sourceView.removeListener("touchstart",this._onViewMouseDown),this._sourceView.removeListener("mousedown",this._onViewMouseDown)},p._onViewMouseDown=function(event){this.isActive&&this._beginDrag(event)},p._onViewMouseUp=function(event){this.isActive&&this._endDrag(event)},p._onViewMouseUpOutside=function(event){this.isActive&&this._endDrag(event)},p._onViewMouseMove=function(event){this.isActive&&this._dragMove(event)},p._onViewMouseMoveOutOfWindow=function(event){this.isActive&&this._endDrag(event)},p._beginDrag=function(event){if(!this._viewIsSelected){this._pointerID=event.data.identifier,this._viewIsSelected=!0,this._lastMousePosition=event.data.global;var mouseLocalPos=this.getLocalMousePosition();this._mouseOffsetVec=Vector.sub(mouseLocalPos,this._viewTransformer.view.position),this._view.scale.x*=this._viewDragRescale,this._view.scale.y*=this._viewDragRescale,this._viewTransformer.captureState(),this._viewTransformer.updateState(0),this._dragStartedCallback&&this._dragStartedCallback(event,this._view),this._stopPropagation&&event.stopPropagation()}},p._dragMove=function(event){this._viewIsSelected&&event.data.identifier===this._pointerID&&(this._lastMousePosition=event.data.global,this._dragMovedCallback&&this._dragMovedCallback(event,this._view))},p._endDrag=function(event){this._viewIsSelected&&(this._viewIsSelected=!1,this._view.scale.x/=this._viewDragRescale,this._view.scale.y/=this._viewDragRescale,this._viewTransformer.restoreState(),this._dragEndedCallback&&this._dragEndedCallback(event,this._view),this._stopPropagation&&event&&event.stopPropagation())},namespace("framework").DragViewScript=DragViewScript}(),function(){function FuncScript(config){var finalConfig=Object.extend({update:function(frameTime){}},config);Script.call(this,finalConfig),this.func=finalConfig.update}var Script=include("framework.Script");Script.prototype;extend(FuncScript,Script)._updateImpl=function(frameTime){this.func&&this.func(frameTime)},namespace("framework").FuncScript=FuncScript}(),function(){function BounceOffWallsScript(config){var finalConfig=Object.extend({walls:{top:0,bottom:720,left:0,right:1080},modelBounds:{topRadius:0,bottomRadius:0,leftRadius:0,rightRadius:0},collisionCallbacks:{top:null,bottom:null,left:null,right:null}},config);ModelScript.call(this,finalConfig),this._walls=Object.clone(finalConfig.walls,!0),this._modelBounds=Object.clone(finalConfig.modelBounds,!0),this._collisionCallbacks=Object.clone(finalConfig.collisionCallbacks,!0)}var ModelScript=include("framework.ModelScript");ModelScript.prototype;extend(BounceOffWallsScript,ModelScript)._updateImpl=function(frameTime){if(this._model.position&&this._model.velocity&&this._model.scale){var modelRestitution,topRadius=this._modelBounds.topRadius*this._model.scale.y,bottomRadius=this._modelBounds.bottomRadius*this._model.scale.y,leftRadius=this._modelBounds.leftRadius*this._model.scale.x,rightRadius=this._modelBounds.rightRadius*this._model.scale.x;modelRestitution=this._model.collisionResponseConfig&&void 0!==this._model.collisionResponseConfig.restitution?this._model.collisionResponseConfig.restitution:1,this._model.position.y<this._walls.top+topRadius&&(this._model.velocity.y*=-modelRestitution,this._model.position.y=this._walls.top+topRadius,this._collisionCallbacks.top&&this._collisionCallbacks.top()),this._model.position.y>this._walls.bottom-bottomRadius&&(this._model.velocity.y*=-modelRestitution,this._model.position.y=this._walls.bottom-bottomRadius,this._collisionCallbacks.bottom&&this._collisionCallbacks.bottom()),this._model.position.x<this._walls.left+leftRadius&&(this._model.velocity.x*=-modelRestitution,this._model.position.x=this._walls.left+leftRadius,this._collisionCallbacks.left&&this._collisionCallbacks.left()),this._model.position.x>this._walls.right-rightRadius&&(this._model.velocity.x*=-modelRestitution,this._model.position.x=this._walls.right-rightRadius,this._collisionCallbacks.right&&this._collisionCallbacks.right())}},namespace("framework").BounceOffWallsScript=BounceOffWallsScript}(),function(){function ChaseArriveScript(config){var finalConfig=Object.extend({targetModel:null,innerRadius:50,outerRadius:100,clampXMovement:!1,clampYMovement:!1,desiredAccelerationTime:.1,executeScriptCondition:null},config);if(!finalConfig.targetModel)throw"ChaseArriveScript: targetModel is null.";ModelScript.call(this,finalConfig),this._targetModel=finalConfig.targetModel,this._innerRadius=finalConfig.innerRadius,this._outerRadius=finalConfig.outerRadius,this._clampXMovement=finalConfig.clampXMovement,this._clampYMovement=finalConfig.clampYMovement,this._desiredAccelerationTime=finalConfig.desiredAccelerationTime,this._executeScriptCondition=finalConfig.executeScriptCondition,this._executeScriptCondition||(this._executeScriptCondition=function(){return!0})}var ModelScript=include("framework.ModelScript"),Vector=include("framework.Vector"),p=(ModelScript.prototype,extend(ChaseArriveScript,ModelScript));Object.defineProperty(p,"innerRadius",{set:function(newInnerRadius){this._innerRadius=newInnerRadius},get:function(){return this._innerRadius}}),Object.defineProperty(p,"outerRadius",{set:function(newOuterRadius){this._outerRadius=newOuterRadius},get:function(){return this._outerRadius}}),Object.defineProperty(p,"desiredAccelerationTime",{set:function(newDesiredAccelerationTime){this._desiredAccelerationTime=newDesiredAccelerationTime},get:function(){return this._desiredAccelerationTime}}),p._updateImpl=function(frameTime){if(this._targetModel&&this._targetModel.position&&this._model.position&&this._model.velocity&&void 0!==this._model.maxSpeed&&void 0!==this._model.maxLinearAcceleration){var targetAcceleration=this._getAccelerationVec();this._model.linearAcceleration.x=targetAcceleration.x,this._model.linearAcceleration.y=targetAcceleration.y}},p._getAccelerationVec=function(){var directionToTarget=Vector.sub(this._targetModel.position,this._model.position);this._clampXMovement&&(directionToTarget.x=0),this._clampYMovement&&(directionToTarget.y=0);var distanceToTarget=Vector.magnitude(directionToTarget),targetSpeed=0;return this._executeScriptCondition()&&(distanceToTarget>this._outerRadius?targetSpeed=this._model.maxSpeed:distanceToTarget>=this._innerRadius&&(targetSpeed=this._model.maxSpeed*(distanceToTarget/this._outerRadius))),targetVelocity=Vector.normalise(directionToTarget),targetVelocity=Vector.mult(targetVelocity,targetSpeed),targetAcceleration=Vector.sub(targetVelocity,this._model.velocity),targetAcceleration=Vector.mult(targetAcceleration,Math.min(1/this._desiredAccelerationTime,99999999.9)),Vector.magnitudeSquared(targetAcceleration)>this._model.maxLinearAcceleration*this._model.maxLinearAcceleration&&(targetAcceleration=Vector.normalise(targetAcceleration),targetAcceleration=Vector.mult(targetAcceleration,this._model.maxLinearAcceleration)),targetAcceleration},namespace("framework").ChaseArriveScript=ChaseArriveScript}(),function(){function CircleCircleCollisionScript(config){var finalConfig=Object.extend({circleModel1:null,circleModel2:null,collisionCallback:null},config);if(!finalConfig.circleModel1)throw"CircleCircleCollisionScript: circleModel1 is null.";if(!finalConfig.circleModel2)throw"CircleCircleCollisionScript: paddleModel is null.";CompositeScript.call(this,finalConfig),this._circleModel1=finalConfig.circleModel1,this._circleModel2=finalConfig.circleModel2,this._collisionCallback=finalConfig.collisionCallback}var CompositeScript=include("framework.CompositeScript"),Vector=include("framework.Vector"),p=(CompositeScript.prototype,extend(CircleCircleCollisionScript,CompositeScript));Object.defineProperty(p,"circleModel1",{set:function(newCircleModel1){if(!newCircleModel1)throw"CircleCircleCollisionScript: provided circleModel1 is null.";this._circleModel1=newCircleModel1},get:function(){return this._circleModel1}}),Object.defineProperty(p,"circleModel2",{set:function(newCircleModel2){if(!newCircleModel2)throw"CircleCircleCollisionScript: provided circleModel2 is null.";this._circleModel2=newCircleModel2},get:function(){return this._circleModel2}}),Object.defineProperty(p,"collisionCallback",{set:function(newCollisionCallback){if(!newCollisionCallback)throw"CircleCircleCollisionScript: provided collisionCallback is null.";this._collisionCallback=newCollisionCallback},get:function(){return this._collisionCallback}}),p._updateImpl=function(frameTime){this._circleModel1.position&&this._circleModel1.scale&&this._circleModel1.velocity&&this._circleModel1.collisionShapeConfig&&void 0!==this._circleModel1.collisionShapeConfig.radius&&this._circleModel1.collisionResponseConfig&&void 0!==this._circleModel1.collisionResponseConfig.enable&&void 0!==this._circleModel1.collisionResponseConfig.restitution&&this._circleModel2.position&&this._circleModel2.scale&&this._circleModel2.velocity&&this._circleModel2.collisionShapeConfig&&void 0!==this._circleModel2.collisionShapeConfig.radius&&this._circleModel2.collisionResponseConfig&&void 0!==this._circleModel2.collisionResponseConfig.enable&&void 0!==this._circleModel2.collisionResponseConfig.restitution&&this._handleCollision(frameTime)},p._handleCollision=function(frameTime){var circle1Position=this._circleModel1.position,circle1Scale=this._circleModel1.scale,circle1Velocity=this._circleModel1.velocity,circle1Radius=this._circleModel1.collisionShapeConfig.radius;circle1Radius*=Math.max(circle1Scale.x,circle1Scale.y);var circle2Position=this._circleModel2.position,circle2Scale=this._circleModel2.scale,circle2Velocity=this._circleModel2.velocity,circle2Radius=this._circleModel2.collisionShapeConfig.radius,radiusSum=circle1Radius+(circle2Radius*=Math.max(circle2Scale.x,circle2Scale.y)),collisionVec=Vector.sub(circle2Position,circle1Position),overlap=radiusSum-Vector.magnitude(collisionVec);if(!(overlap<0)){var circle1Factor,circle2Factor;circle2Factor=this._circleModel1.collisionResponseConfig.enable===this._circleModel2.collisionResponseConfig.enable?circle1Factor=.5:this._circleModel1.collisionResponseConfig.enable?(circle1Factor=1,0):(circle1Factor=0,1);var reflectedVelocity,collisionVecUnit=Vector.normalise(collisionVec);this._circleModel1.position=Vector.sub(circle1Position,Vector.mult(collisionVecUnit,overlap*circle1Factor)),this._circleModel2.position=Vector.add(circle2Position,Vector.mult(collisionVecUnit,overlap*circle2Factor)),this._circleModel1.collisionResponseConfig.enable&&(reflectedVelocity=Vector.reflect(circle1Velocity,Vector.neg(collisionVecUnit)),this._circleModel1.velocity=Vector.mult(reflectedVelocity,this._circleModel1.collisionResponseConfig.restitution)),this._circleModel2.collisionResponseConfig.enable&&(reflectedVelocity=Vector.reflect(circle2Velocity,collisionVecUnit),this._circleModel2.velocity=Vector.mult(reflectedVelocity,this._circleModel2.collisionResponseConfig.restitution)),this._collisionCallback&&this._collisionCallback()}},namespace("framework").CircleCircleCollisionScript=CircleCircleCollisionScript}(),function(){function CircleLinesCollisionScript(config){var finalConfig=Object.extend({circleModel:null,lineModel:null,lineCollisionShapeConfig:null,collisionCallback:null},config);if(!finalConfig.circleModel)throw"CircleLinesCollisionScript: circleModel is null.";if(!finalConfig.lineModel)throw"CircleLinesCollisionScript: lineModel is null.";if(!finalConfig.lineCollisionShapeConfig)throw"CircleLinesCollisionScript: lineCollisionShapeConfig is null.";CompositeScript.call(this,finalConfig),this._circleModel=finalConfig.circleModel,this._lineModel=finalConfig.lineModel,this._lineCollisionShapeConfig=finalConfig.lineCollisionShapeConfig,this._collisionCallback=finalConfig.collisionCallback,this._circleCollidedLastFrame=!1}var CompositeScript=include("framework.CompositeScript"),Vector=include("framework.Vector"),p=(CompositeScript.prototype,extend(CircleLinesCollisionScript,CompositeScript));Object.defineProperty(p,"circleModel",{set:function(newCircleModel){if(!newCircleModel)throw"CircleLinesCollisionScript: provided circleModel is null.";this._circleModel=newCircleModel},get:function(){return this._circleModel}}),Object.defineProperty(p,"lineModel",{set:function(newLineModel){if(!newLineModel)throw"CircleLinesCollisionScript: provided lineModel is null.";this._lineModel=newLineModel},get:function(){return this._lineModel}}),Object.defineProperty(p,"lineCollisionShapeConfig",{set:function(newLineCollisionShapeConfig){if(!newLineCollisionShapeConfig)throw"CircleLinesCollisionScript: provided lineCollisionShapeConfig is null.";this._lineCollisionShapeConfig=newLineCollisionShapeConfig},get:function(){return this._lineCollisionShapeConfig}}),p._updateImpl=function(frameTime){this._circleModel.position&&this._circleModel.velocity&&this._circleModel.collisionShapeConfig&&void 0!==this._circleModel.collisionShapeConfig.radius&&this._lineModel.position&&this._lineCollisionShapeConfig&&this._lineCollisionShapeConfig.lines&&this._handleCollision(frameTime)},p._handleCollision=function(frameTime){var circlePosition=this._circleModel.position,circleRadius=this._circleModel.collisionShapeConfig.radius,circleScale=this._circleModel.scale,circleVelocity=this._circleModel.velocity,linePosition=this._lineModel.position,lineRotation=this._lineModel.rotation,lineScale=this._lineModel.scale,lineConfig=this._lineCollisionShapeConfig;circleScale&&(circleRadius*=Math.max(circleScale.x,circleScale.y));var line,lineMinPoint,lineMaxPoint,lineDir,lineNormal,i,collisionOccurred=!1,orderedLines=lineConfig.lines.slice();for(i=0;i<orderedLines.length;i++)line=orderedLines[i],lineMinPoint=Vector.clone(line.minPoint),lineMaxPoint=Vector.clone(line.maxPoint),void 0!==lineRotation&&(lineMinPoint=Vector.rotate(lineMinPoint,lineRotation),lineMaxPoint=Vector.rotate(lineMaxPoint,lineRotation)),lineScale&&(lineMinPoint=Vector.componentMult(lineMinPoint,lineScale),lineMaxPoint=Vector.componentMult(lineMaxPoint,lineScale)),lineMinPoint=Vector.add(lineMinPoint,linePosition),lineMaxPoint=Vector.add(lineMaxPoint,linePosition),lineDir=Vector.sub(lineMaxPoint,lineMinPoint),lineNormal=Vector.rotate(lineDir,-Math.HALF_PI),lineNormal=Vector.normalise(lineNormal),line.nearestObject=Vector.distanceFromLine(lineMinPoint,lineMaxPoint,circlePosition);for(orderedLines.sort(function(line1,line2){return line1.nearestObject-line2.nearestObject}),i=0;i<orderedLines.length;i++)if(line=orderedLines[i],lineMinPoint=Vector.clone(line.minPoint),lineMaxPoint=Vector.clone(line.maxPoint),void 0!==lineRotation&&(lineMinPoint=Vector.rotate(lineMinPoint,lineRotation),lineMaxPoint=Vector.rotate(lineMaxPoint,lineRotation)),lineScale&&(lineMinPoint=Vector.componentMult(lineMinPoint,lineScale),lineMaxPoint=Vector.componentMult(lineMaxPoint,lineScale)),lineMinPoint=Vector.add(lineMinPoint,linePosition),lineMaxPoint=Vector.add(lineMaxPoint,linePosition),lineDir=Vector.sub(lineMaxPoint,lineMinPoint),lineNormal=Vector.rotate(lineDir,-Math.HALF_PI),lineNormal=Vector.normalise(lineNormal),!(Vector.scalarProjectOntoLine(linePosition,Vector.add(linePosition,lineNormal),this._circleModel.position)<0)){var distanceFromLine=Vector.distanceFromLine(lineMinPoint,lineMaxPoint,circlePosition);if(!(circleRadius<distanceFromLine)){collisionOccurred=!0;var overlap=circleRadius-distanceFromLine+.1;if(this._circleModel.position=Vector.add(circlePosition,Vector.mult(lineNormal,overlap)),line.useBiasedReflect||!1){var projLineCoord=2*Vector.scalarProjectOntoLine(lineMinPoint,lineMaxPoint,this._circleModel.position)/Vector.magnitude(lineDir)-1,newVelocityNorm=Vector.rotate(lineNormal,projLineCoord*Math.QUARTER_PI),oldCircleVelocityLength=Vector.magnitude(this._circleModel.velocity);this._circleModel.velocity=Vector.mult(newVelocityNorm,oldCircleVelocityLength)}else{var reflectedVelocity;this._circleModel.collisionResponseConfig.enable&&(reflectedVelocity=Vector.reflect(circleVelocity,Vector.neg(lineNormal)),this._circleModel.velocity=Vector.mult(reflectedVelocity,this._circleModel.collisionResponseConfig.restitution))}break}}collisionOccurred?this._circleCollidedLastFrame||(this._circleCollidedLastFrame=!0,this._collisionCallback&&this._collisionCallback()):this._circleCollidedLastFrame=!1},namespace("framework").CircleLinesCollisionScript=CircleLinesCollisionScript}(),function(){function ClampToCurveScript(config){var finalConfig=Object.extend({curveModel:null,maxDistanceFromCurve:0,clampOnXAxis:!0},config);ModelScript.call(this,finalConfig),this._curveModel=finalConfig.curveModel,this._maxDistanceFromCurve=finalConfig.maxDistanceFromCurve,this._clampOnXAxis=finalConfig.clampOnXAxis,this._currentDistanceFromCurve=Number.NEGATIVE_INFINITY}var ModelScript=include("framework.ModelScript"),CurveModel=include("framework.CurveModel"),LineModel=include("framework.LineModel"),p=(ModelScript.prototype,extend(ClampToCurveScript,ModelScript));Object.defineProperty(p,"curveModel",{set:function(newCurveModel){this._curveModel=newCurveModel},get:function(){return this._curveModel}}),Object.defineProperty(p,"currentDistanceFromCurve",{get:function(){return this._currentDistanceFromCurve}}),Object.defineProperty(p,"maxDistanceFromCurve",{set:function(newMaxDistanceFromCurve){this._maxDistanceFromCurve=newMaxDistanceFromCurve},get:function(){return this._maxDistanceFromCurve}}),Object.defineProperty(p,"unitDistanceFromCurve",{get:function(){return Number.isZero(this._maxDistanceFromCurve)?0:this._currentDistanceFromCurve/this._maxDistanceFromCurve}}),p._updateImpl=function(frameTime){if(!this._hasNullProperties())if(this._clampOnXAxis){var curveX=this._curveModel.getXAt(this._model.position.y,!0);this._model.position.x=this._clampValueToCurve(this._model.position.x,curveX)}else{var curveY=this._curveModel.getYAt(this._model.position.x,!0);this._model.position.y=this._clampValueToCurve(this._model.position.y,curveY)}},p._clampValueToCurve=function(value,curveValue){var clampedValue=value,separation=value-curveValue;return this._currentDistanceFromCurve=Math.abs(separation),this._currentDistanceFromCurve>this._maxDistanceFromCurve&&(clampedValue=curveValue+Math.sign(separation)*this._maxDistanceFromCurve,this._currentDistanceFromCurve=this._maxDistanceFromCurve),clampedValue},p._hasNullProperties=function(){return!(this._model&&this._model.position&&this._curveModel&&(this._curveModel instanceof CurveModel||this._curveModel instanceof LineModel))},namespace("framework").ClampToCurveScript=ClampToCurveScript}(),function(){function DriveModelScript(config){var finalConfig=Object.extend({speedScales:{up:1,down:1,left:1,right:1},driveConditionFuncs:{up:function(){return!1},down:function(){return!1},left:function(){return!1},right:function(){return!1}},driveOccurredCallback:null},config);ModelScript.call(this,finalConfig),this._speedScales={},this._speedScales.up=finalConfig.speedScales.up,this._speedScales.down=finalConfig.speedScales.down,this._speedScales.left=finalConfig.speedScales.left,this._speedScales.right=finalConfig.speedScales.right,this._driveConditionFuncs={},this._driveConditionFuncs.up=finalConfig.driveConditionFuncs.up,this._driveConditionFuncs.down=finalConfig.driveConditionFuncs.down,this._driveConditionFuncs.left=finalConfig.driveConditionFuncs.left,this._driveConditionFuncs.right=finalConfig.driveConditionFuncs.right,this._driveOccurredCallback=finalConfig.driveOccurredCallback}var ModelScript=include("framework.ModelScript"),Vector=include("framework.Vector");ModelScript.prototype;extend(DriveModelScript,ModelScript)._updateImpl=function(frameTime){var newVelocity=Vector.create(),maxSpeed=this._model.maxSpeed,driveOccurred=!0;this._driveConditionFuncs.up()&&(newVelocity.y-=maxSpeed*this._speedScales.up),this._driveConditionFuncs.down()&&(newVelocity.y+=maxSpeed*this._speedScales.down),this._driveConditionFuncs.left()&&(newVelocity.x-=maxSpeed*this._speedScales.left),this._driveConditionFuncs.right()&&(newVelocity.x+=maxSpeed*this._speedScales.right),Vector.magnitudeSquared(newVelocity)<.001&&(driveOccurred=!1),this._model.velocity.x=newVelocity.x,this._model.velocity.y=newVelocity.y,driveOccurred&&this._driveOccurredCallback&&this._driveOccurredCallback(newVelocity)},namespace("framework").DriveModelScript=DriveModelScript}(),function(){function FaceVelocityScript(config){var finalConfig=Object.extend({zeroRotationDir:{x:0,y:-1}},config);ModelScript.call(this,finalConfig),this._zeroRotationDir=finalConfig.zeroRotationDir}var ModelScript=include("framework.ModelScript"),Vector=include("framework.Vector");ModelScript.prototype;extend(FaceVelocityScript,ModelScript)._updateImpl=function(frameTime){void 0!==this._model.rotation&&this._model.velocity&&(this._model.rotation=Vector.angleBetween(this._zeroRotationDir,Vector.normalise(this._model.velocity)))},namespace("framework").FaceVelocityScript=FaceVelocityScript}(),function(){function InputAccelerateScript(config){var finalConfig=Object.extend({acceleration:{x:100,y:100},accelConditionFuncs:{up:function(){return!1},down:function(){return!1},left:function(){return!1},right:function(){return!1}}},config);ModelScript.call(this,finalConfig),this._acceleration=Object.clone(finalConfig.acceleration,!0),this._accelConditionFuncs={},this._accelConditionFuncs.up=finalConfig.accelConditionFuncs.up,this._accelConditionFuncs.down=finalConfig.accelConditionFuncs.down,this._accelConditionFuncs.left=finalConfig.accelConditionFuncs.left,this._accelConditionFuncs.right=finalConfig.accelConditionFuncs.right}var ModelScript=include("framework.ModelScript"),p=(ModelScript.prototype,extend(InputAccelerateScript,ModelScript));Object.defineProperty(p,"acceleration",{set:function(newAcceleration){this._acceleration=Object.clone(newAcceleration,!0)},get:function(){return this._acceleration}}),p._updateImpl=function(frameTime){var accelVec={x:0,y:0};this._accelConditionFuncs.up()&&(accelVec.y-=this._acceleration.y*frameTime),this._accelConditionFuncs.down()&&(accelVec.y+=this._acceleration.y*frameTime),this._accelConditionFuncs.left()&&(accelVec.x-=this._acceleration.x*frameTime),this._accelConditionFuncs.right()&&(accelVec.x+=this._acceleration.x*frameTime),this._model.velocity&&(this._model.velocity.x+=accelVec.x,this._model.velocity.y+=accelVec.y)},namespace("framework").InputAccelerateScript=InputAccelerateScript}(),function(){function MoveModelScript(config){var finalConfig=Object.extend({clampXMovement:!1,clampYMovement:!1,isKinematic:!1,preUpdateCallback:null,postUpdateCallback:null},config);ModelScript.call(this,finalConfig),this._xMovementScale=finalConfig.clampXMovement?0:1,this._yMovementScale=finalConfig.clampYMovement?0:1,this._isKinematic=finalConfig.isKinematic,this._preUpdateCallback=finalConfig.preUpdateCallback,this._postUpdateCallback=finalConfig.postUpdateCallback,this._preUpdateCallback||(this._preUpdateCallback=function(model){}),this._postUpdateCallback||(this._postUpdateCallback=function(model){})}var ModelScript=include("framework.ModelScript"),Vector=include("framework.Vector");ModelScript.prototype;extend(MoveModelScript,ModelScript)._updateImpl=function(frameTime){if(this._preUpdateCallback(this._model),this._model.position&&this._model.velocity){if(!this._isKinematic&&this._model.linearAcceleration&&.001<Vector.magnitudeSquared(this._model.linearAcceleration)&&void 0!==this._model.linearDrag){var acceleration=Vector.create(this._model.linearAcceleration.x*frameTime*this._xMovementScale,this._model.linearAcceleration.y*frameTime*this._yMovementScale);this._model.velocity.x+=acceleration.x,this._model.velocity.y+=acceleration.y,this._model.linearAcceleration.x-=this._model.linearDrag*acceleration.x,this._model.linearAcceleration.y-=this._model.linearDrag*acceleration.y,this._model.linearAcceleration.x<.001&&(this._model.linearAcceleration.x=0),this._model.linearAcceleration.y<.001&&(this._model.linearAcceleration.y=0)}var velocityLength=Vector.magnitude(this._model.velocity);velocityLength>this._model.maxSpeed&&(this._model.velocity=Vector.mult(this._model.velocity,this._model.maxSpeed/velocityLength)),this._model.position.x+=this._model.velocity.x*frameTime*this._xMovementScale,this._model.position.y+=this._model.velocity.y*frameTime*this._yMovementScale}this._postUpdateCallback(this._model)},namespace("framework").MoveModelScript=MoveModelScript}(),function(){function RadiusTriggerZoneScript(config){var finalConfig=Object.extend({centre:{x:0,y:0},radius:0,triggerWhenOutside:!0,onTriggerCallback:null},config);ModelScript.call(this,finalConfig),this._centre=finalConfig.centre,this._radiusSquared=finalConfig.radius*finalConfig.radius,this._triggerWhenOutside=finalConfig.triggerWhenOutside,this._onTriggerCallback=finalConfig.onTriggerCallback}var ModelScript=include("framework.ModelScript"),Vector=include("framework.Vector"),p=(ModelScript.prototype,extend(RadiusTriggerZoneScript,ModelScript));Object.defineProperty(p,"centre",{set:function(newCentre){this._centre=newCentre},get:function(){return this._centre}}),p._updateImpl=function(frameTime){if(this._onTriggerCallback){var centreToModelVec=Vector.sub(this._model.position,this._centre);Vector.magnitudeSquared(centreToModelVec)>this._radiusSquared===this._triggerWhenOutside&&this._onTriggerCallback()}},namespace("framework").RadiusTriggerZoneScript=RadiusTriggerZoneScript}(),function(){function RotateModelScript(config){var finalConfig=Object.extend({},config);ModelScript.call(this,finalConfig)}var ModelScript=include("framework.ModelScript");ModelScript.prototype;extend(RotateModelScript,ModelScript)._updateImpl=function(frameTime){void 0!==this._model.rotation&&void 0!==this._model.rotationSpeed&&(this._model.rotation+=this._model.rotationSpeed*frameTime)},namespace("framework").RotateModelScript=RotateModelScript}(),function(){function SyncBoundsTransformScript(config){var finalConfig=Object.extend({},config);ModelScript.call(this,finalConfig)}var ModelScript=include("framework.ModelScript"),BoundsModel=include("framework.BoundsModel");ModelScript.prototype;extend(SyncBoundsTransformScript,ModelScript)._updateImpl=function(frameTime){this._model.bounds&&this._model.bounds instanceof BoundsModel&&this._model.bounds.recalculate()},namespace("framework").SyncBoundsTransformScript=SyncBoundsTransformScript}(),function(){function VelocityBiasScript(config){var finalConfig=Object.extend({checkAngle:.5},config);ModelScript.call(this,finalConfig),this._checkAngle=finalConfig.checkAngle,this._up=Vector.create(0,-1),this._down=Vector.create(0,1)}var ModelScript=include("framework.ModelScript"),Vector=include("framework.Vector");ModelScript.prototype;extend(VelocityBiasScript,ModelScript)._updateImpl=function(frameTime){if(this._model.velocity&&!(Vector.magnitudeSquared(this._model.velocity)<1e-4)){var destAngle,newVelocity=this._model.velocity,angleFromUp=Vector.angleBetween(this._model.velocity,this._up);Math.abs(angleFromUp)<this._checkAngle&&(destAngle=this._checkAngle,angleFromUp<0&&(destAngle*=-1),newVelocity=Vector.rotate(this._model.velocity,destAngle-angleFromUp));var angleFromDown=Vector.angleBetween(this._model.velocity,this._down);Math.abs(angleFromDown)<this._checkAngle&&(destAngle=this._checkAngle,angleFromDown<0&&(destAngle*=-1),newVelocity=Vector.rotate(this._model.velocity,destAngle-angleFromDown)),this._model.velocity=newVelocity}},namespace("framework").VelocityBiasScript=VelocityBiasScript}(),function(){function VelocityWanderScript(config){var finalConfig=Object.extend({maxVariability:.5,biasTowardsCentreFactor:1},config);ModelScript.call(this,finalConfig),this._maxVariability=finalConfig.maxVariability,this._biasTowardsCentreFactor=finalConfig.biasTowardsCentreFactor,this._inverseBiasFactor=1/this._biasTowardsCentreFactor}var ModelScript=include("framework.ModelScript"),Vector=include("framework.Vector"),p=(ModelScript.prototype,extend(VelocityWanderScript,ModelScript));Object.defineProperty(p,"maxVariability",{set:function(newMaxVariability){this._maxVariability=newMaxVariability},get:function(){return this._maxVariability}}),p._updateImpl=function(frameTime){if(this._model.velocity&&!(Vector.magnitudeSquared(this._model.velocity)<1e-4)){var minVariance=-this._maxVariability,maxVariance=this._maxVariability;minVariance=Math.pow(minVariance,this._biasTowardsCentreFactor),maxVariance=Math.pow(maxVariance,this._biasTowardsCentreFactor);var randomRotation=Math.randomFloat(minVariance,maxVariance);randomRotation=Math.pow(randomRotation,this._inverseBiasFactor),randomRotation*=frameTime,randomRotation=Math.wrap(randomRotation,0,Math.TWO_PI),this._model.velocity=Vector.rotate(this._model.velocity,randomRotation)}},namespace("framework").VelocityWanderScript=VelocityWanderScript}(),function(){function WrapPositionScript(config){var finalConfig=Object.extend({walls:{top:0,bottom:720,left:0,right:1080}},config);ModelScript.call(this,finalConfig),this._walls=Object.clone(finalConfig.walls,!0)}var ModelScript=include("framework.ModelScript");ModelScript.prototype;extend(WrapPositionScript,ModelScript)._updateImpl=function(frameTime){this._model.position&&(this._model.position.x=Math.wrap(this._model.position.x,this._walls.left,this._walls.right),this._model.position.y=Math.wrap(this._model.position.y,this._walls.top,this._walls.bottom))},namespace("framework").WrapPositionScript=WrapPositionScript}(),function(){var ViewScript=include("framework.ViewScript"),Vector=include("framework.Vector"),Enum=include("springroll.Enum"),AlignViewScript=function(config){var finalConfig=Object.extend({horizontalAlignment:AlignViewScript.Alignment.NONE,verticalAlignment:AlignViewScript.Alignment.NONE,updateFrequency:AlignViewScript.UpdateFrequency.ON_WINDOW_RESIZE},config);ViewScript.call(this,finalConfig),this._horizontalAlignment=finalConfig.horizontalAlignment,this._verticalAlignment=finalConfig.verticalAlignment,this._updateFrequency=finalConfig.updateFrequency,this._windowResizedTimeout=null,this._updateFrequency!=AlignViewScript.UpdateFrequency.ON_WINDOW_RESIZE||this._canUpdateOnWindowResize()||(this._updateFrequency=AlignViewScript.UpdateFrequency.ALWAYS),this._view&&(this._originalViewPos=Vector.clone(this._view.position))},s=ViewScript.prototype,p=extend(AlignViewScript,ViewScript);AlignViewScript.Alignment=new Enum("NONE","CENTRE","LEFT","RIGHT","TOP","BOTTOM"),AlignViewScript.UpdateFrequency=new Enum("ONCE","ON_WINDOW_RESIZE","ALWAYS"),Object.defineProperty(p,"view",{set:function(newView){this._view=newView,this._view&&(this._originalViewPos=Vector.clone(this._view.position))},get:function(){return this._view}}),Object.defineProperty(p,"horizontalAlignment",{get:function(){return this._horizontalAlignment}}),Object.defineProperty(p,"verticalAlignment",{get:function(){return this._verticalAlignment}}),Object.defineProperty(p,"updateFrequency",{get:function(){return this._updateFrequency}}),p.init=function(){s.init.call(this),app.size&&this._updateFrequency==AlignViewScript.UpdateFrequency.ON_WINDOW_RESIZE&&app.size.on("resize",this._windowResized,this),this._scheduleWindowResizedEvent()},p.deinit=function(){this._clearWindowResizedEvent(),this._view&&this._view.transform&&(this._view.position.x=this._originalViewPos.x,this._view.position.y=this._originalViewPos.y),app.size&&this._updateFrequency==AlignViewScript.UpdateFrequency.ON_WINDOW_RESIZE&&app.size.off("resize",this._windowResized,this),s.deinit.call(this)},p._updateImpl=function(frameTime){this._updateFrequency==AlignViewScript.UpdateFrequency.ALWAYS&&this._windowResized()},p._scheduleWindowResizedEvent=function(){this._clearWindowResizedEvent(),this._windowResized(),this._windowResizedTimeout=setTimeout(function(){this._windowResizedTimeout=null,this._windowResized()}.bind(this),1)},p._clearWindowResizedEvent=function(){this._windowResizedTimeout&&(clearTimeout(this._windowResizedTimeout),this._windowResizedTimeout=null)},p._windowResized=function(){this._view&&app&&app.size&&(this._alignX(),this._alignY())},p._canUpdateOnWindowResize=function(){return!!app.size},p._alignX=function(){var snapXAmount=this._getSnapXAmount();if(isDefined(snapXAmount)){var snapXPos=snapXAmount*app.size.currentWidth*app.size.currentScale;snapXPos=(this._view.parent||this._view).toLocal({x:snapXPos,y:0}).x,this._view.position.x=snapXPos+this._originalViewPos.x}},p._alignY=function(){var snapYAmount=this._getSnapYAmount();if(isDefined(snapYAmount)){var snapYPos=snapYAmount*app.size.currentHeight*app.size.currentScale;snapYPos=(this._view.parent||this._view).toLocal({x:0,y:snapYPos}).y,this._view.position.y=snapYPos+this._originalViewPos.y}},p._getSnapXAmount=function(){var snapXAmount;return this._horizontalAlignment==AlignViewScript.Alignment.LEFT?snapXAmount=0:this._horizontalAlignment==AlignViewScript.Alignment.CENTRE?snapXAmount=.5:this._horizontalAlignment==AlignViewScript.Alignment.RIGHT&&(snapXAmount=1),snapXAmount},p._getSnapYAmount=function(){var snapYAmount;return this._verticalAlignment==AlignViewScript.Alignment.TOP?snapYAmount=0:this._verticalAlignment==AlignViewScript.Alignment.CENTRE?snapYAmount=.5:this._verticalAlignment==AlignViewScript.Alignment.BOTTOM&&(snapYAmount=1),snapYAmount},namespace("framework").AlignViewScript=AlignViewScript}(),function(){var ViewScript=include("framework.ViewScript"),BoundsOverlapScript=function(config){var finalConfig=Object.extend({otherView:null,overlapTestFunc:null,overlapResultCallback:function(thisView,otherView,viewsOverlap,returnData){},isOverlappingCallback:function(thisView,otherView,returnData){},isNotOverlappingCallback:function(thisView,otherView,returnData){},overlapStartedCallback:function(thisView,otherView,returnData){},overlapEndedCallback:function(thisView,otherView,returnData){}},config);ViewScript.call(this,finalConfig),this._otherView=finalConfig.otherView,this._overlapTestFunc=finalConfig.overlapTestFunc||BoundsOverlapScript.defaultOverlapTest,this._overlapResultCallback=finalConfig.overlapResultCallback,this._isOverlappingCallback=finalConfig.isOverlappingCallback,this._isNotOverlappingCallback=finalConfig.isNotOverlappingCallback,this._overlapStartedCallback=finalConfig.overlapStartedCallback,this._overlapEndedCallback=finalConfig.overlapEndedCallback},s=ViewScript.prototype,p=extend(BoundsOverlapScript,ViewScript);Object.defineProperty(p,"isActive",{set:function(isActive){this._setActive(isActive)},get:function(){return this._isActive}}),Object.defineProperty(p,"otherView",{set:function(otherView){this._otherView=otherView},get:function(){return this._otherView}}),Object.defineProperty(p,"overlapTestFunc",{set:function(overlapTestFunc){this._overlapTestFunc=overlapTestFunc||BoundsOverlapScript.defaultOverlapTest},get:function(){return this._overlapTestFunc}}),Object.defineProperty(p,"overlapResultCallback",{set:function(overlapResultCallback){this._overlapResultCallback=overlapResultCallback},get:function(){return this._overlapResultCallback}}),Object.defineProperty(p,"isOverlappingCallback",{set:function(isOverlappingCallback){this._isOverlappingCallback=isOverlappingCallback},get:function(){return this._isOverlappingCallback}}),Object.defineProperty(p,"isNotOverlappingCallback",{set:function(isNotOverlappingCallback){this._isNotOverlappingCallback=isNotOverlappingCallback},get:function(){return this._isNotOverlappingCallback}}),Object.defineProperty(p,"overlapStartedCallback",{set:function(overlapStartedCallback){this._overlapStartedCallback=overlapStartedCallback},get:function(){return this._overlapStartedCallback}}),Object.defineProperty(p,"overlapEndedCallback",{set:function(overlapEndedCallback){this._overlapEndedCallback=overlapEndedCallback},get:function(){return this._overlapEndedCallback}}),Object.defineProperty(p,"isOverlapping",{get:function(){return this._isOverlapping}}),BoundsOverlapScript.defaultOverlapTest=function(view1,view2,returnData){var view1Bounds=view1.getBounds(),view2Bounds=view2.getBounds(),xOverlap=view1Bounds.right>view2Bounds.x&&view1Bounds.x<view2Bounds.right,yOverlap=view1Bounds.bottom>view2Bounds.y&&view1Bounds.y<view2Bounds.bottom;return xOverlap&&yOverlap},p.init=function(){s.init.call(this),this._isOverlapping=!1},p.deinit=function(){this._isOverlapping=!1,s.deinit.call(this)},p._updateImpl=function(frameTime){if(this._otherView){var returnData={},overlaps=this._testOverlap(this._view,this._otherView,returnData);this._updateOverlapState(overlaps,returnData)}},p._setActive=function(isActive){this._isActive=isActive,this._isActive||this._updateOverlapState(!1,{})},p._testOverlap=function(view,otherView,returnData){var overlaps=!1;return view&&otherView&&(overlaps=this._overlapTestFunc(view,otherView,returnData)),overlaps},p._updateOverlapState=function(isOverlapping,returnData){this._isOverlapping!==isOverlapping&&(this._isOverlapping=isOverlapping,this._isOverlapping&&this._overlapStartedCallback?this._overlapStartedCallback(this._view,this._otherView,returnData):!this._isOverlapping&&this._overlapEndedCallback&&this._overlapEndedCallback(this._view,this._otherView,returnData)),isOverlapping&&this._isOverlappingCallback?this._isOverlappingCallback(this._view,this._otherView,returnData):!isOverlapping&&this._isNotOverlappingCallback&&this._isNotOverlappingCallback(this._view,this._otherView,returnData),this._overlapResultCallback&&this._overlapResultCallback(this._view,this._otherView,isOverlapping,returnData)},namespace("framework").BoundsOverlapScript=BoundsOverlapScript}(),function(){function ButtonPressScript(config){var finalConfig=Object.extend({buttonPressedCallback:null,buttonOverCallback:null,buttonOutCallback:null},config);ViewScript.call(this,finalConfig),this._buttonPressedCallback=finalConfig.buttonPressedCallback,this._buttonOverCallback=finalConfig.buttonOverCallback,this._buttonOutCallback=finalConfig.buttonOutCallback,this._viewInitiallyInteractive=this._view.interactive,this._onButtonPressedInternal=this._onButtonPressed.bind(this),this._onButtonOverInternal=this._onButtonOver.bind(this),this._onButtonOutInternal=this._onButtonOut.bind(this)}var ViewScript=include("framework.ViewScript"),Button=include("springroll.pixi.Button"),s=ViewScript.prototype,p=extend(ButtonPressScript,ViewScript);p.init=function(){s.init.call(this),this._view.interactive=!0,this._view.on(Button.BUTTON_PRESS,this._onButtonPressedInternal),this._view.on(Button.BUTTON_OVER,this._onButtonOverInternal),this._view.on(Button.BUTTON_OUT,this._onButtonOutInternal)},p.deinit=function(){this._view.removeListener(Button.BUTTON_OUT,this._onButtonOutInternal),this._view.removeListener(Button.BUTTON_OVER,this._onButtonOverInternal),this._view.removeListener(Button.BUTTON_PRESS,this._onButtonPressedInternal),this._view.interactive=this._viewInitiallyInteractive,s.deinit.call(this)},p._onButtonPressed=function(view){this._buttonPressedCallback&&this.isActive&&this._buttonPressedCallback(view)},p._onButtonOver=function(view){this._buttonOverCallback&&this.isActive&&this._buttonOverCallback(view)},p._onButtonOut=function(view){this._buttonOutCallback&&this.isActive&&this._buttonOutCallback(view)},namespace("framework").ButtonPressScript=ButtonPressScript}(),function(){function CameraScript(config){var finalConfig=Object.extend({worldView:null,playerView:null,playerRect:{x:app.size.centre.x-10,y:app.size.centre.y-10,width:20,bottom:20},cameraRect:{x:app.size.min.x,y:app.size.min.y,width:app.size.maxWidth,bottom:app.size.maxHeight},worldRect:{x:app.size.min.x,y:app.size.min.y,width:app.size.maxWidth,bottom:app.size.maxHeight}},config);if(finalConfig.view=finalConfig.playerView,ViewScript.call(this,finalConfig),!finalConfig.worldView)throw"CameraScript: worldView is null.";if(!finalConfig.playerView)throw"CameraScript: playerView is null.";this._worldView=finalConfig.worldView,this._playerView=this._view,this._playerRect=new Rectangle(finalConfig.playerRect),this._cameraRect=new Rectangle(finalConfig.cameraRect),this._worldRect=new Rectangle(finalConfig.worldRect)}var ViewScript=include("framework.ViewScript"),Rectangle=include("PIXI.Rectangle"),p=(ViewScript.prototype,extend(CameraScript,ViewScript));Object.defineProperty(p,"playerRect",{set:function(playerRect){this._playerRect=new Rectangle(playerRect)},get:function(playerRect){return this._playerRect}}),Object.defineProperty(p,"cameraRect",{set:function(cameraRect){this._cameraRect=new Rectangle(cameraRect)},get:function(cameraRect){return this._cameraRect}}),Object.defineProperty(p,"worldRect",{set:function(worldRect){this._worldRect=new Rectangle(worldRect)},get:function(worldRect){return this._worldRect}}),p._updateImpl=function(frameTime){var scrolledPlayerBounds={left:this._playerView.position.x-this._playerRect.x,right:this._playerView.position.x-this._playerRect.right,top:this._playerView.position.y-this._playerRect.y,bottom:this._playerView.position.y-this._playerRect.bottom};if(this._worldView.pivot.x>scrolledPlayerBounds.left&&(this._worldView.pivot.x=scrolledPlayerBounds.left),this._worldView.pivot.x<scrolledPlayerBounds.right&&(this._worldView.pivot.x=scrolledPlayerBounds.right),this._worldView.pivot.y>scrolledPlayerBounds.top&&(this._worldView.pivot.y=scrolledPlayerBounds.top),this._worldView.pivot.y<scrolledPlayerBounds.bottom&&(this._worldView.pivot.y=scrolledPlayerBounds.bottom),this._worldRect){var worldPivotBounds={left:this._worldRect.x-this._cameraRect.x,right:this._worldRect.right-this._cameraRect.right,top:this._worldRect.y-this._cameraRect.y,bottom:this._worldRect.bottom-this._cameraRect.bottom};this._worldView.pivot.x<worldPivotBounds.left&&(this._worldView.pivot.x=worldPivotBounds.left),this._worldView.pivot.x>worldPivotBounds.right&&(this._worldView.pivot.x=worldPivotBounds.right),this._worldView.pivot.y<worldPivotBounds.top&&(this._worldView.pivot.y=worldPivotBounds.top),this._worldView.pivot.y>worldPivotBounds.bottom&&(this._worldView.pivot.y=worldPivotBounds.bottom)}},namespace("framework").CameraScript=CameraScript}(),function(){function ClickScript(config){var finalConfig=Object.extend({clickStartCallback:null,clickEndCallback:null,clickEndOutsideCallback:null,stopPropagation:!0,clickSoundName:null,allowAllClickEndEvents:!1},config);ViewScript.call(this,finalConfig),this._clickStartCallback=finalConfig.clickStartCallback,this._clickEndCallback=finalConfig.clickEndCallback,this._clickEndOutsideCallback=finalConfig.clickEndOutsideCallback,this._stopPropagation=finalConfig.stopPropagation,this._clickSoundName=finalConfig.clickSoundName,!this._clickSoundName||void 0!==this._clickSoundName.length&&0!==this._clickSoundName.length||(this._clickSoundName=null),this._viewInitiallyInteractive=this._view.interactive,this._onClickStartInternal=this._onClickStart.bind(this),this._onClickEndInternal=this._onClickEnd.bind(this),this._onClickEndOutsideInternal=this._onClickEndOutside.bind(this),this._isSelected=!1,this._allowAllClickEndEvents=finalConfig.allowAllClickEndEvents}var ViewScript=include("framework.ViewScript"),s=ViewScript.prototype,p=extend(ClickScript,ViewScript);Object.defineProperty(p,"isActive",{set:function(isActive){this.enable(isActive,!0,!0),this._view&&(this._view.interactive=isActive)},get:function(){return this._isActive}}),Object.defineProperty(p,"isClickable",{set:function(isClickable){this._isClickable=isClickable},get:function(){return this._isClickable}}),Object.defineProperty(p,"isSelected",{get:function(){return this._isSelected}}),p.init=function(){s.init.call(this),this._view.interactive=this.isActive,this._isSelected=!1,this._isClickable=this.isActive,this._view.on("mousedown",this._onClickStartInternal),this._view.on("touchstart",this._onClickStartInternal),this._view.on("touchend",this._onClickEndInternal),this._view.on("mouseup",this._onClickEndInternal),this._view.on("mouseupoutside",this._onClickEndOutsideInternal),this._view.on("touchendoutside",this._onClickEndOutsideInternal)},p.deinit=function(){this._view.removeListener("touchendoutside",this._onClickEndOutsideInternal),this._view.removeListener("mouseupoutside",this._onClickEndOutsideInternal),this._view.removeListener("mouseup",this._onClickEndInternal),this._view.removeListener("touchend",this._onClickEndInternal),this._view.removeListener("touchstart",this._onClickStartInternal),this._view.removeListener("mousedown",this._onClickStartInternal),this._isClickable=!1,this._isSelected=!1,this._view.interactive=this._viewInitiallyInteractive,s.deinit.call(this)},p._onClickStart=function(event){this.isActive&&this.isClickable&&(this._isSelected=!0,this._clickStartCallback&&this._clickStartCallback(event,this._view),this._stopPropagation&&event.stopPropagation())},p._onClickEnd=function(event){this.isActive&&this.isClickable&&(this._isSelected||this._allowAllClickEndEvents)&&(this._isSelected=!1,this._clickSoundName&&app.sound.play(this._clickSoundName),this._stopPropagation&&event.stopPropagation(),this._clickEndCallback&&this._clickEndCallback(event,this._view))},p._onClickEndOutside=function(event){this.isActive&&this.isClickable&&(this._isSelected=!1,this._clickEndOutsideCallback&&this._clickEndOutsideCallback(event,this._view),this._stopPropagation&&event.stopPropagation())},namespace("framework").ClickScript=ClickScript}(),function(){function FaceViewScript(config){var finalConfig=Object.extend({targetView:null},config);ViewScript.call(this,finalConfig),this._targetView=finalConfig.targetView}var ViewScript=include("framework.ViewScript"),Vector=include("framework.Vector"),p=(ViewScript.prototype,extend(FaceViewScript,ViewScript));Object.defineProperty(p,"targetView",{set:function(targetView){this._targetView=targetView},get:function(){return this._targetView}}),p._updateImpl=function(frameTime){if(this._targetView){var targetPosition=Vector.transformTo(this._targetView,this._view.parent),targetVec=Vector.createFromPoints(this._view.position,targetPosition);this._view.rotation=Vector.toAngle(targetVec)}},namespace("framework").FaceViewScript=FaceViewScript}(),function(){function HoverScript(config){var finalConfig=Object.extend({hoverStartCallback:null,hoverEndCallback:null,hoverCallback:null,stopPropagation:!0},config);ViewScript.call(this,finalConfig),this._hoverStartCallback=finalConfig.hoverStartCallback,this._hoverEndCallback=finalConfig.hoverEndCallback,this._hoverCallback=finalConfig.hoverCallback,this._stopPropagation=finalConfig.stopPropagation,this._viewInitiallyInteractive=this._view.interactive,this._onHoverStartInternal=this._onHoverStart.bind(this),this._onHoverEndInternal=this._onHoverEnd.bind(this)}var ViewScript=include("framework.ViewScript"),s=ViewScript.prototype,p=extend(HoverScript,ViewScript);p.init=function(){s.init.call(this),this._view.interactive=!0,this._view.on("mouseover",this._onHoverStartInternal),this._view.on("mouseout",this._onHoverEndInternal)},p.deinit=function(){this._view.removeListener("mouseout",this._onHoverEndInternal),this._view.removeListener("mouseover",this._onHoverStartInternal),this._view.interactive=this._viewInitiallyInteractive,s.deinit.call(this)},p._onHoverStart=function(event){this.isActive&&(this._hoverStartCallback&&this._hoverStartCallback(event,this._view),this._hoverCallback&&this._hoverCallback(event,this._view,!0),this._stopPropagation&&event.stopPropagation())},p._onHoverEnd=function(event){this.isActive&&(this._hoverEndCallback&&this._hoverEndCallback(event,this._view),this._hoverCallback&&this._hoverCallback(event,this._view,!1),this._stopPropagation&&event.stopPropagation())},namespace("framework").HoverScript=HoverScript}(),function(){function ScrollTileScript(config){var finalConfig=Object.extend({scrollSpeed:{x:0,y:0}},config);ViewScript.call(this,finalConfig),this._scrollSpeedX=finalConfig.scrollSpeed.x,this._scrollSpeedY=finalConfig.scrollSpeed.y}var ViewScript=include("framework.ViewScript"),p=(ViewScript.prototype,extend(ScrollTileScript,ViewScript));Object.defineProperty(p,"scrollSpeedX",{set:function(newScrollSpeedX){this._scrollSpeedX=newScrollSpeedX},get:function(){return this._scrollSpeedX}}),Object.defineProperty(p,"scrollSpeedY",{set:function(newScrollSpeedY){this._scrollSpeedY=newScrollSpeedY},get:function(){return this._scrollSpeedY}}),p._updateImpl=function(frameTime){if(this._view&&this._view.tilePosition&&this._view.texture&&void 0!==this._view.texture.width&&void 0!==this._view.texture.height){var xLoopSize=this._view.texture.width*this._view.tileScale.x,yLoopSize=this._view.texture.height*this._view.tileScale.y;this._view.tilePosition.x=this._scroll(this._view.tilePosition.x,this._scrollSpeedX,frameTime,xLoopSize),this._view.tilePosition.y=this._scroll(this._view.tilePosition.y,this._scrollSpeedY,frameTime,yLoopSize)}},p._scroll=function(value,scrollSpeed,frameTime,loopSize){var outputValue=value+scrollSpeed*frameTime;return 0<scrollSpeed?loopSize<value&&(outputValue=value-loopSize):value<-loopSize&&(outputValue=value+loopSize),outputValue},namespace("framework").ScrollTileScript=ScrollTileScript}(),function(){function StickyAndDragViewScript(config){var finalConfig=Object.extend({shouldSnap:!1,dragTimeThreshold:.2},config);DragViewScript.call(this,finalConfig),this._shouldSnap=finalConfig.shouldSnap,this._dragTimeThreshold=finalConfig.dragTimeThreshold,this._isClickAndCarry=!1,this._firstClickOccurring=!1,this._dragTimeout=null}var DragViewScript=include("framework.DragViewScript"),Vector=(include("framework.WindowUtils"),include("framework.Vector")),s=DragViewScript.prototype,p=extend(StickyAndDragViewScript,DragViewScript);Object.defineProperty(p,"isClickAndCarry",{get:function(){return this._isClickAndCarry}}),Object.defineProperty(p,"dragTimeThreshold",{set:function(dragTimeThreshold){this._dragTimeThreshold=dragTimeThreshold},get:function(){return this._dragTimeThreshold}}),p.init=function(){s.init.call(this),this._clearDragTimeout(),this._firstClickOccurring=!1},p.deinit=function(){this._clearDragTimeout(),this._firstClickOccurring=!1,s.deinit.call(this)},p._onViewMouseDown=function(event){if(this.isActive)if(this._clearDragTimeout(),this._viewIsSelected)this._endDrag(event);else{if(this._isClickAndCarry=!0,this._shouldSnap){var convertedPosition=Vector.transformGlobalToChild(event.data.global,this._view.parent);this._view.position.x=convertedPosition.x,this._view.position.y=convertedPosition.y}this._startDragTimeout(),this._beginDrag(event)}},p._onViewMouseUp=function(event){this.isActive&&this._viewIsSelected&&(this._isClickAndCarry&&this._dragTimeout?(this._isClickAndCarry=!1,this._clearDragTimeout()):this._endDrag(event))},p._onViewMouseUpOutside=function(event){this.isActive&&this._viewIsSelected&&this._endDrag(event)},p._onViewMouseMove=function(event){this.isActive&&this._viewIsSelected&&this._dragMove(event)},p._onViewMouseMoveOutOfWindow=function(event){this.isActive&&this._viewIsSelected&&(console.log("Mouse up outside of window."),this._endDrag(event))},p._startDragTimeout=function(){var dragTimeThreshold=1e3*this._dragTimeThreshold;this._dragTimeout=setTimeout(function(){this._isClickAndCarry=!1,this._dragTimeout=null}.bind(this),dragTimeThreshold)},p._clearDragTimeout=function(){this._dragTimeout&&(clearTimeout(this._dragTimeout),this._dragTimeout=null)},namespace("framework").StickyAndDragViewScript=StickyAndDragViewScript}(),function(){function StickyDragViewScript(config){var finalConfig=Object.extend({shouldSnap:!1},config);DragViewScript.call(this,finalConfig),this._shouldSnap=finalConfig.shouldSnap,this._firstClickOccurring=!1}var DragViewScript=include("framework.DragViewScript"),Vector=(include("framework.WindowUtils"),include("framework.Vector")),s=DragViewScript.prototype,p=extend(StickyDragViewScript,DragViewScript);p.init=function(){s.init.call(this),this._firstClickOccurring=!1},p.deinit=function(){s.deinit.call(this)},p.startDrag=function(event){this._viewIsSelected=!1,this._onViewMouseUp(event)},p.stopDrag=function(event){this._viewIsSelected=!0,this._onViewMouseUp(event)},p._onViewMouseDown=function(event){this.isActive&&console.log("Mouse down.")},p._onViewMouseUp=function(event){if(this.isActive)if(console.log("Mouse up."),this._viewIsSelected)this._endDrag(event);else{if(this._shouldSnap){var convertedPosition=Vector.transformGlobalToChild(event.data.global,this._view.parent);this._view.position.x=convertedPosition.x,this._view.position.y=convertedPosition.y}this._beginDrag(event)}},p._onViewMouseUpOutside=function(event){this.isActive&&(console.log("Mouse up outside."),this._viewIsSelected&&this._endDrag(event))},p._onViewMouseMove=function(event){this.isActive&&this._viewIsSelected&&this._dragMove(event)},p._onViewMouseMoveOutOfWindow=function(event){this.isActive&&this._viewIsSelected&&console.log("Mouse up outside of window.")},namespace("framework").StickyDragViewScript=StickyDragViewScript}(),function(){function NullViewTransformer(){ViewTransformer.call(this,{})}var ViewTransformer=include("framework.ViewTransformer");ViewTransformer.prototype,extend(NullViewTransformer,ViewTransformer);namespace("framework").NullViewTransformer=NullViewTransformer}(),function(){function RotationViewTransformer(config){var finalConfig=Object.extend({step:0,applyStepOnEndOnly:!1,onUpdateCallback:function(view,frameTime){}},config);ViewTransformer.call(this,finalConfig),this._oldRotation=0,this._step=Math.abs(finalConfig.step),this._applyStepOnEndOnly=finalConfig.applyStepOnEndOnly,this._onUpdateCallback=finalConfig.onUpdateCallback}var ViewTransformer=include("framework.ViewTransformer"),Vector=include("framework.Vector"),p=(ViewTransformer.prototype,extend(RotationViewTransformer,ViewTransformer));p.captureState=function(){this._oldRotation=this._view.rotation,this._startAngle=Vector.toAngle(this._helper.mouseOffsetVec)},p.updateState=function(frameTime){var currentViewPosition=this._view.position,mousePosition=this._helper.getLocalMousePosition(),clickDirectionVec=Vector.sub(mousePosition,currentViewPosition),currentAngle=Vector.toAngle(clickDirectionVec),currentRotation=this._oldRotation+(currentAngle-this._startAngle);currentRotation=this._applyModifiersToRotation(currentRotation,this._applyStepOnEndOnly),this._view.rotation=currentRotation,this._onUpdateCallback&&this._onUpdateCallback(this._view,frameTime)},p.restoreState=function(){if(this._applyStepOnEndOnly){var rotation=this._applyModifiersToRotation(this._view.rotation);this._view.rotation=rotation}},p._applyModifiersToRotation=function(rotation,skipStep){return 0<this._step&&!skipStep&&(rotation=Math.trunc(rotation/this._step)*this._step),rotation=Math.wrap(rotation,-Math.PI,Math.PI)},namespace("framework").RotationViewTransformer=RotationViewTransformer}(),function(){function Entity(config){var finalConfig=Object.extend({},config);CompositeScript.call(this,finalConfig)}var CompositeScript=include("framework.CompositeScript"),p=(CompositeScript.prototype,extend(Entity,CompositeScript));p.addChild=function(entity,skipInit){this.addScript(entity,skipInit)},p.addChildren=function(entities,skipInit){this.addScripts(entities,skipInit)},p.removeChild=function(entity,skipDeinit){this.removeScript(entity,skipDeinit)},p.removeChildren=function(entities,skipDeinit){this.removeScripts(entities,skipDeinit)},p.addDebugChild=function(entity,skipInit){this.addDebugScript(entity,skipInit)},p.addDebugChildren=function(entities,skipInit){this.addDebugScripts(entities,skipInit)},p.removeDebugChild=function(entity,skipDeinit){this.removeDebugScript(entity,skipDeinit)},p.removeDebugChildren=function(entities,skipDeinit){this.removeDebugScripts(entities,skipDeinit)},namespace("framework").Entity=Entity}(),function(){function ViewController(config){var finalConfig=Object.extend({view:null,parentView:null,viewConfig:{},destroyProvidedView:!1,actionManager:null},config);Entity.call(this,config),this._providedView=finalConfig.view,this._parentView=finalConfig.parentView,this._viewConfig=finalConfig.viewConfig,this._destroyProvidedView=finalConfig.destroyProvidedView,this._view=null,this._actionManager=finalConfig.actionManager||new ActionManager,this._uniqueAction=null}var Entity=include("framework.Entity"),ContainerView=include("framework.ContainerView"),ActionManager=include("framework.ActionManager"),s=Entity.prototype,p=extend(ViewController,Entity);Object.defineProperty(p,"view",{get:function(){return this._view}}),Object.defineProperty(p,"parentView",{set:function(parentView){this._setParentView(parentView)},get:function(view){return this._view.parent||this._parentView}}),Object.defineProperty(p,"actionManager",{get:function(){return this._actionManager}}),p.init=function(){s.init.call(this),this._initView()},p.deinit=function(){this._deinitActions(),s.deinit.call(this),this._deinitView()},p.update=function(frameTime){s.update.call(this,frameTime),this._isActive&&this._actionManager.update(frameTime)},p.swapChild=function(currentChild,newChild){newChild!==currentChild&&(newChild&&(newChild.parentView=this._view,this.addChild(newChild)),currentChild&&this.removeChild(currentChild))},p.runAction=function(action,callbacks){this._runAction(action,callbacks)},p.runUniqueAction=function(action,callbacks){this._runUniqueAction(action,callbacks)},p.cancelAction=function(action){this.cancelActions(action)},p.cancelUniqueAction=function(){this._uniqueAction&&(this.cancelAction(this._uniqueAction),this._uniqueAction=null)},p.cancelActions=function(actions){var actionInstances=Object.values(this._actionManager.actions);actions&&(actions=arrayify(actions).filter(function(action){return!!action}),actionInstances=actionInstances.filter(function(actionInstance){return!!actionInstance&&actions.contains(actionInstance.action)})),this._cancelActionInstances(actionInstances)},p._initView=function(){this._view&&this._deinitView();var view=null;this._providedView?view=this._providedView:(view=new ContainerView,app.viewFactory.createChildren(this._viewConfig,view)),this._view=view,this._view&&this._parentView&&this._parentView.addChild(this._view)},p._deinitView=function(){this._view&&(this._parentView&&this._parentView.removeChild(this._view),this._providedView&&!this._destroyProvidedView||this._view.destroy({children:!0}),this._view=null)},p._setParentView=function(parentView){this._parentView=parentView,this._view&&(this._parentView?this._parentView.addChild(this._view):this._view.parent&&this._view.parent.removeChild(this._view))},p._runAction=function(action,callbacks){if(action){callbacks=this._createCallbacksConfig(callbacks),action.reset();var actionInstance=this._actionManager.runAction(action);callbacks.startedCallback&&actionInstance.once("start",callbacks.startedCallback),callbacks.finishedCallback&&actionInstance.once("end",callbacks.finishedCallback),callbacks.cancelledCallback&&actionInstance.once("cancel",callbacks.cancelledCallback)}},p._runUniqueAction=function(action,callbacks){this.cancelUniqueAction(),this._uniqueAction=action,this._runAction(action,callbacks)},p._cancelActionInstances=function(actionInstances){arrayify(actionInstances).filter(function(actionInstance){return!!actionInstance}).forEach(function(actionInstance){this._actionManager.cancelAction(actionInstance)}.bind(this))},p._deinitActions=function(){this.cancelActions(),this._uniqueAction=null},p._createCallbacksConfig=function(callbacks){return isFunction(callbacks)&&(callbacks={finishedCallback:callbacks,cancelledCallback:callbacks}),callbacks=Object.extend({startedCallback:null,finishedCallback:null,cancelledCallback:null},callbacks)},namespace("framework").ViewController=ViewController}(),function(){function VirtualKeyboard(config){var finalConfig=Object.extend({windowCentreX:540,windowMaxY:720},config),stage=Application.instance.display.stage,keyboardViewConfig=this._buildKeyboardViewConfig();ViewController.call(this,{parentView:stage,viewConfig:keyboardViewConfig}),this._windowCentreX=finalConfig.windowCentreX,this._windowMaxY=finalConfig.windowMaxY,this._height=keyboardViewConfig.keyboardHeight,this._isOpen=!1,this._checkDownCallback=null,this._stageWasInteractive=stage.interactive,this._events=new EventDispatcher}var ViewController=include("framework.ViewController"),ClickScript=include("framework.ClickScript"),Application=include("springroll.Application"),EventDispatcher=include("springroll.EventDispatcher"),s=ViewController.prototype,p=extend(VirtualKeyboard,ViewController);Object.defineProperty(p,"events",{get:function(){return this._events}}),Object.defineProperty(p,"height",{get:function(){return this._height}}),p.init=function(){s.init.call(this),this._backgroundView=this._view.getChildByName("background"),this._backspaceView=this._view.getChildByName("backspace"),this._enterView=this._view.getChildByName("enter"),this._doneView=this._view.getChildByName("done"),this._spacebarView=this._view.getChildByName("spacebar"),this._alphaKeysView=this._view.getChildByName("alphaKeys"),this._goToPuncView=this._view.getChildByName("goToPunc"),this._shiftOnView=this._view.getChildByName("shiftOn"),this._shiftOffView=this._view.getChildByName("shiftOff"),this._shiftOnKeysView=this._view.getChildByName("shiftOnKeys"),this._shiftOffKeysView=this._view.getChildByName("shiftOffKeys"),this._punctuationKeysView=this._view.getChildByName("punctuationKeys"),this._goToAlphaView=this._view.getChildByName("goToAlpha"),this._punc1View=this._view.getChildByName("punc1"),this._punc2View=this._view.getChildByName("punc2"),this._basePuncKeysView=this._view.getChildByName("basePuncKeys"),this._punc1KeysView=this._view.getChildByName("punc1Keys"),this._punc2KeysView=this._view.getChildByName("punc2Keys");var clickScripts={background:new ClickScript({view:this._backgroundView,clickStartCallback:EmptyFunction,clickEndOutsideCallback:this._viewClickEndOutside.bind(this)}),backspace:new ClickScript({view:this._backspaceView,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._standardKeyClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this),stopPropagation:!1}),enter:new ClickScript({view:this._enterView,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._standardKeyClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this),stopPropagation:!1}),done:new ClickScript({view:this._doneView,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._standardKeyClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this),stopPropagation:!1}),spacebar:new ClickScript({view:this._spacebarView,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._standardKeyClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this),stopPropagation:!1}),goToPunc:new ClickScript({view:this._goToPuncView,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._goToPuncClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this)}),goToAlpha:new ClickScript({view:this._goToAlphaView,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._goToAlphaClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this)}),shiftOn:new ClickScript({view:this._shiftOnView,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._shiftOnClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this)}),shiftOff:new ClickScript({view:this._shiftOffView,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._shiftOffClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this)}),punc1:new ClickScript({view:this._punc1View,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._punc1ClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this)}),punc2:new ClickScript({view:this._punc2View,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._punc2ClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this)})},createAlphaKeyClickScript=function(key){return new ClickScript({view:key,clickStartCallback:this._viewClickStart.bind(this),clickEndCallback:this._standardKeyClickEnd.bind(this),clickEndOutsideCallback:this._viewClickEndOutside.bind(this),stopPropagation:!1})}.bind(this),shiftOnKeysViewScripts=this._shiftOnKeysView.children.map(createAlphaKeyClickScript),shiftOffKeysViewScripts=this._shiftOffKeysView.children.map(createAlphaKeyClickScript),basePuncKeysViewScripts=this._basePuncKeysView.children.map(createAlphaKeyClickScript),punc1KeysViewScripts=this._punc1KeysView.children.map(createAlphaKeyClickScript),punc2KeysViewScripts=this._punc2KeysView.children.map(createAlphaKeyClickScript);this._keyboardScripts={alphaModeShiftOn:[clickScripts.goToPunc,clickScripts.shiftOn].concat(shiftOnKeysViewScripts),alphaModeShiftOff:[clickScripts.goToPunc,clickScripts.shiftOff].concat(shiftOffKeysViewScripts),punctuationMode1:[clickScripts.goToAlpha,clickScripts.punc2].concat(basePuncKeysViewScripts).concat(punc1KeysViewScripts),punctuationMode2:[clickScripts.goToAlpha,clickScripts.punc1].concat(basePuncKeysViewScripts).concat(punc2KeysViewScripts),persistent:[clickScripts.background,clickScripts.backspace,clickScripts.enter,clickScripts.done,clickScripts.spacebar]},this._setState("alphaModeShiftOff"),this._enable(!1),this._view.position.set(this._windowCentreX,this._windowMaxY)},p.deinit=function(){this.close(),s.deinit.call(this)},p.open=function(){this._isOpen||(this._setState("alphaModeShiftOff"),this._enable(!0))},p.close=function(){this._isOpen&&this._enable(!1)},p.toggle=function(){this._isOpen?this.close():this.open()},p._enable=function(enable){this.isActive=enable,this._isOpen=enable,this._view.visible=enable},p._checkDown=function(e){var touchPos=e.data.global;this._view.getBounds().contains(touchPos.x,touchPos.y)||this.close()},p._setState=function(state){switch(state){case"alphaModeShiftOn":this._alphaKeysView.visible=!0,this._punctuationKeysView.visible=!1,this._shiftOnView.visible=!0,this._shiftOffView.visible=!1,this._shiftOnKeysView.visible=!0,this._shiftOffKeysView.visible=!1;break;case"alphaModeShiftOff":this._alphaKeysView.visible=!0,this._punctuationKeysView.visible=!1,this._shiftOnView.visible=!1,this._shiftOffView.visible=!0,this._shiftOnKeysView.visible=!1,this._shiftOffKeysView.visible=!0;break;case"punctuationMode1":this._alphaKeysView.visible=!1,this._punctuationKeysView.visible=!0,this._punc2View.visible=!0,this._punc1View.visible=!1,this._punc1KeysView.visible=!0,this._punc2KeysView.visible=!1;break;case"punctuationMode2":this._alphaKeysView.visible=!1,this._punctuationKeysView.visible=!0,this._punc2View.visible=!1,this._punc1View.visible=!0,this._punc1KeysView.visible=!1,this._punc2KeysView.visible=!0}this.removeScripts(),this.addScripts(this._keyboardScripts.persistent),this.addScripts(this._keyboardScripts[state])},p._viewClickStart=function(event,view){view.setHighlighted(!0);var key=this._getKeyForView(view);key&&this._events.trigger("keyDown",event,key)},p._viewClickEndOutside=function(event,view){view.setHighlighted(!1)},p._goToPuncClickEnd=function(event,view){view.setHighlighted(!1),this._setState("punctuationMode1")},p._goToAlphaClickEnd=function(event,view){view.setHighlighted(!1),this._setState("alphaModeShiftOff")},p._shiftOnClickEnd=function(event,view){view.setHighlighted(!1),this._setState("alphaModeShiftOff")},p._shiftOffClickEnd=function(event,view){view.setHighlighted(!1),this._setState("alphaModeShiftOn")},p._punc1ClickEnd=function(event,view){view.setHighlighted(!1),this._setState("punctuationMode1")},p._punc2ClickEnd=function(event,view){view.setHighlighted(!1),this._setState("punctuationMode2")},p._standardKeyClickEnd=function(event,view){view.setHighlighted(!1);var key=this._getKeyForView(view);key&&this._events.trigger("keyUp",event,key)},p._getKeyForView=function(view){var key=null;switch(view.kind){case"backspace":key="backspace";break;case"enter":key="enter";break;case"done":key="done";break;case"spacebar":key="spacebar";break;case"alpha":key=view.value}return key},p._buildKeyboardViewConfig=function(){return{keyboardHeight:400,background:{type:"primitive",name:"background",isInteractive:!0,zIndex:0,fillColour:"#cccccc",lineWidth:0,vertexList:[{x:-640,y:0},{x:640,y:0},{x:640,y:-400},{x:-640,y:-400}]},foreground:{type:"container",name:"foreground",zIndex:1,children:[{type:"keyboardKey",name:"backspace",position:{x:390,y:-150},kind:"backspace"},{type:"keyboardKey",name:"enter",position:{x:260,y:-50},kind:"enter",value:"Enter",isVisible:!1},{type:"keyboardKey",name:"done",position:{x:390,y:-50},kind:"done",value:"Done"},{type:"keyboardKey",name:"spacebar",position:{x:0,y:-50},kind:"spacebar",value:"Space"},{type:"container",name:"alphaKeys",children:[{type:"keyboardKey",name:"goToPunc",position:{x:-390,y:-50},kind:"goToPunc",value:"123"},{type:"container",position:{x:-390,y:-150},children:[{type:"keyboardKey",name:"shiftOn",kind:"shiftOn",isVisible:!1},{type:"keyboardKey",name:"shiftOff",kind:"shiftOff"}]},{type:"container",name:"shiftOnKeys",children:[{type:"keyboardKey",position:{x:-405,y:-350},kind:"alpha",value:"Q"},{type:"keyboardKey",position:{x:-315,y:-350},kind:"alpha",value:"W"},{type:"keyboardKey",position:{x:-225,y:-350},kind:"alpha",value:"E"},{type:"keyboardKey",position:{x:-135,y:-350},kind:"alpha",value:"R"},{type:"keyboardKey",position:{x:-45,y:-350},kind:"alpha",value:"T"},{type:"keyboardKey",position:{x:45,y:-350},kind:"alpha",value:"Y"},{type:"keyboardKey",position:{x:135,y:-350},kind:"alpha",value:"U"},{type:"keyboardKey",position:{x:225,y:-350},kind:"alpha",value:"I"},{type:"keyboardKey",position:{x:315,y:-350},kind:"alpha",value:"O"},{type:"keyboardKey",position:{x:405,y:-350},kind:"alpha",value:"P"},{type:"keyboardKey",position:{x:-360,y:-250},kind:"alpha",value:"A"},{type:"keyboardKey",position:{x:-270,y:-250},kind:"alpha",value:"S"},{type:"keyboardKey",position:{x:-180,y:-250},kind:"alpha",value:"D"},{type:"keyboardKey",position:{x:-90,y:-250},kind:"alpha",value:"F"},{type:"keyboardKey",position:{x:0,y:-250},kind:"alpha",value:"G"},{type:"keyboardKey",position:{x:90,y:-250},kind:"alpha",value:"H"},{type:"keyboardKey",position:{x:180,y:-250},kind:"alpha",value:"J"},{type:"keyboardKey",position:{x:270,y:-250},kind:"alpha",value:"K"},{type:"keyboardKey",position:{x:360,y:-250},kind:"alpha",value:"L"},{type:"keyboardKey",position:{x:-270,y:-150},kind:"alpha",value:"Z"},{type:"keyboardKey",position:{x:-180,y:-150},kind:"alpha",value:"X"},{type:"keyboardKey",position:{x:-90,y:-150},kind:"alpha",value:"C"},{type:"keyboardKey",position:{x:0,y:-150},kind:"alpha",value:"V"},{type:"keyboardKey",position:{x:90,y:-150},kind:"alpha",value:"B"},{type:"keyboardKey",position:{x:180,y:-150},kind:"alpha",value:"N"},{type:"keyboardKey",position:{x:270,y:-150},kind:"alpha",value:"M"}]},{type:"container",name:"shiftOffKeys",children:[{type:"keyboardKey",position:{x:-405,y:-350},kind:"alpha",value:"q"},{type:"keyboardKey",position:{x:-315,y:-350},kind:"alpha",value:"w"},{type:"keyboardKey",position:{x:-225,y:-350},kind:"alpha",value:"e"},{type:"keyboardKey",position:{x:-135,y:-350},kind:"alpha",value:"r"},{type:"keyboardKey",position:{x:-45,y:-350},kind:"alpha",value:"t"},{type:"keyboardKey",position:{x:45,y:-350},kind:"alpha",value:"y"},{type:"keyboardKey",position:{x:135,y:-350},kind:"alpha",value:"u"},{type:"keyboardKey",position:{x:225,y:-350},kind:"alpha",value:"i"},{type:"keyboardKey",position:{x:315,y:-350},kind:"alpha",value:"o"},{type:"keyboardKey",position:{x:405,y:-350},kind:"alpha",value:"p"},{type:"keyboardKey",position:{x:-360,y:-250},kind:"alpha",value:"a"},{type:"keyboardKey",position:{x:-270,y:-250},kind:"alpha",value:"s"},{type:"keyboardKey",position:{x:-180,y:-250},kind:"alpha",value:"d"},{type:"keyboardKey",position:{x:-90,y:-250},kind:"alpha",value:"f"},{type:"keyboardKey",position:{x:0,y:-250},kind:"alpha",value:"g"},{type:"keyboardKey",position:{x:90,y:-250},kind:"alpha",value:"h"},{type:"keyboardKey",position:{x:180,y:-250},kind:"alpha",value:"j"},{type:"keyboardKey",position:{x:270,y:-250},kind:"alpha",value:"k"},{type:"keyboardKey",position:{x:360,y:-250},kind:"alpha",value:"l"},{type:"keyboardKey",position:{x:-270,y:-150},kind:"alpha",value:"z"},{type:"keyboardKey",position:{x:-180,y:-150},kind:"alpha",value:"x"},{type:"keyboardKey",position:{x:-90,y:-150},kind:"alpha",value:"c"},{type:"keyboardKey",position:{x:0,y:-150},kind:"alpha",value:"v"},{type:"keyboardKey",position:{x:90,y:-150},kind:"alpha",value:"b"},{type:"keyboardKey",position:{x:180,y:-150},kind:"alpha",value:"n"},{type:"keyboardKey",position:{x:270,y:-150},kind:"alpha",value:"m"}]}]},{type:"container",name:"punctuationKeys",children:[{type:"keyboardKey",name:"goToAlpha",position:{x:-390,y:-50},kind:"goToAlpha",value:"ABC"},{type:"container",position:{x:-390,y:-150},children:[{type:"keyboardKey",name:"punc1",kind:"punc1",isVisible:!1,value:"123"},{type:"keyboardKey",name:"punc2",kind:"punc2",value:"#+="}]},{type:"container",name:"basePuncKeys",children:[{type:"keyboardKey",position:{x:-180,y:-150},kind:"alpha",value:"."},{type:"keyboardKey",position:{x:-90,y:-150},kind:"alpha",value:","},{type:"keyboardKey",position:{x:0,y:-150},kind:"alpha",value:"?"},{type:"keyboardKey",position:{x:90,y:-150},kind:"alpha",value:"!"},{type:"keyboardKey",position:{x:180,y:-150},kind:"alpha",value:"'"}]},{type:"container",name:"punc1Keys",children:[{type:"keyboardKey",position:{x:-405,y:-350},kind:"alpha",value:"1"},{type:"keyboardKey",position:{x:-315,y:-350},kind:"alpha",value:"2"},{type:"keyboardKey",position:{x:-225,y:-350},kind:"alpha",value:"3"},{type:"keyboardKey",position:{x:-135,y:-350},kind:"alpha",value:"4"},{type:"keyboardKey",position:{x:-45,y:-350},kind:"alpha",value:"5"},{type:"keyboardKey",position:{x:45,y:-350},kind:"alpha",value:"6"},{type:"keyboardKey",position:{x:135,y:-350},kind:"alpha",value:"7"},{type:"keyboardKey",position:{x:225,y:-350},kind:"alpha",value:"8"},{type:"keyboardKey",position:{x:315,y:-350},kind:"alpha",value:"9"},{type:"keyboardKey",position:{x:405,y:-350},kind:"alpha",value:"0"},{type:"keyboardKey",position:{x:-405,y:-250},kind:"alpha",value:"-"},{type:"keyboardKey",position:{x:-315,y:-250},kind:"alpha",value:"/"},{type:"keyboardKey",position:{x:-225,y:-250},kind:"alpha",value:":"},{type:"keyboardKey",position:{x:-135,y:-250},kind:"alpha",value:";"},{type:"keyboardKey",position:{x:-45,y:-250},kind:"alpha",value:"("},{type:"keyboardKey",position:{x:45,y:-250},kind:"alpha",value:")"},{type:"keyboardKey",position:{x:135,y:-250},kind:"alpha",value:"$"},{type:"keyboardKey",position:{x:225,y:-250},kind:"alpha",value:"&"},{type:"keyboardKey",position:{x:315,y:-250},kind:"alpha",value:"@"},{type:"keyboardKey",position:{x:405,y:-250},kind:"alpha",value:'"'}]},{type:"container",name:"punc2Keys",children:[{type:"keyboardKey",position:{x:-405,y:-350},kind:"alpha",value:"["},{type:"keyboardKey",position:{x:-315,y:-350},kind:"alpha",value:"]"},{type:"keyboardKey",position:{x:-225,y:-350},kind:"alpha",value:"{"},{type:"keyboardKey",position:{x:-135,y:-350},kind:"alpha",value:"}"},{type:"keyboardKey",position:{x:-45,y:-350},kind:"alpha",value:"#"},{type:"keyboardKey",position:{x:45,y:-350},kind:"alpha",value:"%"},{type:"keyboardKey",position:{x:135,y:-350},kind:"alpha",value:"^"},{type:"keyboardKey",position:{x:225,y:-350},kind:"alpha",value:"*"},{type:"keyboardKey",position:{x:315,y:-350},kind:"alpha",value:"+"},{type:"keyboardKey",position:{x:405,y:-350},kind:"alpha",value:"="},{type:"keyboardKey",position:{x:-405,y:-250},kind:"alpha",value:"_"},{type:"keyboardKey",position:{x:-315,y:-250},kind:"alpha",value:"\\"},{type:"keyboardKey",position:{x:-225,y:-250},kind:"alpha",value:"|"},{type:"keyboardKey",position:{x:-135,y:-250},kind:"alpha",value:"~"},{type:"keyboardKey",position:{x:-45,y:-250},kind:"alpha",value:"<"},{type:"keyboardKey",position:{x:45,y:-250},kind:"alpha",value:">"},{type:"keyboardKey",position:{x:135,y:-250},kind:"alpha",value:""},{type:"keyboardKey",position:{x:225,y:-250},kind:"alpha",value:""},{type:"keyboardKey",position:{x:315,y:-250},kind:"alpha",value:""},{type:"keyboardKey",position:{x:405,y:-250},kind:"alpha",value:""}]}]}]}}},namespace("framework").VirtualKeyboard=VirtualKeyboard}(),function(){function PreloadService(config){var finalConfig=Object.extend({app:null,sound:null},config);if(!finalConfig.app)throw"PreloadService: app is null.";this._app=finalConfig.app,this._sound=finalConfig.sound,this._loadedAssets=[]}include("springroll.DelayedCall"),include("framework.GeneralUtils");var p=PreloadService.prototype;Object.defineProperty(p,"loadedAssets",{get:function(){return this._loadedAssets}}),p.load=function(assets,callbacks){callbacks={progress:callbacks?callbacks.progress:null,complete:callbacks?callbacks.complete:null};var completeCallback=function(results){this.addLoadedAssets(assets),callbacks.complete&&callbacks.complete(results)}.bind(this);return this._app.load(assets,{cacheAll:!0,startAll:!1,progress:callbacks.progress,complete:completeCallback}),assets},p.loadWithSounds=function(assets,soundsJSON,modifyAssets,callbacks){assets||(assets=[]);var soundAssets=this.createSoundAssetsFromJSON(soundsJSON);return modifyAssets?Array.prototype.push.apply(assets,soundAssets):assets=assets.concat(soundAssets),this.load(assets,callbacks),assets},p.unload=function(assets){return assets&&(this.unloadSounds(assets),this._app.unload(assets),this.removeLoadedAssets(assets)),assets},p.unloadSounds=function(assets){var soundAssets=arrayify(assets).filter(function(asset){return!!asset}).map(function(asset){return this._app.getCache(asset.id)}.bind(this)).filter(function(cachedAsset){return this.isSoundAsset(cachedAsset)}.bind(this));return soundAssets.forEach(function(soundAsset){soundAsset.destroy()}),soundAssets},p.createSoundAssetsFromJSON=function(soundsJSON){return soundsJSON?(this._sound&&(soundsJSON.vo&&this._sound.addContext(soundsJSON.vo),soundsJSON.sfx&&this._sound.addContext(soundsJSON.sfx),soundsJSON.music&&this._sound.addContext(soundsJSON.music)),Object.values(soundsJSON).filter(function(soundContext){return!!soundContext}).map(function(soundContext){return soundContext.sounds}).filter(function(soundArray){return isArray(soundArray)}).reduce(function(array1,array2){return array1.concat(array2)}).filter(function(soundAsset){return!!soundAsset}).map(function(soundAsset){return soundAsset.id}).map(function(soundID){return{id:soundID,sounds:[soundID]}})):null},p.isSoundAsset=function(asset){return isArray(asset)&&0<asset.length&&!!this._sound&&this._sound.exists(asset[0])},p.concat=function(assets,assetsToAdd,soundsJSON,modifyAssets){if(assets||(assets=[]),soundsJSON){var soundAssets=this.createSoundAssetsFromJSON(soundsJSON);modifyAssets?Array.prototype.push.apply(assetsToAdd,soundAssets):assetsToAdd=assetsToAdd.concat(soundAssets)}return Array.prototype.push.apply(assets,assetsToAdd),assets},p.addLoadedAssets=function(assets){this._loadedAssets.append(assets)},p.removeLoadedAssets=function(assets){var assetsToRemove=assets.clone();this._loadedAssets.remove(assetsToRemove)},namespace("framework").PreloadService=PreloadService}(),function(){function SizeManager(app,config){if(EventEmitter.call(this),!config)throw"SizeManager: config is null.";if(!config.width||!config.height)throw"SizeManager: config doesn't have valid width and/or height.";if(this.width=config.width,this.height=config.height,this.maxWidth=config.maxWidth||config.width,this.maxHeight=config.maxHeight||config.height,this.min={x:.5*(this.width-this.maxWidth),y:.5*(this.height-this.maxHeight)},this.max={x:this.min.x+this.maxWidth,y:this.min.y+this.maxHeight},this.centre={x:.5*this.width,y:.5*this.height},this.originalAspectRatio=this.width/this.height,this.currentAspectRatio=0,this.currentScale=0,this.currentWidth=0,this.currentHeight=0,this.currentMin={x:0,y:0},this._app=app,this._app){var options=this._app.options;this.maxWidth&&(options.maxWidth=this.maxWidth),this.maxHeight&&(options.maxHeight=this.maxHeight),this.resize=this.resize.bind(this),this._app.on("resize",this.resize),this._app.triggerResize()}}var EventEmitter=include("PIXI.utils.EventEmitter"),p=(include("springroll.Application"),EventEmitter.prototype,extend(SizeManager,EventEmitter));p.destroy=function(){this._app&&(this._app.off("resize",this.resize),this._app=null),this.removeAllListeners()},p.resize=function(width,height){if(this.currentAspectRatio=width/height,this.currentScale=this.currentAspectRatio>this.originalAspectRatio?height/this.height:width/this.width,this.currentWidth=width/this.currentScale,this.currentHeight=height/this.currentScale,this.currentMin.x=-.5*(this.currentWidth-this.width),this.currentMin.y=-.5*(this.currentHeight-this.height),this._app){var stage=this._app.display.stage;stage.scale.x=this.currentScale,stage.scale.y=this.currentScale,stage.position.x=.5*(width-this.width*this.currentScale),stage.position.y=.5*(height-this.height*this.currentScale),this._app.display.isWebGL||stage.getBounds()}this.emit("resize",this)},namespace("framework").SizeManager=SizeManager}(),function(){function BaseApp(options){var displayContext=this._getDefaultDisplayContext();options=Object.extend({scaling:{width:960,height:720,maxWidth:1280,maxHeight:720},audioTypes:["mp3"],displayOptions:{forceContext:displayContext}},options),Application.call(this,options),this.preloadService=null,this.size=null,this._frameCallback=null,this._onUpdate=this._onUpdate.bind(this),this._scalingConfig=options.scaling,this.options.override("responsive",!0),this.on("configLoaded",this._configLoaded.bind(this)),this.on("progress",this._onProgress.bind(this)),this.on("loaded",this._onLoaded.bind(this)),this.on("loading",this._onLoading.bind(this)),this.on("beforeInit",this._onBeforeInit.bind(this)),this.on("init",this._init.bind(this)),this.on("afterInit",this._afterInit.bind(this)),this.on("destroy",this._onDestroy.bind(this)),this._setCanvasDimensions(options.canvasId,options.scaling)}var Application=include("springroll.Application"),TimeUtils=include("springroll.TimeUtils"),DeviceUtils=include("framework.DeviceUtils"),PreloadService=include("framework.PreloadService"),SizeManager=include("framework.SizeManager"),ViewFactory=include("framework.ViewFactory"),VirtualKeyboard=include("framework.VirtualKeyboard"),s=Application.prototype,p=extend(BaseApp,Application);p.destroy=function(){this.virtualKeyboard&&(this.virtualKeyboard.deinit(),this.virtualKeyboard=null),TWEEN&&TWEEN.removeAll(),this.size&&(this.size.destroy(),this.size=null),s.destroy.call(this)},p.enableUserInput=function(enable){this.display&&(this.display.enabled=enable),this.keyboard&&(this.keyboard.enabled=enable),this.trigger("inputEnabled",enable)},p._onConfigLoaded=function(config,assets){},p._onProgress=function(progress){},p._onLoaded=function(results){},p._onLoading=function(assets){},p._onBeforeInit=function(){},p._onInit=function(){},p._onAfterInit=function(){},p._onUpdate=function(frameTime){},p._onDestroy=function(){},p._getDefaultDisplayContext=function(){return DeviceUtils.isIE11?"webgl":null},p._setCanvasDimensions=function(canvasID,scalingConfig){var canvas=document.getElementById(canvasID);if(canvas){var width=getProperty(scalingConfig,"width")||960,height=getProperty(scalingConfig,"height")||720;canvas.width=width,canvas.height=height}},p._configLoaded=function(config,assets){this.preloadService=new PreloadService({app:this,sound:this.sound}),this.size=new SizeManager(this,this._scalingConfig),this.assetManager.register("framework.SpineLoaderTask"),this._onConfigLoaded(config,assets)},p._init=function(){this._setup(),this._onInit()},p._afterInit=function(){this._run(),this._onAfterInit()},p._setup=function(){this._newState=null,this.viewFactory=this._createViewFactory(),this.virtualKeyboard=new VirtualKeyboard({windowCentreX:this.size.centre.x,windowMaxY:this.size.max.y}),this.virtualKeyboard.init()},p._run=function(){var virtualKeyboardView=this.virtualKeyboard.view;this.virtualKeyboard.parentView.removeChild(virtualKeyboardView),this.virtualKeyboard.parentView.addChild(virtualKeyboardView),this._frameCallback||(this._frameCallback=this._frame.bind(this),this.on("update",this._frameCallback))},p._frame=function(frameTimeMs){TimeUtils._frameTime=.001*frameTimeMs,TWEEN.update(),this._onUpdate(TimeUtils._frameTime)},p._createViewFactory=function(){return new ViewFactory},namespace("framework").BaseApp=BaseApp}(),function(){var PixiDisplay=include("springroll.pixi.PixiDisplay"),BaseApp=include("framework.BaseApp"),AppHelper=AppHelper||{};AppHelper.createAndRun=function(config){var finalConfig=Object.extend({class:BaseApp,options:{name:"Default Name",canvasId:"stage",display:PixiDisplay,displayOptions:{clearView:!0,transparent:!0},scaling:{width:960,height:720,maxWidth:1280,maxHeight:720}}},config),application=new finalConfig.class(finalConfig.options);return window.app=application},namespace("framework").AppHelper=AppHelper}();var _Tween=TWEEN,_Matter=Matter,_PIXI=PIXI;!function(framework){var LoopedSound=function(){function LoopedSound(){this.soundInstance=null,this.muteTimeout=null}return LoopedSound.prototype.destroy=function(){this.muteTimeout&&(this.muteTimeout.destroy(),this.muteTimeout=null),this.stop()},LoopedSound.prototype.start=function(soundName,options){this.stop();var soundOptions=Object.extend({loop:!0},options);this.soundInstance=app.sound.play(soundName,soundOptions)},LoopedSound.prototype.stop=function(){this.soundInstance&&(this.soundInstance.stop(),this.soundInstance=null)},LoopedSound.prototype.setVolume=function(volume){this.soundInstance&&(this.soundInstance.volume=volume)},LoopedSound.prototype.resetVolume=function(){var _this=this;this.muteTimeout||(this.muteTimeout=this.createTimeout(function(){_this.setVolume(0)})),this.muteTimeout.restart(),this.setVolume(1)},LoopedSound.prototype.isPlaying=function(){return this.soundInstance},LoopedSound.prototype.createTimeout=function(finishedCallback){return new springroll.DelayedCall(finishedCallback,50,!1,!1)},LoopedSound}();framework.LoopedSound=LoopedSound}(framework||(framework={}));var app=null;!function(framework){var Mediator=function(){function Mediator(view,destroyView){void 0===destroyView&&(destroyView=!0),this._view=view,this.destroyView=destroyView,this._children=[],this._parent=null,this.isActive=!0}return Object.defineProperty(Mediator.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(Mediator.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(Mediator.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Mediator.prototype.update=function(frameTime){this.isActive&&(this._view&&this._view.update(frameTime),this._children.forEach(function(child){child.update(frameTime)}))},Mediator.prototype.destroy=function(){this.isActive=!1,this._parent&&this._parent.removeChild(this),this.destroyChildren(),this._children=[],this._view&&(this.destroyView&&this._view.destroy(),this._view=null)},Mediator.prototype.sendToParent=function(messageID,args,child){this._parent&&(child||(child=this),this._parent.handleChildMessage(messageID,args,child))},Mediator.prototype.handleChildMessage=function(messageID,args,child){this.sendToParent(messageID,args,child)},Mediator.prototype.addChild=function(child,parentView){void 0===parentView&&(parentView=null),child&&!this._children.contains(child)&&(parentView||(parentView=this._view),child._parent&&child._parent.removeChild(child),(child._parent=this)._children.push(child),parentView.addChild(child.view))},Mediator.prototype.addChildren=function(children,parentView){var _this=this;void 0===parentView&&(parentView=null),children.forEach(function(child){_this.addChild(child,parentView)})},Mediator.prototype.removeChild=function(child){child&&this._children.contains(child)&&(child.view&&child.view.parent&&child.view.parent.removeChild(child.view),child._parent=null,this._children.remove(child))},Mediator.prototype.removeChildren=function(children){var _this=this;children||(children=this._children),children.reverseForEach(function(child){_this.removeChild(child)})},Mediator.prototype.destroyChild=function(child){this.removeChild(child),child&&child.destroy()},Mediator.prototype.destroyChildren=function(children){var _this=this;children||(children=this._children),children.reverseForEach(function(child){_this.destroyChild(child)})},Mediator.prototype.swapChild=function(currentChild,newChild){if(newChild!=currentChild){var newParentView=null,newChildViewIndex=-1,newChildIndex=-1;currentChild&&(newChildIndex=this._children.indexOf(currentChild),currentChild.view&&currentChild.view.parent&&(newChildViewIndex=(newParentView=currentChild.view.parent).getChildIndex(currentChild.view)),this.removeChild(currentChild)),newChild&&(newParentView=newParentView||this.view,newChildIndex=-1==newChildIndex?this.children.length:newChildIndex,newChildViewIndex=-1==newChildViewIndex?newParentView.children.length:newChildViewIndex,this.addChildAt(newChild,newParentView,newChildIndex,newChildViewIndex))}},Mediator.prototype.addChildAt=function(child,parentView,childIndex,childViewIndex){child&&!this._children.contains(child)&&(child._parent&&child._parent.removeChild(child),(child._parent=this)._children.splice(childIndex,0,child),parentView.addChildAt(child.view,childViewIndex))},Mediator}();framework.Mediator=Mediator}(framework||(framework={})),function(framework){var ViewConfig=function(){};framework.ViewConfig=ViewConfig;var View=function(_super){function View(config){var _this=this;return config||(config=new ViewConfig),(_this=_super.call(this,config)||this)._actionManager=config.actionManager||new framework.ActionManager,_this._scripts=new framework.CompositeScript,_this._scripts.init(),_this._uniqueAction=null,_this._layoutConfig=config.layoutConfig,_this._layoutConfig&&app.viewFactory.createChildren(_this._layoutConfig,_this),config.parent&&config.parent.addChild(_this),_this}return __extends(View,_super),Object.defineProperty(View.prototype,"scripts",{get:function(){return this._scripts},enumerable:!0,configurable:!0}),Object.defineProperty(View.prototype,"actionManager",{get:function(){return this._actionManager},enumerable:!0,configurable:!0}),Object.defineProperty(View.prototype,"layoutConfig",{get:function(){return this._layoutConfig},enumerable:!0,configurable:!0}),View.prototype.destroy=function(shouldDestroyTexture){void 0===shouldDestroyTexture&&(shouldDestroyTexture=!1),this.deinitActions(),this._scripts&&(this._scripts.deinit(),this._scripts=null),this._actionManager&&(this._actionManager=null),this.parent&&this.parent.removeChild(this),_super.prototype.destroy.call(this,{children:!0,texture:shouldDestroyTexture,baseTexture:shouldDestroyTexture})},View.prototype.update=function(frameTime){this._actionManager&&this._actionManager.update(frameTime),this._scripts&&this._scripts.update(frameTime)},View.prototype.swapChild=function(currentChild,newChild){if(newChild!=currentChild){var newChildIndex=-1;currentChild&&(newChildIndex=this.getChildIndex(currentChild),this.removeChild(currentChild)),newChild&&(newChildIndex=-1==newChildIndex?this.children.length:newChildIndex,this.addChildAt(newChild,newChildIndex))}},View.prototype.runAction=function(action,callbacks){this.startAction(action,callbacks)},View.prototype.runUniqueAction=function(action,callbacks){this.startUniqueAction(action,callbacks)},View.prototype.cancelAction=function(action){var actions=[action];this.cancelActions(actions)},View.prototype.cancelUniqueAction=function(){this._uniqueAction&&(this.cancelAction(this._uniqueAction),this._uniqueAction=null)},View.prototype.cancelActions=function(actions){void 0===actions&&(actions=null);var actionInstances=Object.values(this._actionManager.actions);actions&&(actions=actions.filter(function(action){return!!action}),actionInstances=actionInstances.filter(function(actionInstance){return!!actionInstance&&actions.contains(actionInstance.action)})),this.cancelActionInstances(actionInstances)},View.prototype.playVO=function(voName){this.runUniqueAction(framework.Actions.VO(voName))},View.prototype.playSound=function(soundName,options){app.sound.play(soundName,options)},View.prototype.startAction=function(action,callbacks){if(action){callbacks=this.createCallbacksConfig(callbacks),action.reset();var actionInstance=this._actionManager.runAction(action);callbacks.startedCallback&&actionInstance.once("start",callbacks.startedCallback),callbacks.finishedCallback&&actionInstance.once("end",callbacks.finishedCallback),callbacks.cancelledCallback&&actionInstance.once("cancel",callbacks.cancelledCallback)}},View.prototype.startUniqueAction=function(action,callbacks){this.cancelUniqueAction(),this._uniqueAction=action,this.startAction(action,callbacks)},View.prototype.cancelActionInstances=function(actionInstances){var _this=this;actionInstances.filter(function(actionInstance){return!!actionInstance}).forEach(function(actionInstance){_this._actionManager.cancelAction(actionInstance)})},View.prototype.deinitActions=function(){this.cancelActions(),this._uniqueAction=null},View.prototype.createCallbacksConfig=function(callbacks){return isFunction(callbacks)&&(callbacks={finishedCallback:callbacks,cancelledCallback:callbacks}),callbacks=Object.extend({startedCallback:null,finishedCallback:null,cancelledCallback:null},callbacks)},View}(framework.ContainerView);framework.View=View}(framework||(framework={}));var framework,ViewCuller=function(){function ViewCuller(){}return ViewCuller.isOnScreen=function(view){if(!view||!app||!app.display)return!1;var screenBounds=new PIXI.Rectangle(0,0,app.display.width,app.display.height),elementBounds=view.getBounds();return elementBounds.right>screenBounds.left&&elementBounds.left<screenBounds.right&&elementBounds.bottom>screenBounds.top&&elementBounds.top<screenBounds.bottom},ViewCuller}();!function(framework){function DragConstraintConfig(){}framework.DragConstraintConfig=DragConstraintConfig;var DragConstraint=function(){function DragConstraint(config){this.parent=null,this.body=null,this.length=0,this.stiffness=1,this.angularStiffness=0,this.allowThrowing=!1,this.constraint=null,this.initiallyStatic=!1,this.init(config)}return DragConstraint.prototype.getParent=function(){return this.parent},DragConstraint.prototype.getBody=function(){return this.body},DragConstraint.prototype.getLength=function(){return this.length},DragConstraint.prototype.setLength=function(length){this.length=length},DragConstraint.prototype.getStiffness=function(){return this.stiffness},DragConstraint.prototype.setStiffness=function(stiffness){this.stiffness=stiffness},DragConstraint.prototype.getAngularStiffness=function(){return this.angularStiffness},DragConstraint.prototype.setAngularStiffness=function(stiffness){this.angularStiffness=stiffness},DragConstraint.prototype.getAllowThrowing=function(){return this.allowThrowing},DragConstraint.prototype.setAllowThrowing=function(allowThrowing){this.allowThrowing=allowThrowing},DragConstraint.prototype.destroy=function(){this.end(),this.body=null,this.parent=null},DragConstraint.prototype.start=function(worldPosition,body){if((body=body||this.body)&&this.parent){this.end(),this.initiallyStatic=body.isStatic,Matter.Body.setStatic(body,!1);var pointA=worldPosition,pointB=Matter.Vector.sub(worldPosition,body.position);this.constraint=Matter.Constraint.create({length:this.length,stiffness:this.stiffness,bodyB:body,pointA:pointA,pointB:pointB}),this.constraint.angularStiffness=this.angularStiffness,Matter.Composite.add(this.parent,this.constraint)}},DragConstraint.prototype.update=function(worldPosition){this.constraint&&(this.constraint.pointA=worldPosition)},DragConstraint.prototype.end=function(){this.constraint&&(Matter.Body.setStatic(this.body,this.initiallyStatic),this.allowThrowing||Matter.Body.setVelocity(this.body,framework.Vector.create()),Matter.Composite.remove(this.parent,this.constraint),this.constraint=null)},DragConstraint.prototype.setBody=function(body){this.end(),this.body=body},DragConstraint.prototype.setParent=function(parent){this.end(),this.parent=parent},DragConstraint.prototype.isActive=function(){return!!this.constraint},DragConstraint.prototype.init=function(config){config&&(config.parent&&(this.parent=config.parent),config.body&&(this.body=config.body),isDefined(config.length)&&(this.length=config.length),isDefined(config.stiffness)&&(this.stiffness=config.stiffness),isDefined(config.angularStiffness)&&(this.angularStiffness=config.angularStiffness),this.allowThrowing=!isDefined(config.allowThrowing)||config.allowThrowing)},DragConstraint}();framework.DragConstraint=DragConstraint}(framework||(framework={})),function(framework){function PhysicsDebugMediatorConfig(){}framework.PhysicsDebugMediatorConfig=PhysicsDebugMediatorConfig;var PhysicsDebugMediator=function(_super){function PhysicsDebugMediator(config){var _this=_super.call(this,config.view,config.destroyView)||this;return _this.bodyAdded=function(e){var body=e.object;if(body)switch(body.type){case"body":_this.addBody(body);break;case"constraint":_this.addConstraint(body);break;case"composite":_this.registerCompositeBodyEvents(body)}},_this.bodyRemoved=function(e){var body=e.object;if(body)switch(body.type){case"body":_this.removeBody(body);break;case"constraint":_this.removeConstraint(body);break;case"composite":_this.deregisterCompositeBodyEvents(body)}},_this.bodySleepStarted=function(e){var body=e.source;body&&_this.view.setBodyAsSleeping(body.id,!0)},_this.bodySleepEnded=function(e){var body=e.source;body&&_this.view.setBodyAsSleeping(body.id,!1)},_this.setCompositeBody(config.compositeBody),_this}return __extends(PhysicsDebugMediator,_super),PhysicsDebugMediator.prototype.getCompositeBody=function(){return this.compositeBody},PhysicsDebugMediator.prototype.destroy=function(){this.setCompositeBody(null),_super.prototype.destroy.call(this)},PhysicsDebugMediator.prototype.update=function(frameTime){var _this=this;_super.prototype.update.call(this,frameTime),this.isActive&&(Matter.Composite.allBodies(this.compositeBody).forEach(function(body){_this.view.updateBody(body.id,body)}),Matter.Composite.allConstraints(this.compositeBody).forEach(function(constraint){var actualConstraint=constraint;_this.view.updateConstraint(actualConstraint.id,actualConstraint)}))},PhysicsDebugMediator.prototype.setCompositeBody=function(compositeBody){this.compositeBody&&this.deregisterCompositeBodyEvents(this.compositeBody),(this.compositeBody=compositeBody)&&this.registerCompositeBodyEvents(compositeBody)},PhysicsDebugMediator.prototype.addBody=function(body){this.view.addBody(body.id,body),Matter.Events.on(body,"sleepStart",this.bodySleepStarted),Matter.Events.on(body,"sleepEnd",this.bodySleepEnded)},PhysicsDebugMediator.prototype.removeBody=function(body){Matter.Events.off(body,"sleepStart",this.bodySleepStarted),Matter.Events.off(body,"sleepEnd",this.bodySleepEnded),this.view.removeBody(body.id)},PhysicsDebugMediator.prototype.addConstraint=function(constraint){this.view.addConstraint(constraint.id,constraint)},PhysicsDebugMediator.prototype.removeConstraint=function(constraint){this.view.removeConstraint(constraint.id)},PhysicsDebugMediator.prototype.registerCompositeBodyEvents=function(compositeBody){var _this=this;compositeBody&&this.getAllComposites(compositeBody).forEach(function(composite){Matter.Events.on(composite,"afterAdd",_this.bodyAdded),Matter.Events.on(composite,"beforeRemove",_this.bodyRemoved)})},PhysicsDebugMediator.prototype.deregisterCompositeBodyEvents=function(compositeBody){var _this=this;compositeBody&&this.getAllComposites(compositeBody).forEach(function(composite){Matter.Events.off(composite,"afterAdd",_this.bodyAdded),Matter.Events.off(composite,"beforeRemove",_this.bodyRemoved)})},PhysicsDebugMediator.prototype.getAllComposites=function(compositeBody){var composites=[];return compositeBody&&(composites.push(compositeBody),composites.push.apply(composites,Matter.Composite.allComposites(compositeBody))),composites},PhysicsDebugMediator}(framework.Mediator);framework.PhysicsDebugMediator=PhysicsDebugMediator}(framework||(framework={})),function(framework){var PhysicsDebugViewConfig=function(_super){function PhysicsDebugViewConfig(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(PhysicsDebugViewConfig,_super),PhysicsDebugViewConfig}(framework.ViewConfig);framework.PhysicsDebugViewConfig=PhysicsDebugViewConfig;var PhysicsDebugView=function(_super){function PhysicsDebugView(config){var _this=_super.call(this,config)||this;return _this.bodies={},_this.constraints={},_this.bodyColours=_this.getBodyColours(config),_this.bodyStaticColours=_this.getBodyStaticColours(config),_this.bodyContainer=new framework.ContainerView,_this.constraintContainer=new framework.ContainerView,_this.addChild(_this.bodyContainer),_this.addChild(_this.constraintContainer),_this}return __extends(PhysicsDebugView,_super),PhysicsDebugView.prototype.destroy=function(){this.constraintContainer&&(this.constraintContainer=null),this.bodyContainer&&(this.bodyContainer=null),this.constraints={},this.bodies={},_super.prototype.destroy.call(this)},PhysicsDebugView.prototype.update=function(frameTime){_super.prototype.update.call(this,frameTime),this.bodies.forIn(function(body){body.visible=ViewCuller.isOnScreen(body)}),this.constraints.forIn(function(constraint){constraint.visible=ViewCuller.isOnScreen(constraint)})},PhysicsDebugView.prototype.addBody=function(id,bodyConfig){if(!this.bodies[id]){var body=this.createBody(bodyConfig);this.bodies[id]=body,this.bodyContainer.addChild(body),this.updateBody(id,bodyConfig)}},PhysicsDebugView.prototype.removeBody=function(id){var body=this.bodies[id];body&&(this.bodyContainer.removeChild(body),delete this.bodies[id])},PhysicsDebugView.prototype.updateBody=function(id,bodyConfig){var body=this.bodies[id];body&&body.visible&&(body.position.set(bodyConfig.position.x,bodyConfig.position.y),body.rotation=bodyConfig.angle)},PhysicsDebugView.prototype.setBodyAsSleeping=function(id,isSleeping){var body=this.bodies[id];body&&(body.getChildAt(0).tint=this.getSleepTint(isSleeping))},PhysicsDebugView.prototype.addConstraint=function(id,constraintConfig){if(!this.constraints[id]){var constraint=this.createConstraint(constraintConfig);this.constraints[id]=constraint,this.constraintContainer.addChild(constraint),this.updateConstraint(id,constraintConfig)}},PhysicsDebugView.prototype.removeConstraint=function(id){var constraint=this.constraints[id];constraint&&(this.constraintContainer.removeChild(constraint),delete this.constraints[id])},PhysicsDebugView.prototype.updateConstraint=function(id,constraintConfig){var constraint=this.constraints[id];if(constraint&&constraint.visible&&(constraint.clear(),constraintConfig.pointA&&constraintConfig.pointB)){constraint.beginFill(0,0),constraint.lineStyle(4,16777215,1);var linePos=Matter.Vector.create();constraintConfig.bodyA?(linePos=Matter.Vector.add(constraintConfig.bodyA.position,constraintConfig.pointA),constraint.moveTo(linePos.x,linePos.y)):constraint.moveTo(constraintConfig.pointA.x,constraintConfig.pointA.y),constraintConfig.bodyB?(linePos=Matter.Vector.add(constraintConfig.bodyB.position,constraintConfig.pointB),constraint.lineTo(linePos.x,linePos.y)):constraint.lineTo(constraintConfig.pointB.x,constraintConfig.pointB.y),constraint.endFill()}},PhysicsDebugView.prototype.getBodyColours=function(config){return config&&config.bodyColours?config.bodyColours:[27558,300799,16759874,14160217,9383254]},PhysicsDebugView.prototype.getBodyStaticColours=function(config){return config&&config.bodyStaticColours?config.bodyStaticColours:[3025732]},PhysicsDebugView.prototype.getSleepTint=function(isSleeping){return isSleeping?8947848:16777215},PhysicsDebugView.prototype.createBody=function(config){var bodyComponent=new framework.GraphicsView({rotation:-config.angle});bodyComponent.tint=this.getSleepTint(config.isSleeping),this.fillBodyParts(config.parts,config,bodyComponent);var body=new framework.ContainerView({position:config.position,rotation:config.angle,scale:framework.Vector.create(config.render.sprite.xScale,config.render.sprite.yScale)});return body.addChild(bodyComponent),body},PhysicsDebugView.prototype.createConstraint=function(config){return new framework.GraphicsView},PhysicsDebugView.prototype.fillBodyParts=function(partConfigs,bodyConfig,bodyComponent){var _this=this;bodyComponent&&partConfigs.filter(function(partConfig){return partConfigs.length<=1||partConfig!=bodyConfig}).forEach(function(partConfig){var colourArray=partConfig.isStatic?_this.bodyStaticColours:_this.bodyColours,bodyColour=colourArray.hasItems?colourArray.random():16711680;bodyComponent.beginFill(bodyColour,1),bodyComponent.lineStyle(2,65280,1);var linePos=Matter.Vector.sub(partConfig.vertices[0],bodyConfig.position);bodyComponent.moveTo(linePos.x,linePos.y);for(var i=1;i<partConfig.vertices.length;i++)linePos=Matter.Vector.sub(partConfig.vertices[i],bodyConfig.position),bodyComponent.lineTo(linePos.x,linePos.y);linePos=Matter.Vector.sub(partConfig.vertices[0],bodyConfig.position),bodyComponent.lineTo(linePos.x,linePos.y),bodyComponent.endFill(),bodyComponent.beginFill(0,0),bodyComponent.lineStyle(2,0),linePos=Matter.Vector.sub(partConfig.position,bodyConfig.position),bodyComponent.moveTo(linePos.x,linePos.y),linePos=Matter.Vector.create((partConfig.vertices[0].x+partConfig.vertices[partConfig.vertices.length-1].x)/2-bodyConfig.position.x,(partConfig.vertices[0].y+partConfig.vertices[partConfig.vertices.length-1].y)/2-bodyConfig.position.y),bodyComponent.lineTo(linePos.x,linePos.y),bodyComponent.endFill(),bodyComponent.beginFill(0,1),bodyComponent.lineStyle(0,0),bodyComponent.drawCircle(0,0,4),bodyComponent.endFill()})},PhysicsDebugView}(framework.View);framework.PhysicsDebugView=PhysicsDebugView}(framework||(framework={})),function(framework){function FixtureCircleData(){}framework.FixtureCircleData=FixtureCircleData;function BodyRenderTransform(){}framework.BodyRenderTransform=BodyRenderTransform;var PhysicsEditorUtils=function(){function PhysicsEditorUtils(){}return PhysicsEditorUtils.createBody=function(x,y,data,options,correctPosition){if(!data)return null;correctPosition=!isDefined(correctPosition)||correctPosition;var finalData=Object.clone(data);finalData=Object.extend(finalData,options);var parts=PhysicsEditorUtils.createPartsFromFixtures(finalData.fixtures);if(!parts.hasItems)return null;var body=Matter.Body.create({parts:parts});Matter.Body.set(body,finalData);var currentAnchor=Matter.Vector.create(body.position.x/finalData.transform.width,body.position.y/finalData.transform.height),translation=Matter.Vector.create(x,y);if(correctPosition){var rotatedPosition=Matter.Vector.rotate(body.position,body.angle);Matter.Body.setPosition(body,rotatedPosition),Matter.Body.translate(body,translation)}else Matter.Body.setPosition(body,translation);return body.render.sprite.xOffset=currentAnchor.x+finalData.transform.anchor.x,body.render.sprite.yOffset=currentAnchor.y+finalData.transform.anchor.y,body},PhysicsEditorUtils.createPartsFromFixtures=function(fixtures){var parts=[];return fixtures.forEach(function(fixtureData){if(fixtureData.circle){var circlePart=PhysicsEditorUtils.createCirclePart(fixtureData.circle,fixtureData);circlePart&&parts.push(circlePart)}else fixtureData.vertexLists&&fixtureData.vertexLists.map(function(vertexList){return PhysicsEditorUtils.createPolygonPart(vertexList,fixtureData)}).forEach(function(polygonPart){polygonPart&&parts.push(polygonPart)})}),parts},PhysicsEditorUtils.createCirclePart=function(circleData,fixtureData){return circleData?Matter.Bodies.circle(circleData.x,circleData.y,circleData.radius,fixtureData):null},PhysicsEditorUtils.createPolygonPart=function(vertexList,fixtureData){var centre=Matter.Vertices.centre(vertexList);return Matter.Bodies.fromVertices(centre.x,centre.y,[vertexList],fixtureData)},PhysicsEditorUtils}();framework.PhysicsEditorUtils=PhysicsEditorUtils}(framework||(framework={})),function(framework){function PhysicsEngineConfig(){}framework.PhysicsEngineConfig=PhysicsEngineConfig;var PhysicsEngine=function(){function PhysicsEngine(config){config=config||{},this.engine=Matter.Engine.create(config.engineOptions),this.targetFPS=config.targetFPS||45,this.updateInterval=1e3/this.targetFPS,this.maxUpdatesPerFrame=config.maxUpdatesPerFrame||5,this.sleepThreshold=isDefined(config.sleepThreshold)?config.sleepThreshold:.27,this.wakeThreshold=isDefined(config.wakeThreshold)?config.wakeThreshold:.27,this.queuedTime=0,this.fixSleepThresholds(),this.setCacheCollisionPairs(config.cacheCollisionPairs)}return PhysicsEngine.prototype.getEngine=function(){return this.engine},PhysicsEngine.prototype.getTargetFPS=function(){return this.targetFPS},PhysicsEngine.prototype.getUpdateInterval=function(){return this.updateInterval},PhysicsEngine.prototype.getMaxUpdatesPerFrame=function(){return this.maxUpdatesPerFrame},PhysicsEngine.prototype.getQueuedTime=function(){return this.queuedTime},PhysicsEngine.prototype.getSleepThreshold=function(){return this.sleepThreshold},PhysicsEngine.prototype.getWakeThreshold=function(){return this.wakeThreshold},PhysicsEngine.prototype.getCacheCollisionPairs=function(){return this.cacheCollisionPairs},PhysicsEngine.prototype.destroy=function(){this.engine&&(Matter.Engine.clear(this.engine),Matter.Composite.clear(this.engine.world,!1,!0),this.engine=null)},PhysicsEngine.prototype.update=function(frameTime){for(var numUpdates=this.getNumFixedUpdates(frameTime),i=0;i<numUpdates;i++)Matter.Engine.update(this.engine,this.updateInterval)},PhysicsEngine.prototype.setCacheCollisionPairs=function(shouldCache){this.cacheCollisionPairs=shouldCache,Matter.Pairs._pairMaxIdleLife=shouldCache?1e3:0},PhysicsEngine.prototype.getNumFixedUpdates=function(frameTime){var numUpdates=0;for(this.queuedTime+=1e3*frameTime;this.queuedTime>this.updateInterval&&numUpdates<this.maxUpdatesPerFrame;)this.queuedTime-=this.updateInterval,numUpdates++;return numUpdates},PhysicsEngine.prototype.fixSleepThresholds=function(){Matter.Sleeping._motionSleepThreshold=this.sleepThreshold,Matter.Sleeping._motionWakeThreshold=this.wakeThreshold},PhysicsEngine}();framework.PhysicsEngine=PhysicsEngine}(framework||(framework={})),function(){function StorageService(){}var p=StorageService.prototype;p.destroy=function(){},p.save=function(key,data){},p.load=function(key,loadedCallback){},namespace("framework.tpt").StorageService=StorageService}(),function(){function LocalStorageService(){StorageService.call(this),this._defaultKey="playerData"}var StorageService=include("framework.tpt.StorageService"),SavedData=include("springroll.SavedData"),p=(StorageService.prototype,extend(LocalStorageService,StorageService));p.destroy=function(){},p.save=function(key,data){key=key||this._defaultKey,SavedData.write(key,data)},p.load=function(key,loadedCallback){key=key||this._defaultKey;var loadedPlayerData=SavedData.read(key);loadedCallback&&loadedCallback(loadedPlayerData,null)},namespace("framework.tpt").LocalStorageService=LocalStorageService}(),function(){function TPTAnalyticsService(config){var finalConfig=Object.extend({container:null,startTime:this._getCurrentTime(),appVersion:"0.0.0",isSecondPlayer:!1,telemetryEventName:"telemetry_save",defaultDataEventName:"",enabled:!0},config);if(!finalConfig.container)throw"TPTAnalyticsService: container is null.";this._container=finalConfig.container,this._startTime=finalConfig.startTime,this._appVersion=finalConfig.appVersion,this._isSecondPlayer=finalConfig.isSecondPlayer,this._telemetryEventName=finalConfig.telemetryEventName,this._defaultDataEventName=finalConfig.defaultDataEventName,this._enabled=finalConfig.enabled}var p=TPTAnalyticsService.prototype;Object.defineProperty(p,"enabled",{set:function(enabled){this._enabled=enabled},get:function(){return this._enabled}}),p.send=function(eventName,eventData){if(!this._container)throw"TPTAnalyticsService: cannot send event '"+eventName+"', container is null.";if(this._enabled){var finalEventData=this._createEventData(eventName,eventData),telemetryEvent=this._createTelemetryEvent(eventName,finalEventData);this._container.send(this._telemetryEventName,telemetryEvent),console.log("SENT ANALYTICS EVENT:",this._telemetryEventName,telemetryEvent)}},p._getCurrentTime=function(){return(new Date).getTime()},p._getDeviceTimeStamp=function(){var date=new Date;return date.getMonth()+1+"/"+date.getDate()+"/"+date.getFullYear()+"/"+date.getHours()+"/"+date.getMinutes()+"/"+date.getSeconds()},p._getTimePlayed=function(){var timePlayedMs=this._getCurrentTime()-this._startTime;return parseInt(timePlayedMs/36e5)%24+"/"+parseInt(timePlayedMs/6e4)%60+"/"+parseInt(timePlayedMs/1e3)%60},p._createEventData=function(eventName,eventData){return Object.extend({event_name:eventName||this._defaultDataEventName,device_time_stamp:this._getDeviceTimeStamp(),time_played:this._getTimePlayed(),game_version:this._appVersion,session_id:"",task_id:"",attempt_num:"",pass_fail:"",mastery_up:"",as_mastery_p1:"",as_mastery_p2:"",rl_mastery:"",correct_selection:"",player_selection:""},eventData)},p._createTelemetryEvent=function(eventName,eventData){return{event_name:eventName||this._defaultDataEventName,event_data:JSON.stringify(eventData),is_second_player:this._isSecondPlayer}},namespace("framework.tpt").TPTAnalyticsService=TPTAnalyticsService}(),function(){function RTLStorageService(config){var finalConfig=Object.extend({container:null,maxLoadTimeout:3},config);if(!finalConfig.container)throw"RTLStorageService: container is null.";StorageService.call(this),this._container=finalConfig.container,this._maxLoadTimeout=1e3*finalConfig.maxLoadTimeout,this._localStorageService=new LocalStorageService,this._loadTimeout=null}var StorageService=include("framework.tpt.StorageService"),LocalStorageService=include("framework.tpt.LocalStorageService"),p=(StorageService.prototype,extend(RTLStorageService,StorageService));p.destroy=function(){this._destroyTimeout(),this._localStorageService&&(this._localStorageService.destroy(),this._localStorageService=null),this._container=null},p.save=function(key,data){this._container&&this._container.send("game_data_save",{game_data:JSON.stringify(data)}),this._localStorageService.save(key,data)},p.load=function(key,loadedCallback){loadedCallback=loadedCallback||function(data,errorData){},this._destroyTimeout();var delayTime=this._container?this._maxLoadTimeout:0;this._loadTimeout=setTimeout(function(){this._alternativeLoad(key,loadedCallback)}.bind(this),delayTime),this._container&&this._container.fetch("user_data",function(userData){if(this._loadTimeout){this._destroyTimeout();var playerData=this._extractPlayerData(userData),gameData=this._getPlayerGameData(playerData);loadedCallback(gameData,null)}}.bind(this),null,!0)},p._destroyTimeout=function(){this._loadTimeout&&(clearTimeout(this._loadTimeout),this._loadTimeout=null)},p._alternativeLoad=function(key,loadedCallback){this._loadTimeout=null,this._localStorageService.load(key,loadedCallback)},p._extractPlayerData=function(userData){return userData&&userData.data?userData.data.find(function(data){return data&&!data.is_second_player}):null},p._getPlayerGameData=function(playerData){var gameData=null;return this._playerHasSaveGame(playerData)&&(gameData=JSON.parse(playerData.game_data)),gameData},p._playerHasSaveGame=function(playerData){return playerData&&""!==playerData.game_data},namespace("framework.tpt").RTLStorageService=RTLStorageService}();