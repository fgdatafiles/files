!function(){var a=new springroll.ApplicationPlugin;a.setup=function(){this.shuffle=a.shuffle.bind(this),this.getObjectsWithPropValue=a.getObjectsWithPropValue.bind(this),this.getRandomInt=a.getRandomInt.bind(this),this.sign=a.sign.bind(this),this.randomSign=a.randomSign.bind(this),this.randFromArray=a.randFromArray.bind(this),this.cycleArray=a.cycleArray.bind(this),this.getScreenWidth=a.getScreenWidth.bind(this),this.getScreenHeight=a.getScreenHeight.bind(this),this.getScreenOffset=a.getScreenOffset.bind(this),this.rotatePoint=a.rotatePoint.bind(this),this.distance=a.distance.bind(this)},a.shuffle=function(a){var b,c,d=a.length;if(0!==d)for(;--d;)b=Math.floor(Math.random()*(d+1)),c=a[d],a[d]=a[b],a[b]=c},a.getObjectsWithPropValue=function(a,b,c){for(var d=[],e=0;e<a.length;e++)a[e].hasOwnProperty(b)&&a[e][b]===c&&d.push(a[e]);return d},a.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},a.randFromArray=function(a){return a[Math.floor(Math.random()*a.length)]},a.sign=function(a){return a=+a,0===a||isNaN(a)?a:a>0?1:-1},a.randomSign=function(){return Math.random()>=.5?1:-1},a.cycleArray=function(a){var b=a.shift();return a.push(b),b},a.getScreenWidth=function(){return app.display.width/app.scaling._scale},a.getScreenHeight=function(){return app.display.height/app.scaling._scale},a.getScreenOffset=function(){return{x:(app.config.scalingSize.maxWidth-this.getScreenWidth())/2,y:(app.config.scalingSize.maxHeight-this.getScreenHeight())/2}},a.rotatePoint=function(a,b){var c=Math.cos(b)*a.x-Math.sin(b)*a.y,d=Math.sin(b)*a.x+Math.cos(b)*a.y;a.x=c,a.y=d},a.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)},a.teardown=function(){}}(),this.createjs=this.createjs||{},function(){function a(){throw"ColorPlugin cannot be instantiated"}var b=function(a,b,c,d){switch(arguments.length){case 0:this.r=255,this.g=255,this.b=255,this.a=255;break;case 1:this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a;break;case 2:this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a,this.averageWith(b);break;case 3:this.r=a,this.g=b,this.b=c,this.a=255;break;case 4:this.r=a,this.g=b,this.b=c,this.a=d}};b.prototype.isWhite=function(){return 255===this.r&&255===this.g&&255===this.b&&255===this.a},b.prototype.hexPad=function(a){return a=Math.floor(a).toString(16),a.length>1?a.substring(0,2):"0"+a},b.prototype.averageWith=function(a){return this.r=(this.r+a.r)/2,this.g=(this.g+a.g)/2,this.b=(this.b+a.b)/2,this.a=(this.a+a.a)/2,this},b.prototype.toHexString=function(){var a="#";return a+=this.hexPad(this.r),a+=this.hexPad(this.g),a+=this.hexPad(this.b)},b.prototype.toRGBString=function(){var a="rgb(";return a+=Math.floor(this.r)+",",a+=Math.floor(this.g)+",",a+=Math.floor(this.b)+")"},b.prototype.toRGBAString=function(){var a="rgba(";return a+=Math.floor(this.r)+",",a+=Math.floor(this.g)+",",a+=Math.floor(this.b)+",",a+=Math.floor(this.a)+")"},b.prototype.fromHexString=function(a){return this.r=parseInt(a.substring(1,3),16),this.g=parseInt(a.substring(3,5),16),this.b=parseInt(a.substring(5),16),this},b.prototype.fromRGBString=function(a){var b=a.split(",");return this.r=parseInt(b[0].substring(4)),this.g=parseInt(b[1]),this.b=parseInt(b[2]),this},b.prototype.fromRGBAString=function(a){var b=a.split(",");return this.r=parseInt(b[0].substring(5)),this.g=parseInt(b[1]),this.b=parseInt(b[2]),this.a=parseInt(b[3]),this},b.prototype.fromString=function(a){return 0===a.indexOf("#")?this.fromHexString(a):0===a.indexOf("rgb(")?this.fromRGBString(a):0===a.indexOf("rgba(")&&this.fromRGBAString(a),this},b.prototype.lerp=function(a,b,c){return this.r=a.r*(1-c)+b.r*c,this.g=a.g*(1-c)+b.g*c,this.b=a.b*(1-c)+b.b*c,this.a=a.a*(1-c)+b.a*c,this},b.lerp=function(a,c,d){return new b(a.r*(1-d)+c.r*d,a.g*(1-d)+c.g*d,a.b*(1-d)+c.b*d,a.a*(1-d)+c.a*d)},namespace("PrimalScreen").Color=b,a.priority=1,a.color1=new b,a.color2=new b,a.lerpedColor=new b,a.install=function(){createjs.Tween.installPlugin(a,["color"])},a.init=function(a,b,c){return c},a.step=function(a,b,c,d,e){},a.tween=function(b,c,d,e,f,g,h,i){return a.lerpedColor.lerp(a.color1.fromString(e.color),a.color2.fromString(f.color),g).toHexString()},createjs.ColorPlugin=a}(),function(){var a=include("PrimalScreen.Color"),b=function(a,b,c,d,e,f){this.container=a,this.lifetime=b,this.velocity=c,this.angularVelocity=d,this.force=e,this.age=0,this.flip=f},c=b.prototype;c.update=function(a){if(this.age+=a,this.age>=this.lifetime)return!1;if(this.endFadeLength){var b=1-this.age/this.lifetime;b>this.endFadeLength&&(this.container.alpha=b/this.endFadeLength)}var c=.5*a*a;if(this.container.x+=this.velocity.x*a+this.force.x*c,this.container.y+=this.velocity.y*a+this.force.y*c,this.velocity.x+=this.force.x*a,this.velocity.y+=this.force.y*a,this.container.rotation+=this.angularVelocity*a,this.flip){var d=100*(Math.floor(5*Math.random())+2);createjs.Tween.get(this.container,{loop:!0}).to({scaleY:-1},d).to({scaleY:1},d)}return!0},c.destroy=function(){this.container.parent.removeChild(this.container),this.container=null,this.lifetime=null,this.velocity=null};var d=function(b,c,d){d=d||{},this.container=new createjs.Container,b.addChild(this.container),c?this.particleParent=c:this.particleParent=this.container,this.particleTexture=d.texture,this.particleTexture&&(this.particleTexture=Array.isArray(this.particleTexture)?this.particleTexture:[this.particleTexture]),this.particleGraphics=d.graphics,this.color1=new a(255,255,255,255),this.color2=new a(255,255,255,255),this.particles=[],this.particleSpawnTimer=0,this.emissionRate=.1,this.minLifetime=1,this.maxLifetime=1,this.minSize=1,this.maxSize=1,this.minVelocity=1,this.maxVelocity=1,this.constantForceX=0,this.constantForceY=0,this.minAngularVelocity=0,this.maxAngularVelocity=0,this.angularFlip=!1,this.parentFlip=!1,this.isPlaying=!1,this.timeScale=1,this.tickListener=app.on("update",this.update.bind(this))},e=d.prototype;e.play=function(){this.isPlaying=!0},e.stop=function(a){if(this.particleSpawnTimer=0,this.isPlaying=!1,a){for(var b=0;b<this.particles.length;b++)this.particles[b].destroy();this.particles=[]}},e.prewarm=function(){this.update(1e3*this.maxLifetime)},e.setSize=function(a,b){this.minSize=a,this.maxSize=b},e.setColor=function(a,b){this.color1.fromString(a),b?this.color2.fromString(b):this.color2.fromString(a)},e.setEndFade=function(a){a>0?this.endFadeLength=a:delete this.endFadeLength},e.setVelocity=function(a,b){this.minVelocity=a,this.maxVelocity=b},e.setConstantForce=function(a,b){this.constantForceX=a,this.constantForceY=b},e.setEmission=function(a,b,c){this.emissionRate=1/a,this.minLifetime=b,this.maxLifetime=c},e.setLineEmission=function(a){this.isArc=!1,this.isLine=!0,this.lineLength=a},e.setArcEmission=function(a,b,c,d){this.isArc=!0,this.isLine=!1,this.arcRadius=a,this.minAngle=b,this.maxAngle=c,this.emitFromEdge=d},e.setAngularVelocity=function(a,b,c){this.minAngularVelocity=a,this.maxAngularVelocity=b,this.angularFlip=c?!0:!1},e.setFlip=function(a){this.parentFlip=a},e.update=function(a){if(a/=1e3,a*=this.timeScale,null!==this.particles){for(var b=this.particles.length-1;b>=0;b--){var c=this.particles[b];c.update(a)||(c.destroy(),this.particles.splice(b,1))}if(this.isPlaying){var d=a-(this.emissionRate-this.particleSpawnTimer);for(this.particleSpawnTimer+=a;this.particleSpawnTimer>this.emissionRate;){this.particleSpawnTimer-=this.emissionRate;var e=this.createParticle();d>e.lifetime?e.destroy():(e.update(d),this.particles.push(e)),d-=this.emissionRate}}}},e.createParticle=function(){var c=a.lerp(new a(this.color1),new a(this.color2),Math.random()),d=this.minSize+Math.random()*(this.maxSize-this.minSize),e=this.minLifetime+Math.random()*(this.maxLifetime-this.minLifetime),f=this.minVelocity+Math.random()*(this.maxVelocity-this.minVelocity),g=this.minAngularVelocity+Math.random()*(this.maxAngularVelocity-this.minAngularVelocity);this.angularFlip&&Math.random()<.5&&(g*=-1);var h=this.parentFlip,i=null;if(this.particleTexture){var j=null;j=this.particleTexture.length>1?this.particleTexture[Math.floor(Math.random()*this.particleTexture.length)]:this.particleTexture[0],i=new createjs.Bitmap(j),i.scaleX=d,i.scaleY=d,i.regX=j.width/2,i.regY=j.height/2,c.isWhite()||(i.filters=[new createjs.ColorFilter(c.r/255,c.g/255,c.b/255,c.a/255,0,0,0,0)],i.cache(0,0,j.width,j.height))}else if(this.particleGraphics){if(i=new createjs.Shape(this.particleGraphics),i.scaleX=d,i.scaleY=d,c.isWhite()||(i.graphics._fill.style=c.toHexString()),i.graphics._activeInstructions.length){var k=i.graphics._activeInstructions[0];k.w&&i.cache(k.x,k.y,k.w,k.h)}}else i=new createjs.Shape,i.graphics.beginFill(c.toRGBAString()).drawCircle(0,0,d);var l=f,m=f,n=0;this.isArc?(n=this.minAngle+Math.random()*(this.maxAngle-this.minAngle),n*=3.1415/180,this.emitFromEdge&&(i.x+=Math.cos(n)*this.arcRadius,i.y+=Math.sin(n)*this.arcRadius)):this.isLine?(n=1.57075,i.x=-this.lineLength+2*Math.random()*this.lineLength):n=2*Math.random()*3.1415,l*=Math.cos(n),m*=Math.sin(n);var o=this.container.localToGlobal(i.x,i.y);this.particleParent.globalToLocal(o.x,o.y,o),this.particleParent.addChild(i),i.x=o.x,i.y=o.y,i.rotation=360*Math.random();var p=new b(i,e,{x:l,y:m},g,{x:this.constantForceX,y:this.constantForceY},h);return this.endFadeLength&&(p.endFadeLength=this.endFadeLength),p},e.destroy=function(){this.isPlaying=!1,app.off("update",this.tickListener);for(var a=0;a<this.particles.length;a++)this.particles[a].destroy();this.particles=null,this.particleTexture=null,this.color1=null,this.color2=null,this.container.parent&&this.container.parent.removeChild(this.container),this.container=null,this.eventFunction=null},namespace("PrimalScreen").ParticleSystem=d}(),function(){function a(a,b){return a.start-b.start}var b,c,d,e,f=include("createjs.Container"),g=function(g){if(d||(b=include("springroll.Debug",!1),d=include("springroll.Application"),e=include("springroll.Sound"),c=include("springroll.easeljs.BitmapUtils")),f.call(this),!g)throw"Need options to create Cutscene";var h=this._display=g.display;this.width=g.width,this.height=g.height,this._elapsedTime=0,this._audio=g.audio?g.audio.slice():[],this._audio.sort(a),this._audioIndex=0;var i=this._clip=g.clip;this._activeSyncAudio=[],this._soundStartTime=-1,this._activeAudio=[],this._audioFinished=!1,this._functionCalls=g.functions?g.functions:[],this._endCallback=null,this._parent=g.parent;var j=this._captions=g.captions;j&&(j.selfUpdate=!1),this.update=this.update.bind(this),this.resize=this.resize.bind(this),i.mouseEnabled=!1,i.tickEnabled=!1,i.gotoAndPlay(0),i.loop=!1,this.addChild(this._parent?this._parent:i),this.resize(h.width,h.height),d.instance.on("resize",this.resize)},h=extend(g,f);h.resize=function(a,b){if(this._clip){var c,d=this.width/this.height,e=a/b;d>e?(c=a/this.width,this.x=0,this.y=.5*(b-this.height*c)):(c=b/this.height,this.x=.5*(a-this.width*c),this.y=0),this._parent?this._parent.scaleX=this._parent.scaleY=c:this._clip.scaleX=this._clip.scaleY=c}},h.start=function(a){this._endCallback=a,this._elapsedTime=0,this._animFinished=!1,this._audioFinished=!this._audio.length;for(var b=0;b<this._audio.length;++b){var c=this._audio[b];if(0!==c.start)break;var f=c.alias,g={};if(c.sync){var h=e.instance.play(f,this._audioCallback.bind(this,g));try{this._activeSyncAudio.unshift(h),g.instance=h,h._audioData=c,this._soundStartTime=c.start,this._captions&&this._captions.play(f)}catch(i){}}else{var j=e.instance.play(f,this._audioCallback.bind(this,g));g.instance=j,this._activeAudio.push(j)}++this._audioIndex}d.instance.on("update",this.update)},h._audioCallback=function(a){var b=this._activeSyncAudio.indexOf(a.instance);if(-1!=b)if(0===b?this._activeSyncAudio.shift():this._activeSyncAudio.splice(b,1),this._activeSyncAudio.length<1)this._audioFinished=!0,this._soundStartTime=-1,this._captions&&this._captions.stop(),this._animFinished&&this.stop(!0);else try{var c=this._activeSyncAudio[0]._audioData;this._soundStartTime=c.start,this._captions&&this._captions.play(c.alias)}catch(d){}else b=this._activeAudio.indexOf(a.instance),-1!=b&&this._activeAudio.splice(b,1)},h.update=function(a){if(!this._animFinished){this._activeSyncAudio.length||(this._elapsedTime+=.001*a);for(var b=this._audioIndex;b<this._audio.length;++b){var c=this._audio[b];if(!(c.start<=this._elapsedTime))break;var d=c.alias,f={};if(c.sync){this._audioFinished=!1;var g=e.instance.play(d,this._audioCallback.bind(this,f));try{this._activeSyncAudio.unshift(g),f.instance=g,g._audioData=c,this._elapsedTime=this._soundStartTime=c.start,this._captions&&this._captions.play(d)}catch(h){}}else{var i=e.instance.play(d,{complete:this._audioCallback.bind(this,f),offset:1e3*(this._elapsedTime-c.start)});f.instance=i,this._activeAudio.push(i)}++this._audioIndex}for(var j=0;j<this._functionCalls.length;j++){var k=this._functionCalls[j];k.hasRun||k.time<=this._elapsedTime&&(k.hasRun=!0,k["function"]())}if(this._activeSyncAudio.length)try{var l=.001*this._activeSyncAudio[0].position;0===this._elapsedTime&&l>2*a||(this._elapsedTime=this._soundStartTime+l)}catch(h){}if(this._captions&&this._soundStartTime>=0&&this._captions.seek(this._activeSyncAudio[0].position),!this._animFinished){var m=this._clip.timeline&&1!=this._clip.timeline.duration?this._clip:this._clip.getChildAt(0);m.elapsedTime=this._elapsedTime,m.advance(),m.currentFrame==m.timeline.duration&&(this._animFinished=!0,this._audioFinished&&this.stop(!0))}}},h.stop=function(a){d.instance.off("update",this.update);var b;for(b=0;b<this._activeSyncAudio.length;++b)try{this._activeSyncAudio[b].stop()}catch(c){}for(b=0;b<this._activeAudio.length;++b)this._activeAudio[b].stop();this._activeAudio.length=this._activeSyncAudio.length=0,this._captions&&this._captions.stop(),a&&(this.dispatchEvent("complete"),this._endCallback&&(this._endCallback(),this._endCallback=null))},h.destroy=function(){this.stop(),this.dispatchEvent("destroy"),d.instance.off("resize",this.resize),this.removeAllChildren(!0),this._activeSyncAudio=this._activeAudio=this._audio=this._display=this._endCallback=this._clip=this._captions=null,this.parent&&this.parent.removeChild(this),this.removeAllEventListeners()},namespace("PrimalSpringroll").Cutscene=g}(),function(a){var b=include("springroll.Task"),c=include("PrimalSpringroll.Cutscene"),d=include("springroll.Application"),e=function(a){b.call(this,a,a.animClass);var c=d.instance;this.anim=a.anim,this.fps=a.fps||c.options.fps,this.animClass=a.animClass,this.width=a.width,this.height=a.height,this.audio=a.audio,this.images=a.images,this.libName=a.libName||"lib",this.imagesName=a.imagesName||"images",this.display="string"==typeof a.display?c.getDisplay(a.display):c.display},f=b.prototype,g=b.extend(e);e.test=function(a){return!!a.anim&&a.anim.search(/\.js$/i)>-1&&!!a.animClass&&a.width&&a.height},g.start=function(a){var b={_anim:{src:this.anim,libName:this.libName,images:this.images,imagesName:this.imagesName,type:"easeljs",format:"springroll.easeljs.FlashArt"}};if(this.audio){var e=[];this.audio.forEach(function(a){e.push(a.alias)}),b._audio={sounds:e}}var f=d.instance;f.load(b,function(b){var d=include(this.libName+"."+this.animClass),e=new d;e.framerate=this.fps;var g=new c({clip:e,width:this.width,height:this.height,display:this.display,captions:f.captions||null,audio:this.audio});g.addEventListener("destroy",function(){b._anim.destroy(),b._audio&&b._audio.destroy()}),a(g)}.bind(this))},g.destroy=function(){this.display=null,this.images=null,this.audio=null,f.destroy.call(this)},namespace("PrimalSpringroll").CutsceneTask=e}(window),function(){var a=include("createjs.MovieClip"),b=new springroll.ApplicationPlugin;b.setup=function(){a.prototype.gotoAndPlayThenStop=function(a,b){"function"!=typeof b&&(b=function(){}),this._unbindSegment(),this.gotoAndPlay(a);var c=this._getLabelIndex(a);0>c||this._playSegment(c,a,b,!1)},a.prototype.gotoAndLoop=function(a,b){"function"!=typeof b&&(b=function(){}),this._unbindSegment(),this.gotoAndPlay(a);var c=this._getLabelIndex(a);0>c||this._playSegment(c,a,b,!0)},a.prototype.stopLoop=function(){this._unbindSegment(),this.stop()},a.prototype._playSegment=function(a,b,c,d){"undefined"==typeof d&&(d=!1),this.extensionTickHandler=this.on("tick",function(e){if(this.currentLabel!==b||this.paused||this.currentFrame===this.timeline.duration&&this.loop===!1){if(d===!0)return this.gotoAndPlay(b),void c();var f=this.currentFrame;a<this.labels.length-1?(a++,f=this.labels[a].position-1):f=this.duration-1,this.gotoAndStop(f),this._unbindSegment(),c()}})},a.prototype._unbindSegment=function(){this.off("tick",this.extensionTickHandler)},a.prototype._getLabelIndex=function(a){for(var b=-1,c=0;c<this.labels.length;c++){var d=this.labels[c];if(d.label===a){b=c;break}}return b}},b.teardown=function(){}}(),function(){var a=include("createjs.Container"),b=function(){a.call(this),this.playBurstAnimation=this.playBurstAnimation.bind(this),this.playCollisionSound=this.playCollisionSound.bind(this),this.setup()},c=a.prototype,d=extend(b,a);d.setup=function(){this.id="building",this.listener=this.buildTick.bind(this),this.activityView=new lib_Building.Building,this.addChild(this.activityView),createjs.Ticker.framerate=60,this.physics=app.physicsInterface,this.physics.contactListener.BeginContact=this.onBeginContact.bind(this),this.buildingArray=[],this.selectionArray=[],this.currentBuildIndex=1,this.currentBuildObj=null,this.selectedShape=null,this.flingCounter=0,this.cleared=!1,this.clearing=!1,this.timeout=[],this.activityView.bucket.visible=!1,this.ground=this.activityView.ground.y+this.activityView.ground.nominalBounds.y,this.activityView.ground.alpha=0,this.container=this.activityView.container,this.containerPos=this.container.y,this.wavePos=this.activityView.wave.y,this.foamPos=this.activityView.foam.y,this.groundMask=this.activityView.groundMask,this.groundMask.visible=!1,this.usingTouch=app.hasTouch===!0?!0:!1,this.pointerPos={x:0,y:0},this.currentInteraction="none",this.flaggedForStatic=[],this.cloudSpeed=.2,this.tutorialPlaying=!1,this.activityView.wave.framerate=24,this.activityView.wave.stop(),this.activityView.foam.framerate=24,this.activityView.foam.stop(),this.activityView.outerSea.framerate=24,this.sandCollisionSounds=["sand1","sand2","sand3","sand4"],this.sandBurstSounds=["spin_castle_land1","spin_castle_land2","spin_castle_land3","spin_castle_land4"],this.sandMakeSounds=["spin_castle_make1","spin_castle_make2","spin_castle_make3","spin_castle_make4"],this.sandSoundPlaying=!1,this.mouseDownListener=app.display.stage.on("stagemousedown",this.onStageMouseDown,this),this.mouseMoveListener=app.display.stage.on("stagemousemove",this.onStageMouseMove,this)},d.playTutorial=function(){this.tutorialPlaying=!0,this.activityView.bucket.index=2,this.activityView.bucket.height=this.activityView.bucket.nominalBounds.height,this.activityView.bucket.width=this.activityView.bucket.nominalBounds.width,this.activityView.bucket.hitbox.visible=!1,this.activityView.bucket.parent.removeChild(this.activityView.bucket),this.container.addChild(this.activityView.bucket);var a=this.activityView.cursor.tutObj2;this.selectionArray[1].visible=!1,app.cursor.visible=!1;var b=this.activityView.cursor;b.framerate=24,b.gotoAndStop(0),a.gotoAndStop(1),a.hitbox.visible=!1,createjs.Tween.get(b).wait(1e3).call(function(){app.voPlayer.play(["spinmj-60-SALLY-01A","spinmj-61-SALLY-01F"]),app.animator.play(b,"move",function(){a.gotoAndStop(2),app.animator.play(b,"drop"),this.selectionArray[1].visible=!0}.bind(this))}.bind(this)).wait(4e3).call(function(){this.activityView.bucket.gotoAndStop(2),this.activityView.bucket.visible=!0,this.clearBuilding()}.bind(this)).wait(1e3).call(function(){app.voPlayer.play("spinmj-64-SALLY-01G"),app.cursor.x=this.activityView.clear.x,app.cursor.y=this.activityView.clear.y,this.addTimeouts(),this.startGame()}.bind(this))},d.initialize=function(a){this.physics.addNewBody(this.activityView.ground,{shape:"box",type:"static",friction:100});for(var b=0;4>b;b++){var c="buildObj"+(b+1),d=new lib_Building["Bucket"+(b+1)];d.gotoAndStop(1),d.index=b+1,d.x=this.activityView[c].x,d.y=this.activityView[c].y,d.hitArea=d.hitbox,d.hitbox.visible=!1,d.cache(-125,-125,275,250),d.selected=!1,d.name="bucket",this.activityView.addChild(d),this.selectionArray.push(d)}a?(this.startGame(),this.buildCastle(),createjs.Tween.get(this).wait(1e3).call(function(){app.voPlayer.play("spinmj-59-SALLY-01D",this.addTimeouts)}.bind(this))):this.playTutorial()},d.startGame=function(){this.tutorialPlaying=!1,app.cursor.visible=!0,this.activityView.cursor.visible=!1,this.currentBuildIndex=1,this.buildingArray=[],app.state.panel.makeDynamic(this.activityView.clear),this.activityView.clear.on("click",this.clearBuilding.bind(this));for(var a=0;4>a;a++){var b=this.selectionArray[a];app.state.panel.makeDynamic(b),b.on("mousedown",this.selectBuildObj,this,!1,b),b.on("pressup",this.releaseBuildObj,this,!1,b)}},d.onStageMouseDown=function(a){a.touches&&a.touches.length>1&&a.pointerID>0||"none"===this.currentInteraction&&(this.usingTouch===!1&&a.touches?this.usingTouch=!0:this.usingTouch!==!0||a.touches||(this.usingTouch=!1),this.pointerPos={x:a.stageX,y:a.stageY})},d.onStageMouseMove=function(a){a.touches&&a.touches.length>1&&a.pointerID>0||this.usingTouch===!1&&a.touches||(this.usingTouch!==!0||a.touches)&&(this.pointerPos={x:a.stageX,y:a.stageY})},d.addTimeouts=function(){this.timeout=["spinmj-62-SALLY-01D","spinmj-63-SALLY-01E","spinmj-69-NICK-01D","spinmj-70-NICK-01B","spinmj-70-NICK-01D","spinmj-71-NICK-01C","spinmj-71-NICK-01D","spinmj-72-NICK-01D","spinmj-73-NICK-01B"],app.shuffle(this.timeout),app.state.startTimeout(!0,!1)},d.clearBuilding=function(){if(!this.clearing){this.clearing=!0,this.activityView.cursor.tutObj2.visible=!1,this.disableBuckets();for(var a=0;a<this.buildingArray.length;a++){var b=this.buildingArray[a];if(b.mouseEnabled=!1,b.physics)try{this.physics.removeBody(b.physics)}catch(c){return null}}app.animator.play(this.activityView.wave,["waveEnter","waveExit"],function(){this.clearing=!1,this.enableBuckets()}.bind(this)),app.animator.play(this.activityView.foam,["waveEnter","waveExit"]),this.activityView.bucket.visible&&createjs.Tween.get(this.activityView.bucket).wait(1e3).to({y:850},2e3,createjs.Ease.cubicIn).call(function(){this.activityView.bucket.visible=!1}.bind(this)),createjs.Tween.get(this.container).wait(1e3).call(function(){this.tutorialPlaying===!1&&app.sound.play("sandcastle-wave"),this.groundMask.visible=!0}.bind(this)).to({y:850},2e3,createjs.Ease.sineIn).call(function(){this.cleared=!0}.bind(this)).wait(500).call(function(){this.groundMask.visible=!1}.bind(this)).set({y:this.containerPos})}},d.buildCastle=function(){for(var a=1;4>a;a++){var b="grid"+a,c=null;1==a?(c=new lib_Building.Bucket3,c.index=3):2==a?c=new lib_Building.Bucket1:3==a&&(c=new lib_Building.Bucket2),null!==c&&(c.x=this.activityView[b].x,c.y=this.activityView[b].y,c.gotoAndStop(0),this.addBuildObj(c))}},d.enableDrag=function(a,b){if("none"===this.currentInteraction&&!b.clickCarry&&null===this.selectedShape){this.currentInteraction="castle",this.usingTouch===!1&&a.touches?this.usingTouch=!0:this.usingTouch!==!0||a.touches||(this.usingTouch=!1);var c={x:this.pointerPos.x,y:this.pointerPos.y},d=this.activityView.globalToLocal(c.x,c.y);b.startPointX=d.x,b.startPointY=d.y,b.kinStartPointX=b.x,b.kinStartPointY=b.y,this.flingCounter=0,b.positionList=[],this.currentBuildObj=b,b.physics.SetType(box2d.b2BodyType.b2_kinematicBody)}},d.disableBuckets=function(){for(var a=0;a<this.selectionArray.length;a++)this.selectionArray[a].mouseEnabled=!1},d.enableBuckets=function(){for(var a=0;a<this.selectionArray.length;a++)this.selectionArray[a].mouseEnabled=!0},d.dropBuildObj=function(a,b){if("castle"===this.currentInteraction&&null!==this.currentBuildObj&&b===this.currentBuildObj&&(this.usingTouch!==!1||!a.touches)&&(this.usingTouch!==!0||a.touches)){var c=Math.abs(b.x-b.startPointX),d=Math.abs(b.y-b.startPointY);!(10>c||15>d)||b.clickCarry||app.hasTouch?(this.currentInteraction="none",b.flung=!0,this.adjustlayering(),this.currentBuildObj=null,b.clickCarry=!1,b.physics.SetType(box2d.b2BodyType.b2_dynamicBody),b.physics.SetPosition({x:b.x/40,y:b.y/40})):b.clickCarry=!0}},d.addBuildObj=function(a){a.tumble=!1,a["break"]=!1,a.flung=!1,a.positionList=[],a.clickCarry=!1,a.kinStartPointX=a.x,a.kinStartPointY=a.y,a.width=a.nominalBounds.width,a.height=a.nominalBounds.height,this.buildingArray.push(a),this.physics.addNewBody(a,{type:"dynamic",shape:"polygon",density:5,friction:100}),a.gotoAndStop(2),a.hitArea=a.hitbox,a.hitbox.visible=!1,a.cache(-125,-125,250,250),a.on("mousedown",this.enableDrag,this,!1,a),a.on("pressup",this.dropBuildObj,this,!1,a),app.state.panel.makeDynamic(a),this.container.addChild(a),this.adjustlayering()},d.flingBuildObj=function(a){var b={x:0,y:0};if(a.positionList.length>1)for(var c=0;c<a.positionList.length-1;c++){var d=a.positionList[c],e=a.positionList[c+1],f=e.x-d.x,g=e.y-d.y;b.x+=f,b.y+=g}var h=new box2d.b2Vec2(b.x/10,b.y/10);a.physics.SetLinearVelocity(h),a.flung=!1,app.sound.play("spin_castle_fling")},d.selectBuildObj=function(a,b){if("none"===this.currentInteraction&&!b.clickCarry&&null===this.currentBuildObj){this.currentInteraction="bucket",this.usingTouch===!1&&a.touches?this.usingTouch=!0:this.usingTouch!==!0||a.touches||(this.usingTouch=!1);var c={x:this.pointerPos.x,y:this.pointerPos.y},d=this.activityView.globalToLocal(c.x,c.y);b.startPointX=d.x,b.startPointY=d.y,b.selected=!0,this.currentBuildIndex=b.index,this.selectedShape=b,this.activityView.children.forEach(function(a,c){a===b&&(this.activityView.children.splice(c,1),this.activityView.children.push(a))}.bind(this))}},d.releaseBuildObj=function(a,b){if("bucket"===this.currentInteraction&&null!==this.selectedShape&&b===this.selectedShape&&(this.usingTouch!==!1||!a.touches)&&(this.usingTouch!==!0||a.touches)){var c=Math.abs(b.x-b.startPointX),d=Math.abs(b.y-b.startPointY),e=this.activityView.getObjectsUnderPoint(b.x,b.y),f=null;if(e.forEach(function(a,b){"bucket"===a.name&&b>0&&(f=a)}.bind(this)),!(10>c||15>d)||b.clickCarry||app.hasTouch){if(b.y-b.nominalBounds.y>this.ground+100||f);else{var g=new lib_Building["Bucket"+this.currentBuildIndex];g.gotoAndStop(0),g.framerate=24,g.x=b.x,g.y=b.y,g.index=this.currentBuildIndex,this.addBuildObj(g)}this.currentInteraction="none",b.selected=!1,b.x=this.activityView["buildObj"+b.index].x,b.y=this.activityView["buildObj"+b.index].y,this.selectedShape=null,null===this.selectedShape&&(b.clickCarry=!1)}else b.clickCarry=!0}},d.onBeginContact=function(a){var b=a.GetFixtureA().GetBody(),c=a.GetFixtureB().GetBody(),d=!1;b.view.currentFrame>2||c.view.currentFrame>2||((b.GetLinearVelocity().y>12||c.GetLinearVelocity().y>12||Math.abs(c.view.kinVelocityX)>25||Math.abs(c.view.kinVelocityY)>25)&&(b.view.name&&"ground"===b.view.name||this.playBurstAnimation(b.view),c.view.name&&"ground"===c.view.name||this.playBurstAnimation(c.view),d=!0),d||this.playCollisionSound())},d.playBurstAnimation=function(a){a["break"]||a.tumble||(a.uncache(),app.animator.play(a,{anim:"break",audio:app.randFromArray(this.sandBurstSounds)},function(){this.breakBuildObj(a)}.bind(this)),this.flaggedForStatic.push(a))},d.playCollisionSound=function(){this.audioDebounce||(this.audioDebounce=!0,createjs.Tween.get(this).wait(500).call(function(){this.audioDebounce=!1}.bind(this)),app.sound.play(app.randFromArray(this.sandCollisionSounds)))},d.breakBuildObj=function(a,b){a["break"]||(a.removeAllEventListeners(),a.mouseEnabled=!1,createjs.Tween.get(this).wait(b).call(function(){if(a==this.currentBuildObj&&(this.currentInteraction="none",this.currentBuildObj=null),a["break"]=!0,this.container.removeChild(a),!this.clearing)try{this.physics.removeBody(a.physics)}catch(b){return null}}.bind(this)))},d.setStatic=function(a){a.physics.SetType(box2d.b2BodyType.b2_staticBody),a.physics.m_fixtureList.m_isSensor=!0},d.adjustlayering=function(){var a=function(a,b){return a.y>b.y?1:-1};this.buildingArray.sort(a);for(var b=0;b<this.buildingArray.length;b++){var c=this.buildingArray[b];this.container.removeChild(c),this.container.addChild(c)}},d.buildTick=function(a){var b=0;for(b=0;b<this.activityView.clouds.children.length;b++)this.activityView.clouds.children[b].x-=this.cloudSpeed,this.activityView.clouds.children[b].x<-500&&(this.activityView.clouds.children[b].x=1536);if(this.cleared){for(var c=0;c<this.buildingArray.length;c++)this.breakBuildObj(this.buildingArray[c]);this.buildingArray=[],this.cleared=!1}if(!this.clearing){a/=1e3,this.flingCounter++;var d={x:this.pointerPos.x,y:this.pointerPos.y},e=this.activityView.globalToLocal(d.x,d.y),f=this.selectedShape;null!==f&&(f.x=e.x,f.y=e.y);var g=this.currentBuildObj;for(null!==g&&null===f&&(g.x=e.x,g.y=e.y,g.y-g.nominalBounds.y>this.ground&&(g.y=this.ground-10+g.nominalBounds.y),g.physics.SetPosition({x:g.x/40,y:g.y/40}),g.positionList.push({x:g.x,y:g.y}),g.positionList.length>5&&g.positionList.shift(),g.kinVelocityX=Math.abs(g.x-g.kinStartPointX),g.kinVelocityY=Math.abs(g.y-g.kinStartPointY),g.kinStartPointX=g.x,g.kinStartPointY=g.y),b=0;b<this.flaggedForStatic.length;b++)try{this.setStatic(this.flaggedForStatic[b])}catch(h){}for(this.flaggedForStatic=[],b=this.buildingArray.length-1;b>-1;b--){var i=this.buildingArray[b];i.flung&&this.flingBuildObj(i),i["break"]&&this.buildingArray.splice(b,1),Math.abs(i.rotation)>30&&!i.tumble&&(this.playBurstAnimation(i),i.tumble=!0)}}},d.kill=function(a){app.off("update",this.listener),this.physics.removeAllBodies(),this.physics=null,app.display.stage.off("stagemousedown",this.mouseDownListener),app.display.stage.off("stagemousemove",this.mouseMoveListener),this.activityView.clear.removeAllEventListeners();var b=0;for(b=0;b<this.buildingArray.length;b++){var c=this.buildingArray[b];c.removeAllEventListeners()}for(b=0;4>b;b++){var d=this.selectionArray[b];d.removeAllEventListeners()}},d.teardown=function(){c.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").BuildingActivity=b}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("createjs.Container"),b=function(){a.call(this),this.setup()},c=a.prototype,d=extend(b,a);d.setup=function(){this.listener=this.cheatTick.bind(this),this.activityView=new lib_Cheat.Cheat,this.addChild(this.activityView),this.currentGame=0},d.initialize=function(a){app.voPlayer.play("spin_gen_which");for(var b=1,c=1;9>c;c++){var d=this.activityView["result"+b];d.alpha=.05,d.index=b,d.on("mouseover",app.state.panel.highlight,this,!1,d),d.on("mouseout",app.state.panel.unhighlight,this,!1,d),d.on("click",this.getGame,this,!1,d),b++}},d.getGame=function(a,b){0===this.currentGame&&(this.currentGame=b.index)},d.cheatTick=function(a){var b=this.currentGame;0!==b&&(app.state.panel.lastGame=0,app.off("update",this.listener),app.state.hideWindow(),app.state.panel.lastGame=b,createjs.Tween.get(this).wait(1200).call(function(){app.state.showWindow("result"+b),this.currentGame=0}.bind(this)))},d.teardown=function(){c.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").CheatActivity=b}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("createjs.Container"),b=function(){a.call(this),this.setup()},c=a.prototype,d=extend(b,a);d.setup=function(){this.onResize=this.onResize.bind(this),this.id="coloring",this.activityView=new lib_Coloring.Coloring,this.addChild(this.activityView),app.on("resize",this.onResize),this.coloringWindow=this.activityView.coloringContainer,this.activityView._updateTimeline(),this.coloringWindow._updateTimeline(),this.coloringWindow.pages._updateTimeline(),this.lastPos={x:0,y:0},this.paintingWindowActive=!0,this.painting=!1,this.tutorial=!1,this.strokes=[],this.selectedStroke=!1,this.clicks=0,this.colorPaletteWrapper=this.coloringWindow.colorContainer,this.colorPaletteWrapper._updateTimeline(),this.colorPaletteWrapper.x=app.getScreenOffset().x,this.colorPalette=this.colorPaletteWrapper.colors,this.colorPalette._updateTimeline(),
this.toolPaletteWrapper=this.coloringWindow.toolContainer,this.toolPaletteWrapper._updateTimeline(),this.toolPaletteWrapper.x=1536-app.getScreenOffset().x,this.toolPalette=this.toolPaletteWrapper.tools,this.toolPalette._updateTimeline(),this.ctx=app.display.canvas.getContext("2d"),this.colorData=[{instanceName:"swatch_1",imageName:"color_green",pattern:null},{instanceName:"swatch_2",imageName:"color_purple",pattern:null},{instanceName:"swatch_3",imageName:"color_blue",pattern:null},{instanceName:"swatch_4",imageName:"color_stars",pattern:null},{instanceName:"swatch_5",imageName:"color_yellow",pattern:null},{instanceName:"swatch_6",imageName:"color_spots",pattern:null},{instanceName:"swatch_7",imageName:"color_orange",pattern:null},{instanceName:"swatch_8",imageName:"color_pink",pattern:null},{instanceName:"swatch_9",imageName:"color_red",pattern:null},{instanceName:"swatch_10",imageName:"color_stripes",pattern:null}],this.toolData=[{instanceName:"brushThin",toolType:"brushThin",width:5},{instanceName:"brushThick",toolType:"brushThick",width:30},{instanceName:"eraser",toolType:"eraser",width:30}],this.pageSelection=app.cycleArray(app.state.alternatePages),0===this.pageSelection?(this.coloringPg=app.cycleArray(app.state.coloringPages),this.page=this.coloringPg,this.timeout=["spinmj-80-NICK-01C","spinmj-81-NICK-01D","spinmj-82-NICK-01E","spinmj-83-NICK-01B","spinmj-84-NICK-01C","spinmj-85-NICK-01J","spinmj-86-NICK-01C"]):1===this.pageSelection&&(this.drawingPg=app.cycleArray(app.state.drawingPages),this.page=this.drawingPg,this.timeout=["spinmj-76-NICK-01D","spinmj-80-NICK-01C","spinmj-81-NICK-01D","spinmj-82-NICK-01E","spinmj-85-NICK-01J","spinmj-86-NICK-01C"])},d.playTutorial=function(){this.selectedStroke=!0,this.tutorial=!0;for(var a=this.colorPalette.swatch_8.localToGlobal(25,25),b=this.toolPalette.eraser.localToGlobal(0,0),c=this.coloringWindow.localToGlobal(725,350),d=this.coloringWindow.localToGlobal(925,500),e=0;e<this.swatchButtons.length;e++)this.swatchButtons[e].gotoAndStop(0);var f=!1,g={x:c.x,y:c.y};0===this.pageSelection?app.voPlayer.play("spinmj-77-NICK-01C"):1===this.pageSelection&&app.voPlayer.play("spinmj-75-NICK-01D"),createjs.Tween.get(app.tutorialCursor,{onChange:function(){f&&(this.colorCanvas.beginPath(),this.colorCanvas.moveTo(g.x,g.y),g=this.coloringWindow.coloringCanvas.globalToLocal(app.tutorialCursor.x,app.tutorialCursor.y),this.colorCanvas.lineTo(g.x,g.y),this.colorCanvas.stroke())}.bind(this)}).wait(1500).to({x:a.x,y:a.y},800).call(function(){app.voPlayer.play("spinmj-80-NICK-01C"),this.colorPalette.swatch_8.gotoAndStop(1),this.selectedSwatch=this.colorPalette.swatch_8,this.currentDrawingPattern=this.selectedSwatch.swatchData.pattern,this.colorCanvas.strokeStyle=this.currentDrawingPattern,app.sound.play("spin_color_dip1")}.bind(this)).wait(500).to({x:c.x,y:c.y},800).call(function(){g=this.coloringWindow.coloringCanvas.globalToLocal(app.tutorialCursor.x,app.tutorialCursor.y),f=!0}.bind(this)).to({x:d.x,y:d.y},800).call(function(){f=!1}.bind(this)).wait(500).to({x:b.x,y:b.y},800).call(function(){app.voPlayer.play("spinmj-78-NICK-01E"),this.colorPalette.swatch_8.gotoAndStop(0),this.toolPalette.brushThick.gotoAndStop(0),this.toolPalette.eraser.gotoAndStop(1),this.colorCanvas.strokeStyle="#ffffff",this.colorCanvas.lineWidth=50}.bind(this)).wait(500).to({x:c.x,y:c.y},800).call(function(){g=this.coloringWindow.coloringCanvas.globalToLocal(app.tutorialCursor.x,app.tutorialCursor.y),f=!0}.bind(this)).to({x:d.x,y:d.y},800).call(function(){f=!1}.bind(this)).wait(500).call(function(){createjs.Tween.removeTweens(app.tutorialCursor),app.cursor.x=app.tutorialCursor.x,app.cursor.y=app.tutorialCursor.y,app.tutorialCursor.visible=!1,app.cursor.visible=!0,this.startGame()}.bind(this))},d.initialize=function(a){this.coloringWindow.coloringCanvas.cacheCanvas&&this.coloringWindow.coloringCanvas.uncache();var b=this.coloringWindow.coloringCanvas.nominalBounds;this.coloringWindow.coloringCanvas.cache(0,0,b.width,b.height),this.colorCanvas=this.coloringWindow.coloringCanvas.cacheCanvas.getContext("2d"),this.colorCanvas.lineWidth=30,this.colorCanvas.globalCompositeOperation="source-atop",this.colorCanvas.lineCap="round",this.hitbox=this.coloringWindow.hitDetect,this.coloringWindow.pages.gotoAndStop(this.page),this.swatchButtons=[],this.selectedSwatch=null;var c=0;for(c=0;c<this.colorData.length;c++)if(curData=this.colorData[c],this.colorPalette[curData.instanceName]){var d=this.colorPalette[curData.instanceName];d.gotoAndStop(0);var e=new createjs.Bitmap(images[curData.imageName]);curData.pattern=this.ctx.createPattern(e.image,"repeat"),d.on("click",this.selectSwatch,this),d.swatchData=curData,this.swatchButtons.push(d),0===c&&(d.gotoAndStop(1),this.currentDrawingPattern=curData.pattern,this.colorCanvas.strokeStyle=this.currentDrawingPattern)}for(this.toolButtons=[],this.selectedTool=null,c=0;c<this.toolData.length;c++)if(curData=this.toolData[c],this.toolPalette[curData.instanceName]){var f=this.toolPalette[curData.instanceName];f.gotoAndStop(0),f.on("click",this.selectTool,this),f.toolData=curData,this.toolButtons.push(f)}a?createjs.Tween.get(this).wait(1e3).call(function(){0===this.pageSelection?app.voPlayer.play("spinmj-77-NICK-01C"):1===this.pageSelection&&app.voPlayer.play("spinmj-75-NICK-01D"),this.startGame()}.bind(this)):(app.cursor.visible=!1,app.tutorialCursor.visible=!0,app.tutorialCursor.scaleX=app.tutorialCursor.scaleY=app.scaling.scale,app.tutorialCursor.x=app.cursor.x,app.tutorialCursor.y=app.cursor.y,createjs.Tween.get(this).wait(1e3).call(function(){this.playTutorial()}.bind(this)))},d.startGame=function(){this.tutorial=!1,app.tutorialCursor.visible=!1,this.selectDefaultSwatch(),this.selectDefaultTool(),this.mouseDownListener=this.hitbox.on("mousedown",this.onMouseDown.bind(this)),this.mouseMoveListener=app.display.stage.on("stagemousemove",this.onMouseMove.bind(this)),this.mouseUpListener=this.hitbox.on("pressup",this.onMouseUp.bind(this)),this.mouseOutListener=this.hitbox.on("mouseout",this.onMouseOut.bind(this));for(var a=0;a<this.strokes.length;a++)this.strokes[a].on("click",this.selectStroke,this,!1,this.strokes[a]);app.shuffle(this.timeout),app.state.startTimeout()},d.selectTool=function(a){app.sound.play("spin_color_dip5");for(var b=a.currentTarget.toolData,c=0;c<this.toolButtons.length;c++)this.toolButtons[c].gotoAndStop(0);a.currentTarget.gotoAndStop(1),this.selectedStroke=!0,"eraser"===this.selectedTool&&this.selectedSwatch.gotoAndStop(1),this.selectedTool=b.toolType,"brushThin"===b.toolType?(this.colorCanvas.lineWidth=b.width,this.colorCanvas.strokeStyle=this.currentDrawingPattern):"brushThick"===b.toolType?(this.colorCanvas.lineWidth=b.width,this.colorCanvas.strokeStyle=this.currentDrawingPattern):"eraser"===b.toolType&&(this.colorCanvas.lineWidth=b.width,this.colorCanvas.strokeStyle="#ffffff",this.deselectSwatch()),this.painting=!1,this.clicks=0},d.selectDefaultTool=function(){for(var a=0;a<this.toolButtons.length;a++)this.toolButtons[a].gotoAndStop(0);var b=this.toolPalette.brushThick;b.gotoAndStop(1),this.colorCanvas.lineWidth=b.toolData.width,this.selectedStroke=!0,this.selectedTool=b.toolData.toolType},d.selectSwatch=function(a){if(!this.tutorial){var b=["spin_color_dip1","spin_color_dip2","spin_color_dip3","spin_color_dip4","spin_color_dip5"];app.sound.play(b[Math.floor(Math.random()*b.length)]);for(var c=0;c<this.swatchButtons.length;c++)this.swatchButtons[c].gotoAndStop(0);a.currentTarget.gotoAndStop(1),this.selectedSwatch=this.colorPalette[a.currentTarget.swatchData.instanceName],this.currentDrawingPattern=a.currentTarget.swatchData.pattern,this.colorCanvas.strokeStyle=this.currentDrawingPattern,"eraser"===this.selectedTool&&this.selectDefaultTool(),this.painting=!1,this.clicks=0}},d.deselectSwatch=function(){if(!this.tutorial)for(var a=0;a<this.swatchButtons.length;a++)this.swatchButtons[a].gotoAndStop(0)},d.selectDefaultSwatch=function(){for(var a=0;a<this.swatchButtons.length;a++)this.swatchButtons[a].gotoAndStop(0);this.swatchButtons[0].gotoAndStop(1),this.selectedSwatch=this.swatchButtons[0],this.currentDrawingPattern=this.swatchButtons[0].swatchData.pattern,this.colorCanvas.strokeStyle=this.currentDrawingPattern},d.eraseAll=function(){var a=this.colorCanvas,b=0,c={x:0,y:0},d={x:a.canvas.width,y:a.canvas.height},e=this.currentDrawingPattern,f=a.lineWidth;app.setInterval(function(g){b+=.0195;var h={x:c.x+b*(d.x-c.x),y:c.y+b*(d.y-c.y)};a.lineWidth=50,a.strokeStyle="#ffffff",a.moveTo(h.x-a.canvas.width,h.y+a.canvas.height),a.lineTo(h.x+a.canvas.width,h.y-a.canvas.height),a.stroke(),b>=1&&(g.destroy(),a.strokeStyle=e,a.lineWidth=f)},15)},d.startPaint=function(a){this.coloringWindow.coloringCanvas.globalToLocal(a.x,a.y,a),this.lastX=a.x,this.lastY=a.y,this.paintAmount=0},d.paint=function(a){if(this.coloringWindow.coloringCanvas.globalToLocal(a.x,a.y,a),this.currentDrawingPattern&&this.selectedStroke){var b=a.x-this.lastX,c=a.y-this.lastY,d=Math.sqrt(b*b+c*c);this.paintAmount+=d,this.colorCanvas.beginPath(),this.colorCanvas.moveTo(this.lastX,this.lastY),this.colorCanvas.lineTo(a.x,a.y),this.colorCanvas.stroke(),this.lastX=a.x,this.lastY=a.y}},d.onMouseDown=function(a){this.lastPos={x:a.stageX,y:a.stageY},this.paintingWindowActive===!0&&(this.startPaint(this.lastPos),this.painting=!0),this.originalPos=this.lastPos},d.onMouseMove=function(a){this.lastPos={x:a.stageX,y:a.stageY},this.painting&&this.paint(this.lastPos)},d.onMouseUp=function(a){this.clicks++,this.lastPos={x:a.stageX,y:a.stageY},this.checktoClickStick()||(this.painting=!1),2===this.clicks&&(this.painting=!1,this.clicks=0)},d.onMouseOut=function(a){this.painting=!1,this.clicks=0},d.checktoClickStick=function(){var a=20,b={x:app.display.stage.mouseX,y:app.display.stage.mouseY};this.coloringWindow.coloringCanvas.globalToLocal(b.x,b.y,b);var c=app.distance(b,this.originalPos);return a>c?!0:!1},d.onResize=function(a){this.colorPaletteWrapper.x=app.getScreenOffset().x,this.toolPaletteWrapper.x=1536-app.getScreenOffset().x},d.kill=function(a){app.tutorialCursor.visible=!1,this.paintingWindowActive=!1,app.colorMaskLeft.visible=!1,app.colorMaskRight.visible=!1,app.off("resize",this.onResize)},d.teardown=function(){c.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").ColoringActivity=b}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("springroll.easeljs.BasePanel"),b=include("createjs.Container");Captions=include("springroll.Captions");var c=function(){a.call(this),this.cycleCharacterAnimation=this.cycleCharacterAnimation.bind(this)},d=a.prototype,e=extend(c,a);e.setup=function(){this.state=app.states.game,this.skin=new lib_Game.Game,this.skin._updateTimeline(),this.addChild(this.skin),this.hose=this.skin.hose,this.hose.framerate=24,this.hose.gotoAndStop(0),this.lights=this.skin.lights,this.lights.framerate=24,this.lights.gotoAndStop(0),this.pump=this.skin.pump,this.pump.framerate=24,this.pump.gotoAndStop(0),this.platform=this.skin.platform,this.hitbox=this.skin.hitbox,this.arrownail=this.skin.arrownail,this.arrow=this.skin.arrow,this.arrow.framerate=24,this.arrow.gotoAndStop(0),this.makeDynamic(this.arrow),this.spinner=this.skin.spinner,this.pieces=[];for(var a=1;9>a;a++){var c=this.spinner["result"+a];app.animator.play(c,"default"),c.name="result"+a,c.index=a,this.pieces.push(c)}this.spinner._updateTimeline(),this.angles=[0,-45,-90,-138,-180,-225,-270,-320],this.playedGames=[],this.games=[1,2,3,4,5,6,7,8],this.weight=[5,5,5,5,5,5,5,5],this.lastGame=0,this.wandGameCount=0,this.window=this.skin.window,this.currentContainer=new b,app.backB.visible=!1,this.windowHiddenY=-450,this.windowVisibleY=380,this.window.y=this.windowHiddenY,this.sally=this.skin.Sally,this.nick=this.skin.Nick,this.sally.framerate=24,this.nick.framerate=24,this.lastCharacterWithSpecialIdle="",createjs.Tween.get(this.sally).wait(500).call(function(){app.animator.play(this.sally,"idle_01",this.cycleCharacterAnimation)}.bind(this)),app.animator.play(this.nick,"idle_01",this.cycleCharacterAnimation),this.isPlayingAltIdle=!1,this.spinPrompts=["spinmj-03-CAT-01","spinmj-04-CAT-01","spinmj-05-CAT-01"],this.spinner.on("click",function(){this.removeArrowEvents()}.bind(this)),this.arrownail.on("click",function(){this.removeArrowEvents()}.bind(this)),this.hitbox.on("click",function(){this.removeArrowEvents()}.bind(this)),this.pump.on("click",function(){this.removeArrowEvents()}.bind(this)),this.sally.on("click",function(){this.removeArrowEvents()}.bind(this)),this.nick.on("click",function(){this.removeArrowEvents()}.bind(this))},e.addArrowEvents=function(){createjs.Tween.get(this.arrow).wait(1e4).call(function(){this.jiggleArrow(),this.pulseArrow()}.bind(this))},e.removeArrowEvents=function(){createjs.Tween.removeTweens(this.arrow),createjs.Tween.removeTweens(this.arrownail),this.arrow.removeAllEventListeners()},e.cycleCharacterAnimation=function(a){var b=this.sally.paused===!0?this.sally:this.nick;if(this.isPlayingAltIdle===!1&&b.name!==this.lastCharacterWithSpecialIdle){this.lastCharacterWithSpecialIdle=b.name;var c=Math.random()>.5?"idle_02":"idle_03";this.isPlayingAltIdle=!0,app.animator.play(b,c,function(){this.cycleCharacterAnimation(!0)}.bind(this))}else app.animator.play(b,"idle_01",this.cycleCharacterAnimation);a&&(this.isPlayingAltIdle=!1)},e.makeDynamic=function(a,b){b=b||.15,a.originalScaleX=a.scaleX,a.originalScaleY=a.scaleY,a.on("mouseover",function(){createjs.Tween.get(a).to({scaleX:a.scaleX*(1+b),scaleY:a.scaleY*(1+b)},100,createjs.Ease.sineOut)}.bind(this)),a.on("mouseout",function(){createjs.Tween.get(a).to({scaleX:a.originalScaleX,scaleY:a.originalScaleY},100,createjs.Ease.sineOut)}.bind(this)),a.on("mousedown",function(){createjs.Tween.get(a).to({scaleX:a.originalScaleX*(1-b),scaleY:a.originalScaleY*(1-b)},100,createjs.Ease.sineOut)}.bind(this)),a.on("pressup",function(){createjs.Tween.get(a).to({scaleX:a.originalScaleX*(1+b),scaleY:a.originalScaleY*(1+b)},100,createjs.Ease.backOut)}.bind(this))},e.jiggleArrow=function(){var a=this.arrow.rotation;createjs.Tween.get(this.arrow).to({rotation:a},300,createjs.Ease.backIn).to({rotation:a+20},200,createjs.Ease.backIn).to({rotation:a-20},200,createjs.Ease.backIn).to({rotation:a},300,createjs.Ease.backIn).wait(1e3).call(function(){this.jiggleArrow()}.bind(this))},e.pulseArrow=function(){this.spinPrompts.push(this.spinPrompts.shift()),app.voPlayer.playing||app.voPlayer.play(this.spinPrompts[0]);var a=.95;createjs.Tween.get(this.arrow).call(function(){}.bind(this)).to({scaleX:a+.2,scaleY:a+.2},200,createjs.Ease.backIn).to({scaleX:a-.2,scaleY:a-.2},300,createjs.Ease.backIn).to({scaleX:a,scaleY:a},200,createjs.Ease.backIn).wait(7e3).call(function(){this.pulseArrow()}.bind(this))},e.pulseDoneButton=function(a){var b=2;2===a.scaleX?createjs.Tween.get(a).to({scaleX:1,scaleY:1},300,createjs.Ease.backIn).to({scaleX:b+.2,scaleY:b+.2},200,createjs.Ease.backIn).to({scaleX:b-.2,scaleY:b-.2},300,createjs.Ease.backIn).to({scaleX:b,scaleY:b},200,createjs.Ease.backIn).wait(5e3).call(function(){this.pulseDoneButton(a)}.bind(this)):createjs.Tween.get(a).to({scaleX:b+.2,scaleY:b+.2},200,createjs.Ease.backIn).to({scaleX:b-.2,scaleY:b-.2},300,createjs.Ease.backIn).to({scaleX:b,scaleY:b},200,createjs.Ease.backIn).wait(5e3).call(function(){this.pulseDoneButton(a)}.bind(this))},e.clickDoneButton=function(a){app.sound.play("xylo4");var b=2;createjs.Tween.get(a).to({scaleX:b+.2,scaleY:b+.2},200,createjs.Ease.backIn).to({scaleX:b-.2,scaleY:b-.2},300,createjs.Ease.backIn)},e.teardown=function(){d.teardown.call(this),this.skin=null},namespace("CatSpinnerGame").GamePanel=c}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("springroll.easeljs.BasePanel"),b=include("PrimalSpringroll.Cutscene"),c=function(){a.call(this)},d=a.prototype,e=extend(c,a);e.setup=function(){this.cutscene=new lib.Intro,this.cutscene.framerate=24,this.cutscene._updateTimeline(),this.cutsceneObject=new b({clip:this.cutscene,additionalClips:[],display:app.display,audio:[],functions:[]}),this.addChild(this.cutsceneObject)},e.teardown=function(){d.teardown.call(this),this.cutsceneObject=null,this.cutscene=null},namespace("CatSpinnerGame").IntroPanel=c}(),function(){var a=include("PrimalScreen.ParticleSystem"),b=include("createjs.Container"),c=function(){b.call(this),this.setup()},d=b.prototype,e=extend(c,b);e.setup=function(){this.listener=this.popTick.bind(this),this.activityView=new lib_Popping.Popping,this.activityView.cursor.gotoAndStop(0),this.addChild(this.activityView),this.activityStarted=!1,this.spawningPopObjects=!1,this.timeSinceLastSpawn=0,this.spawnInterval=60,this.totalSpawned=0,this.numberToSpawn=20,this.maxObjectsOnScreen=5,this.rubberPlayed=!1,this.waterPlayed=!1,this.sandPlayed=!1,this.popCount=0,this.popObjectList=[],this.balloonMaterials=[{materialType:"rubber",constructor:"Balloon_Rubber"},{materialType:"glitter",constructor:"Balloon_Glitter"},{materialType:"sand",constructor:"Balloon_Sand"},{materialType:"water",constructor:"Balloon_Water"}],this.popping=!1,this.timeout=[]},e.initialize=function(a){this.activityView.popObj.visible=!1,this.activityView.popBox.text="",a?(this.activityView.cursor.visible=!1,app.cursor.visible=!0,createjs.Tween.get(this).wait(1e3).call(function(){this.startGame(a)}.bind(this))):this.playTutorial()},e.playTutorial=function(){app.voPlayer.play(["spinmj-87-SALLY-01D","spinmj-89-SALLY-01C"]),this.activityView.popObj.visible=!0,app.cursor.visible=!1,this.activityView.cursor.framerate=24,app.animator.play(this.activityView.popObj,"balloon"),createjs.Tween.get(this.activityView.cursor).wait(1200).call(function(){app.animator.play(this.activityView.cursor,"move",function(){app.animator.play(this.activityView.popObj,{anim:"balloonPop",audio:"spin_baloon_air1"})}.bind(this))}.bind(this)).wait(2500).call(function(){app.cursor.x=this.activityView.cursor.x,app.cursor.y=this.activityView.cursor.y,this.activityView.popObj.visible=!1,this.startGame()}.bind(this))},e.startGame=function(a){this.activityView.cursor.visible=!1,app.cursor.visible=!0,this.popping=!0,a&&app.voPlayer.play("spinmj-88-SALLY-01B"),this.rubberPlayed=!1,this.waterPlayed=!1,this.sandPlayed=!1,this.glitterPlayed=!1,this.spawningPopObjects=!0,this.activityStarted=!0},e.generateConfetti=function(c){var d=new b;c.addChild(d),d.x+=50,d.y+=50,d.flip=!0,c.particles=new a(d,this.activityView,{texture:[images.Confetti_Yellow1,images.Confetti_Yellow2,images.Confetti_Yellow3,images.Confetti_Pink1,images.Confetti_Pink2,images.Confetti_Pink3]}),c.particles.setEmission(200,1,2),c.particles.setArcEmission(20,-30,210,!0),c.particles.setSize(.4,.6),c.particles.setVelocity(50,0),c.particles.setConstantForce(0,200),c.particles.setFlip(!0)},e.generateSparkle=function(c){var d=new b;c.addChild(d),d.rotation=90,d.x-=150,d.y-=50,c.particles=new a(d,this.activityView,{texture:[images.star_particle,images.star_particle_2,images.star_particle_3]}),c.particles.setEmission(300,.3,.4),c.particles.setLineEmission(150),c.particles.setSize(.3,.5),c.particles.setVelocity(0,200),c.particles.setConstantForce(0,200),createjs.Tween.get(this).wait(100).call(function(){c.particles.play()}.bind(this))},e.generatePop=function(){var a=this.spawnPoppable();this.setBalloonProperties(a),a.on("mousedown",this.popOnClick,this,!1,a),this.popObjectList.push(a),this.activityView.addChild(a)},e.spawnPoppable=function(){var a,b=Math.floor(Math.random()*this.balloonMaterials.length),c=this.balloonMaterials[b];a=new lib_Popping[c.constructor],a.materialType=c.materialType,app.animator.play(a,"Float"),a.framerate=24;var d=Math.random()*(1-.8)+.8;return a.scaleX=a.scaleX*d,a.scaleY=a.scaleY*d,a.hitbox&&(a.hitArea=a.hitbox,a.hitbox.visible=!1),a.width=a.nominalBounds.width*d,a.height=a.nominalBounds.height*d,a.popped=!1,a.velocity={x:0,y:0},a.acceleration={x:0,y:0},a.velBehavior={type:"none"},a.collisionBehavior={top:"reverse",bottom:"reverse",left:"reverse",right:"reverse"},a},e.setPoppablePosition=function(a,b){b=b||"random";var c={width:app.display.width,height:app.display.height},d=this.activityView.localToGlobal(0,0),e=0,f=c.width-a.width,g=d.y+20,h=c.height-2*a.height+d.y,i={x:Math.floor(Math.random()*(f-e)+e),y:g};"top"===b?i.y=g:"bottom"===b?i.y=h:i.y=Math.floor(Math.random()*(h-g)+g);var j=this.activityView.globalToLocal(i.x,i.y);a.x=j.x,a.y=j.y},e.setBalloonProperties=function(a){"rubber"===a.materialType?(this.setPoppablePosition(a,"bottom"),a.velocity.x=(.5*Math.random()+.5)*app.randomSign(),a.acceleration.y=-.01,a.collisionBehavior.top="offscreen",a.audio=["spin_baloon_air1","spin_baloon_air2","spin_baloon_air3"]):"glitter"===a.materialType?(this.setPoppablePosition(a,"top"),a.velocity.x=(.5*Math.random()+.1)*app.randomSign(),a.acceleration.y=.005,a.collisionBehavior.bottom="offscreen",a.audio=["spin_baloon_air1","spin_baloon_air2","spin_baloon_air3"],this.generateConfetti(a)):"sand"===a.materialType?(this.setPoppablePosition(a,"top"),a.acceleration.y=.02,a.collisionBehavior.bottom="offscreen",a.audio=["spin_baloon_sand1","spin_baloon_sand2","spin_baloon_sand3"]):"water"===a.materialType&&(this.setPoppablePosition(a,"top"),a.acceleration.y=.02,a.collisionBehavior.bottom="offscreen",a.audio=["spin_baloon_water1","spin_baloon_water2","spin_baloon_water3"])},e.popOnCollide=function(a){if(!a.popped){a.popped=!0;var b=Math.floor(Math.random()*a.audio.length);app.sound.play(a.audio[b]),app.animator.play(a,{anim:"Pop"}),createjs.Tween.get(a).wait(100).call(function(){a.particles&&a.particles.stop()}.bind(this)).wait(1e3).call(function(){var b=this.popObjectList.indexOf(a);this.popObjectList.splice(b,1),this.activityView.removeChild(a)}.bind(this))}},e.removeWithoutPop=function(a){if(!a.popped){a.popped=!0,a.particles&&(a.particles.destroy(),a.particles.stop());var b=this.popObjectList.indexOf(a);this.popObjectList.splice(b,1),this.activityView.removeChild(a)}},e.popOnClick=function(a,b){this.popOnCollide(b),!app.voPlayer.playing&&Math.random()<.2&&("rubber"!=b.materialType||this.rubberPlayed?"water"!=b.materialType||this.waterPlayed?"sand"!=b.materialType||this.sandPlayed?"glitter"!=b.materialType||this.glitterPlayed||(app.voPlayer.play(["spinmj-100-SALLY-01A",5e3]),this.glitterPlayed=!0):(app.voPlayer.play(["spinmj-91-SALLY-01C",5e3]),this.sandPlayed=!0):(app.voPlayer.play(["spinmj-90-SALLY-01E",5e3]),this.waterPlayed=!0):(app.voPlayer.play(["spinmj-92-SALLY-01D",5e3]),this.rubberPlayed=!0)),"glitter"==b.materialType&&b.particles.play(),this.popCount++,b.removeAllEventListeners()},e.clearPopList=function(){for(var a=0;a<this.popObjectList.length;a++)this.popObjectList[a].particles&&(this.popObjectList[a].particles.destroy(),this.popObjectList[a].particles.stop()),this.activityView.removeChild(this.popObjectList[a]);this.popObjectList=[]},e.popTick=function(a){if(!app.state.windowTransitioning){a>100&&(a=100),a/=1e3,a/=1/app.options.fps;for(var b=15,c={width:app.display.width,height:app.display.height},d={x:app.display.stage.mouseX,y:app.display.stage.mouseY},e=(this.activityView.globalToLocal(d.x,d.y),0);e<this.popObjectList.length;e++){var f=this.popObjectList[e];if(f.popped!==!0){var g=this.activityView.localToGlobal(f.x,f.y),h=f.collisionBehavior,i=this.activityView.localToGlobal(0,0),j=2*b,k=c.width-f.width,l=i.y+20,m=c.height-2*f.height+i.y;g.y<l-2*f.height&&"offscreen"===h.top?this.removeWithoutPop(f):g.y<l&&"offscreen"!==h.top?(f.y=this.activityView.globalToLocal(j,l).y,"reverse"===h.top?f.velocity.y=-f.velocity.y:"bounce"===h.top?f.velocity.y=.75*-f.velocity.y:"pop"===h.top&&this.popOnCollide(f)):g.y>m+2*f.height&&"offscreen"===h.bottom?this.removeWithoutPop(f):g.y>m&&"offscreen"!==h.bottom&&("popOnObject"!==h.bottom&&(f.y=this.activityView.globalToLocal(k,m).y),"reverse"===h.bottom?f.velocity.y=-f.velocity.y:"bounce"===h.bottom?f.velocity.y=.75*-f.velocity.y:"pop"===h.bottom?this.popOnCollide(f):"popOnObject"===h.bottom&&this.removeWithoutPop(f)),g.x<j?(f.x=this.activityView.globalToLocal(j,l).x,g.x=j,"reverse"===h.left?f.velocity.x=-f.velocity.x:"bounce"===h.left?f.velocity.x=.75*-f.velocity.x:"pop"===h.left&&this.popOnCollide(f)):g.x>k&&(f.x=this.activityView.globalToLocal(k,m).x,"reverse"===h.right?f.velocity.x=-f.velocity.x:"bounce"===h.right?f.velocity.x=.75*-f.velocity.x:"pop"===h.right&&this.popOnCollide(f)),"oscillate"===f.velBehavior.type&&(f.velBehavior.behaviorDir+=f.velBehavior.rate,f.velocity.x=Math.sin(f.velBehavior.behaviorDir)*f.velBehavior.maxSpeed),f.velocity.x+=f.acceleration.x*a,f.velocity.y+=f.acceleration.y*a,f.x+=f.velocity.x*a,f.y+=f.velocity.y*a}}this.spawningPopObjects===!0?(this.timeSinceLastSpawn+=a,this.timeSinceLastSpawn>=this.spawnInterval&&this.popObjectList.length<this.maxObjectsOnScreen&&(this.timeSinceLastSpawn=0,this.totalSpawned++,this.generatePop()),this.totalSpawned>=this.numberToSpawn&&(this.spawningPopObjects=!1)):this.activityStarted&&this.spawningPopObjects===!1&&0===this.popObjectList.length&&(app.off("update",this.listener),createjs.Tween.get(this).wait(500).call(function(){this.endPop()}.bind(this)))}},e.endPop=function(){app.sound.play("fanfare"),this.activityView.popBox.text=this.popCount,createjs.Tween.get(this.activityView.popSparkle).to({scaleX:0},600),this.generateSparkle(this.activityView.popSparkle),createjs.Tween.get(this.activityView).wait(600).call(function(){this.activityView.popSparkle.particles.setEmission(100,2,2)}.bind(this)).wait(100).call(function(){this.activityView.popSparkle.particles.stop()}.bind(this)),this.clearPopList(),createjs.Tween.get(this.activityView).wait(4e3).call(function(){app.state.hideWindow()}.bind(this))},e.kill=function(a){this.popping&&this.clearPopList(),this.popping=!1,app.off("update",this.listener)},e.teardown=function(){d.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").PopActivity=c}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("createjs.Container"),b=function(){a.call(this),this.onDoneButtonClicked=this.onDoneButtonClicked.bind(this),this.setup()},c=a.prototype,d=extend(b,a);d.setup=function(){this.id="quizzes",this.activityView=new lib_Quizzes.Quizzes,this.addChild(this.activityView),this.answered=!1,this.data=app.cycleArray(app.config.assets.quizzes),this.quizName=this.data[1],this.timeout=[],this.activityView.nextB.scaleX=0},d.initialize=function(){this.answered=!1,this.populateQuiz(),app.state.panel.makeDynamic(this.activityView.nextB),this.activityView.nextB.on("click",this.onDoneButtonClicked)},d.populateQuiz=function(){app.animator.play(this.activityView,"answers_"+(this.data.length-2)),this.activityView.bg.gotoAndStop(this.quizName),this.timeout.push([this.data[0],"spinmj-140-SALLY-01D"]);for(var a=2;a<this.data.length;a++){var b=this.activityView["spawn"+(a-1)];b.audio=this.data[0]+"_"+(a-1),app.state.previous=[],app.state.previous.push(b),b.addChild(new lib_Quizzes[this.data[a]]),b.answerName=this.data[a],app.state.panel.makeDynamic(b),b.on("mouseover",this.playAnswer,this,!1,b),b.on("click",this.answerQuiz,this,!1,b)}createjs.Tween.get(this).wait(1e3).call(function(){app.voPlayer.play([this.data[0],"spinmj-140-SALLY-01D"],function(){app.state.startTimeout()}.bind(this))}.bind(this))},d.answerQuiz=function(a,b){var c=Math.floor(3*Math.random())+1,d="xylo"+c,e=["spinmj-278-NICK-01C","spinmj-279-SALLY-03E","spinmj-279-SALLY-04C"],f=Math.floor(Math.random()*e.length);createjs.Tween.get(this).call(function(){app.state.stopTimeout(),app.sound.play(d),this.answered=!0}.bind(this)).wait(2500).call(function(){app.voPlayer.playing||app.voPlayer.play([e[f]],function(){}.bind(this))}.bind(this)),createjs.Tween.removeTweens(this.activityView.nextB),app.state.panel.pulseDoneButton(this.activityView.nextB)},d.playAnswer=function(a,b){app.voPlayer.playing||app.voPlayer.play(b.audio)},d.onDoneButtonClicked=function(){createjs.Tween.removeTweens(this.activityView.nextB),app.state.panel.clickDoneButton(this.activityView.nextB),app.state.window=!1,createjs.Tween.removeTweens(this),this.activityView.nextB.removeAllEventListeners(),this.activityDone=!0,createjs.Tween.get(this).wait(1e3).call(function(){app.state.hideWindow()}.bind(this))},d.teardown=function(){c.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").QuizActivity=b}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("createjs.Container"),b=function(){a.call(this),this.repeatPrompt=this.repeatPrompt.bind(this),this.onDoneButtonClicked=this.onDoneButtonClicked.bind(this),this.setup()},c=a.prototype,d=extend(b,a);d.setup=function(){this.id="offscreen",this.listener=this.activityTick.bind(this),this.activityView=new lib_RealWorld.RealWorld,this.addChild(this.activityView),this.activityDone=!1,this.timeout=[],this.kid="sally",this.categoryData=null,this.prompt="",this.voList=[]},d.initialize=function(){this.activityDone=!1,this.randomPrompts(),this.activityView.gotoAndStop(this.prompt.frame),this.activityView.currentFrame>2&&(this.kid="nick"),this.activityView[this.kid].framerate=24,this.activityView[this.kid].gotoAndStop(0);var a=[this.prompt.frame,this.prompt.frame+"_idle"],b=1200;"remember"==this.categoryData.category&&(b=1800),createjs.Tween.get(this).wait(1e3).call(function(){app.voPlayer.play(this.voList,function(){this.activityView[this.kid].on("click",this.repeatPrompt)}.bind(this))}.bind(this)).wait(b).call(function(){app.animator.play(this.activityView[this.kid],a)}.bind(this)),app.state.panel.makeDynamic(this.activityView.nextB),this.activityView.nextB.on("click",this.onDoneButtonClicked),app.state.panel.pulseDoneButton(this.activityView.nextB)},d.randomPrompts=function(){this.categoryData=app.randFromArray(app.config.assets.feedback),this.prompt=app.cycleArray(this.categoryData.prompts),this.voList=[],this.categoryData.prefix.length>0&&this.voList.push(this.categoryData.prefix),this.voList.push(this.prompt.vo)},d.repeatPrompt=function(){app.voPlayer.playing||this.activityDone||app.voPlayer.play(this.voList)},d.onDoneButtonClicked=function(){app.voPlayer.stop();for(var a=0;a<this.voList.length;a++)app.sound.stop(this.voList[a]);app.animator.stop(this.activityView[this.kid]),createjs.Tween.removeTweens(this.activityView.nextB),app.state.panel.clickDoneButton(this.activityView.nextB),app.state.window=!1,app.off("update",this.listener),createjs.Tween.removeTweens(this),this.activityView[this.kid].removeAllEventListeners(),this.activityView.nextB.removeAllEventListeners(),this.activityDone=!0,createjs.Tween.get(this).wait(1e3).call(function(){app.state.hideWindow()}.bind(this))},d.activityTick=function(a){a>100&&(a=100),a/=1e3,a/=1/app.options.fps},d.teardown=function(){c.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").RealWorldActivity=b}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("createjs.Container"),b=function(){a.call(this),this.setup()},c=a.prototype,d=extend(b,a);d.setup=function(){this.activityView=new lib_Seasons.Seasons,this.addChild(this.activityView),this.season="SUMMER",this.prevSeason=this.season,this.seasonButtons=[]},d.initializeSeasons=function(){this.seasonButtons=[];for(var a=0;a<app.state.panel.seasons.length;a++){var b=this.activityView[app.state.panel.seasons[a]];this.makeDynamic(b,.15),app.state.panel.seasons[a]!=this.season?b.gotoAndStop("default"):b.gotoAndStop("chosen"),b.name=app.state.panel.seasons[a],b.index=a,b.on("click",this.chooseSeason,this,!1,b),this.seasonButtons.push(b)}},d.chooseSeason=function(a,b){this.activityView.chosenSeason.text="VO:"+b.name,b.gotoAndStop("chosen"),this.season=b.name,this.prevSeason=this.season;for(var c=0;c<this.seasonButtons.length;c++)c!=b.index?this.seasonButtons[c].gotoAndStop("default"):(app.state.panel.spinner.buildIcon.gotoAndStop(b.index),app.state.panel.spinner.popIcon.gotoAndStop(b.index))},d.makeDynamic=function(a,b){b=b||.15;
var c=a.scaleX,d=a.scaleY;a.on("mouseover",function(){createjs.Tween.get(a).to({scaleX:c*(1+b),scaleY:d*(1+b)},100,createjs.Ease.sineOut)}.bind(this)),a.on("mouseout",function(){createjs.Tween.get(a).to({scaleX:c,scaleY:d},100,createjs.Ease.sineOut)}.bind(this)),a.on("mousedown",function(){createjs.Tween.get(a).to({scaleX:c*(1-b),scaleY:d*(1-b)},100,createjs.Ease.sineOut)}.bind(this)),a.on("pressup",function(){createjs.Tween.get(a).to({scaleX:c*(1+b),scaleY:d*(1+b)},100,createjs.Ease.backOut)}.bind(this))},d.teardown=function(){c.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").SeasonsActivity=b}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("createjs.Container"),b=function(){a.call(this),this.setup()},c=a.prototype,d=extend(b,a);d.setup=function(){this.listener=this.squishTick.bind(this),this.activityView=new lib_Squish.Squish,this.activityView.cursor.gotoAndStop(0),this.addChild(this.activityView),this.activityStarted=!1,this.spawningSquishObjects=!1,this.timeSinceLastSpawn=0,this.spawnInterval=60,this.totalSpawned=0,this.numberToSpawn=20,this.maxObjectsOnScreen=5,this.squishCount=0,this.squishObjectList=[],this.squishing=!1,this.timeout=[],this.reactVO=[],this.type=app.cycleArray(app.config.assets.squish),this.snowSounds=["spin_snowflake_flake1","spin_snowflake_flake2","spin_snowflake_flake3","spin_snowflake_flake4","spin_snowflake_flake5"],this.leafSounds=["leaves_break1","leaves_break2","leaves_break3","leaves_break4","leaves_break5"],this.berrySounds=["fruitsquish1","fruitsquish2","fruitsquish3","fruitsquish4"],this.paintSounds=["paintsplash1","paintsplash2","paintsplash3","paintsplash4","paintsplash5"],this.berryVO=["spinmj-127-NICK-01I","spinmj-129-SALLY-01E","spinmj-130-SALLY-01E","spinmj-131-SALLY-01F"],this.leafVO=["spinmj-127-NICK-01I","spinmj-137-SALLY-01B","spinmj-138-SALLY-01E","spinmj-139-SALLY-01E"],this.snowflakeVO=["spinmj-124-NICK-01D","spinmj-125-NICK-01D","spinmj-126-NICK-01C","spinmj-127-NICK-01I"],this.paintballVO=["spinmj-127-NICK-01I","spinmj-133-SALLY-01B","spinmj-134-SALLY-01C","spinmj-135-SALLY-01D"]},d.initialize=function(a){this.activityView.gotoAndStop(this.type);var b;"berry"==this.type?b="spinmj-128-SALLY-01D":"leaf"==this.type?b="spinmj-136-SALLY-01C":"snowflake"==this.type?b="spinmj-123-NICK-01G":"paintball"==this.type&&(b="spinmj-132-SALLY-01C"),this.addReactions(),createjs.Tween.get(this).wait(1e3).call(function(){app.voPlayer.play(b)}.bind(this)),a?(this.activityView.cursor.visible=!1,app.cursor.visible=!0,createjs.Tween.get(this).wait(1e3).call(function(){this.startGame()}.bind(this))):this.playTutorial()},d.playTutorial=function(){var a;"berry"==this.type?a=new lib_Squish.Berry:"leaf"==this.type?a=new lib_Squish.Leaf:"snowflake"==this.type?a=new lib_Squish.Snowflake:"paintball"==this.type&&(a=new lib_Squish.Paintball),this.activityView.squishObj.addChild(a),app.cursor.visible=!1,this.activityView.cursor.framerate=24,this.activityView.squishObj.children[0].gotoAndStop(0),this.activityView.squishObj.children[0][this.type+1].gotoAndStop(0),createjs.Tween.get(this.activityView.cursor).wait(1200).call(function(){app.animator.play(this.activityView.cursor,"move",function(){app.animator.play(this.activityView.squishObj.children[0][this.type+1],"Squish")}.bind(this))}.bind(this)).wait(2500).call(function(){app.cursor.x=this.activityView.cursor.x,app.cursor.y=this.activityView.cursor.y,this.startGame()}.bind(this))},d.startGame=function(){this.activityView.cursor.visible=!1,app.cursor.visible=!0,this.squishing=!0,this.spawningSquishObjects=!0,this.activityStarted=!0},d.addReactions=function(){"berry"==this.type?this.reactVO=this.berryVO:"leaf"==this.type?this.reactVO=this.leafVO:"snowflake"==this.type?this.reactVO=this.snowflakeVO:"paintball"==this.type&&(this.reactVO=this.paintballVO),app.shuffle(this.reactVO)},d.playReaction=function(){app.voPlayer.playing||(app.cycleArray(this.reactVO),app.voPlayer.play([this.reactVO[0],2e3]))},d.generateSquish=function(){var a=this.spawnSquishable();this.setObjectProperties(a),a.hitbox.on("click",this.squishOnClick,this,!1,a),this.squishObjectList.push(a),this.activityView.addChild(a)},d.spawnSquishable=function(){var a;"berry"==this.type?(a=new lib_Squish.Berry,a.variations=4):"leaf"==this.type?(a=new lib_Squish.Leaf,a.variations=4):"snowflake"==this.type?(a=new lib_Squish.Snowflake,a.variations=5):"paintball"==this.type&&(a=new lib_Squish.Paintball,a.variations=3);var b=Math.floor(Math.random()*a.variations);a.gotoAndStop(this.type+(b+1)),a[this.type+(b+1)].gotoAndStop(0),a.framerate=24;var c=Math.random()*(1.05-.75)+.75;return a.scaleX=a.scaleX*c,a.scaleY=a.scaleY*c,a.width=a.nominalBounds.width*c,a.height=a.nominalBounds.height*c,a.index=b+1,a.squished=!1,a.velocity={x:0,y:0},a.acceleration={x:0,y:0},a},d.setSquishablePosition=function(a){var b=app.getScreenOffset(),c=b.x+a.width,d=app.getScreenWidth()+b.x-a.width,e=b.y,f=app.getScreenHeight(),g={x:Math.floor(Math.random()*(d-c)+c),y:Math.floor(Math.random()*(f-e)+e)};a.x=g.x,a.y=g.y},d.setObjectProperties=function(a){this.setSquishablePosition(a),a.velocity.x=(1*Math.random()+1.5)*app.randomSign(),a.velocity.y=(1*Math.random()+1.5)*app.randomSign(),a.rotateDir=app.randomSign(),"leaf"===this.type?a.audio=this.leafSounds:"snowflake"===this.type?a.audio=this.snowSounds:"berry"===this.type?a.audio=this.berrySounds:"paintball"===this.type&&(a.audio=this.paintSounds)},d.squishOnClick=function(a,b){if(!b.squished){"paintball"==this.type&&(b.rotation=0),this.squishCount++,b.squished=!0;var c=Math.floor(Math.random()*b.audio.length);app.animator.play(b[this.type+b.index],{anim:"Squish",audio:b.audio[c]},function(){b.cache(-200,-200,400,400)}.bind(this)),this.playReaction(),createjs.Tween.get(b).wait(100).call(function(){var a=this.squishObjectList.indexOf(b);this.squishObjectList.splice(a,1),this.activityView.removeChild(b),this.activityView.addChildAt(b,2+this.squishCount)}.bind(this))}},d.clearSquishList=function(){for(var a=0;a<this.squishObjectList.length;a++)this.squishObjectList[a].confettiParticles&&(this.squishObjectList[a].confettiParticles.destroy(),this.squishObjectList[a].confettiParticles.stop()),this.activityView.removeChild(this.squishObjectList[a]);this.squishObjectList=[]},d.squishTick=function(a){if(!app.state.windowTransitioning){a>100&&(a=100),a/=1e3,a/=1/app.options.fps;for(var b=20,c={x:app.display.stage.mouseX,y:app.display.stage.mouseY},d=(this.activityView.globalToLocal(c.x,c.y),0);d<this.squishObjectList.length;d++){var e=this.squishObjectList[d];if(e.squished!==!0){var f=app.getScreenOffset(),g=f.x+e.width/2-b,h=f.x+app.getScreenWidth()-e.width/2+b,i=e.height/2-b,j=app.getScreenHeight()-e.height/2+b;e.x<g?(e.x=g,e.velocity.x*=-1):e.x>h&&(e.x=h,e.velocity.x*=-1),e.y<i?(e.y=i,e.velocity.y*=-1):e.y>j&&(e.y=j,e.velocity.y*=-1),e.velocity.x+=e.acceleration.x,e.velocity.y+=e.acceleration.y,e.x+=e.velocity.x,e.y+=e.velocity.y,e.rotation+=e.rotateDir}}this.spawningSquishObjects===!0?(this.timeSinceLastSpawn+=a,this.timeSinceLastSpawn>=this.spawnInterval&&this.squishObjectList.length<this.maxObjectsOnScreen&&(this.timeSinceLastSpawn=0,this.totalSpawned++,this.generateSquish()),this.totalSpawned>=this.numberToSpawn&&(this.spawningSquishObjects=!1)):this.activityStarted&&this.spawningSquishObjects===!1&&0===this.squishObjectList.length&&(app.state.stopTimeout(),app.off("update",this.listener),this.checkVO())}},d.checkVO=function(){app.voPlayer.playing?createjs.Tween.get(this).wait(800).call(function(){this.checkVO()}.bind(this)):this.endSquish()},d.endSquish=function(){app.voPlayer.stop(),this.clearSquishList(),createjs.Tween.get(this.activityView).wait(1e3).call(function(){app.state.hideWindow()}.bind(this))},d.kill=function(a){if(this.squishing&&this.clearSquishList(),this.timeout=[],this.squishing=!1,app.off("update",this.listener),this.spawnTweens)for(var b=0;b<this.spawnTweens.length;b++){var c=this.spawnTweens[b];try{createjs.Tween.removeTweens(c.target)}catch(d){}}},d.teardown=function(){c.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").SquishActivity=b}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("createjs.Container"),b=function(){a.call(this),this.setup()},c=a.prototype,d=extend(b,a);d.setup=function(){this.id="sticker",this.listener=this.stickerTick.bind(this),this.addTimeouts=this.addTimeouts.bind(this),this.reEnableBankDrag=this.reEnableBankDrag.bind(this),this.onBankDrag=this.onBankDrag.bind(this),this.onBankRelease=this.onBankRelease.bind(this),this.activityView=new lib_Sticker.Sticker,this.activityView.tickEnabled=!1,this.addChild(this.activityView),this.usingTouch=app.hasTouch===!0?!0:!1,this.pointerPos={x:0,y:0},this.currentInteraction="none",this.backgroundNum=0,this.stickerTotal=22,this.currentSticker=null,this.scrollCounter=0,this.addForce=!1,this.dragBank=!1,this.stickerCount=0,this.stickerData=app.config.assets.stickers,this.bankSpacing={x:140,y:-30},this.bankDragPlaying=!1,this.tutorial=!1,this.timeout=[],this.genericResponses=["spinmj-56-CAT-03","spinmj-57-CAT-03","spinmj-58-CAT-03B"],this.additionalVO=["spinmj-45-CAT-03","spinmj-48-CAT-03","spinmj-55-CAT-03"],this.pickStickerVO="spinmj-44-CAT-03",app.display.stage.on("stagemousedown",this.onStageMouseDown,this),app.display.stage.on("stagemousemove",this.onStageMouseMove,this)},d.playTutorial=function(){var a=app.stickerRight.localToGlobal(0,0);this.activityView.globalToLocal(a.x,a.y);this.tutorial=!0,this.activityView.slots.visible=!0,this.activityView.slots.x=1600;var b=this.activityView.cursor;b.framerate=24,b.gotoAndStop(0),app.voPlayer.play("spinmj-44-CAT-03"),createjs.Tween.get(b).wait(1e3).call(function(){app.animator.play(b,"grab")}.bind(this)).wait(3e3).call(function(){app.animator.play(b,"return")}.bind(this)).wait(3e3).call(function(){app.animator.play(b,"disappear")}.bind(this)),createjs.Tween.get(this.activityView.slots).wait(6500).to({x:this.activityView.slots.initialPosition},2500).call(function(){this.addTimeouts(),this.startGame()}.bind(this))},d.initialize=function(a){this.backgroundNum=Math.floor(3*Math.random()),this.activityView.stickerBG.x-=1536*this.backgroundNum,this.activityView.stickerBank.force=0,"undefined"==typeof this.activityView.slots.initialPosition&&(this.activityView.slots.initialPosition=this.activityView.slots.x),this.activityView.slots.x=this.activityView.slots.initialPosition,this.stickerCount=0,app.stickerLeft.on("click",function(){this.moveBackground(1)}.bind(this)),app.stickerRight.on("click",function(){this.moveBackground(-1)}.bind(this));for(var b=this.stickerData.permanent,c=[],d=0;d<this.stickerData.random.length;d++)c.push(this.stickerData.random[d]);for(var e=[],f=0;f<this.stickerTotal-b.length;f++){var g=Math.floor(Math.random()*c.length),h=c[g];e.push(h),c.splice(g,1)}for(var i=0;i<b.length;i++)e.push(b[i]);this.addStickers(e),createjs.Tween.get(this).wait(1e3).call(function(){app.stickerLeft.visible=!0,app.stickerRight.visible=!0}.bind(this)),a?(this.startGame(),createjs.Tween.get(this).wait(1e3).call(function(){app.voPlayer.play("spinmj-44-CAT-03",this.addTimeouts)}.bind(this))):(app.cursor.visible=!1,this.activityView.cursor.stop(),this.activityView.slots.visible=!1,createjs.Tween.get(this).wait(1e3).call(function(){this.playTutorial()}.bind(this)))},d.startGame=function(){this.tutorial=!1,this.activityView.slots.x=this.activityView.slots.initialPosition,this.activityView.cursor.visible=!1,app.cursor.visible=!0,this.reEnableBankDrag()},d.onStageMouseDown=function(a){a.touches&&a.touches.length>1&&a.pointerID>0||"none"===this.currentInteraction&&(this.usingTouch===!1&&a.touches?this.usingTouch=!0:this.usingTouch!==!0||a.touches||(this.usingTouch=!1),this.pointerPos={x:a.stageX,y:a.stageY})},d.onStageMouseMove=function(a){a.touches&&a.touches.length>1&&a.pointerID>0||this.usingTouch===!1&&a.touches||(this.usingTouch!==!0||a.touches)&&(this.pointerPos={x:a.stageX,y:a.stageY})},d.addTimeouts=function(){this.timeout=["spinmj-46-CAT-03","spinmj-47-CAT-03"],app.shuffle(this.timeout),this.timeout.push("spinmj-44-CAT-03"),app.state.startTimeout()},d.addStickers=function(a){for(var b=0;b<this.stickerTotal;b++){var c=new createjs.Container;c.x=this.bankSpacing.x*b,c.y=this.bankSpacing.y,this.activityView.slots.addChild(c);var d=Math.floor(Math.random()*a.length),e=this.initializeSticker(a[d],b);c.addChild(e),app.state.panel.makeDynamic(c),a.splice(d,1)}},d.moveBackground=function(a){this.activityView.stickerBG.moving||(app.sound.play("spin_sticker_sceneslide"),this.backgroundNum-=a,this.activityView.stickerBG.moving=!0,this.backgroundNum<0&&(this.backgroundNum=2,this.activityView.stickerBG.x=-3830),createjs.Tween.get(this.activityView.stickerBG).wait(10).to({x:this.activityView.stickerBG.x+1536*a},750).call(function(){this.activityView.stickerBG.moving=!1,this.backgroundNum>2&&(this.backgroundNum=0,this.activityView.stickerBG.x=778)}.bind(this)))},d.initializeSticker=function(a,b){var c=new lib_Sticker["sticker"+a];return c.gotoAndStop(1),c.index=b,c.placed=!1,c.type=a,c.on("mousedown",this.enableStickerDrag,this,!1,c),c.on("pressup",this.placeSticker,this,!1,c),c},d.enableStickerDrag=function(a,b){"none"!==this.currentInteraction||null!==this.currentSticker||b.clickCarry||(this.currentInteraction="sticker",this.usingTouch===!1&&a.touches?this.usingTouch=!0:this.usingTouch!==!0||a.touches||(this.usingTouch=!1),app.sound.play("spin_sticker_stickerlift"),this.activityView.removeChild(b),this.activityView.addChild(b),this.currentSticker=b,createjs.Tween.get(this).wait(1).call(function(){b.startPointX=b.x,b.startPointY=b.y}.bind(this)))},d.placeSticker=function(a,b){if("sticker"===this.currentInteraction&&null!==this.currentSticker&&b===this.currentSticker&&(this.usingTouch!==!1||!a.touches)&&(this.usingTouch!==!0||a.touches)){var c=Math.abs(b.x-b.startPointX),d=Math.abs(b.y-b.startPointY);!(10>c||15>d)||b.clickCarry||app.hasTouch?(this.currentInteraction="none",b.clickCarry=!1,this.currentSticker=null,b.placed||(this.adjustBank(b),app.state.panel.makeDynamic(b),this.playVoResponse(b.type)),b.placed=!0,b.x<app.getScreenOffset().x+150&&b.y<app.getScreenOffset().y+170?(b.x=app.getScreenOffset().x+150,b.y=app.getScreenOffset().y+150):b.x<app.getScreenOffset().x+150&&b.y>=app.getScreenOffset().y+350&&b.y<app.getScreenOffset().y+475?b.x=app.getScreenOffset().x+150:b.x>=app.getScreenOffset().x+880&&b.y>=app.getScreenOffset().y+350&&b.y<app.getScreenOffset().y+475?b.x=app.getScreenWidth()+(app.getScreenOffset().x-150):b.y<app.getScreenOffset().y+8&&(b.y=app.getScreenOffset().y+15),b.y>580?this.returnToBank(b):(app.sound.play("thump1"),this.activityView.removeChild(b),this.activityView.addChildAt(b,this.activityView.getChildIndex(this.activityView.stickerBank)))):b.clickCarry=!0}},d.collision=function(a,b,c,d,e,f){var g=d-a,h=e-b,i=c+f;return i*i>=g*g+h*h},d.playVoResponse=function(a){app.voPlayer.playing!==!0&&(this.stickerData.vo.hasOwnProperty(a)?(app.state.stopTimeout(),app.voPlayer.play(["spinmj-49-CAT-03",this.stickerData.vo[a]]),app.state.startTimeout()):Math.random()<.3&&(app.state.stopTimeout(),app.voPlayer.play(app.randFromArray(this.genericResponses)),app.state.startTimeout()))},d.adjustBank=function(a){this.stickerCount++;for(var b=a.index;b<this.activityView.slots.children.length-1;b++){var c=this.activityView.slots.children[b],d=c.children[0];c.removeChild(d);var e=this.activityView.slots.children[b+1];c.addChild(e.children[0]),c.children.length&&(c.children[0].index=b)}2===this.stickerCount&&this.additionalVO.length&&(this.timeout=this.timeout.concat(this.additionalVO),this.additionalVO=[],app.shuffle(this.timeout)),this.stickerCount>=this.stickerTotal&&this.timeout.indexOf(this.pickStickerVO)>-1&&this.timeout.splice(this.timeout.indexOf(this.pickStickerVO),1)},d.returnToBank=function(a){for(var b,c,d,e=a.parent.localToLocal(a.x,a.y,this.activityView.slots),f=[],g=0;g<this.activityView.slots.children.length;g++){var h=Math.abs(this.activityView.slots.children[g].x-e.x);(0===g||c>h)&&(c=h,b=this.activityView.slots.children[g],this.activityView.slots.children[g].children.length&&f.push(this.activityView.slots.children[g]))}f.length>=6?d=this.activityView.slots.getChildIndex(b):f.length&&f.length>=1?d=f.length:(!f.length||c>=80)&&(d=0),c>=80&&(d=0);for(var i=this.activityView.slots.children.length-this.stickerCount-1;i>d-1;i--){var j=this.activityView.slots.children[i],k=j.children[0];if(j.children.length){k.index++,j.children.splice(2);var l=this.activityView.slots.children[i+1];l.addChild(k)}}var m=this.activityView.slots.children[d],n=this.initializeSticker(a.type,d);this.activityView.removeChild(a),m.addChild(n),this.stickerCount--,-1===this.timeout.indexOf(this.pickStickerVO)&&this.timeout.push(this.pickStickerVO)},d.reEnableBankDrag=function(){this.activityView.stickerBank.disabled=!1,this.activityView.stickerBank.on("mousedown",this.onBankDrag),this.activityView.stickerBank.on("pressup",this.onBankRelease)},d.onBankDrag=function(a){"none"===this.currentInteraction&&(this.currentInteraction="bank",this.usingTouch===!1&&a.touches?this.usingTouch=!0:this.usingTouch!==!0||a.touches||(this.usingTouch=!1),this.activityView.stickerBank.startPoint=this.pointerPos.x,this.activityView.stickerBank.dragPoint=this.activityView.stickerBank.startPoint,this.scrollCounter=0,this.stickerCount<this.activityView.slots.children.length-4?(this.bankDragPlaying||app.sound.play("spin_sticker_stickerslide-loop"),this.dragBank=!0,this.bankDragPlaying=!0):(this.activityView.stickerBank.disabled=!0,this.activityView.stickerBank.removeAllEventListeners(),this.currentInteraction="none"))},d.onBankRelease=function(a){"bank"===this.currentInteraction&&(this.usingTouch===!1&&a.touches||(this.usingTouch!==!0||a.touches)&&(this.currentInteraction="none",this.addForce=!0,this.dragBank=!1,app.sound.stop("spin_sticker_stickerslide-loop"),this.bankDragPlaying=!1))},d.stickerTick=function(a){if(!this.tutorial){a>100&&(a=100),a/=1e3,a/=1/app.options.fps,this.scrollCounter++;var b=this.activityView.globalToLocal(this.pointerPos.x,this.pointerPos.y),c=this.currentSticker,d=this.activityView.stickerBank;if(null!==c&&(c.x=b.x,c.y=b.y,c.y<580?c.gotoAndStop(0):c.gotoAndStop(1)),d.force>0?d.force--:d.force<0&&d.force++,Math.abs(d.force)<1&&(d.force=0),this.addForce&&(d.force=(this.pointerPos.x-d.startPoint)/this.scrollCounter,this.addForce=!1),this.dragBank){var e=this.pointerPos.x-d.dragPoint;this.activityView.slots.x+=2*e,d.dragPoint=this.pointerPos.x}else this.activityView.slots.x+=d.force;if(this.stickerCount<this.activityView.slots.children.length-4){d.disabled&&this.reEnableBankDrag();var f=this.activityView.slots.initialPosition,g=f,h=this.stickerTotal-this.stickerCount-7;h>0&&(g=f-this.bankSpacing.x*h),this.activityView.slots.x>f?this.activityView.slots.x=f:this.activityView.slots.x<g&&(this.activityView.slots.x=g)}else d.disabled=!0,"bank"===this.currentInteraction&&(this.currentInteraction="none")}},d.kill=function(a){app.off("update",this.listener),app.stickerLeft.visible=!1,app.stickerRight.visible=!1,app.stickerLeft.removeAllEventListeners(),app.stickerRight.removeAllEventListeners(),app.display.stage.off("stagemousedown",this.onStageMouseMove),app.display.stage.off("stagemousemove",this.onStageMouseMove)},d.teardown=function(){c.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").StickerActivity=b}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("springroll.easeljs.BasePanel"),b=include("createjs.Bitmap"),c=include("springroll.easeljs.SoundButton"),d=function(){a.call(this)},e=a.prototype,f=extend(d,a);f.setup=function(){this.background=new b(images.TitleBackground),this.addChild(this.background),this.playButton=new c(images.PlayButton),this.addChild(this.playButton),app.backB.visible=!1},f.teardown=function(){e.teardown.call(this),this.background=null,this.playButton=null},namespace("CatSpinnerGame").TitlePanel=d}(),function(){function a(a){return a?0>a?-1:1:0}var b=include("createjs.Container"),c=function(){b.call(this),this.setup()},d=b.prototype,e=extend(c,b);e.setup=function(){this.id="wand",this.activityView=new lib_Wand.Wand,this.addChild(this.activityView),this.wand=this.activityView.wand,this.obstacle=this.activityView.obstacle,this.activityView._updateTimeline(),this.obstacle._updateTimeline(),app.state.panel.wandGameCount%2===0?(this.obstacle.gotoAndStop(0),this.obsCollider=this.obstacle.popZone,this.collisionBehavior="pop"):(this.obstacle.gotoAndStop(1),this.obsCollider=this.obstacle.bowlZone,this.collisionBehavior="float");var a=this.obsCollider.localToLocal(0,0,this.activityView);this.obsDims={x:a.x,y:a.y,r:this.obsCollider.nominalBounds.width/2},this.obstacle.fishbowl.framerate=24,this.obstacle.popZone.visible=!1,this.obstacle.bowlZone.visible=!1,this.obstacle.waterline.visible=!1,this.bubbleListener=this.bubbleTick.bind(this),this.mouseMoveListener=app.display.stage.on("stagemousemove",this.onMouseMove.bind(this)),this.mouseDownListener=app.display.stage.on("stagemousedown",this.onMouseDown.bind(this)),this.maxBubbleSize=2.5,this.clickRelease=!1,this.clickBurstRadius=100,this.timeout=["spinmj-107-NICK-01E","spinmj-108-NICK-01E","spinmj-109-NICK-01D","spinmj-110-NICK-01I","spinmj-111-NICK-01D","spinmj-113-NICK-01D","spinmj-114-NICK-01D","spinmj-116-NICK-01A","spinmj-117-NICK-01D","spinmj-118-NICK-01E","spinmj-119-NICK-01A"],this.bubbleMakeSounds=["bubbles-make1","bubbles-make2","bubbles-make3","bubbles-make4"],this.bubblePopSounds=["bubbles-pop1","bubbles-pop2","bubbles-pop3","bubbles-pop4"]},e.playTutorial=function(){this.wand.visible=!1;var a=this.activityView.cursor;a.framerate=24,a.gotoAndStop(0),a.bubble.gotoAndStop(0),createjs.Tween.get(a).wait(1e3).call(function(){app.voPlayer.play("spinmj-106-NICK-01C"),app.animator.play(a,"move")}.bind(this)).wait(2e3).call(function(){app.animator.play(a,"pop",function(){app.animator.play(a.bubble,"Pop")}.bind(this))}.bind(this)).wait(3e3).call(function(){this.activityView.cursor.visible=!1,this.startGame()}.bind(this))},e.initialize=function(a){app.cursor.visible=!1,this.prevPos={x:0,y:0},this.xDiff=0,this.yDiff=0,this.averagedXDiff=0,this.averagedYDiff=0,this.bubbleLoopDelay=null,this.growingBubble=null,this.bubbleCount=0,this.bubbles=[],this.bubblesMade=0,a?(this.activityView.cursor.visible=!1,createjs.Tween.get(this).wait(1e3).call(function(){app.voPlayer.play("spinmj-106-NICK-01C"),this.startGame()}.bind(this))):this.playTutorial()},e.startGame=function(){this.wand.visible=!0,app.on("update",this.bubbleListener),app.shuffle(this.timeout),app.state.startTimeout(!0,!1)},e.createBubble=function(){var a=new lib_Wand.Bubble;return a.gotoAndStop(0),this.activityView.addChildAt(a,0),a},e.bubbleTick=function(a){a/=1e3;var b={x:app.display.stage.mouseX,y:app.display.stage.mouseY},c=this.activityView.globalToLocal(b.x,b.y);this.wand.x=c.x,this.wand.y=c.y;var d=this.wand.x-this.prevX,e=this.wand.y-this.prevY,f=.1;this.averagedXDiff=f*d+(1-f)*this.averagedXDiff,this.averagedYDiff=f*e+(1-f)*this.averagedYDiff,this.xDiff=d,this.yDiff=e;var g=Math.sqrt(this.xDiff*this.xDiff+this.yDiff*this.yDiff),h=g/a;if(null===this.growingBubble)this.bubbleCount+=a,this.bubbleCount>=.025&&(this.growingBubble=this.createBubble(),this.growingBubble.scaleX=.25,this.growingBubble.scaleY=.25,this.growingBubble.x=this.wand.x,this.growingBubble.y=this.wand.y,this.growingBubble.alpha=0,this.averagedXDiff=this.xDiff,this.averagedYDiff=this.yDiff);else{this.growingBubble.alpha+=g/100;var i=this.growingBubble.scaleX+g/1e3;this.growingBubble.scaleX=i,this.growingBubble.scaleY=i,this.growingBubble.width=this.growingBubble.nominalBounds.width*this.growingBubble.scaleX,this.growingBubble.height=this.growingBubble.nominalBounds.height*this.growingBubble.scaleY,this.growingBubble.x+=this.xDiff/1.15,this.growingBubble.y+=this.yDiff/1.15;this.activityView.globalToLocal(this.growingBubble.x,this.growingBubble.y);i>=this.maxBubbleSize?this.finishBubble(a):h>1500&&this.growingBubble.alpha>=1?this.finishBubble(a):this.clickRelease&&(this.finishBubble(a),this.clickRelease=!1)}if(this.prevX=this.wand.x,this.prevY=this.wand.y,null!==this.bubbles)for(var j=this.bubbles.length-1;j>=0;j--){var k=this.bubbles[j];k.update(a),this.checkForObstacleCollision(k),k.popped&&this.bubbles.splice(j,1)}},e.checkForObstacleCollision=function(a){var b=a.object.localToLocal(0,0,this.activityView),c=this.collision(b.x,b.y,a.sizeX,this.obsDims.x,this.obsDims.y,this.obsDims.r);c!==!1&&a.popped!==!0&&("pop"===this.collisionBehavior?a.pop():"float"===this.collisionBehavior&&(a.getBottomEdge()<=this.obstacle.waterline.localToLocal(0,0,a.object).y?(a.targetPos=this.obstacle.waterline.localToLocal(0,0,this.activityView),a.targetPos.y-=a.getBottomEdge()):a.moveAwayFrom(this.obsDims)))},e.finishBubble=function(a){var b=new f(this.growingBubble,this.averagedXDiff/a,this.averagedYDiff/a);b.popSound=app.randFromArray(this.bubblePopSounds),this.bubbles.push(b),this.growingBubble=null,this.bubbleCount=0,this.bubblesMade+=1,app.sound.play(app.randFromArray(this.bubbleMakeSounds))};var f=function(b,c,d){var e=50;this.object=b,this.popped=!1,this.initialScaleX=b.scaleX,this.initialScaleY=b.scaleY,this.sizeX=b.nominalBounds.width*b.scaleX/2,this.sizeY=b.nominalBounds.height*b.scaleY/2,this.lifetime=.1*this.sizeX,this.driftY=40,this.targetPos=null,this.targetMoveSpeed=20,this.popSound="",this.object.alpha=1,this.xVel=c,Math.abs(this.xVel)>e&&(this.xVel=a(this.xVel)*e),this.yVel=d,Math.abs(this.yVel)>e&&(this.yVel=a(this.yVel)*e),this.age=0,createjs.Tween.get(b,{loop:!0}).to({scaleX:1.05*this.initialScaleX,scaleY:.95*this.initialScaleY},1e3,createjs.Ease.sineOut).to({scaleX:.95*this.initialScaleX,scaleY:1.05*this.initialScaleY},2e3,createjs.Ease.sineInOut).to({scaleX:this.initialScaleX,scaleY:this.initialScaleY},1e3,createjs.Ease.sineIn);var f=750+500*Math.random();createjs.Tween.get(b,{loop:!0}).to({rotation:10},f,createjs.Ease.sineOut).to({rotation:-10},2*f,createjs.Ease.sineInOut).to({rotation:0},f,createjs.Ease.sineIn)};f.prototype.update=function(a){if(null!==this.object&&!this.popped){if(this.age+=a,this.age>this.lifetime&&!this.popped&&this.pop(),null!==this.targetPos)return Math.abs(this.object.y,this.targetPos.y)<=this.driftY*a?this.object.y=this.targetPos.y:this.object.y+=this.driftY*a*app.sign(this.targetPos.y-this.object.y),this.xVel+=(this.targetPos.x-this.object.x)*a,this.xVel*=.9,void(this.object.x+=this.xVel*a);this.object.x+=this.xVel*a,this.object.y+=this.yVel*a+this.driftY*a,this.xVel/=1+Math.pow(.05,1+this.age/3),this.yVel/=1+Math.pow(.05,1+this.age/3);var b=app.getScreenOffset(),c=b.x+this.sizeX,d=app.getScreenWidth()+b.x-this.sizeX,e=b.y+this.sizeY,f=app.getScreenHeight()+b.y-this.sizeY;this.object.x<c?(this.object.x=c,this.xVel*=-1):this.object.x>d&&(this.object.x=d,this.xVel*=-1),this.object.y<e?(this.object.y=e,this.yVel*=-1):this.object.y>f&&(this.object.y=f,this.yVel*=-1)}},f.prototype.pop=function(){this.popped||(this.popped=!0,app.animator.play(this.object,"Pop",function(){this.remove()}.bind(this)),app.sound.play(this.popSound))},f.prototype.remove=function(){app.animator.stop(this.object,!0),createjs.Tween.removeTweens(this),this.object.parent&&this.object.parent.removeChild(this.object)},f.prototype.getRadius=function(){return this.object.nominalBounds.width/2*this.object.scaleX},f.prototype.getBottomEdge=function(){return this.object.nominalBounds.height/2*this.object.scaleY},f.prototype.moveAwayFrom=function(a){this.object.x+=.5*app.sign(this.object.x-a.x)},e.onBubbleClicked=function(a,b){b.pop(),null!==this.growingBubble&&this.cancelBubble()},e.cancelBubble=function(){this.growingBubble.parent.removeChild(this.growingBubble),this.growingBubble=null,this.bubbleCount=0},e.onMouseMove=function(a){this.prevPos={x:a.stageX,y:a.stageY}},e.onMouseDown=function(a){for(var b=!1,c=this.activityView.globalToLocal(a.stageX,a.stageY),d=0;d<this.bubbles.length;d++){var e=this.bubbles[d];if(e.popped!==!0){var f=this.collision(c.x,c.y,this.clickBurstRadius,e.object.x,e.object.y,e.getRadius());f&&(e.pop(),b=!0)}}null!==this.growingBubble&&(b?this.cancelBubble():this.clickRelease=!0)},e.kill=function(){this.wand.visible=!1,app.off("update",this.bubbleListener),app.display.stage.off("stagemousedown",this.mouseDownListener),app.display.stage.off("stagemousemove",this.mouseMoveListener);for(var a=this.bubbles.length-1;a>=0;a--)this.bubbles[a].remove();this.bubbles=[],app.state.panel.wandGameCount++},e.collision=function(a,b,c,d,e,f){var g=d-a,h=e-b,i=c+f;return i*i>=g*g+h*h},e.teardown=function(){d.teardown.call(this),this.activityView=null},namespace("CatSpinnerGame").WandActivity=c}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("springroll.easeljs.BaseState"),b=include("CatSpinnerGame.GamePanel"),c=include("springroll.DelayedCall");Captions=include("springroll.Captions");var d=function(c){a.call(this,new b,c)},e=extend(d,a);e.enterDone=function(){app.state=this,this.gameListener=this.startTimeout.bind(this),this.arrowListener=this.arrowTick.bind(this),this.spinning=!1,this.window=!1,this.windowTransitioning=!1,this.arrowSpeed=60,this.arrowTimer=0,this.targetAngle=0,this.arrowAngle=0,this.spinIndex=0,this.auto=!0,this.timeoutCount=0,this.containerTick=!1,this.bgmusic=app.sound.play("musicloop"),app.shuffle(app.config.assets.quizzes),app.shuffle(app.config.assets.squish),this.alternatePages=[0,1],this.coloringPages=["coloring1","coloring2","coloring3","coloring4"],this.drawingPages=["drawing1","drawing2","drawing3","drawing4","drawing5","drawing6","drawing7"],app.shuffle(this.coloringPages),app.shuffle(this.drawingPages),this.gameNameAudio=["spinmj-17-CAT-01","spinmj-15-CAT-01","spinmj-14-CAT-01","spinmj-16-CAT-01","spinmj-20-CAT-01","spinmj-18-CAT-02B","spinmj-19-CAT-01","spinmj-13-CAT-01"],this.cacheSymbols=[this.panel.nick,this.panel.sally,this.panel.pump,this.panel.hose,this.panel.lights],this.panel.skin.hitbox.on("click",function(){this.spin()}.bind(this)),this.panel.pump.on("click",function(){app.sound.play("spin_quiz_C3"),this.scalePump(),this.spin()}.bind(this)),this.panel.nick.on("click",function(){this.scalePlatform(),this.spin()}.bind(this)),this.panel.sally.on("click",function(){this.scalePlatform(),this.spin()}.bind(this)),this.panel.skin.hitbox.on("mousedown",function(){this.panel.removeArrowEvents(),createjs.Tween.get(this).wait(200).call(function(){this.spinning||this.window||app.on("update",this.arrowListener)}.bind(this))}.bind(this)),this.panel.skin.hitbox.on("pressup",function(){if(!this.spinning&&!this.window){app.off("update",this.arrowListener);var a=Math.ceil(-this.panel.arrow.rotation/45);this.panel.arrow.rotation=this.panel.angles[a-1],this.panel.lastGame=a;var b="result"+a;app.animator.play(this.panel.spinner[b],"highlight"),createjs.Tween.get(this).wait(500).call(function(){this.showWindow(b)}.bind(this))}}.bind(this));for(var a=0;a<this.panel.pieces.length;a++){var b=this.panel.pieces[a];b.hitbox.on("click",this.spinnerClick,this,!1,b)}this.panel.makeDynamic(app.backB),app.backB.on("click",function(){app.sound.play("ButtonClick"),app.voPlayer.stop(),this.hideWindow()}.bind(this)),this.spin(),this.spinnerMechanics()},e.spin=function(){if(!this.spinning&&!this.window){app.state.stopTimeout(),app.sound.play("spin_gen_spinTick"),this.spinning=!0;var a=this.generateWeightedList(),b=a[Math.floor(Math.random()*a.length)];b==this.spinIndex?8===b?this.spinIndex=1:this.spinIndex=b+1:this.spinIndex=b,this.targetAngle=1440-this.panel.angles[this.spinIndex-1],this.panel.lastGame=this.spinIndex,this.adjustWeight(this.spinIndex),app.on("update",this.arrowListener)}},e.spinnerClick=function(a,b){this.window||this.spinning||(app.animator.play(this.panel.spinner[b.name],"highlight"),this.panel.lastGame=b.index,this.panel.arrow.rotation=this.panel.angles[b.index-1],
app.voPlayer.play(this.gameNameAudio[b.index-1],function(){this.showWindow(b.name)}.bind(this)))},e.rotateArrow=function(){var a={x:app.display.stage.mouseX,y:app.display.stage.mouseY},b=this.panel.skin.globalToLocal(a.x,a.y),c=Math.atan2(b.y-this.panel.arrow.y,b.x-this.panel.arrow.x),d=c*(180/Math.PI);this.panel.arrow.rotation=d-180,this.panel.lastGame=Math.ceil(-this.panel.arrow.rotation/45)},e.generateWeightedList=function(){for(var a=[],b=0;b<this.panel.weight.length;b++)for(var c=0;c<this.panel.weight[b];c++)a.push(this.panel.games[b]);return a},e.adjustWeight=function(a){for(var b=0,c=0;c<this.panel.weight.length;c++)c==a-1&&this.panel.weight[c]--,b+=this.panel.weight[c];0===b&&(this.panel.weight=[5,5,5,5,5,5,5,5])},e.showWindow=function(a){if(!this.window){app.sound.stop("spin_gen_spinTick"),this.stopTimeout(),this.window=!0,this.windowTransitioning=!0,this.spinning=!1;var b=app.config.assets.activityViews,c=!1;this.panel.currentContainer=new CatSpinnerGame[b[a]];for(var d=0;d<this.panel.playedGames.length;d++)a==this.panel.playedGames[d]&&(c=!0);this.panel.currentContainer.initialize(c),this.panel.window.addChild(this.panel.currentContainer),this.containerTick=app.on("update",this.panel.currentContainer.listener),app.sound.play("spin_gen_wipedown"),this.toggleAnimationCache(),createjs.Tween.get(this.panel.window).to({y:this.panel.windowVisibleY},1e3).call(function(){this.windowTransitioning=!1,app.backB.visible=!0,app.animator.play(this.panel.spinner[a],"default"),this.toggleHomeScreen()}.bind(this)),c||this.panel.playedGames.push(a)}},e.toggleHomeScreen=function(){for(var a=0;12>a;a++)this.panel.skin.children[a].visible=!this.panel.skin.children[a].visible},e.toggleAnimationCache=function(){for(var a=0;a<this.cacheSymbols.length;a++){var b=this.cacheSymbols[a];if(null===b.cacheCanvas){var c=b.nominalBounds;b.cache(c.x-100,c.y-100,c.width+200,c.height+200)}else b.uncache()}},e.hideWindow=function(){createjs.Tween.removeAllTweens(),app.voPlayer.stop();var a=this.panel.currentContainer.activityView.cursor;a&&(a.visible=!1),app.cursor.visible=!0,app.tutorialCursor.visible=!1,this.windowTransitioning=!0,this.stopTimeout(),this.panel.currentContainer.kill&&this.panel.currentContainer.kill(),app.backB.visible=!1,this.toggleHomeScreen(),app.voPlayer.play("spin_gen_wipeup"),createjs.Tween.get(this.panel.window).to({y:this.panel.windowHiddenY},1e3).call(function(){this.window=!1,this.windowTransitioning=!1,this.startTimeout(),this.panel.currentContainer.activityView&&(this.panel.currentContainer.removeChild(this.panel.currentContainer.activityView),this.panel.currentContainer.activityView=null),app.off("update",this.containerTick),this.panel.window.removeChild(this.panel.currentContainer),this.panel.currentContainer=null,this.toggleAnimationCache()}.bind(this)),this.panel.addArrowEvents()},e.startTimeout=function(a,b){"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!1),this.timeout&&this.timeout.destroy();var d=2500;null!==this.panel.currentContainer&&(d=1e4),this.timeoutCount++,this.timeout=new c(function(){if(this.spinning||this.window){if(!this.panel.currentContainer.timeout.length)return;var a=app.cycleArray(this.panel.currentContainer.timeout);if("offscreen"==this.panel.currentContainer.id&&(a=this.panel.currentContainer.timeout),app.voPlayer.play(a,function(){app.voPlayer.playing||app.state.startTimeout(!1,b)}.bind(this)),b){var c=this.panel.currentContainer.timeout.indexOf(a);this.panel.currentContainer.timeout.splice(c,1)}}}.bind(this),d)},e.stopTimeout=function(){this.timeout&&this.timeout.destroy(),app.state.timeoutCount=0},e.arrowTick=function(a){if(a>100&&(a=100),a/=1e3,a/=1/app.options.fps,this.window||this.spinning){if(this.spinning&&!this.window)if(this.arrowTimer++,this.panel.arrow.rotation-=this.arrowSpeed,this.arrowAngle-=this.arrowSpeed,this.arrowAngle%360===0&&this.panel.arrow.rotation>-this.targetAngle)this.arrowSpeed-=15,this.arrowSpeed<=0&&(this.arrowSpeed=5);else if(this.panel.arrow.rotation<=-this.targetAngle){var b=0;this.panel.arrow.rotation=-(this.targetAngle%360);for(var c=0;c<this.panel.angles.length;c++)if(this.panel.arrow.rotation==this.panel.angles[c]){b=c+1;break}app.sound.stop("spin_gen_spinTick");var d=[];this.auto?(this.spinning=!1,app.animator.play(this.panel.spinner["result"+b],"default"),d.push(this.panel.spinPrompts[Math.floor(3*Math.random())]),this.startTimeout(),createjs.Tween.get(this).call(function(){app.animator.play(this.panel.arrow,"pulse")}.bind(this)).wait(100).call(function(){this.panel.addArrowEvents(this.panel.arrow)}.bind(this))):(app.animator.play(this.panel.spinner["result"+b],"highlight"),d.push("spin_gen_spinDing"),d.push(this.gameNameAudio[b-1])),app.voPlayer.play(d,function(){this.auto||this.showWindow("result"+b),this.arrowTimer=0,this.arrowSpeed=60,this.arrowAngle=0,this.auto=!1}.bind(this)),app.off("update",this.arrowListener)}}else this.rotateArrow()},e.spinnerMechanics=function(){this.mechTimeout=new c(function(){var a=["hose","lights","pump"],b=Math.floor(Math.random()*a.length);app.animator.play(this.panel[a[b]],"activate",function(){app.state.spinnerMechanics()})}.bind(this),750)},e.scalePump=function(){var a=this.panel.pump.y;createjs.Tween.get(this.panel.pump).to({scaleX:.9,scaleY:.9},100).to({scaleX:1,scaleY:1},100),createjs.Tween.get(this.panel.pump).to({y:a+10},100).to({y:a},100)},e.scalePlatform=function(){var a=this.panel.nick.y,b=this.panel.sally.y;this.panel.platform.y;createjs.Tween.get(this.panel.nick).to({scaleX:.9,scaleY:.9},100).to({scaleX:1,scaleY:1},100),createjs.Tween.get(this.panel.sally).to({scaleX:.9,scaleY:.9},100).to({scaleX:1,scaleY:1},100),createjs.Tween.get(this.panel.platform).to({scaleX:.9,scaleY:.9},100).to({scaleX:1,scaleY:1},100),createjs.Tween.get(this.panel.nick).to({y:a+10},100).to({y:a},100),createjs.Tween.get(this.panel.sally).to({y:b+10},100).to({y:b},100)},e.exitStart=function(){this.timeout&&this.timeout.destroy()},namespace("CatSpinnerGame").GameState=d}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("CatSpinnerGame.IntroPanel"),c=function(c){a.call(this,new b,c)},d=extend(c,a);d.enterDone=function(){app.state=this,this.panel.cutsceneObject.start(this.nextState.bind(this))},d.exit=function(){},namespace("CatSpinnerGame").IntroState=c}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("CatSpinnerGame.TitlePanel"),c=function(c){a.call(this,new b,c),this.onPlay=this.onPlay.bind(this)},d=extend(c,a);d.enterDone=function(){app.state=this,app.voPlayer.play("spinmj-01-CAT-01"),this.panel.playButton.addEventListener("click",this.onPlay),this.panel.playButton.addEventListener("mouseover",function(){app.voPlayer.playing||app.voPlayer.play("spinmj-02-CAT-01")}.bind(this)),this.panel.background.addEventListener("click",this.onPlay),this.panel.background.cursor="pointer"},d.onPlay=function(){app.voPlayer.stop(),this.nextState()},d.exit=function(){this.panel.background.cursor=null,this.panel.background.removeEventListener("click",this.onPlay),this.panel.playButton.removeEventListener("click",this.onPlay)},namespace("CatSpinnerGame").TitleState=c}(),function(){var a=include("CatSpinnerGame.TitleState"),b=include("CatSpinnerGame.IntroState"),c=include("CatSpinnerGame.GameState"),d=include("springroll.Application"),e=include("lib.Transition"),f=include("createjs.Container"),g=include("createjs.Bitmap"),h=include("springroll.easeljs.EaselJSDisplay"),i=include("springroll.easeljs.SoundButton");!function(){var a=include("springroll.ApplicationPlugin"),b=new a(96);b.setup=function(){},b.preload=function(a){this.options.override("language",this.options.language||this.playOptions.language),a()},b.teardown=function(){}}();var j=function(){d.call(this,{fps:60,name:"CatSpinnerGame",state:"title",canvasId:"stage",configPath:"assets/config/config.json",languagesPath:"assets/config/languages.json",captionsPath:"assets/config/%LANG%/captions.json",transition:new e,transitionSounds:{"in":"",out:""},preload:[{src:"assets/images/_0000_Propellor_02.png",id:"_0000_Propellor_02",complete:l},{src:"assets/images/_0001_Propellor_01.png",id:"_0001_Propellor_01",complete:l},{src:"assets/images/_0002_MainBody.png",id:"_0002_MainBody",complete:l},{src:"assets/images/_0003_Propeller_Base_02.png",id:"_0003_Propeller_Base_02",complete:l},{src:"assets/images/_0004_Propeller_Base_01.png",id:"_0004_Propeller_Base_01",complete:l},{src:"assets/images/cloud.png",id:"cloud",complete:l},{src:"assets/images/paint_top_bar.png",id:"paint_top_bar",complete:l},{src:"assets/images/stickerLeftButton.png",id:"stickerLeftButton",complete:l},{src:"assets/images/stickerRightButton.png",id:"stickerRightButton",complete:l}],display:h,displayOptions:{clearView:!0,mouseOverRate:15},enableHiDPI:!0}),this.onResize=this.onResize.bind(this),this.once("configLoaded",m.bind(this)),this.once("init",n.bind(this)),this.onWindowUnload=this.onWindowUnload.bind(this),window.addEventListener("unload",this.onWindowUnload),this.resumeAudioContext=this.resumeAudioContext.bind(this),window.addEventListener("click",this.resumeAudioContext)},k=extend(j,d);k.onWindowUnload=function(){window.removeEventListener("unload",this.onWindowUnload),this.destroy()};var l=function(a,b){window.images[b.id]=a},m=function(a,b){this.triggerResize(),this.hasTouch||(b.push(this.config.assets.cursor[0]),b.push(this.config.assets.cursor[1]));for(var c=0;c<a.assets.feedback.length;c++)app.shuffle(a.assets.feedback[c].prompts);app.globalState=app.config.globalState,app.globalState.startTime=Date.now()},n=function(){this.cursor=null;var d=this.display,e=(d.canvas,this.options.transition=new lib.Transition);e.framerate=30,e.tmj.framerate=30,e.tmj.tmj_main.framerate=30,e.clouds.framerate=30,e.width=1320,e.height=780,e.nominalBounds=null,this.scaling.addItem(e,{x:-256,y:0,titleSafe:!0,align:"top-left"}),this.scaling.enabled=!0,this.on("resize",this.onResize,-1);var h=this.config.assets,j=this.config.scaling;this.manifests;lib_Game.ssMetadata[0].images=["assets/images/Game_atlas_.png"],ss.Game_atlas_=new createjs.SpriteSheet(lib_Game.ssMetadata[0]),lib_Game.ssMetadata[1].images=["assets/images/Game_atlas_2.png"],ss.Game_atlas_2=new createjs.SpriteSheet(lib_Game.ssMetadata[1]),lib_Game.ssMetadata[2].images=["assets/images/Game_atlas_3.png"],ss.Game_atlas_3=new createjs.SpriteSheet(lib_Game.ssMetadata[2]),lib_Seasons.ssMetadata[0].images=["assets/images/Seasons_atlas_.png"],ss.Seasons_atlas_=new createjs.SpriteSheet(lib_Seasons.ssMetadata[0]),lib_Sticker.ssMetadata[0].images=["assets/images/Sticker_atlas_.png"],ss.Sticker_atlas_=new createjs.SpriteSheet(lib_Sticker.ssMetadata[0]),lib_Sticker.ssMetadata[1].images=["assets/images/Sticker_atlas_2.png"],ss.Sticker_atlas_2=new createjs.SpriteSheet(lib_Sticker.ssMetadata[1]),lib_Building.ssMetadata[0].images=["assets/images/Building_atlas_.png"],ss.Building_atlas_=new createjs.SpriteSheet(lib_Building.ssMetadata[0]),lib_Popping.ssMetadata[0].images=["assets/images/Popping_atlas_.png"],ss.Popping_atlas_=new createjs.SpriteSheet(lib_Popping.ssMetadata[0]),lib_Squish.ssMetadata[0].images=["assets/images/Squish_atlas_.png"],ss.Squish_atlas_=new createjs.SpriteSheet(lib_Squish.ssMetadata[0]),lib_Squish.ssMetadata[1].images=["assets/images/Squish_atlas_2.png"],ss.Squish_atlas_2=new createjs.SpriteSheet(lib_Squish.ssMetadata[1]),lib_Quizzes.ssMetadata[0].images=["assets/images/Quizzes_atlas_.png"],ss.Quizzes_atlas_=new createjs.SpriteSheet(lib_Quizzes.ssMetadata[0]),lib_Quizzes.ssMetadata[1].images=["assets/images/Quizzes_atlas_2.png"],ss.Quizzes_atlas_2=new createjs.SpriteSheet(lib_Quizzes.ssMetadata[1]),lib_Quizzes.ssMetadata[2].images=["assets/images/Quizzes_atlas_3.png"],ss.Quizzes_atlas_3=new createjs.SpriteSheet(lib_Quizzes.ssMetadata[2]),lib_Coloring.ssMetadata[0].images=["assets/images/Coloring_atlas_.png"],ss.Coloring_atlas_=new createjs.SpriteSheet(lib_Coloring.ssMetadata[0]),lib_Coloring.ssMetadata[1].images=["assets/images/Coloring_atlas_2.png"],ss.Coloring_atlas_2=new createjs.SpriteSheet(lib_Coloring.ssMetadata[1]),lib_Coloring.ssMetadata[2].images=["assets/images/Coloring_atlas_3.png"],ss.Coloring_atlas_3=new createjs.SpriteSheet(lib_Coloring.ssMetadata[2]),lib_Coloring.ssMetadata[3].images=["assets/images/Coloring_atlas_4.png"],ss.Coloring_atlas_4=new createjs.SpriteSheet(lib_Coloring.ssMetadata[3]),lib_Coloring.ssMetadata[4].images=["assets/images/Coloring_atlas_5.png"],ss.Coloring_atlas_5=new createjs.SpriteSheet(lib_Coloring.ssMetadata[4]),lib_Coloring.ssMetadata[5].images=["assets/images/Coloring_atlas_6.png"],ss.Coloring_atlas_6=new createjs.SpriteSheet(lib_Coloring.ssMetadata[5]),lib_Wand.ssMetadata[0].images=["assets/images/Wand_atlas_.png"],ss.Wand_atlas_=new createjs.SpriteSheet(lib_Wand.ssMetadata[0]),this.states={title:new a({next:"game",preload:h.title,scaling:j.title}),intro:new b({next:"game",preload:h.intro,scaling:j.intro}),game:new c({next:"game",previous:"intro",preload:h.game,scaling:j.game})};var k=d.stage;this.colorMaskLeft=new f,app.scaling.addItem(this.colorMaskLeft,{x:10,y:5,align:"top-left"}),k.addChild(this.colorMaskLeft),this.colorMaskLeft.visible=!1,this.colorMaskRight=new f,app.scaling.addItem(this.colorMaskRight,{x:760,y:-30,align:"top-right"}),k.addChild(this.colorMaskRight),this.colorMaskRight.visible=!1,this.stickerLeft=new i(images.stickerLeftButton),app.scaling.addItem(this.stickerLeft,{x:0,y:350,align:"center-left"}),this.stickerLeft.visible=!1,k.addChild(this.stickerLeft),this.stickerRight=new i(images.stickerRightButton),app.scaling.addItem(this.stickerRight,{x:895,y:350,align:"center-right"}),this.stickerRight.visible=!1,k.addChild(this.stickerRight),this.backB=new lib_Game.backButton,app.scaling.addItem(this.backB,{x:75,y:120,align:"top-left"}),k.addChild(this.backB),this.cursor=new f,this.hasTouch||(k.addEventListener("mouseleave",this.stageOut.bind(this)),k.addEventListener("mouseenter",this.stageIn.bind(this)),k.addEventListener("stagemousemove",this.onMouseMove.bind(this)),k.addEventListener("changecursor",this.onCursorChange.bind(this)),this.display.canvas.style.cursor="none",this.cursorDefault=new g(app.assetManager.cache.read("CursorDefault")),this.cursor.addChild(this.cursorDefault),this.cursorPointer=new g(app.assetManager.cache.read("CursorOver")),this.cursor.addChild(this.cursorPointer),this.cursorPointer.visible=!1,this.cursorDefault.regX=0,this.cursorDefault.regY=0,this.cursorPointer.regX=0,this.cursorPointer.regY=0,k.addChild(this.cursor),this.currentDragged=this.currentDraggedOffset=null),this.tutorialCursor=new f;var l=new g(app.assetManager.cache.read("CursorDefault"));this.tutorialCursor.addChild(l),k.addChild(this.tutorialCursor),this.tutorialCursor.visible=!1,this.physicsInterface=new Box2DRendererInterface,this.physicsInterface.init(),this.physicsInterface.world.m_gravity.y=10,this.display.visible=!0};k.loadLanguage=function(a){app.globalState.language=a,this.sound.contextExists("vo")&&this.sound.unload(app.config.sounds.vo),app.globalState.language=a,app.config.sounds.vo.path="assets/sound/vo/"+app.globalState.language+"/",this.sound.addContext(app.config.sounds.vo)},k.onResize=function(a,b){var c=document.getElementById("container");c.scrollIntoViewIfNeeded&&c.scrollIntoViewIfNeeded(!0);try{this.backB.removeAllEventListeners(),app.state.panel.makeDynamic(this.backB),this.backB.on("click",function(){app.voPlayer.play("ButtonClick",function(){app.state.hideWindow()}.bind(this))}.bind(this))}catch(d){}},k.resumeAudioContext=function(){try{createjs.WebAudioPlugin.context&&"suspended"===createjs.WebAudioPlugin.context.state&&(createjs.WebAudioPlugin.context.resume(),window.removeEventListener("click",this.resumeAudioContext))}catch(a){}},k.stageIn=function(){this.cursor&&(this.cursor.visible=!0)},k.stageOut=function(){},k.onCursorChange=function(a){this.cursorPointer.visible="pointer"==a.cursor,this.cursorDefault.visible="pointer"!=a.cursor},k.onMouseMove=function(a){this._lastStageX=a.stageX,this._lastStageY=a.stageY,this.currentDragged||(this.cursor.x=a.stageX,this.cursor.y=a.stageY)},k.onQuitTap=function(){window.close()},k.destroy=function(){this.onWindowUnload=null,this.quitButton&&this.quitButton.removeEventListener("click",this.onQuitTap),this.quitButton=null,d.prototype.destroy.call(this)},window.app=new j}();