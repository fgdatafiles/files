this.createjs=this.createjs||{},createjs.extend=function(a,b){"use strict";function c(){this.constructor=a}return c.prototype=b.prototype,a.prototype=new c},this.createjs=this.createjs||{},createjs.promote=function(a,b){"use strict";var c=a.prototype,d=Object.getPrototypeOf&&Object.getPrototypeOf(c)||c.__proto__;if(d){c[(b+="_")+"constructor"]=d.constructor;for(var e in d)c.hasOwnProperty(e)&&"function"==typeof d[e]&&(c[b+e]=d[e])}return a},this.createjs=this.createjs||{},createjs.indexOf=function(a,b){"use strict";for(var c=0,d=a.length;d>c;c++)if(b===a[c])return c;return-1},this.createjs=this.createjs||{},function(){"use strict";function a(){throw"UID cannot be instantiated"}a._nextID=0,a.get=function(){return a._nextID++},createjs.UID=a}(),this.createjs=this.createjs||{},createjs.deprecate=function(a,b){"use strict";return function(){return console&&(console.warn,void 0),a&&a.apply(this,arguments)}},this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c){this.type=a,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!b,this.cancelable=!!c,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var b=a.prototype;b.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},b.stopPropagation=function(){this.propagationStopped=!0},b.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},b.remove=function(){this.removed=!0},b.clone=function(){return new a(this.type,this.bubbles,this.cancelable)},b.set=function(a){for(var b in a)this[b]=a[b];return this},b.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this._listeners=null,this._captureListeners=null}var b=a.prototype;a.initialize=function(a){a.addEventListener=b.addEventListener,a.on=b.on,a.removeEventListener=a.off=b.removeEventListener,a.removeAllEventListeners=b.removeAllEventListeners,a.hasEventListener=b.hasEventListener,a.dispatchEvent=b.dispatchEvent,a._dispatchEvent=b._dispatchEvent,a.willTrigger=b.willTrigger},b.addEventListener=function(a,b,c){var d;d=c?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var e=d[a];return e&&this.removeEventListener(a,b,c),e=d[a],e?e.push(b):d[a]=[b],b},b.on=function(a,b,c,d,e,f){return b.handleEvent&&(c=c||b,b=b.handleEvent),c=c||this,this.addEventListener(a,function(a){b.call(c,a,e),d&&a.remove()},f)},b.removeEventListener=function(a,b,c){var d=c?this._captureListeners:this._listeners;if(d){var e=d[a];if(e)for(var f=0,g=e.length;g>f;f++)if(e[f]==b){1==g?delete d[a]:e.splice(f,1);break}}},b.off=b.removeEventListener,b.removeAllEventListeners=function(a){a?(this._listeners&&delete this._listeners[a],this._captureListeners&&delete this._captureListeners[a]):this._listeners=this._captureListeners=null},b.dispatchEvent=function(a,b,c){if("string"==typeof a){var d=this._listeners;if(!(b||d&&d[a]))return!0;a=new createjs.Event(a,b,c)}else a.target&&a.clone&&(a=a.clone());try{a.target=this}catch(e){}if(a.bubbles&&this.parent){for(var f=this,g=[f];f.parent;)g.push(f=f.parent);var h,i=g.length;for(h=i-1;h>=0&&!a.propagationStopped;h--)g[h]._dispatchEvent(a,1+(0==h));for(h=1;i>h&&!a.propagationStopped;h++)g[h]._dispatchEvent(a,3)}else this._dispatchEvent(a,2);return!a.defaultPrevented},b.hasEventListener=function(a){var b=this._listeners,c=this._captureListeners;return!!(b&&b[a]||c&&c[a])},b.willTrigger=function(a){for(var b=this;b;){if(b.hasEventListener(a))return!0;b=b.parent}return!1},b.toString=function(){return"[EventDispatcher]"},b._dispatchEvent=function(a,b){var c,d,e=2>=b?this._captureListeners:this._listeners;if(a&&e&&(d=e[a.type])&&(c=d.length)){try{a.currentTarget=this}catch(f){}try{a.eventPhase=0|b}catch(f){}a.removed=!1,d=d.slice();for(var g=0;c>g&&!a.immediatePropagationStopped;g++){var h=d[g];h.handleEvent?h.handleEvent(a):h(a),a.removed&&(this.off(a.type,h,1==b),a.removed=!1)}}2===b&&this._dispatchEvent(a,2.1)},createjs.EventDispatcher=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(){throw"Ticker cannot be instantiated."}a.RAF_SYNCHED="synched",a.RAF="raf",a.TIMEOUT="timeout",a.timingMode=null,a.maxDelta=0,a.paused=!1,a.removeEventListener=null,a.removeAllEventListeners=null,a.dispatchEvent=null,a.hasEventListener=null,a._listeners=null,createjs.EventDispatcher.initialize(a),a._addEventListener=a.addEventListener,a.addEventListener=function(){return!a._inited&&a.init(),a._addEventListener.apply(a,arguments)},a._inited=!1,a._startTime=0,a._pausedTime=0,a._ticks=0,a._pausedTicks=0,a._interval=50,a._lastTime=0,a._times=null,a._tickTimes=null,a._timerId=null,a._raf=!0,a._setInterval=function(b){a._interval=b,a._inited&&a._setupTick()},a.setInterval=createjs.deprecate(a._setInterval,"Ticker.setInterval"),a._getInterval=function(){return a._interval},a.getInterval=createjs.deprecate(a._getInterval,"Ticker.getInterval"),a._setFPS=function(b){a._setInterval(1e3/b)},a.setFPS=createjs.deprecate(a._setFPS,"Ticker.setFPS"),a._getFPS=function(){return 1e3/a._interval},a.getFPS=createjs.deprecate(a._getFPS,"Ticker.getFPS");try{Object.defineProperties(a,{interval:{get:a._getInterval,set:a._setInterval},framerate:{get:a._getFPS,set:a._setFPS}})}catch(b){}a.init=function(){a._inited||(a._inited=!0,a._times=[],a._tickTimes=[],a._startTime=a._getTime(),a._times.push(a._lastTime=0),a.interval=a._interval)},a.reset=function(){if(a._raf){var b=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;b&&b(a._timerId)}else clearTimeout(a._timerId);a.removeAllEventListeners("tick"),a._timerId=a._times=a._tickTimes=null,a._startTime=a._lastTime=a._ticks=a._pausedTime=0,a._inited=!1},a.getMeasuredTickTime=function(b){var c=0,d=a._tickTimes;if(!d||d.length<1)return-1;b=Math.min(d.length,b||0|a._getFPS());for(var e=0;b>e;e++)c+=d[e];return c/b},a.getMeasuredFPS=function(b){var c=a._times;return!c||c.length<2?-1:(b=Math.min(c.length-1,b||0|a._getFPS()),1e3/((c[0]-c[b])/b))},a.getTime=function(b){return a._startTime?a._getTime()-(b?a._pausedTime:0):-1},a.getEventTime=function(b){return a._startTime?(a._lastTime||a._startTime)-(b?a._pausedTime:0):-1},a.getTicks=function(b){return a._ticks-(b?a._pausedTicks:0)},a._handleSynch=function(){a._timerId=null,a._setupTick(),a._getTime()-a._lastTime>=.97*(a._interval-1)&&a._tick()},a._handleRAF=function(){a._timerId=null,a._setupTick(),a._tick()},a._handleTimeout=function(){a._timerId=null,a._setupTick(),a._tick()},a._setupTick=function(){if(null==a._timerId){var b=a.timingMode;if(b==a.RAF_SYNCHED||b==a.RAF){var c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(c)return a._timerId=c(b==a.RAF?a._handleRAF:a._handleSynch),void(a._raf=!0)}a._raf=!1,a._timerId=setTimeout(a._handleTimeout,a._interval)}},a._tick=function(){var b=a.paused,c=a._getTime(),d=c-a._lastTime;if(a._lastTime=c,a._ticks++,b&&(a._pausedTicks++,a._pausedTime+=d),a.hasEventListener("tick")){var e=new createjs.Event("tick"),f=a.maxDelta;e.delta=f&&d>f?f:d,e.paused=b,e.time=c,e.runTime=c-a._pausedTime,a.dispatchEvent(e)}for(a._tickTimes.unshift(a._getTime()-c);a._tickTimes.length>100;)a._tickTimes.pop();for(a._times.unshift(c);a._times.length>100;)a._times.pop()};var c=window,d=c.performance.now||c.performance.mozNow||c.performance.msNow||c.performance.oNow||c.performance.webkitNow;a._getTime=function(){return(d&&d.call(c.performance)||(new Date).getTime())-a._startTime},createjs.Ticker=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.readyState=a.readyState,this._video=a,this._canvas=null,this._lastTime=-1,this.readyState<2&&a.addEventListener("canplaythrough",this._videoReady.bind(this))}var b=a.prototype;b.getImage=function(){if(!(this.readyState<2)){var a=this._canvas,b=this._video;if(a||(a=this._canvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),a.width=b.videoWidth,a.height=b.videoHeight),b.readyState>=2&&b.currentTime!==this._lastTime){var c=a.getContext("2d");c.clearRect(0,0,a.width,a.height),c.drawImage(b,0,0,a.width,a.height),this._lastTime=b.currentTime}return a}},b._videoReady=function(){this.readyState=2},createjs.VideoBuffer=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){this.Event_constructor(a,b,c),this.stageX=d,this.stageY=e,this.rawX=null==i?d:i,this.rawY=null==j?e:j,this.nativeEvent=f,this.pointerID=g,this.primary=!!h,this.relatedTarget=k}var b=createjs.extend(a,createjs.Event);b._get_localX=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x},b._get_localY=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y},b._get_isTouch=function(){return-1!==this.pointerID};try{Object.defineProperties(b,{localX:{get:b._get_localX},localY:{get:b._get_localY},isTouch:{get:b._get_isTouch}})}catch(c){}b.clone=function(){return new a(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)},b.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"},createjs.MouseEvent=createjs.promote(a,"Event")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c,d,e,f){this.setValues(a,b,c,d,e,f)}var b=a.prototype;a.DEG_TO_RAD=Math.PI/180,a.identity=null,b.setValues=function(a,b,c,d,e,f){return this.a=null==a?1:a,this.b=b||0,this.c=c||0,this.d=null==d?1:d,this.tx=e||0,this.ty=f||0,this},b.append=function(a,b,c,d,e,f){var g=this.a,h=this.b,i=this.c,j=this.d;return(1!=a||0!=b||0!=c||1!=d)&&(this.a=g*a+i*b,this.b=h*a+j*b,this.c=g*c+i*d,this.d=h*c+j*d),this.tx=g*e+i*f+this.tx,this.ty=h*e+j*f+this.ty,this},b.prepend=function(a,b,c,d,e,f){var g=this.a,h=this.c,i=this.tx;return this.a=a*g+c*this.b,this.b=b*g+d*this.b,this.c=a*h+c*this.d,this.d=b*h+d*this.d,this.tx=a*i+c*this.ty+e,this.ty=b*i+d*this.ty+f,this},b.appendMatrix=function(a){return this.append(a.a,a.b,a.c,a.d,a.tx,a.ty)},b.prependMatrix=function(a){return this.prepend(a.a,a.b,a.c,a.d,a.tx,a.ty)},b.appendTransform=function(b,c,d,e,f,g,h,i,j){if(f%360)var k=f*a.DEG_TO_RAD,l=Math.cos(k),m=Math.sin(k);else l=1,m=0;return g||h?(g*=a.DEG_TO_RAD,h*=a.DEG_TO_RAD,this.append(Math.cos(h),Math.sin(h),-Math.sin(g),Math.cos(g),b,c),this.append(l*d,m*d,-m*e,l*e,0,0)):this.append(l*d,m*d,-m*e,l*e,b,c),(i||j)&&(this.tx-=i*this.a+j*this.c,this.ty-=i*this.b+j*this.d),this},b.prependTransform=function(b,c,d,e,f,g,h,i,j){if(f%360)var k=f*a.DEG_TO_RAD,l=Math.cos(k),m=Math.sin(k);else l=1,m=0;return(i||j)&&(this.tx-=i,this.ty-=j),g||h?(g*=a.DEG_TO_RAD,h*=a.DEG_TO_RAD,this.prepend(l*d,m*d,-m*e,l*e,0,0),this.prepend(Math.cos(h),Math.sin(h),-Math.sin(g),Math.cos(g),b,c)):this.prepend(l*d,m*d,-m*e,l*e,b,c),this},b.rotate=function(b){b*=a.DEG_TO_RAD;var c=Math.cos(b),d=Math.sin(b),e=this.a,f=this.b;return this.a=e*c+this.c*d,this.b=f*c+this.d*d,this.c=-e*d+this.c*c,this.d=-f*d+this.d*c,this},b.skew=function(b,c){return b*=a.DEG_TO_RAD,c*=a.DEG_TO_RAD,this.append(Math.cos(c),Math.sin(c),-Math.sin(b),Math.cos(b),0,0),this},b.scale=function(a,b){return this.a*=a,this.b*=a,this.c*=b,this.d*=b,this},b.translate=function(a,b){return this.tx+=this.a*a+this.c*b,this.ty+=this.b*a+this.d*b,this},b.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},b.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},b.isIdentity=function(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d},b.equals=function(a){return this.tx===a.tx&&this.ty===a.ty&&this.a===a.a&&this.b===a.b&&this.c===a.c&&this.d===a.d},b.transformPoint=function(a,b,c){return c=c||{},c.x=a*this.a+b*this.c+this.tx,c.y=a*this.b+b*this.d+this.ty,c},b.decompose=function(b){null==b&&(b={}),b.x=this.tx,b.y=this.ty,b.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),b.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var c=Math.atan2(-this.c,this.d),d=Math.atan2(this.b,this.a),e=Math.abs(1-c/d);return 1e-5>e?(b.rotation=d/a.DEG_TO_RAD,this.a<0&&this.d>=0&&(b.rotation+=b.rotation<=0?180:-180),b.skewX=b.skewY=0):(b.skewX=c/a.DEG_TO_RAD,b.skewY=d/a.DEG_TO_RAD),b},b.copy=function(a){return this.setValues(a.a,a.b,a.c,a.d,a.tx,a.ty)},b.clone=function(){return new a(this.a,this.b,this.c,this.d,this.tx,this.ty)},b.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"},a.identity=new a,createjs.Matrix2D=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c,d,e){this.setValues(a,b,c,d,e)}var b=a.prototype;b.setValues=function(a,b,c,d,e){return this.visible=null==a?!0:!!a,this.alpha=null==b?1:b,this.shadow=c,this.compositeOperation=d,this.matrix=e||this.matrix&&this.matrix.identity()||new createjs.Matrix2D,this},b.append=function(a,b,c,d,e){return this.alpha*=b,this.shadow=c||this.shadow,this.compositeOperation=d||this.compositeOperation,this.visible=this.visible&&a,e&&this.matrix.appendMatrix(e),this},b.prepend=function(a,b,c,d,e){return this.alpha*=b,this.shadow=this.shadow||c,this.compositeOperation=this.compositeOperation||d,this.visible=this.visible&&a,e&&this.matrix.prependMatrix(e),this},b.identity=function(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this},b.clone=function(){return new a(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())},createjs.DisplayProps=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b){this.setValues(a,b)}var b=a.prototype;b.setValues=function(a,b){return this.x=a||0,this.y=b||0,this},b.copy=function(a){return this.x=a.x,this.y=a.y,this},b.clone=function(){return new a(this.x,this.y)},b.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},createjs.Point=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c,d){this.setValues(a,b,c,d)}var b=a.prototype;b.setValues=function(a,b,c,d){return this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this},b.extend=function(a,b,c,d){return c=c||0,d=d||0,a+c>this.x+this.width&&(this.width=a+c-this.x),b+d>this.y+this.height&&(this.height=b+d-this.y),a<this.x&&(this.width+=this.x-a,this.x=a),b<this.y&&(this.height+=this.y-b,this.y=b),this},b.pad=function(a,b,c,d){return this.x-=b,this.y-=a,this.width+=b+d,this.height+=a+c,this},b.copy=function(a){return this.setValues(a.x,a.y,a.width,a.height)},b.contains=function(a,b,c,d){return c=c||0,d=d||0,a>=this.x&&a+c<=this.x+this.width&&b>=this.y&&b+d<=this.y+this.height},b.union=function(a){return this.clone().extend(a.x,a.y,a.width,a.height)},b.intersection=function(b){var c=b.x,d=b.y,e=c+b.width,f=d+b.height;return this.x>c&&(c=this.x),this.y>d&&(d=this.y),this.x+this.width<e&&(e=this.x+this.width),this.y+this.height<f&&(f=this.y+this.height),c>=e||d>=f?null:new a(c,d,e-c,f-d)},b.intersects=function(a){return a.x<=this.x+this.width&&this.x<=a.x+a.width&&a.y<=this.y+this.height&&this.y<=a.y+a.height},b.isEmpty=function(){return this.width<=0||this.height<=0},b.clone=function(){return new a(this.x,this.y,this.width,this.height)},b.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},createjs.Rectangle=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c,d,e,f,g){a.addEventListener&&(this.target=a,this.overLabel=null==c?"over":c,this.outLabel=null==b?"out":b,this.downLabel=null==d?"down":d,this.play=e,this._isPressed=!1,this._isOver=!1,this._enabled=!1,a.mouseChildren=!1,this.enabled=!0,this.handleEvent({}),f&&(g&&(f.actionsEnabled=!1,f.gotoAndStop&&f.gotoAndStop(g)),a.hitArea=f))}var b=a.prototype;b._setEnabled=function(a){if(a!=this._enabled){var b=this.target;this._enabled=a,a?(b.cursor="pointer",b.addEventListener("rollover",this),b.addEventListener("rollout",this),b.addEventListener("mousedown",this),b.addEventListener("pressup",this),b._reset&&(b.__reset=b._reset,b._reset=this._reset)):(b.cursor=null,b.removeEventListener("rollover",this),b.removeEventListener("rollout",this),b.removeEventListener("mousedown",this),b.removeEventListener("pressup",this),b.__reset&&(b._reset=b.__reset,delete b.__reset))}},b.setEnabled=createjs.deprecate(b._setEnabled,"ButtonHelper.setEnabled"),b._getEnabled=function(){return this._enabled},b.getEnabled=createjs.deprecate(b._getEnabled,"ButtonHelper.getEnabled");try{Object.defineProperties(b,{enabled:{get:b._getEnabled,set:b._setEnabled}})}catch(c){}b.toString=function(){return"[ButtonHelper]"},b.handleEvent=function(a){var b,c=this.target,d=a.type;"mousedown"==d?(this._isPressed=!0,b=this.downLabel):"pressup"==d?(this._isPressed=!1,b=this._isOver?this.overLabel:this.outLabel):"rollover"==d?(this._isOver=!0,b=this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,b=this._isPressed?this.overLabel:this.outLabel),this.play?c.gotoAndPlay&&c.gotoAndPlay(b):c.gotoAndStop&&c.gotoAndStop(b)},b._reset=function(){var a=this.paused;this.__reset(),this.paused=a},createjs.ButtonHelper=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c,d){this.color=a||"black",this.offsetX=b||0,this.offsetY=c||0,this.blur=d||0}var b=a.prototype;a.identity=new a("transparent",0,0,0),b.toString=function(){return"[Shadow]"},b.clone=function(){return new a(this.color,this.offsetX,this.offsetY,this.blur)},createjs.Shadow=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.EventDispatcher_constructor(),this.complete=!0,this.framerate=0,this._animations=null,this._frames=null,this._images=null,this._data=null,this._loadCount=0,this._frameHeight=0,this._frameWidth=0,this._numFrames=0,this._regX=0,this._regY=0,this._spacing=0,this._margin=0,this._parseData(a)}var b=createjs.extend(a,createjs.EventDispatcher);b._getAnimations=function(){return this._animations.slice()},b.getAnimations=createjs.deprecate(b._getAnimations,"SpriteSheet.getAnimations");try{Object.defineProperties(b,{animations:{get:b._getAnimations}})}catch(c){}b.getNumFrames=function(a){if(null==a)return this._frames?this._frames.length:this._numFrames||0;var b=this._data[a];return null==b?0:b.frames.length},b.getAnimation=function(a){return this._data[a]},b.getFrame=function(a){var b;return this._frames&&(b=this._frames[a])?b:null},b.getFrameBounds=function(a,b){var c=this.getFrame(a);return c?(b||new createjs.Rectangle).setValues(-c.regX,-c.regY,c.rect.width,c.rect.height):null},b.toString=function(){return"[SpriteSheet]"},b.clone=function(){throw"SpriteSheet cannot be cloned."},b._parseData=function(a){var b,c,d,e;if(null!=a){if(this.framerate=a.framerate||0,a.images&&(c=a.images.length)>0)for(e=this._images=[],b=0;c>b;b++){var f=a.images[b];if("string"==typeof f){var g=f;f=document.createElement("img"),f.src=g}e.push(f),f.getContext||f.naturalWidth||(this._loadCount++,this.complete=!1,function(a,b){f.onload=function(){a._handleImageLoad(b)}}(this,g),function(a,b){f.onerror=function(){a._handleImageError(b)}}(this,g))}if(null==a.frames);else if(Array.isArray(a.frames))for(this._frames=[],e=a.frames,b=0,c=e.length;c>b;b++){var h=e[b];this._frames.push({image:this._images[h[4]?h[4]:0],rect:new createjs.Rectangle(h[0],h[1],h[2],h[3]),regX:h[5]||0,regY:h[6]||0})}else d=a.frames,this._frameWidth=d.width,this._frameHeight=d.height,this._regX=d.regX||0,this._regY=d.regY||0,this._spacing=d.spacing||0,this._margin=d.margin||0,this._numFrames=d.count,0==this._loadCount&&this._calculateFrames();if(this._animations=[],null!=(d=a.animations)){this._data={};var i;for(i in d){var j={name:i},k=d[i];if("number"==typeof k)e=j.frames=[k];else if(Array.isArray(k))if(1==k.length)j.frames=[k[0]];else for(j.speed=k[3],j.next=k[2],e=j.frames=[],b=k[0];b<=k[1];b++)e.push(b);else{j.speed=k.speed,j.next=k.next;var l=k.frames;e=j.frames="number"==typeof l?[l]:l.slice(0)}(j.next===!0||void 0===j.next)&&(j.next=i),(j.next===!1||e.length<2&&j.next==i)&&(j.next=null),j.speed||(j.speed=1),this._animations.push(i),this._data[i]=j}}}},b._handleImageLoad=function(){0==--this._loadCount&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))},b._handleImageError=function(a){var b=new createjs.Event("error");b.src=a,this.dispatchEvent(b),0==--this._loadCount&&this.dispatchEvent("complete")},b._calculateFrames=function(){if(!this._frames&&0!=this._frameWidth){this._frames=[];var a=this._numFrames||1e5,b=0,c=this._frameWidth,d=this._frameHeight,e=this._spacing,f=this._margin;a:for(var g=0,h=this._images;g<h.length;g++)for(var i=h[g],j=i.width||i.naturalWidth,k=i.height||i.naturalHeight,l=f;k-f-d>=l;){for(var m=f;j-f-c>=m;){if(b>=a)break a;b++,this._frames.push({image:i,rect:new createjs.Rectangle(m,l,c,d),regX:this._regX,regY:this._regY}),m+=c+e}l+=d+e}this._numFrames=b}},createjs.SpriteSheet=createjs.promote(a,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this.command=null,this._stroke=null,this._strokeStyle=null,this._oldStrokeStyle=null,this._strokeDash=null,this._oldStrokeDash=null,this._strokeIgnoreScale=!1,this._fill=null,this._instructions=[],this._commitIndex=0,this._activeInstructions=[],this._dirty=!1,this._storeIndex=0,this.clear()}var b=a.prototype,c=a;a.getRGB=function(a,b,c,d){return null!=a&&null==c&&(d=b,c=255&a,b=a>>8&255,a=a>>16&255),null==d?"rgb("+a+","+b+","+c+")":"rgba("+a+","+b+","+c+","+d+")"},a.getHSL=function(a,b,c,d){return null==d?"hsl("+a%360+","+b+"%,"+c+"%)":"hsla("+a%360+","+b+"%,"+c+"%,"+d+")"},a.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},a.STROKE_CAPS_MAP=["butt","round","square"],a.STROKE_JOINTS_MAP=["miter","round","bevel"];var d=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");d.getContext&&(a._ctx=d.getContext("2d"),d.width=d.height=1),b._getInstructions=function(){return this._updateInstructions(),this._instructions},b.getInstructions=createjs.deprecate(b._getInstructions,"Graphics.getInstructions");try{Object.defineProperties(b,{instructions:{get:b._getInstructions}})}catch(e){}b.isEmpty=function(){return!(this._instructions.length||this._activeInstructions.length)},b.draw=function(a,b){this._updateInstructions();for(var c=this._instructions,d=this._storeIndex,e=c.length;e>d;d++)c[d].exec(a,b)},b.drawAsPath=function(a){this._updateInstructions();for(var b,c=this._instructions,d=this._storeIndex,e=c.length;e>d;d++)(b=c[d]).path!==!1&&b.exec(a)},b.moveTo=function(a,b){return this.append(new c.MoveTo(a,b),!0)},b.lineTo=function(a,b){return this.append(new c.LineTo(a,b))},b.arcTo=function(a,b,d,e,f){return this.append(new c.ArcTo(a,b,d,e,f))},b.arc=function(a,b,d,e,f,g){return this.append(new c.Arc(a,b,d,e,f,g))},b.quadraticCurveTo=function(a,b,d,e){return this.append(new c.QuadraticCurveTo(a,b,d,e))},b.bezierCurveTo=function(a,b,d,e,f,g){return this.append(new c.BezierCurveTo(a,b,d,e,f,g))},b.rect=function(a,b,d,e){return this.append(new c.Rect(a,b,d,e))},b.closePath=function(){return this._activeInstructions.length?this.append(new c.ClosePath):this},b.clear=function(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._oldStrokeStyle=this._stroke=this._fill=this._strokeDash=this._oldStrokeDash=null,this._dirty=this._strokeIgnoreScale=!1,this},b.beginFill=function(a){return this._setFill(a?new c.Fill(a):null)},b.beginLinearGradientFill=function(a,b,d,e,f,g){return this._setFill((new c.Fill).linearGradient(a,b,d,e,f,g))},b.beginRadialGradientFill=function(a,b,d,e,f,g,h,i){return this._setFill((new c.Fill).radialGradient(a,b,d,e,f,g,h,i))},b.beginBitmapFill=function(a,b,d){return this._setFill(new c.Fill(null,d).bitmap(a,b))},b.endFill=function(){return this.beginFill()},b.setStrokeStyle=function(a,b,d,e,f){return this._updateInstructions(!0),this._strokeStyle=this.command=new c.StrokeStyle(a,b,d,e,f),this._stroke&&(this._stroke.ignoreScale=f),this._strokeIgnoreScale=f,this},b.setStrokeDash=function(a,b){return this._updateInstructions(!0),this._strokeDash=this.command=new c.StrokeDash(a,b),this},b.beginStroke=function(a){return this._setStroke(a?new c.Stroke(a):null)},b.beginLinearGradientStroke=function(a,b,d,e,f,g){return this._setStroke((new c.Stroke).linearGradient(a,b,d,e,f,g))},b.beginRadialGradientStroke=function(a,b,d,e,f,g,h,i){return this._setStroke((new c.Stroke).radialGradient(a,b,d,e,f,g,h,i))},b.beginBitmapStroke=function(a,b){return this._setStroke((new c.Stroke).bitmap(a,b))},b.endStroke=function(){return this.beginStroke()},b.curveTo=b.quadraticCurveTo,b.drawRect=b.rect,b.drawRoundRect=function(a,b,c,d,e){return this.drawRoundRectComplex(a,b,c,d,e,e,e,e)},b.drawRoundRectComplex=function(a,b,d,e,f,g,h,i){return this.append(new c.RoundRect(a,b,d,e,f,g,h,i))},b.drawCircle=function(a,b,d){return this.append(new c.Circle(a,b,d))},b.drawEllipse=function(a,b,d,e){return this.append(new c.Ellipse(a,b,d,e))},b.drawPolyStar=function(a,b,d,e,f,g){return this.append(new c.PolyStar(a,b,d,e,f,g))},b.append=function(a,b){return this._activeInstructions.push(a),this.command=a,b||(this._dirty=!0),this},b.decodePath=function(b){for(var c=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],d=[2,2,4,6,0],e=0,f=b.length,g=[],h=0,i=0,j=a.BASE_64;f>e;){var k=b.charAt(e),l=j[k],m=l>>3,n=c[m];if(!n||3&l)throw"bad path data (@"+e+"): "+k;var o=d[m];m||(h=i=0),g.length=0,e++;for(var p=(l>>2&1)+2,q=0;o>q;q++){var r=j[b.charAt(e)],s=r>>5?-1:1;r=(31&r)<<6|j[b.charAt(e+1)],3==p&&(r=r<<6|j[b.charAt(e+2)]),r=s*r/10,q%2?h=r+=h:i=r+=i,g[q]=r,e+=p}n.apply(this,g)}return this},b.store=function(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this},b.unstore=function(){return this._storeIndex=0,this},b.clone=function(){var b=new a;return b.command=this.command,b._stroke=this._stroke,b._strokeStyle=this._strokeStyle,b._strokeDash=this._strokeDash,b._strokeIgnoreScale=this._strokeIgnoreScale,b._fill=this._fill,b._instructions=this._instructions.slice(),b._commitIndex=this._commitIndex,b._activeInstructions=this._activeInstructions.slice(),b._dirty=this._dirty,b._storeIndex=this._storeIndex,b},b.toString=function(){return"[Graphics]"},b.mt=b.moveTo,b.lt=b.lineTo,b.at=b.arcTo,b.bt=b.bezierCurveTo,b.qt=b.quadraticCurveTo,b.a=b.arc,b.r=b.rect,b.cp=b.closePath,b.c=b.clear,b.f=b.beginFill,b.lf=b.beginLinearGradientFill,b.rf=b.beginRadialGradientFill,b.bf=b.beginBitmapFill,b.ef=b.endFill,b.ss=b.setStrokeStyle,b.sd=b.setStrokeDash,b.s=b.beginStroke,b.ls=b.beginLinearGradientStroke,b.rs=b.beginRadialGradientStroke,b.bs=b.beginBitmapStroke,b.es=b.endStroke,b.dr=b.drawRect,b.rr=b.drawRoundRect,b.rc=b.drawRoundRectComplex,b.dc=b.drawCircle,b.de=b.drawEllipse,b.dp=b.drawPolyStar,b.p=b.decodePath,b._updateInstructions=function(b){var c=this._instructions,d=this._activeInstructions,e=this._commitIndex;if(this._dirty&&d.length){c.length=e,c.push(a.beginCmd);var f=d.length,g=c.length;c.length=g+f;for(var h=0;f>h;h++)c[h+g]=d[h];this._fill&&c.push(this._fill),this._stroke&&(this._strokeDash!==this._oldStrokeDash&&c.push(this._strokeDash),this._strokeStyle!==this._oldStrokeStyle&&c.push(this._strokeStyle),b&&(this._oldStrokeStyle=this._strokeStyle,this._oldStrokeDash=this._strokeDash),c.push(this._stroke)),this._dirty=!1}b&&(d.length=0,this._commitIndex=c.length)},b._setFill=function(a){return this._updateInstructions(!0),this.command=this._fill=a,this},b._setStroke=function(a){return this._updateInstructions(!0),(this.command=this._stroke=a)&&(a.ignoreScale=this._strokeIgnoreScale),this},(c.LineTo=function(a,b){this.x=a,this.y=b}).prototype.exec=function(a){a.lineTo(this.x,this.y)},(c.MoveTo=function(a,b){this.x=a,this.y=b}).prototype.exec=function(a){a.moveTo(this.x,this.y)},(c.ArcTo=function(a,b,c,d,e){this.x1=a,this.y1=b,this.x2=c,this.y2=d,this.radius=e}).prototype.exec=function(a){a.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)},(c.Arc=function(a,b,c,d,e,f){this.x=a,this.y=b,this.radius=c,this.startAngle=d,this.endAngle=e,this.anticlockwise=!!f}).prototype.exec=function(a){a.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},(c.QuadraticCurveTo=function(a,b,c,d){this.cpx=a,this.cpy=b,this.x=c,this.y=d}).prototype.exec=function(a){a.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)},(c.BezierCurveTo=function(a,b,c,d,e,f){this.cp1x=a,this.cp1y=b,this.cp2x=c,this.cp2y=d,this.x=e,this.y=f}).prototype.exec=function(a){a.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)},(c.Rect=function(a,b,c,d){this.x=a,this.y=b,this.w=c,this.h=d}).prototype.exec=function(a){a.rect(this.x,this.y,this.w,this.h)},(c.ClosePath=function(){}).prototype.exec=function(a){a.closePath()},(c.BeginPath=function(){}).prototype.exec=function(a){a.beginPath()},b=(c.Fill=function(a,b){this.style=a,this.matrix=b}).prototype,b.exec=function(a){if(this.style){a.fillStyle=this.style;var b=this.matrix;b&&(a.save(),a.transform(b.a,b.b,b.c,b.d,b.tx,b.ty)),a.fill(),b&&a.restore()}},b.linearGradient=function(b,c,d,e,f,g){for(var h=this.style=a._ctx.createLinearGradient(d,e,f,g),i=0,j=b.length;j>i;i++)h.addColorStop(c[i],b[i]);return h.props={colors:b,ratios:c,x0:d,y0:e,x1:f,y1:g,type:"linear"},this},b.radialGradient=function(b,c,d,e,f,g,h,i){for(var j=this.style=a._ctx.createRadialGradient(d,e,f,g,h,i),k=0,l=b.length;l>k;k++)j.addColorStop(c[k],b[k]);return j.props={colors:b,ratios:c,x0:d,y0:e,r0:f,x1:g,y1:h,r1:i,type:"radial"},this},b.bitmap=function(b,c){if(b.naturalWidth||b.getContext||b.readyState>=2){var d=this.style=a._ctx.createPattern(b,c||"");d.props={image:b,repetition:c,type:"bitmap"}}return this},b.path=!1,b=(c.Stroke=function(a,b){this.style=a,this.ignoreScale=b}).prototype,b.exec=function(a){this.style&&(a.strokeStyle=this.style,this.ignoreScale&&(a.save(),a.setTransform(1,0,0,1,0,0)),a.stroke(),this.ignoreScale&&a.restore())},b.linearGradient=c.Fill.prototype.linearGradient,b.radialGradient=c.Fill.prototype.radialGradient,b.bitmap=c.Fill.prototype.bitmap,b.path=!1,b=(c.StrokeStyle=function(a,b,c,d,e){this.width=a,this.caps=b,this.joints=c,this.miterLimit=d,this.ignoreScale=e}).prototype,b.exec=function(b){b.lineWidth=null==this.width?"1":this.width,b.lineCap=null==this.caps?"butt":isNaN(this.caps)?this.caps:a.STROKE_CAPS_MAP[this.caps],b.lineJoin=null==this.joints?"miter":isNaN(this.joints)?this.joints:a.STROKE_JOINTS_MAP[this.joints],b.miterLimit=null==this.miterLimit?"10":this.miterLimit,b.ignoreScale=null==this.ignoreScale?!1:this.ignoreScale},b.path=!1,(c.StrokeDash=function(a,b){this.segments=a,this.offset=b||0}).prototype.exec=function(a){a.setLineDash&&(a.setLineDash(this.segments||c.StrokeDash.EMPTY_SEGMENTS),a.lineDashOffset=this.offset||0)},c.StrokeDash.EMPTY_SEGMENTS=[],(c.RoundRect=function(a,b,c,d,e,f,g,h){this.x=a,this.y=b,this.w=c,this.h=d,this.radiusTL=e,this.radiusTR=f,this.radiusBR=g,this.radiusBL=h}).prototype.exec=function(a){var b=(j>i?i:j)/2,c=0,d=0,e=0,f=0,g=this.x,h=this.y,i=this.w,j=this.h,k=this.radiusTL,l=this.radiusTR,m=this.radiusBR,n=this.radiusBL;0>k&&(k*=c=-1),k>b&&(k=b),0>l&&(l*=d=-1),l>b&&(l=b),0>m&&(m*=e=-1),m>b&&(m=b),0>n&&(n*=f=-1),n>b&&(n=b),a.moveTo(g+i-l,h),a.arcTo(g+i+l*d,h-l*d,g+i,h+l,l),a.lineTo(g+i,h+j-m),a.arcTo(g+i+m*e,h+j+m*e,g+i-m,h+j,m),a.lineTo(g+n,h+j),a.arcTo(g-n*f,h+j+n*f,g,h+j-n,n),a.lineTo(g,h+k),a.arcTo(g-k*c,h-k*c,g+k,h,k),a.closePath()},(c.Circle=function(a,b,c){
this.x=a,this.y=b,this.radius=c}).prototype.exec=function(a){a.arc(this.x,this.y,this.radius,0,2*Math.PI)},(c.Ellipse=function(a,b,c,d){this.x=a,this.y=b,this.w=c,this.h=d}).prototype.exec=function(a){var b=this.x,c=this.y,d=this.w,e=this.h,f=.5522848,g=d/2*f,h=e/2*f,i=b+d,j=c+e,k=b+d/2,l=c+e/2;a.moveTo(b,l),a.bezierCurveTo(b,l-h,k-g,c,k,c),a.bezierCurveTo(k+g,c,i,l-h,i,l),a.bezierCurveTo(i,l+h,k+g,j,k,j),a.bezierCurveTo(k-g,j,b,l+h,b,l)},(c.PolyStar=function(a,b,c,d,e,f){this.x=a,this.y=b,this.radius=c,this.sides=d,this.pointSize=e,this.angle=f}).prototype.exec=function(a){var b=this.x,c=this.y,d=this.radius,e=(this.angle||0)/180*Math.PI,f=this.sides,g=1-(this.pointSize||0),h=Math.PI/f;a.moveTo(b+Math.cos(e)*d,c+Math.sin(e)*d);for(var i=0;f>i;i++)e+=h,1!=g&&a.lineTo(b+Math.cos(e)*d*g,c+Math.sin(e)*d*g),e+=h,a.lineTo(b+Math.cos(e)*d,c+Math.sin(e)*d);a.closePath()},a.beginCmd=new c.BeginPath,createjs.Graphics=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this.EventDispatcher_constructor(),this.alpha=1,this.cacheCanvas=null,this.bitmapCache=null,this.id=createjs.UID.get(),this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.mask=null,this.hitArea=null,this.cursor=null,this._props=new createjs.DisplayProps,this._rectangle=new createjs.Rectangle,this._bounds=null,this._webGLRenderStyle=a._StageGL_NONE}var b=createjs.extend(a,createjs.EventDispatcher);a._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],a.suppressCrossDomainErrors=!1,a._snapToPixelEnabled=!1,a._StageGL_NONE=0,a._StageGL_SPRITE=1,a._StageGL_BITMAP=2;var c=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");c.getContext&&(a._hitTestCanvas=c,a._hitTestContext=c.getContext("2d"),c.width=c.height=1),b._getStage=function(){for(var a=this,b=createjs.Stage;a.parent;)a=a.parent;return a instanceof b?a:null},b.getStage=createjs.deprecate(b._getStage,"DisplayObject.getStage");try{Object.defineProperties(b,{stage:{get:b._getStage},cacheID:{get:function(){return this.bitmapCache&&this.bitmapCache.cacheID},set:function(a){this.bitmapCache&&(this.bitmapCache.cacheID=a)}},scale:{get:function(){return this.scaleX},set:function(a){this.scaleX=this.scaleY=a}}})}catch(d){}b.isVisible=function(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)},b.draw=function(a,b){var c=this.bitmapCache;return c&&!b?c.draw(a):!1},b.updateContext=function(b){var c=this,d=c.mask,e=c._props.matrix;d&&d.graphics&&!d.graphics.isEmpty()&&(d.getMatrix(e),b.transform(e.a,e.b,e.c,e.d,e.tx,e.ty),d.graphics.drawAsPath(b),b.clip(),e.invert(),b.transform(e.a,e.b,e.c,e.d,e.tx,e.ty)),this.getMatrix(e);var f=e.tx,g=e.ty;a._snapToPixelEnabled&&c.snapToPixel&&(f=f+(0>f?-.5:.5)|0,g=g+(0>g?-.5:.5)|0),b.transform(e.a,e.b,e.c,e.d,f,g),b.globalAlpha*=c.alpha,c.compositeOperation&&(b.globalCompositeOperation=c.compositeOperation),c.shadow&&this._applyShadow(b,c.shadow)},b.cache=function(a,b,c,d,e,f){this.bitmapCache||(this.bitmapCache=new createjs.BitmapCache),this.bitmapCache.define(this,a,b,c,d,e,f)},b.updateCache=function(a){if(!this.bitmapCache)throw"cache() must be called before updateCache()";this.bitmapCache.update(a)},b.uncache=function(){this.bitmapCache&&(this.bitmapCache.release(),this.bitmapCache=void 0)},b.getCacheDataURL=function(){return this.bitmapCache?this.bitmapCache.getDataURL():null},b.localToGlobal=function(a,b,c){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(a,b,c||new createjs.Point)},b.globalToLocal=function(a,b,c){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(a,b,c||new createjs.Point)},b.localToLocal=function(a,b,c,d){return d=this.localToGlobal(a,b,d),c.globalToLocal(d.x,d.y,d)},b.setTransform=function(a,b,c,d,e,f,g,h,i){return this.x=a||0,this.y=b||0,this.scaleX=null==c?1:c,this.scaleY=null==d?1:d,this.rotation=e||0,this.skewX=f||0,this.skewY=g||0,this.regX=h||0,this.regY=i||0,this},b.getMatrix=function(a){var b=this,c=a&&a.identity()||new createjs.Matrix2D;return b.transformMatrix?c.copy(b.transformMatrix):c.appendTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY)},b.getConcatenatedMatrix=function(a){for(var b=this,c=this.getMatrix(a);b=b.parent;)c.prependMatrix(b.getMatrix(b._props.matrix));return c},b.getConcatenatedDisplayProps=function(a){a=a?a.identity():new createjs.DisplayProps;var b=this,c=b.getMatrix(a.matrix);do a.prepend(b.visible,b.alpha,b.shadow,b.compositeOperation),b!=this&&c.prependMatrix(b.getMatrix(b._props.matrix));while(b=b.parent);return a},b.hitTest=function(b,c){var d=a._hitTestContext;d.setTransform(1,0,0,1,-b,-c),this.draw(d);var e=this._testHit(d);return d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,2,2),e},b.set=function(a){for(var b in a)this[b]=a[b];return this},b.getBounds=function(){if(this._bounds)return this._rectangle.copy(this._bounds);var a=this.cacheCanvas;if(a){var b=this._cacheScale;return this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,a.width/b,a.height/b)}return null},b.getTransformedBounds=function(){return this._getBounds()},b.setBounds=function(a,b,c,d){return null==a?void(this._bounds=a):void(this._bounds=(this._bounds||new createjs.Rectangle).setValues(a,b,c,d))},b.clone=function(){return this._cloneProps(new a)},b.toString=function(){return"[DisplayObject (name="+this.name+")]"},b._updateState=null,b._cloneProps=function(a){return a.alpha=this.alpha,a.mouseEnabled=this.mouseEnabled,a.tickEnabled=this.tickEnabled,a.name=this.name,a.regX=this.regX,a.regY=this.regY,a.rotation=this.rotation,a.scaleX=this.scaleX,a.scaleY=this.scaleY,a.shadow=this.shadow,a.skewX=this.skewX,a.skewY=this.skewY,a.visible=this.visible,a.x=this.x,a.y=this.y,a.compositeOperation=this.compositeOperation,a.snapToPixel=this.snapToPixel,a.filters=null==this.filters?null:this.filters.slice(0),a.mask=this.mask,a.hitArea=this.hitArea,a.cursor=this.cursor,a._bounds=this._bounds,a},b._applyShadow=function(a,b){b=b||Shadow.identity,a.shadowColor=b.color,a.shadowOffsetX=b.offsetX,a.shadowOffsetY=b.offsetY,a.shadowBlur=b.blur},b._tick=function(a){var b=this._listeners;b&&b.tick&&(a.target=null,a.propagationStopped=a.immediatePropagationStopped=!1,this.dispatchEvent(a))},b._testHit=function(b){try{var c=b.getImageData(0,0,1,1).data[3]>1}catch(d){if(!a.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."}return c},b._getBounds=function(a,b){return this._transformBounds(this.getBounds(),a,b)},b._transformBounds=function(a,b,c){if(!a)return a;var d=a.x,e=a.y,f=a.width,g=a.height,h=this._props.matrix;h=c?h.identity():this.getMatrix(h),(d||e)&&h.appendTransform(0,0,1,1,0,0,0,-d,-e),b&&h.prependMatrix(b);var i=f*h.a,j=f*h.b,k=g*h.c,l=g*h.d,m=h.tx,n=h.ty,o=m,p=m,q=n,r=n;return(d=i+m)<o?o=d:d>p&&(p=d),(d=i+k+m)<o?o=d:d>p&&(p=d),(d=k+m)<o?o=d:d>p&&(p=d),(e=j+n)<q?q=e:e>r&&(r=e),(e=j+l+n)<q?q=e:e>r&&(r=e),(e=l+n)<q?q=e:e>r&&(r=e),a.setValues(o,q,p-o,r-q)},b._hasMouseEventListener=function(){for(var b=a._MOUSE_EVENTS,c=0,d=b.length;d>c;c++)if(this.hasEventListener(b[c]))return!0;return!!this.cursor},createjs.DisplayObject=createjs.promote(a,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this.DisplayObject_constructor(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0}var b=createjs.extend(a,createjs.DisplayObject);b._getNumChildren=function(){return this.children.length},b.getNumChildren=createjs.deprecate(b._getNumChildren,"Container.getNumChildren");try{Object.defineProperties(b,{numChildren:{get:b._getNumChildren}})}catch(c){}b.initialize=a,b.isVisible=function(){var a=this.cacheCanvas||this.children.length;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&a)},b.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;for(var c=this.children.slice(),d=0,e=c.length;e>d;d++){var f=c[d];f.isVisible()&&(a.save(),f.updateContext(a),f.draw(a),a.restore())}return!0},b.addChild=function(a){if(null==a)return a;var b=arguments.length;if(b>1){for(var c=0;b>c;c++)this.addChild(arguments[c]);return arguments[b-1]}var d=a.parent,e=d===this;return d&&d._removeChildAt(createjs.indexOf(d.children,a),e),a.parent=this,this.children.push(a),e||a.dispatchEvent("added"),a},b.addChildAt=function(a,b){var c=arguments.length,d=arguments[c-1];if(0>d||d>this.children.length)return arguments[c-2];if(c>2){for(var e=0;c-1>e;e++)this.addChildAt(arguments[e],d+e);return arguments[c-2]}var f=a.parent,g=f===this;return f&&f._removeChildAt(createjs.indexOf(f.children,a),g),a.parent=this,this.children.splice(b,0,a),g||a.dispatchEvent("added"),a},b.removeChild=function(a){var b=arguments.length;if(b>1){for(var c=!0,d=0;b>d;d++)c=c&&this.removeChild(arguments[d]);return c}return this._removeChildAt(createjs.indexOf(this.children,a))},b.removeChildAt=function(a){var b=arguments.length;if(b>1){for(var c=[],d=0;b>d;d++)c[d]=arguments[d];c.sort(function(a,b){return b-a});for(var e=!0,d=0;b>d;d++)e=e&&this._removeChildAt(c[d]);return e}return this._removeChildAt(a)},b.removeAllChildren=function(){for(var a=this.children;a.length;)this._removeChildAt(0)},b.getChildAt=function(a){return this.children[a]},b.getChildByName=function(a){for(var b=this.children,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},b.sortChildren=function(a){this.children.sort(a)},b.getChildIndex=function(a){return createjs.indexOf(this.children,a)},b.swapChildrenAt=function(a,b){var c=this.children,d=c[a],e=c[b];d&&e&&(c[a]=e,c[b]=d)},b.swapChildren=function(a,b){for(var c,d,e=this.children,f=0,g=e.length;g>f&&(e[f]==a&&(c=f),e[f]==b&&(d=f),null==c||null==d);f++);f!=g&&(e[c]=b,e[d]=a)},b.setChildIndex=function(a,b){var c=this.children,d=c.length;if(!(a.parent!=this||0>b||b>=d)){for(var e=0;d>e&&c[e]!=a;e++);e!=d&&e!=b&&(c.splice(e,1),c.splice(b,0,a))}},b.contains=function(a){for(;a;){if(a==this)return!0;a=a.parent}return!1},b.hitTest=function(a,b){return null!=this.getObjectUnderPoint(a,b)},b.getObjectsUnderPoint=function(a,b,c){var d=[],e=this.localToGlobal(a,b);return this._getObjectsUnderPoint(e.x,e.y,d,c>0,1==c),d},b.getObjectUnderPoint=function(a,b,c){var d=this.localToGlobal(a,b);return this._getObjectsUnderPoint(d.x,d.y,null,c>0,1==c)},b.getBounds=function(){return this._getBounds(null,!0)},b.getTransformedBounds=function(){return this._getBounds()},b.clone=function(b){var c=this._cloneProps(new a);return b&&this._cloneChildren(c),c},b.toString=function(){return"[Container (name="+this.name+")]"},b._tick=function(a){if(this.tickChildren)for(var b=this.children.length-1;b>=0;b--){var c=this.children[b];c.tickEnabled&&c._tick&&c._tick(a)}this.DisplayObject__tick(a)},b._cloneChildren=function(a){a.children.length&&a.removeAllChildren();for(var b=a.children,c=0,d=this.children.length;d>c;c++){var e=this.children[c].clone(!0);e.parent=a,b.push(e)}},b._removeChildAt=function(a,b){if(0>a||a>this.children.length-1)return!1;var c=this.children[a];return c&&(c.parent=null),this.children.splice(a,1),b||c.dispatchEvent("removed"),!0},b._getObjectsUnderPoint=function(b,c,d,e,f,g){if(g=g||0,!g&&!this._testMask(this,b,c))return null;var h,i=createjs.DisplayObject._hitTestContext;f=f||e&&this._hasMouseEventListener();for(var j=this.children,k=j.length,l=k-1;l>=0;l--){var m=j[l],n=m.hitArea;if(m.visible&&(n||m.isVisible())&&(!e||m.mouseEnabled)&&(n||this._testMask(m,b,c)))if(!n&&m instanceof a){var o=m._getObjectsUnderPoint(b,c,d,e,f,g+1);if(!d&&o)return e&&!this.mouseChildren?this:o}else{if(e&&!f&&!m._hasMouseEventListener())continue;var p=m.getConcatenatedDisplayProps(m._props);if(h=p.matrix,n&&(h.appendMatrix(n.getMatrix(n._props.matrix)),p.alpha=n.alpha),i.globalAlpha=p.alpha,i.setTransform(h.a,h.b,h.c,h.d,h.tx-b,h.ty-c),(n||m).draw(i),!this._testHit(i))continue;if(i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,2,2),!d)return e&&!this.mouseChildren?this:m;d.push(m)}}return null},b._testMask=function(a,b,c){var d=a.mask;if(!d||!d.graphics||d.graphics.isEmpty())return!0;var e=this._props.matrix,f=a.parent;e=f?f.getConcatenatedMatrix(e):e.identity(),e=d.getMatrix(d._props.matrix).prependMatrix(e);var g=createjs.DisplayObject._hitTestContext;return g.setTransform(e.a,e.b,e.c,e.d,e.tx-b,e.ty-c),d.graphics.drawAsPath(g),g.fillStyle="#000",g.fill(),this._testHit(g)?(g.setTransform(1,0,0,1,0,0),g.clearRect(0,0,2,2),!0):!1},b._getBounds=function(a,b){var c=this.DisplayObject_getBounds();if(c)return this._transformBounds(c,a,b);var d=this._props.matrix;d=b?d.identity():this.getMatrix(d),a&&d.prependMatrix(a);for(var e=this.children.length,f=null,g=0;e>g;g++){var h=this.children[g];h.visible&&(c=h._getBounds(d))&&(f?f.extend(c.x,c.y,c.width,c.height):f=c.clone())}return f},createjs.Container=createjs.promote(a,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.Container_constructor(),this.autoClear=!0,this.canvas="string"==typeof a?document.getElementById(a):a,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}var b=createjs.extend(a,createjs.Container);b._get_nextStage=function(){return this._nextStage},b._set_nextStage=function(a){this._nextStage&&(this._nextStage._prevStage=null),a&&(a._prevStage=this),this._nextStage=a};try{Object.defineProperties(b,{nextStage:{get:b._get_nextStage,set:b._set_nextStage}})}catch(c){}b.update=function(a){if(this.canvas&&(this.tickOnUpdate&&this.tick(a),this.dispatchEvent("drawstart",!1,!0)!==!1)){createjs.DisplayObject._snapToPixelEnabled=this.snapToPixelEnabled;var b=this.drawRect,c=this.canvas.getContext("2d");c.setTransform(1,0,0,1,0,0),this.autoClear&&(b?c.clearRect(b.x,b.y,b.width,b.height):c.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),c.save(),this.drawRect&&(c.beginPath(),c.rect(b.x,b.y,b.width,b.height),c.clip()),this.updateContext(c),this.draw(c,!1),c.restore(),this.dispatchEvent("drawend")}},b.tick=function(a){if(this.tickEnabled&&this.dispatchEvent("tickstart",!1,!0)!==!1){var b=new createjs.Event("tick");if(a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);this._tick(b),this.dispatchEvent("tickend")}},b.handleEvent=function(a){"tick"==a.type&&this.update(a)},b.clear=function(){if(this.canvas){var a=this.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)}},b.toDataURL=function(a,b){var c,d=this.canvas.getContext("2d"),e=this.canvas.width,f=this.canvas.height;if(a){c=d.getImageData(0,0,e,f);var g=d.globalCompositeOperation;d.globalCompositeOperation="destination-over",d.fillStyle=a,d.fillRect(0,0,e,f)}var h=this.canvas.toDataURL(b||"image/png");return a&&(d.putImageData(c,0,0),d.globalCompositeOperation=g),h},b.enableMouseOver=function(a){if(this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,0==a&&this._testMouseOver(!0)),null==a)a=20;else if(0>=a)return;var b=this;this._mouseOverIntervalID=setInterval(function(){b._testMouseOver()},1e3/Math.min(50,a))},b.enableDOMEvents=function(a){null==a&&(a=!0);var b,c,d=this._eventListeners;if(!a&&d){for(b in d)c=d[b],c.t.removeEventListener(b,c.f,!1);this._eventListeners=null}else if(a&&!d&&this.canvas){var e=window.addEventListener?window:document,f=this;d=this._eventListeners={},d.mouseup={t:e,f:function(a){f._handleMouseUp(a)}},d.mousemove={t:e,f:function(a){f._handleMouseMove(a)}},d.dblclick={t:this.canvas,f:function(a){f._handleDoubleClick(a)}},d.mousedown={t:this.canvas,f:function(a){f._handleMouseDown(a)}};for(b in d)c=d[b],c.t.addEventListener(b,c.f,!1)}},b.clone=function(){throw"Stage cannot be cloned."},b.toString=function(){return"[Stage (name="+this.name+")]"},b._getElementRect=function(a){var b;try{b=a.getBoundingClientRect()}catch(c){b={top:a.offsetTop,left:a.offsetLeft,width:a.offsetWidth,height:a.offsetHeight}}var d=(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),e=(window.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||0),f=window.getComputedStyle?getComputedStyle(a,null):a.currentStyle,g=parseInt(f.paddingLeft)+parseInt(f.borderLeftWidth),h=parseInt(f.paddingTop)+parseInt(f.borderTopWidth),i=parseInt(f.paddingRight)+parseInt(f.borderRightWidth),j=parseInt(f.paddingBottom)+parseInt(f.borderBottomWidth);return{left:b.left+d+g,right:b.right+d-i,top:b.top+e+h,bottom:b.bottom+e-j}},b._getPointerData=function(a){var b=this._pointerData[a];return b||(b=this._pointerData[a]={x:0,y:0}),b},b._handleMouseMove=function(a){a||(a=window.event),this._handlePointerMove(-1,a,a.pageX,a.pageY)},b._handlePointerMove=function(a,b,c,d,e){if((!this._prevStage||void 0!==e)&&this.canvas){var f=this._nextStage,g=this._getPointerData(a),h=g.inBounds;this._updatePointerPosition(a,b,c,d),(h||g.inBounds||this.mouseMoveOutside)&&(-1===a&&g.inBounds==!h&&this._dispatchMouseEvent(this,h?"mouseleave":"mouseenter",!1,a,g,b),this._dispatchMouseEvent(this,"stagemousemove",!1,a,g,b),this._dispatchMouseEvent(g.target,"pressmove",!0,a,g,b)),f&&f._handlePointerMove(a,b,c,d,null)}},b._updatePointerPosition=function(a,b,c,d){var e=this._getElementRect(this.canvas);c-=e.left,d-=e.top;var f=this.canvas.width,g=this.canvas.height;c/=(e.right-e.left)/f,d/=(e.bottom-e.top)/g;var h=this._getPointerData(a);(h.inBounds=c>=0&&d>=0&&f-1>=c&&g-1>=d)?(h.x=c,h.y=d):this.mouseMoveOutside&&(h.x=0>c?0:c>f-1?f-1:c,h.y=0>d?0:d>g-1?g-1:d),h.posEvtObj=b,h.rawX=c,h.rawY=d,(a===this._primaryPointerID||-1===a)&&(this.mouseX=h.x,this.mouseY=h.y,this.mouseInBounds=h.inBounds)},b._handleMouseUp=function(a){this._handlePointerUp(-1,a,!1)},b._handlePointerUp=function(a,b,c,d){var e=this._nextStage,f=this._getPointerData(a);if(!this._prevStage||void 0!==d){var g=null,h=f.target;d||!h&&!e||(g=this._getObjectsUnderPoint(f.x,f.y,null,!0)),f.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,a,f,b,g),f.down=!1),g==h&&this._dispatchMouseEvent(h,"click",!0,a,f,b),this._dispatchMouseEvent(h,"pressup",!0,a,f,b),c?(a==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[a]):f.target=null,e&&e._handlePointerUp(a,b,c,d||g&&this)}},b._handleMouseDown=function(a){this._handlePointerDown(-1,a,a.pageX,a.pageY)},b._handlePointerDown=function(a,b,c,d,e){this.preventSelection&&b.preventDefault(),(null==this._primaryPointerID||-1===a)&&(this._primaryPointerID=a),null!=d&&this._updatePointerPosition(a,b,c,d);var f=null,g=this._nextStage,h=this._getPointerData(a);e||(f=h.target=this._getObjectsUnderPoint(h.x,h.y,null,!0)),h.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,a,h,b,f),h.down=!0),this._dispatchMouseEvent(f,"mousedown",!0,a,h,b),g&&g._handlePointerDown(a,b,c,d,e||f&&this)},b._testMouseOver=function(a,b,c){if(!this._prevStage||void 0!==b){var d=this._nextStage;if(!this._mouseOverIntervalID)return void(d&&d._testMouseOver(a,b,c));var e=this._getPointerData(-1);if(e&&(a||this.mouseX!=this._mouseOverX||this.mouseY!=this._mouseOverY||!this.mouseInBounds)){var f,g,h,i=e.posEvtObj,j=c||i&&i.target==this.canvas,k=null,l=-1,m="";!b&&(a||this.mouseInBounds&&j)&&(k=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);var n=this._mouseOverTarget||[],o=n[n.length-1],p=this._mouseOverTarget=[];for(f=k;f;)p.unshift(f),m||(m=f.cursor),f=f.parent;for(this.canvas.style.cursor=m,!b&&c&&(c.canvas.style.cursor=m),g=0,h=p.length;h>g&&p[g]==n[g];g++)l=g;for(o!=k&&this._dispatchMouseEvent(o,"mouseout",!0,-1,e,i,k),g=n.length-1;g>l;g--)this._dispatchMouseEvent(n[g],"rollout",!1,-1,e,i,k);for(g=p.length-1;g>l;g--)this._dispatchMouseEvent(p[g],"rollover",!1,-1,e,i,o);o!=k&&this._dispatchMouseEvent(k,"mouseover",!0,-1,e,i,o),d&&d._testMouseOver(a,b||k&&this,c||j&&this)}}},b._handleDoubleClick=function(a,b){var c=null,d=this._nextStage,e=this._getPointerData(-1);b||(c=this._getObjectsUnderPoint(e.x,e.y,null,!0),this._dispatchMouseEvent(c,"dblclick",!0,-1,e,a)),d&&d._handleDoubleClick(a,b||c&&this)},b._dispatchMouseEvent=function(a,b,c,d,e,f,g){if(a&&(c||a.hasEventListener(b))){var h=new createjs.MouseEvent(b,c,!1,e.x,e.y,f,d,d===this._primaryPointerID||-1===d,e.rawX,e.rawY,g);a.dispatchEvent(h)}},createjs.Stage=createjs.promote(a,"Container")}(),this.createjs=this.createjs||{},function(){"use strict";function a(b,c){if(this.Stage_constructor(b),void 0!==c){if("object"!=typeof c)throw"Invalid options object";var d=c.premultiply,e=c.transparent,f=c.antialias,g=c.preserveBuffer,h=c.autoPurge}this.vocalDebug=!1,this._preserveBuffer=g||!1,this._antialias=f||!1,this._transparent=e||!1,this._premultiply=d||!1,this._autoPurge=void 0,this.autoPurge=h,this._viewportWidth=0,this._viewportHeight=0,this._projectionMatrix=null,this._webGLContext=null,this._clearColor={r:.5,g:.5,b:.5,a:0},this._maxCardsPerBatch=a.DEFAULT_MAX_BATCH_SIZE,this._activeShader=null,this._vertices=null,this._vertexPositionBuffer=null,this._uvs=null,this._uvPositionBuffer=null,this._indices=null,this._textureIndexBuffer=null,this._alphas=null,this._alphaBuffer=null,this._textureDictionary=[],this._textureIDs={},this._batchTextures=[],this._baseTextures=[],this._batchTextureCount=8,this._lastTextureInsert=-1,this._batchID=0,this._drawID=0,this._slotBlacklist=[],this._isDrawing=0,this._lastTrackedCanvas=0,this.isCacheControlled=!1,this._cacheContainer=new createjs.Container,this._initializeWebGL()}var b=createjs.extend(a,createjs.Stage);a.buildUVRects=function(a,b,c){if(!a||!a._frames)return null;void 0===b&&(b=-1),void 0===c&&(c=!1);for(var d=-1!=b&&c?b:0,e=-1!=b&&c?b+1:a._frames.length,f=d;e>f;f++){var g=a._frames[f];if(!(g.uvRect||g.image.width<=0||g.image.height<=0)){var h=g.rect;g.uvRect={t:h.y/g.image.height,l:h.x/g.image.width,b:(h.y+h.height)/g.image.height,r:(h.x+h.width)/g.image.width}}}return a._frames[-1!=b?b:0].uvRect||{t:0,l:0,b:1,r:1}},a.isWebGLActive=function(a){return a&&a instanceof WebGLRenderingContext&&"undefined"!=typeof WebGLRenderingContext},a.VERTEX_PROPERTY_COUNT=6,a.INDICIES_PER_CARD=6,a.DEFAULT_MAX_BATCH_SIZE=1e4,a.WEBGL_MAX_INDEX_NUM=Math.pow(2,16),a.UV_RECT={t:0,l:0,b:1,r:1};try{a.COVER_VERT=new Float32Array([-1,1,1,1,-1,-1,1,1,1,-1,-1,-1]),a.COVER_UV=new Float32Array([0,0,1,0,0,1,1,0,1,1,0,1]),a.COVER_UV_FLIP=new Float32Array([0,1,1,1,0,0,1,1,1,0,0,0])}catch(c){}a.REGULAR_VARYING_HEADER="precision mediump float;varying vec2 vTextureCoord;varying lowp float indexPicker;varying lowp float alphaValue;",a.REGULAR_VERTEX_HEADER=a.REGULAR_VARYING_HEADER+"attribute vec2 vertexPosition;attribute vec2 uvPosition;attribute lowp float textureIndex;attribute lowp float objectAlpha;uniform mat4 pMatrix;",a.REGULAR_FRAGMENT_HEADER=a.REGULAR_VARYING_HEADER+"uniform sampler2D uSampler[{{count}}];",a.REGULAR_VERTEX_BODY="void main(void) {gl_Position = vec4((vertexPosition.x * pMatrix[0][0]) + pMatrix[3][0],(vertexPosition.y * pMatrix[1][1]) + pMatrix[3][1],pMatrix[3][2],1.0);alphaValue = objectAlpha;indexPicker = textureIndex;vTextureCoord = uvPosition;}",a.REGULAR_FRAGMENT_BODY="void main(void) {vec4 color = vec4(1.0, 0.0, 0.0, 1.0);if (indexPicker <= 0.5) {color = texture2D(uSampler[0], vTextureCoord);{{alternates}}}{{fragColor}}}",a.REGULAR_FRAG_COLOR_NORMAL="gl_FragColor = vec4(color.rgb, color.a * alphaValue);",a.REGULAR_FRAG_COLOR_PREMULTIPLY="if(color.a > 0.0035) {gl_FragColor = vec4(color.rgb/color.a, color.a * alphaValue);} else {gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}",a.PARTICLE_VERTEX_BODY=a.REGULAR_VERTEX_BODY,a.PARTICLE_FRAGMENT_BODY=a.REGULAR_FRAGMENT_BODY,a.COVER_VARYING_HEADER="precision mediump float;varying highp vec2 vRenderCoord;varying highp vec2 vTextureCoord;",a.COVER_VERTEX_HEADER=a.COVER_VARYING_HEADER+"attribute vec2 vertexPosition;attribute vec2 uvPosition;uniform float uUpright;",a.COVER_FRAGMENT_HEADER=a.COVER_VARYING_HEADER+"uniform sampler2D uSampler;",a.COVER_VERTEX_BODY="void main(void) {gl_Position = vec4(vertexPosition.x, vertexPosition.y, 0.0, 1.0);vRenderCoord = uvPosition;vTextureCoord = vec2(uvPosition.x, abs(uUpright - uvPosition.y));}",a.COVER_FRAGMENT_BODY="void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = color;}",b._get_isWebGL=function(){return!!this._webGLContext},b._set_autoPurge=function(a){a=isNaN(a)?1200:a,-1!=a&&(a=10>a?10:a),this._autoPurge=a},b._get_autoPurge=function(){return Number(this._autoPurge)};try{Object.defineProperties(b,{isWebGL:{get:b._get_isWebGL},autoPurge:{get:b._get_autoPurge,set:b._set_autoPurge}})}catch(c){}b._initializeWebGL=function(){if(this.canvas){if(!this._webGLContext||this._webGLContext.canvas!==this.canvas){var a={depth:!1,alpha:this._transparent,stencil:!0,antialias:this._antialias,premultipliedAlpha:this._premultiply,preserveDrawingBuffer:this._preserveBuffer},b=this._webGLContext=this._fetchWebGLContext(this.canvas,a);if(!b)return null;this.updateSimultaneousTextureCount(b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS)),this._maxTextureSlots=b.getParameter(b.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this._createBuffers(b),this._initTextures(b),b.disable(b.DEPTH_TEST),b.enable(b.BLEND),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiply),this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),this.updateViewport(this._viewportWidth||this.canvas.width,this._viewportHeight||this.canvas.height)}}else this._webGLContext=null;return this._webGLContext},b.update=function(a){if(this.canvas){if(this.tickOnUpdate&&this.tick(a),this.dispatchEvent("drawstart"),this.autoClear&&this.clear(),this._webGLContext)this._batchDraw(this,this._webGLContext),-1==this._autoPurge||this._drawID%(this._autoPurge/2|0)||this.purgeTextures(this._autoPurge);else{var b=this.canvas.getContext("2d");b.save(),this.updateContext(b),this.draw(b,!1),b.restore()}this.dispatchEvent("drawend")}},b.clear=function(){if(this.canvas)if(a.isWebGLActive(this._webGLContext)){var b=this._webGLContext,c=this._clearColor,d=this._transparent?c.a:1;this._webGLContext.clearColor(c.r*d,c.g*d,c.b*d,d),b.clear(b.COLOR_BUFFER_BIT),this._webGLContext.clearColor(c.r,c.g,c.b,c.a)}else this.Stage_clear()},b.draw=function(b,c){if(b===this._webGLContext&&a.isWebGLActive(this._webGLContext)){var d=this._webGLContext;return this._batchDraw(this,d,c),!0}return this.Stage_draw(b,c)},b.cacheDraw=function(b,c,d){if(a.isWebGLActive(this._webGLContext)){var e=this._webGLContext;return this._cacheDraw(e,b,c,d),!0}return!1},b.protectTextureSlot=function(a,b){if(a>this._maxTextureSlots||0>a)throw"Slot outside of acceptable range";this._slotBlacklist[a]=!!b},b.getTargetRenderTexture=function(a,b,c){var d,e=!1,f=this._webGLContext;if(void 0!==a.__lastRT&&a.__lastRT===a.__rtA&&(e=!0),e?(void 0===a.__rtB?a.__rtB=this.getRenderBufferTexture(b,c):((b!=a.__rtB._width||c!=a.__rtB._height)&&this.resizeTexture(a.__rtB,b,c),this.setTextureParams(f)),d=a.__rtB):(void 0===a.__rtA?a.__rtA=this.getRenderBufferTexture(b,c):((b!=a.__rtA._width||c!=a.__rtA._height)&&this.resizeTexture(a.__rtA,b,c),this.setTextureParams(f)),d=a.__rtA),!d)throw"Problems creating render textures, known causes include using too much VRAM by not releasing WebGL texture instances";return a.__lastRT=d,d},b.releaseTexture=function(a){var b,c;if(a){if(a.children)for(b=0,c=a.children.length;c>b;b++)this.releaseTexture(a.children[b]);a.cacheCanvas&&a.uncache();var d=void 0;if(void 0!==a._storeID){if(a===this._textureDictionary[a._storeID])return this._killTextureObject(a),void(a._storeID=void 0);d=a}else if(2===a._webGLRenderStyle)d=a.image;else if(1===a._webGLRenderStyle){for(b=0,c=a.spriteSheet._images.length;c>b;b++)this.releaseTexture(a.spriteSheet._images[b]);return}if(void 0===d)return void(this.vocalDebug&&void 0);this._killTextureObject(this._textureDictionary[d._storeID]),d._storeID=void 0}},b.purgeTextures=function(a){void 0==a&&(a=100);for(var b=this._textureDictionary,c=b.length,d=0;c>d;d++){var e=b[d];e&&e._drawID+a<=this._drawID&&this._killTextureObject(e)}},b.updateSimultaneousTextureCount=function(a){var b=this._webGLContext,c=!1;for((1>a||isNaN(a))&&(a=1),this._batchTextureCount=a;!c;)try{this._activeShader=this._fetchShaderProgram(b),c=!0}catch(d){if(1==this._batchTextureCount)throw"Cannot compile shader "+d;this._batchTextureCount-=4,this._batchTextureCount<1&&(this._batchTextureCount=1),this.vocalDebug&&void 0}},b.updateViewport=function(a,b){this._viewportWidth=0|a,this._viewportHeight=0|b;var c=this._webGLContext;c&&(c.viewport(0,0,this._viewportWidth,this._viewportHeight),this._projectionMatrix=new Float32Array([2/this._viewportWidth,0,0,0,0,-2/this._viewportHeight,1,0,0,0,1,0,-1,1,.1,0]),this._projectionMatrixFlip=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this._projectionMatrixFlip.set(this._projectionMatrix),this._projectionMatrixFlip[5]*=-1,this._projectionMatrixFlip[13]*=-1)},b.getFilterShader=function(a){a||(a=this);var b=this._webGLContext,c=this._activeShader;if(a._builtShader)c=a._builtShader,a.shaderParamSetup&&(b.useProgram(c),a.shaderParamSetup(b,this,c));else try{c=this._fetchShaderProgram(b,"filter",a.VTX_SHADER_BODY,a.FRAG_SHADER_BODY,a.shaderParamSetup&&a.shaderParamSetup.bind(a)),a._builtShader=c,c._name=a.toString()}catch(d){console&&void 0}return c},b.getBaseTexture=function(a,b){var c=Math.ceil(a>0?a:1)||1,d=Math.ceil(b>0?b:1)||1,e=this._webGLContext,f=e.createTexture();return this.resizeTexture(f,c,d),this.setTextureParams(e,!1),f},b.resizeTexture=function(a,b,c){var d=this._webGLContext;d.bindTexture(d.TEXTURE_2D,a),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,b,c,0,d.RGBA,d.UNSIGNED_BYTE,null),a.width=b,a.height=c},b.getRenderBufferTexture=function(a,b){var c=this._webGLContext,d=this.getBaseTexture(a,b);if(!d)return null;var e=c.createFramebuffer();return e?(d.width=a,d.height=b,c.bindFramebuffer(c.FRAMEBUFFER,e),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,d,0),e._renderTexture=d,d._frameBuffer=e,d._storeID=this._textureDictionary.length,this._textureDictionary[d._storeID]=d,c.bindFramebuffer(c.FRAMEBUFFER,null),d):null},b.setTextureParams=function(a,b){b&&this._antialias?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST)),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)},b.setClearColor=function(a){var b,c,d,e,f;"string"==typeof a?0==a.indexOf("#")?(4==a.length&&(a="#"+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)+a.charAt(3)+a.charAt(3)),b=Number("0x"+a.slice(1,3))/255,c=Number("0x"+a.slice(3,5))/255,d=Number("0x"+a.slice(5,7))/255,e=Number("0x"+a.slice(7,9))/255):0==a.indexOf("rgba(")&&(f=a.slice(5,-1).split(","),b=Number(f[0])/255,c=Number(f[1])/255,d=Number(f[2])/255,e=Number(f[3])):(b=((4278190080&a)>>>24)/255,c=((16711680&a)>>>16)/255,d=((65280&a)>>>8)/255,e=(255&a)/255),this._clearColor.r=b||0,this._clearColor.g=c||0,this._clearColor.b=d||0,this._clearColor.a=e||0,this._webGLContext&&this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a)},b.toString=function(){return"[StageGL (name="+this.name+")]"},b._fetchWebGLContext=function(a,b){var c;try{c=a.getContext("webgl",b)||a.getContext("experimental-webgl",b)}catch(d){}if(c)c.viewportWidth=a.width,
c.viewportHeight=a.height;else{console.error,void 0}return c},b._fetchShaderProgram=function(b,c,d,e,f){b.useProgram(null);var g,h;switch(c){case"filter":h=a.COVER_VERTEX_HEADER+(d||a.COVER_VERTEX_BODY),g=a.COVER_FRAGMENT_HEADER+(e||a.COVER_FRAGMENT_BODY);break;case"particle":h=a.REGULAR_VERTEX_HEADER+a.PARTICLE_VERTEX_BODY,g=a.REGULAR_FRAGMENT_HEADER+a.PARTICLE_FRAGMENT_BODY;break;case"override":h=a.REGULAR_VERTEX_HEADER+(d||a.REGULAR_VERTEX_BODY),g=a.REGULAR_FRAGMENT_HEADER+(e||a.REGULAR_FRAGMENT_BODY);break;case"regular":default:h=a.REGULAR_VERTEX_HEADER+a.REGULAR_VERTEX_BODY,g=a.REGULAR_FRAGMENT_HEADER+a.REGULAR_FRAGMENT_BODY}var i=this._createShader(b,b.VERTEX_SHADER,h),j=this._createShader(b,b.FRAGMENT_SHADER,g),k=b.createProgram();if(b.attachShader(k,i),b.attachShader(k,j),b.linkProgram(k),k._type=c,!b.getProgramParameter(k,b.LINK_STATUS))throw b.useProgram(this._activeShader),b.getProgramInfoLog(k);switch(b.useProgram(k),c){case"filter":k.vertexPositionAttribute=b.getAttribLocation(k,"vertexPosition"),b.enableVertexAttribArray(k.vertexPositionAttribute),k.uvPositionAttribute=b.getAttribLocation(k,"uvPosition"),b.enableVertexAttribArray(k.uvPositionAttribute),k.samplerUniform=b.getUniformLocation(k,"uSampler"),b.uniform1i(k.samplerUniform,0),k.uprightUniform=b.getUniformLocation(k,"uUpright"),b.uniform1f(k.uprightUniform,0),f&&f(b,this,k);break;case"override":case"particle":case"regular":default:k.vertexPositionAttribute=b.getAttribLocation(k,"vertexPosition"),b.enableVertexAttribArray(k.vertexPositionAttribute),k.uvPositionAttribute=b.getAttribLocation(k,"uvPosition"),b.enableVertexAttribArray(k.uvPositionAttribute),k.textureIndexAttribute=b.getAttribLocation(k,"textureIndex"),b.enableVertexAttribArray(k.textureIndexAttribute),k.alphaAttribute=b.getAttribLocation(k,"objectAlpha"),b.enableVertexAttribArray(k.alphaAttribute);for(var l=[],m=0;m<this._batchTextureCount;m++)l[m]=m;k.samplerData=l,k.samplerUniform=b.getUniformLocation(k,"uSampler"),b.uniform1iv(k.samplerUniform,l),k.pMatrixUniform=b.getUniformLocation(k,"pMatrix")}return b.useProgram(this._activeShader),k},b._createShader=function(b,c,d){d=d.replace(/{{count}}/g,this._batchTextureCount);for(var e="",f=1;f<this._batchTextureCount;f++)e+="} else if (indexPicker <= "+f+".5) { color = texture2D(uSampler["+f+"], vTextureCoord);";d=d.replace(/{{alternates}}/g,e),d=d.replace(/{{fragColor}}/g,this._premultiply?a.REGULAR_FRAG_COLOR_NORMAL:a.REGULAR_FRAG_COLOR_PREMULTIPLY);var g=b.createShader(c);if(b.shaderSource(g,d),b.compileShader(g),!b.getShaderParameter(g,b.COMPILE_STATUS))throw b.getShaderInfoLog(g);return g},b._createBuffers=function(b){var c,d,e,f=this._maxCardsPerBatch*a.INDICIES_PER_CARD,g=this._vertexPositionBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,g),c=2;var h=this._vertices=new Float32Array(f*c);for(d=0,e=h.length;e>d;d+=c)h[d]=h[d+1]=0;b.bufferData(b.ARRAY_BUFFER,h,b.DYNAMIC_DRAW),g.itemSize=c,g.numItems=f;var i=this._uvPositionBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,i),c=2;var j=this._uvs=new Float32Array(f*c);for(d=0,e=j.length;e>d;d+=c)j[d]=j[d+1]=0;b.bufferData(b.ARRAY_BUFFER,j,b.DYNAMIC_DRAW),i.itemSize=c,i.numItems=f;var k=this._textureIndexBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,k),c=1;var l=this._indices=new Float32Array(f*c);for(d=0,e=l.length;e>d;d++)l[d]=0;b.bufferData(b.ARRAY_BUFFER,l,b.DYNAMIC_DRAW),k.itemSize=c,k.numItems=f;var m=this._alphaBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,m),c=1;var n=this._alphas=new Float32Array(f*c);for(d=0,e=n.length;e>d;d++)n[d]=1;b.bufferData(b.ARRAY_BUFFER,n,b.DYNAMIC_DRAW),m.itemSize=c,m.numItems=f},b._initTextures=function(){this._lastTextureInsert=-1,this._textureDictionary=[],this._textureIDs={},this._baseTextures=[],this._batchTextures=[];for(var a=0;a<this._batchTextureCount;a++){var b=this.getBaseTexture();if(this._baseTextures[a]=this._batchTextures[a]=b,!b)throw"Problems creating basic textures, known causes include using too much VRAM by not releasing WebGL texture instances"}},b._loadTextureImage=function(a,b){var c=b.src;c||(b._isCanvas=!0,c=b.src="canvas_"+this._lastTrackedCanvas++);var d=this._textureIDs[c];void 0===d&&(d=this._textureIDs[c]=this._textureDictionary.length),void 0===this._textureDictionary[d]&&(this._textureDictionary[d]=this.getBaseTexture());var e=this._textureDictionary[d];if(e)e._batchID=this._batchID,e._storeID=d,e._imageData=b,this._insertTextureInBatch(a,e),b._storeID=d,b.complete||b.naturalWidth||b._isCanvas?this._updateTextureImageData(a,b):b.addEventListener("load",this._updateTextureImageData.bind(this,a,b));else{console.error&&void 0||void 0,e=this._baseTextures[0],e._batchID=this._batchID,e._storeID=-1,e._imageData=e,this._insertTextureInBatch(a,e)}return e},b._updateTextureImageData=function(a,b){var c=b.width&b.width-1||b.height&b.height-1,d=this._textureDictionary[b._storeID];a.activeTexture(a.TEXTURE0+d._activeIndex),a.bindTexture(a.TEXTURE_2D,d),d.isPOT=!c,this.setTextureParams(a,d.isPOT);try{a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b)}catch(e){console.error?void 0:console&&void 0}b._invalid=!1,d._w=b.width,d._h=b.height,this.vocalDebug&&(b.width>a.MAX_TEXTURE_SIZE||b.height>a.MAX_TEXTURE_SIZE)&&console&&void 0},b._insertTextureInBatch=function(a,b){if(this._batchTextures[b._activeIndex]!==b){var c=-1,d=(this._lastTextureInsert+1)%this._batchTextureCount,e=d;do{if(this._batchTextures[e]._batchID!=this._batchID&&!this._slotBlacklist[e]){c=e;break}e=(e+1)%this._batchTextureCount}while(e!==d);-1===c&&(this.batchReason="textureOverflow",this._drawBuffers(a),this.batchCardCount=0,c=d),this._batchTextures[c]=b,b._activeIndex=c;var f=b._imageData;f&&f._invalid&&void 0!==b._drawID?this._updateTextureImageData(a,f):(a.activeTexture(a.TEXTURE0+c),a.bindTexture(a.TEXTURE_2D,b),this.setTextureParams(a)),this._lastTextureInsert=c}else{var f=b._imageData;void 0!=b._storeID&&f&&f._invalid&&this._updateTextureImageData(a,f)}b._drawID=this._drawID,b._batchID=this._batchID},b._killTextureObject=function(a){if(a){var b=this._webGLContext;if(void 0!==a._storeID&&a._storeID>=0){this._textureDictionary[a._storeID]=void 0;for(var c in this._textureIDs)this._textureIDs[c]==a._storeID&&delete this._textureIDs[c];a._imageData&&(a._imageData._storeID=void 0),a._imageData=a._storeID=void 0}void 0!==a._activeIndex&&this._batchTextures[a._activeIndex]===a&&(this._batchTextures[a._activeIndex]=this._baseTextures[a._activeIndex]);try{a._frameBuffer&&b.deleteFramebuffer(a._frameBuffer),a._frameBuffer=void 0}catch(d){this.vocalDebug&&void 0}try{b.deleteTexture(a)}catch(d){this.vocalDebug&&void 0}}},b._backupBatchTextures=function(a,b){var c=this._webGLContext;this._backupTextures||(this._backupTextures=[]),void 0===b&&(b=this._backupTextures);for(var d=0;d<this._batchTextureCount;d++)c.activeTexture(c.TEXTURE0+d),a?this._batchTextures[d]=b[d]:(b[d]=this._batchTextures[d],this._batchTextures[d]=this._baseTextures[d]),c.bindTexture(c.TEXTURE_2D,this._batchTextures[d]),this.setTextureParams(c,this._batchTextures[d].isPOT);a&&b===this._backupTextures&&(this._backupTextures=[])},b._batchDraw=function(a,b,c){this._isDrawing>0&&this._drawBuffers(b),this._isDrawing++,this._drawID++,this.batchCardCount=0,this.depth=0,this._appendToBatchGroup(a,b,new createjs.Matrix2D,this.alpha,c),this.batchReason="drawFinish",this._drawBuffers(b),this._isDrawing--},b._cacheDraw=function(a,b,c,d){var e,f=this._activeShader,g=this._slotBlacklist,h=this._maxTextureSlots-1,i=this._viewportWidth,j=this._viewportHeight;this.protectTextureSlot(h,!0);var k=b.getMatrix();k=k.clone(),k.scale(1/d.scale,1/d.scale),k=k.invert(),k.translate(-d.offX/d.scale*b.scaleX,-d.offY/d.scale*b.scaleY);var l=this._cacheContainer;l.children=[b],l.transformMatrix=k,this._backupBatchTextures(!1),c&&c.length?this._drawFilters(b,c,d):this.isCacheControlled?(a.clear(a.COLOR_BUFFER_BIT),this._batchDraw(l,a,!0)):(a.activeTexture(a.TEXTURE0+h),b.cacheCanvas=this.getTargetRenderTexture(b,d._drawWidth,d._drawHeight),e=b.cacheCanvas,a.bindFramebuffer(a.FRAMEBUFFER,e._frameBuffer),this.updateViewport(d._drawWidth,d._drawHeight),this._projectionMatrix=this._projectionMatrixFlip,a.clear(a.COLOR_BUFFER_BIT),this._batchDraw(l,a,!0),a.bindFramebuffer(a.FRAMEBUFFER,null),this.updateViewport(i,j)),this._backupBatchTextures(!0),this.protectTextureSlot(h,!1),this._activeShader=f,this._slotBlacklist=g},b._drawFilters=function(a,b,c){var d,e=this._webGLContext,f=this._maxTextureSlots-1,g=this._viewportWidth,h=this._viewportHeight,i=this._cacheContainer,j=b.length;e.activeTexture(e.TEXTURE0+f),d=this.getTargetRenderTexture(a,c._drawWidth,c._drawHeight),e.bindFramebuffer(e.FRAMEBUFFER,d._frameBuffer),this.updateViewport(c._drawWidth,c._drawHeight),e.clear(e.COLOR_BUFFER_BIT),this._batchDraw(i,e,!0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,d),this.setTextureParams(e);var k=!1,l=0,m=b[l];do this._activeShader=this.getFilterShader(m),this._activeShader&&(e.activeTexture(e.TEXTURE0+f),d=this.getTargetRenderTexture(a,c._drawWidth,c._drawHeight),e.bindFramebuffer(e.FRAMEBUFFER,d._frameBuffer),e.viewport(0,0,c._drawWidth,c._drawHeight),e.clear(e.COLOR_BUFFER_BIT),this._drawCover(e,k),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,d),this.setTextureParams(e),(j>1||b[0]._multiPass)&&(k=!k),m=null!==m._multiPass?m._multiPass:b[++l]);while(m);this.isCacheControlled?(e.bindFramebuffer(e.FRAMEBUFFER,null),this.updateViewport(g,h),this._activeShader=this.getFilterShader(this),e.clear(e.COLOR_BUFFER_BIT),this._drawCover(e,k)):(k&&(e.activeTexture(e.TEXTURE0+f),d=this.getTargetRenderTexture(a,c._drawWidth,c._drawHeight),e.bindFramebuffer(e.FRAMEBUFFER,d._frameBuffer),this._activeShader=this.getFilterShader(this),e.viewport(0,0,c._drawWidth,c._drawHeight),e.clear(e.COLOR_BUFFER_BIT),this._drawCover(e,!k)),e.bindFramebuffer(e.FRAMEBUFFER,null),this.updateViewport(g,h),a.cacheCanvas=d)},b._appendToBatchGroup=function(b,c,d,e,f){b._glMtx||(b._glMtx=new createjs.Matrix2D);var g=b._glMtx;g.copy(d),b.transformMatrix?g.appendMatrix(b.transformMatrix):g.appendTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY);for(var h,i,j,k,l=b.children.length,m=0;l>m;m++){var n=b.children[m];if(n.visible&&e)if(n.cacheCanvas&&!f||(n._updateState&&n._updateState(),!n.children)){this.batchCardCount+1>this._maxCardsPerBatch&&(this.batchReason="vertexOverflow",this._drawBuffers(c),this.batchCardCount=0),n._glMtx||(n._glMtx=new createjs.Matrix2D);var o=n._glMtx;o.copy(g),n.transformMatrix?o.appendMatrix(n.transformMatrix):o.appendTransform(n.x,n.y,n.scaleX,n.scaleY,n.rotation,n.skewX,n.skewY,n.regX,n.regY);var p,q,r,s,t,u,v=n.cacheCanvas&&!f;if(2===n._webGLRenderStyle||v)r=(f?!1:n.cacheCanvas)||n.image;else{if(1!==n._webGLRenderStyle)continue;if(s=n.spriteSheet.getFrame(n.currentFrame),null===s)continue;r=s.image}var w=this._uvs,x=this._vertices,y=this._indices,z=this._alphas;if(r){if(void 0===r._storeID)t=this._loadTextureImage(c,r),this._insertTextureInBatch(c,t);else{if(t=this._textureDictionary[r._storeID],!t){this.vocalDebug&&void 0;continue}t._batchID!==this._batchID&&this._insertTextureInBatch(c,t)}if(q=t._activeIndex,2===n._webGLRenderStyle||v)!v&&n.sourceRect?(n._uvRect||(n._uvRect={}),u=n.sourceRect,p=n._uvRect,p.t=u.y/r.height,p.l=u.x/r.width,p.b=(u.y+u.height)/r.height,p.r=(u.x+u.width)/r.width,h=0,i=0,j=u.width+h,k=u.height+i):(p=a.UV_RECT,v?(u=n.bitmapCache,h=u.x+u._filterOffX/u.scale,i=u.y+u._filterOffY/u.scale,j=u._drawWidth/u.scale+h,k=u._drawHeight/u.scale+i):(h=0,i=0,j=r.width+h,k=r.height+i));else if(1===n._webGLRenderStyle){var A=s.rect;p=s.uvRect,p||(p=a.buildUVRects(n.spriteSheet,n.currentFrame,!1)),h=-s.regX,i=-s.regY,j=A.width-s.regX,k=A.height-s.regY}var B=this.batchCardCount*a.INDICIES_PER_CARD,C=2*B;x[C]=h*o.a+i*o.c+o.tx,x[C+1]=h*o.b+i*o.d+o.ty,x[C+2]=h*o.a+k*o.c+o.tx,x[C+3]=h*o.b+k*o.d+o.ty,x[C+4]=j*o.a+i*o.c+o.tx,x[C+5]=j*o.b+i*o.d+o.ty,x[C+6]=x[C+2],x[C+7]=x[C+3],x[C+8]=x[C+4],x[C+9]=x[C+5],x[C+10]=j*o.a+k*o.c+o.tx,x[C+11]=j*o.b+k*o.d+o.ty,w[C]=p.l,w[C+1]=p.t,w[C+2]=p.l,w[C+3]=p.b,w[C+4]=p.r,w[C+5]=p.t,w[C+6]=p.l,w[C+7]=p.b,w[C+8]=p.r,w[C+9]=p.t,w[C+10]=p.r,w[C+11]=p.b,y[B]=y[B+1]=y[B+2]=y[B+3]=y[B+4]=y[B+5]=q,z[B]=z[B+1]=z[B+2]=z[B+3]=z[B+4]=z[B+5]=n.alpha*e,this.batchCardCount++}}else this._appendToBatchGroup(n,c,g,n.alpha*e)}},b._drawBuffers=function(b){if(!(this.batchCardCount<=0)){this.vocalDebug&&void 0;var c=this._activeShader,d=this._vertexPositionBuffer,e=this._textureIndexBuffer,f=this._uvPositionBuffer,g=this._alphaBuffer;b.useProgram(c),b.bindBuffer(b.ARRAY_BUFFER,d),b.vertexAttribPointer(c.vertexPositionAttribute,d.itemSize,b.FLOAT,!1,0,0),b.bufferSubData(b.ARRAY_BUFFER,0,this._vertices),b.bindBuffer(b.ARRAY_BUFFER,e),b.vertexAttribPointer(c.textureIndexAttribute,e.itemSize,b.FLOAT,!1,0,0),b.bufferSubData(b.ARRAY_BUFFER,0,this._indices),b.bindBuffer(b.ARRAY_BUFFER,f),b.vertexAttribPointer(c.uvPositionAttribute,f.itemSize,b.FLOAT,!1,0,0),b.bufferSubData(b.ARRAY_BUFFER,0,this._uvs),b.bindBuffer(b.ARRAY_BUFFER,g),b.vertexAttribPointer(c.alphaAttribute,g.itemSize,b.FLOAT,!1,0,0),b.bufferSubData(b.ARRAY_BUFFER,0,this._alphas),b.uniformMatrix4fv(c.pMatrixUniform,b.FALSE,this._projectionMatrix);for(var h=0;h<this._batchTextureCount;h++){var i=this._batchTextures[h];b.activeTexture(b.TEXTURE0+h),b.bindTexture(b.TEXTURE_2D,i),this.setTextureParams(b,i.isPOT)}b.drawArrays(b.TRIANGLES,0,this.batchCardCount*a.INDICIES_PER_CARD),this._batchID++}},b._drawCover=function(b,c){this._isDrawing>0&&this._drawBuffers(b),this.vocalDebug&&void 0;var d=this._activeShader,e=this._vertexPositionBuffer,f=this._uvPositionBuffer;b.clear(b.COLOR_BUFFER_BIT),b.useProgram(d),b.bindBuffer(b.ARRAY_BUFFER,e),b.vertexAttribPointer(d.vertexPositionAttribute,e.itemSize,b.FLOAT,!1,0,0),b.bufferSubData(b.ARRAY_BUFFER,0,a.COVER_VERT),b.bindBuffer(b.ARRAY_BUFFER,f),b.vertexAttribPointer(d.uvPositionAttribute,f.itemSize,b.FLOAT,!1,0,0),b.bufferSubData(b.ARRAY_BUFFER,0,c?a.COVER_UV_FLIP:a.COVER_UV),b.uniform1i(d.samplerUniform,0),b.uniform1f(d.uprightUniform,c?0:1),b.drawArrays(b.TRIANGLES,0,a.INDICIES_PER_CARD)},createjs.StageGL=createjs.promote(a,"Stage")}(),this.createjs=this.createjs||{},function(){function a(a){this.DisplayObject_constructor(),"string"==typeof a?(this.image=document.createElement("img"),this.image.src=a):this.image=a,this.sourceRect=null,this._webGLRenderStyle=createjs.DisplayObject._StageGL_BITMAP}var b=createjs.extend(a,createjs.DisplayObject);b.initialize=a,b.isVisible=function(){var a=this.image,b=this.cacheCanvas||a&&(a.naturalWidth||a.getContext||a.readyState>=2);return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&b)},b.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;var c=this.image,d=this.sourceRect;if(c.getImage&&(c=c.getImage()),!c)return!0;if(d){var e=d.x,f=d.y,g=e+d.width,h=f+d.height,i=0,j=0,k=c.width,l=c.height;0>e&&(i-=e,e=0),g>k&&(g=k),0>f&&(j-=f,f=0),h>l&&(h=l),a.drawImage(c,e,f,g-e,h-f,i,j,g-e,h-f)}else a.drawImage(c,0,0);return!0},b.getBounds=function(){var a=this.DisplayObject_getBounds();if(a)return a;var b=this.image,c=this.sourceRect||b,d=b&&(b.naturalWidth||b.getContext||b.readyState>=2);return d?this._rectangle.setValues(0,0,c.width,c.height):null},b.clone=function(b){var c=this.image;c&&b&&(c=c.cloneNode());var d=new a(c);return this.sourceRect&&(d.sourceRect=this.sourceRect.clone()),this._cloneProps(d),d},b.toString=function(){return"[Bitmap (name="+this.name+")]"},createjs.Bitmap=createjs.promote(a,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b){this.DisplayObject_constructor(),this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=a,this.currentAnimationFrame=0,this.framerate=0,this._animation=null,this._currentFrame=null,this._skipAdvance=!1,this._webGLRenderStyle=createjs.DisplayObject._StageGL_SPRITE,null!=b&&this.gotoAndPlay(b)}var b=createjs.extend(a,createjs.DisplayObject);b.initialize=a,b.isVisible=function(){var a=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&a)},b.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;this._normalizeFrame();var c=this.spriteSheet.getFrame(0|this._currentFrame);if(!c)return!1;var d=c.rect;return d.width&&d.height&&a.drawImage(c.image,d.x,d.y,d.width,d.height,-c.regX,-c.regY,d.width,d.height),!0},b.play=function(){this.paused=!1},b.stop=function(){this.paused=!0},b.gotoAndPlay=function(a){this.paused=!1,this._skipAdvance=!0,this._goto(a)},b.gotoAndStop=function(a){this.paused=!0,this._goto(a)},b.advance=function(a){var b=this.framerate||this.spriteSheet.framerate,c=b&&null!=a?a/(1e3/b):1;this._normalizeFrame(c)},b.getBounds=function(){return this.DisplayObject_getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)},b.clone=function(){return this._cloneProps(new a(this.spriteSheet))},b.toString=function(){return"[Sprite (name="+this.name+")]"},b._cloneProps=function(a){return this.DisplayObject__cloneProps(a),a.currentFrame=this.currentFrame,a.currentAnimation=this.currentAnimation,a.paused=this.paused,a.currentAnimationFrame=this.currentAnimationFrame,a.framerate=this.framerate,a._animation=this._animation,a._currentFrame=this._currentFrame,a._skipAdvance=this._skipAdvance,a},b._tick=function(a){this.paused||(this._skipAdvance||this.advance(a&&a.delta),this._skipAdvance=!1),this.DisplayObject__tick(a)},b._normalizeFrame=function(a){a=a||0;var b,c=this._animation,d=this.paused,e=this._currentFrame;if(c){var f=c.speed||1,g=this.currentAnimationFrame;if(b=c.frames.length,g+a*f>=b){var h=c.next;if(this._dispatchAnimationEnd(c,e,d,h,b-1))return;if(h)return this._goto(h,a-(b-g)/f);this.paused=!0,g=c.frames.length-1}else g+=a*f;this.currentAnimationFrame=g,this._currentFrame=c.frames[0|g]}else if(e=this._currentFrame+=a,b=this.spriteSheet.getNumFrames(),e>=b&&b>0&&!this._dispatchAnimationEnd(c,e,d,b-1)&&(this._currentFrame-=b)>=b)return this._normalizeFrame();e=0|this._currentFrame,this.currentFrame!=e&&(this.currentFrame=e,this.dispatchEvent("change"))},b._dispatchAnimationEnd=function(a,b,c,d,e){var f=a?a.name:null;if(this.hasEventListener("animationend")){var g=new createjs.Event("animationend");g.name=f,g.next=d,this.dispatchEvent(g)}var h=this._animation!=a||this._currentFrame!=b;return h||c||!this.paused||(this.currentAnimationFrame=e,h=!0),h},b._goto=function(a,b){if(this.currentAnimationFrame=0,isNaN(a)){var c=this.spriteSheet.getAnimation(a);c&&(this._animation=c,this.currentAnimation=a,this._normalizeFrame(b))}else this.currentAnimation=this._animation=null,this._currentFrame=a,this._normalizeFrame()},createjs.Sprite=createjs.promote(a,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.DisplayObject_constructor(),this.graphics=a?a:new createjs.Graphics}var b=createjs.extend(a,createjs.DisplayObject);b.isVisible=function(){var a=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&a)},b.draw=function(a,b){return this.DisplayObject_draw(a,b)?!0:(this.graphics.draw(a,this),!0)},b.clone=function(b){var c=b&&this.graphics?this.graphics.clone():this.graphics;return this._cloneProps(new a(c))},b.toString=function(){return"[Shape (name="+this.name+")]"},createjs.Shape=createjs.promote(a,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c){this.DisplayObject_constructor(),this.text=a,this.font=b,this.color=c,this.textAlign="left",this.textBaseline="top",this.maxWidth=null,this.outline=0,this.lineHeight=0,this.lineWidth=null}var b=createjs.extend(a,createjs.DisplayObject),c=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");c.getContext&&(a._workingContext=c.getContext("2d"),c.width=c.height=1),a.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},a.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1},b.isVisible=function(){var a=this.cacheCanvas||null!=this.text&&""!==this.text;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&a)},b.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;var c=this.color||"#000";return this.outline?(a.strokeStyle=c,a.lineWidth=1*this.outline):a.fillStyle=c,this._drawText(this._prepContext(a)),!0},b.getMeasuredWidth=function(){return this._getMeasuredWidth(this.text)},b.getMeasuredLineHeight=function(){return 1.2*this._getMeasuredWidth("M")},b.getMeasuredHeight=function(){return this._drawText(null,{}).height},b.getBounds=function(){var b=this.DisplayObject_getBounds();if(b)return b;if(null==this.text||""===this.text)return null;var c=this._drawText(null,{}),d=this.maxWidth&&this.maxWidth<c.width?this.maxWidth:c.width,e=d*a.H_OFFSETS[this.textAlign||"left"],f=this.lineHeight||this.getMeasuredLineHeight(),g=f*a.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(e,g,d,c.height)},b.getMetrics=function(){var b={lines:[]};return b.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),b.vOffset=b.lineHeight*a.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,b,b.lines)},b.clone=function(){return this._cloneProps(new a(this.text,this.font,this.color))},b.toString=function(){return"[Text (text="+(this.text.length>20?this.text.substr(0,17)+"...":this.text)+")]"},b._cloneProps=function(a){return this.DisplayObject__cloneProps(a),a.textAlign=this.textAlign,a.textBaseline=this.textBaseline,a.maxWidth=this.maxWidth,a.outline=this.outline,a.lineHeight=this.lineHeight,a.lineWidth=this.lineWidth,a},b._prepContext=function(a){return a.font=this.font||"10px sans-serif",a.textAlign=this.textAlign||"left",a.textBaseline=this.textBaseline||"top",a.lineJoin="miter",a.miterLimit=2.5,a},b._drawText=function(b,c,d){var e=!!b;e||(b=a._workingContext,b.save(),this._prepContext(b));for(var f=this.lineHeight||this.getMeasuredLineHeight(),g=0,h=0,i=String(this.text).split(/(?:\r\n|\r|\n)/),j=0,k=i.length;k>j;j++){var l=i[j],m=null;if(null!=this.lineWidth&&(m=b.measureText(l).width)>this.lineWidth){var n=l.split(/(\s)/);l=n[0],m=b.measureText(l).width;for(var o=1,p=n.length;p>o;o+=2){var q=b.measureText(n[o]+n[o+1]).width;m+q>this.lineWidth?(e&&this._drawTextLine(b,l,h*f),d&&d.push(l),m>g&&(g=m),l=n[o+1],m=b.measureText(l).width,h++):(l+=n[o]+n[o+1],m+=q)}}e&&this._drawTextLine(b,l,h*f),d&&d.push(l),c&&null==m&&(m=b.measureText(l).width),m>g&&(g=m),h++}return c&&(c.width=g,c.height=h*f),e||b.restore(),c},b._drawTextLine=function(a,b,c){this.outline?a.strokeText(b,0,c,this.maxWidth||65535):a.fillText(b,0,c,this.maxWidth||65535)},b._getMeasuredWidth=function(b){var c=a._workingContext;c.save();var d=this._prepContext(c).measureText(b).width;return c.restore(),d},createjs.Text=createjs.promote(a,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b){this.Container_constructor(),this.text=a||"",this.spriteSheet=b,this.lineHeight=0,this.letterSpacing=0,this.spaceWidth=0,this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0},this._oldStage=null,this._drawAction=null}var b=createjs.extend(a,createjs.Container);a.maxPoolSize=100,a._spritePool=[],b.draw=function(a,b){this.DisplayObject_draw(a,b)||(this._updateState(),this.Container_draw(a,b))},b.getBounds=function(){return this._updateText(),this.Container_getBounds()},b.isVisible=function(){var a=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&this.alpha>0&&0!==this.scaleX&&0!==this.scaleY&&a)},b.clone=function(){return this._cloneProps(new a(this.text,this.spriteSheet))},b.addChild=b.addChildAt=b.removeChild=b.removeChildAt=b.removeAllChildren=function(){},b._updateState=function(){this._updateText()},b._cloneProps=function(a){return this.Container__cloneProps(a),a.lineHeight=this.lineHeight,a.letterSpacing=this.letterSpacing,a.spaceWidth=this.spaceWidth,a},b._getFrameIndex=function(a,b){var c,d=b.getAnimation(a);return d||(a!=(c=a.toUpperCase())||a!=(c=a.toLowerCase())||(c=null),c&&(d=b.getAnimation(c))),d&&d.frames[0]},b._getFrame=function(a,b){var c=this._getFrameIndex(a,b);return null==c?c:b.getFrame(c)},b._getLineHeight=function(a){var b=this._getFrame("1",a)||this._getFrame("T",a)||this._getFrame("L",a)||a.getFrame(0);return b?b.rect.height:1},b._getSpaceWidth=function(a){var b=this._getFrame("1",a)||this._getFrame("l",a)||this._getFrame("e",a)||this._getFrame("a",a)||a.getFrame(0);return b?b.rect.width:1},b._updateText=function(){var b,c=0,d=0,e=this._oldProps,f=!1,g=this.spaceWidth,h=this.lineHeight,i=this.spriteSheet,j=a._spritePool,k=this.children,l=0,m=k.length;for(var n in e)e[n]!=this[n]&&(e[n]=this[n],f=!0);if(f){var o=!!this._getFrame(" ",i);o||g||(g=this._getSpaceWidth(i)),h||(h=this._getLineHeight(i));for(var p=0,q=this.text.length;q>p;p++){var r=this.text.charAt(p);if(" "!=r||o)if("\n"!=r&&"\r"!=r){var s=this._getFrameIndex(r,i);null!=s&&(m>l?b=k[l]:(k.push(b=j.length?j.pop():new createjs.Sprite),b.parent=this,m++),b.spriteSheet=i,b.gotoAndStop(s),b.x=c,b.y=d,l++,c+=b.getBounds().width+this.letterSpacing)}else"\r"==r&&"\n"==this.text.charAt(p+1)&&p++,c=0,d+=h;else c+=g}for(;m>l;)j.push(b=k.pop()),b.parent=null,m--;j.length>a.maxPoolSize&&(j.length=a.maxPoolSize)}},createjs.BitmapText=createjs.promote(a,"Container")}(),this.createjs=this.createjs||{},function(){"use strict";function a(b){this.Container_constructor(),!a.inited&&a.init();var c,d,e,f;b instanceof String||arguments.length>1?(c=b,d=arguments[1],e=arguments[2],f=arguments[3],null==e&&(e=-1),b=null):b&&(c=b.mode,d=b.startPosition,e=b.loop,f=b.labels),b||(b={labels:f}),this.mode=c||a.INDEPENDENT,this.startPosition=d||0,this.loop=e===!0?-1:e||0,this.currentFrame=0,this.paused=b.paused||!1,this.actionsEnabled=!0,this.autoReset=!0,this.frameBounds=this.frameBounds||b.frameBounds,this.framerate=null,b.useTicks=b.paused=!0,this.timeline=new createjs.Timeline(b),this._synchOffset=0,this._rawPosition=-1,this._bound_resolveState=this._resolveState.bind(this),this._t=0,this._managed={}}function b(){throw"MovieClipPlugin cannot be instantiated."}var c=createjs.extend(a,createjs.Container);a.INDEPENDENT="independent",a.SINGLE_FRAME="single",a.SYNCHED="synched",a.inited=!1,a.init=function(){a.inited||(b.install(),a.inited=!0)},c._getLabels=function(){return this.timeline.getLabels()},c.getLabels=createjs.deprecate(c._getLabels,"MovieClip.getLabels"),c._getCurrentLabel=function(){return this.timeline.currentLabel},c.getCurrentLabel=createjs.deprecate(c._getCurrentLabel,"MovieClip.getCurrentLabel"),c._getDuration=function(){return this.timeline.duration},c.getDuration=createjs.deprecate(c._getDuration,"MovieClip.getDuration");try{Object.defineProperties(c,{labels:{get:c._getLabels},currentLabel:{get:c._getCurrentLabel},totalFrames:{get:c._getDuration},duration:{get:c._getDuration}})}catch(d){}c.initialize=a,c.isVisible=function(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)},c.draw=function(a,b){return this.DisplayObject_draw(a,b)?!0:(this._updateState(),this.Container_draw(a,b),!0)},c.play=function(){this.paused=!1},c.stop=function(){this.paused=!0},c.gotoAndPlay=function(a){this.paused=!1,this._goto(a)},c.gotoAndStop=function(a){this.paused=!0,this._goto(a)},c.advance=function(b){var c=a.INDEPENDENT;if(this.mode===c){for(var d=this,e=d.framerate;(d=d.parent)&&null===e;)d.mode===c&&(e=d._framerate);if(this._framerate=e,!this.paused){var f=null!==e&&-1!==e&&null!==b?b/(1e3/e)+this._t:1,g=0|f;for(this._t=f-g;g--;)this._updateTimeline(this._rawPosition+1,!1)}}},c.clone=function(){throw"MovieClip cannot be cloned."},c.toString=function(){return"[MovieClip (name="+this.name+")]"},c._updateState=function(){(-1===this._rawPosition||this.mode!==a.INDEPENDENT)&&this._updateTimeline(-1)},c._tick=function(a){this.advance(a&&a.delta),this.Container__tick(a)},c._goto=function(a){var b=this.timeline.resolve(a);null!=b&&(this._t=0,this._updateTimeline(b,!0))},c._reset=function(){this._rawPosition=-1,this._t=this.currentFrame=0,this.paused=!1},c._updateTimeline=function(b,c){var d=this.mode!==a.INDEPENDENT,e=this.timeline;d&&(b=this.startPosition+(this.mode===a.SINGLE_FRAME?0:this._synchOffset)),0>b&&(b=0),(this._rawPosition!==b||d)&&(this._rawPosition=b,e.loop=this.loop,e.setPosition(b,d||!this.actionsEnabled,c,this._bound_resolveState))},c._renderFirstFrame=function(){var a=this.timeline,b=a.rawPosition;a.setPosition(0,!0,!0,this._bound_resolveState),a.rawPosition=b},c._resolveState=function(){var a=this.timeline;this.currentFrame=a.position;for(var b in this._managed)this._managed[b]=1;for(var c=a.tweens,d=0,e=c.length;e>d;d++){var f=c[d],g=f.target;if(g!==this&&!f.passive){var h=f._stepPosition;g instanceof createjs.DisplayObject?this._addManagedChild(g,h):this._setState(g.state,h)}}var i=this.children;for(d=i.length-1;d>=0;d--){var j=i[d].id;1===this._managed[j]&&(this.removeChildAt(d),delete this._managed[j])}},c._setState=function(a,b){if(a)for(var c=a.length-1;c>=0;c--){var d=a[c],e=d.t,f=d.p;for(var g in f)e[g]=f[g];this._addManagedChild(e,b)}},c._addManagedChild=function(b,c){b._off||(this.addChildAt(b,0),b instanceof a&&(b._synchOffset=c,b.mode===a.INDEPENDENT&&b.autoReset&&!this._managed[b.id]&&b._reset()),this._managed[b.id]=2)},c._getBounds=function(a,b){var c=this.DisplayObject_getBounds();return c||this.frameBounds&&(c=this._rectangle.copy(this.frameBounds[this.currentFrame])),c?this._transformBounds(c,a,b):this.Container__getBounds(a,b)},createjs.MovieClip=createjs.promote(a,"Container"),b.priority=100,b.ID="MovieClip",b.install=function(){createjs.Tween._installPlugin(b)},b.init=function(c,d){"startPosition"===d&&c.target instanceof a&&c._addPlugin(b)},b.step=function(){},b.change=function(a,b,c,d,e){return"startPosition"===c?1===e?b.props[c]:b.prev.props[c]:void 0}}(),this.createjs=this.createjs||{},function(){"use strict";function a(){throw"SpriteSheetUtils cannot be instantiated"}var b=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");b.getContext&&(a._workingCanvas=b,a._workingContext=b.getContext("2d"),b.width=b.height=1),a.extractFrame=function(b,c){isNaN(c)&&(c=b.getAnimation(c).frames[0]);var d=b.getFrame(c);if(!d)return null;var e=d.rect,f=a._workingCanvas;f.width=e.width,f.height=e.height,a._workingContext.drawImage(d.image,e.x,e.y,e.width,e.height,0,0,e.width,e.height);var g=document.createElement("img");return g.src=f.toDataURL("image/png"),g},a.addFlippedFrames=createjs.deprecate(null,"SpriteSheetUtils.addFlippedFrames"),a.mergeAlpha=createjs.deprecate(null,"SpriteSheetUtils.mergeAlpha"),a._flip=function(b,c,d,e){for(var f=b._images,g=a._workingCanvas,h=a._workingContext,i=f.length/c,j=0;i>j;j++){var k=f[j];k.__tmp=j,h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,g.width+1,g.height+1),g.width=k.width,g.height=k.height,h.setTransform(d?-1:1,0,0,e?-1:1,d?k.width:0,e?k.height:0),h.drawImage(k,0,0);var l=document.createElement("img");l.src=g.toDataURL("image/png"),l.width=k.width||k.naturalWidth,l.height=k.height||k.naturalHeight,f.push(l)}var m=b._frames,n=m.length/c;for(j=0;n>j;j++){k=m[j];var o=k.rect.clone();l=f[k.image.__tmp+i*c];var p={image:l,rect:o,regX:k.regX,regY:k.regY};d&&(o.x=(l.width||l.naturalWidth)-o.x-o.width,p.regX=o.width-k.regX),e&&(o.y=(l.height||l.naturalHeight)-o.y-o.height,p.regY=o.height-k.regY),m.push(p)}var q="_"+(d?"h":"")+(e?"v":""),r=b._animations,s=b._data,t=r.length/c;for(j=0;t>j;j++){var u=r[j];k=s[u];var v={name:u+q,speed:k.speed,next:k.next,frames:[]};k.next&&(v.next+=q),m=k.frames;for(var w=0,x=m.length;x>w;w++)v.frames.push(m[w]+n*c);s[v.name]=v,r.push(v.name)}},createjs.SpriteSheetUtils=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.EventDispatcher_constructor(),this.maxWidth=2048,this.maxHeight=2048,this.spriteSheet=null,this.scale=1,this.padding=1,this.timeSlice=.3,this.progress=-1,this.framerate=a||0,this._frames=[],this._animations={},this._data=null,this._nextFrameIndex=0,
this._index=0,this._timerID=null,this._scale=1}var b=createjs.extend(a,createjs.EventDispatcher);a.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions",a.ERR_RUNNING="a build is already running",b.addFrame=function(b,c,d,e,f){if(this._data)throw a.ERR_RUNNING;var g=c||b.bounds||b.nominalBounds;return!g&&b.getBounds&&(g=b.getBounds()),g?(d=d||1,this._frames.push({source:b,sourceRect:g,scale:d,funct:e,data:f,index:this._frames.length,height:g.height*d})-1):null},b.addAnimation=function(b,c,d,e){if(this._data)throw a.ERR_RUNNING;this._animations[b]={frames:c,next:d,speed:e}},b.addMovieClip=function(b,c,d,e,f,g){if(this._data)throw a.ERR_RUNNING;var h=b.frameBounds,i=c||b.bounds||b.nominalBounds;if(!i&&b.getBounds&&(i=b.getBounds()),i||h){var j,k,l=this._frames.length,m=b.timeline.duration;for(j=0;m>j;j++){var n=h&&h[j]?h[j]:i;this.addFrame(b,n,d,this._setupMovieClipFrame,{i:j,f:e,d:f})}var o=b.timeline._labels,p=[];for(var q in o)p.push({index:o[q],label:q});if(p.length)for(p.sort(function(a,b){return a.index-b.index}),j=0,k=p.length;k>j;j++){for(var r=p[j].label,s=l+p[j].index,t=l+(j==k-1?m:p[j+1].index),u=[],v=s;t>v;v++)u.push(v);(!g||(r=g(r,b,s,t)))&&this.addAnimation(r,u,!0)}}},b.build=function(){if(this._data)throw a.ERR_RUNNING;for(this._startBuild();this._drawNext(););return this._endBuild(),this.spriteSheet},b.buildAsync=function(b){if(this._data)throw a.ERR_RUNNING;this.timeSlice=b,this._startBuild();var c=this;this._timerID=setTimeout(function(){c._run()},50-50*Math.max(.01,Math.min(.99,this.timeSlice||.3)))},b.stopAsync=function(){clearTimeout(this._timerID),this._data=null},b.clone=function(){throw"SpriteSheetBuilder cannot be cloned."},b.toString=function(){return"[SpriteSheetBuilder]"},b._startBuild=function(){var b=this.padding||0;this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale;var c=[];this._data={images:[],frames:c,framerate:this.framerate,animations:this._animations};var d=this._frames.slice();if(d.sort(function(a,b){return a.height<=b.height?-1:1}),d[d.length-1].height+2*b>this.maxHeight)throw a.ERR_DIMENSIONS;for(var e=0,f=0,g=0;d.length;){var h=this._fillRow(d,e,g,c,b);if(h.w>f&&(f=h.w),e+=h.h,!h.h||!d.length){var i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");i.width=this._getSize(f,this.maxWidth),i.height=this._getSize(e,this.maxHeight),this._data.images[g]=i,h.h||(f=e=0,g++)}}},b._setupMovieClipFrame=function(a,b){var c=a.actionsEnabled;a.actionsEnabled=!1,a.gotoAndStop(b.i),a.actionsEnabled=c,b.f&&b.f(a,b.d,b.i)},b._getSize=function(a,b){for(var c=4;Math.pow(2,++c)<a;);return Math.min(b,Math.pow(2,c))},b._fillRow=function(b,c,d,e,f){var g=this.maxWidth,h=this.maxHeight;c+=f;for(var i=h-c,j=f,k=0,l=b.length-1;l>=0;l--){var m=b[l],n=this._scale*m.scale,o=m.sourceRect,p=m.source,q=Math.floor(n*o.x-f),r=Math.floor(n*o.y-f),s=Math.ceil(n*o.height+2*f),t=Math.ceil(n*o.width+2*f);if(t>g)throw a.ERR_DIMENSIONS;s>i||j+t>g||(m.img=d,m.rect=new createjs.Rectangle(j,c,t,s),k=k||s,b.splice(l,1),e[m.index]=[j,c,t,s,d,Math.round(-q+n*p.regX-f),Math.round(-r+n*p.regY-f)],j+=t)}return{w:j,h:k}},b._endBuild=function(){this.spriteSheet=new createjs.SpriteSheet(this._data),this._data=null,this.progress=1,this.dispatchEvent("complete")},b._run=function(){for(var a=50*Math.max(.01,Math.min(.99,this.timeSlice||.3)),b=(new Date).getTime()+a,c=!1;b>(new Date).getTime();)if(!this._drawNext()){c=!0;break}if(c)this._endBuild();else{var d=this;this._timerID=setTimeout(function(){d._run()},50-a)}var e=this.progress=this._index/this._frames.length;if(this.hasEventListener("progress")){var f=new createjs.Event("progress");f.progress=e,this.dispatchEvent(f)}},b._drawNext=function(){var a=this._frames[this._index],b=a.scale*this._scale,c=a.rect,d=a.sourceRect,e=this._data.images[a.img],f=e.getContext("2d");return a.funct&&a.funct(a.source,a.data),f.save(),f.beginPath(),f.rect(c.x,c.y,c.width,c.height),f.clip(),f.translate(Math.ceil(c.x-d.x*b),Math.ceil(c.y-d.y*b)),f.scale(b,b),a.source.draw(f),f.restore(),++this._index<this._frames.length},createjs.SpriteSheetBuilder=createjs.promote(a,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.DisplayObject_constructor(),"string"==typeof a&&(a=document.getElementById(a)),this.mouseEnabled=!1;var b=a.style;b.position="absolute",b.transformOrigin=b.WebkitTransformOrigin=b.msTransformOrigin=b.MozTransformOrigin=b.OTransformOrigin="0% 0%",this.htmlElement=a,this._oldProps=null,this._oldStage=null,this._drawAction=null}var b=createjs.extend(a,createjs.DisplayObject);b.isVisible=function(){return null!=this.htmlElement},b.draw=function(){return!0},b.cache=function(){},b.uncache=function(){},b.updateCache=function(){},b.hitTest=function(){},b.localToGlobal=function(){},b.globalToLocal=function(){},b.localToLocal=function(){},b.clone=function(){throw"DOMElement cannot be cloned."},b.toString=function(){return"[DOMElement (name="+this.name+")]"},b._tick=function(a){var b=this.stage;b&&b!==this._oldStage&&(this._drawAction&&b.off("drawend",this._drawAction),this._drawAction=b.on("drawend",this._handleDrawEnd,this),this._oldStage=b),this.DisplayObject__tick(a)},b._handleDrawEnd=function(){var a=this.htmlElement;if(a){var b=a.style,c=this.getConcatenatedDisplayProps(this._props),d=c.matrix,e=c.visible?"visible":"hidden";if(e!=b.visibility&&(b.visibility=e),c.visible){var f=this._oldProps,g=f&&f.matrix,h=1e4;if(!g||!g.equals(d)){var i="matrix("+(d.a*h|0)/h+","+(d.b*h|0)/h+","+(d.c*h|0)/h+","+(d.d*h|0)/h+","+(d.tx+.5|0);b.transform=b.WebkitTransform=b.OTransform=b.msTransform=i+","+(d.ty+.5|0)+")",b.MozTransform=i+"px,"+(d.ty+.5|0)+"px)",f||(f=this._oldProps=new createjs.DisplayProps(!0,null)),f.matrix.copy(d)}f.alpha!=c.alpha&&(b.opacity=""+(c.alpha*h|0)/h,f.alpha=c.alpha)}}},createjs.DOMElement=createjs.promote(a,"DisplayObject")}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this.usesContext=!1,this._multiPass=null,this.VTX_SHADER_BODY=null,this.FRAG_SHADER_BODY=null}var b=a.prototype;b.getBounds=function(a){return a},b.shaderParamSetup=function(){},b.applyFilter=function(a,b,c,d,e,f,g,h){f=f||a,null==g&&(g=b),null==h&&(h=c);try{var i=a.getImageData(b,c,d,e)}catch(j){return!1}return this._applyFilter(i)?(f.putImageData(i,g,h),!0):!1},b.toString=function(){return"[Filter]"},b.clone=function(){return new a},b._applyFilter=function(){return!0},createjs.Filter=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this.width=void 0,this.height=void 0,this.x=void 0,this.y=void 0,this.scale=1,this.offX=0,this.offY=0,this.cacheID=0,this._filterOffX=0,this._filterOffY=0,this._cacheDataURLID=0,this._cacheDataURL=null,this._drawWidth=0,this._drawHeight=0}var b=a.prototype;a.getFilterBounds=function(a,b){b||(b=new createjs.Rectangle);var c=a.filters,d=c&&c.length;if(0>=!!d)return b;for(var e=0;d>e;e++){var f=c[e];if(f&&f.getBounds){var g=f.getBounds();g&&(0==e?b.setValues(g.x,g.y,g.width,g.height):b.extend(g.x,g.y,g.width,g.height))}}return b},b.toString=function(){return"[BitmapCache]"},b.define=function(a,b,c,d,e,f,g){if(!a)throw"No symbol to cache";this._options=g,this.target=a,this.width=d>=1?d:1,this.height=e>=1?e:1,this.x=b||0,this.y=c||0,this.scale=f||1,this.update()},b.update=function(b){if(!this.target)throw"define() must be called before update()";var c=a.getFilterBounds(this.target),d=this.target.cacheCanvas;this._drawWidth=Math.ceil(this.width*this.scale)+c.width,this._drawHeight=Math.ceil(this.height*this.scale)+c.height,d&&this._drawWidth==d.width&&this._drawHeight==d.height||this._updateSurface(),this._filterOffX=c.x,this._filterOffY=c.y,this.offX=this.x*this.scale+this._filterOffX,this.offY=this.y*this.scale+this._filterOffY,this._drawToCache(b),this.cacheID=this.cacheID?this.cacheID+1:1},b.release=function(){if(this._webGLCache)this._webGLCache.isCacheControlled||(this.__lastRT&&(this.__lastRT=void 0),this.__rtA&&this._webGLCache._killTextureObject(this.__rtA),this.__rtB&&this._webGLCache._killTextureObject(this.__rtB),this.target&&this.target.cacheCanvas&&this._webGLCache._killTextureObject(this.target.cacheCanvas)),this._webGLCache=!1;else{var a=this.target.stage;a instanceof createjs.StageGL&&a.releaseTexture(this.target.cacheCanvas)}this.target=this.target.cacheCanvas=null,this.cacheID=this._cacheDataURLID=this._cacheDataURL=void 0,this.width=this.height=this.x=this.y=this.offX=this.offY=0,this.scale=1},b.getCacheDataURL=function(){var a=this.target&&this.target.cacheCanvas;return a?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURLID=this.cacheID,this._cacheDataURL=a.toDataURL?a.toDataURL():null),this._cacheDataURL):null},b.draw=function(a){return this.target?(a.drawImage(this.target.cacheCanvas,this.x+this._filterOffX/this.scale,this.y+this._filterOffY/this.scale,this._drawWidth/this.scale,this._drawHeight/this.scale),!0):!1},b._updateSurface=function(){if(!this._options||!this._options.useGL){var a=this.target.cacheCanvas;return a||(a=this.target.cacheCanvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")),a.width=this._drawWidth,void(a.height=this._drawHeight)}if(!this._webGLCache)if("stage"===this._options.useGL){if(!this.target.stage||!this.target.stage.isWebGL){var b="Cannot use 'stage' for cache because the object's parent stage is ";throw b+=this.target.stage?"non WebGL.":"not set, please addChild to the correct stage."}this.target.cacheCanvas=!0,this._webGLCache=this.target.stage}else if("new"===this._options.useGL)this.target.cacheCanvas=document.createElement("canvas"),this._webGLCache=new createjs.StageGL(this.target.cacheCanvas,{antialias:!0,transparent:!0,autoPurge:-1}),this._webGLCache.isCacheControlled=!0;else{if(!(this._options.useGL instanceof createjs.StageGL))throw"Invalid option provided to useGL, expected ['stage', 'new', StageGL, undefined], got "+this._options.useGL;this.target.cacheCanvas=!0,this._webGLCache=this._options.useGL,this._webGLCache.isCacheControlled=!0}var a=this.target.cacheCanvas,c=this._webGLCache;c.isCacheControlled&&(a.width=this._drawWidth,a.height=this._drawHeight,c.updateViewport(this._drawWidth,this._drawHeight)),this.target.filters?(c.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight),c.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)):c.isCacheControlled||c.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)},b._drawToCache=function(a){var b=this.target.cacheCanvas,c=this.target,d=this._webGLCache;if(d)d.cacheDraw(c,c.filters,this),b=this.target.cacheCanvas,b.width=this._drawWidth,b.height=this._drawHeight;else{var e=b.getContext("2d");a||e.clearRect(0,0,this._drawWidth+1,this._drawHeight+1),e.save(),e.globalCompositeOperation=a,e.setTransform(this.scale,0,0,this.scale,-this._filterOffX,-this._filterOffY),e.translate(-this.x,-this.y),c.draw(e,!0),e.restore(),c.filters&&c.filters.length&&this._applyFilters(e)}b._invalid=!0},b._applyFilters=function(a){var b,c=this.target.filters,d=this._drawWidth,e=this._drawHeight,f=0,g=c[f];do g.usesContext?(b&&(a.putImageData(b,0,0),b=null),g.applyFilter(a,0,0,d,e)):(b||(b=a.getImageData(0,0,d,e)),g._applyFilter(b)),g=null!==g._multiPass?g._multiPass:c[++f];while(g);b&&a.putImageData(b,0,0)},createjs.BitmapCache=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c){this.Filter_constructor(),this._blurX=a,this._blurXTable=[],this._lastBlurX=null,this._blurY=b,this._blurYTable=[],this._lastBlurY=null,this._quality,this._lastQuality=null,this.FRAG_SHADER_TEMPLATE="uniform float xWeight[{{blurX}}];uniform float yWeight[{{blurY}}];uniform vec2 textureOffset;void main(void) {vec4 color = vec4(0.0);float xAdj = ({{blurX}}.0-1.0)/2.0;float yAdj = ({{blurY}}.0-1.0)/2.0;vec2 sampleOffset;for(int i=0; i<{{blurX}}; i++) {for(int j=0; j<{{blurY}}; j++) {sampleOffset = vRenderCoord + (textureOffset * vec2(float(i)-xAdj, float(j)-yAdj));color += texture2D(uSampler, sampleOffset) * (xWeight[i] * yWeight[j]);}}gl_FragColor = color.rgba;}",(isNaN(c)||1>c)&&(c=1),this.setQuality(0|c)}var b=createjs.extend(a,createjs.Filter);b.getBlurX=function(){return this._blurX},b.getBlurY=function(){return this._blurY},b.setBlurX=function(a){(isNaN(a)||0>a)&&(a=0),this._blurX=a},b.setBlurY=function(a){(isNaN(a)||0>a)&&(a=0),this._blurY=a},b.getQuality=function(){return this._quality},b.setQuality=function(a){(isNaN(a)||0>a)&&(a=0),this._quality=0|a},b._getShader=function(){var a=this._lastBlurX!==this._blurX,b=this._lastBlurY!==this._blurY,c=this._lastQuality!==this._quality;return a||b||c?((a||c)&&(this._blurXTable=this._getTable(this._blurX*this._quality)),(b||c)&&(this._blurYTable=this._getTable(this._blurY*this._quality)),this._updateShader(),this._lastBlurX=this._blurX,this._lastBlurY=this._blurY,void(this._lastQuality=this._quality)):this._compiledShader},b._setShader=function(){this._compiledShader};try{Object.defineProperties(b,{blurX:{get:b.getBlurX,set:b.setBlurX},blurY:{get:b.getBlurY,set:b.setBlurY},quality:{get:b.getQuality,set:b.setQuality},_builtShader:{get:b._getShader,set:b._setShader}})}catch(c){}b._getTable=function(a){var b=4.2;if(1>=a)return[1];var c=[],d=Math.ceil(2*a);d+=d%2?0:1;for(var e=d/2|0,f=-e;e>=f;f++){var g=f/e*b;c.push(1/Math.sqrt(2*Math.PI)*Math.pow(Math.E,-(Math.pow(g,2)/4)))}var h=c.reduce(function(a,b){return a+b});return c.map(function(a){return a/h})},b._updateShader=function(){if(void 0!==this._blurX&&void 0!==this._blurY){var a=this.FRAG_SHADER_TEMPLATE;a=a.replace(/\{\{blurX\}\}/g,this._blurXTable.length.toFixed(0)),a=a.replace(/\{\{blurY\}\}/g,this._blurYTable.length.toFixed(0)),this.FRAG_SHADER_BODY=a}},b.shaderParamSetup=function(a,b,c){a.uniform1fv(a.getUniformLocation(c,"xWeight"),this._blurXTable),a.uniform1fv(a.getUniformLocation(c,"yWeight"),this._blurYTable),a.uniform2f(a.getUniformLocation(c,"textureOffset"),2/(b._viewportWidth*this._quality),2/(b._viewportHeight*this._quality))},a.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],a.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9],b.getBounds=function(a){var b=0|this.blurX,c=0|this.blurY;if(0>=b&&0>=c)return a;var d=Math.pow(this.quality,.2);return(a||new createjs.Rectangle).pad(c*d+1,b*d+1,c*d+1,b*d+1)},b.clone=function(){return new a(this.blurX,this.blurY,this.quality)},b.toString=function(){return"[BlurFilter]"},b._applyFilter=function(b){var c=this._blurX>>1;if(isNaN(c)||0>c)return!1;var d=this._blurY>>1;if(isNaN(d)||0>d)return!1;if(0==c&&0==d)return!1;var e=this.quality;(isNaN(e)||1>e)&&(e=1),e|=0,e>3&&(e=3),1>e&&(e=1);var f=b.data,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=c+c+1|0,w=d+d+1|0,x=0|b.width,y=0|b.height,z=x-1|0,A=y-1|0,B=c+1|0,C=d+1|0,D={r:0,b:0,g:0,a:0},E=D;for(i=1;v>i;i++)E=E.n={r:0,b:0,g:0,a:0};E.n=D;var F={r:0,b:0,g:0,a:0},G=F;for(i=1;w>i;i++)G=G.n={r:0,b:0,g:0,a:0};G.n=F;for(var H=null,I=0|a.MUL_TABLE[c],J=0|a.SHG_TABLE[c],K=0|a.MUL_TABLE[d],L=0|a.SHG_TABLE[d];e-->0;){m=l=0;var M=I,N=J;for(h=y;--h>-1;){for(n=B*(r=f[0|l]),o=B*(s=f[l+1|0]),p=B*(t=f[l+2|0]),q=B*(u=f[l+3|0]),E=D,i=B;--i>-1;)E.r=r,E.g=s,E.b=t,E.a=u,E=E.n;for(i=1;B>i;i++)j=l+((i>z?z:i)<<2)|0,n+=E.r=f[j],o+=E.g=f[j+1],p+=E.b=f[j+2],q+=E.a=f[j+3],E=E.n;for(H=D,g=0;x>g;g++)f[l++]=n*M>>>N,f[l++]=o*M>>>N,f[l++]=p*M>>>N,f[l++]=q*M>>>N,j=m+((j=g+c+1)<z?j:z)<<2,n-=H.r-(H.r=f[j]),o-=H.g-(H.g=f[j+1]),p-=H.b-(H.b=f[j+2]),q-=H.a-(H.a=f[j+3]),H=H.n;m+=x}for(M=K,N=L,g=0;x>g;g++){for(l=g<<2|0,n=C*(r=f[l])|0,o=C*(s=f[l+1|0])|0,p=C*(t=f[l+2|0])|0,q=C*(u=f[l+3|0])|0,G=F,i=0;C>i;i++)G.r=r,G.g=s,G.b=t,G.a=u,G=G.n;for(k=x,i=1;d>=i;i++)l=k+g<<2,n+=G.r=f[l],o+=G.g=f[l+1],p+=G.b=f[l+2],q+=G.a=f[l+3],G=G.n,A>i&&(k+=x);if(l=g,H=F,e>0)for(h=0;y>h;h++)j=l<<2,f[j+3]=u=q*M>>>N,u>0?(f[j]=n*M>>>N,f[j+1]=o*M>>>N,f[j+2]=p*M>>>N):f[j]=f[j+1]=f[j+2]=0,j=g+((j=h+C)<A?j:A)*x<<2,n-=H.r-(H.r=f[j]),o-=H.g-(H.g=f[j+1]),p-=H.b-(H.b=f[j+2]),q-=H.a-(H.a=f[j+3]),H=H.n,l+=x;else for(h=0;y>h;h++)j=l<<2,f[j+3]=u=q*M>>>N,u>0?(u=255/u,f[j]=(n*M>>>N)*u,f[j+1]=(o*M>>>N)*u,f[j+2]=(p*M>>>N)*u):f[j]=f[j+1]=f[j+2]=0,j=g+((j=h+C)<A?j:A)*x<<2,n-=H.r-(H.r=f[j]),o-=H.g-(H.g=f[j+1]),p-=H.b-(H.b=f[j+2]),q-=H.a-(H.a=f[j+3]),H=H.n,l+=x}}return!0},createjs.BlurFilter=createjs.promote(a,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.Filter_constructor(),this.alphaMap=a,this._alphaMap=null,this._mapData=null,this._mapTexture=null,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * (alphaMap.r * ceil(alphaMap.a)));}"}var b=createjs.extend(a,createjs.Filter);b.shaderParamSetup=function(a,b,c){this._mapTexture||(this._mapTexture=a.createTexture()),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._mapTexture),b.setTextureParams(a),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.alphaMap),a.uniform1i(a.getUniformLocation(c,"uAlphaSampler"),1)},b.clone=function(){var b=new a(this.alphaMap);return b._alphaMap=this._alphaMap,b._mapData=this._mapData,b},b.toString=function(){return"[AlphaMapFilter]"},b._applyFilter=function(a){if(!this.alphaMap)return!0;if(!this._prepAlphaMap())return!1;for(var b=a.data,c=this._mapData,d=0,e=b.length;e>d;d+=4)b[d+3]=c[d]||0;return!0},b._prepAlphaMap=function(){if(!this.alphaMap)return!1;if(this.alphaMap==this._alphaMap&&this._mapData)return!0;this._mapData=null;var a,b=this._alphaMap=this.alphaMap,c=b;b instanceof HTMLCanvasElement?a=c.getContext("2d"):(c=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),c.width=b.width,c.height=b.height,a=c.getContext("2d"),a.drawImage(b,0,0));try{var d=a.getImageData(0,0,b.width,b.height)}catch(e){return!1}return this._mapData=d.data,!0},createjs.AlphaMapFilter=createjs.promote(a,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.Filter_constructor(),this.mask=a,this.usesContext=!0,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * alphaMap.a);}"}var b=createjs.extend(a,createjs.Filter);b.shaderParamSetup=function(a,b,c){this._mapTexture||(this._mapTexture=a.createTexture()),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._mapTexture),b.setTextureParams(a),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.mask),a.uniform1i(a.getUniformLocation(c,"uAlphaSampler"),1)},b.applyFilter=function(a,b,c,d,e,f,g,h){return this.mask?(f=f||a,null==g&&(g=b),null==h&&(h=c),f.save(),a!=f?!1:(f.globalCompositeOperation="destination-in",f.drawImage(this.mask,g,h),f.restore(),!0)):!0},b.clone=function(){return new a(this.mask)},b.toString=function(){return"[AlphaMaskFilter]"},createjs.AlphaMaskFilter=createjs.promote(a,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c,d,e,f,g,h){this.Filter_constructor(),this.redMultiplier=null!=a?a:1,this.greenMultiplier=null!=b?b:1,this.blueMultiplier=null!=c?c:1,this.alphaMultiplier=null!=d?d:1,this.redOffset=e||0,this.greenOffset=f||0,this.blueOffset=g||0,this.alphaOffset=h||0,this.FRAG_SHADER_BODY="uniform vec4 uColorMultiplier;uniform vec4 uColorOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = (color * uColorMultiplier) + uColorOffset;}"}var b=createjs.extend(a,createjs.Filter);b.shaderParamSetup=function(a,b,c){a.uniform4f(a.getUniformLocation(c,"uColorMultiplier"),this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier),a.uniform4f(a.getUniformLocation(c,"uColorOffset"),this.redOffset/255,this.greenOffset/255,this.blueOffset/255,this.alphaOffset/255)},b.toString=function(){return"[ColorFilter]"},b.clone=function(){return new a(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)},b._applyFilter=function(a){for(var b=a.data,c=b.length,d=0;c>d;d+=4)b[d]=b[d]*this.redMultiplier+this.redOffset,b[d+1]=b[d+1]*this.greenMultiplier+this.greenOffset,b[d+2]=b[d+2]*this.blueMultiplier+this.blueOffset,b[d+3]=b[d+3]*this.alphaMultiplier+this.alphaOffset;return!0},createjs.ColorFilter=createjs.promote(a,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c,d){this.setColor(a,b,c,d)}var b=a.prototype;a.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],a.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],a.LENGTH=a.IDENTITY_MATRIX.length,b.setColor=function(a,b,c,d){return this.reset().adjustColor(a,b,c,d)},b.reset=function(){return this.copy(a.IDENTITY_MATRIX)},b.adjustColor=function(a,b,c,d){return this.adjustHue(d),this.adjustContrast(b),this.adjustBrightness(a),this.adjustSaturation(c)},b.adjustBrightness=function(a){return 0==a||isNaN(a)?this:(a=this._cleanValue(a,255),this._multiplyMatrix([1,0,0,0,a,0,1,0,0,a,0,0,1,0,a,0,0,0,1,0,0,0,0,0,1]),this)},b.adjustContrast=function(b){if(0==b||isNaN(b))return this;b=this._cleanValue(b,100);var c;return 0>b?c=127+b/100*127:(c=b%1,c=0==c?a.DELTA_INDEX[b]:a.DELTA_INDEX[b<<0]*(1-c)+a.DELTA_INDEX[(b<<0)+1]*c,c=127*c+127),this._multiplyMatrix([c/127,0,0,0,.5*(127-c),0,c/127,0,0,.5*(127-c),0,0,c/127,0,.5*(127-c),0,0,0,1,0,0,0,0,0,1]),this},b.adjustSaturation=function(a){if(0==a||isNaN(a))return this;a=this._cleanValue(a,100);var b=1+(a>0?3*a/100:a/100),c=.3086,d=.6094,e=.082;return this._multiplyMatrix([c*(1-b)+b,d*(1-b),e*(1-b),0,0,c*(1-b),d*(1-b)+b,e*(1-b),0,0,c*(1-b),d*(1-b),e*(1-b)+b,0,0,0,0,0,1,0,0,0,0,0,1]),this},b.adjustHue=function(a){if(0==a||isNaN(a))return this;a=this._cleanValue(a,180)/180*Math.PI;var b=Math.cos(a),c=Math.sin(a),d=.213,e=.715,f=.072;return this._multiplyMatrix([d+b*(1-d)+c*-d,e+b*-e+c*-e,f+b*-f+c*(1-f),0,0,d+b*-d+.143*c,e+b*(1-e)+.14*c,f+b*-f+c*-.283,0,0,d+b*-d+c*-(1-d),e+b*-e+c*e,f+b*(1-f)+c*f,0,0,0,0,0,1,0,0,0,0,0,1]),this},b.concat=function(b){return b=this._fixMatrix(b),b.length!=a.LENGTH?this:(this._multiplyMatrix(b),this)},b.clone=function(){return(new a).copy(this)},b.toArray=function(){for(var b=[],c=0,d=a.LENGTH;d>c;c++)b[c]=this[c];return b},b.copy=function(b){for(var c=a.LENGTH,d=0;c>d;d++)this[d]=b[d];return this},b.toString=function(){return"[ColorMatrix]"},b._multiplyMatrix=function(a){var b,c,d,e=[];for(b=0;5>b;b++){for(c=0;5>c;c++)e[c]=this[c+5*b];for(c=0;5>c;c++){var f=0;for(d=0;5>d;d++)f+=a[c+5*d]*e[d];this[c+5*b]=f}}},b._cleanValue=function(a,b){return Math.min(b,Math.max(-b,a))},b._fixMatrix=function(b){return b instanceof a&&(b=b.toArray()),b.length<a.LENGTH?b=b.slice(0,b.length).concat(a.IDENTITY_MATRIX.slice(b.length,a.LENGTH)):b.length>a.LENGTH&&(b=b.slice(0,a.LENGTH)),b},createjs.ColorMatrix=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.Filter_constructor(),this.matrix=a,this.FRAG_SHADER_BODY="uniform mat4 uColorMatrix;uniform vec4 uColorMatrixOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);mat4 m = uColorMatrix;vec4 newColor = vec4(0,0,0,0);newColor.r = color.r*m[0][0] + color.g*m[0][1] + color.b*m[0][2] + color.a*m[0][3];newColor.g = color.r*m[1][0] + color.g*m[1][1] + color.b*m[1][2] + color.a*m[1][3];newColor.b = color.r*m[2][0] + color.g*m[2][1] + color.b*m[2][2] + color.a*m[2][3];newColor.a = color.r*m[3][0] + color.g*m[3][1] + color.b*m[3][2] + color.a*m[3][3];gl_FragColor = newColor + uColorMatrixOffset;}"}var b=createjs.extend(a,createjs.Filter);b.shaderParamSetup=function(a,b,c){var d=this.matrix,e=new Float32Array([d[0],d[1],d[2],d[3],d[5],d[6],d[7],d[8],d[10],d[11],d[12],d[13],d[15],d[16],d[17],d[18]]);a.uniformMatrix4fv(a.getUniformLocation(c,"uColorMatrix"),!1,e),a.uniform4f(a.getUniformLocation(c,"uColorMatrixOffset"),d[4]/255,d[9]/255,d[14]/255,d[19]/255)},b.toString=function(){return"[ColorMatrixFilter]"},b.clone=function(){return new a(this.matrix)},b._applyFilter=function(a){for(var b,c,d,e,f=a.data,g=f.length,h=this.matrix,i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=h[5],o=h[6],p=h[7],q=h[8],r=h[9],s=h[10],t=h[11],u=h[12],v=h[13],w=h[14],x=h[15],y=h[16],z=h[17],A=h[18],B=h[19],C=0;g>C;C+=4)b=f[C],c=f[C+1],d=f[C+2],e=f[C+3],f[C]=b*i+c*j+d*k+e*l+m,f[C+1]=b*n+c*o+d*p+e*q+r,f[C+2]=b*s+c*t+d*u+e*v+w,f[C+3]=b*x+c*y+d*z+e*A+B;return!0},createjs.ColorMatrixFilter=createjs.promote(a,"Filter")}(),this.createjs=this.createjs||{},function(){"use strict";function a(){throw"Touch cannot be instantiated"}a.isSupported=function(){return!!("ontouchstart"in window||window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>0||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>0)},a.enable=function(b,c,d){return b&&b.canvas&&a.isSupported()?b.__touch?!0:(b.__touch={pointers:{},multitouch:!c,preventDefault:!d,count:0},"ontouchstart"in window?a._IOS_enable(b):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&a._IE_enable(b),!0):!1},a.disable=function(b){b&&("ontouchstart"in window?a._IOS_disable(b):(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&a._IE_disable(b),delete b.__touch)},a._IOS_enable=function(b){var c=b.canvas,d=b.__touch.f=function(c){a._IOS_handleEvent(b,c)};c.addEventListener("touchstart",d,!1),c.addEventListener("touchmove",d,!1),c.addEventListener("touchend",d,!1),c.addEventListener("touchcancel",d,!1)},a._IOS_disable=function(a){var b=a.canvas;if(b){var c=a.__touch.f;b.removeEventListener("touchstart",c,!1),b.removeEventListener("touchmove",c,!1),b.removeEventListener("touchend",c,!1),b.removeEventListener("touchcancel",c,!1)}},a._IOS_handleEvent=function(a,b){if(a){a.__touch.preventDefault&&b.preventDefault&&b.preventDefault();for(var c=b.changedTouches,d=b.type,e=0,f=c.length;f>e;e++){var g=c[e],h=g.identifier;g.target==a.canvas&&("touchstart"==d?this._handleStart(a,h,b,g.pageX,g.pageY):"touchmove"==d?this._handleMove(a,h,b,g.pageX,g.pageY):("touchend"==d||"touchcancel"==d)&&this._handleEnd(a,h,b))}}},a._IE_enable=function(b){var c=b.canvas,d=b.__touch.f=function(c){a._IE_handleEvent(b,c)};void 0===window.navigator.pointerEnabled?(c.addEventListener("MSPointerDown",d,!1),window.addEventListener("MSPointerMove",d,!1),window.addEventListener("MSPointerUp",d,!1),window.addEventListener("MSPointerCancel",d,!1),b.__touch.preventDefault&&(c.style.msTouchAction="none")):(c.addEventListener("pointerdown",d,!1),window.addEventListener("pointermove",d,!1),window.addEventListener("pointerup",d,!1),window.addEventListener("pointercancel",d,!1),b.__touch.preventDefault&&(c.style.touchAction="none")),b.__touch.activeIDs={}},a._IE_disable=function(a){var b=a.__touch.f;void 0===window.navigator.pointerEnabled?(window.removeEventListener("MSPointerMove",b,!1),window.removeEventListener("MSPointerUp",b,!1),window.removeEventListener("MSPointerCancel",b,!1),a.canvas&&a.canvas.removeEventListener("MSPointerDown",b,!1)):(window.removeEventListener("pointermove",b,!1),window.removeEventListener("pointerup",b,!1),window.removeEventListener("pointercancel",b,!1),a.canvas&&a.canvas.removeEventListener("pointerdown",b,!1))},a._IE_handleEvent=function(a,b){if(a){a.__touch.preventDefault&&b.preventDefault&&b.preventDefault();var c=b.type,d=b.pointerId,e=a.__touch.activeIDs;if("MSPointerDown"==c||"pointerdown"==c){if(b.srcElement!=a.canvas)return;e[d]=!0,this._handleStart(a,d,b,b.pageX,b.pageY)}else e[d]&&("MSPointerMove"==c||"pointermove"==c?this._handleMove(a,d,b,b.pageX,b.pageY):("MSPointerUp"==c||"MSPointerCancel"==c||"pointerup"==c||"pointercancel"==c)&&(delete e[d],this._handleEnd(a,d,b)))}},a._handleStart=function(a,b,c,d,e){var f=a.__touch;if(f.multitouch||!f.count){var g=f.pointers;g[b]||(g[b]=!0,f.count++,a._handlePointerDown(b,c,d,e))}},a._handleMove=function(a,b,c,d,e){a.__touch.pointers[b]&&a._handlePointerMove(b,c,d,e)},a._handleEnd=function(a,b,c){var d=a.__touch,e=d.pointers;e[b]&&(d.count--,a._handlePointerUp(b,c,!0),delete e[b])},createjs.Touch=a}(),this.createjs=this.createjs||{},function(){"use strict";var a=createjs.EaselJS=createjs.EaselJS||{};a.version="NEXT",a.buildDate="Mon, 17 Jul 2017 17:06:39 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(a,b){"use strict";function c(){this.constructor=a}return c.prototype=b.prototype,a.prototype=new c},this.createjs=this.createjs||{},createjs.promote=function(a,b){"use strict";var c=a.prototype,d=Object.getPrototypeOf&&Object.getPrototypeOf(c)||c.__proto__;if(d){c[(b+="_")+"constructor"]=d.constructor;for(var e in d)c.hasOwnProperty(e)&&"function"==typeof d[e]&&(c[b+e]=d[e])}return a},this.createjs=this.createjs||{},function(){"use strict";function a(a,b,c){this.type=a,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!b,this.cancelable=!!c,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var b=a.prototype;b.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},b.stopPropagation=function(){this.propagationStopped=!0},b.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},b.remove=function(){this.removed=!0},b.clone=function(){return new a(this.type,this.bubbles,this.cancelable)},b.set=function(a){for(var b in a)this[b]=a[b];return this},b.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this._listeners=null,this._captureListeners=null}var b=a.prototype;a.initialize=function(a){a.addEventListener=b.addEventListener,a.on=b.on,a.removeEventListener=a.off=b.removeEventListener,a.removeAllEventListeners=b.removeAllEventListeners,a.hasEventListener=b.hasEventListener,a.dispatchEvent=b.dispatchEvent,a._dispatchEvent=b._dispatchEvent,a.willTrigger=b.willTrigger},b.addEventListener=function(a,b,c){var d;d=c?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};
var e=d[a];return e&&this.removeEventListener(a,b,c),e=d[a],e?e.push(b):d[a]=[b],b},b.on=function(a,b,c,d,e,f){return b.handleEvent&&(c=c||b,b=b.handleEvent),c=c||this,this.addEventListener(a,function(a){b.call(c,a,e),d&&a.remove()},f)},b.removeEventListener=function(a,b,c){var d=c?this._captureListeners:this._listeners;if(d){var e=d[a];if(e)for(var f=0,g=e.length;g>f;f++)if(e[f]==b){1==g?delete d[a]:e.splice(f,1);break}}},b.off=b.removeEventListener,b.removeAllEventListeners=function(a){a?(this._listeners&&delete this._listeners[a],this._captureListeners&&delete this._captureListeners[a]):this._listeners=this._captureListeners=null},b.dispatchEvent=function(a,b,c){if("string"==typeof a){var d=this._listeners;if(!(b||d&&d[a]))return!0;a=new createjs.Event(a,b,c)}else a.target&&a.clone&&(a=a.clone());try{a.target=this}catch(e){}if(a.bubbles&&this.parent){for(var f=this,g=[f];f.parent;)g.push(f=f.parent);var h,i=g.length;for(h=i-1;h>=0&&!a.propagationStopped;h--)g[h]._dispatchEvent(a,1+(0==h));for(h=1;i>h&&!a.propagationStopped;h++)g[h]._dispatchEvent(a,3)}else this._dispatchEvent(a,2);return!a.defaultPrevented},b.hasEventListener=function(a){var b=this._listeners,c=this._captureListeners;return!!(b&&b[a]||c&&c[a])},b.willTrigger=function(a){for(var b=this;b;){if(b.hasEventListener(a))return!0;b=b.parent}return!1},b.toString=function(){return"[EventDispatcher]"},b._dispatchEvent=function(a,b){var c,d,e=2>=b?this._captureListeners:this._listeners;if(a&&e&&(d=e[a.type])&&(c=d.length)){try{a.currentTarget=this}catch(f){}try{a.eventPhase=0|b}catch(f){}a.removed=!1,d=d.slice();for(var g=0;c>g&&!a.immediatePropagationStopped;g++){var h=d[g];h.handleEvent?h.handleEvent(a):h(a),a.removed&&(this.off(a.type,h,1==b),a.removed=!1)}}2===b&&this._dispatchEvent(a,2.1)},createjs.EventDispatcher=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(){throw"Ticker cannot be instantiated."}a.RAF_SYNCHED="synched",a.RAF="raf",a.TIMEOUT="timeout",a.timingMode=null,a.maxDelta=0,a.paused=!1,a.removeEventListener=null,a.removeAllEventListeners=null,a.dispatchEvent=null,a.hasEventListener=null,a._listeners=null,createjs.EventDispatcher.initialize(a),a._addEventListener=a.addEventListener,a.addEventListener=function(){return!a._inited&&a.init(),a._addEventListener.apply(a,arguments)},a._inited=!1,a._startTime=0,a._pausedTime=0,a._ticks=0,a._pausedTicks=0,a._interval=50,a._lastTime=0,a._times=null,a._tickTimes=null,a._timerId=null,a._raf=!0,a._setInterval=function(b){a._interval=b,a._inited&&a._setupTick()},a._getInterval=function(){return a._interval},a._setFPS=function(b){a._setInterval(1e3/b)},a._getFPS=function(){return 1e3/a._interval};try{Object.defineProperties(a,{interval:{get:a._getInterval,set:a._setInterval},framerate:{get:a._getFPS,set:a._setFPS}})}catch(b){}a.init=function(){a._inited||(a._inited=!0,a._times=[],a._tickTimes=[],a._startTime=a._getTime(),a._times.push(a._lastTime=0),a.interval=a._interval)},a.reset=function(){if(a._raf){var b=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;b&&b(a._timerId)}else clearTimeout(a._timerId);a.removeAllEventListeners("tick"),a._timerId=a._times=a._tickTimes=null,a._startTime=a._lastTime=a._ticks=a._pausedTime=0,a._inited=!1},a.getMeasuredTickTime=function(b){var c=0,d=a._tickTimes;if(!d||d.length<1)return-1;b=Math.min(d.length,b||0|a._getFPS());for(var e=0;b>e;e++)c+=d[e];return c/b},a.getMeasuredFPS=function(b){var c=a._times;return!c||c.length<2?-1:(b=Math.min(c.length-1,b||0|a._getFPS()),1e3/((c[0]-c[b])/b))},a.getTime=function(b){return a._startTime?a._getTime()-(b?a._pausedTime:0):-1},a.getEventTime=function(b){return a._startTime?(a._lastTime||a._startTime)-(b?a._pausedTime:0):-1},a.getTicks=function(b){return a._ticks-(b?a._pausedTicks:0)},a._handleSynch=function(){a._timerId=null,a._setupTick(),a._getTime()-a._lastTime>=.97*(a._interval-1)&&a._tick()},a._handleRAF=function(){a._timerId=null,a._setupTick(),a._tick()},a._handleTimeout=function(){a._timerId=null,a._setupTick(),a._tick()},a._setupTick=function(){if(null==a._timerId){var b=a.timingMode;if(b==a.RAF_SYNCHED||b==a.RAF){var c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(c)return a._timerId=c(b==a.RAF?a._handleRAF:a._handleSynch),void(a._raf=!0)}a._raf=!1,a._timerId=setTimeout(a._handleTimeout,a._interval)}},a._tick=function(){var b=a.paused,c=a._getTime(),d=c-a._lastTime;if(a._lastTime=c,a._ticks++,b&&(a._pausedTicks++,a._pausedTime+=d),a.hasEventListener("tick")){var e=new createjs.Event("tick"),f=a.maxDelta;e.delta=f&&d>f?f:d,e.paused=b,e.time=c,e.runTime=c-a._pausedTime,a.dispatchEvent(e)}for(a._tickTimes.unshift(a._getTime()-c);a._tickTimes.length>100;)a._tickTimes.pop();for(a._times.unshift(c);a._times.length>100;)a._times.pop()};var c=window,d=c.performance.now||c.performance.mozNow||c.performance.msNow||c.performance.oNow||c.performance.webkitNow;a._getTime=function(){return(d&&d.call(c.performance)||(new Date).getTime())-a._startTime},createjs.Ticker=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){this.EventDispatcher_constructor(),this.ignoreGlobalPause=!1,this.loop=0,this.useTicks=!1,this.reversed=!1,this.bounce=!1,this.timeScale=1,this.duration=0,this.position=0,this.rawPosition=-1,this._paused=!0,this._next=null,this._prev=null,this._parent=null,this._labels=null,this._labelList=null,a&&(this.useTicks=!!a.useTicks,this.ignoreGlobalPause=!!a.ignoreGlobalPause,this.loop=a.loop===!0?-1:a.loop||0,this.reversed=!!a.reversed,this.bounce=!!a.bounce,this.timeScale=a.timeScale||1,a.onChange&&this.addEventListener("change",a.onChange),a.onComplete&&this.addEventListener("complete",a.onComplete))}var b=createjs.extend(a,createjs.EventDispatcher);b.setPaused=function(a){return createjs.Tween._register(this,a),this},b.getPaused=function(){return this._paused},b.getCurrentLabel=function(a){var b=this.getLabels();null==a&&(a=this.position);for(var c=0,d=b.length;d>c&&!(a<b[c].position);c++);return 0===c?null:b[c-1].label};try{Object.defineProperties(b,{paused:{set:b.setPaused,get:b.getPaused},currentLabel:{get:b.getCurrentLabel}})}catch(c){}b.advance=function(a,b){this.setPosition(this.rawPosition+a*this.timeScale,b)},b.setPosition=function(a,b,c,d){var e=this.duration,f=this.loop,g=this.rawPosition,h=0,i=0,j=!1;if(0>a&&(a=0),0===e){if(j=!0,-1!==g)return j}else{if(h=a/e|0,i=a-h*e,j=-1!==f&&a>=f*e+e,j&&(a=(i=e)*(h=f)+e),a===g)return j;var k=!this.reversed!=!(this.bounce&&h%2);k&&(i=e-i)}this.position=i,this.rawPosition=a,this._updatePosition(c,j),j&&(this.paused=!0),d&&d(this),b||this._runActions(g,a,c,!c&&-1===g),this.dispatchEvent("change"),j&&this.dispatchEvent("complete")},b.calculatePosition=function(a){var b=this.duration,c=this.loop,d=0,e=0;if(0===b)return 0;-1!==c&&a>=c*b+b?(e=b,d=c):0>a?e=0:(d=a/b|0,e=a-d*b);var f=!this.reversed!=!(this.bounce&&d%2);return f?b-e:e},b.getLabels=function(){var a=this._labelList;if(!a){a=this._labelList=[];var b=this._labels;for(var c in b)a.push({label:c,position:b[c]});a.sort(function(a,b){return a.position-b.position})}return a},b.setLabels=function(a){this._labels=a,this._labelList=null},b.addLabel=function(a,b){this._labels||(this._labels={}),this._labels[a]=b;var c=this._labelList;if(c){for(var d=0,e=c.length;e>d&&!(b<c[d].position);d++);c.splice(d,0,{label:a,position:b})}},b.gotoAndPlay=function(a){this.paused=!1,this._goto(a)},b.gotoAndStop=function(a){this.paused=!0,this._goto(a)},b.resolve=function(a){var b=Number(a);return isNaN(b)&&(b=this._labels&&this._labels[a]),b},b.toString=function(){return"[AbstractTween]"},b.clone=function(){throw"AbstractTween can not be cloned."},b._init=function(a){a&&a.paused||(this.paused=!1),a&&null!=a.position&&this.setPosition(a.position)},b._updatePosition=function(){},b._goto=function(a){var b=this.resolve(a);null!=b&&this.setPosition(b,!1,!0)},b._runActions=function(a,b,c,d){if(this._actionHead||this.tweens){var e,f,g,h,i=this.duration,j=this.reversed,k=this.bounce,l=this.loop;if(0===i?(e=f=g=h=0,j=k=!1):(e=a/i|0,f=b/i|0,g=a-e*i,h=b-f*i),-1!==l&&(f>l&&(h=i,f=l),e>l&&(g=i,e=l)),c)return this._runActionsRange(h,h,c,d);if(e!==f||g!==h||c||d){-1===e&&(e=g=0);var m=b>=a,n=e;do{var o=!j!=!(k&&n%2),p=n===e?g:m?0:i,q=n===f?h:m?i:0;if(o&&(p=i-p,q=i-q),k&&n!==e&&p===q);else if(this._runActionsRange(p,q,c,d||n!==e&&!k))return!0;d=!1}while(m&&++n<=f||!m&&--n>=f)}}},b._runActionsRange=function(){},createjs.AbstractTween=createjs.promote(a,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function a(c,d){this.AbstractTween_constructor(d),this.pluginData=null,this.target=c,this.passive=!1,this._stepHead=new b(null,0,0,{},null,!0),this._stepTail=this._stepHead,this._stepPosition=0,this._actionHead=null,this._actionTail=null,this._plugins=null,this._pluginIds=null,this._injected=null,d&&(this.pluginData=d.pluginData,d.override&&a.removeTweens(c)),this.pluginData||(this.pluginData={}),this._init(d)}function b(a,b,c,d,e,f){this.next=null,this.prev=a,this.t=b,this.d=c,this.props=d,this.ease=e,this.passive=f,this.index=a?a.index+1:0}function c(a,b,c,d,e){this.next=null,this.prev=a,this.t=b,this.d=0,this.scope=c,this.funct=d,this.params=e}var d=createjs.extend(a,createjs.AbstractTween);a.IGNORE={},a._tweens=[],a._plugins=null,a._tweenHead=null,a._tweenTail=null,a.get=function(b,c){return new a(b,c)},a.tick=function(b,c){for(var d=a._tweenHead;d;){var e=d._next;c&&!d.ignoreGlobalPause||d._paused||d.advance(d.useTicks?1:b),d=e}},a.handleEvent=function(a){"tick"===a.type&&this.tick(a.delta,a.paused)},a.removeTweens=function(b){if(b.tweenjs_count){for(var c=a._tweenHead;c;){var d=c._next;c.target===b&&a._register(c,!0),c=d}b.tweenjs_count=0}},a.removeAllTweens=function(){for(var b=a._tweenHead;b;){var c=b._next;b._paused=!0,b.target&&(b.target.tweenjs_count=0),b._next=b._prev=null,b=c}a._tweenHead=a._tweenTail=null},a.hasActiveTweens=function(b){return b?!!b.tweenjs_count:!!a._tweenHead},a._installPlugin=function(b){for(var c=b.priority=b.priority||0,d=a._plugins=a._plugins||[],e=0,f=d.length;f>e&&!(c<d[e].priority);e++);d.splice(e,0,b)},a._register=function(b,c){var d=b.target;if(!c&&b._paused){d&&(d.tweenjs_count=d.tweenjs_count?d.tweenjs_count+1:1);var e=a._tweenTail;e?(a._tweenTail=e._next=b,b._prev=e):a._tweenHead=a._tweenTail=b,!a._inited&&createjs.Ticker&&(createjs.Ticker.addEventListener("tick",a),a._inited=!0)}else if(c&&!b._paused){d&&d.tweenjs_count--;var f=b._next,g=b._prev;f?f._prev=g:a._tweenTail=g,g?g._next=f:a._tweenHead=f,b._next=b._prev=null}b._paused=c},d.wait=function(a,b){return a>0&&this._addStep(+a,this._stepTail.props,null,b),this},d.to=function(a,b,c){(null==b||0>b)&&(b=0);var d=this._addStep(+b,null,c);return this._appendProps(a,d),this},d.label=function(a){return this.addLabel(a,this.duration),this},d.call=function(a,b,c){return this._addAction(c||this.target,a,b||[this])},d.set=function(a,b){return this._addAction(b||this.target,this._set,[a])},d.play=function(a){return this._addAction(a||this,this._set,[{paused:!1}])},d.pause=function(a){return this._addAction(a||this,this._set,[{paused:!0}])},d.w=d.wait,d.t=d.to,d.c=d.call,d.s=d.set,d.toString=function(){return"[Tween]"},d.clone=function(){throw"Tween can not be cloned."},d._addPlugin=function(a){var b=this._pluginIds||(this._pluginIds={}),c=a.ID;if(c&&!b[c]){b[c]=!0;for(var d=this._plugins||(this._plugins=[]),e=a.priority||0,f=0,g=d.length;g>f;f++)if(e<d[f].priority)return void d.splice(f,0,a);d.push(a)}},d._updatePosition=function(a,b){var c=this._stepHead.next,d=this.position,e=this.duration;if(this.target&&c){for(var f=c.next;f&&f.t<=d;)c=c.next,f=c.next;var g=b?0===e?1:d/e:(d-c.t)/c.d;this._updateTargetProps(c,g,b)}this._stepPosition=c?d-c.t:0},d._updateTargetProps=function(b,c,d){if(!(this.passive=!!b.passive)){var e,f,g,h,i=b.prev.props,j=b.props;(h=b.ease)&&(c=h(c,0,1,1));var k=this._plugins;a:for(var l in i){if(f=i[l],g=j[l],e=f!==g&&"number"==typeof f?f+(g-f)*c:c>=1?g:f,k)for(var m=0,n=k.length;n>m;m++){var o=k[m].change(this,b,l,e,c,d);if(o===a.IGNORE)continue a;void 0!==o&&(e=o)}this.target[l]=e}}},d._runActionsRange=function(a,b,c,d){var e=a>b,f=e?this._actionTail:this._actionHead,g=b,h=a;e&&(g=a,h=b);for(var i=this.position;f;){var j=f.t;if((j===b||j>h&&g>j||d&&j===a)&&(f.funct.apply(f.scope,f.params),i!==this.position))return!0;f=e?f.prev:f.next}},d._appendProps=function(b,c,d){var e,f,g,h,i,j=this._stepHead.props,k=this.target,l=a._plugins,m=c.prev,n=m.props,o=c.props||(c.props=this._cloneProps(n)),p={};for(e in b)if(b.hasOwnProperty(e)&&(p[e]=o[e]=b[e],void 0===j[e])){if(h=void 0,l)for(f=l.length-1;f>=0;f--)if(g=l[f].init(this,e,h),void 0!==g&&(h=g),h===a.IGNORE){delete o[e],delete p[e];break}h!==a.IGNORE&&(void 0===h&&(h=k[e]),n[e]=void 0===h?null:h)}for(e in p){g=b[e];for(var q,r=m;(q=r)&&(r=q.prev);)if(r.props!==q.props){if(void 0!==r.props[e])break;r.props[e]=n[e]}}if(d!==!1&&(l=this._plugins))for(f=l.length-1;f>=0;f--)l[f].step(this,c,p);(i=this._injected)&&(this._injected=null,this._appendProps(i,c,!1))},d._injectProp=function(a,b){var c=this._injected||(this._injected={});c[a]=b},d._addStep=function(a,c,d,e){var f=new b(this._stepTail,this.duration,a,c,d,e||!1);return this.duration+=a,this._stepTail=this._stepTail.next=f},d._addAction=function(a,b,d){var e=new c(this._actionTail,this.duration,a,b,d);return this._actionTail?this._actionTail.next=e:this._actionHead=e,this._actionTail=e,this},d._set=function(a){for(var b in a)this[b]=a[b]},d._cloneProps=function(a){var b={};for(var c in a)b[c]=a[c];return b},createjs.Tween=createjs.promote(a,"AbstractTween")}(),this.createjs=this.createjs||{},function(){"use strict";function a(a){var b,c;a instanceof Array||null==a&&arguments.length>1?(b=a,c=arguments[1],a=arguments[2]):a&&(b=a.tweens,c=a.labels),this.AbstractTween_constructor(a),this.tweens=[],b&&this.addTween.apply(this,b),this.setLabels(c),this._init(a)}var b=createjs.extend(a,createjs.AbstractTween);b.addTween=function(a){a._parent&&a._parent.removeTween(a);var b=arguments.length;if(b>1){for(var c=0;b>c;c++)this.addTween(arguments[c]);return arguments[b-1]}if(0===b)return null;this.tweens.push(a),a._parent=this,a.paused=!0;var d=a.duration;return a.loop>0&&(d*=a.loop+1),d>this.duration&&(this.duration=d),this.rawPosition>=0&&a.setPosition(this.rawPosition),a},b.removeTween=function(a){var b=arguments.length;if(b>1){for(var c=!0,d=0;b>d;d++)c=c&&this.removeTween(arguments[d]);return c}if(0===b)return!0;for(var e=this.tweens,d=e.length;d--;)if(e[d]===a)return e.splice(d,1),a._parent=null,a.duration>=this.duration&&this.updateDuration(),!0;return!1},b.updateDuration=function(){this.duration=0;for(var a=0,b=this.tweens.length;b>a;a++){var c=this.tweens[a],d=c.duration;c.loop>0&&(d*=c.loop+1),d>this.duration&&(this.duration=d)}},b.toString=function(){return"[Timeline]"},b.clone=function(){throw"Timeline can not be cloned."},b._updatePosition=function(a){for(var b=this.position,c=0,d=this.tweens.length;d>c;c++)this.tweens[c].setPosition(b,!0,a)},b._runActionsRange=function(a,b,c,d){for(var e=this.position,f=0,g=this.tweens.length;g>f;f++)if(this.tweens[f]._runActions(a,b,c,d),e!==this.position)return!0},createjs.Timeline=createjs.promote(a,"AbstractTween")}(),this.createjs=this.createjs||{},function(){"use strict";function a(){throw"Ease cannot be instantiated."}a.linear=function(a){return a},a.none=a.linear,a.get=function(a){return-1>a?a=-1:a>1&&(a=1),function(b){return 0==a?b:0>a?b*(b*-a+1+a):b*((2-b)*a+(1-a))}},a.getPowIn=function(a){return function(b){return Math.pow(b,a)}},a.getPowOut=function(a){return function(b){return 1-Math.pow(1-b,a)}},a.getPowInOut=function(a){return function(b){return(b*=2)<1?.5*Math.pow(b,a):1-.5*Math.abs(Math.pow(2-b,a))}},a.quadIn=a.getPowIn(2),a.quadOut=a.getPowOut(2),a.quadInOut=a.getPowInOut(2),a.cubicIn=a.getPowIn(3),a.cubicOut=a.getPowOut(3),a.cubicInOut=a.getPowInOut(3),a.quartIn=a.getPowIn(4),a.quartOut=a.getPowOut(4),a.quartInOut=a.getPowInOut(4),a.quintIn=a.getPowIn(5),a.quintOut=a.getPowOut(5),a.quintInOut=a.getPowInOut(5),a.sineIn=function(a){return 1-Math.cos(a*Math.PI/2)},a.sineOut=function(a){return Math.sin(a*Math.PI/2)},a.sineInOut=function(a){return-.5*(Math.cos(Math.PI*a)-1)},a.getBackIn=function(a){return function(b){return b*b*((a+1)*b-a)}},a.backIn=a.getBackIn(1.7),a.getBackOut=function(a){return function(b){return--b*b*((a+1)*b+a)+1}},a.backOut=a.getBackOut(1.7),a.getBackInOut=function(a){return a*=1.525,function(b){return(b*=2)<1?.5*b*b*((a+1)*b-a):.5*((b-=2)*b*((a+1)*b+a)+2)}},a.backInOut=a.getBackInOut(1.7),a.circIn=function(a){return-(Math.sqrt(1-a*a)-1)},a.circOut=function(a){return Math.sqrt(1- --a*a)},a.circInOut=function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},a.bounceIn=function(b){return 1-a.bounceOut(1-b)},a.bounceOut=function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},a.bounceInOut=function(b){return.5>b?.5*a.bounceIn(2*b):.5*a.bounceOut(2*b-1)+.5},a.getElasticIn=function(a,b){var c=2*Math.PI;return function(d){if(0==d||1==d)return d;var e=b/c*Math.asin(1/a);return-(a*Math.pow(2,10*(d-=1))*Math.sin((d-e)*c/b))}},a.elasticIn=a.getElasticIn(1,.3),a.getElasticOut=function(a,b){var c=2*Math.PI;return function(d){if(0==d||1==d)return d;var e=b/c*Math.asin(1/a);return a*Math.pow(2,-10*d)*Math.sin((d-e)*c/b)+1}},a.elasticOut=a.getElasticOut(1,.3),a.getElasticInOut=function(a,b){var c=2*Math.PI;return function(d){var e=b/c*Math.asin(1/a);return(d*=2)<1?-.5*a*Math.pow(2,10*(d-=1))*Math.sin((d-e)*c/b):a*Math.pow(2,-10*(d-=1))*Math.sin((d-e)*c/b)*.5+1}},a.elasticInOut=a.getElasticInOut(1,.3*1.5),createjs.Ease=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(){throw"MotionGuidePlugin cannot be instantiated."}var b=a;b.priority=0,b.ID="MotionGuide",b.install=function(){return createjs.Tween._installPlugin(a),createjs.Tween.IGNORE},b.init=function(a,c){"guide"==c&&a._addPlugin(b)},b.step=function(a,c,d){for(var e in d)if("guide"===e){var f=c.props.guide,g=b._solveGuideData(d.guide,f);f.valid=!g;var h=f.endData;if(a._injectProp("x",h.x),a._injectProp("y",h.y),g||!f.orient)break;var i=void 0===c.prev.props.rotation?a.target.rotation||0:c.prev.props.rotation;if(f.startOffsetRot=i-f.startData.rotation,"fixed"==f.orient)f.endAbsRot=h.rotation+f.startOffsetRot,f.deltaRotation=0;else{var j=void 0===d.rotation?a.target.rotation||0:d.rotation,k=j-f.endData.rotation-f.startOffsetRot,l=k%360;switch(f.endAbsRot=j,f.orient){case"auto":f.deltaRotation=k;break;case"cw":f.deltaRotation=(l+360)%360+360*Math.abs(k/360|0);break;case"ccw":f.deltaRotation=(l-360)%360+-360*Math.abs(k/360|0)}}a._injectProp("rotation",f.endAbsRot)}},b.change=function(a,c,d,e,f){var g=c.props.guide;return g&&c.props!==c.prev.props&&g!==c.prev.props.guide?"guide"===d&&!g.valid||"x"==d||"y"==d||"rotation"===d&&g.orient?createjs.Tween.IGNORE:void b._ratioToPositionData(f,g,a.target):void 0},b.debug=function(a,c,d){a=a.guide||a;var e=b._findPathProblems(a);if(!c)return e;var f,g=a.path,h=g.length,i=3,j=9;for(c.save(),c.lineCap="round",c.lineJoin="miter",c.beginPath(),c.moveTo(g[0],g[1]),f=2;h>f;f+=4)c.quadraticCurveTo(g[f],g[f+1],g[f+2],g[f+3]);c.strokeStyle="black",c.lineWidth=1.5*i,c.stroke(),c.strokeStyle="white",c.lineWidth=i,c.stroke(),c.closePath();var k=d.length;if(d&&k){var l={},m={};b._solveGuideData(a,l);for(var f=0;k>f;f++)l.orient="fixed",b._ratioToPositionData(d[f],l,m),c.beginPath(),c.moveTo(m.x,m.y),c.lineTo(m.x+Math.cos(.0174533*m.rotation)*j,m.y+Math.sin(.0174533*m.rotation)*j),c.strokeStyle="black",c.lineWidth=1.5*i,c.stroke(),c.strokeStyle="red",c.lineWidth=i,c.stroke(),c.closePath()}return c.restore(),e},b._solveGuideData=function(a,c){var d=void 0;if(d=b.debug(a))return d;var e=c.path=a.path;c.orient=a.orient,c.subLines=[],c.totalLength=0,c.startOffsetRot=0,c.deltaRotation=0,c.startData={ratio:0},c.endData={ratio:1},c.animSpan=1;var f,g,h,i,j,k,l,m,n,o=e.length,p=10,q={};for(f=e[0],g=e[1],l=2;o>l;l+=4){h=e[l],i=e[l+1],j=e[l+2],k=e[l+3];var r={weightings:[],estLength:0,portion:0},s=f,t=g;for(m=1;p>=m;m++){b._getParamsForCurve(f,g,h,i,j,k,m/p,!1,q);var u=q.x-s,v=q.y-t;n=Math.sqrt(u*u+v*v),r.weightings.push(n),r.estLength+=n,s=q.x,t=q.y}for(c.totalLength+=r.estLength,m=0;p>m;m++)n=r.estLength,r.weightings[m]=r.weightings[m]/n;c.subLines.push(r),f=j,g=k}n=c.totalLength;var w=c.subLines.length;for(l=0;w>l;l++)c.subLines[l].portion=c.subLines[l].estLength/n;var x=isNaN(a.start)?0:a.start,y=isNaN(a.end)?1:a.end;b._ratioToPositionData(x,c,c.startData),b._ratioToPositionData(y,c,c.endData),c.startData.ratio=x,c.endData.ratio=y,c.animSpan=c.endData.ratio-c.startData.ratio},b._ratioToPositionData=function(a,c,d){var e,f,g,h,i,j=c.subLines,k=0,l=10,m=a*c.animSpan+c.startData.ratio;for(f=j.length,e=0;f>e;e++){if(h=j[e].portion,k+h>=m){i=e;break}k+=h}void 0===i&&(i=f-1,k-=h);var n=j[i].weightings,o=h;for(f=n.length,e=0;f>e&&(h=n[e]*o,!(k+h>=m));e++)k+=h;i=4*i+2,g=e/l+(m-k)/h*(1/l);var p=c.path;return b._getParamsForCurve(p[i-2],p[i-1],p[i],p[i+1],p[i+2],p[i+3],g,c.orient,d),c.orient&&(a>=.99999&&1.00001>=a&&void 0!==c.endAbsRot?d.rotation=c.endAbsRot:d.rotation+=c.startOffsetRot+a*c.deltaRotation),d},b._getParamsForCurve=function(a,b,c,d,e,f,g,h,i){var j=1-g;i.x=j*j*a+2*j*g*c+g*g*e,i.y=j*j*b+2*j*g*d+g*g*f,h&&(i.rotation=57.2957795*Math.atan2((d-b)*j+(f-d)*g,(c-a)*j+(e-c)*g))},b._findPathProblems=function(a){var b=a.path,c=b&&b.length||0;if(6>c||(c-2)%4){var d="	Cannot parse 'path' array due to invalid number of entries in path. ";return d+="There should be an odd number of points, at least 3 points, and 2 entries per point (x & y). ",d+="See 'CanvasRenderingContext2D.quadraticCurveTo' for details as 'path' models a quadratic bezier.\n\n",d+="Only [ "+c+" ] values found. Expected: "+Math.max(4*Math.ceil((c-2)/4)+2,6)}for(var e=0;c>e;e++)if(isNaN(b[e]))return"All data in path array must be numeric";var f=a.start;if(isNaN(f)&&void 0!==f)return"'start' out of bounds. Expected 0 to 1, got: "+f;var g=a.end;if(isNaN(g)&&void 0!==g)return"'end' out of bounds. Expected 0 to 1, got: "+g;var h=a.orient;return h&&"fixed"!=h&&"auto"!=h&&"cw"!=h&&"ccw"!=h?'Invalid orientation value. Expected ["fixed", "auto", "cw", "ccw", undefined], got: '+h:void 0},createjs.MotionGuidePlugin=a}(),this.createjs=this.createjs||{},function(){"use strict";var a=createjs.TweenJS=createjs.TweenJS||{};a.version="NEXT",a.buildDate="Wed, 21 Jun 2017 16:57:37 GMT"}();var cjs=createjs;createjs.MotionGuidePlugin.install(),function(){"use strict";var a=include("createjs"),b=include("createjs.Ticker");b.setPaused=function(a){b.paused=a},b.getPaused=function(){return b.paused},a.DisplayObject.prototype.center=function(){return this.regs(.5,.5)},a.DisplayObject.prototype.setScale=function(a){return this.scale?this.scale=a:this.scaleX=this.scaleY=a,this},a.DisplayObject.prototype.hitbox=function(b,c){var d=this.getBounds();return c&&(d=c),d&&(b=b||0,this.hitArea=new a.Shape,this.hitArea.graphics.f("#000").r(d.x-b,d.y-b,d.width+2*b,d.height+2*b)),this},a.DisplayObject.prototype.reg=function(a,b){var c=this.getBounds();return c&&(this.regX=Math.floor(c.width*a),this.regY=Math.floor(c.height*b)),this},a.MovieClip.prototype.changeSnapToPixel=function(a){function b(c){for(var d in c){var e=c[d];e&&e.snapToPixel&&(c[d].snapToPixel=a,c[d].children&&b(c[d]))}}b(this)},a.DisplayObject.prototype.regs=function(a,b,c){var d,e,f,g,h=this.getBounds();if(null!==h){if(1===arguments.length)if("string"==typeof arguments[0])switch(arguments[0]){case"center":f=g=.5}else f=g=arguments[0];else{if("string"==typeof a)switch(a){case"center":f=.5;break;case"left":f=0;break;case"right":f=1}else f=a;if("string"==typeof b)switch(b){case"center":g=.5;break;case"top":g=0;break;case"bottom":g=1}else g=b}return d=h.width*f,e=h.height*g,c&&c===!0&&(d="string"!=typeof a?a:h.width*f,e="string"!=typeof b?b:h.height*g),this.set({regX:d,regY:e}),this}return this},a.Bitmap.prototype.getBounds=function(){var a=this.DisplayObject_getBounds();if(a)return a;var b=this.image,c=this.sourceRect||b,d=b&&(b.naturalWidth||b.getContext||b.readyState>=2);return c.naturalWidth?d?this._rectangle.setValues(0,0,c.naturalWidth,c.naturalHeight):null:d?this._rectangle.setValues(0,0,c.width,c.height):null},a.Rectangle.prototype.contains=function(b,c,d,e){d=d||0,e=e||0;var f;return arguments[0]instanceof a.Rectangle?(f=b,f.x>=this.x&&f.x+f.width<=this.x+this.width&&f.y>=this.y&&f.y+f.height<=this.y+this.height):b>=this.x&&b+d<=this.x+this.width&&c>=this.y&&c+e<=this.y+this.height},a.MovieClip.prototype.doesHaveLabel=function(a){var b=this.labels;for(var c in b)if(b[c].label===a)return!0;return!1},a.MovieClip.prototype.iterateInstances=function(a){for(var b=this.instance,c=0;b;)a(b),b=movieClip["instance_"+ ++c]}}(),function(a){"use strict";a.cjs=a.createjs,Function.prototype.bind=Function.prototype.bind||function(a){var b=this;return function(){return b.apply(a,arguments)}},("undefined"==typeof console||"undefined"==typeof console.log)&&(console={},console.log=function(){}),a.cm={main:null,modules:{},ready:!1,baked:!1,global:a,prefix:"",lib:"js/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(a){return"#"===a[0]?document.getElementById(a.substr(1)):document.getElementsByTagName(a)},$new:document.createElement.bind(document),debug:!!document.getElementById("cmDebug"),debugDiv:document.getElementById("cmDebug"),copy:function(a){var b,c;if(!a||"object"!=typeof a||a instanceof HTMLElement||a instanceof cm.Class)return a;if(Array.isArray(a)){for(b=a.slice(0),c=0;c<b.length;c++)b[c]&&"object"==typeof b[c]&&(b[c]=cm.copy(b[c]));return b}b={};for(c in a)b[c]=cm.copy(a[c]);return b},merge:function(a,b){for(var c in b){var d=b[c];"object"!=typeof d||d instanceof HTMLElement||d instanceof cm.Class||null===d?a[c]=d:(a[c]&&"object"==typeof a[c]||(a[c]=d instanceof Array?[]:{}),cm.merge(a[c],d))}return a},module:function(a){if(cm._current)throw"Module '"+cm._current.name+"' defines nothing";if(cm.modules[a]&&cm.modules[a].body)throw"Module '"+a+"' is already defined";return cm._current={name:a,requires:[],loaded:!1,body:null},cm.modules[a]=cm._current,cm._loadQueue.push(cm._current),cm},requires:function(){return cm._current.requires=Array.prototype.slice.call(arguments),cm},external:function(){for(var a=Array.prototype.slice.call(arguments),b=0;b<a.length;b++)cm.modules[name]||cm._loadScript(a[b]);return cm},defines:function(a){cm._current.body=a,cm._current=null,cm._initDOMReady()},log:function(a){cm.debug},_loadScript:function(a,b){cm.modules[a]={name:a,requires:[],loaded:!1,body:null},cm._waitForOnload++;var c=cm.prefix+cm.lib+a.replace(/\./g,"/")+".js?"+Date.now(),d=cm.$new("script");d.type="text/javascript",d.onload=function(){cm._waitForOnload--,cm._execModules()},d.onerror=function(){throw"Failed to load module "+a+" at "+c+" required from "+b},d.src=c,cm.$("head")[0].appendChild(d)},_execModules:function(){var a,b,c,d=!1;for(a=0;a<cm._loadQueue.length;a++){c=cm._loadQueue[a];var e=!0;for(b=0;b<c.requires.length;b++){var f=c.requires[b];cm.modules[f]?cm.modules[f].loaded||(e=!1):(e=!1,cm._loadScript(f,c.name))}e&&c.body&&(cm._loadQueue.splice(a,1),c.loaded=!0,c.body(),d=!0,a--)}if(d)cm._execModules();else if(!cm.baked&&0===cm._waitForOnload&&0!==cm._loadQueue.length){var g=[];for(a=0;a<cm._loadQueue.length;a++){var h=[],i=cm._loadQueue[a].requires;for(b=0;b<i.length;b++)c=cm.modules[i[b]],c&&c.loaded||h.push(i[b]);g.push(cm._loadQueue[a].name+" (requires: "+h.join(", ")+")")}throw"Unresolved (circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules:\n"+g.join("\n")}},_DOMReady:function(){if(!cm.modules["dom.ready"].loaded){if(!document.body)return setTimeout(cm._DOMReady,13);cm.modules["dom.ready"].loaded=!0,cm._waitForOnload--,cm._execModules()}return 0},_initDOMReady:function(){return cm.modules["dom.ready"]?void cm._execModules():(cm.modules["dom.ready"]={requires:[],loaded:!1,body:null},cm._waitForOnload++,document.addEventListener("DOMContentLoaded",cm._DOMReady,!1),void a.addEventListener("load",cm._DOMReady,!1))}}}(window),function(){"use strict";cm.ready=!0}(),function(){"use strict";cm.Globals={currentLevel:!1}}(),function(){"use strict";Math.map=function(a,b,c,d,e){return d+(e-d)*((a-b)/(c-b))},Math.limit=function(a,b,c){return Math.min(c,Math.max(b,a))},Math.roundAt=function(a,b){return b?(b=Math.pow(10,b||0),Math.round(a*b)/b):Math.round(a)},Math.toInt=function(a){return 0|a},Math.toRad=function(a){return a*Math.PI/180},Math.DEGTORAD||(Math.DEGTORAD=Math.PI/180),Math.toDeg=function(a){return 180*a/Math.PI},Math.RADTODEG||(Math.RADTODEG=180/Math.PI),Math.rangeFloat=function(a,b){return Math.random()*(b-a)+a},Math.range=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},Math.isEpsilon=function(a){return Math.abs(a)<1e-4},Math.pointDistance=function(a,b){var c=0,d=0;b&&(c=b.x,d=b.y);var e=a.x-b.x,f=a.y-b.y;return Math.sqrt(e*e+f*f)},Math.pointAngle=function(a,b){var c=0,d=0;b&&(c=b.x,d=b.y);var e=c-a.x,f=d-a.y;return Math.atan2(f,e)},Math.plusOrMinus=function(){return Math.random()<.5?-1:1}}(),function(){"use strict";function a(){this.EventDispatcher_constructor(),this._activeQueues=[],this.activeQueue=null,this.data={},this.lib={},this._loadedManifests=[],window.images=this.lib}var b=cjs.extend(a,cjs.EventDispatcher);b.setData=function(a){this.data=a},b.unloadAsset=function(a){delete this.lib[a]},b.load=function(a,b,c,d){if(a=this._getManifestArray(a)){var e=new cjs.LoadQueue;e.installPlugin(cjs.Sound),e.registerLoader(cjs.FlashAnimationLoader),e.setMaxConnections(10),e.onComplete=b,e.onError=c,e.onProgress=d,e.on("complete",this._handleComplete,this),e.on("error",this._handleError,this),e.on("progress",this._handleProgress,this),e.on("fileload",this._handleFileLoad,this);for(var f=0;f<a.length;f++)e.loadManifest(a[f],!1);this.activeQueue=e,e.load()}},b._handleComplete=function(a){var b=a.target;b.onComplete(a),b.removeAllEventListeners(),b.destroy(),b.removeAll(),this.activeQueue=null},b._handleError=function(a){var b=a.target;b.onError&&b.onError(a)},b._handleProgress=function(a){var b=a.target;b.onProgress&&b.onProgress(a)},b._handleFileLoad=function(a){var b=a.item;switch(b.type){case cjs.LoadQueue.JAVASCRIPT:break;case"flash_animation":this.lib[b.id]=a.result;break;default:this.lib[b.id]=a.result}},b.unload=function(a){if(a=this._getManifestArray(a))for(var b=0;b<a.length;b++){var c=a[b];c&&this._unloadManifest(c)}},b._unloadManifest=function(a){Array.isArray(a)||(a=a.manifest);for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];"flash_animation"===e.type&&e.lib&&e.lib.properties.manifest?(this._unloadManifest(e.lib.properties.manifest),delete e.lib):"sound"===e.type&&cjs.Sound.removeSound(e.id),this.unloadAsset(e.id)}cjs.Sound.removeSounds(b)},b._getManifestArray=function(a){var b;if(Array.isArray(a)){b=[];for(var c=0;c<a.length;c++){var d=a[c];"string"==typeof d?b.push(this._getManifestByString(d)):b.push(d)}return b}return"string"==typeof a?[this._getManifestByString(a)]:!1},b._getManifestByString=function(a){return this.data[a]};var c=createjs.promote(a,"EventDispatcher");cm.Assets=new c}(),function(){"use strict";function a(){if(this.EventDispatcher_constructor(),a._started)throw"Only one instance of cm.System should be created.";this.domElement=null,this.width=0,this.minWidth=0,this.maxWidth=0,this.height=0,this.minHeight=0,this.maxHeight=0,this.tick=0,this._stages=[],this._delegate=null,this._lastWidth=0,this._lastHeight=0}var b=cjs.extend(a,cjs.EventDispatcher);a._started=!1,b.start=function(a,b){if(this.width=b.maxWidth||b.width,this.height=b.maxHeight||b.height,"number"!=typeof this.width||this.width<=0)throw"'width' or 'maxWidth' needs to be provided in cm.System.start";if("number"!=typeof this.height||this.height<=0)throw"'height' or 'maxHeight' needs to be provided in cm.System.start";
this.minWidth=parseFloat(b.minWidth)||this.width,this.maxWidth=parseFloat(b.maxWidth)||this.width,this.minHeight=parseFloat(b.minHeight)||this.height,this.maxHeight=parseFloat(b.maxHeight)||this.height,this.domElement=b.element,this.resize(),cjs.Ticker.timingMode=createjs.Ticker.RAF,cjs.Ticker.addEventListener("tick",this.run.bind(this)),this._delegate=cm.main=new a},b.addStage=function(a){return this.sizeStage(a),this._stages.push(a),a},b.createStage=function(a,b){var c=b?new cjs.StageGL(a,{antialias:!0,premultiply:!0}):new cjs.Stage(a);return c.snapToPixelEnabled=!0,c.autoClear=!!b,this.addStage(c)},b.resize=function(){var a=window.innerWidth,b=window.innerHeight,c=this.domElement;c.style.maxWidth="",c.style.maxHeight="",c.style.margin="",c.style.marginTop="",c.style.margin="0 auto";var d=a/this.minWidth,e=b/this.minHeight,f=1,g=this.minWidth,h=this.minHeight;d>e?(f=e,g=a>this.maxWidth*e?this.maxWidth:a<this.minWidth*e?this.minWidth:a/e):(f=d,h=b>this.maxHeight*d?this.maxHeight:b<this.minHeight*d?this.minHeight:b/d),this.width=g=Math.floor(g),this.height=h=Math.floor(h),f=d>e?b/h:a/g,c.style.width=Math.floor(g*f)+"px",c.style.height=Math.floor(h*f)+"px",c.style.marginTop=Math.floor((b-h*f)/2)+"px";for(var i=this._stages,j=0,k=i.length;k>j;j++)this.sizeStage(i[j]);this._lastWidth=a,this._lastHeight=b,this.dispatchEvent(new cjs.Event("resize"))},b.sizeStage=function(a){a.canvas&&(a.canvas.width=this.width,a.canvas.height=this.height,a.isWebGL&&a.updateViewport(this.width,this.height),a.update())},b.run=function(a){var b=this.tick=a.delta/1e3;if(a.tick=b,!(b>3)){this._delegate&&this._delegate.update(b,a),cm.ViewControl&&cm.ViewControl.update(b);for(var c=this._stages,d=0,e=c.length;e>d;d++){var f=c[d];f.stopUpdate||f.update(a)}cm.Mouse&&cm.Mouse.clearPressed(),cm.Keyboard&&cm.Keyboard.clearPressed(),(this._lastWidth!==window.innerWidth||this._lastHeight!==window.innerHeight)&&this.resize()}};var c=createjs.promote(a,"EventDispatcher");cm.System=new c}(),function(){"use strict";function a(a){a=a||{},cjs.LoadItem.LOAD_TIMEOUT_DEFAULT=a.loadTimeoutDefault||6e4,cjs.Sound.registerPlugins(a.soundPlugins||[cjs.WebAudioPlugin,cjs.HTMLAudioPlugin]),cjs.Sound.alternateExtensions=["mp3"]}a.Paths={},a.Paths.Media="assets/",a.Paths.Images=a.Paths.Media+"images/",a.Paths.Audio=a.Paths.Media+"audio/",a.Paths.Animations=a.Paths.Media+"animations/",a.Paths.VO=a.Paths.Audio+"vo/",a.Paths.SFX=a.Paths.Audio+"sfx/",cm.App=a}(),function(){"use strict";Object.defineProperty(Array.prototype,"erase",{value:function(a){var b=this.indexOf(a);return b>=0&&this.splice(b,1),this}}),Object.defineProperty(Array.prototype,"randomRotation",{value:function(a){var b=this.length;if(0===b)return null;a>b&&(a=b);var c=Math.floor(a*Math.random()),d=this.splice(c,1)[0];return this.push(d),d}}),Object.defineProperty(Array.prototype,"clone",{value:function(){return this.slice(0)}})}(),function(){function a(){this.OS={kindle:!1,android:!1,chromeOS:!1,iOS:!1,iOSVersion:0,linux:!1,macOS:!1,windowsPhone:!1,windows:!1},this.browsers={cocoonJS:!1,cordova:!1,chrome:!1,chromeVersion:0,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,ieEdge:!1,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,webApp:!1,silk:!1},this.audio={audioTags:!1,webAudio:!1,ogg:!1,opus:!1,mp3:!1,wav:!1,m4a:!1,webm:!1,dolby:!1},this.video={oggVideo:!1,h264Video:!1,mp4Video:!1,webmVideo:!1,vp9Video:!1,hlsVideo:!1},this.desktop=!1,this.mobile=!1,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.pixelRatio=0,this.file=!1,this.fileSystem=!1,this.localStorage=!1,this.worker=!1,this.vibration=!1,this.touch=!1,this.fullscreen=!1,this.fullscreenKeyboard=!1,this.requestFullscreen="",this.cancelFullscreen="",this.performChecks()}var b=a.prototype;b.performChecks=function(){this.checkOS(),this.checkBrowser(),this.checkDevice()},b.checkOS=function(){var a=navigator.userAgent;this.OS.kindle=/Kindle/.test(a)||/\bKF[A-Z][A-Z]+/.test(a)||/Silk/.test(a),this.OS.android=/Android/.test(a),this.OS.chromeOS=/CrOS/.test(a),this.OS.iOS=/iP[ao]d|iPhone/i.test(a),this.OS.linux=/Linux/.test(a),this.OS.macOS=/Mac OS/.test(a),this.OS.windowsPhone=/Windows Phone/i.test(a)||/IEMobile/i.test(a),this.OS.windows=this.OS.windowsPhone||/Windows/.test(a),(this.OS.iOS||this.OS.android)&&(this.mobile=!0),!this.mobile&&(this.OS.windows||this.OS.macOS||this.OS.linux&&!this.kindle||this.OS.chromeOS)&&(this.desktop=!0),this.OS.iOS&&(navigator.appVersion.match(/OS (\d+)/),this.OS.iOSVersion=parseInt(RegExp.$1,10)),this.mobile=!this.desktop},b.checkBrowser=function(){var a=navigator.userAgent,b=this.browsers,c=this.OS;/Edge\/\d+/.test(a)?b.edge=!0:/Chrome\/(\d+)/.test(a)&&!c.windowsPhone?(b.chrome=!0,b.chromeVersion=parseInt(RegExp.$1,10)):/Firefox\D+(\d+)/.test(a)?(b.firefox=!0,b.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(a)&&c.iOS?b.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(a)?(b.ie=!0,b.ieVersion=parseInt(RegExp.$1,10)):/Opera/.test(a)?b.opera=!0:/Safari\/(\d+)/.test(a)&&!c.windowsPhone&&(b.safari=!0,/Version\/(\d+)\./.test(a)&&(b.safariVersion=parseInt(RegExp.$1,10))),/Silk/.test(a)&&(b.silk=!0),navigator.standalone&&(b.webApp=!0),"undefined"!=typeof window.cordova&&(b.cordova=!0),navigator.isCocoonJS&&(b.cocoonJS=!0)},b.checkDevice=function(){var a=navigator.userAgent;this.pixelRatio=window.devicePixelRatio||1,this.iPhone=-1!==a.toLowerCase().indexOf("iphone"),this.iPhone4=2===this.pixelRatio&&this.iPhone,this.iPad=-1!==a.toLowerCase().indexOf("ipad"),this.vibration=!!(navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate);try{var b="DC";localStorage.setItem(b,b),localStorage.removeItem(b),this.features.localStorage=!0}catch(c){}this.file=!!(window.File&&window.FileList&&window.FileReader),this.fileSystem=!!window.requestFileSystem,this.worker=!!window.Worker,this.touch="ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>=1,this.audioTags=!!window.Audio,this.webAudio=!(!window.AudioContext&&!window.webkitAudioContext)},cm.Device=new a}(),function(){"use strict";function a(){throw"Keyboard cannot be instantiated."}a.isUsingKeyboard=!1,a.bindings={},a.actions={},a.presses={},a.locks={},a.delayedKeyup={},a.KEYS={BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190},a.start=function(){a.isUsingKeyboard||(a.isUsingKeyboard=!0,window.addEventListener("keydown",a.keydown.bind(a),!1),window.addEventListener("keyup",a.keyup.bind(a),!1))},a.keydown=function(b){var c=b.nativeEvent||b,d=c.target.tagName;if("INPUT"!==d&&"TEXTAREA"!==d){var e=c.keyCode,f=a.bindings[e];f&&(a.actions[f]=!0,a.locks[f]||(a.presses[f]=!0,a.locks[f]=!0),b.stopPropagation(),b.preventDefault())}},a.keyup=function(b){var c=b.nativeEvent||b,d=c.target.tagName;if("INPUT"!==d&&"TEXTAREA"!==d){var e=c.keyCode,f=a.bindings[e];f&&(a.delayedKeyup[f]=!0,b.stopPropagation(),b.preventDefault())}},a.bind=function(b,c){a.start(),a.bindings[b]=c},a.unbind=function(b){var c=a.bindings[b];a.delayedKeyup[c]=!0,a.bindings[b]=null},a.unbindAll=function(){a.bindings={},a.actions={},a.presses={},a.locks={},a.delayedKeyup={}},a.state=function(b){return a.actions[b]},a.pressed=function(b){return a.presses[b]},a.released=function(b){return!!a.delayedKeyup[b]},a.clearPressed=function(){for(var b in a.delayedKeyup)a.actions[b]=!1,a.locks[b]=!1;a.delayedKeyup={},a.presses={}},cm.Keyboard=a}(),function(){"use strict";function a(b,c,d){this.Container_constructor(),this.name=b,this.px=c,this.py=d,a.s[b]=this}var b=createjs.extend(a,cjs.Container);a.s={},a.alignLayers=function(b,c){var d=new cjs.Point,e=b,f=c;for(var g in a.s){var h=a.s[g];if(h.parent&&h.px&&h.py){var i=e*h.px,j=f*h.py;h.parent.globalToLocal(i,j,d),h.x=d.x,h.y=d.y}}},cm.System.on("resize",a.alignLayers,a),b.destroy=function(){delete a.s[this.name]},cm.Layer=cjs.promote(a,"Container")}(),function(){function a(){this.Container_constructor(),this.visible=!1}var b=createjs.extend(a,cjs.Container);b.build=function(){var a=(new cjs.Shape).set({regX:.5*cm.System.maxWidth,regY:.5*cm.System.height});a.graphics.f("#000").r(0,0,cm.System.maxWidth,cm.System.height),this.addChild(a)},b.transitIn=function(){var a=cjs.Tween.get(this,{override:!0}).wait(100).to({alpha:0},400,cjs.Ease.quadInOut).set({visible:!1});return a.duration},b.transitOut=function(){this.alpha=0;var a=cjs.Tween.get(this,{override:!0}).set({visible:!0}).to({alpha:1},400,cjs.Ease.quadInOut);return a.duration},cm.ViewTransition=cjs.promote(a,"Container")}(),function(){"use strict";function a(){this.EventDispatcher_constructor(),this._last=null,this.lastID="",this.current=null,this.currentID="",this._views={},this._layer=null,this.TransitionClass=cm.ViewTransition,this.transitionOverlay=null,cm.System.on("resize",this.resize,this)}var b=cjs.extend(a,cjs.EventDispatcher);b.registerView=function(a,b,c){this._views[a]={viewClass:b,persistent:!!c,instance:null}},b.setViewLayer=function(a){this._layer=a},b.setTransitionLayer=function(a){this.transitionOverlay=new this.TransitionClass,this.transitionOverlay.build(),a.addChild(this.transitionOverlay)},b.getViewInstance=function(a){return this._views[a]?this._views[a].instance:null},b.update=function(a){this.current&&this.current.update(a)},b.resize=function(){this.current&&this.current.resize(cm.System.width,cm.System.height)},b.gotoView=function(a){var b=this._views[a];if(!b)return void cm.log("No View with name: "+a);this.isTransitioning=!0;var c;return this.current?(this._last=this.current,this.current=null,this._lastID=this.currentID,this._last.setActive(!1),c=this._last.animateOut(),void cjs.Tween.get(this).wait(c).call(this._last.destroy,null,this._last).call(this.gotoView,[a],this)):(this.currentID=a,this.current=b.instance||new b.viewClass,this.current.reset(),this._layer.removeAllChildren(),this._layer.addChild(this.current),c=this.current.animateIn(),void cjs.Tween.get(this).wait(c).call(this.current.start,null,this.current).set({isTransitioning:!1,_last:null},this))},b.gotoLoaderThen=function(a,b){var c=this.transitionOverlay.transitIn(),d=cjs.Tween.get(this).wait(c);this.current&&(this._last=this.current,this.current=null,this._lastID=this.currentID,this._last.setActive(!1),this._last.animateOut(),d.call(this._last.destroy,null,this._last).call(this._layer.removeAllChildren,null,this._layer)),"string"==typeof b&&(b=this.gotoView.bind(this,b)),d.call(cm.Assets.load,[a,b],cm.Assets)},b.transitOut=function(){return this.transitionOverlay.transitOut()},b.transitIn=function(){return this.transitionOverlay.transitIn()};var c=createjs.promote(a,"EventDispatcher");cm.ViewControl=new c}(),function(){function a(){this.Container_constructor()}var b=createjs.extend(a,cjs.Container);b.reset=function(){this.resize(cm.System.width,cm.System.height)},b.start=function(){this.setActive(!0)},b.setActive=function(a){},b.animateIn=function(){return cm.ViewControl.transitOut()},b.animateOut=function(){return this.setActive(!1),cm.ViewControl.transitIn()},b.resize=function(a,b){},b.update=function(){},b.destroy=function(){this.setActive(!1)},cm.View=cjs.promote(a,"Container")}(),function(){"use strict";function a(a,b){this.AbstractLoader_constructor(a,b,"flash_animation"),this._manifestQueue=null}var b=createjs.extend(a,createjs.AbstractLoader),c=a;c.MANIFEST_PROGRESS=.25,c.canLoadItem=function(a){return"flash_animation"===a.type},b.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},b._createRequest=function(){this._request=new createjs.JavaScriptLoader(this._item)},b.handleEvent=function(a){switch(a.type){case"complete":if(this._rawResult=a.target.getResult(!0),!AdobeAn.compositions)throw"Using out of date flash export! "+this._item.src;var b=Object.keys(AdobeAn.compositions)[0],d=this._item.comp=AdobeAn.compositions[b],e=this._result=this._item.lib=d.getLibrary();if(delete AdobeAn.compositions[b],AdobeAn.compositions=null,!e)throw"Something went wrong. Lib not found";return this._sendProgress(c.MANIFEST_PROGRESS),void this._loadManifest(e);case"progress":return a.loaded*=c.MANIFEST_PROGRESS,this.progress=a.loaded/a.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(a)}this.AbstractLoader_handleEvent(a)},b._loadManifest=function(a){if(a.properties.manifest&&a.properties.manifest.length){var b=this._manifestQueue=new createjs.LoadQueue(this._preferXHR,this._item.assetsPath,this._item.crossOrigin);b.installPlugin(cjs.Sound),b.on("complete",this._handleManifestComplete,this,!0),b.on("fileload",this._handleManifestFileLoad,this),b.on("progress",this._handleManifestProgress,this),b.on("error",this._handleManifestError,this,!0),b.loadManifest(a.properties.manifest)}else this._sendComplete()},b._handleManifestFileLoad=function(a){if(a&&"image"===a.item.type){var b=this._item.comp,c=b.getImages();c[a.item.id]=a.result}},b._handleManifestComplete=function(a){for(var b=this._item.comp,c=b.getLibrary(),d=b.getSpriteSheet(),e=a.target,f=c.ssMetadata,g=0;g<f.length;g++)d[f[g].name]=new createjs.SpriteSheet({images:[e.getResult(f[g].name)],frames:f[g].frames});this._sendComplete()},b._handleManifestProgress=function(a){this.progress=a.progress*(1-c.MANIFEST_PROGRESS)+c.MANIFEST_PROGRESS,this._sendProgress(this.progress)},b._handleManifestError=function(a){var b=new createjs.Event("fileerror");b.item=a.data,this.dispatchEvent(b)},createjs.FlashAnimationLoader=createjs.promote(a,"AbstractLoader")}(),function(){"use strict";function a(){throw"Mouse cannot be instantiated."}a._stage=!1,a.isMouseInBounds=!0,a.x=0,a.y=0,a.bindings={},a.actions={},a.presses={},a.locks={},a.delayedKeyup={},a.KEYS={LEFT:0,RIGHT:1,WHEEL_UP:2,WHEEL_DOWN:3},a.setTopStage=function(a){this._stage&&this._stage.removeAllEventListeners(),a.on("stagemousedown",this.mousedown,this),a.on("stagemouseup",this.mouseup,this),a.on("stagemousemove",this.mousemove,this),a.on("mouseenter",this.mousebound,this),a.on("mouseleave",this.mousebound,this),this._stage=a},a.mousemove=function(a){a.primary&&(this.x=a.stageX,this.y=a.stageY)},a.mousebound=function(a){this.isMouseInBounds="mouseenter"===a.type},a.mousedown=function(a){var b=a.nativeEvent||a,c=2===b.button?cm.Mouse.KEYS.RIGHT:cm.Mouse.KEYS.LEFT;if(!b.touches||a.primary){this.mousemove(a);var d=this.bindings[c];d&&(this.actions[d]=!0,this.locks[d]||(this.presses[d]=!0,this.locks[d]=!0))}},a.mouseup=function(a){var b=a.nativeEvent||a,c=2===b.button?cm.Mouse.KEYS.RIGHT:cm.Mouse.KEYS.LEFT;if(!b.touches||a.primary){var d=this.bindings[c];d&&(this.delayedKeyup[d]=!0)}},a.bind=function(a,b){this.bindings[a]=b},a.unbind=function(a){var b=this.bindings[a];this.delayedKeyup[b]=!0,this.bindings[a]=null},a.unbindAll=function(){this.bindings={},this.actions={},this.presses={},this.locks={},this.delayedKeyup={}},a.state=function(a){return this.actions[a]},a.pressed=function(a){return this.presses[a]},a.released=function(a){return!!this.delayedKeyup[a]},a.clearPressed=function(){for(var a in this.delayedKeyup)this.actions[a]=!1,this.locks[a]=!1;this.delayedKeyup={},this.presses={}},cm.Mouse=a}(),function(){"use strict";function a(){this.EventDispatcher_constructor(),this.instance=null,this.currentID=null,this.instanceVolume=1,cm.Visibility&&(this._lastID=!1,cm.Visibility.on("CHANGE",this.onVisiblityEvent,this))}var b=cjs.extend(a,cjs.EventDispatcher);b.play=function(a,b,c){a!==this.currentID&&(this.stop(c),this.instanceVolume=b||this.instanceVolume,c=parseInt(c,10),isNaN(c)?this.instance=cjs.Sound.play(a,{loop:-1,volume:b}):(this.instance=cjs.Sound.play(a,{loop:-1,volume:0}),cjs.Tween.get(this.instance).to({volume:b},c,cjs.Ease.quadInOut)),this.currentID=a)},b.stop=function(a){if(this.instance){var b=this.instance;this.instance=null,a=parseInt(a,10),isNaN(a)?b.stop():cjs.Tween.get(b).to({volume:0},a,cjs.Ease.quadInOut).call(b.stop,null,b),this.currentID=null}},b.lowerVolumeForVO=function(){this.instance&&cjs.Tween.get(this.instance,{override:!0}).to({volume:.6*this.instanceVolume},200,cjs.Ease.quadInOut)},b.returnVolumeToNormal=function(){this.instance&&cjs.Tween.get(this.instance,{override:!0}).to({volume:this.instanceVolume},200,cjs.Ease.quadInOut)},b.onVisiblityEvent=function(a){cm.Visibility.hidden?(this._lastID=this.currentID,this.stop()):this.play(this._lastID)};var c=createjs.promote(a,"EventDispatcher");cm.MusicPlayer=new c}(),function(){"use strict";function a(){this.EventDispatcher_constructor(),this.hidden=!1,this.hiddenProp=!1,this.visibilityChangeEvent=!1,this.eventListener=!1,this.init()}var b=cjs.extend(a,cjs.EventDispatcher);b.init=function(){var a,b;"undefined"!=typeof document.hidden?(a="hidden",b="visibilitychange"):"undefined"!=typeof document.msHidden?(a="msHidden",b="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(a="webkitHidden",b="webkitvisibilitychange"),this.hiddenProp=a,this.visibilityChangeEvent=b,"undefined"==typeof document[a]||(this.eventListener=this.onVisiblityChange.bind(this),document.addEventListener(b,this.eventListener))},b.onVisiblityChange=function(a){this.hidden=document[this.hiddenProp],this.dispatchEvent("CHANGE"),this.hidden?cjs.Ticker.paused=!0:cjs.Ticker.paused=!1};var c=createjs.promote(a,"EventDispatcher");cm.Visibility=new c}(),function(){"use strict";function a(){this.EventDispatcher_constructor(),this._soundInstance=null,this._onePlays=[],this._sequence=[],this._index=0,this._callback=null,this.isPlaying=!1,this.waitTween=null,cm.Visibility&&cm.Visibility.on("CHANGE",this.onVisiblityEvent,this)}var b=cjs.extend(a,cjs.EventDispatcher);b.play=function(a,b){this.clearSoundInstance(),"string"==typeof a?this._sequence=[a]:this._sequence=a,this.isPlaying=!0,this._index=-1,this._callback=b,this._next()},b.pause=function(){this._soundInstance&&(this._soundInstance.paused=!0),this.waitTween&&this.waitTween.pause()},b.resume=function(){this._soundInstance&&(this._soundInstance.paused=!1),this.waitTween&&this.waitTween.play()},b.playOnceEver=function(a,b){-1===this._onePlays.indexOf(a)?(this.play(a,b),this._onePlays.push(a)):b&&b()},b.loadAndPlay=function(a){cjs.Sound.on("fileload",this.onFileLoad,this),cjs.Sound.removeSound(a),cjs.Sound.registerSound(a)},b.onFileLoad=function(a){a.remove(),cm.VO.play(a.src,cjs.Sound.removeSound.bind(cjs.Sound,a.src))},b.stop=function(){this.clearSoundInstance(),this._callback=null,this.isPlaying=!1},b._next=function(){this._index++,this.clearSoundInstance();var a=this._sequence[this._index];if("number"==typeof a)this.waitTween=cjs.Tween.get(this).wait(a).call(this._next,null,this);else if("string"==typeof a||"object"==typeof a){var b,c=0;"string"==typeof a?b=a:(b=a.id,c=a.delay),this._soundInstance=cjs.Sound.play(b,{delay:c}),this._soundInstance&&this._soundInstance.playState!==cjs.Sound.PLAY_FAILED?(this._soundInstance.on("complete",this._onSoundComplete,this),cm.MusicPlayer.lowerVolumeForVO()):this._next()}else if(this._callback){cm.MusicPlayer.returnVolumeToNormal();var d=this._callback;this._callback=null,this.isPlaying=!1,d()}else this.isPlaying=!1,cm.MusicPlayer.returnVolumeToNormal()},b.clearSoundInstance=function(){this._soundInstance&&(this._soundInstance.removeAllEventListeners(),"playSucceeded"===this._soundInstance.playState&&this._soundInstance.stop()),this._soundInstance=null,cjs.Tween.removeTweens(this),this.waitTween=null},b._onSoundComplete=function(){this._next()},b.onVisiblityEvent=function(a){cm.Visibility.hidden?this.pause():this.resume()};var c=createjs.promote(a,"EventDispatcher");cm.VO=new c}(),function(){"use strict";function a(){this.Container_constructor(),this.areaName=this.areaName||"",this.world=null,this.regX=1426,this.regY=768,this.buildPhysicsWorld(),this.buildTerrain(null,this.world,1),this.buildBackground(),this.itemHolder=new cjs.Container,this.addChild(this.itemHolder),this.debugBitmap&&this.addChild(this.debugBitmap),this.updateBackground(),this.addHeros(),this.restore()}var b=createjs.extend(a,cjs.Container);b.addHeros=function(){var a=new cm.AreaHero;a.x=0,a.y=768,this.itemHolder.addChild(a)},b.addItem=function(a){if(a.parent){var b=a.parent.localToLocal(a.x,a.y,this.itemHolder);a.x=b.x,a.y=b.y}this.checkGroundObj(a),a.allowFall!==!1&&(a.angleNum=1,a.dir=2*Math.round(Math.random())-1,this.setPhysicsObject(a)),this.itemHolder.addChild(a)},b.checkGroundObj=function(a){("muck-pit"===a.name||"red-algae-bed"===a.name||"barnacles"===a.name||"barnacles-2"===a.name)&&this.positionGroundObject(a)},b.positionGroundObject=function(a){},b.save=function(){for(var a=this.itemHolder.children,b=[],c=0,d=a.length;d>c;c++){var e=a[c];e.isHero||b.push({name:e.name,x:e.x,y:e.y,rotation:e.rotation,width:e.width,height:e.height})}cm.PlayerData.saveArea("Area"+this.areaName,b)},b.restore=function(){var a=cm.PlayerData.getArea("Area"+this.areaName);if(a&&!(a.length<1))for(var b=0;b<a.length;b++){var c=a[b],d=cm.GameObjectHelper.get(c.name);if(d){var e=new d;e.x=c.x,e.y=c.y,e.name=c.name,e.rotation=c.rotation,e.width=c.width,e.height=c.height,e.allowFall=!1,this.addItem(e)}else{var f=new cjs.Bitmap(cm.View.OceanBuilder.assetPath+c.name+".png");f.center(),f.x=c.x,f.y=c.y,f.name=c.name,f.rotation=c.rotation,f.width=c.width,f.height=c.height,f.regX=Math.round(.5*c.width),f.regY=Math.round(.5*c.height),this.addItem(f)}}},b.getCharacterList=function(){for(var a=this.itemHolder.children,b=[],c=0,d=a.length;d>c;c++){var e=a[c],f=cm.GameObjectHelper.get(e.name);f&&f.isSingleCharacter&&b.push(e.name)}return b},b.clear=function(){this.itemHolder.removeAllChildren(),this.save(),this.addHeros()},b.setPhysicsObject=function(a){var b=new b2.b2BodyDef;b.type=b2.b2Body.b2_dynamicBody,b.userData=a;var c=this.world.CreateBody(b);c.stepCount=0;var d=new b2.b2FixtureDef;d.density=1,d.friction=2,d.restitution=.1,d.isSensor=!0,d.userData="isObject";var e=.5*Math.min(a.width,a.height),f=new b2.b2CircleShape(e/b2.b2Scale);f.SetLocalPosition(new b2.b2Vec2(0,0)),d.shape=f,c.CreateFixture(d),c.SetPosition(new b2.b2Vec2(a.x/b2.b2Scale,a.y/b2.b2Scale)),a.pBody=c},b._tick=function(a){this.Container__tick(a),this.debugBitmap&&(this.debugBitmap.visible=cm.Keyboard.state("debug"),this.debugBitmap.x=-this.x+1426,this.debugBitmap.y=-this.y+768),this.updatePhysicWorld()},b.updateBackground=function(){var a=this.background;if(a){var b=cm.System.width,c=cm.System.height,d=.5*b+this.x-this.regX,e=.5*c+this.y-this.regY,f=a.sourceRect;a.x=-d,a.y=-e,f.x=a.x,f.y=a.y,f.width=b,f.height=c-136}},b.buildBackground=function(){this.background=new cjs.Bitmap(cm.Assets.lib.AreaBackground),this.background.sourceRect=new cjs.Rectangle(713,384,cm.System.width,cm.System.height),this.addChild(this.background)},b.checkLevelVisibility=function(){for(var a=cm.System.width,b=cm.System.height,c=this.children,d=0,e=c.length;e>d;d++){var f=c[d],g=this.x-this.regX+f.x+a/2,h=this.y-this.regY+f.y+b/2,i=f.children;if(i)for(var j=0,k=i.length;k>j;j++){var l=i[j];isNaN(l.left)||(l.visible=!(l.right+g<0||l.left+g>a||l.top+h>b||l.bottom+h<0))}}},b.buildPhysicsWorld=function(){if(this.world=new b2.b2World(new b2.b2Vec2(0,1)),cm.debug){var a=document.createElement("canvas");a.width=cm.System.width,a.height=cm.System.height;var b=a.getContext("2d");this.debugBitmap=new cjs.Bitmap(a).set({alpha:.4,regX:713,regY:384});var c=new b2.b2DebugDraw;c.SetSprite(b),c.SetDrawScale(b2.b2Scale),c.SetFillAlpha(.5),c.SetLineThickness(1),c.SetFlags(b2.b2DebugDraw.e_shapeBit|b2.b2DebugDraw.e_jointBit|b2.b2DebugDraw.e_centerOfMassBit),this.world.SetDebugDraw(c),this._debugDraw=c,this._debugCtx=b,this._debugCanvas=a}this.addContactListeners()},b.updatePhysicWorld=function(){var a=this.world;if(a.Step(1/60,8,3),a.ClearForces(),this._debugCtx){this._debugCtx.save();var b=this.localToGlobal(0,0);this._debugCtx.translate(b.x,b.y),a.DrawDebugData(),this._debugCtx.restore()}for(var c=a.GetBodyList();c;){var d=c.GetUserData();if(c._kill)d&&(d.pBody=null),this.world.DestroyBody(c),c=c.GetNext(),this.save();else{if(c.stepCount++,d&&!d.isHero){var e=c.GetPosition(),f=c.GetAngle();d.x=e.x*b2.b2Scale,d.y=e.y*b2.b2Scale,d.rotation>10&&(d.dir=-1),d.rotation<-10&&(d.dir=1),d.angleNum+=1*d.dir,d.angleNum>30&&(d.angleNum=30),d.angleNum<-30&&(d.angleNum=-30),c.SetAngularVelocity(Math.toRad(d.angleNum)),d.rotation=Math.toDeg(f)}c=c.GetNext()}}},b.buildTerrain=function(a,b,c){if(null!==a){var d=new b2.b2BodyDef;d.type=b2.b2Body.b2_staticBody;for(var e=b.CreateBody(d),f=a.fixtures,g=0;g<f.length;g++){var h=f[g],i=new b2.b2FixtureDef;if(i.density=h.density,i.friction=h.friction,i.restitution=h.restitution,i.filter.categoryBits=h.categoryBits,i.filter.maskBits=h.maskBits,i.filter.groupIndex=h.groupIndex,i.isSensor=h.isSensor,h.userData&&(i.userData=h.userData),"POLYGON"===h.fixtureType)for(var j=h.polygons,k=0;k<j.length;k++){for(var l=[],m=0;m<j[k].length;m++)l.push(new b2.b2Vec2(j[k][m][0]/b2.b2Scale*c,j[k][m][1]/b2.b2Scale*c));var n=new b2.b2PolygonShape;n.SetAsArray(l,l.length),i.shape=n,e.CreateFixture(i)}else if("CIRCLE"===h.fixtureType){var o=new b2.b2CircleShape(h.radius/b2.b2Scale);o.SetLocalPosition(new b2.b2Vec2(h.center[0]/b2.b2Scale,h.center[1]/b2.b2Scale)),i.shape=o,e.CreateFixture(i)}}}},b.addContactListeners=function(){var a=new b2.b2ContactListener;this.world.SetContactListener(a),a.BeginContact=function(a){var b=a.GetFixtureA(),c=a.GetFixtureB(),d=c.GetBody();"isObject"===c.GetUserData()&&("ground"===b.GetUserData()||"stickerArea"===b.GetUserData()&&d.stepCount<1)&&(d._kill=!0)}},cm.Area=cjs.promote(a,"Container")}(),function(){"use strict";function a(){this.areaName="Deep",this.Area_constructor()}var b=createjs.extend(a,cm.Area);b.buildTerrain=function(a,b,c){a=cm.Assets.lib.AreaTerrainPhysics.DeepTerrain,this.Area_buildTerrain(a,b,1)},cm.Area.Deep=cjs.promote(a,"Area")}(),function(){"use strict";function a(){this.areaName="KelpForest",this.Area_constructor()}var b=createjs.extend(a,cm.Area);b.positionGroundObject=function(a){a.x<-100?a.y=1404:a.y=1300},b.buildTerrain=function(a,b,c){a=cm.Assets.lib.AreaTerrainPhysics.KelpForestTerrain,this.Area_buildTerrain(a,b,1)},cm.Area.KelpForest=cjs.promote(a,"Area")}(),function(){"use strict";function a(){this.areaName="Reeftown",this.Area_constructor()}var b=createjs.extend(a,cm.Area);b.positionGroundObject=function(a){a.y=1284,(a.x<313||a.x>2713)&&(a.y=1354)},b.buildTerrain=function(a,b,c){a=cm.Assets.lib.AreaTerrainPhysics.ReeftownTerrain,this.Area_buildTerrain(a,b,1)},cm.Area.Reeftown=cjs.promote(a,"Area")}(),function(){"use strict";function a(){this.areaName="SunkenShip",this.Area_constructor()}var b=createjs.extend(a,cm.Area);b.positionGroundObject=function(a){a.x<313?a.y=1394:a.x<1213&&a.x>262?a.y=970:a.x>1213&&a.x<1713?a.y=900:a.x>1713&&(a.y=850)},b.buildTerrain=function(a,b,c){a=cm.Assets.lib.AreaTerrainPhysics.SunkenShipTerrain,this.Area_buildTerrain(a,b,1)},cm.Area.SunkenShip=cjs.promote(a,"Area")}(),function(){"use strict";function a(){throw"GameData cannot be instantiated."}a._raw=null,a.itemList=null,a.setData=function(b){a._raw=b,a.itemList=b.items.list,a.setUnlocks()},a.setUnlocks=function(){for(var b=a.itemList,c=b.length,d=0;c>d;d++){var e=b[d];e.explorer||cm.PlayerData.foundItem(e.id)}},a._validateKey=function(a){switch(a){case cm.Level.SUNKEN_SHIP:case"sunkenship":return"sunkenship";case cm.Level.REEF_TOWN:case"reeftown":return"reeftown";case cm.Level.KELP_FOREST:case"kelpforest":return"kelpforest";case cm.Level.THE_DEEP:case"deep":return"deep";case cm.Level.ANTARCTIC:case"antarctic":return"antarctic"}throw"Please provide valid location key"},a.getDataFor=function(b){for(var c=a.itemList,d=c.length,e=0;d>e;e++){var f=c[e];if(f.id===b)return f}},a.getExplorerItemListFor=function(b){for(var c=a._validateKey(b),d=[],e=a.itemList,f=e.length,g=0;f>g;g++){var h=e[g];h.explorer&&h.locations.indexOf(c)>=0&&d.push(h)}return d},a.getBuilderItemListFor=function(b){for(var c=a._validateKey(b),d=[],e=a.itemList,f=e.length,g=0;f>g;g++){var h=e[g];(cm.PlayerData.isItemUnlocked(h.id)||h.defaultBuildMode)&&h.builder&&h.locations.indexOf(c)>=0&&d.push(h)}return d},cm.GameData=a}(),function(){"use strict";function a(){throw"PlayerData cannot be instantiated."}var b=a;b.sessionData={itemUnlocks:{}},b.persistentData=null,b.areaData={},b._default_data={isFirstTimeUser:!0,flags:[]},b.DATA_KEY="JHC_OceanAdventure_1.0",b.foundItem=function(a){if("string"!=typeof a)throw"addToItemCount id is not a string: "+a;var c=b.sessionData.itemUnlocks;c[a]||(c[a]=!0)},b.isItemUnlocked=function(a){return b.sessionData.itemUnlocks[a]===!0},b.setFirstTimerUserOff=function(){b.persistentData.isFirstTimeUser=!1,b.saveData()},b.isFirstTimeUser=function(){return b.persistentData.isFirstTimeUser},b.saveData=function(){window.localStorage.setItem(b.DATA_KEY,JSON.stringify(b.persistentData))},b.getData=function(){var a=window.localStorage.getItem(b.DATA_KEY);a?b.persistentData=JSON.parse(a):b.clearData()},b.needsFlag=function(a,c){c=c!==!1;var d=b.persistentData.flags,e=-1===d.indexOf(a);return e?(c&&(d.push(a),b.saveData()),!0):!1},b.saveArea=function(a,c){b.areaData[a]=c},b.getArea=function(a){return b.areaData[a]},b.clearData=function(){b.persistentData=JSON.parse(JSON.stringify(b._default_data)),b.saveData()},b.unlockAll=function(){for(var a=cm.config.items.list,c=0;c<a.length;c++){var d=a[c];b.foundItem(d.id)}b.saveData()},b.getData(),cm.PlayerData=b}(),function(){"use strict";function a(a){this.Container_constructor(),this.physicsWorld=a,this.isPhysicsObject=!1}var b=createjs.extend(a,cjs.Container);b.switchSpots=function(a){a._cloneProps(this);var b=a.parent,c=b.getChildIndex(a);b.addChildAt(this,c),b.removeChild(a)},b.addPhysicsBody=function(a,b,c){var d=new b2.b2BodyDef;d.type=c,d.userData=this;var e=b.CreateBody(d),f=1,g=1;this&&(f=this.scaleX,g=this.scaleY);for(var h=a.fixtures,i=0;i<h.length;i++){var j=h[i],k=new b2.b2FixtureDef;if(k.density=j.density,k.friction=j.friction,k.restitution=j.restitution,k.filter.categoryBits=j.categoryBits,k.filter.maskBits=j.maskBits,k.filter.groupIndex=j.groupIndex,k.isSensor=j.isSensor,j.userData&&(k.userData=j.userData),"POLYGON"===j.fixtureType)for(var l=j.polygons,m=0;m<l.length;m++){for(var n=[],o=0;o<l[m].length;o++)n.push(new b2.b2Vec2(l[m][o][0]/b2.b2Scale*f,l[m][o][1]/b2.b2Scale*g));var p=new b2.b2PolygonShape;p.SetAsArray(n,n.length),k.shape=p,e.CreateFixture(k)}else if("CIRCLE"===j.fixtureType){var q=new b2.b2CircleShape(j.radius/b2.b2Scale);q.SetLocalPosition(new b2.b2Vec2(j.center[0]/b2.b2Scale,j.center[1]/b2.b2Scale)),k.shape=q,e.CreateFixture(k)}}this._body=e,this._killed=!1,this.isPhysicsObject=!0,this.setPhysicsDisplayProps(a)},b.addSensorCircle=function(a,b){var c=new b2.b2BodyDef;c.type=b2.b2Body.b2_staticBody,c.userData=this;var d=a.CreateBody(c),e=new b2.b2FixtureDef;e.isSensor=!0;var f=new b2.b2CircleShape(b/b2.b2Scale);e.shape=f,d.CreateFixture(e),this._body=d,this._killed=!1},b.setPhysicsDisplayProps=function(a){this.displayObject&&(this.displayObject.regX=a.spriteRegX,this.displayObject.regY=a.spriteRegY)},b.getPhysicsTransform=function(){var a=this._body,b=this;if(a&&b){var c=a.GetPosition();c.x=b.x/b2.b2Scale,c.y=b.y/b2.b2Scale,a.SetPosition(c),a.SetAngle(b.rotation*Math.PI/180)}},b.update=function(){this.isPhysicsObject&&this.updatePhysics()},b.updatePhysics=function(){var a=this._body,b=this;if(a&&b){if(this._killed){var c=a.GetWorld();c.DestroyBody(a),b.parent&&b.parent.removeChild(b)}var d=b2.b2Scale,e=a.GetPosition(),f=e.x*d,g=e.y*d;b.x=f,b.y=g,b.rotation=180*a.GetAngle()/Math.PI}},b.destroy=function(){this._killed=!0},cm.GameObject=cjs.promote(a,"Container");
}(),function(){"use strict";function a(){}var b=a.prototype;b.getLoaderData=function(a,b){for(var c=cm.Assets.data[a],d=0;d<c.length;d++){var e=c[d];if(e.id===b)return e}return null},b.get=function(a,b){if(b)switch(a){case"GameObjectPinkFishSchool":return cm.GameObject.FishSchoolPinkFish;case"GameObjectSilverFishSchool":return cm.GameObject.FishSchoolSilverFish;case"GameObjectYellowFishSchool":return cm.GameObject.FishSchoolYellowFish;case"GameObjectBlueTangSchool":return cm.GameObject.FishSchoolBlueTang;case"scallop-shell":case"treasure-chest":case"maury":case"BarrelBubbles":case"PowderedBlueTang":case"tidy":case"Flounder":case"muck-pit":case"SilverFishPeak":return cm.GameObject.ProximityEasterEgg}switch(a){case"oblo":return cm.Character.Oblo;case"biggie":return cm.Character.Biggie;case"lu-and-bob":return cm.Character.LuAndBob;case"boo":return cm.Character.Boo;case"mortimer":return cm.Character.Mortimer;case"mac":return cm.Character.Mac;case"tidy":return cm.Character.Tidy;case"mrs-tidy":return cm.Character.MrsTidy;case"tyke":return cm.Character.Tyke;case"gush":return cm.Character.Gush;case"maury":return cm.Character.Maury;case"denny":return cm.Character.Denny;case"wave":return cm.Character.Wave;case"chompy":return cm.Character.Chompy;case"zee":return cm.Character.Zee;case"pearlene":return cm.Character.Pearlene;case"charlie":return cm.Character.Charlie;case"snap":return cm.Character.Snap;case"flo":return cm.Character.Flo;case"scout-and-snap":return cm.Character.ScoutAndSnap;case"jellyfish":return cm.GameObject.Jellyfish;case"penguin":return cm.GameObject.Penguin;case"krill":return cm.GameObject.Krill;case"DecoratorCrab":return cm.GameObject.DecoratorCrab;case"firefly-squid":return cm.GameObject.FireflySquid;case"pink-anthias":return cm.GameObject.PinkAnthias;case"tube-worms":return cm.GameObject.GiantTubeWorms;case"sunkenbarrel":return cm.GameObject.SunkenBarrel;case"feather-duster":return cm.GameObject.FeatherDuster}return!1},cm.GameObjectHelper=new a}(),function(){"use strict";function a(a){this.GameObject_constructor(a),this.isLoaded=!1,this.loadSelf()}var b=createjs.extend(a,cm.GameObject);b.loadSelf=function(a){a&&(cm.Assets.lib[a.id]?this.onLoadComplete():cm.Assets.load([a],this.onLoadComplete.bind(this)))},b.onLoadComplete=function(){this.buildMovieClip(),this.isLoaded=!0},b.buildMovieClip=function(a){var b=this.anim=new a;if(b.framerate=24,this.addChild(b),b.nominalBounds&&(b.maxBounds=b.nominalBounds,b.frameBounds&&b.frameBounds.length>1)){var c=b.maxBounds;c.x=c.y=c.width=c.height=0;for(var d=0;d<b.frameBounds.length;d++){var e=b.frameBounds[d];if(e){var f=e.x,g=f+e.width,h=e.y,i=h+e.height;f<c.x&&(c.x=f),g>c.x+c.width&&(c.width=g-c.x),h<c.y&&(c.y=h),i>c.y+c.height&&(c.height=i-c.y)}}}},b._tick=function(a){var b=this.anim&&this.anim.maxBounds;b&&(this.left=this.x+this.anim.x+b.x,this.right=this.left+b.width,this.top=this.y+this.anim.y+b.y,this.bottom=this.top+b.height),this.GameObject__tick(a)},cm.AutoLoadingAnimation=cjs.promote(a,"GameObject")}(),function(){"use strict";function a(a){this.AutoLoadingAnimation_constructor(a),this.set({mouseChildren:!1,isCollectible:!0,isMovieClip:!0})}var b=createjs.extend(a,cm.AutoLoadingAnimation);b.switchSpots=function(a){this.AutoLoadingAnimation_switchSpots(a),this.collectibleID=a.collectibleID},cm.CollectibleAnimation=cjs.promote(a,"AutoLoadingAnimation")}(),function(){"use strict";function a(b){this.GameObject_constructor(b),this.mouseChildren=!1,this.isHero=!0,this.currentLabel="Idle",this.targetPt=new cjs.Point,this.screenPt=new cjs.Point,this.vel=new cjs.Point,this.vortexBody=null,this.isReturning=!0,this.character=a.rotation.randomRotation(2),this.changeTo(this.character)}var b=a;b.rotation=["Splash","Bubbles","Dunk","Ripple"];var c=createjs.extend(a,cm.GameObject);c.playEasterEgg=function(){switch(this.inEasterEggMode=!0,this.animation.onSpecialEnd=this.onSpecialEnd.bind(this),this.character){case"Splash":case"Bubbles":case"Ripple":this.animation.gotoAndPlay("Special");break;case"Dunk":this.animation.gotoAndPlay("Startle")}this.currentLabel="Special",cm.CharacterVO.playEasterEgg(this.character)},c.onSpecialEnd=function(){this.animation.onSpecialEnd=null,this.inEasterEggMode=!1},c.changeTo=function(a){this.character=a,this.removeAllChildren();var b;switch(this.character){case"Splash":b=new cm.Assets.lib.MainCharacters.SplashClip;break;case"Bubbles":b=new cm.Assets.lib.MainCharacters.BubblesClip;break;case"Ripple":b=new cm.Assets.lib.MainCharacters.RippleClip;break;case"Dunk":b=new cm.Assets.lib.MainCharacters.DunkClip}b.framerate=24,b.gotoAndPlay("Idle"),this.animation=b,this.animation.changeSnapToPixel(!1),this.addChild(b),this.isObstacleInProgress=!1},c.changeAnimation=function(a){this.animation&&!this.inEasterEggMode&&this.currentLabel!==a&&(this.currentLabel=a,this.animation.gotoAndPlay(a))},c._tick=function(a){if(this.GameObject__tick(a),!this.inEasterEggMode&&!this.dragging){var b=0,c=this.targetPt,d=this.screenPt;this.localToGlobal(0,0,d);var e=.5*cm.System.width,f=.5*cm.System.height;d.x-=e,d.y-=f;var g=-e,h=e,i=-f,j=f-160,k=this.vel,l=d.x<g||d.y<i||d.x>h||d.y>j;if(l&&(this.isReturning=!0),l||this.isReturning){g+=200,h-=200,i+=160,j-=200,d.x<g?c.x=this.x-d.x+g:d.x>h?c.x=this.x-d.x+h:c.x=this.x,d.y<i?c.y=this.y-d.y+i:d.y>j?c.y=this.y-d.y+j:c.y=this.y;var m=c.x-this.x,n=c.y-this.y,o=Math.pointDistance(c,this);if(o>50){var p=Math.atan2(n,m),q=400;k.x=q*Math.cos(p),k.y=q*Math.sin(p),0!==m&&(this.scaleX=m>0?1:-1),b=p,this.scaleX<0&&(b-=Math.PI),this.rotation=b*Math.RADTODEG,this.changeAnimation("Swim")}else this.isReturning=!1}this.x+=k.x*cm.tick,this.y+=k.y*cm.tick,k.x*=.9,k.y*=.9;var r=Math.sqrt(k.x*k.x+k.y*k.y);1>r&&0===this.rotation?this.changeAnimation("Idle"):this.isReturning||((this.rotation>180||this.rotation<-180)&&(this.rotation+=360),this.rotation*=.9,this.rotation<1&&this.rotation>-1&&(this.rotation=0)),"Idle"===this.currentLabel&&(this.rotation=0)}},c.onTargetPointComplete=function(){this.stopBody(),this.isObstacleInProgress=!0,this.pendingObstacle.attempt(this)},cm.AreaHero=cjs.promote(a,"GameObject")}(),function(){"use strict";function a(a){this.CollectibleAnimation_constructor(a)}createjs.extend(a,cm.CollectibleAnimation);cm.Character=cjs.promote(a,"CollectibleAnimation")}(),function(){"use strict";function a(a){this.GameObject_constructor(a),this.bestCharacter="",this.wrongVO="",this.mouseChildren=!1,this.isObstacle=!0,this.isComplete=!1}var b=createjs.extend(a,cm.GameObject);b.switchSpots=function(a){for(;a.children.length;)this.addChild(a.children[0]);this.GameObject_switchSpots(a),this.obstacleType=a.obstacleType},b.characterCheck=function(a){return a===this.bestCharacter},b.getTargetPoint=function(){return new cjs.Point(this.x,this.y)},b.attempt=function(a){},b.onComplete=function(){for(var a,b=0;b<this.children.length;b++){var c=this.children[b];if(c.isCollectible){a=c;break}}cm.ViewControl.current.level.onCollectibleTap(a),this.isComplete=!0},cm.Obstacle=cjs.promote(a,"GameObject")}(),function(){"use strict";function a(a){this.Obstacle_constructor(a),this.bestCharacter="Ripple",this.wrongVO="obstacle-pebbles-take1"}var b=createjs.extend(a,cm.Obstacle);b.getTargetPoint=function(){return new cjs.Point(this.x+10,this.y-130)},b.attempt=function(a){a.animation.onStroke=this.onStroke.bind(this),a.changeAnimation("Pebbles"),this.player=a},b.onStroke=function(){cjs.Sound.play("sfx-pebbles");for(var a="Ripple"===this.player.character?2:1,b=this.children,c=b.length-1;c>=1;c--){var d=b[c];if(!d.used&&(this.throwPebble(d),1===c&&(this.player.onObstacleComplete(),this.isComplete=!0,cjs.Tween.get(this).wait(500).call(this.onComplete,null,this)),a--,0>=a))return}},b.throwPebble=function(a){var b=a.x+60*Math.plusOrMinus(),c=a.y+160,d=(a.x+b)/2,e=a.y-60;cjs.Tween.get(a).to({guide:{path:[a.x,a.y,d,e,b,c]}},1e3,cjs.Ease.quadInOut),cjs.Tween.get(a).wait(700).to({alpha:0},300).call(a.parent.removeChild,[a],a.parent)},cm.ObstaclePebbles=cjs.promote(a,"Obstacle")}(),function(){"use strict";function a(a){this.Obstacle_constructor(a),this.bestCharacter="Dunk",this.wrongVO="obstacle-rocks",this.movesLeft=6}var b=createjs.extend(a,cm.Obstacle);b.getTargetPoint=function(){return new cjs.Point(this.x,this.y-100)},b.attempt=function(a){a.animation.framerate=40,a.animation.onStroke=this.onStroke.bind(this),a.changeAnimation("Slam"),this.player=a},b.onStroke=function(){cjs.Sound.play("sfx-rockhit"),"Dunk"===this.player.character&&(this.movesLeft=1),this.movesLeft--,this.movesLeft<=0&&(this.player.onObstacleComplete(),cjs.Tween.get(this).wait(500).call(this.onComplete,null,this))},b.onComplete=function(){this.children[1].play(),cjs.Tween.get(this.children[1]).wait(1e3).to({alpha:0},600,cjs.Ease.quadInOut).set({visible:!1}),this.player.animation.framerate=24,this.Obstacle_onComplete()},cm.ObstacleRockPile=cjs.promote(a,"Obstacle")}(),function(){"use strict";function a(a){this.Obstacle_constructor(a),this.bestCharacter="Bubbles",this.wrongVO="obstacle-sand",this.movesLeft=5,this.moveAmountLeft=0}var b=createjs.extend(a,cm.Obstacle);b.getTargetPoint=function(){return new cjs.Point(this.x,this.y-160)},b.attempt=function(a){var b=this.children[0],c=b.getTransformedBounds();this.moveAmountLeft=-1*(c.y+c.height),a.animation.onStroke=this.onStroke.bind(this),a.changeAnimation("Dig"),this.player=a},b.onStroke=function(){cjs.Sound.play("sfx-sand"),"Bubbles"===this.player.character&&(this.movesLeft=1);var a=this.moveAmountLeft/this.movesLeft;this.moveAmountLeft-=a,this.addDustCloud();var b=this.children[0];cjs.Tween.get(b,{override:!0}).to({y:b.y+a},200,cjs.Ease.quadInOut),this.movesLeft--,this.movesLeft<=0&&(this.player.onObstacleComplete(),cjs.Tween.get(this).wait(500).call(this.onComplete,null,this),this.addChild(b))},b.addDustCloud=function(){var a=new cjs.Sprite(cm.Assets.lib.GameSS,"DustCloud");a.framerate=24,a.regX=158,a.regY=104,this.addChild(a),cjs.Tween.get(a).to({alpha:0},750).call(this.removeChild,[a],this)},cm.ObstacleSandCover=cjs.promote(a,"Obstacle")}(),function(){"use strict";function a(a){this.Obstacle_constructor(a),this.bestCharacter="Splash",this.wrongVO="obstacle-current",this.isVortex=!0;var b=cm.Assets.lib.LevelPhysics.Vortex;this.addPhysicsBody(b,a,b2.b2Body.b2_staticBody)}var b=createjs.extend(a,cm.Obstacle);b.switchSpots=function(a){this.Obstacle_switchSpots(a),this.addAnimation(),this.getPhysicsTransform()},b.addAnimation=function(){var a=new cm.Assets.lib.GameplayAnim.Vortex;a.scaleX=a.scaleY=1.4,this.removeChildAt(this.children.length-1),this.addChild(a)},b.setPhysicsDisplayProps=function(a){},b.setCollectible=function(){this.collectible=this.children[0],this.ox=this.collectible.x,this.oy=this.collectible.y},b.update=function(){!this.isComplete&&this.collectible&&(this.collectible.x=this.ox+Math.range(-5,5),this.collectible.y=this.oy+Math.range(-5,5)),this.Obstacle_update()},b.getTargetPoint=function(){return new cjs.Point(this.x,this.y)},b.attempt=function(a){this.isComplete||(this.player=a,this.player.onObstacleComplete(),this.onComplete())},cm.ObstacleVortex=cjs.promote(a,"Obstacle")}(),function(){"use strict";function a(){this.Container_constructor(),this.mainStage=cm.main.gameStage.canvas,this.movementBtn=null,this.world=null,this.mainLevelLayer=null,this.playerPt=new cjs.Point,this.reusablePt=new cjs.Point,this.bubblePool=[],this.movementIdle=0,this._x=0,this._y=0,this.minX=0,this.minY=0,this.regX=0,this.regY=0,this.runningTime=0,this.addControlHitbox(),this.buildPhysicsWorld(),this.buildFromFlashExport(),this.findGameObjects(),this.setScreenBounds(this),this.addPlayer(400,384)}a.SUNKEN_SHIP="SunkenShip",a.REEF_TOWN="Reeftown",a.KELP_FOREST="KelpForest",a.THE_DEEP="Deep",a.ANTARCTIC="Antarctic";var b=createjs.extend(a,cjs.Container);b.setActive=function(a){a?(this.movementBtn.on("mousedown",this.onDragEvent,this),this.movementBtn.on("pressmove",this.onDragEvent,this),this.movementBtn.on("pressup",this.onDragEvent,this),this.mainLevelLayer.on("click",this.onLevelClick,this)):(this.movementBtn.removeAllEventListeners(),this.mainLevelLayer.removeAllEventListeners())},b._tick=function(a){this.Container__tick(a),this.debugBitmap&&(this.debugBitmap.visible=cm.Keyboard.state("debug")),this.updatePhysicWorld();var b=this.playerPt;this.player.localToGlobal(0,0,b);var c=0,d=0,e=this.mainStage.width/2,f=this.mainStage.height/2;b.x<e?c=e-b.x:b.x>this.mainStage.width-e&&(c=this.mainStage.width-e-b.x),b.y<f-60?d=f-b.y-60:b.y>this.mainStage.height-f-60&&(d=this.mainStage.height-f-b.y-60);var g=this._x+c,h=this._y+d;g=this._x=Math.limit(g,this.minX,0),h=this._y=Math.limit(h,this.minY,0);for(var i=this.children,j=0;j<i.length;j++){var k=i[j];(k.px||k.py)&&(k.x=g*k.px,k.y=h*k.py)}var l=cm.tick;this.movementIdle+=l,this.runningTime+=1e3*l,this.checkLevelVisibility(),this.performVisualHints(this.runningTime),this.updateBubbles(l)},b.performVisualHints=function(a){for(var b=this.collectibles,c=0,d=b.length;d>c;c++){var e=b[c];if(!e.isAlreadyFound&&e.visible&&e.parent.visible){e.lastBubble||(e.lastBubble=a);var f=e.lastBubble,g=a-f;g>1e3&&(this.spawnHintBubbleAt(e),e.lastBubble=a+Math.range(-500,1e3))}}},b.spawnHintBubbleAt=function(a){var b=this.getAvailableBubble();b||(b=new cm.Assets.lib.GameplayAnim.Bubble,this.bubblePool.push(b));var c=this.mainLevelLayer,d=this.reusablePt,e=a.parent;e.localToLocal(a.x,a.y,c,d),a.anim&&(d.x+=a.anim.x,d.y+=a.anim.y),b.visible=!0,b.alpha=1,b.scale=0,b.x=d.x,b.y=d.y;var f=c.getChildIndex(a);0>f&&(f=c.getChildIndex(a.parent)),c.addChildAt(b,f-1)},b.updateBubbles=function(a){for(var b=.4,c=this.bubblePool,d=0,e=c.length;e>d;d++){var f=c[d];f.visible&&(f.y-=200*a,f.alpha-=.5*a,f.scale+=a*b,f.scale>b&&(f.scale=b),f.alpha<0&&(f.visible=!1))}},b.getAvailableBubble=function(){for(var a=0;a<this.bubblePool.length;a++){var b=this.bubblePool[a];if(!b.visible)return b}},b.onDragEvent=function(a){return"pressup"===a.type?(this.player.mouseX=-1,void(this.player.mouseY=-1)):(this.player.mouseX=a.stageX,this.player.mouseY=a.stageY,void(this.movementIdle=0))},b.updatePhysicWorld=function(){var a=this.world;a.Step(cm.tick,8,3),a.ClearForces(),this._debugCtx&&(this._debugCtx.save(),this._debugCtx.translate(this._x,this._y),a.DrawDebugData(),this._debugCtx.restore());for(var b=a.GetBodyList();b;){var c=b.GetUserData();c&&c.update&&c.update(),b=b.GetNext()}},b.checkLevelVisibility=function(){for(var a=this.mainStage.width,b=this.mainStage.height-140,c=this.children,d=0;d<c.length;d++){var e=c[d],f=e.children;if(f)for(var g=e.x,h=e.y,i=0;i<f.length;i++){var j=f[i];isNaN(j.left)||(j.visible=!(j.right+g<0||j.left+g>a||j.top+h>b||j.bottom+h<0),j.tickEnabled=j.visible)}}},b.isItemFullyVisible=function(a){if(!a.left)return null;var b=this.mainStage.width,c=this.mainStage.height-140,d=a.parent.x,e=a.parent.y;return!(a.right+d>b||a.left+d<0||a.top+e<0||a.bottom+e>c)},b.buildPhysicsWorld=function(){if(this.world=new b2.b2World(new b2.b2Vec2(0,0)),cm.debug){var a=document.createElement("canvas");a.width=this.mainStage.width,a.height=this.mainStage.height;var b=a.getContext("2d");this.debugBitmap=new cjs.Bitmap(a).set({alpha:.4});var c=new b2.b2DebugDraw;c.SetSprite(b),c.SetDrawScale(b2.b2Scale),c.SetFillAlpha(.5),c.SetLineThickness(1),c.SetFlags(b2.b2DebugDraw.e_shapeBit|b2.b2DebugDraw.e_jointBit|b2.b2DebugDraw.e_centerOfMassBit),this.world.SetDebugDraw(c),this._debugDraw=c,this._debugCtx=b,this._debugCanvas=a}this.buildTerrain(null,this.world,1),this.addContactListeners()},b.buildTerrain=function(a,b,c){if(null!==a){var d=new b2.b2BodyDef;d.type=b2.b2Body.b2_staticBody;for(var e=b.CreateBody(d),f=a.fixtures,g=0;g<f.length;g++){var h=f[g],i=new b2.b2FixtureDef;if(i.density=h.density,i.friction=h.friction,i.restitution=h.restitution,i.filter.categoryBits=h.categoryBits,i.filter.maskBits=h.maskBits,i.filter.groupIndex=h.groupIndex,i.isSensor=h.isSensor,h.userData&&(i.userData=h.userData),"POLYGON"===h.fixtureType)for(var j=h.polygons,k=0;k<j.length;k++){for(var l=[],m=0;m<j[k].length;m++)l.push(new b2.b2Vec2(j[k][m][0]/b2.b2Scale*c,j[k][m][1]/b2.b2Scale*c));var n=new b2.b2PolygonShape;n.SetAsArray(l,l.length),i.shape=n,e.CreateFixture(i)}else if("CIRCLE"===h.fixtureType){var o=new b2.b2CircleShape(h.radius/b2.b2Scale);o.SetLocalPosition(new b2.b2Vec2(h.center[0]/b2.b2Scale,h.center[1]/b2.b2Scale)),i.shape=o,e.CreateFixture(i)}}}},b.findGameObjects=function(){for(var a=[],b=[],c=this.mainLevelLayer.children,d=0;d<c.length;d++){var e=c[d];if(e.mouseChildren=!1,e.mouseEnabled=e.isCollectible||e.isObstacle,e.isCollectible)b.push(e);else if(e.isObstacle)a.push(e);else{var f=this.checkForGameObject(e.symbolName);if(f){var g=new f(this.world);g.switchSpots(e)}}}a=this.pickObstacles(a),b=this.pickCollectibles(b,a),this.checkCollectiblesForGameObjectClass(b),this.numOfCollectibles=b.length,this.collectibles=b},b.checkLayerForGameObjects=function(a){for(var b=a.children,c=0;c<b.length;c++){var d=b[c];d.mouseChildren=!1;var e=this.checkForGameObject(d.symbolName);if(e){var f=new e(this.world);f.switchSpots(d)}}},b.pickObstacles=function(a){a.shuffle();for(var b=[],c=[],d=cm.PlayerData.isFirstTimeUser(),e=0;e<a.length;e++){var f=a[e];(e>0||d)&&(d||c.indexOf(f.obstacleType)>-1||!this.checkDistances(f,b,900))?this.removeGameObject(f):(f=this.addObstacleGameObject(f),c.push(f.obstacleType),b.push(f))}return b},b.addObstacleGameObject=function(a){var b;switch(a.obstacleType){case"pebbles":b=cm.ObstaclePebbles;break;case"rockPile":b=cm.ObstacleRockPile;break;case"sandCover":b=cm.ObstacleSandCover;break;case"vortex":b=cm.ObstacleVortex}var c=new b(this.world);return c.switchSpots(a),c},b.pickCollectibles=function(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=!1,g=b[e],h=g.children.clone();h.shuffle();for(var i=0;i<h.length;i++){var j=h[i];if(j.isCollectible){var k=d.indexOf(j.collectibleID)>=0;f||k?this.removeGameObject(j):(f=!0,j.obstacle=g,j.mouseChildren=!1,this.checkCollectibleForHitbox(j),c.push(j),d.push(j.collectibleID))}}f?"vortex"===g.obstacleType&&g.setCollectible():this.removeGameObject(g)}for(a.shuffle(),e=0;e<a.length;e++){var l=a[e];d.indexOf(l.collectibleID)>=0?this.removeGameObject(l):(this.checkCollectibleForHitbox(l),c.push(l),d.push(l.collectibleID))}return c},b.checkCollectibleForHitbox=function(a){},b.checkCollectibleForMultiples=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.children.length>1&&"holdfast"!==c.collectibleID)for(var d=c.children.clone(),e=1;e<d.length;e++)this.removeGameObject(d[e])}},b.checkCollectiblesForGameObjectClass=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=this.checkForGameObject(c.collectibleID);if(d){var e=new d(this.world);e.switchSpots(c),e.hacked||(a[b]=e)}}},b.getCharacterClass=function(a){},b.checkDistances=function(a,b,c){for(var d=1/0,e=0;e<b.length;e++){var f=b[e];if(f.parent===a.parent){var g=Math.pointDistance(f,a);d>g&&(d=g)}}return d>c},b.removeGameObject=function(a){a.parent&&a.parent.removeChild(a)},b.checkForGameObject=function(a){return cm.GameObjectHelper.get(a,!0)},b.addContactListeners=function(){var a=new b2.b2ContactListener;this.world.SetContactListener(a),a.PreSolve=function(a){var b=a.GetFixtureA(),c=b.GetBody(),d=c.GetUserData(),e=a.GetFixtureB(),f=e.GetBody(),g=f.GetUserData();d&&d.preSolve&&d.preSolve(f,e,g,c,b,a),g&&g.preSolve&&g.preSolve(c,b,d,f,e,a)},a.BeginContact=function(a){var b=a.GetFixtureA(),c=b.GetBody(),d=c.GetUserData(),e=a.GetFixtureB(),f=e.GetBody(),g=f.GetUserData();d&&d.beginContact&&d.beginContact(f,e,g,c,b,a),g&&g.beginContact&&g.beginContact(c,b,d,f,e,a)},a.EndContact=function(a){var b=a.GetFixtureA(),c=b.GetBody(),d=c.GetUserData(),e=a.GetFixtureB(),f=e.GetBody(),g=f.GetUserData();d&&d.endContact&&d.endContact(f,e,g,c,b,a),g&&g.endContact&&g.endContact(c,b,d,f,e,a)},a.PostSolve=function(a){var b=a.GetFixtureA(),c=b.GetBody(),d=c.GetUserData(),e=a.GetFixtureB(),f=e.GetBody(),g=f.GetUserData();d&&d.postSolve&&d.postSolve(f,e,g,c,b,a),g&&g.postSolve&&g.postSolve(c,b,d,f,e,a)}},b.onLevelClick=function(a){var b=a.target;b.isCollectible?this.onCollectibleTap(b):b.isObstacle&&this.onObstacleTap(b)},b.onCollectibleTap=function(a){a.isAlreadyFound||(this.onCollectibleFound(a),a.isAlreadyFound=!0,a.mouseEnabled=!1)},b.onCollectibleFound=function(a){var b=a;b.addChild&&this.addSparkleToItem(b);var c=new cjs.Event("COLLECTIBLE_FOUND");c.data=b,this.dispatchEvent(c)},b.addSparkleToItem=function(a){var b=a.getBounds(),c=(b.width+100)/360,d=(b.height+100)/344,e=(c+d)/2,f=new cjs.Sprite(cm.Assets.lib.GameSS,"Sparkle").set({alpha:0,scaleX:0,scaleY:0,regX:180,regY:172});a.addChildAt(f,0),cjs.Tween.get(f,{loop:!0}).to({rotation:360},2e3,cjs.Ease.linear),cjs.Tween.get(f).to({alpha:.8,scaleX:e,scaleY:e},600,cjs.Ease.cubicOut).wait(1e3).to({alpha:0},600,cjs.Ease.cubicIn).call(cjs.Tween.removeTweens,[f],cjs.Tween).call(a.removeChild,[f],a)},b.onObstacleTap=function(a){var b=a.characterCheck(this.player.character);if(!b){a.attemptTime||(a.attemptTime=0);var c=Date.now()-a.attemptTime;if(c>6e3)return a.attemptTime=Date.now(),cm.PlayerData.needsFlag("ObstacleChangeHint")&&cm.DemoHand.tapObject(this.parent.ui.characterPicker),void cm.VO.play(a.wrongVO)}this.player.attemptObstacle(a)},b.addPlayer=function(a,b){var c=this.player=new cm.Player(this.world);c.x=a,c.y=b,this.mainLevelLayer.addChild(c),c.getPhysicsTransform()},b.addControlHitbox=function(){this.movementBtn=new cjs.DisplayObject,this.movementBtn.hitArea=new cjs.Shape,this.movementBtn.hitArea.graphics.f("#000").r(0,0,1426,768),this.addChild(this.movementBtn)},b.buildFromFlashExport=function(a,b){this.setSymbolNames(a);var c=new b;c._tick({delta:100}),this.simplifyContainer(this,c),this.debugBitmap&&this.addChild(this.debugBitmap)},b.simplifyContainer=function(a,b){for(var c=0;c<b.children.length;c++){var d=b.children[c],e=null;if(d instanceof cjs.Sprite||d instanceof cjs.Bitmap)e=d.clone();else{if(!(d instanceof cjs.MovieClip))continue;d._ignoreSimplify===!0?e=d:(e=d._cloneProps(new cjs.Container),this.simplifyContainer(e,d))}d.collectibleID&&(e.collectibleID=d.collectibleID,e.isCollectible=!0),d.obstacleType&&(e.obstacleType=d.obstacleType,e.isObstacle=!0),e.symbolName=d.symbolName;var f=b.children.length;a.addChild(e),f!==b.children.length&&c--}},b.setSymbolNames=function(a){for(var b in a)a[b].prototype&&(a[b].prototype.symbolName=b)},b.setScreenBounds=function(a){for(var b=new cjs.Rectangle,c=0;c<a.children.length;c++){var d=a.children[c],e=d.children;if(e)for(var f=0;f<e.length;f++){var g=e[f];if(g.nominalBounds){var h=g.nominalBounds;g.frameBounds&&(h=this.getMaxBounds(g.frameBounds,b)),g.left=g.x+h.x,g.right=g.left+h.width,g.top=g.y+h.y,g.bottom=g.top+h.height}else{var i=g.getTransformedBounds();if(i){var j=i.x,k=j+i.width,l=i.y,m=l+i.height;g.left=j,g.right=k,g.top=l,g.bottom=m}}}}},b.getMaxBounds=function(a,b){b.x=b.y=b.width=b.height=0;for(var c=0;c<a.length;c++){var d=a[c];if(d){var e=d.x,f=e+d.width,g=d.y,h=g+d.height;e<b.x&&(b.x=e),f>b.x+b.width&&(b.width=f-b.x),g<b.y&&(b.y=g),h>b.y+b.height&&(b.height=h-b.y)}}return b},cm.Level=cjs.promote(a,"Container")}(),function(){"use strict";function a(){this.Level_constructor(),this.checkLayerForGameObjects(this.children[3]),this.minX=-11500,this.minY=-904}var b=createjs.extend(a,cm.Level);b.buildFromFlashExport=function(){this.Level_buildFromFlashExport(cm.Assets.lib.LevelLib,cm.Assets.lib.LevelLib.Reeftown);var a=this.children[1];a.set({px:0,py:1,mouseEnabled:!1,mouseChildren:!1});var b=this.children[2];b.set({px:.609,py:1,mouseEnabled:!1,mouseChildren:!1});var c=this.children[3];c.set({px:.739,py:1,mouseEnabled:!1,mouseChildren:!1}),this.mainLevelLayer=this.children[4],this.mainLevelLayer.px=1,this.mainLevelLayer.py=1;var d=this.children[5];d.set({px:1.74,py:1,mouseEnabled:!1,mouseChildren:!1})},cm.Level.Reeftown=cjs.promote(a,"Level")}(),function(){"use strict";function a(a){this.GameObject_constructor(a),this.snapToPixel=this.mouseEnabled=this.mouseChildren=!1,this.isHero=!0,this.currentLabel="Idle",this.mouseX=-1,this.mouseY=-1,this.targetPt=null,this.vortexBody=null,this.isObstacleInProgress=!1,this.mousePt=new cjs.Point,this.pushAngle=!1,this.pushStrength=0,this.swimLoop=cjs.Sound.play("sfx-swim-loop",{loop:-1,volume:0});var b={spriteRegX:0,spriteRegY:0,fixtures:[{density:1,friction:0,restitution:0,categoryBits:1,maskBits:65535,groupIndex:0,isSensor:!1,userData:"",fixtureType:"CIRCLE",center:[0,0],radius:60}]};this.addPhysicsBody(b,a,b2.b2Body.b2_dynamicBody)}var b=createjs.extend(a,cm.GameObject);b.changeTo=function(a){this.character=a,this.removeAllChildren();var b;switch(this.character){case"Splash":b=new cm.Assets.lib.MainCharacters.SplashClip;break;case"Bubbles":b=new cm.Assets.lib.MainCharacters.BubblesClip;break;case"Ripple":b=new cm.Assets.lib.MainCharacters.RippleClip;break;case"Dunk":b=new cm.Assets.lib.MainCharacters.DunkClip}b.framerate=24,b.gotoAndPlay("Idle"),this.animation=b,this.animation.changeSnapToPixel(!1),this.addChild(b),this.currentLabel="Idle",this.isObstacleInProgress=!1},b.changeAnimation=function(a){this.currentLabel!==a&&(this.currentLabel=a,this.animation.gotoAndPlay(a))},b.addPhysicsBody=function(a,b,c){this.GameObject_addPhysicsBody(a,b,c),this._body.SetLinearDamping(3),this.regX=this.regY=0},b.update=function(){var a=0;if(this.mouseEnabled=this.mouseX>-1&&this.mouseY>-1,this.animation&&!this.isObstacleInProgress){var b;if(this.targetPt&&(b=this.targetPt),this.mouseEnabled&&(this.targetPt=null,b=this.mousePt,this.parent.globalToLocal(this.mouseX,this.mouseY,b)),b){this.swimLoop.volume=1;var c=b.x-this.x,d=b.y-this.y,e=Math.pointDistance(b,this);if(e>50){var f=Math.atan2(d,c),g=400;g*=this.vortexBody&&"Splash"!==this.character?.9:e/250,g=Math.limit(g,250,670);var h=this._body.GetLinearVelocity();h.x=g*Math.cos(f)/b2.b2Scale,h.y=g*Math.sin(f)/b2.b2Scale,this._body.ApplyImpulse(h,this._body.GetWorldCenter()),0!==c&&(this.scaleX=c>0?1:-1),a=f,this.scaleX<0&&(a-=Math.PI),this._body.SetAngle(a),this.changeAnimation("Swim")}else this.targetPt&&(this.targetPt=null,this._body.SetAngle(0),this.onTargetPointComplete())}else if(this._body.GetLinearVelocity().Length()<1&&0===this.rotation)this.changeAnimation("Idle"),this.swimLoop.volume>1e-6&&(this.swimLoop.volume*=.9);else{this.swimLoop.volume>1e-6&&(this.swimLoop.volume*=.9),a=0,this.rotation<-270&&(a=-360);var i=this._body.GetAngle(),j=a-i,k=2*Math.DEGTORAD,l=i+Math.min(k,Math.max(-k,j));this._body.SetAngle(l),this.rotation<-360&&(this.rotation=0,this._body.SetAngle(0))}var m=this._body.GetLinearVelocity().Length();this.animation.framerate=24+Math.floor(m/24*36),this.vortexBody&&this.applyVortexWell(),this.pushAngle!==!1&&(this.applyPushAngle(),this.pushAngle=!1),this.GameObject_update(),"Idle"===this.currentLabel&&(this.rotation=0)}},b.stopBody=function(){var a=this._body.GetLinearVelocity();a.SetZero(),this._body.SetLinearVelocity(a)},b.attemptObstacle=function(a){this.isObstacleInProgress||a.isComplete||(a.characterCheck(this.character),this.targetPt=a.getTargetPoint(),this.pendingObstacle=a)},b.onObstacleComplete=function(){this.isObstacleInProgress=!1,this.animation.onStroke=null,this.pendingObstacle=null},b.onTargetPointComplete=function(){this.stopBody(),!this.isObstacleInProgress&&this.pendingObstacle&&(this.isObstacleInProgress=!0,this.pendingObstacle.attempt(this))},b.applyVortexWell=function(){var a=this._body,b=this.vortexBody,c=b.GetPosition(),d=a.GetPosition(),e=Math.atan2(c.y-d.y,c.x-d.x),f=b2.b2Math.Distance(d,c),g=(15-f)/15*-250;-140>g&&(g=-140),this.targetPt||this.mouseEnabled?"Splash"===this.character&&(g*=.3):g*=.3,a.ApplyImpulse(new b2.b2Vec2(Math.cos(e)*g,Math.sin(e)*g),a.GetWorldCenter())},b.applyPushAngle=function(){var a=this._body,b=this.pushAngle*Math.DEGTORAD,c=this.pushStrength;a.ApplyImpulse(new b2.b2Vec2(Math.cos(b)*c,Math.sin(b)*c),a.GetWorldCenter())},b.beginContact=function(a,b,c,d,e,f){c&&c.isVortex&&(this.vortexBody=a,"collectionZone"===b.GetUserData()&&c.attempt(this))},b.endContact=function(a,b,c,d,e,f){c&&c.isVortex&&"collectionZone"!==b.GetUserData()&&(this.vortexBody=null)},cm.Player=cjs.promote(a,"GameObject")}(),function(){"use strict";function a(a,b){this.EventDispatcher_constructor(),this.physicsData=a,this.displayObject=b,this.displayObject.actor=this,this._body=null,this.setDisplayProps(a)}var b=createjs.extend(a,cjs.EventDispatcher);b.setDisplayProps=function(a){this.displayObject&&(this.displayObject.regX=a.spriteRegX,this.displayObject.regY=a.spriteRegY)},b.setPosition=function(a,b){var c=this._body;if(c){var d=c.GetPosition();d.x=a/b2.b2Scale,d.y=b/b2.b2Scale,c.SetPosition(d)}},b.getPropsFromDisplayObject=function(){var a=this._body,b=this.displayObject;if(a&&b){var c=a.GetPosition();c.x=b.x/b2.b2Scale,c.y=b.y/b2.b2Scale,a.SetPosition(c),a.SetAngle(b.rotation*Math.PI/180)}},b.update=function(){var a=this._body,b=this.displayObject;if(a&&b){if(this._killed){var c=a.GetWorld();c.DestroyBody(a),b.parent&&b.parent.removeChild(b)}var d=b2.b2Scale,e=a.GetPosition(),f=e.x*d,g=e.y*d;b.x=f,b.y=g,b.rotation=180*a.GetAngle()/Math.PI}},b.createBody=function(a,b){var c=this.physicsData;if(!c)throw"No Physics Data Provided!";var d=new b2.b2BodyDef;d.type=b,d.userData=this;var e=a.CreateBody(d),f=1,g=1;this.displayObject&&(f=this.displayObject.scaleX,g=this.displayObject.scaleY);for(var h=c.fixtures,i=0;i<h.length;i++){var j=h[i],k=new b2.b2FixtureDef;if(k.density=j.density,k.friction=j.friction,k.restitution=j.restitution,k.filter.categoryBits=j.categoryBits,k.filter.maskBits=j.maskBits,k.filter.groupIndex=j.groupIndex,k.isSensor=j.isSensor,j.userData&&(k.userData=j.userData),"POLYGON"===j.fixtureType)for(var l=j.polygons,m=0;m<l.length;m++){for(var n=[],o=0;o<l[m].length;o++)n.push(new b2.b2Vec2(l[m][o][0]/b2.b2Scale*f,l[m][o][1]/b2.b2Scale*g));var p=new b2.b2PolygonShape;p.SetAsArray(n,n.length),k.shape=p,e.CreateFixture(k)}else if("CIRCLE"===j.fixtureType){var q=new b2.b2CircleShape(j.radius/b2.b2Scale);q.SetLocalPosition(new b2.b2Vec2(j.center[0]/b2.b2Scale,j.center[1]/b2.b2Scale)),k.shape=q,e.CreateFixture(k)}}this._body=e,this._killed=!1},b.destroy=function(){this._killed=!0},cm.Box2DActor=cjs.promote(a,"EventDispatcher")}(),function(){window.b2={},b2.b2Scale=30,b2.extend=function(a,b){for(var c in b)a[c]=b[c]},b2.isInstanceOf=function(a,b){for(;"object"==typeof a;){if(a.constructor===b)return!0;a=a._super}return!1},b2.b2BoundValues=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2BoundValues.prototype.__constructor=function(){this.lowerValues=[],this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=[],this.upperValues[0]=0,this.upperValues[1]=0},b2.b2BoundValues.prototype.__varz=function(){},b2.b2BoundValues.prototype.lowerValues=null,b2.b2BoundValues.prototype.upperValues=null,b2.b2PairManager=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2PairManager.prototype.__constructor=function(){this.m_pairs=[],this.m_pairBuffer=[],this.m_pairCount=0,this.m_pairBufferCount=0,this.m_freePair=null},b2.b2PairManager.prototype.__varz=function(){},b2.b2PairManager.prototype.AddPair=function(a,b){var c=a.pairs[b];return null!=c?c:(null==this.m_freePair&&(this.m_freePair=new b2.b2Pair,this.m_pairs.push(this.m_freePair)),c=this.m_freePair,this.m_freePair=c.next,c.proxy1=a,c.proxy2=b,c.status=0,c.userData=null,c.next=null,a.pairs[b]=c,b.pairs[a]=c,++this.m_pairCount,c)},b2.b2PairManager.prototype.RemovePair=function(a,b){var c=a.pairs[b];if(null==c)return null;var d=c.userData;return delete a.pairs[b],delete b.pairs[a],c.next=this.m_freePair,c.proxy1=null,c.proxy2=null,c.userData=null,c.status=0,this.m_freePair=c,--this.m_pairCount,d},b2.b2PairManager.prototype.Find=function(a,b){return a.pairs[b]},b2.b2PairManager.prototype.ValidateBuffer=function(){},b2.b2PairManager.prototype.ValidateTable=function(){},b2.b2PairManager.prototype.Initialize=function(a){this.m_broadPhase=a},b2.b2PairManager.prototype.AddBufferedPair=function(a,b){var c=this.AddPair(a,b);0==c.IsBuffered()&&(c.SetBuffered(),this.m_pairBuffer[this.m_pairBufferCount]=c,++this.m_pairBufferCount),c.ClearRemoved(),b2.b2BroadPhase.s_validate&&this.ValidateBuffer();
},b2.b2PairManager.prototype.RemoveBufferedPair=function(a,b){var c=this.Find(a,b);null!=c&&(0==c.IsBuffered()&&(c.SetBuffered(),this.m_pairBuffer[this.m_pairBufferCount]=c,++this.m_pairBufferCount),c.SetRemoved(),b2.b2BroadPhase.s_validate&&this.ValidateBuffer())},b2.b2PairManager.prototype.Commit=function(a){var b=0;for(b=0;b<this.m_pairBufferCount;++b){var c=this.m_pairBuffer[b];c.ClearBuffered();var d=c.proxy1,e=c.proxy2;c.IsRemoved()||0==c.IsFinal()&&a(d.userData,e.userData)}this.m_pairBufferCount=0,b2.b2BroadPhase.s_validate&&this.ValidateTable()},b2.b2PairManager.prototype.m_broadPhase=null,b2.b2PairManager.prototype.m_pairs=null,b2.b2PairManager.prototype.m_freePair=null,b2.b2PairManager.prototype.m_pairCount=0,b2.b2PairManager.prototype.m_pairBuffer=null,b2.b2PairManager.prototype.m_pairBufferCount=0,b2.b2TimeStep=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2TimeStep.prototype.__constructor=function(){},b2.b2TimeStep.prototype.__varz=function(){},b2.b2TimeStep.prototype.Set=function(a){this.dt=a.dt,this.inv_dt=a.inv_dt,this.positionIterations=a.positionIterations,this.velocityIterations=a.velocityIterations,this.warmStarting=a.warmStarting},b2.b2TimeStep.prototype.dt=null,b2.b2TimeStep.prototype.inv_dt=null,b2.b2TimeStep.prototype.dtRatio=null,b2.b2TimeStep.prototype.velocityIterations=0,b2.b2TimeStep.prototype.positionIterations=0,b2.b2TimeStep.prototype.warmStarting=null,b2.b2Controller=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Controller.prototype.__constructor=function(){},b2.b2Controller.prototype.__varz=function(){},b2.b2Controller.prototype.Step=function(a){},b2.b2Controller.prototype.Draw=function(a){},b2.b2Controller.prototype.AddBody=function(a){var b=new b2.b2ControllerEdge;b.controller=this,b.body=a,b.nextBody=m_bodyList,b.prevBody=null,m_bodyList=b,b.nextBody&&(b.nextBody.prevBody=b),m_bodyCount++,b.nextController=a.m_controllerList,b.prevController=null,a.m_controllerList=b,b.nextController&&(b.nextController.prevController=b),a.m_controllerCount++},b2.b2Controller.prototype.RemoveBody=function(a){for(var b=a.m_controllerList;b&&b.controller!=this;)b=b.nextController;b.prevBody&&(b.prevBody.nextBody=b.nextBody),b.nextBody&&(b.nextBody.prevBody=b.prevBody),b.nextController&&(b.nextController.prevController=b.prevController),b.prevController&&(b.prevController.nextController=b.nextController),m_bodyList==b&&(m_bodyList=b.nextBody),a.m_controllerList==b&&(a.m_controllerList=b.nextController),a.m_controllerCount--,m_bodyCount--},b2.b2Controller.prototype.Clear=function(){for(;m_bodyList;)this.RemoveBody(m_bodyList.body)},b2.b2Controller.prototype.GetNext=function(){return this.m_next},b2.b2Controller.prototype.GetWorld=function(){return this.m_world},b2.b2Controller.prototype.GetBodyList=function(){return m_bodyList},b2.b2Controller.prototype.m_next=null,b2.b2Controller.prototype.m_prev=null,b2.b2Controller.prototype.m_world=null,b2.b2GravityController=function(){b2.b2Controller.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2GravityController.prototype,b2.b2Controller.prototype),b2.b2GravityController.prototype._super=b2.b2Controller.prototype,b2.b2GravityController.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2GravityController.prototype.__varz=function(){},b2.b2GravityController.prototype.Step=function(a){var b=null,c=null,d=null,e=0,f=null,g=null,h=null,i=0,j=0,k=0,l=null;if(this.invSqr)for(b=m_bodyList;b;b=b.nextBody)for(c=b.body,d=c.GetWorldCenter(),e=c.GetMass(),f=m_bodyList;f!=b;f=f.nextBody)g=f.body,h=g.GetWorldCenter(),i=h.x-d.x,j=h.y-d.y,k=i*i+j*j,k<Number.MIN_VALUE||(l=new b2.b2Vec2(i,j),l.Multiply(this.G/k/Math.sqrt(k)*e*g.GetMass()),c.IsAwake()&&c.ApplyForce(l,d),l.Multiply(-1),g.IsAwake()&&g.ApplyForce(l,h));else for(b=m_bodyList;b;b=b.nextBody)for(c=b.body,d=c.GetWorldCenter(),e=c.GetMass(),f=m_bodyList;f!=b;f=f.nextBody)g=f.body,h=g.GetWorldCenter(),i=h.x-d.x,j=h.y-d.y,k=i*i+j*j,k<Number.MIN_VALUE||(l=new b2.b2Vec2(i,j),l.Multiply(this.G/k*e*g.GetMass()),c.IsAwake()&&c.ApplyForce(l,d),l.Multiply(-1),g.IsAwake()&&g.ApplyForce(l,h))},b2.b2GravityController.prototype.G=1,b2.b2GravityController.prototype.invSqr=!0,b2.b2DestructionListener=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DestructionListener.prototype.__constructor=function(){},b2.b2DestructionListener.prototype.__varz=function(){},b2.b2DestructionListener.prototype.SayGoodbyeJoint=function(a){},b2.b2DestructionListener.prototype.SayGoodbyeFixture=function(a){},b2.b2ContactEdge=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactEdge.prototype.__constructor=function(){},b2.b2ContactEdge.prototype.__varz=function(){},b2.b2ContactEdge.prototype.other=null,b2.b2ContactEdge.prototype.contact=null,b2.b2ContactEdge.prototype.prev=null,b2.b2ContactEdge.prototype.next=null,b2.b2EdgeChainDef=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2EdgeChainDef.prototype.__constructor=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},b2.b2EdgeChainDef.prototype.__varz=function(){},b2.b2EdgeChainDef.prototype.vertices=null,b2.b2EdgeChainDef.prototype.vertexCount=null,b2.b2EdgeChainDef.prototype.isALoop=null,b2.b2Vec2=function(a,b){2==arguments.length&&(this.x=a,this.y=b)},b2.b2Vec2.Make=function(a,b){return new b2.b2Vec2(a,b)},b2.b2Vec2.prototype.SetZero=function(){this.x=0,this.y=0},b2.b2Vec2.prototype.Set=function(a,b){this.x=a,this.y=b},b2.b2Vec2.prototype.SetV=function(a){this.x=a.x,this.y=a.y},b2.b2Vec2.prototype.GetNegative=function(){return new b2.b2Vec2(-this.x,-this.y)},b2.b2Vec2.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},b2.b2Vec2.prototype.Copy=function(){return new b2.b2Vec2(this.x,this.y)},b2.b2Vec2.prototype.Add=function(a){this.x+=a.x,this.y+=a.y},b2.b2Vec2.prototype.Subtract=function(a){this.x-=a.x,this.y-=a.y},b2.b2Vec2.prototype.Multiply=function(a){this.x*=a,this.y*=a},b2.b2Vec2.prototype.MulM=function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y,this.y=a.col1.y*b+a.col2.y*this.y},b2.b2Vec2.prototype.MulTM=function(a){var b=b2.b2Math.Dot(this,a.col1);this.y=b2.b2Math.Dot(this,a.col2),this.x=b},b2.b2Vec2.prototype.CrossVF=function(a){var b=this.x;this.x=a*this.y,this.y=-a*b},b2.b2Vec2.prototype.CrossFV=function(a){var b=this.x;this.x=-a*this.y,this.y=a*b},b2.b2Vec2.prototype.MinV=function(a){this.x=this.x<a.x?this.x:a.x,this.y=this.y<a.y?this.y:a.y},b2.b2Vec2.prototype.MaxV=function(a){this.x=this.x>a.x?this.x:a.x,this.y=this.y>a.y?this.y:a.y},b2.b2Vec2.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},b2.b2Vec2.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},b2.b2Vec2.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},b2.b2Vec2.prototype.Normalize=function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;return this.x*=b,this.y*=b,a},b2.b2Vec2.prototype.IsValid=function(){return b2.b2Math.IsValid(this.x)&&b2.b2Math.IsValid(this.y)},b2.b2Vec2.prototype.Limit=function(a){var b=this.LengthSquared();return b>a*a&&(this.Multiply(1/Math.sqrt(b)),this.Multiply(a)),this},b2.b2Vec2.prototype.x=0,b2.b2Vec2.prototype.y=0,b2.b2Vec3=function(a,b,c){3==arguments.length&&(this.x=a,this.y=b,this.z=c)},b2.b2Vec3.prototype.SetZero=function(){this.x=this.y=this.z=0},b2.b2Vec3.prototype.Set=function(a,b,c){this.x=a,this.y=b,this.z=c},b2.b2Vec3.prototype.SetV=function(a){this.x=a.x,this.y=a.y,this.z=a.z},b2.b2Vec3.prototype.GetNegative=function(){return new b2.b2Vec3(-this.x,-this.y,-this.z)},b2.b2Vec3.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},b2.b2Vec3.prototype.Copy=function(){return new b2.b2Vec3(this.x,this.y,this.z)},b2.b2Vec3.prototype.Add=function(a){this.x+=a.x,this.y+=a.y,this.z+=a.z},b2.b2Vec3.prototype.Subtract=function(a){this.x-=a.x,this.y-=a.y,this.z-=a.z},b2.b2Vec3.prototype.Multiply=function(a){this.x*=a,this.y*=a,this.z*=a},b2.b2Vec3.prototype.x=0,b2.b2Vec3.prototype.y=0,b2.b2Vec3.prototype.z=0,b2.b2DistanceProxy=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DistanceProxy.prototype.__constructor=function(){},b2.b2DistanceProxy.prototype.__varz=function(){},b2.b2DistanceProxy.prototype.Set=function(a){switch(a.GetType()){case b2.b2Shape.e_circleShape:var b=a;this.m_vertices=new Array(1),this.m_vertices[0]=b.m_p,this.m_count=1,this.m_radius=b.m_radius;break;case b2.b2Shape.e_polygonShape:var c=a;this.m_vertices=c.m_vertices,this.m_count=c.m_vertexCount,this.m_radius=c.m_radius;break;default:b2.b2Settings.b2Assert(!1)}},b2.b2DistanceProxy.prototype.GetSupport=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1;d<this.m_count;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return b},b2.b2DistanceProxy.prototype.GetSupportVertex=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1;d<this.m_count;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return this.m_vertices[b]},b2.b2DistanceProxy.prototype.GetVertexCount=function(){return this.m_count},b2.b2DistanceProxy.prototype.GetVertex=function(a){return b2.b2Settings.b2Assert(a>=0&&a<this.m_count),this.m_vertices[a]},b2.b2DistanceProxy.prototype.m_vertices=null,b2.b2DistanceProxy.prototype.m_count=0,b2.b2DistanceProxy.prototype.m_radius=null,b2.b2ContactFactory=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactFactory.prototype.__constructor=function(a){this.m_allocator=a,this.InitializeRegisters()},b2.b2ContactFactory.prototype.__varz=function(){},b2.b2ContactFactory.prototype.AddType=function(a,b,c,d){this.m_registers[c][d].createFcn=a,this.m_registers[c][d].destroyFcn=b,this.m_registers[c][d].primary=!0,c!=d&&(this.m_registers[d][c].createFcn=a,this.m_registers[d][c].destroyFcn=b,this.m_registers[d][c].primary=!1)},b2.b2ContactFactory.prototype.InitializeRegisters=function(){this.m_registers=new Array(b2.b2Shape.e_shapeTypeCount);for(var a=0;a<b2.b2Shape.e_shapeTypeCount;a++){this.m_registers[a]=new Array(b2.b2Shape.e_shapeTypeCount);for(var b=0;b<b2.b2Shape.e_shapeTypeCount;b++)this.m_registers[a][b]=new b2.b2ContactRegister}this.AddType(b2.b2CircleContact.Create,b2.b2CircleContact.Destroy,b2.b2Shape.e_circleShape,b2.b2Shape.e_circleShape),this.AddType(b2.b2PolyAndCircleContact.Create,b2.b2PolyAndCircleContact.Destroy,b2.b2Shape.e_polygonShape,b2.b2Shape.e_circleShape),this.AddType(b2.b2PolygonContact.Create,b2.b2PolygonContact.Destroy,b2.b2Shape.e_polygonShape,b2.b2Shape.e_polygonShape),this.AddType(b2.b2EdgeAndCircleContact.Create,b2.b2EdgeAndCircleContact.Destroy,b2.b2Shape.e_edgeShape,b2.b2Shape.e_circleShape),this.AddType(b2.b2PolyAndEdgeContact.Create,b2.b2PolyAndEdgeContact.Destroy,b2.b2Shape.e_polygonShape,b2.b2Shape.e_edgeShape)},b2.b2ContactFactory.prototype.Create=function(a,b){var c,d=a.GetType(),e=b.GetType(),f=this.m_registers[d][e];if(f.pool)return c=f.pool,f.pool=c.m_next,f.poolCount--,c.Reset(a,b),c;var g=f.createFcn;return null!=g?f.primary?(c=g(this.m_allocator),c.Reset(a,b),c):(c=g(this.m_allocator),c.Reset(b,a),c):null},b2.b2ContactFactory.prototype.Destroy=function(a){a.m_manifold.m_pointCount>0&&(a.m_fixtureA.m_body.SetAwake(!0),a.m_fixtureB.m_body.SetAwake(!0));var b,c=a.m_fixtureA.GetType(),d=a.m_fixtureB.GetType(),e=this.m_registers[c][d];e.poolCount++,a.m_next=e.pool,e.pool=a,(b=e.destroyFcn)(a,this.m_allocator)},b2.b2ContactFactory.prototype.m_registers=null,b2.b2ContactFactory.prototype.m_allocator=null,b2.b2ConstantAccelController=function(){b2.b2Controller.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2ConstantAccelController.prototype,b2.b2Controller.prototype),b2.b2ConstantAccelController.prototype._super=b2.b2Controller.prototype,b2.b2ConstantAccelController.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2ConstantAccelController.prototype.__varz=function(){this.A=new b2.b2Vec2(0,0)},b2.b2ConstantAccelController.prototype.Step=function(a){for(var b=new b2.b2Vec2(this.A.x*a.dt,this.A.y*a.dt),c=m_bodyList;c;c=c.nextBody){var d=c.body;d.IsAwake()&&d.SetLinearVelocity(new b2.b2Vec2(d.GetLinearVelocity().x+b.x,d.GetLinearVelocity().y+b.y))}},b2.b2ConstantAccelController.prototype.A=new b2.b2Vec2(0,0),b2.b2SeparationFunction=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2SeparationFunction.prototype.__constructor=function(){},b2.b2SeparationFunction.prototype.__varz=function(){this.m_localPoint=new b2.b2Vec2,this.m_axis=new b2.b2Vec2},b2.b2SeparationFunction.e_points=1,b2.b2SeparationFunction.e_faceA=2,b2.b2SeparationFunction.e_faceB=4,b2.b2SeparationFunction.prototype.Initialize=function(a,b,c,d,e){this.m_proxyA=b,this.m_proxyB=d;var f=a.count;b2.b2Settings.b2Assert(f>0&&3>f);var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(1==f)this.m_type=b2.b2SeparationFunction.e_points,g=this.m_proxyA.GetVertex(a.indexA[0]),j=this.m_proxyB.GetVertex(a.indexB[0]),t=g,s=c.R,m=c.position.x+(s.col1.x*t.x+s.col2.x*t.y),n=c.position.y+(s.col1.y*t.x+s.col2.y*t.y),t=j,s=e.R,o=e.position.x+(s.col1.x*t.x+s.col2.x*t.y),p=e.position.y+(s.col1.y*t.x+s.col2.y*t.y),this.m_axis.x=o-m,this.m_axis.y=p-n,this.m_axis.Normalize();else if(a.indexB[0]==a.indexB[1])this.m_type=b2.b2SeparationFunction.e_faceA,h=this.m_proxyA.GetVertex(a.indexA[0]),i=this.m_proxyA.GetVertex(a.indexA[1]),j=this.m_proxyB.GetVertex(a.indexB[0]),this.m_localPoint.x=.5*(h.x+i.x),this.m_localPoint.y=.5*(h.y+i.y),this.m_axis=b2.b2Math.CrossVF(b2.b2Math.SubtractVV(i,h),1),this.m_axis.Normalize(),t=this.m_axis,s=c.R,q=s.col1.x*t.x+s.col2.x*t.y,r=s.col1.y*t.x+s.col2.y*t.y,t=this.m_localPoint,s=c.R,m=c.position.x+(s.col1.x*t.x+s.col2.x*t.y),n=c.position.y+(s.col1.y*t.x+s.col2.y*t.y),t=j,s=e.R,o=e.position.x+(s.col1.x*t.x+s.col2.x*t.y),p=e.position.y+(s.col1.y*t.x+s.col2.y*t.y),u=(o-m)*q+(p-n)*r,0>u&&this.m_axis.NegativeSelf();else if(a.indexA[0]==a.indexA[0])this.m_type=b2.b2SeparationFunction.e_faceB,k=this.m_proxyB.GetVertex(a.indexB[0]),l=this.m_proxyB.GetVertex(a.indexB[1]),g=this.m_proxyA.GetVertex(a.indexA[0]),this.m_localPoint.x=.5*(k.x+l.x),this.m_localPoint.y=.5*(k.y+l.y),this.m_axis=b2.b2Math.CrossVF(b2.b2Math.SubtractVV(l,k),1),this.m_axis.Normalize(),t=this.m_axis,s=e.R,q=s.col1.x*t.x+s.col2.x*t.y,r=s.col1.y*t.x+s.col2.y*t.y,t=this.m_localPoint,s=e.R,o=e.position.x+(s.col1.x*t.x+s.col2.x*t.y),p=e.position.y+(s.col1.y*t.x+s.col2.y*t.y),t=g,s=c.R,m=c.position.x+(s.col1.x*t.x+s.col2.x*t.y),n=c.position.y+(s.col1.y*t.x+s.col2.y*t.y),u=(m-o)*q+(n-p)*r,0>u&&this.m_axis.NegativeSelf();else{h=this.m_proxyA.GetVertex(a.indexA[0]),i=this.m_proxyA.GetVertex(a.indexA[1]),k=this.m_proxyB.GetVertex(a.indexB[0]),l=this.m_proxyB.GetVertex(a.indexB[1]);var w=(b2.b2Math.MulX(c,g),b2.b2Math.MulMV(c.R,b2.b2Math.SubtractVV(i,h))),x=(b2.b2Math.MulX(e,j),b2.b2Math.MulMV(e.R,b2.b2Math.SubtractVV(l,k))),y=w.x*w.x+w.y*w.y,z=x.x*x.x+x.y*x.y,A=b2.b2Math.SubtractVV(x,w),B=w.x*A.x+w.y*A.y,C=x.x*A.x+x.y*A.y,D=w.x*x.x+w.y*x.y,E=y*z-D*D;u=0,0!=E&&(u=b2.b2Math.Clamp((D*C-B*z)/E,0,1));var F=(D*u+C)/z;0>F&&(F=0,u=b2.b2Math.Clamp((D-B)/y,0,1)),g=new b2.b2Vec2,g.x=h.x+u*(i.x-h.x),g.y=h.y+u*(i.y-h.y),j=new b2.b2Vec2,j.x=k.x+u*(l.x-k.x),j.y=k.y+u*(l.y-k.y),0==u||1==u?(this.m_type=b2.b2SeparationFunction.e_faceB,this.m_axis=b2.b2Math.CrossVF(b2.b2Math.SubtractVV(l,k),1),this.m_axis.Normalize(),this.m_localPoint=j,t=this.m_axis,s=e.R,q=s.col1.x*t.x+s.col2.x*t.y,r=s.col1.y*t.x+s.col2.y*t.y,t=this.m_localPoint,s=e.R,o=e.position.x+(s.col1.x*t.x+s.col2.x*t.y),p=e.position.y+(s.col1.y*t.x+s.col2.y*t.y),t=g,s=c.R,m=c.position.x+(s.col1.x*t.x+s.col2.x*t.y),n=c.position.y+(s.col1.y*t.x+s.col2.y*t.y),v=(m-o)*q+(n-p)*r,0>u&&this.m_axis.NegativeSelf()):(this.m_type=b2.b2SeparationFunction.e_faceA,this.m_axis=b2.b2Math.CrossVF(b2.b2Math.SubtractVV(i,h),1),this.m_localPoint=g,t=this.m_axis,s=c.R,q=s.col1.x*t.x+s.col2.x*t.y,r=s.col1.y*t.x+s.col2.y*t.y,t=this.m_localPoint,s=c.R,m=c.position.x+(s.col1.x*t.x+s.col2.x*t.y),n=c.position.y+(s.col1.y*t.x+s.col2.y*t.y),t=j,s=e.R,o=e.position.x+(s.col1.x*t.x+s.col2.x*t.y),p=e.position.y+(s.col1.y*t.x+s.col2.y*t.y),v=(o-m)*q+(p-n)*r,0>u&&this.m_axis.NegativeSelf())}},b2.b2SeparationFunction.prototype.Evaluate=function(a,b){var c,d,e,f,g,h,i,j;switch(this.m_type){case b2.b2SeparationFunction.e_points:return c=b2.b2Math.MulTMV(a.R,this.m_axis),d=b2.b2Math.MulTMV(b.R,this.m_axis.GetNegative()),e=this.m_proxyA.GetSupportVertex(c),f=this.m_proxyB.GetSupportVertex(d),g=b2.b2Math.MulX(a,e),h=b2.b2Math.MulX(b,f),i=(h.x-g.x)*this.m_axis.x+(h.y-g.y)*this.m_axis.y;case b2.b2SeparationFunction.e_faceA:return j=b2.b2Math.MulMV(a.R,this.m_axis),g=b2.b2Math.MulX(a,this.m_localPoint),d=b2.b2Math.MulTMV(b.R,j.GetNegative()),f=this.m_proxyB.GetSupportVertex(d),h=b2.b2Math.MulX(b,f),i=(h.x-g.x)*j.x+(h.y-g.y)*j.y;case b2.b2SeparationFunction.e_faceB:return j=b2.b2Math.MulMV(b.R,this.m_axis),h=b2.b2Math.MulX(b,this.m_localPoint),c=b2.b2Math.MulTMV(a.R,j.GetNegative()),e=this.m_proxyA.GetSupportVertex(c),g=b2.b2Math.MulX(a,e),i=(g.x-h.x)*j.x+(g.y-h.y)*j.y;default:return b2.b2Settings.b2Assert(!1),0}},b2.b2SeparationFunction.prototype.m_proxyA=null,b2.b2SeparationFunction.prototype.m_proxyB=null,b2.b2SeparationFunction.prototype.m_type=0,b2.b2SeparationFunction.prototype.m_localPoint=new b2.b2Vec2,b2.b2SeparationFunction.prototype.m_axis=new b2.b2Vec2,b2.b2DynamicTreePair=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DynamicTreePair.prototype.__constructor=function(){},b2.b2DynamicTreePair.prototype.__varz=function(){},b2.b2DynamicTreePair.prototype.proxyA=null,b2.b2DynamicTreePair.prototype.proxyB=null,b2.b2ContactConstraintPoint=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactConstraintPoint.prototype.__constructor=function(){},b2.b2ContactConstraintPoint.prototype.__varz=function(){this.localPoint=new b2.b2Vec2,this.rA=new b2.b2Vec2,this.rB=new b2.b2Vec2},b2.b2ContactConstraintPoint.prototype.localPoint=new b2.b2Vec2,b2.b2ContactConstraintPoint.prototype.rA=new b2.b2Vec2,b2.b2ContactConstraintPoint.prototype.rB=new b2.b2Vec2,b2.b2ContactConstraintPoint.prototype.normalImpulse=null,b2.b2ContactConstraintPoint.prototype.tangentImpulse=null,b2.b2ContactConstraintPoint.prototype.normalMass=null,b2.b2ContactConstraintPoint.prototype.tangentMass=null,b2.b2ContactConstraintPoint.prototype.equalizedMass=null,b2.b2ContactConstraintPoint.prototype.velocityBias=null,b2.b2ControllerEdge=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ControllerEdge.prototype.__constructor=function(){},b2.b2ControllerEdge.prototype.__varz=function(){},b2.b2ControllerEdge.prototype.controller=null,b2.b2ControllerEdge.prototype.body=null,b2.b2ControllerEdge.prototype.prevBody=null,b2.b2ControllerEdge.prototype.nextBody=null,b2.b2ControllerEdge.prototype.prevController=null,b2.b2ControllerEdge.prototype.nextController=null,b2.b2DistanceInput=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DistanceInput.prototype.__constructor=function(){},b2.b2DistanceInput.prototype.__varz=function(){},b2.b2DistanceInput.prototype.proxyA=null,b2.b2DistanceInput.prototype.proxyB=null,b2.b2DistanceInput.prototype.transformA=null,b2.b2DistanceInput.prototype.transformB=null,b2.b2DistanceInput.prototype.useRadii=null,b2.b2Settings=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Settings.prototype.__constructor=function(){},b2.b2Settings.prototype.__varz=function(){},b2.b2SettingsMixFriction=function(a,b){return Math.sqrt(a*b)},b2.b2SettingsMixRestitution=function(a,b){return a>b?a:b},b2.b2Settings.b2Assert=function(a){if(!a)throw"Assertion Failed"},b2.b2Settings.USHRT_MAX=65535,b2.b2Settings.b2_pi=Math.PI,b2.b2Settings.b2_maxManifoldPoints=2,b2.b2Settings.b2_aabbExtension=.1,b2.b2Settings.b2_aabbMultiplier=2,b2.b2Settings.b2_polygonRadius=2*b2.b2Settings.b2_linearSlop,b2.b2Settings.b2_linearSlop=.005,b2.b2Settings.b2_angularSlop=2/180*b2.b2Settings.b2_pi,b2.b2Settings.b2_toiSlop=8*b2.b2Settings.b2_linearSlop,b2.b2Settings.b2_maxTOIContactsPerIsland=32,b2.b2Settings.b2_maxTOIJointsPerIsland=32,b2.b2Settings.b2_velocityThreshold=1,b2.b2Settings.b2_maxLinearCorrection=.2,b2.b2Settings.b2_maxAngularCorrection=8/180*b2.b2Settings.b2_pi,b2.b2Settings.b2_maxTranslation=2,b2.b2Settings.b2_maxTranslationSquared=b2.b2Settings.b2_maxTranslation*b2.b2Settings.b2_maxTranslation,b2.b2Settings.b2_maxRotation=.5*b2.b2Settings.b2_pi,b2.b2Settings.b2_maxRotationSquared=b2.b2Settings.b2_maxRotation*b2.b2Settings.b2_maxRotation,b2.b2Settings.b2_contactBaumgarte=.2,b2.b2Settings.b2_timeToSleep=.5,b2.b2Settings.b2_linearSleepTolerance=.01,b2.b2Settings.b2_angularSleepTolerance=2/180*b2.b2Settings.b2_pi,b2.b2Proxy=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Proxy.prototype.__constructor=function(){},b2.b2Proxy.prototype.__varz=function(){this.lowerBounds=new Array(2),this.upperBounds=new Array(2),this.pairs=new Object},b2.b2Proxy.prototype.IsValid=function(){return this.overlapCount!=b2.b2BroadPhase.b2_invalid},b2.b2Proxy.prototype.lowerBounds=new Array(2),b2.b2Proxy.prototype.upperBounds=new Array(2),b2.b2Proxy.prototype.overlapCount=0,b2.b2Proxy.prototype.timeStamp=0,b2.b2Proxy.prototype.pairs=new Object,b2.b2Proxy.prototype.next=null,b2.b2Proxy.prototype.userData=null,b2.b2Point=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Point.prototype.__constructor=function(){},b2.b2Point.prototype.__varz=function(){this.p=new b2.b2Vec2},b2.b2Point.prototype.Support=function(a,b,c){return this.p},b2.b2Point.prototype.GetFirstVertex=function(a){return this.p},b2.b2Point.prototype.p=new b2.b2Vec2,b2.b2WorldManifold=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2WorldManifold.prototype.__constructor=function(){this.m_points=new Array(b2.b2Settings.b2_maxManifoldPoints);for(var a=0;a<b2.b2Settings.b2_maxManifoldPoints;a++)this.m_points[a]=new b2.b2Vec2},b2.b2WorldManifold.prototype.__varz=function(){this.m_normal=new b2.b2Vec2},b2.b2WorldManifold.prototype.Initialize=function(a,b,c,d,e){if(0!=a.m_pointCount){var f,g,h,i,j,k,l,m,n=0;switch(a.m_type){case b2.b2Manifold.e_circles:g=b.R,f=a.m_localPoint;var o=b.position.x+g.col1.x*f.x+g.col2.x*f.y,p=b.position.y+g.col1.y*f.x+g.col2.y*f.y;g=d.R,f=a.m_points[0].m_localPoint;var q=d.position.x+g.col1.x*f.x+g.col2.x*f.y,r=d.position.y+g.col1.y*f.x+g.col2.y*f.y,s=q-o,t=r-p,u=s*s+t*t;if(u>Number.MIN_VALUE*Number.MIN_VALUE){var v=Math.sqrt(u);this.m_normal.x=s/v,this.m_normal.y=t/v}else this.m_normal.x=1,this.m_normal.y=0;var w=o+c*this.m_normal.x,x=p+c*this.m_normal.y,y=q-e*this.m_normal.x,z=r-e*this.m_normal.y;this.m_points[0].x=.5*(w+y),this.m_points[0].y=.5*(x+z);break;case b2.b2Manifold.e_faceA:for(g=b.R,f=a.m_localPlaneNormal,h=g.col1.x*f.x+g.col2.x*f.y,i=g.col1.y*f.x+g.col2.y*f.y,g=b.R,f=a.m_localPoint,j=b.position.x+g.col1.x*f.x+g.col2.x*f.y,k=b.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_normal.x=h,this.m_normal.y=i,n=0;n<a.m_pointCount;n++)g=d.R,f=a.m_points[n].m_localPoint,l=d.position.x+g.col1.x*f.x+g.col2.x*f.y,m=d.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_points[n].x=l+.5*(c-(l-j)*h-(m-k)*i-e)*h,this.m_points[n].y=m+.5*(c-(l-j)*h-(m-k)*i-e)*i;break;case b2.b2Manifold.e_faceB:for(g=d.R,f=a.m_localPlaneNormal,h=g.col1.x*f.x+g.col2.x*f.y,i=g.col1.y*f.x+g.col2.y*f.y,g=d.R,f=a.m_localPoint,j=d.position.x+g.col1.x*f.x+g.col2.x*f.y,k=d.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_normal.x=-h,this.m_normal.y=-i,n=0;n<a.m_pointCount;n++)g=b.R,f=a.m_points[n].m_localPoint,l=b.position.x+g.col1.x*f.x+g.col2.x*f.y,m=b.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_points[n].x=l+.5*(e-(l-j)*h-(m-k)*i-c)*h,this.m_points[n].y=m+.5*(e-(l-j)*h-(m-k)*i-c)*i}}},b2.b2WorldManifold.prototype.m_normal=new b2.b2Vec2,b2.b2WorldManifold.prototype.m_points=null,b2.b2RayCastOutput=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2RayCastOutput.prototype.__constructor=function(){},b2.b2RayCastOutput.prototype.__varz=function(){this.normal=new b2.b2Vec2},b2.b2RayCastOutput.prototype.normal=new b2.b2Vec2,b2.b2RayCastOutput.prototype.fraction=null,b2.b2ConstantForceController=function(){b2.b2Controller.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2ConstantForceController.prototype,b2.b2Controller.prototype),b2.b2ConstantForceController.prototype._super=b2.b2Controller.prototype,b2.b2ConstantForceController.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2ConstantForceController.prototype.__varz=function(){this.F=new b2.b2Vec2(0,0)},b2.b2ConstantForceController.prototype.Step=function(a){for(var b=m_bodyList;b;b=b.nextBody){var c=b.body;c.IsAwake()&&c.ApplyForce(this.F,c.GetWorldCenter())}},b2.b2ConstantForceController.prototype.F=new b2.b2Vec2(0,0),b2.b2MassData=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2MassData.prototype.__constructor=function(){},b2.b2MassData.prototype.__varz=function(){this.center=new b2.b2Vec2(0,0)},b2.b2MassData.prototype.mass=0,b2.b2MassData.prototype.center=new b2.b2Vec2(0,0),b2.b2MassData.prototype.I=0,b2.b2DynamicTree=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DynamicTree.prototype.__constructor=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},b2.b2DynamicTree.prototype.__varz=function(){},b2.b2DynamicTree.prototype.AllocateNode=function(){if(this.m_freeList){var a=this.m_freeList;return this.m_freeList=a.parent,a.parent=null,a.child1=null,a.child2=null,a}return new b2.b2DynamicTreeNode},b2.b2DynamicTree.prototype.FreeNode=function(a){a.parent=this.m_freeList,this.m_freeList=a},b2.b2DynamicTree.prototype.InsertLeaf=function(a){if(++this.m_insertionCount,null==this.m_root)return this.m_root=a,void(this.m_root.parent=null);var b,c,d,e,f,g,h=a.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do b=i.child1,c=i.child2,d=Math.abs((b.aabb.lowerBound.x+b.aabb.upperBound.x)/2-h.x)+Math.abs((b.aabb.lowerBound.y+b.aabb.upperBound.y)/2-h.y),e=Math.abs((c.aabb.lowerBound.x+c.aabb.upperBound.x)/2-h.x)+Math.abs((c.aabb.lowerBound.y+c.aabb.upperBound.y)/2-h.y),i=e>d?b:c;while(0==i.IsLeaf());if(f=i.parent,g=this.AllocateNode(),g.parent=f,g.userData=null,g.aabb.Combine(a.aabb,i.aabb),f){i.parent.child1==i?f.child1=g:f.child2=g,g.child1=i,g.child2=a,i.parent=g,a.parent=g;do{if(f.aabb.Contains(g.aabb))break;f.aabb.Combine(f.child1.aabb,f.child2.aabb),g=f,f=f.parent}while(f)}else g.child1=i,g.child2=a,i.parent=g,a.parent=g,this.m_root=g},b2.b2DynamicTree.prototype.RemoveLeaf=function(a){if(a==this.m_root)return void(this.m_root=null);var b,c,d=a.parent,e=d.parent;if(b=d.child1==a?d.child2:d.child1,e)for(e.child1==d?e.child1=b:e.child2=b,b.parent=e,this.FreeNode(d);e&&(c=e.aabb,e.aabb=b2.b2AABB.Combine(e.child1.aabb,e.child2.aabb),!c.Contains(e.aabb));)e=e.parent;else this.m_root=b,b.parent=null,this.FreeNode(d)},b2.b2DynamicTree.prototype.CreateProxy=function(a,b){var c=this.AllocateNode(),d=b2.b2Settings.b2_aabbExtension,e=b2.b2Settings.b2_aabbExtension;return c.aabb.lowerBound.x=a.lowerBound.x-d,c.aabb.lowerBound.y=a.lowerBound.y-e,c.aabb.upperBound.x=a.upperBound.x+d,c.aabb.upperBound.y=a.upperBound.y+e,c.userData=b,this.InsertLeaf(c),c},b2.b2DynamicTree.prototype.DestroyProxy=function(a){this.RemoveLeaf(a),this.FreeNode(a)},b2.b2DynamicTree.prototype.MoveProxy=function(a,b,c){if(b2.b2Settings.b2Assert(a.IsLeaf()),a.aabb.Contains(b))return!1;this.RemoveLeaf(a);var d=b2.b2Settings.b2_aabbExtension+b2.b2Settings.b2_aabbMultiplier*(c.x>0?c.x:-c.x),e=b2.b2Settings.b2_aabbExtension+b2.b2Settings.b2_aabbMultiplier*(c.y>0?c.y:-c.y);return a.aabb.lowerBound.x=b.lowerBound.x-d,a.aabb.lowerBound.y=b.lowerBound.y-e,a.aabb.upperBound.x=b.upperBound.x+d,a.aabb.upperBound.y=b.upperBound.y+e,this.InsertLeaf(a),!0},b2.b2DynamicTree.prototype.Rebalance=function(a){if(null!=this.m_root)for(var b=0;a>b;b++){for(var c=this.m_root,d=0;0==c.IsLeaf();)c=this.m_path>>d&1?c.child2:c.child1,d=d+1&31;++this.m_path,this.RemoveLeaf(c),this.InsertLeaf(c)}},b2.b2DynamicTree.prototype.GetFatAABB=function(a){return a.aabb},b2.b2DynamicTree.prototype.GetUserData=function(a){return a.userData},b2.b2DynamicTree.prototype.Query=function(a,b){if(null!=this.m_root){var c=[],d=0;for(c[d++]=this.m_root;d>0;){var e=c[--d];if(e.aabb.TestOverlap(b))if(e.IsLeaf()){var f=a(e);if(!f)return}else c[d++]=e.child1,c[d++]=e.child2}}},b2.b2DynamicTree.prototype.RayCast=function(a,b){if(null!=this.m_root){var c=b.p1,d=b.p2,e=b2.b2Math.SubtractVV(c,d);e.Normalize();var f,g,h=b2.b2Math.CrossFV(1,e),i=b2.b2Math.AbsV(h),j=b.maxFraction,k=new b2.b2AABB;f=c.x+j*(d.x-c.x),g=c.y+j*(d.y-c.y),k.lowerBound.x=Math.min(c.x,f),k.lowerBound.y=Math.min(c.y,g),k.upperBound.x=Math.max(c.x,f),k.upperBound.y=Math.max(c.y,g);var l,m,n,o,p,q=new Array,r=0;for(q[r++]=this.m_root;r>0;)if(l=q[--r],0!=l.aabb.TestOverlap(k)&&(m=l.aabb.GetCenter(),n=l.aabb.GetExtents(),o=Math.abs(h.x*(c.x-m.x)+h.y*(c.y-m.y))-i.x*n.x-i.y*n.y,!(o>0)))if(l.IsLeaf()){if(p=new b2.b2RayCastInput,p.p1=b.p1,p.p2=b.p2,p.maxFraction=b.maxFraction,j=a(p,l),0==j)return;f=c.x+j*(d.x-c.x),g=c.y+j*(d.y-c.y),k.lowerBound.x=Math.min(c.x,f),k.lowerBound.y=Math.min(c.y,g),k.upperBound.x=Math.max(c.x,f),k.upperBound.y=Math.max(c.y,g)}else q[r++]=l.child1,q[r++]=l.child2}},b2.b2DynamicTree.prototype.m_root=null,b2.b2DynamicTree.prototype.m_freeList=null,b2.b2DynamicTree.prototype.m_path=0,b2.b2DynamicTree.prototype.m_insertionCount=0,b2.b2JointEdge=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2JointEdge.prototype.__constructor=function(){},b2.b2JointEdge.prototype.__varz=function(){},b2.b2JointEdge.prototype.other=null,b2.b2JointEdge.prototype.joint=null,b2.b2JointEdge.prototype.prev=null,b2.b2JointEdge.prototype.next=null,b2.b2RayCastInput=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2RayCastInput.prototype.__constructor=function(a,b,c){a&&this.p1.SetV(a),b&&this.p2.SetV(b),c&&(this.maxFraction=c)},b2.b2RayCastInput.prototype.__varz=function(){this.p1=new b2.b2Vec2,this.p2=new b2.b2Vec2},b2.b2RayCastInput.prototype.p1=new b2.b2Vec2,b2.b2RayCastInput.prototype.p2=new b2.b2Vec2,b2.b2RayCastInput.prototype.maxFraction=1;var a=function(){this.__varz(),this.__constructor.apply(this,arguments)};a.prototype.__constructor=function(){},a.prototype.__varz=function(){},"__defineSetter__"in Object&&"__defineGetter__"in Object?(a.prototype.__defineGetter__("referenceEdge",function(){return this._referenceEdge}),a.prototype.__defineSetter__("referenceEdge",function(a){this._referenceEdge=a,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}),a.prototype.__defineGetter__("incidentEdge",function(){return this._incidentEdge}),a.prototype.__defineSetter__("incidentEdge",function(a){this._incidentEdge=a,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}),a.prototype.__defineGetter__("incidentVertex",function(){return this._incidentVertex}),a.prototype.__defineSetter__("incidentVertex",function(a){this._incidentVertex=a,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}),a.prototype.__defineGetter__("flip",function(){return this._flip}),a.prototype.__defineSetter__("flip",function(a){this._flip=a,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080})):(Object.defineProperty(a,"referenceEdge",{get:function(){return this._referenceEdge},set:function(a){this._referenceEdge=a,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(a,"incidentEdge",{get:function(){return this._incidentEdge},set:function(a){this._incidentEdge=a,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}}),Object.defineProperty(a,"incidentVertex",{get:function(){
return this._incidentVertex},set:function(a){this._incidentVertex=a,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}}),Object.defineProperty(a,"flip",{get:function(){return this._flip},set:function(a){this._flip=a,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080}})),a.prototype._referenceEdge=0,a.prototype._incidentEdge=0,a.prototype._incidentVertex=0,a.prototype._flip=0,a.prototype._m_id=null,b2.b2FilterData=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2FilterData.prototype.__constructor=function(){},b2.b2FilterData.prototype.__varz=function(){this.categoryBits=1,this.maskBits=65535},b2.b2FilterData.prototype.Copy=function(){var a=new b2.b2FilterData;return a.categoryBits=this.categoryBits,a.maskBits=this.maskBits,a.groupIndex=this.groupIndex,a},b2.b2FilterData.prototype.categoryBits=1,b2.b2FilterData.prototype.maskBits=65535,b2.b2FilterData.prototype.groupIndex=0,b2.b2AABB=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2AABB.prototype.__constructor=function(){},b2.b2AABB.prototype.__varz=function(){this.lowerBound=new b2.b2Vec2,this.upperBound=new b2.b2Vec2,this.centerV2=new b2.b2Vec2,this.extentsV2=new b2.b2Vec2},b2.b2AABB.prototype.Reset=function(){this.lowerBound.SetZero(),this.upperBound.SetZero(),this.centerV2.SetZero(),this.extentsV2.SetZero()},b2.b2AABB.Combine=function(a,b){var c=new b2.b2AABB;return c.Combine(a,b),c},b2.b2AABB.prototype.IsValid=function(){var a=this.upperBound.x-this.lowerBound.x,b=this.upperBound.y-this.lowerBound.y,c=a>=0&&b>=0;return c=c&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},b2.b2AABB.prototype.GetCenter=function(){return this.centerV2.x=.5*(this.lowerBound.x+this.upperBound.x),this.centerV2.y=.5*(this.lowerBound.y+this.upperBound.y),this.centerV2},b2.b2AABB.prototype.GetExtents=function(){return this.extentsV2.x=.5*(this.upperBound.x-this.lowerBound.x),this.extentsV2.y=.5*(this.upperBound.y-this.lowerBound.y),this.extentsV2},b2.b2AABB.prototype.Contains=function(a){var b=this.lowerBound.x<=a.lowerBound.x&&this.lowerBound.y<=a.lowerBound.y&&a.upperBound.x<=this.upperBound.x&&a.upperBound.y<=this.upperBound.y;return b},b2.b2AABB.prototype.RayCast=function(a,b){var c,d,e,f,g,h=-Number.MAX_VALUE,i=Number.MAX_VALUE,j=b.p1.x,k=b.p1.y,l=b.p2.x-b.p1.x,m=b.p2.y-b.p1.y,n=Math.abs(l),o=Math.abs(m),p=a.normal;if(n<Number.MIN_VALUE){if(j<this.lowerBound.x||this.upperBound.x<j)return!1}else if(c=1/l,d=(this.lowerBound.x-j)*c,e=(this.upperBound.x-j)*c,g=-1,d>e&&(f=d,d=e,e=f,g=1),d>h&&(p.x=g,p.y=0,h=d),i=Math.min(i,e),h>i)return!1;if(o<Number.MIN_VALUE){if(k<this.lowerBound.y||this.upperBound.y<k)return!1}else if(c=1/m,d=(this.lowerBound.y-k)*c,e=(this.upperBound.y-k)*c,g=-1,d>e&&(f=d,d=e,e=f,g=1),d>h&&(p.y=g,p.x=0,h=d),i=Math.min(i,e),h>i)return!1;return a.fraction=h,!0},b2.b2AABB.prototype.TestOverlap=function(a){var b=a.lowerBound.x-this.upperBound.x,c=a.lowerBound.y-this.upperBound.y,d=this.lowerBound.x-a.upperBound.x,e=this.lowerBound.y-a.upperBound.y;return b>0||c>0?!1:d>0||e>0?!1:!0},b2.b2AABB.prototype.Combine=function(a,b){this.lowerBound.x=Math.min(a.lowerBound.x,b.lowerBound.x),this.lowerBound.y=Math.min(a.lowerBound.y,b.lowerBound.y),this.upperBound.x=Math.max(a.upperBound.x,b.upperBound.x),this.upperBound.y=Math.max(a.upperBound.y,b.upperBound.y)},b2.b2AABB.prototype.lowerBound=new b2.b2Vec2,b2.b2AABB.prototype.upperBound=new b2.b2Vec2,b2.b2Jacobian=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Jacobian.prototype.__constructor=function(){},b2.b2Jacobian.prototype.__varz=function(){this.linearA=new b2.b2Vec2,this.linearB=new b2.b2Vec2},b2.b2Jacobian.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},b2.b2Jacobian.prototype.Set=function(a,b,c,d){this.linearA.SetV(a),this.angularA=b,this.linearB.SetV(c),this.angularB=d},b2.b2Jacobian.prototype.Compute=function(a,b,c,d){return this.linearA.x*a.x+this.linearA.y*a.y+this.angularA*b+(this.linearB.x*c.x+this.linearB.y*c.y)+this.angularB*d},b2.b2Jacobian.prototype.linearA=new b2.b2Vec2,b2.b2Jacobian.prototype.angularA=null,b2.b2Jacobian.prototype.linearB=new b2.b2Vec2,b2.b2Jacobian.prototype.angularB=null,b2.b2Bound=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Bound.prototype.__constructor=function(){},b2.b2Bound.prototype.__varz=function(){},b2.b2Bound.prototype.IsLower=function(){return 0==(1&this.value)},b2.b2Bound.prototype.IsUpper=function(){return 1==(1&this.value)},b2.b2Bound.prototype.Swap=function(a){var b=this.value,c=this.proxy,d=this.stabbingCount;this.value=a.value,this.proxy=a.proxy,this.stabbingCount=a.stabbingCount,a.value=b,a.proxy=c,a.stabbingCount=d},b2.b2Bound.prototype.value=0,b2.b2Bound.prototype.proxy=null,b2.b2Bound.prototype.stabbingCount=0,b2.b2SimplexVertex=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2SimplexVertex.prototype.__constructor=function(){},b2.b2SimplexVertex.prototype.__varz=function(){},b2.b2SimplexVertex.prototype.Set=function(a){this.wA.SetV(a.wA),this.wB.SetV(a.wB),this.w.SetV(a.w),this.a=a.a,this.indexA=a.indexA,this.indexB=a.indexB},b2.b2SimplexVertex.prototype.wA=null,b2.b2SimplexVertex.prototype.wB=null,b2.b2SimplexVertex.prototype.w=null,b2.b2SimplexVertex.prototype.a=null,b2.b2SimplexVertex.prototype.indexA=0,b2.b2SimplexVertex.prototype.indexB=0,b2.b2Mat22=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Mat22.prototype.__constructor=function(){this.col1.x=this.col2.y=1},b2.b2Mat22.prototype.__varz=function(){this.col1=new b2.b2Vec2,this.col2=new b2.b2Vec2},b2.b2Mat22.FromAngle=function(a){var b=new b2.b2Mat22;return b.Set(a),b},b2.b2Mat22.FromVV=function(a,b){var c=new b2.b2Mat22;return c.SetVV(a,b),c},b2.b2Mat22.prototype.Set=function(a){var b=Math.cos(a),c=Math.sin(a);this.col1.x=b,this.col2.x=-c,this.col1.y=c,this.col2.y=b},b2.b2Mat22.prototype.SetVV=function(a,b){this.col1.SetV(a),this.col2.SetV(b)},b2.b2Mat22.prototype.Copy=function(){var a=new b2.b2Mat22;return a.SetM(this),a},b2.b2Mat22.prototype.SetM=function(a){this.col1.SetV(a.col1),this.col2.SetV(a.col2)},b2.b2Mat22.prototype.AddM=function(a){this.col1.x+=a.col1.x,this.col1.y+=a.col1.y,this.col2.x+=a.col2.x,this.col2.y+=a.col2.y},b2.b2Mat22.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},b2.b2Mat22.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},b2.b2Mat22.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},b2.b2Mat22.prototype.GetInverse=function(a){var b=this.col1.x,c=this.col2.x,d=this.col1.y,e=this.col2.y,f=b*e-c*d;return 0!=f&&(f=1/f),a.col1.x=f*e,a.col2.x=-f*c,a.col1.y=-f*d,a.col2.y=f*b,a},b2.b2Mat22.prototype.Solve=function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,h=d*g-e*f;return 0!=h&&(h=1/h),a.x=h*(g*b-e*c),a.y=h*(d*c-f*b),a},b2.b2Mat22.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},b2.b2Mat22.prototype.col1=new b2.b2Vec2,b2.b2Mat22.prototype.col2=new b2.b2Vec2,b2.b2SimplexCache=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2SimplexCache.prototype.__constructor=function(){},b2.b2SimplexCache.prototype.__varz=function(){this.indexA=new Array(3),this.indexB=new Array(3)},b2.b2SimplexCache.prototype.metric=null,b2.b2SimplexCache.prototype.count=0,b2.b2SimplexCache.prototype.indexA=new Array(3),b2.b2SimplexCache.prototype.indexB=new Array(3),b2.b2Shape=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Shape.prototype.__constructor=function(){this.m_type=b2.b2Shape.e_unknownShape,this.m_radius=b2.b2Settings.b2_linearSlop},b2.b2Shape.prototype.__varz=function(){},b2.b2Shape.TestOverlap=function(a,b,c,d){var e=new b2.b2DistanceInput;e.proxyA=new b2.b2DistanceProxy,e.proxyA.Set(a),e.proxyB=new b2.b2DistanceProxy,e.proxyB.Set(c),e.transformA=b,e.transformB=d,e.useRadii=!0;var f=new b2.b2SimplexCache;f.count=0;var g=new b2.b2DistanceOutput;return b2.b2Distance.Distance(g,f,e),g.distance<10*Number.MIN_VALUE},b2.b2Shape.e_hitCollide=1,b2.b2Shape.e_missCollide=0,b2.b2Shape.e_startsInsideCollide=-1,b2.b2Shape.e_unknownShape=-1,b2.b2Shape.e_circleShape=0,b2.b2Shape.e_polygonShape=1,b2.b2Shape.e_edgeShape=2,b2.b2Shape.e_shapeTypeCount=3,b2.b2Shape.prototype.Copy=function(){return null},b2.b2Shape.prototype.Set=function(a){this.m_radius=a.m_radius},b2.b2Shape.prototype.GetType=function(){return this.m_type},b2.b2Shape.prototype.TestPoint=function(a,b){return!1},b2.b2Shape.prototype.RayCast=function(a,b,c){return!1},b2.b2Shape.prototype.ComputeAABB=function(a,b){},b2.b2Shape.prototype.ComputeMass=function(a,b){},b2.b2Shape.prototype.ComputeSubmergedArea=function(a,b,c,d){return 0},b2.b2Shape.prototype.m_type=0,b2.b2Shape.prototype.m_radius=null,b2.b2Segment=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Segment.prototype.__constructor=function(){},b2.b2Segment.prototype.__varz=function(){this.p1=new b2.b2Vec2,this.p2=new b2.b2Vec2},b2.b2Segment.prototype.TestSegment=function(a,b,c,d){var e=c.p1,f=c.p2.x-e.x,g=c.p2.y-e.y,h=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,j=i,k=-h,l=100*Number.MIN_VALUE,m=-(f*j+g*k);if(m>l){var n=e.x-this.p1.x,o=e.y-this.p1.y,p=n*j+o*k;if(p>=0&&d*m>=p){var q=-f*o+g*n;if(q>=-l*m&&m*(1+l)>=q){p/=m;var r=Math.sqrt(j*j+k*k);return j/=r,k/=r,a[0]=p,b.Set(j,k),!0}}}return!1},b2.b2Segment.prototype.Extend=function(a){this.ExtendForward(a),this.ExtendBackward(a)},b2.b2Segment.prototype.ExtendForward=function(a){var b=this.p2.x-this.p1.x,c=this.p2.y-this.p1.y,d=Math.min(b>0?(a.upperBound.x-this.p1.x)/b:0>b?(a.lowerBound.x-this.p1.x)/b:Number.POSITIVE_INFINITY,c>0?(a.upperBound.y-this.p1.y)/c:0>c?(a.lowerBound.y-this.p1.y)/c:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+b*d,this.p2.y=this.p1.y+c*d},b2.b2Segment.prototype.ExtendBackward=function(a){var b=-this.p2.x+this.p1.x,c=-this.p2.y+this.p1.y,d=Math.min(b>0?(a.upperBound.x-this.p2.x)/b:0>b?(a.lowerBound.x-this.p2.x)/b:Number.POSITIVE_INFINITY,c>0?(a.upperBound.y-this.p2.y)/c:0>c?(a.lowerBound.y-this.p2.y)/c:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+b*d,this.p1.y=this.p2.y+c*d},b2.b2Segment.prototype.p1=new b2.b2Vec2,b2.b2Segment.prototype.p2=new b2.b2Vec2,b2.b2ContactRegister=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactRegister.prototype.__constructor=function(){},b2.b2ContactRegister.prototype.__varz=function(){},b2.b2ContactRegister.prototype.createFcn=null,b2.b2ContactRegister.prototype.destroyFcn=null,b2.b2ContactRegister.prototype.primary=null,b2.b2ContactRegister.prototype.pool=null,b2.b2ContactRegister.prototype.poolCount=0,b2.b2DebugDraw=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DebugDraw.prototype.__constructor=function(){this.m_drawFlags=0},b2.b2DebugDraw.prototype.__varz=function(){},b2.b2DebugDraw.e_shapeBit=1,b2.b2DebugDraw.e_jointBit=2,b2.b2DebugDraw.e_aabbBit=4,b2.b2DebugDraw.e_pairBit=8,b2.b2DebugDraw.e_centerOfMassBit=16,b2.b2DebugDraw.e_controllerBit=32,b2.b2DebugDraw.prototype.SetFlags=function(a){this.m_drawFlags=a},b2.b2DebugDraw.prototype.GetFlags=function(){return this.m_drawFlags},b2.b2DebugDraw.prototype.AppendFlags=function(a){this.m_drawFlags|=a},b2.b2DebugDraw.prototype.ClearFlags=function(a){this.m_drawFlags&=~a},b2.b2DebugDraw.prototype.SetSprite=function(a){this.m_sprite=a},b2.b2DebugDraw.prototype.GetSprite=function(){return this.m_sprite},b2.b2DebugDraw.prototype.SetDrawScale=function(a){this.m_drawScale=a},b2.b2DebugDraw.prototype.GetDrawScale=function(){return this.m_drawScale},b2.b2DebugDraw.prototype.SetLineThickness=function(a){this.m_lineThickness=a},b2.b2DebugDraw.prototype.GetLineThickness=function(){return this.m_lineThickness},b2.b2DebugDraw.prototype.SetAlpha=function(a){this.m_alpha=a},b2.b2DebugDraw.prototype.GetAlpha=function(){return this.m_alpha},b2.b2DebugDraw.prototype.SetFillAlpha=function(a){this.m_fillAlpha=a},b2.b2DebugDraw.prototype.GetFillAlpha=function(){return this.m_fillAlpha},b2.b2DebugDraw.prototype.SetXFormScale=function(a){this.m_xformScale=a},b2.b2DebugDraw.prototype.GetXFormScale=function(){return this.m_xformScale},b2.b2DebugDraw.prototype.Clear=function(){var a=this.m_sprite;a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,this.m_sprite.canvas.width,this.m_sprite.canvas.height),a.restore()},b2.b2DebugDraw.prototype.Y=function(a){return a},b2.b2DebugDraw.prototype.ToWorldPoint=function(a){return new b2.b2Vec2(a.x/this.m_drawScale,this.Y(a.y)/this.m_drawScale)},b2.b2DebugDraw.prototype.ColorStyle=function(a,b){return"rgba("+a.r+", "+a.g+", "+a.b+", "+b+")"},b2.b2DebugDraw.prototype.DrawPolygon=function(a,b,c){this.m_sprite.graphics.lineStyle(this.m_lineThickness,c.color,this.m_alpha),this.m_sprite.graphics.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);for(var d=1;b>d;d++)this.m_sprite.graphics.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale);this.m_sprite.graphics.lineTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale)},b2.b2DebugDraw.prototype.DrawSolidPolygon=function(a,b,c){this.m_sprite.strokeStyle=this.ColorStyle(c,this.m_alpha),this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.fillStyle=this.ColorStyle(c,this.m_fillAlpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a[0].x*this.m_drawScale,this.Y(a[0].y*this.m_drawScale));for(var d=1;b>d;d++)this.m_sprite.lineTo(a[d].x*this.m_drawScale,this.Y(a[d].y*this.m_drawScale));this.m_sprite.lineTo(a[0].x*this.m_drawScale,this.Y(a[0].y*this.m_drawScale)),this.m_sprite.fill(),this.m_sprite.stroke(),this.m_sprite.closePath()},b2.b2DebugDraw.prototype.DrawCircle=function(a,b,c){this.m_sprite.graphics.lineStyle(this.m_lineThickness,c.color,this.m_alpha),this.m_sprite.graphics.drawCircle(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale)},b2.b2DebugDraw.prototype.DrawSolidCircle=function(a,b,c,d){this.m_sprite.strokeSyle=this.ColorStyle(d,this.m_alpha),this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.fillStyle=this.ColorStyle(d,this.m_fillAlpha),this.m_sprite.beginPath(),this.m_sprite.arc(a.x*this.m_drawScale,this.Y(a.y*this.m_drawScale),b*this.m_drawScale,0,2*Math.PI,!0),this.m_sprite.fill(),this.m_sprite.stroke(),this.m_sprite.closePath()},b2.b2DebugDraw.prototype.DrawSegment=function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.strokeSyle=this.ColorStyle(c,this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.x*this.m_drawScale,this.Y(a.y*this.m_drawScale)),this.m_sprite.lineTo(b.x*this.m_drawScale,this.Y(b.y*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath()},b2.b2DebugDraw.prototype.DrawTransform=function(a){this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.strokeSyle=this.ColorStyle(new b2.b2Color(255,0,0),this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.position.x*this.m_drawScale,this.Y(a.position.y*this.m_drawScale)),this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*this.m_drawScale,this.Y((a.position.y+this.m_xformScale*a.R.col1.y)*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath(),this.m_sprite.strokeSyle=this.ColorStyle(new b2.b2Color(0,255,0),this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.position.x*this.m_drawScale,this.Y(a.position.y*this.m_drawScale)),this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*this.m_drawScale,this.Y((a.position.y+this.m_xformScale*a.R.col2.y)*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath()},b2.b2DebugDraw.prototype.m_drawFlags=0,b2.b2DebugDraw.prototype.m_sprite=null,b2.b2DebugDraw.prototype.m_drawScale=1,b2.b2DebugDraw.prototype.m_lineThickness=1,b2.b2DebugDraw.prototype.m_alpha=1,b2.b2DebugDraw.prototype.m_fillAlpha=1,b2.b2DebugDraw.prototype.m_xformScale=1,b2.b2Sweep=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Sweep.prototype.__constructor=function(){},b2.b2Sweep.prototype.__varz=function(){this.localCenter=new b2.b2Vec2,this.c0=new b2.b2Vec2,this.c=new b2.b2Vec2},b2.b2Sweep.prototype.Set=function(a){this.localCenter.SetV(a.localCenter),this.c0.SetV(a.c0),this.c.SetV(a.c),this.a0=a.a0,this.a=a.a,this.t0=a.t0},b2.b2Sweep.prototype.Copy=function(){var a=new b2.b2Sweep;return a.localCenter.SetV(this.localCenter),a.c0.SetV(this.c0),a.c.SetV(this.c),a.a0=this.a0,a.a=this.a,a.t0=this.t0,a},b2.b2Sweep.prototype.GetTransform=function(a,b){a.position.x=(1-b)*this.c0.x+b*this.c.x,a.position.y=(1-b)*this.c0.y+b*this.c.y;var c=(1-b)*this.a0+b*this.a;a.R.Set(c);var d=a.R;a.position.x-=d.col1.x*this.localCenter.x+d.col2.x*this.localCenter.y,a.position.y-=d.col1.y*this.localCenter.x+d.col2.y*this.localCenter.y},b2.b2Sweep.prototype.Advance=function(a){if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var b=(a-this.t0)/(1-this.t0);this.c0.x=(1-b)*this.c0.x+b*this.c.x,this.c0.y=(1-b)*this.c0.y+b*this.c.y,this.a0=(1-b)*this.a0+b*this.a,this.t0=a}},b2.b2Sweep.prototype.localCenter=new b2.b2Vec2,b2.b2Sweep.prototype.c0=new b2.b2Vec2,b2.b2Sweep.prototype.c=new b2.b2Vec2,b2.b2Sweep.prototype.a0=null,b2.b2Sweep.prototype.a=null,b2.b2Sweep.prototype.t0=null,b2.b2DistanceOutput=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DistanceOutput.prototype.__constructor=function(){},b2.b2DistanceOutput.prototype.__varz=function(){this.pointA=new b2.b2Vec2,this.pointB=new b2.b2Vec2},b2.b2DistanceOutput.prototype.pointA=new b2.b2Vec2,b2.b2DistanceOutput.prototype.pointB=new b2.b2Vec2,b2.b2DistanceOutput.prototype.distance=null,b2.b2DistanceOutput.prototype.iterations=0,b2.b2Mat33=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Mat33.prototype.__constructor=function(a,b,c){a||b||c?(this.col1.SetV(a),this.col2.SetV(b),this.col3.SetV(c)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},b2.b2Mat33.prototype.__varz=function(){this.col1=new b2.b2Vec3,this.col2=new b2.b2Vec3,this.col3=new b2.b2Vec3},b2.b2Mat33.prototype.SetVVV=function(a,b,c){this.col1.SetV(a),this.col2.SetV(b),this.col3.SetV(c)},b2.b2Mat33.prototype.Copy=function(){return new b2.b2Mat33(this.col1,this.col2,this.col3)},b2.b2Mat33.prototype.SetM=function(a){this.col1.SetV(a.col1),this.col2.SetV(a.col2),this.col3.SetV(a.col3)},b2.b2Mat33.prototype.AddM=function(a){this.col1.x+=a.col1.x,this.col1.y+=a.col1.y,this.col1.z+=a.col1.z,this.col2.x+=a.col2.x,this.col2.y+=a.col2.y,this.col2.z+=a.col2.z,this.col3.x+=a.col3.x,this.col3.y+=a.col3.y,this.col3.z+=a.col3.z},b2.b2Mat33.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},b2.b2Mat33.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},b2.b2Mat33.prototype.Solve22=function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,h=d*g-e*f;return 0!=h&&(h=1/h),a.x=h*(g*b-e*c),a.y=h*(d*c-f*b),a},b2.b2Mat33.prototype.Solve33=function(a,b,c,d){var e=this.col1.x,f=this.col1.y,g=this.col1.z,h=this.col2.x,i=this.col2.y,j=this.col2.z,k=this.col3.x,l=this.col3.y,m=this.col3.z,n=e*(i*m-j*l)+f*(j*k-h*m)+g*(h*l-i*k);return 0!=n&&(n=1/n),a.x=n*(b*(i*m-j*l)+c*(j*k-h*m)+d*(h*l-i*k)),a.y=n*(e*(c*m-d*l)+f*(d*k-b*m)+g*(b*l-c*k)),a.z=n*(e*(i*d-j*c)+f*(j*b-h*d)+g*(h*c-i*b)),a},b2.b2Mat33.prototype.col1=new b2.b2Vec3,b2.b2Mat33.prototype.col2=new b2.b2Vec3,b2.b2Mat33.prototype.col3=new b2.b2Vec3,b2.b2PositionSolverManifold=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2PositionSolverManifold.prototype.__constructor=function(){this.m_normal=new b2.b2Vec2,this.m_separations=new Array(b2.b2Settings.b2_maxManifoldPoints),this.m_points=new Array(b2.b2Settings.b2_maxManifoldPoints);for(var a=0;a<b2.b2Settings.b2_maxManifoldPoints;a++)this.m_points[a]=new b2.b2Vec2},b2.b2PositionSolverManifold.prototype.__varz=function(){},b2.b2PositionSolverManifold.circlePointA=new b2.b2Vec2,b2.b2PositionSolverManifold.circlePointB=new b2.b2Vec2,b2.b2PositionSolverManifold.prototype.Initialize=function(a){b2.b2Settings.b2Assert(a.pointCount>0);var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=0;switch(a.type){case b2.b2Manifold.e_circles:d=a.bodyA.m_xf.R,e=a.localPoint,h=a.bodyA.m_xf.position.x+(d.col1.x*e.x+d.col2.x*e.y),i=a.bodyA.m_xf.position.y+(d.col1.y*e.x+d.col2.y*e.y),d=a.bodyB.m_xf.R,e=a.points[0].localPoint,j=a.bodyB.m_xf.position.x+(d.col1.x*e.x+d.col2.x*e.y),k=a.bodyB.m_xf.position.y+(d.col1.y*e.x+d.col2.y*e.y),l=j-h,m=k-i,n=l*l+m*m,n>Number.MIN_VALUE*Number.MIN_VALUE?(o=Math.sqrt(n),this.m_normal.x=l/o,this.m_normal.y=m/o):(this.m_normal.x=1,this.m_normal.y=0),this.m_points[0].x=.5*(h+j),this.m_points[0].y=.5*(i+k),this.m_separations[0]=l*this.m_normal.x+m*this.m_normal.y-a.radius;break;case b2.b2Manifold.e_faceA:for(d=a.bodyA.m_xf.R,e=a.localPlaneNormal,this.m_normal.x=d.col1.x*e.x+d.col2.x*e.y,this.m_normal.y=d.col1.y*e.x+d.col2.y*e.y,d=a.bodyA.m_xf.R,e=a.localPoint,f=a.bodyA.m_xf.position.x+(d.col1.x*e.x+d.col2.x*e.y),g=a.bodyA.m_xf.position.y+(d.col1.y*e.x+d.col2.y*e.y),d=a.bodyB.m_xf.R,p=0;p<a.pointCount;++p)e=a.points[p].localPoint,b=a.bodyB.m_xf.position.x+(d.col1.x*e.x+d.col2.x*e.y),c=a.bodyB.m_xf.position.y+(d.col1.y*e.x+d.col2.y*e.y),this.m_separations[p]=(b-f)*this.m_normal.x+(c-g)*this.m_normal.y-a.radius,this.m_points[p].x=b,this.m_points[p].y=c;break;case b2.b2Manifold.e_faceB:for(d=a.bodyB.m_xf.R,e=a.localPlaneNormal,this.m_normal.x=d.col1.x*e.x+d.col2.x*e.y,this.m_normal.y=d.col1.y*e.x+d.col2.y*e.y,d=a.bodyB.m_xf.R,e=a.localPoint,f=a.bodyB.m_xf.position.x+(d.col1.x*e.x+d.col2.x*e.y),g=a.bodyB.m_xf.position.y+(d.col1.y*e.x+d.col2.y*e.y),d=a.bodyA.m_xf.R,p=0;p<a.pointCount;++p)e=a.points[p].localPoint,b=a.bodyA.m_xf.position.x+(d.col1.x*e.x+d.col2.x*e.y),c=a.bodyA.m_xf.position.y+(d.col1.y*e.x+d.col2.y*e.y),this.m_separations[p]=(b-f)*this.m_normal.x+(c-g)*this.m_normal.y-a.radius,this.m_points[p].Set(b,c);this.m_normal.x*=-1,this.m_normal.y*=-1}},b2.b2PositionSolverManifold.prototype.m_normal=null,b2.b2PositionSolverManifold.prototype.m_points=null,b2.b2PositionSolverManifold.prototype.m_separations=null,b2.b2OBB=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2OBB.prototype.__constructor=function(){},b2.b2OBB.prototype.__varz=function(){this.R=new b2.b2Mat22,this.center=new b2.b2Vec2,this.extents=new b2.b2Vec2},b2.b2OBB.prototype.R=new b2.b2Mat22,b2.b2OBB.prototype.center=new b2.b2Vec2,b2.b2OBB.prototype.extents=new b2.b2Vec2,b2.b2Pair=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Pair.prototype.__constructor=function(){},b2.b2Pair.prototype.__varz=function(){},b2.b2Pair.b2_nullProxy=b2.b2Settings.USHRT_MAX,b2.b2Pair.e_pairBuffered=1,b2.b2Pair.e_pairRemoved=2,b2.b2Pair.e_pairFinal=4,b2.b2Pair.prototype.SetBuffered=function(){this.status|=b2.b2Pair.e_pairBuffered},b2.b2Pair.prototype.ClearBuffered=function(){this.status&=~b2.b2Pair.e_pairBuffered},b2.b2Pair.prototype.IsBuffered=function(){return(this.status&b2.b2Pair.e_pairBuffered)==b2.b2Pair.e_pairBuffered},b2.b2Pair.prototype.SetRemoved=function(){this.status|=b2.b2Pair.e_pairRemoved},b2.b2Pair.prototype.ClearRemoved=function(){this.status&=~b2.b2Pair.e_pairRemoved},b2.b2Pair.prototype.IsRemoved=function(){return(this.status&b2.b2Pair.e_pairRemoved)==b2.b2Pair.e_pairRemoved},b2.b2Pair.prototype.SetFinal=function(){this.status|=b2.b2Pair.e_pairFinal},b2.b2Pair.prototype.IsFinal=function(){return(this.status&b2.b2Pair.e_pairFinal)==b2.b2Pair.e_pairFinal},b2.b2Pair.prototype.userData=null,b2.b2Pair.prototype.proxy1=null,b2.b2Pair.prototype.proxy2=null,b2.b2Pair.prototype.next=null,b2.b2Pair.prototype.status=0,b2.b2FixtureDef=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2FixtureDef.prototype.__constructor=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},b2.b2FixtureDef.prototype.__varz=function(){this.filter=new b2.b2FilterData},b2.b2FixtureDef.prototype.shape=null,b2.b2FixtureDef.prototype.userData=null,b2.b2FixtureDef.prototype.friction=null,b2.b2FixtureDef.prototype.restitution=null,b2.b2FixtureDef.prototype.density=null,b2.b2FixtureDef.prototype.isSensor=null,b2.b2FixtureDef.prototype.filter=new b2.b2FilterData,b2.b2ContactID=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactID.prototype.__constructor=function(){this.features._m_id=this},b2.b2ContactID.prototype.__varz=function(){this.features=new a},b2.b2ContactID.prototype.Set=function(a){key=a._key},b2.b2ContactID.prototype.Copy=function(){var a=new b2.b2ContactID;return a.key=key,a},"__defineSetter__"in Object&&"__defineGetter__"in Object?(b2.b2ContactID.prototype.__defineSetter__("key",function(){return this._key}),b2.b2ContactID.prototype.__defineSetter__("key",function(a){this._key=a,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255})):Object.defineProperty(b2.b2ContactID,"key",{get:function(){return this._key},set:function(a){this._key=a,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255}}),b2.b2ContactID.prototype._key=0,b2.b2ContactID.prototype.features=new a,b2.b2Transform=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Transform.prototype.__constructor=function(a,b){a&&(this.position.SetV(a),this.R.SetM(b))},b2.b2Transform.prototype.__varz=function(){this.position=new b2.b2Vec2,this.R=new b2.b2Mat22},b2.b2Transform.prototype.Initialize=function(a,b){this.position.SetV(a),this.R.SetM(b)},b2.b2Transform.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},b2.b2Transform.prototype.Set=function(a){this.position.SetV(a.position),this.R.SetM(a.R)},b2.b2Transform.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},b2.b2Transform.prototype.position=new b2.b2Vec2,b2.b2Transform.prototype.R=new b2.b2Mat22,b2.b2EdgeShape=function(){b2.b2Shape.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2EdgeShape.prototype,b2.b2Shape.prototype),b2.b2EdgeShape.prototype._super=b2.b2Shape.prototype,b2.b2EdgeShape.prototype.__constructor=function(a,b){this._super.__constructor.apply(this,[]),this.m_type=b2.b2Shape.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=a,this.m_v2=b,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-b2.b2Settings.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-b2.b2Settings.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-b2.b2Settings.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-b2.b2Settings.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},b2.b2EdgeShape.prototype.__varz=function(){this.s_supportVec=new b2.b2Vec2,this.m_v1=new b2.b2Vec2,this.m_v2=new b2.b2Vec2,this.m_coreV1=new b2.b2Vec2,this.m_coreV2=new b2.b2Vec2,this.m_normal=new b2.b2Vec2,this.m_direction=new b2.b2Vec2,this.m_cornerDir1=new b2.b2Vec2,this.m_cornerDir2=new b2.b2Vec2},b2.b2EdgeShape.prototype.SetPrevEdge=function(a,b,c,d){this.m_prevEdge=a,this.m_coreV1=b,this.m_cornerDir1=c,this.m_cornerConvex1=d},b2.b2EdgeShape.prototype.SetNextEdge=function(a,b,c,d){this.m_nextEdge=a,this.m_coreV2=b,this.m_cornerDir2=c,this.m_cornerConvex2=d},b2.b2EdgeShape.prototype.TestPoint=function(a,b){return!1},b2.b2EdgeShape.prototype.RayCast=function(a,b,c){var d,e=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y;d=c.R;var g,h,i,j,k,l=c.position.x+(d.col1.x*this.m_v1.x+d.col2.x*this.m_v1.y),m=c.position.y+(d.col1.y*this.m_v1.x+d.col2.y*this.m_v1.y),n=c.position.y+(d.col1.y*this.m_v2.x+d.col2.y*this.m_v2.y)-m,o=-(c.position.x+(d.col1.x*this.m_v2.x+d.col2.x*this.m_v2.y)-l),p=100*Number.MIN_VALUE,q=-(e*n+f*o);return q>p&&(g=b.p1.x-l,h=b.p1.y-m,i=g*n+h*o,i>=0&&i<=b.maxFraction*q&&(j=-e*h+f*g,j>=-p*q&&q*(1+p)>=j))?(i/=q,a.fraction=i,k=Math.sqrt(n*n+o*o),a.normal.x=n/k,a.normal.y=o/k,!0):!1},b2.b2EdgeShape.prototype.ComputeAABB=function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_v1.x+c.col2.x*this.m_v1.y),e=b.position.y+(c.col1.y*this.m_v1.x+c.col2.y*this.m_v1.y),f=b.position.x+(c.col1.x*this.m_v2.x+c.col2.x*this.m_v2.y),g=b.position.y+(c.col1.y*this.m_v2.x+c.col2.y*this.m_v2.y);f>d?(a.lowerBound.x=d,a.upperBound.x=f):(a.lowerBound.x=f,a.upperBound.x=d),g>e?(a.lowerBound.y=e,a.upperBound.y=g):(a.lowerBound.y=g,a.upperBound.y=e)},b2.b2EdgeShape.prototype.ComputeMass=function(a,b){a.mass=0,a.center.SetV(this.m_v1),a.I=0},b2.b2EdgeShape.prototype.ComputeSubmergedArea=function(a,b,c,d){var e=new b2.b2Vec2(a.x*b,a.y*b),f=b2.b2Math.MulX(c,this.m_v1),g=b2.b2Math.MulX(c,this.m_v2),h=b2.b2Math.Dot(a,f)-b,i=b2.b2Math.Dot(a,g)-b;if(h>0){if(i>0)return 0;f.x=-i/(h-i)*f.x+h/(h-i)*g.x,f.y=-i/(h-i)*f.y+h/(h-i)*g.y}else i>0&&(g.x=-i/(h-i)*f.x+h/(h-i)*g.x,g.y=-i/(h-i)*f.y+h/(h-i)*g.y);return d.x=(e.x+f.x+g.x)/3,d.y=(e.y+f.y+g.y)/3,.5*((f.x-e.x)*(g.y-e.y)-(f.y-e.y)*(g.x-e.x))},b2.b2EdgeShape.prototype.GetLength=function(){return this.m_length},b2.b2EdgeShape.prototype.GetVertex1=function(){return this.m_v1},b2.b2EdgeShape.prototype.GetVertex2=function(){return this.m_v2},b2.b2EdgeShape.prototype.GetCoreVertex1=function(){return this.m_coreV1},b2.b2EdgeShape.prototype.GetCoreVertex2=function(){return this.m_coreV2},b2.b2EdgeShape.prototype.GetNormalVector=function(){return this.m_normal},b2.b2EdgeShape.prototype.GetDirectionVector=function(){return this.m_direction},b2.b2EdgeShape.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},b2.b2EdgeShape.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},b2.b2EdgeShape.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},b2.b2EdgeShape.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},b2.b2EdgeShape.prototype.GetFirstVertex=function(a){var b=a.R;return new b2.b2Vec2(a.position.x+(b.col1.x*this.m_coreV1.x+b.col2.x*this.m_coreV1.y),a.position.y+(b.col1.y*this.m_coreV1.x+b.col2.y*this.m_coreV1.y))},b2.b2EdgeShape.prototype.GetNextEdge=function(){return this.m_nextEdge},b2.b2EdgeShape.prototype.GetPrevEdge=function(){return this.m_prevEdge},b2.b2EdgeShape.prototype.Support=function(a,b,c){var d=a.R,e=a.position.x+(d.col1.x*this.m_coreV1.x+d.col2.x*this.m_coreV1.y),f=a.position.y+(d.col1.y*this.m_coreV1.x+d.col2.y*this.m_coreV1.y),g=a.position.x+(d.col1.x*this.m_coreV2.x+d.col2.x*this.m_coreV2.y),h=a.position.y+(d.col1.y*this.m_coreV2.x+d.col2.y*this.m_coreV2.y);return e*b+f*c>g*b+h*c?(this.s_supportVec.x=e,this.s_supportVec.y=f):(this.s_supportVec.x=g,this.s_supportVec.y=h),this.s_supportVec},b2.b2EdgeShape.prototype.s_supportVec=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_v1=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_v2=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_coreV1=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_coreV2=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_length=null,b2.b2EdgeShape.prototype.m_normal=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_direction=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_cornerDir1=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_cornerDir2=new b2.b2Vec2,b2.b2EdgeShape.prototype.m_cornerConvex1=null,b2.b2EdgeShape.prototype.m_cornerConvex2=null,b2.b2EdgeShape.prototype.m_nextEdge=null,b2.b2EdgeShape.prototype.m_prevEdge=null,b2.b2BuoyancyController=function(){b2.b2Controller.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2BuoyancyController.prototype,b2.b2Controller.prototype),b2.b2BuoyancyController.prototype._super=b2.b2Controller.prototype,
b2.b2BuoyancyController.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2BuoyancyController.prototype.__varz=function(){this.normal=new b2.b2Vec2(0,-1),this.velocity=new b2.b2Vec2(0,0)},b2.b2BuoyancyController.prototype.Step=function(a){if(m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var b=m_bodyList;b;b=b.nextBody){var c=b.body;if(0!=c.IsAwake()){for(var d=new b2.b2Vec2,e=new b2.b2Vec2,f=0,g=0,h=c.GetFixtureList();h;h=h.GetNext()){var i=new b2.b2Vec2,j=h.GetShape().ComputeSubmergedArea(this.normal,this.offset,c.GetTransform(),i);f+=j,d.x+=j*i.x,d.y+=j*i.y;var k;k=(this.useDensity,1),g+=j*k,e.x+=j*i.x*k,e.y+=j*i.y*k}if(d.x/=f,d.y/=f,e.x/=g,e.y/=g,!(f<Number.MIN_VALUE)){var l=this.gravity.GetNegative();l.Multiply(this.density*f),c.ApplyForce(l,e);var m=c.GetLinearVelocityFromWorldPoint(d);m.Subtract(this.velocity),m.Multiply(-this.linearDrag*f),c.ApplyForce(m,d),c.ApplyTorque(-c.GetInertia()/c.GetMass()*f*c.GetAngularVelocity()*this.angularDrag)}}}}},b2.b2BuoyancyController.prototype.Draw=function(a){var b=1e3,c=new b2.b2Vec2,d=new b2.b2Vec2;c.x=this.normal.x*this.offset+this.normal.y*b,c.y=this.normal.y*this.offset-this.normal.x*b,d.x=this.normal.x*this.offset-this.normal.y*b,d.y=this.normal.y*this.offset+this.normal.x*b;var e=new b2.b2Color(0,0,1);a.DrawSegment(c,d,e)},b2.b2BuoyancyController.prototype.normal=new b2.b2Vec2(0,-1),b2.b2BuoyancyController.prototype.offset=0,b2.b2BuoyancyController.prototype.density=0,b2.b2BuoyancyController.prototype.velocity=new b2.b2Vec2(0,0),b2.b2BuoyancyController.prototype.linearDrag=2,b2.b2BuoyancyController.prototype.angularDrag=1,b2.b2BuoyancyController.prototype.useDensity=!1,b2.b2BuoyancyController.prototype.useWorldGravity=!0,b2.b2BuoyancyController.prototype.gravity=null,b2.b2Body=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Body.prototype.__constructor=function(a,b){this.m_flags=0,a.bullet&&(this.m_flags|=b2.b2Body.e_bulletFlag),a.fixedRotation&&(this.m_flags|=b2.b2Body.e_fixedRotationFlag),a.allowSleep&&(this.m_flags|=b2.b2Body.e_allowSleepFlag),a.awake&&(this.m_flags|=b2.b2Body.e_awakeFlag),a.active&&(this.m_flags|=b2.b2Body.e_activeFlag),this.m_world=b,this.m_xf.position.SetV(a.position),this.m_xf.R.Set(a.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=a.angle;var c=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y,this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(a.linearVelocity),this.m_angularVelocity=a.angularVelocity,this.m_linearDamping=a.linearDamping,this.m_angularDamping=a.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=a.type,this.m_type==b2.b2Body.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=a.inertiaScale,this.m_userData=a.userData,this.m_fixtureList=null,this.m_fixtureCount=0},b2.b2Body.prototype.__varz=function(){this.m_xf=new b2.b2Transform,this.m_sweep=new b2.b2Sweep,this.m_linearVelocity=new b2.b2Vec2,this.m_force=new b2.b2Vec2},b2.b2Body.b2_staticBody=0,b2.b2Body.b2_kinematicBody=1,b2.b2Body.b2_dynamicBody=2,b2.b2Body.s_xf1=new b2.b2Transform,b2.b2Body.e_islandFlag=1,b2.b2Body.e_awakeFlag=2,b2.b2Body.e_allowSleepFlag=4,b2.b2Body.e_bulletFlag=8,b2.b2Body.e_fixedRotationFlag=16,b2.b2Body.e_activeFlag=32,b2.b2Body.prototype.connectEdges=function(a,b,c){var d=Math.atan2(b.GetDirectionVector().y,b.GetDirectionVector().x),e=Math.tan(.5*(d-c)),f=b2.b2Math.MulFV(e,b.GetDirectionVector());f=b2.b2Math.SubtractVV(f,b.GetNormalVector()),f=b2.b2Math.MulFV(b2.b2Settings.b2_toiSlop,f),f=b2.b2Math.AddVV(f,b.GetVertex1());var g=b2.b2Math.AddVV(a.GetDirectionVector(),b.GetDirectionVector());g.Normalize();var h=b2.b2Math.Dot(a.GetDirectionVector(),b.GetNormalVector())>0;return a.SetNextEdge(b,f,g,h),b.SetPrevEdge(a,f,g,h),d},b2.b2Body.prototype.SynchronizeFixtures=function(){var a,b,c,d,e=b2.b2Body.s_xf1;for(e.R.Set(this.m_sweep.a0),a=e.R,b=this.m_sweep.localCenter,e.position.x=this.m_sweep.c0.x-(a.col1.x*b.x+a.col2.x*b.y),e.position.y=this.m_sweep.c0.y-(a.col1.y*b.x+a.col2.y*b.y),d=this.m_world.m_contactManager.m_broadPhase,c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(d,e,this.m_xf)},b2.b2Body.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y),this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)},b2.b2Body.prototype.ShouldCollide=function(a){if(this.m_type!=b2.b2Body.b2_dynamicBody&&a.m_type!=b2.b2Body.b2_dynamicBody)return!1;for(var b=this.m_jointList;b;b=b.next)if(b.other==a&&0==b.joint.m_collideConnected)return!1;return!0},b2.b2Body.prototype.Advance=function(a){this.m_sweep.Advance(a),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},b2.b2Body.prototype.CreateFixture=function(a){if(1==this.m_world.IsLocked())return null;var b=new b2.b2Fixture;if(b.Create(this,this.m_xf,a),this.m_flags&b2.b2Body.e_activeFlag){var c=this.m_world.m_contactManager.m_broadPhase;b.CreateProxy(c,this.m_xf)}return b.m_next=this.m_fixtureList,this.m_fixtureList=b,++this.m_fixtureCount,b.m_body=this,b.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=b2.b2World.e_newFixture,b},b2.b2Body.prototype.CreateFixture2=function(a,b){var c=new b2.b2FixtureDef;return c.shape=a,c.density=b,this.CreateFixture(c)},b2.b2Body.prototype.DestroyFixture=function(a){if(1!=this.m_world.IsLocked()){for(var b=this.m_fixtureList,c=null,d=!1;null!=b;){if(b==a){c?c.m_next=a.m_next:this.m_fixtureList=a.m_next,d=!0;break}c=b,b=b.m_next}for(var e=this.m_contactList;e;){var f=e.contact;e=e.next;var g=f.GetFixtureA(),h=f.GetFixtureB();(a==g||a==h)&&this.m_world.m_contactManager.Destroy(f)}if(this.m_flags&b2.b2Body.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;a.DestroyProxy(i)}a.Destroy(),a.m_body=null,a.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},b2.b2Body.prototype.SetPositionAndAngle=function(a,b){if(1!=this.m_world.IsLocked()){var c,d,e,f;for(this.m_xf.R.Set(b),this.m_xf.position.SetV(a),d=this.m_xf.R,e=this.m_sweep.localCenter,this.m_sweep.c.x=d.col1.x*e.x+d.col2.x*e.y,this.m_sweep.c.y=d.col1.y*e.x+d.col2.y*e.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=b,f=this.m_world.m_contactManager.m_broadPhase,c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(f,this.m_xf,this.m_xf)}},b2.b2Body.prototype.SetTransform=function(a){this.SetPositionAndAngle(a.position,a.GetAngle())},b2.b2Body.prototype.GetTransform=function(){return this.m_xf},b2.b2Body.prototype.GetPosition=function(){return this.m_xf.position},b2.b2Body.prototype.SetPosition=function(a){this.SetPositionAndAngle(a,this.GetAngle())},b2.b2Body.prototype.GetAngle=function(){return this.m_sweep.a},b2.b2Body.prototype.SetAngle=function(a){this.SetPositionAndAngle(this.GetPosition(),a)},b2.b2Body.prototype.GetWorldCenter=function(){return this.m_sweep.c},b2.b2Body.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},b2.b2Body.prototype.SetLinearVelocity=function(a){this.m_type!=b2.b2Body.b2_staticBody&&this.m_linearVelocity.SetV(a)},b2.b2Body.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},b2.b2Body.prototype.SetAngularVelocity=function(a){this.m_type!=b2.b2Body.b2_staticBody&&(this.m_angularVelocity=a)},b2.b2Body.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},b2.b2Body.prototype.GetDefinition=function(){var a=new b2.b2BodyDef;return a.type=this.GetType(),a.allowSleep=(this.m_flags&b2.b2Body.e_allowSleepFlag)==b2.b2Body.e_allowSleepFlag,a.angle=this.GetAngle(),a.angularDamping=this.m_angularDamping,a.angularVelocity=this.m_angularVelocity,a.fixedRotation=(this.m_flags&b2.b2Body.e_fixedRotationFlag)==b2.b2Body.e_fixedRotationFlag,a.bullet=(this.m_flags&b2.b2Body.e_bulletFlag)==b2.b2Body.e_bulletFlag,a.awake=(this.m_flags&b2.b2Body.e_awakeFlag)==b2.b2Body.e_awakeFlag,a.linearDamping=this.m_linearDamping,a.linearVelocity.SetV(this.GetLinearVelocity()),a.position=this.GetPosition(),a.userData=this.GetUserData(),a},b2.b2Body.prototype.ApplyForce=function(a,b){this.m_type==b2.b2Body.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)},b2.b2Body.prototype.ApplyTorque=function(a){this.m_type==b2.b2Body.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=a)},b2.b2Body.prototype.ApplyImpulse=function(a,b){this.m_type==b2.b2Body.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))},b2.b2Body.prototype.Split=function(a){for(var b,c=this.GetLinearVelocity().Copy(),d=this.GetAngularVelocity(),e=this.GetWorldCenter(),f=this,g=this.m_world.CreateBody(this.GetDefinition()),h=f.m_fixtureList;h;)if(a(h)){var i=h.m_next;b?b.m_next=i:f.m_fixtureList=i,f.m_fixtureCount--,h.m_next=g.m_fixtureList,g.m_fixtureList=h,g.m_fixtureCount++,h.m_body=g,h=i}else b=h,h=h.m_next;f.ResetMassData(),g.ResetMassData();var j=f.GetWorldCenter(),k=g.GetWorldCenter(),l=b2.b2Math.AddVV(c,b2.b2Math.CrossFV(d,b2.b2Math.SubtractVV(j,e))),m=b2.b2Math.AddVV(c,b2.b2Math.CrossFV(d,b2.b2Math.SubtractVV(k,e)));return f.SetLinearVelocity(l),g.SetLinearVelocity(m),f.SetAngularVelocity(d),g.SetAngularVelocity(d),f.SynchronizeFixtures(),g.SynchronizeFixtures(),g},b2.b2Body.prototype.Merge=function(a){var b;for(b=a.m_fixtureList;b;){var c=b.m_next;a.m_fixtureCount--,b.m_next=this.m_fixtureList,this.m_fixtureList=b,this.m_fixtureCount++,b.m_body=e,b=c}d.m_fixtureCount=0;var d=this,e=a;d.GetWorldCenter(),e.GetWorldCenter(),d.GetLinearVelocity().Copy(),e.GetLinearVelocity().Copy(),d.GetAngularVelocity(),e.GetAngularVelocity();d.ResetMassData(),this.SynchronizeFixtures()},b2.b2Body.prototype.GetMass=function(){return this.m_mass},b2.b2Body.prototype.GetInertia=function(){return this.m_I},b2.b2Body.prototype.GetMassData=function(a){a.mass=this.m_mass,a.I=this.m_I,a.center.SetV(this.m_sweep.localCenter)},b2.b2Body.prototype.SetMassData=function(a){if(b2.b2Settings.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==b2.b2Body.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=a.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,a.I>0&&0==(this.m_flags&b2.b2Body.e_fixedRotationFlag)&&(this.m_I=a.I-this.m_mass*(a.center.x*a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I);var b=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a.center),this.m_sweep.c0.SetV(b2.b2Math.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-b.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-b.x)}},b2.b2Body.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=b2.b2Body.b2_staticBody&&this.m_type!=b2.b2Body.b2_kinematicBody){for(var a=b2.b2Vec2.Make(0,0),b=this.m_fixtureList;b;b=b.m_next)if(0!=b.m_density){var c=b.GetMassData();this.m_mass+=c.mass,a.x+=c.center.x*c.mass,a.y+=c.center.y*c.mass,this.m_I+=c.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&b2.b2Body.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,b2.b2Settings.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var d=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a),this.m_sweep.c0.SetV(b2.b2Math.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-d.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-d.x)}},b2.b2Body.prototype.GetWorldPoint=function(a){var b=this.m_xf.R,c=new b2.b2Vec2(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);return c.x+=this.m_xf.position.x,c.y+=this.m_xf.position.y,c},b2.b2Body.prototype.GetWorldVector=function(a){return b2.b2Math.MulMV(this.m_xf.R,a)},b2.b2Body.prototype.GetLocalPoint=function(a){return b2.b2Math.MulXT(this.m_xf,a)},b2.b2Body.prototype.GetLocalVector=function(a){return b2.b2Math.MulTMV(this.m_xf.R,a)},b2.b2Body.prototype.GetLinearVelocityFromWorldPoint=function(a){return new b2.b2Vec2(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},b2.b2Body.prototype.GetLinearVelocityFromLocalPoint=function(a){var b=this.m_xf.R,c=new b2.b2Vec2(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);return c.x+=this.m_xf.position.x,c.y+=this.m_xf.position.y,new b2.b2Vec2(this.m_linearVelocity.x-this.m_angularVelocity*(c.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(c.x-this.m_sweep.c.x))},b2.b2Body.prototype.GetLinearDamping=function(){return this.m_linearDamping},b2.b2Body.prototype.SetLinearDamping=function(a){this.m_linearDamping=a},b2.b2Body.prototype.GetAngularDamping=function(){return this.m_angularDamping},b2.b2Body.prototype.SetAngularDamping=function(a){this.m_angularDamping=a},b2.b2Body.prototype.SetType=function(a){if(this.m_type!=a){this.m_type=a,this.ResetMassData(),this.m_type==b2.b2Body.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var b=this.m_contactList;b;b=b.next)b.contact.FlagForFiltering()}},b2.b2Body.prototype.GetType=function(){return this.m_type},b2.b2Body.prototype.SetBullet=function(a){a?this.m_flags|=b2.b2Body.e_bulletFlag:this.m_flags&=~b2.b2Body.e_bulletFlag},b2.b2Body.prototype.IsBullet=function(){return(this.m_flags&b2.b2Body.e_bulletFlag)==b2.b2Body.e_bulletFlag},b2.b2Body.prototype.SetSleepingAllowed=function(a){a?this.m_flags|=b2.b2Body.e_allowSleepFlag:(this.m_flags&=~b2.b2Body.e_allowSleepFlag,this.SetAwake(!0))},b2.b2Body.prototype.SetAwake=function(a){a?(this.m_flags|=b2.b2Body.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~b2.b2Body.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},b2.b2Body.prototype.IsAwake=function(){return(this.m_flags&b2.b2Body.e_awakeFlag)==b2.b2Body.e_awakeFlag},b2.b2Body.prototype.SetFixedRotation=function(a){a?this.m_flags|=b2.b2Body.e_fixedRotationFlag:this.m_flags&=~b2.b2Body.e_fixedRotationFlag,this.ResetMassData()},b2.b2Body.prototype.IsFixedRotation=function(){return(this.m_flags&b2.b2Body.e_fixedRotationFlag)==b2.b2Body.e_fixedRotationFlag},b2.b2Body.prototype.SetActive=function(a){if(a!=this.IsActive()){var b,c;if(a)for(this.m_flags|=b2.b2Body.e_activeFlag,b=this.m_world.m_contactManager.m_broadPhase,c=this.m_fixtureList;c;c=c.m_next)c.CreateProxy(b,this.m_xf);else{for(this.m_flags&=~b2.b2Body.e_activeFlag,b=this.m_world.m_contactManager.m_broadPhase,c=this.m_fixtureList;c;c=c.m_next)c.DestroyProxy(b);for(var d=this.m_contactList;d;){var e=d;d=d.next,this.m_world.m_contactManager.Destroy(e.contact)}this.m_contactList=null}}},b2.b2Body.prototype.IsActive=function(){return(this.m_flags&b2.b2Body.e_activeFlag)==b2.b2Body.e_activeFlag},b2.b2Body.prototype.IsSleepingAllowed=function(){return(this.m_flags&b2.b2Body.e_allowSleepFlag)==b2.b2Body.e_allowSleepFlag},b2.b2Body.prototype.GetFixtureList=function(){return this.m_fixtureList},b2.b2Body.prototype.GetJointList=function(){return this.m_jointList},b2.b2Body.prototype.GetControllerList=function(){return this.m_controllerList},b2.b2Body.prototype.GetContactList=function(){return this.m_contactList},b2.b2Body.prototype.GetNext=function(){return this.m_next},b2.b2Body.prototype.GetUserData=function(){return this.m_userData},b2.b2Body.prototype.SetUserData=function(a){this.m_userData=a},b2.b2Body.prototype.GetWorld=function(){return this.m_world},b2.b2Body.prototype.m_flags=0,b2.b2Body.prototype.m_type=0,b2.b2Body.prototype.m_islandIndex=0,b2.b2Body.prototype.m_xf=new b2.b2Transform,b2.b2Body.prototype.m_sweep=new b2.b2Sweep,b2.b2Body.prototype.m_linearVelocity=new b2.b2Vec2,b2.b2Body.prototype.m_angularVelocity=null,b2.b2Body.prototype.m_force=new b2.b2Vec2,b2.b2Body.prototype.m_torque=null,b2.b2Body.prototype.m_world=null,b2.b2Body.prototype.m_prev=null,b2.b2Body.prototype.m_next=null,b2.b2Body.prototype.m_fixtureList=null,b2.b2Body.prototype.m_fixtureCount=0,b2.b2Body.prototype.m_controllerList=null,b2.b2Body.prototype.m_controllerCount=0,b2.b2Body.prototype.m_jointList=null,b2.b2Body.prototype.m_contactList=null,b2.b2Body.prototype.m_mass=null,b2.b2Body.prototype.m_invMass=null,b2.b2Body.prototype.m_I=null,b2.b2Body.prototype.m_invI=null,b2.b2Body.prototype.m_inertiaScale=null,b2.b2Body.prototype.m_linearDamping=null,b2.b2Body.prototype.m_angularDamping=null,b2.b2Body.prototype.m_sleepTime=null,b2.b2Body.prototype.m_userData=null,b2.b2ContactImpulse=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactImpulse.prototype.__constructor=function(){},b2.b2ContactImpulse.prototype.__varz=function(){this.normalImpulses=new Array(b2.b2Settings.b2_maxManifoldPoints),this.tangentImpulses=new Array(b2.b2Settings.b2_maxManifoldPoints)},b2.b2ContactImpulse.prototype.normalImpulses=new Array(b2.b2Settings.b2_maxManifoldPoints),b2.b2ContactImpulse.prototype.tangentImpulses=new Array(b2.b2Settings.b2_maxManifoldPoints),b2.b2TensorDampingController=function(){b2.b2Controller.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2TensorDampingController.prototype,b2.b2Controller.prototype),b2.b2TensorDampingController.prototype._super=b2.b2Controller.prototype,b2.b2TensorDampingController.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2TensorDampingController.prototype.__varz=function(){this.T=new b2.b2Mat22},b2.b2TensorDampingController.prototype.SetAxisAligned=function(a,b){this.T.col1.x=-a,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-b,a>0||b>0?this.maxTimestep=1/Math.max(a,b):this.maxTimestep=0},b2.b2TensorDampingController.prototype.Step=function(a){var b=a.dt;if(!(b<=Number.MIN_VALUE)){b>this.maxTimestep&&this.maxTimestep>0&&(b=this.maxTimestep);for(var c=m_bodyList;c;c=c.nextBody){var d=c.body;if(d.IsAwake()){var e=d.GetWorldVector(b2.b2Math.MulMV(this.T,d.GetLocalVector(d.GetLinearVelocity())));d.SetLinearVelocity(new b2.b2Vec2(d.GetLinearVelocity().x+e.x*b,d.GetLinearVelocity().y+e.y*b))}}}},b2.b2TensorDampingController.prototype.T=new b2.b2Mat22,b2.b2TensorDampingController.prototype.maxTimestep=0,b2.b2ManifoldPoint=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ManifoldPoint.prototype.__constructor=function(){this.Reset()},b2.b2ManifoldPoint.prototype.__varz=function(){this.m_localPoint=new b2.b2Vec2,this.m_id=new b2.b2ContactID},b2.b2ManifoldPoint.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},b2.b2ManifoldPoint.prototype.Set=function(a){this.m_localPoint.SetV(a.m_localPoint),this.m_normalImpulse=a.m_normalImpulse,this.m_tangentImpulse=a.m_tangentImpulse,this.m_id.Set(a.m_id)},b2.b2ManifoldPoint.prototype.m_localPoint=new b2.b2Vec2,b2.b2ManifoldPoint.prototype.m_normalImpulse=null,b2.b2ManifoldPoint.prototype.m_tangentImpulse=null,b2.b2ManifoldPoint.prototype.m_id=new b2.b2ContactID,b2.b2PolygonShape=function(){b2.b2Shape.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2PolygonShape.prototype,b2.b2Shape.prototype),b2.b2PolygonShape.prototype._super=b2.b2Shape.prototype,b2.b2PolygonShape.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.m_type=b2.b2Shape.e_polygonShape,this.m_centroid=new b2.b2Vec2,this.m_vertices=[],this.m_normals=new Array},b2.b2PolygonShape.prototype.__varz=function(){},b2.b2PolygonShape.AsArray=function(a,b){var c=new b2.b2PolygonShape;return c.SetAsArray(a,b),c},b2.b2PolygonShape.AsVector=function(a,b){var c=new b2.b2PolygonShape;return c.SetAsVector(a,b),c},b2.b2PolygonShape.AsBox=function(a,b){var c=new b2.b2PolygonShape;return c.SetAsBox(a,b),c},b2.b2PolygonShape.AsOrientedBox=function(a,b,c,d){var e=new b2.b2PolygonShape;return e.SetAsOrientedBox(a,b,c,d),e},b2.b2PolygonShape.AsEdge=function(a,b){var c=new b2.b2PolygonShape;return c.SetAsEdge(a,b),c},b2.b2PolygonShape.ComputeCentroid=function(a,b){for(var c=new b2.b2Vec2,d=0,e=0,f=0,g=1/3,h=0;b>h;++h){var i=a[h],j=b>h+1?a[~~(h+1)]:a[0],k=i.x-e,l=i.y-f,m=j.x-e,n=j.y-f,o=k*n-l*m,p=.5*o;d+=p,c.x+=p*g*(e+i.x+j.x),c.y+=p*g*(f+i.y+j.y)}return c.x*=1/d,c.y*=1/d,c},b2.b2PolygonShape.ComputeOBB=function(a,b,c){var d=0,e=new Array(c+1);for(d=0;c>d;++d)e[d]=b[d];e[c]=e[0];var f=Number.MAX_VALUE;for(d=1;c>=d;++d){var g=e[~~(d-1)],h=e[d].x-g.x,i=e[d].y-g.y,j=Math.sqrt(h*h+i*i);h/=j,i/=j;for(var k=-i,l=h,m=Number.MAX_VALUE,n=Number.MAX_VALUE,o=-Number.MAX_VALUE,p=-Number.MAX_VALUE,q=0;c>q;++q){var r=e[q].x-g.x,s=e[q].y-g.y,t=h*r+i*s,u=k*r+l*s;m>t&&(m=t),n>u&&(n=u),t>o&&(o=t),u>p&&(p=u)}var v=(o-m)*(p-n);if(.95*f>v){f=v,a.R.col1.x=h,a.R.col1.y=i,a.R.col2.x=k,a.R.col2.y=l;var w=.5*(m+o),x=.5*(n+p),y=a.R;a.center.x=g.x+(y.col1.x*w+y.col2.x*x),a.center.y=g.y+(y.col1.y*w+y.col2.y*x),a.extents.x=.5*(o-m),a.extents.y=.5*(p-n)}}},b2.b2PolygonShape.s_mat=new b2.b2Mat22,b2.b2PolygonShape.prototype.Validate=function(){return!1},b2.b2PolygonShape.prototype.Reserve=function(a){for(var b=this.m_vertices.length;a>b;b++)this.m_vertices[b]=new b2.b2Vec2,this.m_normals[b]=new b2.b2Vec2},b2.b2PolygonShape.prototype.Copy=function(){var a=new b2.b2PolygonShape;return a.Set(this),a},b2.b2PolygonShape.prototype.Set=function(a){if(this._super.Set.apply(this,[a]),b2.isInstanceOf(a,b2.b2PolygonShape)){var b=a;this.m_centroid.SetV(b.m_centroid),this.m_vertexCount=b.m_vertexCount,this.Reserve(this.m_vertexCount);for(var c=0;c<this.m_vertexCount;c++)this.m_vertices[c].SetV(b.m_vertices[c]),this.m_normals[c].SetV(b.m_normals[c])}},b2.b2PolygonShape.prototype.SetAsArray=function(a,b){for(var c=[],d=0,e=null;d<a.length,e=a[d];d++)c.push(e);this.SetAsVector(c,b)},b2.b2PolygonShape.prototype.SetAsVector=function(a,b){"undefined"==typeof b&&(b=a.length),b2.b2Settings.b2Assert(b>=2),this.m_vertexCount=b,this.Reserve(b);var c=0;for(c=0;c<this.m_vertexCount;c++)this.m_vertices[c].SetV(a[c]);for(c=0;c<this.m_vertexCount;++c){var d=c,e=c+1<this.m_vertexCount?c+1:0,f=b2.b2Math.SubtractVV(this.m_vertices[e],this.m_vertices[d]);b2.b2Settings.b2Assert(f.LengthSquared()>Number.MIN_VALUE),this.m_normals[c].SetV(b2.b2Math.CrossVF(f,1)),this.m_normals[c].Normalize()}this.m_centroid=b2.b2PolygonShape.ComputeCentroid(this.m_vertices,this.m_vertexCount)},b2.b2PolygonShape.prototype.SetAsBox=function(a,b){this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-a,-b),this.m_vertices[1].Set(a,-b),this.m_vertices[2].Set(a,b),this.m_vertices[3].Set(-a,b),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},b2.b2PolygonShape.prototype.SetAsOrientedBox=function(a,b,c,d){this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-a,-b),this.m_vertices[1].Set(a,-b),this.m_vertices[2].Set(a,b),this.m_vertices[3].Set(-a,b),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=c;var e=new b2.b2Transform;e.position=c,e.R.Set(d);for(var f=0;f<this.m_vertexCount;++f)this.m_vertices[f]=b2.b2Math.MulX(e,this.m_vertices[f]),this.m_normals[f]=b2.b2Math.MulMV(e.R,this.m_normals[f])},b2.b2PolygonShape.prototype.SetAsEdge=function(a,b){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(a),this.m_vertices[1].SetV(b),this.m_centroid.x=.5*(a.x+b.x),this.m_centroid.y=.5*(a.y+b.y),this.m_normals[0]=b2.b2Math.CrossVF(b2.b2Math.SubtractVV(b,a),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},b2.b2PolygonShape.prototype.TestPoint=function(a,b){for(var c,d=a.R,e=b.x-a.position.x,f=b.y-a.position.y,g=e*d.col1.x+f*d.col1.y,h=e*d.col2.x+f*d.col2.y,i=0;i<this.m_vertexCount;++i){c=this.m_vertices[i],e=g-c.x,f=h-c.y,c=this.m_normals[i];var j=c.x*e+c.y*f;if(j>0)return!1}return!0},b2.b2PolygonShape.prototype.RayCast=function(a,b,c){var d,e,f,g,h=0,i=b.maxFraction;d=b.p1.x-c.position.x,e=b.p1.y-c.position.y,f=c.R;var j=d*f.col1.x+e*f.col1.y,k=d*f.col2.x+e*f.col2.y;d=b.p2.x-c.position.x,e=b.p2.y-c.position.y,f=c.R;for(var l,m,n=d*f.col1.x+e*f.col1.y,o=d*f.col2.x+e*f.col2.y,p=n-j,q=o-k,r=-1,s=0;s<this.m_vertexCount;++s){if(g=this.m_vertices[s],d=g.x-j,e=g.y-k,g=this.m_normals[s],l=g.x*d+g.y*e,m=g.x*p+g.y*q,0==m){if(0>l)return!1}else 0>m&&h*m>l?(h=l/m,r=s):m>0&&i*m>l&&(i=l/m);if(i<h-Number.MIN_VALUE)return!1}return r>=0?(a.fraction=h,f=c.R,g=this.m_normals[r],a.normal.x=f.col1.x*g.x+f.col2.x*g.y,a.normal.y=f.col1.y*g.x+f.col2.y*g.y,!0):!1},b2.b2PolygonShape.prototype.ComputeAABB=function(a,b){for(var c,d,e=b.R,f=this.m_vertices[0],g=b.position.x+(e.col1.x*f.x+e.col2.x*f.y),h=b.position.y+(e.col1.y*f.x+e.col2.y*f.y),i=g,j=h,k=1;k<this.m_vertexCount;++k)f=this.m_vertices[k],c=b.position.x+(e.col1.x*f.x+e.col2.x*f.y),d=b.position.y+(e.col1.y*f.x+e.col2.y*f.y),g=c>g?g:c,h=d>h?h:d,i=i>c?i:c,j=j>d?j:d;a.lowerBound.x=g-this.m_radius,a.lowerBound.y=h-this.m_radius,a.upperBound.x=i+this.m_radius,a.upperBound.y=j+this.m_radius},b2.b2PolygonShape.prototype.ComputeMass=function(a,b){if(2==this.m_vertexCount)return a.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),a.mass=0,void(a.I=0);for(var c=0,d=0,e=0,f=0,g=0,h=0,i=1/3,j=0;j<this.m_vertexCount;++j){var k=this.m_vertices[j],l=j+1<this.m_vertexCount?this.m_vertices[~~(j+1)]:this.m_vertices[0],m=k.x-g,n=k.y-h,o=l.x-g,p=l.y-h,q=m*p-n*o,r=.5*q;e+=r,c+=r*i*(g+k.x+l.x),d+=r*i*(h+k.y+l.y);var s=g,t=h,u=m,v=n,w=o,x=p,y=i*(.25*(u*u+w*u+w*w)+(s*u+s*w))+.5*s*s,z=i*(.25*(v*v+x*v+x*x)+(t*v+t*x))+.5*t*t;f+=q*(y+z)}a.mass=b*e,c*=1/e,d*=1/e,a.center.Set(c,d),a.I=b*f},b2.b2PolygonShape.prototype.ComputeSubmergedArea=function(a,b,c,d){var e=b2.b2Math.MulTMV(c.R,a),f=b-b2.b2Math.Dot(a,c.position),g=[],h=0,i=-1,j=-1,k=!1,l=0;for(l=0;l<this.m_vertexCount;++l){g[l]=b2.b2Math.Dot(e,this.m_vertices[l])-f;var m=g[l]<-Number.MIN_VALUE;l>0&&(m?k||(i=l-1,h++):k&&(j=l-1,h++)),k=m}switch(h){case 0:if(k){var n=new b2.b2MassData;return this.ComputeMass(n,1),d.SetV(b2.b2Math.MulX(c,n.center)),n.mass}return 0;case 1:-1==i?i=this.m_vertexCount-1:j=this.m_vertexCount-1}var o,p=(i+1)%this.m_vertexCount,q=(j+1)%this.m_vertexCount,r=(0-g[i])/(g[p]-g[i]),s=(0-g[j])/(g[q]-g[j]),t=new b2.b2Vec2(this.m_vertices[i].x*(1-r)+this.m_vertices[p].x*r,this.m_vertices[i].y*(1-r)+this.m_vertices[p].y*r),u=new b2.b2Vec2(this.m_vertices[j].x*(1-s)+this.m_vertices[q].x*s,this.m_vertices[j].y*(1-s)+this.m_vertices[q].y*s),v=0,w=new b2.b2Vec2,x=this.m_vertices[p];for(l=p;l!=q;){l=(l+1)%this.m_vertexCount,o=l==q?u:this.m_vertices[l];var y=.5*((x.x-t.x)*(o.y-t.y)-(x.y-t.y)*(o.x-t.x));v+=y,w.x+=y*(t.x+x.x+o.x)/3,w.y+=y*(t.y+x.y+o.y)/3,x=o}return w.Multiply(1/v),d.SetV(b2.b2Math.MulX(c,w)),v},b2.b2PolygonShape.prototype.GetVertexCount=function(){return this.m_vertexCount},b2.b2PolygonShape.prototype.GetVertices=function(){return this.m_vertices},b2.b2PolygonShape.prototype.GetNormals=function(){return this.m_normals},b2.b2PolygonShape.prototype.GetSupport=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1;d<this.m_vertexCount;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return b},b2.b2PolygonShape.prototype.GetSupportVertex=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1;d<this.m_vertexCount;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return this.m_vertices[b]},b2.b2PolygonShape.prototype.m_centroid=null,b2.b2PolygonShape.prototype.m_vertices=null,b2.b2PolygonShape.prototype.m_normals=null,b2.b2PolygonShape.prototype.m_vertexCount=0,b2.b2Fixture=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Fixture.prototype.__constructor=function(){this.m_aabb=new b2.b2AABB,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},b2.b2Fixture.prototype.__varz=function(){this.m_filter=new b2.b2FilterData,this.m_aabb1=new b2.b2AABB,this.m_aabb2=new b2.b2AABB},b2.b2Fixture.prototype.Create=function(a,b,c){this.m_userData=c.userData,this.m_friction=c.friction,this.m_restitution=c.restitution,this.m_body=a,this.m_next=null,this.m_filter=c.filter.Copy(),this.m_isSensor=c.isSensor,this.m_shape=c.shape.Copy(),this.m_density=c.density,this.m_displacement={x:0,y:0}},b2.b2Fixture.prototype.Destroy=function(){this.m_shape=null},b2.b2Fixture.prototype.CreateProxy=function(a,b){this.m_shape.ComputeAABB(this.m_aabb,b),this.m_proxy=a.CreateProxy(this.m_aabb,this)},b2.b2Fixture.prototype.DestroyProxy=function(a){null!=this.m_proxy&&(a.DestroyProxy(this.m_proxy),this.m_proxy=null)},b2.b2Fixture.prototype.Synchronize=function(a,b,c){this.m_proxy&&(this.m_aabb1.Reset(),this.m_aabb2.Reset(),this.m_shape.ComputeAABB(this.m_aabb1,b),this.m_shape.ComputeAABB(this.m_aabb2,c),this.m_aabb.Combine(this.m_aabb1,this.m_aabb2),this.m_displacement.x=c.position.x-b.position.x,this.m_displacement.y=c.position.y-b.position.y,a.MoveProxy(this.m_proxy,this.m_aabb,this.m_displacement))},b2.b2Fixture.prototype.GetType=function(){return this.m_shape.GetType()},b2.b2Fixture.prototype.GetShape=function(){return this.m_shape},b2.b2Fixture.prototype.SetSensor=function(a){if(this.m_isSensor!=a&&(this.m_isSensor=a,null!=this.m_body))for(var b=this.m_body.GetContactList();b;){var c=b.contact,d=c.GetFixtureA(),e=c.GetFixtureB();(d==this||e==this)&&c.SetSensor(d.IsSensor()||e.IsSensor()),b=b.next}},b2.b2Fixture.prototype.IsSensor=function(){return this.m_isSensor},b2.b2Fixture.prototype.SetFilterData=function(a){if(this.m_filter=a.Copy(),!this.m_body)for(var b=this.m_body.GetContactList();b;){var c=b.contact,d=c.GetFixtureA(),e=c.GetFixtureB();(d==this||e==this)&&c.FlagForFiltering(),b=b.next}},b2.b2Fixture.prototype.GetFilterData=function(){return this.m_filter.Copy()},b2.b2Fixture.prototype.GetBody=function(){return this.m_body},b2.b2Fixture.prototype.GetNext=function(){return this.m_next},b2.b2Fixture.prototype.GetUserData=function(){return this.m_userData},b2.b2Fixture.prototype.SetUserData=function(a){this.m_userData=a},b2.b2Fixture.prototype.TestPoint=function(a){return this.m_shape.TestPoint(this.m_body.GetTransform(),a)},b2.b2Fixture.prototype.RayCast=function(a,b){return this.m_shape.RayCast(a,b,this.m_body.GetTransform())},b2.b2Fixture.prototype.GetMassData=function(a){return null==a&&(a=new b2.b2MassData),this.m_shape.ComputeMass(a,this.m_density),a},b2.b2Fixture.prototype.SetDensity=function(a){this.m_density=a},b2.b2Fixture.prototype.GetDensity=function(){return this.m_density},b2.b2Fixture.prototype.GetFriction=function(){return this.m_friction},b2.b2Fixture.prototype.SetFriction=function(a){this.m_friction=a},b2.b2Fixture.prototype.GetRestitution=function(){return this.m_restitution},b2.b2Fixture.prototype.SetRestitution=function(a){this.m_restitution=a},b2.b2Fixture.prototype.GetAABB=function(){return this.m_aabb},b2.b2Fixture.prototype.m_massData=null,
b2.b2Fixture.prototype.m_aabb=null,b2.b2Fixture.prototype.m_density=null,b2.b2Fixture.prototype.m_next=null,b2.b2Fixture.prototype.m_body=null,b2.b2Fixture.prototype.m_shape=null,b2.b2Fixture.prototype.m_friction=null,b2.b2Fixture.prototype.m_restitution=null,b2.b2Fixture.prototype.m_proxy=null,b2.b2Fixture.prototype.m_filter=new b2.b2FilterData,b2.b2Fixture.prototype.m_isSensor=null,b2.b2Fixture.prototype.m_userData=null,b2.b2DynamicTreeNode=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DynamicTreeNode.prototype.__constructor=function(){},b2.b2DynamicTreeNode.prototype.__varz=function(){this.aabb=new b2.b2AABB},b2.b2DynamicTreeNode.prototype.IsLeaf=function(){return null==this.child1},b2.b2DynamicTreeNode.prototype.userData=null,b2.b2DynamicTreeNode.prototype.aabb=new b2.b2AABB,b2.b2DynamicTreeNode.prototype.parent=null,b2.b2DynamicTreeNode.prototype.child1=null,b2.b2DynamicTreeNode.prototype.child2=null,b2.b2BodyDef=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2BodyDef.prototype.__constructor=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=b2.b2Body.b2_staticBody,this.active=!0,this.inertiaScale=1},b2.b2BodyDef.prototype.__varz=function(){this.position=new b2.b2Vec2,this.linearVelocity=new b2.b2Vec2},b2.b2BodyDef.prototype.type=0,b2.b2BodyDef.prototype.position=new b2.b2Vec2,b2.b2BodyDef.prototype.angle=null,b2.b2BodyDef.prototype.linearVelocity=new b2.b2Vec2,b2.b2BodyDef.prototype.angularVelocity=null,b2.b2BodyDef.prototype.linearDamping=null,b2.b2BodyDef.prototype.angularDamping=null,b2.b2BodyDef.prototype.allowSleep=null,b2.b2BodyDef.prototype.awake=null,b2.b2BodyDef.prototype.fixedRotation=null,b2.b2BodyDef.prototype.bullet=null,b2.b2BodyDef.prototype.active=null,b2.b2BodyDef.prototype.userData=null,b2.b2BodyDef.prototype.inertiaScale=null,b2.b2DynamicTreeBroadPhase=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2DynamicTreeBroadPhase.prototype.__constructor=function(){},b2.b2DynamicTreeBroadPhase.prototype.__varz=function(){this.m_tree=new b2.b2DynamicTree,this.m_moveBuffer=[],this.m_pairBuffer=new Array},b2.b2DynamicTreeBroadPhase.prototype.BufferMove=function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a},b2.b2DynamicTreeBroadPhase.prototype.UnBufferMove=function(a){var b=this.m_moveBuffer.indexOf(a);this.m_moveBuffer.splice(b,1)},b2.b2DynamicTreeBroadPhase.prototype.ComparePairs=function(a,b){return 0},b2.b2DynamicTreeBroadPhase.prototype.CreateProxy=function(a,b){var c=this.m_tree.CreateProxy(a,b);return++this.m_proxyCount,this.BufferMove(c),c},b2.b2DynamicTreeBroadPhase.prototype.DestroyProxy=function(a){this.UnBufferMove(a),--this.m_proxyCount,this.m_tree.DestroyProxy(a)},b2.b2DynamicTreeBroadPhase.prototype.MoveProxy=function(a,b,c){var d=this.m_tree.MoveProxy(a,b,c);d&&this.BufferMove(a)},b2.b2DynamicTreeBroadPhase.prototype.TestOverlap=function(a,b){var c=this.m_tree.GetFatAABB(a),d=this.m_tree.GetFatAABB(b);return c.TestOverlap(d)},b2.b2DynamicTreeBroadPhase.prototype.GetUserData=function(a){return this.m_tree.GetUserData(a)},b2.b2DynamicTreeBroadPhase.prototype.GetFatAABB=function(a){return this.m_tree.GetFatAABB(a)},b2.b2DynamicTreeBroadPhase.prototype.GetProxyCount=function(){return this.m_proxyCount},b2.b2DynamicTreeBroadPhase.prototype.UpdatePairs=function(a){function b(a){return a==i?!0:(j.m_pairCount==j.m_pairBuffer.length&&(j.m_pairBuffer[j.m_pairCount]=new b2.b2DynamicTreePair),c=j.m_pairBuffer[j.m_pairCount],c.proxyA=i>a?a:i,c.proxyB=a>=i?a:i,++j.m_pairCount,!0)}this.m_pairCount=0;for(var c,d,e,f,g,c,h=0,i=null,j=this;h<this.m_moveBuffer.length,i=this.m_moveBuffer[h];h++)d=this.m_tree.GetFatAABB(i),this.m_tree.Query(b,d);for(this.m_moveBuffer.length=0,h=0;h<this.m_pairCount;)for(e=this.m_pairBuffer[h],f=this.m_tree.GetUserData(e.proxyA),g=this.m_tree.GetUserData(e.proxyB),a(f,g),++h;h<this.m_pairCount&&(c=this.m_pairBuffer[h],c.proxyA==e.proxyA&&c.proxyB==e.proxyB);)++h},b2.b2DynamicTreeBroadPhase.prototype.Query=function(a,b){this.m_tree.Query(a,b)},b2.b2DynamicTreeBroadPhase.prototype.RayCast=function(a,b){this.m_tree.RayCast(a,b)},b2.b2DynamicTreeBroadPhase.prototype.Validate=function(){},b2.b2DynamicTreeBroadPhase.prototype.Rebalance=function(a){this.m_tree.Rebalance(a)},b2.b2DynamicTreeBroadPhase.prototype.m_tree=new b2.b2DynamicTree,b2.b2DynamicTreeBroadPhase.prototype.m_proxyCount=0,b2.b2DynamicTreeBroadPhase.prototype.m_moveBuffer=[],b2.b2DynamicTreeBroadPhase.prototype.m_pairBuffer=[],b2.b2DynamicTreeBroadPhase.prototype.m_pairCount=0,b2.b2BroadPhase=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2BroadPhase.prototype.__constructor=function(a){var b=0;for(this.m_pairManager.Initialize(this),this.m_worldAABB=a,this.m_proxyCount=0,this.m_bounds=[],b=0;2>b;b++)this.m_bounds[b]=new Array;var c=a.upperBound.x-a.lowerBound.x,d=a.upperBound.y-a.lowerBound.y;this.m_quantizationFactor.x=b2.b2Settings.USHRT_MAX/c,this.m_quantizationFactor.y=b2.b2Settings.USHRT_MAX/d,this.m_timeStamp=1,this.m_queryResultCount=0},b2.b2BroadPhase.prototype.__varz=function(){this.m_pairManager=new b2.b2PairManager,this.m_proxyPool=[],this.m_querySortKeys=[],this.m_queryResults=[],this.m_quantizationFactor=new b2.b2Vec2},b2.b2BroadPhase.BinarySearch=function(a,b,c){for(var d=0,e=b-1;e>=d;){var f=Math.round((d+e)/2),g=a[f];if(g.value>c)e=f-1;else{if(!(g.value<c))return~~f;d=f+1}}return~~d},b2.b2BroadPhase.s_validate=!1,b2.b2BroadPhase.b2_invalid=b2.b2Settings.USHRT_MAX,b2.b2BroadPhase.b2_nullEdge=b2.b2Settings.USHRT_MAX,b2.b2BroadPhase.prototype.ComputeBounds=function(a,b,c){var d=c.lowerBound.x,e=c.lowerBound.y;d=b2.b2Math.Min(d,this.m_worldAABB.upperBound.x),e=b2.b2Math.Min(e,this.m_worldAABB.upperBound.y),d=b2.b2Math.Max(d,this.m_worldAABB.lowerBound.x),e=b2.b2Math.Max(e,this.m_worldAABB.lowerBound.y);var f=c.upperBound.x,g=c.upperBound.y;f=b2.b2Math.Min(f,this.m_worldAABB.upperBound.x),g=b2.b2Math.Min(g,this.m_worldAABB.upperBound.y),f=b2.b2Math.Max(f,this.m_worldAABB.lowerBound.x),g=b2.b2Math.Max(g,this.m_worldAABB.lowerBound.y),a[0]=~~(this.m_quantizationFactor.x*(d-this.m_worldAABB.lowerBound.x))&b2.b2Settings.USHRT_MAX-1,b[0]=~~(this.m_quantizationFactor.x*(f-this.m_worldAABB.lowerBound.x))%65535|1,a[1]=~~(this.m_quantizationFactor.y*(e-this.m_worldAABB.lowerBound.y))&b2.b2Settings.USHRT_MAX-1,b[1]=~~(this.m_quantizationFactor.y*(g-this.m_worldAABB.lowerBound.y))%65535|1},b2.b2BroadPhase.prototype.TestOverlapValidate=function(a,b){for(var c=0;2>c;++c){var d=this.m_bounds[c],e=d[a.lowerBounds[c]],f=d[b.upperBounds[c]];if(e.value>f.value)return!1;if(e=d[a.upperBounds[c]],f=d[b.lowerBounds[c]],e.value<f.value)return!1}return!0},b2.b2BroadPhase.prototype.QueryAxis=function(a,b,c,d,e,f,g){for(var h,i=b2.b2BroadPhase.BinarySearch(e,f,c),j=b2.b2BroadPhase.BinarySearch(e,f,d),k=i;j>k;++k)h=e[k],h.IsLower()&&this.IncrementOverlapCount(h.proxy);if(i>0){var l=i-1;h=e[l];for(var m=h.stabbingCount;m;){if(h=e[l],h.IsLower()){var n=h.proxy;i<=n.upperBounds[g]&&(this.IncrementOverlapCount(h.proxy),--m)}--l}}a[0]=i,b[0]=j},b2.b2BroadPhase.prototype.IncrementOverlapCount=function(a){a.timeStamp<this.m_timeStamp?(a.timeStamp=this.m_timeStamp,a.overlapCount=1):(a.overlapCount=2,this.m_queryResults[this.m_queryResultCount]=a,++this.m_queryResultCount)},b2.b2BroadPhase.prototype.IncrementTimeStamp=function(){if(this.m_timeStamp==b2.b2Settings.USHRT_MAX){for(var a=0;a<this.m_proxyPool.length;++a)this.m_proxyPool[a].timeStamp=0;this.m_timeStamp=1}else++this.m_timeStamp},b2.b2BroadPhase.prototype.InRange=function(a){var b,c,d,e;return b=a.lowerBound.x,c=a.lowerBound.y,b-=this.m_worldAABB.upperBound.x,c-=this.m_worldAABB.upperBound.y,d=this.m_worldAABB.lowerBound.x,e=this.m_worldAABB.lowerBound.y,d-=a.upperBound.x,e-=a.upperBound.y,b=b2.b2Math.Max(b,d),c=b2.b2Math.Max(c,e),b2.b2Math.Max(b,c)<0},b2.b2BroadPhase.prototype.CreateProxy=function(a,b){var c,d=0,e=0,f=0;if(!this.m_freeProxy)for(this.m_freeProxy=this.m_proxyPool[this.m_proxyCount]=new b2.b2Proxy,this.m_freeProxy.next=null,this.m_freeProxy.timeStamp=0,this.m_freeProxy.overlapCount=b2.b2BroadPhase.b2_invalid,this.m_freeProxy.userData=null,e=0;2>e;e++)f=2*this.m_proxyCount,this.m_bounds[e][f++]=new b2.b2Bound,this.m_bounds[e][f]=new b2.b2Bound;c=this.m_freeProxy,this.m_freeProxy=c.next,c.overlapCount=0,c.userData=b;var g=2*this.m_proxyCount,h=[],i=[];this.ComputeBounds(h,i,a);for(var j=0;2>j;++j){var k=this.m_bounds[j],l=0,m=0,n=[];n.push(l);var o=[];o.push(m),this.QueryAxis(n,o,h[j],i[j],k,g,j),l=n[0],m=o[0],k.splice(m,0,k[k.length-1]),k.length--,k.splice(l,0,k[k.length-1]),k.length--,++m;var p=k[l],q=k[m];p.value=h[j],p.proxy=c,q.value=i[j],q.proxy=c;var r=k[~~(l-1)];for(p.stabbingCount=0==l?0:r.stabbingCount,r=k[~~(m-1)],q.stabbingCount=r.stabbingCount,d=l;m>d;++d)r=k[d],r.stabbingCount++;for(d=l;g+2>d;++d){p=k[d];var s=p.proxy;p.IsLower()?s.lowerBounds[j]=d:s.upperBounds[j]=d}}for(++this.m_proxyCount,e=0;e<this.m_queryResultCount;++e)this.m_pairManager.AddBufferedPair(c,this.m_queryResults[e]);return this.m_queryResultCount=0,this.IncrementTimeStamp(),c},b2.b2BroadPhase.prototype.DestroyProxy=function(a){for(var b,c,d=a,e=2*this.m_proxyCount,f=0;2>f;++f){var g=this.m_bounds[f],h=d.lowerBounds[f],i=d.upperBounds[f];b=g[h];var j=b.value;c=g[i];var k=c.value;g.splice(i,1),g.splice(h,1),g.push(b),g.push(c);for(var l=e-2,m=h;l>m;++m){b=g[m];var n=b.proxy;b.IsLower()?n.lowerBounds[f]=m:n.upperBounds[f]=m}l=i-1;for(var o=h;l>o;++o)b=g[o],b.stabbingCount--;var p=[];this.QueryAxis(p,p,j,k,g,e-2,f)}for(var q=0;q<this.m_queryResultCount;++q)this.m_pairManager.RemoveBufferedPair(d,this.m_queryResults[q]);this.m_queryResultCount=0,this.IncrementTimeStamp(),d.userData=null,d.overlapCount=b2.b2BroadPhase.b2_invalid,d.lowerBounds[0]=b2.b2BroadPhase.b2_invalid,d.lowerBounds[1]=b2.b2BroadPhase.b2_invalid,d.upperBounds[0]=b2.b2BroadPhase.b2_invalid,d.upperBounds[1]=b2.b2BroadPhase.b2_invalid,d.next=this.m_freeProxy,this.m_freeProxy=d,--this.m_proxyCount},b2.b2BroadPhase.prototype.MoveProxy=function(a,b,c){if(null!=a&&0!=b.IsValid()){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=a,r=0,s=0,t=0,u=2*this.m_proxyCount,v=new b2.b2BoundValues,w=new b2.b2BoundValues;for(this.ComputeBounds(v.lowerValues,v.upperValues,b),s=0;2>s;++s)e=this.m_bounds[s][q.lowerBounds[s]],w.lowerValues[s]=e.value,e=this.m_bounds[s][q.upperBounds[s]],w.upperValues[s]=e.value;for(s=0;2>s;++s){if(i=this.m_bounds[s],j=q.lowerBounds[s],k=q.upperBounds[s],l=v.lowerValues[s],m=v.upperValues[s],e=i[j],n=l-e.value,e.value=l,e=i[k],o=m-e.value,e.value=m,0>n)for(t=j;t>0&&l<i[~~(t-1)].value;)e=i[t],f=i[~~(t-1)],p=f.proxy,f.stabbingCount++,1==f.IsUpper()?(this.TestOverlapBound(v,p)&&this.m_pairManager.AddBufferedPair(q,p),d=p.upperBounds,r=d[s],r++,d[s]=r,e.stabbingCount++):(d=p.lowerBounds,r=d[s],r++,d[s]=r,e.stabbingCount--),d=q.lowerBounds,r=d[s],r--,d[s]=r,e.Swap(f),--t;if(o>0)for(t=k;u-1>t&&i[~~(t+1)].value<=m;)e=i[t],g=i[~~(t+1)],h=g.proxy,g.stabbingCount++,1==g.IsLower()?(this.TestOverlapBound(v,h)&&this.m_pairManager.AddBufferedPair(q,h),d=h.lowerBounds,r=d[s],r--,d[s]=r,e.stabbingCount++):(d=h.upperBounds,r=d[s],r--,d[s]=r,e.stabbingCount--),d=q.upperBounds,r=d[s],r++,d[s]=r,e.Swap(g),t++;if(n>0)for(t=j;u-1>t&&i[~~(t+1)].value<=l;)e=i[t],g=i[~~(t+1)],h=g.proxy,g.stabbingCount--,g.IsUpper()?(this.TestOverlapBound(w,h)&&this.m_pairManager.RemoveBufferedPair(q,h),d=h.upperBounds,r=d[s],r--,d[s]=r,e.stabbingCount--):(d=h.lowerBounds,r=d[s],r--,d[s]=r,e.stabbingCount++),d=q.lowerBounds,r=d[s],r++,d[s]=r,e.Swap(g),t++;if(0>o)for(t=k;t>0&&m<i[~~(t-1)].value;)e=i[t],f=i[~~(t-1)],p=f.proxy,f.stabbingCount--,1==f.IsLower()?(this.TestOverlapBound(w,p)&&this.m_pairManager.RemoveBufferedPair(q,p),d=p.lowerBounds,r=d[s],r++,d[s]=r,e.stabbingCount--):(d=p.upperBounds,r=d[s],r++,d[s]=r,e.stabbingCount++),d=q.upperBounds,r=d[s],r--,d[s]=r,e.Swap(f),t--}}},b2.b2BroadPhase.prototype.UpdatePairs=function(a){this.m_pairManager.Commit(a)},b2.b2BroadPhase.prototype.TestOverlap=function(a,b){return a.lowerBounds[0]>b.upperBounds[0]?!1:b.lowerBounds[0]>a.upperBounds[0]?!1:a.lowerBounds[1]>b.upperBounds[1]?!1:b.lowerBounds[1]>a.upperBounds[1]?!1:!0},b2.b2BroadPhase.prototype.GetUserData=function(a){return a.userData},b2.b2BroadPhase.prototype.GetFatAABB=function(a){var b=new b2.b2AABB,c=a;return b.lowerBound.x=this.m_worldAABB.lowerBound.x+this.m_bounds[0][c.lowerBounds[0]].value/this.m_quantizationFactor.x,b.lowerBound.y=this.m_worldAABB.lowerBound.y+this.m_bounds[1][c.lowerBounds[1]].value/this.m_quantizationFactor.y,b.upperBound.x=this.m_worldAABB.lowerBound.x+this.m_bounds[0][c.upperBounds[0]].value/this.m_quantizationFactor.x,b.upperBound.y=this.m_worldAABB.lowerBound.y+this.m_bounds[1][c.upperBounds[1]].value/this.m_quantizationFactor.y,b},b2.b2BroadPhase.prototype.GetProxyCount=function(){return this.m_proxyCount},b2.b2BroadPhase.prototype.Query=function(a,b){var c=[],d=[];this.ComputeBounds(c,d,b);var e=0,f=0,g=[];g.push(e);var h=[];h.push(f),this.QueryAxis(g,h,c[0],d[0],this.m_bounds[0],2*this.m_proxyCount,0),this.QueryAxis(g,h,c[1],d[1],this.m_bounds[1],2*this.m_proxyCount,1);for(var i=0;i<this.m_queryResultCount;++i){var j=this.m_queryResults[i];if(!a(j))break}this.m_queryResultCount=0,this.IncrementTimeStamp()},b2.b2BroadPhase.prototype.Validate=function(){for(var a=0;2>a;++a)for(var b=this.m_bounds[a],c=2*this.m_proxyCount,d=0,e=0;c>e;++e){var f=b[e];1==f.IsLower()?d++:d--}},b2.b2BroadPhase.prototype.Rebalance=function(a){},b2.b2BroadPhase.prototype.RayCast=function(a,b){var c=new b2.b2RayCastInput;c.p1.SetV(b.p1),c.p2.SetV(b.p2),c.maxFraction=b.maxFraction;var d=(b.p2.x-b.p1.x)*this.m_quantizationFactor.x,e=(b.p2.y-b.p1.y)*this.m_quantizationFactor.y,f=d<-Number.MIN_VALUE?-1:d>Number.MIN_VALUE?1:0,g=e<-Number.MIN_VALUE?-1:e>Number.MIN_VALUE?1:0,h=this.m_quantizationFactor.x*(b.p1.x-this.m_worldAABB.lowerBound.x),i=this.m_quantizationFactor.y*(b.p1.y-this.m_worldAABB.lowerBound.y),j=new Array,k=[];j[0]=~~h&b2.b2Settings.USHRT_MAX-1,j[1]=~~i&b2.b2Settings.USHRT_MAX-1,k[0]=j[0]+1,k[1]=j[1]+1;var l,m,n,o=(new Array,0),p=0,q=0,r=0,s=new Array,t=new Array,u=0;for(s.push(q),t.push(r),this.QueryAxis(s,t,j[0],k[0],this.m_bounds[0],2*this.m_proxyCount,0),o=f>=0?t[0]-1:s[0],this.QueryAxis(s,t,j[1],k[1],this.m_bounds[1],2*this.m_proxyCount,1),p=g>=0?t[0]-1:s[0];u<this.m_queryResultCount;u++)c.maxFraction=a(this.m_queryResults[u],c);for(;(m=0,n=0,o+=f>=0?1:-1,!(0>o||o>=2*this.m_proxyCount))&&(0!=f&&(m=(this.m_bounds[0][o].value-h)/d),p+=g>=0?1:-1,!(0>p||p>=2*this.m_proxyCount));){for(0!=g&&(n=(this.m_bounds[1][p].value-i)/e);;)if(0==g||0!=f&&n>m){if(m>c.maxFraction)break;if((f>0?this.m_bounds[0][o].IsLower():this.m_bounds[0][o].IsUpper())&&(l=this.m_bounds[0][o].proxy,g>=0?l.lowerBounds[1]<=p-1&&l.upperBounds[1]>=p&&(c.maxFraction=a(l,c)):l.lowerBounds[1]<=p&&l.upperBounds[1]>=p+1&&(c.maxFraction=a(l,c))),0==c.maxFraction)break;if(f>0){if(o++,o==2*this.m_proxyCount)break}else if(o--,0>o)break;m=(this.m_bounds[0][o].value-h)/d}else{if(n>c.maxFraction)break;if((g>0?this.m_bounds[1][p].IsLower():this.m_bounds[1][p].IsUpper())&&(l=this.m_bounds[1][p].proxy,f>=0?l.lowerBounds[0]<=o-1&&l.upperBounds[0]>=o&&(c.maxFraction=a(l,c)):l.lowerBounds[0]<=o&&l.upperBounds[0]>=o+1&&(c.maxFraction=a(l,c))),0==c.maxFraction)break;if(g>0){if(p++,p==2*this.m_proxyCount)break}else if(p--,0>p)break;n=(this.m_bounds[1][p].value-i)/e}break}this.m_queryResultCount=0,this.IncrementTimeStamp()},b2.b2BroadPhase.prototype.TestOverlapBound=function(a,b){for(var c=0;2>c;++c){var d=this.m_bounds[c],e=d[b.upperBounds[c]];if(a.lowerValues[c]>e.value)return!1;if(e=d[b.lowerBounds[c]],a.upperValues[c]<e.value)return!1}return!0},b2.b2BroadPhase.prototype.m_pairManager=new b2.b2PairManager,b2.b2BroadPhase.prototype.m_proxyPool=[],b2.b2BroadPhase.prototype.m_freeProxy=null,b2.b2BroadPhase.prototype.m_bounds=null,b2.b2BroadPhase.prototype.m_querySortKeys=[],b2.b2BroadPhase.prototype.m_queryResults=[],b2.b2BroadPhase.prototype.m_queryResultCount=0,b2.b2BroadPhase.prototype.m_worldAABB=null,b2.b2BroadPhase.prototype.m_quantizationFactor=new b2.b2Vec2,b2.b2BroadPhase.prototype.m_proxyCount=0,b2.b2BroadPhase.prototype.m_timeStamp=0,b2.b2Manifold=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Manifold.prototype.__constructor=function(){this.m_points=new Array(b2.b2Settings.b2_maxManifoldPoints);for(var a=0;a<b2.b2Settings.b2_maxManifoldPoints;a++)this.m_points[a]=new b2.b2ManifoldPoint;this.m_localPlaneNormal=new b2.b2Vec2,this.m_localPoint=new b2.b2Vec2},b2.b2Manifold.prototype.__varz=function(){},b2.b2Manifold.e_circles=1,b2.b2Manifold.e_faceA=2,b2.b2Manifold.e_faceB=4,b2.b2Manifold.prototype.Reset=function(){for(var a=0;a<b2.b2Settings.b2_maxManifoldPoints;a++)this.m_points[a].Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},b2.b2Manifold.prototype.Set=function(a){this.m_pointCount=a.m_pointCount;for(var b=0;b<b2.b2Settings.b2_maxManifoldPoints;b++)this.m_points[b].Set(a.m_points[b]);this.m_localPlaneNormal.SetV(a.m_localPlaneNormal),this.m_localPoint.SetV(a.m_localPoint),this.m_type=a.m_type},b2.b2Manifold.prototype.Copy=function(){var a=new b2.b2Manifold;return a.Set(this),a},b2.b2Manifold.prototype.m_points=null,b2.b2Manifold.prototype.m_localPlaneNormal=null,b2.b2Manifold.prototype.m_localPoint=null,b2.b2Manifold.prototype.m_type=0,b2.b2Manifold.prototype.m_pointCount=0,b2.b2CircleShape=function(){b2.b2Shape.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2CircleShape.prototype,b2.b2Shape.prototype),b2.b2CircleShape.prototype._super=b2.b2Shape.prototype,b2.b2CircleShape.prototype.__constructor=function(a){this._super.__constructor.apply(this,[]),this.m_type=b2.b2Shape.e_circleShape,this.m_radius=a},b2.b2CircleShape.prototype.__varz=function(){this.m_p=new b2.b2Vec2},b2.b2CircleShape.prototype.Copy=function(){var a=new b2.b2CircleShape;return a.Set(this),a},b2.b2CircleShape.prototype.Set=function(a){if(this._super.Set.apply(this,[a]),b2.isInstanceOf(a,b2.b2CircleShape)){var b=a;this.m_p.SetV(b.m_p)}},b2.b2CircleShape.prototype.TestPoint=function(a,b){var c=a.R,d=a.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),e=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);return d=b.x-d,e=b.y-e,d*d+e*e<=this.m_radius*this.m_radius},b2.b2CircleShape.prototype.RayCast=function(a,b,c){var d,e=c.R,f=c.position.x+(e.col1.x*this.m_p.x+e.col2.x*this.m_p.y),g=c.position.y+(e.col1.y*this.m_p.x+e.col2.y*this.m_p.y),h=b.p1.x-f,i=b.p1.y-g,j=h*h+i*i-this.m_radius*this.m_radius,k=b.p2.x-b.p1.x,l=b.p2.y-b.p1.y,m=h*k+i*l,n=k*k+l*l,o=m*m-n*j;return 0>o||n<Number.MIN_VALUE?!1:(d=-(m+Math.sqrt(o)),d>=0&&d<=b.maxFraction*n?(d/=n,a.fraction=d,a.normal.x=h+d*k,a.normal.y=i+d*l,a.normal.Normalize(),!0):!1)},b2.b2CircleShape.prototype.ComputeAABB=function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),e=b.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.Set(d-this.m_radius,e-this.m_radius),a.upperBound.Set(d+this.m_radius,e+this.m_radius)},b2.b2CircleShape.prototype.ComputeMass=function(a,b){a.mass=b*b2.b2Settings.b2_pi*this.m_radius*this.m_radius,a.center.SetV(this.m_p),a.I=a.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},b2.b2CircleShape.prototype.ComputeSubmergedArea=function(a,b,c,d){var e=b2.b2Math.MulX(c,this.m_p),f=-(b2.b2Math.Dot(a,e)-b);if(f<-this.m_radius+Number.MIN_VALUE)return 0;if(f>this.m_radius)return d.SetV(e),Math.PI*this.m_radius*this.m_radius;var g=this.m_radius*this.m_radius,h=f*f,i=g*(Math.asin(f/this.m_radius)+Math.PI/2)+f*Math.sqrt(g-h),j=-2/3*Math.pow(g-h,1.5)/i;return d.x=e.x+a.x*j,d.y=e.y+a.y*j,i},b2.b2CircleShape.prototype.GetLocalPosition=function(){return this.m_p},b2.b2CircleShape.prototype.SetLocalPosition=function(a){this.m_p.SetV(a)},b2.b2CircleShape.prototype.GetRadius=function(){return this.m_radius},b2.b2CircleShape.prototype.SetRadius=function(a){this.m_radius=a},b2.b2CircleShape.prototype.m_p=new b2.b2Vec2,b2.b2Joint=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Joint.prototype.__constructor=function(a){b2.b2Settings.b2Assert(a.bodyA!=a.bodyB),this.m_type=a.type,this.m_prev=null,this.m_next=null,this.m_bodyA=a.bodyA,this.m_bodyB=a.bodyB,this.m_collideConnected=a.collideConnected,this.m_islandFlag=!1,this.m_userData=a.userData},b2.b2Joint.prototype.__varz=function(){this.m_edgeA=new b2.b2JointEdge,this.m_edgeB=new b2.b2JointEdge,this.m_localCenterA=new b2.b2Vec2,this.m_localCenterB=new b2.b2Vec2},b2.b2Joint.Create=function(a,b){var c=null;switch(a.type){case b2.b2Joint.e_distanceJoint:c=new b2.b2DistanceJoint(a);break;case b2.b2Joint.e_mouseJoint:c=new b2.b2MouseJoint(a);break;case b2.b2Joint.e_prismaticJoint:c=new b2.b2PrismaticJoint(a);break;case b2.b2Joint.e_revoluteJoint:c=new b2.b2RevoluteJoint(a);break;case b2.b2Joint.e_pulleyJoint:c=new b2.b2PulleyJoint(a);break;case b2.b2Joint.e_gearJoint:c=new b2.b2GearJoint(a);break;case b2.b2Joint.e_lineJoint:c=new b2.b2LineJoint(a);break;case b2.b2Joint.e_weldJoint:c=new b2.b2WeldJoint(a);break;case b2.b2Joint.e_frictionJoint:c=new b2.b2FrictionJoint(a)}return c},b2.b2Joint.Destroy=function(a,b){},b2.b2Joint.e_unknownJoint=0,b2.b2Joint.e_revoluteJoint=1,b2.b2Joint.e_prismaticJoint=2,b2.b2Joint.e_distanceJoint=3,b2.b2Joint.e_pulleyJoint=4,b2.b2Joint.e_mouseJoint=5,b2.b2Joint.e_gearJoint=6,b2.b2Joint.e_lineJoint=7,b2.b2Joint.e_weldJoint=8,b2.b2Joint.e_frictionJoint=9,b2.b2Joint.e_inactiveLimit=0,b2.b2Joint.e_atLowerLimit=1,b2.b2Joint.e_atUpperLimit=2,b2.b2Joint.e_equalLimits=3,b2.b2Joint.prototype.InitVelocityConstraints=function(a){},b2.b2Joint.prototype.SolveVelocityConstraints=function(a){},b2.b2Joint.prototype.FinalizeVelocityConstraints=function(){},b2.b2Joint.prototype.SolvePositionConstraints=function(a){return!1},b2.b2Joint.prototype.GetType=function(){return this.m_type},b2.b2Joint.prototype.GetAnchorA=function(){return null},b2.b2Joint.prototype.GetAnchorB=function(){return null},b2.b2Joint.prototype.GetReactionForce=function(a){return null},b2.b2Joint.prototype.GetReactionTorque=function(a){return 0},b2.b2Joint.prototype.GetBodyA=function(){return this.m_bodyA},b2.b2Joint.prototype.GetBodyB=function(){return this.m_bodyB},b2.b2Joint.prototype.GetNext=function(){return this.m_next},b2.b2Joint.prototype.GetUserData=function(){return this.m_userData},b2.b2Joint.prototype.SetUserData=function(a){this.m_userData=a},b2.b2Joint.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},b2.b2Joint.prototype.m_type=0,b2.b2Joint.prototype.m_prev=null,b2.b2Joint.prototype.m_next=null,b2.b2Joint.prototype.m_edgeA=new b2.b2JointEdge,b2.b2Joint.prototype.m_edgeB=new b2.b2JointEdge,b2.b2Joint.prototype.m_bodyA=null,b2.b2Joint.prototype.m_bodyB=null,b2.b2Joint.prototype.m_islandFlag=null,b2.b2Joint.prototype.m_collideConnected=null,b2.b2Joint.prototype.m_userData=null,b2.b2Joint.prototype.m_localCenterA=new b2.b2Vec2,b2.b2Joint.prototype.m_localCenterB=new b2.b2Vec2,b2.b2Joint.prototype.m_invMassA=null,b2.b2Joint.prototype.m_invMassB=null,b2.b2Joint.prototype.m_invIA=null,b2.b2Joint.prototype.m_invIB=null,b2.b2LineJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2LineJoint.prototype,b2.b2Joint.prototype),b2.b2LineJoint.prototype._super=b2.b2Joint.prototype,b2.b2LineJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]);this.m_localAnchor1.SetV(a.localAnchorA),this.m_localAnchor2.SetV(a.localAnchorB),this.m_localXAxis1.SetV(a.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=a.lowerTranslation,this.m_upperTranslation=a.upperTranslation,this.m_maxMotorForce=a.maxMotorForce,this.m_motorSpeed=a.motorSpeed,this.m_enableLimit=a.enableLimit,this.m_enableMotor=a.enableMotor,this.m_limitState=b2.b2Joint.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},b2.b2LineJoint.prototype.__varz=function(){this.m_localAnchor1=new b2.b2Vec2,this.m_localAnchor2=new b2.b2Vec2,this.m_localXAxis1=new b2.b2Vec2,this.m_localYAxis1=new b2.b2Vec2,this.m_axis=new b2.b2Vec2,this.m_perp=new b2.b2Vec2,this.m_K=new b2.b2Mat22,this.m_impulse=new b2.b2Vec2},b2.b2LineJoint.prototype.InitVelocityConstraints=function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;this.m_localCenterA.SetV(d.GetLocalCenter()),this.m_localCenterB.SetV(e.GetLocalCenter());var f=d.GetTransform();e.GetTransform();b=d.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,h=this.m_localAnchor1.y-this.m_localCenterA.y;c=b.col1.x*g+b.col2.x*h,h=b.col1.y*g+b.col2.y*h,g=c,b=e.m_xf.R;var i=this.m_localAnchor2.x-this.m_localCenterB.x,j=this.m_localAnchor2.y-this.m_localCenterB.y;c=b.col1.x*i+b.col2.x*j,j=b.col1.y*i+b.col2.y*j,i=c;var k=e.m_sweep.c.x+i-d.m_sweep.c.x-g,l=e.m_sweep.c.y+j-d.m_sweep.c.y-h;this.m_invMassA=d.m_invMass,this.m_invMassB=e.m_invMass,this.m_invIA=d.m_invI,this.m_invIB=e.m_invI,this.m_axis.SetV(b2.b2Math.MulMV(f.R,this.m_localXAxis1)),this.m_a1=(k+g)*this.m_axis.y-(l+h)*this.m_axis.x,this.m_a2=i*this.m_axis.y-j*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(b2.b2Math.MulMV(f.R,this.m_localYAxis1)),this.m_s1=(k+g)*this.m_perp.y-(l+h)*this.m_perp.x,this.m_s2=i*this.m_perp.y-j*this.m_perp.x;var m=this.m_invMassA,n=this.m_invMassB,o=this.m_invIA,p=this.m_invIB;if(this.m_K.col1.x=m+n+o*this.m_s1*this.m_s1+p*this.m_s2*this.m_s2,this.m_K.col1.y=o*this.m_s1*this.m_a1+p*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=m+n+o*this.m_a1*this.m_a1+p*this.m_a2*this.m_a2,this.m_enableLimit){var q=this.m_axis.x*k+this.m_axis.y*l;b2.b2Math.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b2.b2Settings.b2_linearSlop?this.m_limitState=b2.b2Joint.e_equalLimits:q<=this.m_lowerTranslation?this.m_limitState!=b2.b2Joint.e_atLowerLimit&&(this.m_limitState=b2.b2Joint.e_atLowerLimit,this.m_impulse.y=0):q>=this.m_upperTranslation?this.m_limitState!=b2.b2Joint.e_atUpperLimit&&(this.m_limitState=b2.b2Joint.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=b2.b2Joint.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=b2.b2Joint.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),a.warmStarting){this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio;var r=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,s=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,t=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,u=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;d.m_linearVelocity.x-=this.m_invMassA*r,d.m_linearVelocity.y-=this.m_invMassA*s,d.m_angularVelocity-=this.m_invIA*t,e.m_linearVelocity.x+=this.m_invMassB*r,e.m_linearVelocity.y+=this.m_invMassB*s,e.m_angularVelocity+=this.m_invIB*u}else this.m_impulse.SetZero(),this.m_motorImpulse=0},b2.b2LineJoint.prototype.SolveVelocityConstraints=function(a){var b,c,d,e,f=this.m_bodyA,g=this.m_bodyB,h=f.m_linearVelocity,i=f.m_angularVelocity,j=g.m_linearVelocity,k=g.m_angularVelocity;if(this.m_enableMotor&&this.m_limitState!=b2.b2Joint.e_equalLimits){var l=this.m_axis.x*(j.x-h.x)+this.m_axis.y*(j.y-h.y)+this.m_a2*k-this.m_a1*i,m=this.m_motorMass*(this.m_motorSpeed-l),n=this.m_motorImpulse,o=a.dt*this.m_maxMotorForce;this.m_motorImpulse=b2.b2Math.Clamp(this.m_motorImpulse+m,-o,o),m=this.m_motorImpulse-n,b=m*this.m_axis.x,c=m*this.m_axis.y,d=m*this.m_a1,e=m*this.m_a2,h.x-=this.m_invMassA*b,h.y-=this.m_invMassA*c,i-=this.m_invIA*d,j.x+=this.m_invMassB*b,j.y+=this.m_invMassB*c,k+=this.m_invIB*e}var p=this.m_perp.x*(j.x-h.x)+this.m_perp.y*(j.y-h.y)+this.m_s2*k-this.m_s1*i;if(this.m_enableLimit&&this.m_limitState!=b2.b2Joint.e_inactiveLimit){var q=this.m_axis.x*(j.x-h.x)+this.m_axis.y*(j.y-h.y)+this.m_a2*k-this.m_a1*i,r=this.m_impulse.Copy(),s=this.m_K.Solve(new b2.b2Vec2,-p,-q);this.m_impulse.Add(s),this.m_limitState==b2.b2Joint.e_atLowerLimit?this.m_impulse.y=b2.b2Math.Max(this.m_impulse.y,0):this.m_limitState==b2.b2Joint.e_atUpperLimit&&(this.m_impulse.y=b2.b2Math.Min(this.m_impulse.y,0));var t,u=-p-(this.m_impulse.y-r.y)*this.m_K.col2.x;t=0!=this.m_K.col1.x?u/this.m_K.col1.x+r.x:r.x,this.m_impulse.x=t,s.x=this.m_impulse.x-r.x,s.y=this.m_impulse.y-r.y,b=s.x*this.m_perp.x+s.y*this.m_axis.x,c=s.x*this.m_perp.y+s.y*this.m_axis.y,d=s.x*this.m_s1+s.y*this.m_a1,e=s.x*this.m_s2+s.y*this.m_a2,h.x-=this.m_invMassA*b,h.y-=this.m_invMassA*c,i-=this.m_invIA*d,j.x+=this.m_invMassB*b,j.y+=this.m_invMassB*c,k+=this.m_invIB*e}else{var v;v=0!=this.m_K.col1.x?-p/this.m_K.col1.x:0,this.m_impulse.x+=v,b=v*this.m_perp.x,c=v*this.m_perp.y,d=v*this.m_s1,e=v*this.m_s2,h.x-=this.m_invMassA*b,h.y-=this.m_invMassA*c,i-=this.m_invIA*d,j.x+=this.m_invMassB*b,j.y+=this.m_invMassB*c,k+=this.m_invIB*e}f.m_linearVelocity.SetV(h),f.m_angularVelocity=i,g.m_linearVelocity.SetV(j),g.m_angularVelocity=k},b2.b2LineJoint.prototype.SolvePositionConstraints=function(a){var b,c,d,e,f,g,h=this.m_bodyA,i=this.m_bodyB,j=h.m_sweep.c,k=h.m_sweep.a,l=i.m_sweep.c,m=i.m_sweep.a,n=0,o=0,p=!1,q=0,r=b2.b2Mat22.FromAngle(k),s=b2.b2Mat22.FromAngle(m);b=r;var t=this.m_localAnchor1.x-this.m_localCenterA.x,u=this.m_localAnchor1.y-this.m_localCenterA.y;c=b.col1.x*t+b.col2.x*u,u=b.col1.y*t+b.col2.y*u,t=c,b=s;var v=this.m_localAnchor2.x-this.m_localCenterB.x,w=this.m_localAnchor2.y-this.m_localCenterB.y;c=b.col1.x*v+b.col2.x*w,w=b.col1.y*v+b.col2.y*w,v=c;var x=l.x+v-j.x-t,y=l.y+w-j.y-u;if(this.m_enableLimit){this.m_axis=b2.b2Math.MulMV(r,this.m_localXAxis1),this.m_a1=(x+t)*this.m_axis.y-(y+u)*this.m_axis.x,this.m_a2=v*this.m_axis.y-w*this.m_axis.x;var z=this.m_axis.x*x+this.m_axis.y*y;b2.b2Math.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b2.b2Settings.b2_linearSlop?(q=b2.b2Math.Clamp(z,-b2.b2Settings.b2_maxLinearCorrection,b2.b2Settings.b2_maxLinearCorrection),n=b2.b2Math.Abs(z),p=!0):z<=this.m_lowerTranslation?(q=b2.b2Math.Clamp(z-this.m_lowerTranslation+b2.b2Settings.b2_linearSlop,-b2.b2Settings.b2_maxLinearCorrection,0),n=this.m_lowerTranslation-z,p=!0):z>=this.m_upperTranslation&&(q=b2.b2Math.Clamp(z-this.m_upperTranslation+b2.b2Settings.b2_linearSlop,0,b2.b2Settings.b2_maxLinearCorrection),n=z-this.m_upperTranslation,p=!0)}this.m_perp=b2.b2Math.MulMV(r,this.m_localYAxis1),this.m_s1=(x+t)*this.m_perp.y-(y+u)*this.m_perp.x,this.m_s2=v*this.m_perp.y-w*this.m_perp.x;var A=new b2.b2Vec2,B=this.m_perp.x*x+this.m_perp.y*y;if(n=b2.b2Math.Max(n,b2.b2Math.Abs(B)),o=0,p)d=this.m_invMassA,e=this.m_invMassB,f=this.m_invIA,g=this.m_invIB,this.m_K.col1.x=d+e+f*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,this.m_K.col1.y=f*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=d+e+f*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_K.Solve(A,-B,-q);else{d=this.m_invMassA,e=this.m_invMassB,f=this.m_invIA,g=this.m_invIB;var C,D=d+e+f*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2;C=0!=D?-B/D:0,A.x=C,A.y=0}var E=A.x*this.m_perp.x+A.y*this.m_axis.x,F=A.x*this.m_perp.y+A.y*this.m_axis.y,G=A.x*this.m_s1+A.y*this.m_a1,H=A.x*this.m_s2+A.y*this.m_a2;return j.x-=this.m_invMassA*E,j.y-=this.m_invMassA*F,k-=this.m_invIA*G,l.x+=this.m_invMassB*E,l.y+=this.m_invMassB*F,m+=this.m_invIB*H,h.m_sweep.a=k,i.m_sweep.a=m,h.SynchronizeTransform(),i.SynchronizeTransform(),n<=b2.b2Settings.b2_linearSlop&&o<=b2.b2Settings.b2_angularSlop},b2.b2LineJoint.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},b2.b2LineJoint.prototype.GetAnchorB=function(){
return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},b2.b2LineJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},b2.b2LineJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.y},b2.b2LineJoint.prototype.GetJointTranslation=function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.GetWorldPoint(this.m_localAnchor1),d=b.GetWorldPoint(this.m_localAnchor2),e=d.x-c.x,f=d.y-c.y,g=a.GetWorldVector(this.m_localXAxis1),h=g.x*e+g.y*f;return h},b2.b2LineJoint.prototype.GetJointSpeed=function(){var a,b=this.m_bodyA,c=this.m_bodyB;a=b.m_xf.R;var d=this.m_localAnchor1.x-b.m_sweep.localCenter.x,e=this.m_localAnchor1.y-b.m_sweep.localCenter.y,f=a.col1.x*d+a.col2.x*e;e=a.col1.y*d+a.col2.y*e,d=f,a=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y;f=a.col1.x*g+a.col2.x*h,h=a.col1.y*g+a.col2.y*h,g=f;var i=b.m_sweep.c.x+d,j=b.m_sweep.c.y+e,k=c.m_sweep.c.x+g,l=c.m_sweep.c.y+h,m=k-i,n=l-j,o=b.GetWorldVector(this.m_localXAxis1),p=b.m_linearVelocity,q=c.m_linearVelocity,r=b.m_angularVelocity,s=c.m_angularVelocity,t=m*-r*o.y+n*r*o.x+(o.x*(q.x+-s*h-p.x- -r*e)+o.y*(q.y+s*g-p.y-r*d));return t},b2.b2LineJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit},b2.b2LineJoint.prototype.EnableLimit=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=a},b2.b2LineJoint.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},b2.b2LineJoint.prototype.GetUpperLimit=function(){return this.m_upperTranslation},b2.b2LineJoint.prototype.SetLimits=function(a,b){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=a,this.m_upperTranslation=b},b2.b2LineJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor},b2.b2LineJoint.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=a},b2.b2LineJoint.prototype.SetMotorSpeed=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=a},b2.b2LineJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},b2.b2LineJoint.prototype.SetMaxMotorForce=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=a},b2.b2LineJoint.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},b2.b2LineJoint.prototype.GetMotorForce=function(){return this.m_motorImpulse},b2.b2LineJoint.prototype.m_localAnchor1=new b2.b2Vec2,b2.b2LineJoint.prototype.m_localAnchor2=new b2.b2Vec2,b2.b2LineJoint.prototype.m_localXAxis1=new b2.b2Vec2,b2.b2LineJoint.prototype.m_localYAxis1=new b2.b2Vec2,b2.b2LineJoint.prototype.m_axis=new b2.b2Vec2,b2.b2LineJoint.prototype.m_perp=new b2.b2Vec2,b2.b2LineJoint.prototype.m_s1=null,b2.b2LineJoint.prototype.m_s2=null,b2.b2LineJoint.prototype.m_a1=null,b2.b2LineJoint.prototype.m_a2=null,b2.b2LineJoint.prototype.m_K=new b2.b2Mat22,b2.b2LineJoint.prototype.m_impulse=new b2.b2Vec2,b2.b2LineJoint.prototype.m_motorMass=null,b2.b2LineJoint.prototype.m_motorImpulse=null,b2.b2LineJoint.prototype.m_lowerTranslation=null,b2.b2LineJoint.prototype.m_upperTranslation=null,b2.b2LineJoint.prototype.m_maxMotorForce=null,b2.b2LineJoint.prototype.m_motorSpeed=null,b2.b2LineJoint.prototype.m_enableLimit=null,b2.b2LineJoint.prototype.m_enableMotor=null,b2.b2LineJoint.prototype.m_limitState=0,b2.b2ContactSolver=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactSolver.prototype.__constructor=function(){},b2.b2ContactSolver.prototype.__varz=function(){this.m_step=new b2.b2TimeStep,this.m_constraints=new Array},b2.b2ContactSolver.s_worldManifold=new b2.b2WorldManifold,b2.b2ContactSolver.s_psm=new b2.b2PositionSolverManifold,b2.b2ContactSolver.prototype.Initialize=function(a,b,c,d){var e,f=0;for(this.m_step.Set(a),this.m_allocator=d,this.m_constraintCount=c;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new b2.b2ContactConstraint;for(;c>f;++f){e=b[f];var g=e.m_fixtureA,h=e.m_fixtureB,i=g.m_shape,j=h.m_shape,k=i.m_radius,l=j.m_radius,m=g.m_body,n=h.m_body,o=e.GetManifold(),p=b2.b2SettingsMixFriction(g.GetFriction(),h.GetFriction()),q=b2.b2SettingsMixRestitution(g.GetRestitution(),h.GetRestitution()),r=m.m_linearVelocity.x,s=m.m_linearVelocity.y,t=n.m_linearVelocity.x,u=n.m_linearVelocity.y,v=m.m_angularVelocity,w=n.m_angularVelocity;b2.b2Settings.b2Assert(o.m_pointCount>0),b2.b2ContactSolver.s_worldManifold.Initialize(o,m.m_xf,k,n.m_xf,l);var x=b2.b2ContactSolver.s_worldManifold.m_normal.x,y=b2.b2ContactSolver.s_worldManifold.m_normal.y,z=this.m_constraints[f];z.bodyA=m,z.bodyB=n,z.manifold=o,z.normal.x=x,z.normal.y=y,z.pointCount=o.m_pointCount,z.friction=p,z.restitution=q,z.localPlaneNormal.x=o.m_localPlaneNormal.x,z.localPlaneNormal.y=o.m_localPlaneNormal.y,z.localPoint.x=o.m_localPoint.x,z.localPoint.y=o.m_localPoint.y,z.radius=k+l,z.type=o.m_type;for(var A=0;A<z.pointCount;++A){var B=o.m_points[A],C=z.points[A];C.normalImpulse=B.m_normalImpulse,C.tangentImpulse=B.m_tangentImpulse,C.localPoint.SetV(B.m_localPoint);var D=C.rA.x=b2.b2ContactSolver.s_worldManifold.m_points[A].x-m.m_sweep.c.x,E=C.rA.y=b2.b2ContactSolver.s_worldManifold.m_points[A].y-m.m_sweep.c.y,F=C.rB.x=b2.b2ContactSolver.s_worldManifold.m_points[A].x-n.m_sweep.c.x,G=C.rB.y=b2.b2ContactSolver.s_worldManifold.m_points[A].y-n.m_sweep.c.y,H=D*y-E*x,I=F*y-G*x;H*=H,I*=I;var J=m.m_invMass+n.m_invMass+m.m_invI*H+n.m_invI*I;C.normalMass=1/J;var K=m.m_mass*m.m_invMass+n.m_mass*n.m_invMass;K+=m.m_mass*m.m_invI*H+n.m_mass*n.m_invI*I,C.equalizedMass=1/K;var L=y,M=-x,N=D*M-E*L,O=F*M-G*L;N*=N,O*=O;var P=m.m_invMass+n.m_invMass+m.m_invI*N+n.m_invI*O;C.tangentMass=1/P,C.velocityBias=0;var Q=t+-w*G-r- -v*E,R=u+w*F-s-v*D,S=z.normal.x*Q+z.normal.y*R;S<-b2.b2Settings.b2_velocityThreshold&&(C.velocityBias+=-z.restitution*S)}if(2==z.pointCount){var T=z.points[0],U=z.points[1],V=m.m_invMass,W=m.m_invI,X=n.m_invMass,Y=n.m_invI,Z=T.rA.x*y-T.rA.y*x,$=T.rB.x*y-T.rB.y*x,_=U.rA.x*y-U.rA.y*x,aa=U.rB.x*y-U.rB.y*x,ba=V+X+W*Z*Z+Y*$*$,ca=V+X+W*_*_+Y*aa*aa,da=V+X+W*Z*_+Y*$*aa,ea=100;ea*(ba*ca-da*da)>ba*ba?(z.K.col1.Set(ba,da),z.K.col2.Set(da,ca),z.K.GetInverse(z.normalMass)):z.pointCount=1}}},b2.b2ContactSolver.prototype.InitVelocityConstraints=function(a){for(var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=0;r<this.m_constraintCount;++r)if(b=this.m_constraints[r],c=b.bodyA,d=b.bodyB,e=c.m_invMass,f=c.m_invI,g=d.m_invMass,h=d.m_invI,i=b.normal.x,j=b.normal.y,k=j,l=-i,n=0,a.warmStarting)for(n=b.pointCount,m=0;n>m;++m)o=b.points[m],o.normalImpulse*=a.dtRatio,o.tangentImpulse*=a.dtRatio,p=o.normalImpulse*i+o.tangentImpulse*k,q=o.normalImpulse*j+o.tangentImpulse*l,c.m_angularVelocity-=f*(o.rA.x*q-o.rA.y*p),c.m_linearVelocity.x-=e*p,c.m_linearVelocity.y-=e*q,d.m_angularVelocity+=h*(o.rB.x*q-o.rB.y*p),d.m_linearVelocity.x+=g*p,d.m_linearVelocity.y+=g*q;else for(n=b.pointCount,m=0;n>m;++m){var s=b.points[m];s.normalImpulse=0,s.tangentImpulse=0}},b2.b2ContactSolver.prototype.SolveVelocityConstraints=function(){for(var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=0,s=0;s<this.m_constraintCount;++s){var t=this.m_constraints[s],u=t.bodyA,v=t.bodyB,w=u.m_angularVelocity,x=v.m_angularVelocity,y=u.m_linearVelocity,z=v.m_linearVelocity,A=u.m_invMass,B=u.m_invI,C=v.m_invMass,D=v.m_invI,E=t.normal.x,F=t.normal.y,G=F,H=-E,I=t.friction;for(r=0;r<t.pointCount;r++)a=t.points[r],b=z.x-x*a.rB.y-y.x+w*a.rA.y,c=z.y+x*a.rB.x-y.y-w*a.rA.x,e=b*G+c*H,f=a.tangentMass*-e,g=I*a.normalImpulse,h=b2.b2Math.Clamp(a.tangentImpulse+f,-g,g),f=h-a.tangentImpulse,i=f*G,j=f*H,y.x-=A*i,y.y-=A*j,w-=B*(a.rA.x*j-a.rA.y*i),z.x+=C*i,z.y+=C*j,x+=D*(a.rB.x*j-a.rB.y*i),a.tangentImpulse=h;t.pointCount;if(1==t.pointCount)a=t.points[0],b=z.x+-x*a.rB.y-y.x- -w*a.rA.y,c=z.y+x*a.rB.x-y.y-w*a.rA.x,d=b*E+c*F,f=-a.normalMass*(d-a.velocityBias),h=a.normalImpulse+f,h=h>0?h:0,f=h-a.normalImpulse,i=f*E,j=f*F,y.x-=A*i,y.y-=A*j,w-=B*(a.rA.x*j-a.rA.y*i),z.x+=C*i,z.y+=C*j,x+=D*(a.rB.x*j-a.rB.y*i),a.normalImpulse=h;else{var J=t.points[0],K=t.points[1],L=J.normalImpulse,M=K.normalImpulse,N=z.x-x*J.rB.y-y.x+w*J.rA.y,O=z.y+x*J.rB.x-y.y-w*J.rA.x,P=z.x-x*K.rB.y-y.x+w*K.rA.y,Q=z.y+x*K.rB.x-y.y-w*K.rA.x,R=N*E+O*F,S=P*E+Q*F,T=R-J.velocityBias,U=S-K.velocityBias;q=t.K,T-=q.col1.x*L+q.col2.x*M,U-=q.col1.y*L+q.col2.y*M;for(;;){q=t.normalMass;var V=-(q.col1.x*T+q.col2.x*U),W=-(q.col1.y*T+q.col2.y*U);if(V>=0&&W>=0){k=V-L,l=W-M,m=k*E,n=k*F,o=l*E,p=l*F,y.x-=A*(m+o),y.y-=A*(n+p),w-=B*(J.rA.x*n-J.rA.y*m+K.rA.x*p-K.rA.y*o),z.x+=C*(m+o),z.y+=C*(n+p),x+=D*(J.rB.x*n-J.rB.y*m+K.rB.x*p-K.rB.y*o),J.normalImpulse=V,K.normalImpulse=W;break}if(V=-J.normalMass*T,W=0,R=0,S=t.K.col1.y*V+U,V>=0&&S>=0){k=V-L,l=W-M,m=k*E,n=k*F,o=l*E,p=l*F,y.x-=A*(m+o),y.y-=A*(n+p),w-=B*(J.rA.x*n-J.rA.y*m+K.rA.x*p-K.rA.y*o),z.x+=C*(m+o),z.y+=C*(n+p),x+=D*(J.rB.x*n-J.rB.y*m+K.rB.x*p-K.rB.y*o),J.normalImpulse=V,K.normalImpulse=W;break}if(V=0,W=-K.normalMass*U,R=t.K.col2.x*W+T,S=0,W>=0&&R>=0){k=V-L,l=W-M,m=k*E,n=k*F,o=l*E,p=l*F,y.x-=A*(m+o),y.y-=A*(n+p),w-=B*(J.rA.x*n-J.rA.y*m+K.rA.x*p-K.rA.y*o),z.x+=C*(m+o),z.y+=C*(n+p),x+=D*(J.rB.x*n-J.rB.y*m+K.rB.x*p-K.rB.y*o),J.normalImpulse=V,K.normalImpulse=W;break}if(V=0,W=0,R=T,S=U,R>=0&&S>=0){k=V-L,l=W-M,m=k*E,n=k*F,o=l*E,p=l*F,y.x-=A*(m+o),y.y-=A*(n+p),w-=B*(J.rA.x*n-J.rA.y*m+K.rA.x*p-K.rA.y*o),z.x+=C*(m+o),z.y+=C*(n+p),x+=D*(J.rB.x*n-J.rB.y*m+K.rB.x*p-K.rB.y*o),J.normalImpulse=V,K.normalImpulse=W;break}break}}u.m_angularVelocity=w,v.m_angularVelocity=x}},b2.b2ContactSolver.prototype.FinalizeVelocityConstraints=function(){for(var a,b,c,d,e=0,f=0;e<this.m_constraintCount;++e)for(a=this.m_constraints[e],b=a.manifold,f=0;f<a.pointCount;++f)c=b.m_points[f],d=a.points[f],c.m_normalImpulse=d.normalImpulse,c.m_tangentImpulse=d.tangentImpulse},b2.b2ContactSolver.prototype.SolvePositionConstraints=function(a){for(var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=0,w=0;w<this.m_constraintCount;w++)for(b=this.m_constraints[w],c=b.bodyA,d=b.bodyB,e=c.m_mass*c.m_invMass,f=c.m_mass*c.m_invI,g=d.m_mass*d.m_invMass,h=d.m_mass*d.m_invI,b2.b2ContactSolver.s_psm.Initialize(b),i=b2.b2ContactSolver.s_psm.m_normal,j=0;j<b.pointCount;j++)k=b.points[j],l=b2.b2ContactSolver.s_psm.m_points[j],m=b2.b2ContactSolver.s_psm.m_separations[j],n=l.x-c.m_sweep.c.x,o=l.y-c.m_sweep.c.y,p=l.x-d.m_sweep.c.x,q=l.y-d.m_sweep.c.y,v=m>v?v:m,r=b2.b2Math.Clamp(a*(m+b2.b2Settings.b2_linearSlop),-b2.b2Settings.b2_maxLinearCorrection,0),s=-k.equalizedMass*r,t=s*i.x,u=s*i.y,c.m_sweep.c.x-=e*t,c.m_sweep.c.y-=e*u,c.m_sweep.a-=f*(n*u-o*t),c.SynchronizeTransform(),d.m_sweep.c.x+=g*t,d.m_sweep.c.y+=g*u,d.m_sweep.a+=h*(p*u-q*t),d.SynchronizeTransform();return v>-1.5*b2.b2Settings.b2_linearSlop},b2.b2ContactSolver.prototype.m_step=new b2.b2TimeStep,b2.b2ContactSolver.prototype.m_allocator=null,b2.b2ContactSolver.prototype.m_constraints=[],b2.b2ContactSolver.prototype.m_constraintCount=0,b2.b2Simplex=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Simplex.prototype.__constructor=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},b2.b2Simplex.prototype.__varz=function(){this.m_v1=new b2.b2SimplexVertex,this.m_v2=new b2.b2SimplexVertex,this.m_v3=new b2.b2SimplexVertex,this.m_vertices=new Array(3)},b2.b2Simplex.prototype.ReadCache=function(a,b,c,d,e){b2.b2Settings.b2Assert(0<=a.count&&a.count<=3);var f,g;this.m_count=a.count;for(var h=this.m_vertices,i=0;i<this.m_count;i++){var j=h[i];j.indexA=a.indexA[i],j.indexB=a.indexB[i],f=b.GetVertex(j.indexA),g=d.GetVertex(j.indexB),j.wA=b2.b2Math.MulX(c,f),j.wB=b2.b2Math.MulX(e,g),j.w=b2.b2Math.SubtractVV(j.wB,j.wA),j.a=0}if(this.m_count>1){var k=a.metric,l=this.GetMetric();(.5*k>l||l>2*k||l<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&(j=h[0],j.indexA=0,j.indexB=0,f=b.GetVertex(0),g=d.GetVertex(0),j.wA=b2.b2Math.MulX(c,f),j.wB=b2.b2Math.MulX(e,g),j.w=b2.b2Math.SubtractVV(j.wB,j.wA),this.m_count=1)},b2.b2Simplex.prototype.WriteCache=function(a){a.metric=this.GetMetric(),a.count=~~this.m_count;for(var b=this.m_vertices,c=0;c<this.m_count;c++)a.indexA[c]=~~b[c].indexA,a.indexB[c]=~~b[c].indexB},b2.b2Simplex.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var a=b2.b2Math.SubtractVV(this.m_v2.w,this.m_v1.w),b=b2.b2Math.CrossVV(a,this.m_v1.w.GetNegative());return b>0?b2.b2Math.CrossFV(1,a):b2.b2Math.CrossVF(a,1);default:return b2.b2Settings.b2Assert(!1),new b2.b2Vec2}},b2.b2Simplex.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return b2.b2Settings.b2Assert(!1),new b2.b2Vec2;case 1:return this.m_v1.w;case 2:return new b2.b2Vec2(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return b2.b2Settings.b2Assert(!1),new b2.b2Vec2}},b2.b2Simplex.prototype.GetWitnessPoints=function(a,b){switch(this.m_count){case 0:b2.b2Settings.b2Assert(!1);break;case 1:a.SetV(this.m_v1.wA),b.SetV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,b.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:b2.b2Settings.b2Assert(!1)}},b2.b2Simplex.prototype.GetMetric=function(){switch(this.m_count){case 0:return b2.b2Settings.b2Assert(!1),0;case 1:return 0;case 2:return b2.b2Math.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return b2.b2Math.CrossVV(b2.b2Math.SubtractVV(this.m_v2.w,this.m_v1.w),b2.b2Math.SubtractVV(this.m_v3.w,this.m_v1.w));default:return b2.b2Settings.b2Assert(!1),0}},b2.b2Simplex.prototype.Solve2=function(){var a=this.m_v1.w,b=this.m_v2.w,c=b2.b2Math.SubtractVV(b,a),d=-(a.x*c.x+a.y*c.y);if(0>=d)return this.m_v1.a=1,void(this.m_count=1);var e=b.x*c.x+b.y*c.y;if(0>=e)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var f=1/(e+d);this.m_v1.a=e*f,this.m_v2.a=d*f,this.m_count=2},b2.b2Simplex.prototype.Solve3=function(){var a=this.m_v1.w,b=this.m_v2.w,c=this.m_v3.w,d=b2.b2Math.SubtractVV(b,a),e=b2.b2Math.Dot(a,d),f=b2.b2Math.Dot(b,d),g=f,h=-e,i=b2.b2Math.SubtractVV(c,a),j=b2.b2Math.Dot(a,i),k=b2.b2Math.Dot(c,i),l=k,m=-j,n=b2.b2Math.SubtractVV(c,b),o=b2.b2Math.Dot(b,n),p=b2.b2Math.Dot(c,n),q=p,r=-o,s=b2.b2Math.CrossVV(d,i),t=s*b2.b2Math.CrossVV(b,c),u=s*b2.b2Math.CrossVV(c,a),v=s*b2.b2Math.CrossVV(a,b);if(0>=h&&0>=m)return this.m_v1.a=1,void(this.m_count=1);if(g>0&&h>0&&0>=v){var w=1/(g+h);return this.m_v1.a=g*w,this.m_v2.a=h*w,void(this.m_count=2)}if(l>0&&m>0&&0>=u){var x=1/(l+m);return this.m_v1.a=l*x,this.m_v3.a=m*x,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(0>=g&&0>=r)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(0>=l&&0>=q)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(q>0&&r>0&&0>=t){var y=1/(q+r);return this.m_v2.a=q*y,this.m_v3.a=r*y,this.m_count=2,void this.m_v1.Set(this.m_v3)}var z=1/(t+u+v);this.m_v1.a=t*z,this.m_v2.a=u*z,this.m_v3.a=v*z,this.m_count=3},b2.b2Simplex.prototype.m_v1=new b2.b2SimplexVertex,b2.b2Simplex.prototype.m_v2=new b2.b2SimplexVertex,b2.b2Simplex.prototype.m_v3=new b2.b2SimplexVertex,b2.b2Simplex.prototype.m_vertices=new Array(3),b2.b2Simplex.prototype.m_count=0,b2.b2WeldJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2WeldJoint.prototype,b2.b2Joint.prototype),b2.b2WeldJoint.prototype._super=b2.b2Joint.prototype,b2.b2WeldJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]),this.m_localAnchorA.SetV(a.localAnchorA),this.m_localAnchorB.SetV(a.localAnchorB),this.m_referenceAngle=a.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new b2.b2Mat33},b2.b2WeldJoint.prototype.__varz=function(){this.m_localAnchorA=new b2.b2Vec2,this.m_localAnchorB=new b2.b2Vec2,this.m_impulse=new b2.b2Vec3,this.m_mass=new b2.b2Mat33},b2.b2WeldJoint.prototype.InitVelocityConstraints=function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g,g=b.col1.y*f+b.col2.y*g,f=c,b=e.m_xf.R;var h=this.m_localAnchorB.x-e.m_sweep.localCenter.x,i=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*h+b.col2.x*i,i=b.col1.y*h+b.col2.y*i,h=c;var j=d.m_invMass,k=e.m_invMass,l=d.m_invI,m=e.m_invI;this.m_mass.col1.x=j+k+g*g*l+i*i*m,this.m_mass.col2.x=-g*f*l-i*h*m,this.m_mass.col3.x=-g*l-i*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=j+k+f*f*l+h*h*m,this.m_mass.col3.y=f*l+h*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=l+m,a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_impulse.z*=a.dtRatio,d.m_linearVelocity.x-=j*this.m_impulse.x,d.m_linearVelocity.y-=j*this.m_impulse.y,d.m_angularVelocity-=l*(f*this.m_impulse.y-g*this.m_impulse.x+this.m_impulse.z),e.m_linearVelocity.x+=k*this.m_impulse.x,e.m_linearVelocity.y+=k*this.m_impulse.y,e.m_angularVelocity+=m*(h*this.m_impulse.y-i*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},b2.b2WeldJoint.prototype.SolveVelocityConstraints=function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB,f=d.m_linearVelocity,g=d.m_angularVelocity,h=e.m_linearVelocity,i=e.m_angularVelocity,j=d.m_invMass,k=e.m_invMass,l=d.m_invI,m=e.m_invI;b=d.m_xf.R;var n=this.m_localAnchorA.x-d.m_sweep.localCenter.x,o=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*n+b.col2.x*o,o=b.col1.y*n+b.col2.y*o,n=c,b=e.m_xf.R;var p=this.m_localAnchorB.x-e.m_sweep.localCenter.x,q=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*p+b.col2.x*q,q=b.col1.y*p+b.col2.y*q,p=c;var r=h.x-i*q-f.x+g*o,s=h.y+i*p-f.y-g*n,t=i-g,u=new b2.b2Vec3;this.m_mass.Solve33(u,-r,-s,-t),this.m_impulse.Add(u),f.x-=j*u.x,f.y-=j*u.y,g-=l*(n*u.y-o*u.x+u.z),h.x+=k*u.x,h.y+=k*u.y,i+=m*(p*u.y-q*u.x+u.z),d.m_angularVelocity=g,e.m_angularVelocity=i},b2.b2WeldJoint.prototype.SolvePositionConstraints=function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g,g=b.col1.y*f+b.col2.y*g,f=c,b=e.m_xf.R;var h=this.m_localAnchorB.x-e.m_sweep.localCenter.x,i=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*h+b.col2.x*i,i=b.col1.y*h+b.col2.y*i,h=c;var j=d.m_invMass,k=e.m_invMass,l=d.m_invI,m=e.m_invI,n=e.m_sweep.c.x+h-d.m_sweep.c.x-f,o=e.m_sweep.c.y+i-d.m_sweep.c.y-g,p=e.m_sweep.a-d.m_sweep.a-this.m_referenceAngle,q=10*b2.b2Settings.b2_linearSlop,r=Math.sqrt(n*n+o*o),s=b2.b2Math.Abs(p);r>q&&(l*=1,m*=1),this.m_mass.col1.x=j+k+g*g*l+i*i*m,this.m_mass.col2.x=-g*f*l-i*h*m,this.m_mass.col3.x=-g*l-i*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=j+k+f*f*l+h*h*m,this.m_mass.col3.y=f*l+h*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=l+m;var t=new b2.b2Vec3;return this.m_mass.Solve33(t,-n,-o,-p),d.m_sweep.c.x-=j*t.x,d.m_sweep.c.y-=j*t.y,d.m_sweep.a-=l*(f*t.y-g*t.x+t.z),e.m_sweep.c.x+=k*t.x,e.m_sweep.c.y+=k*t.y,e.m_sweep.a+=m*(h*t.y-i*t.x+t.z),d.SynchronizeTransform(),e.SynchronizeTransform(),r<=b2.b2Settings.b2_linearSlop&&s<=b2.b2Settings.b2_angularSlop},b2.b2WeldJoint.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},b2.b2WeldJoint.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},b2.b2WeldJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*this.m_impulse.x,a*this.m_impulse.y)},b2.b2WeldJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.z},b2.b2WeldJoint.prototype.m_localAnchorA=new b2.b2Vec2,b2.b2WeldJoint.prototype.m_localAnchorB=new b2.b2Vec2,b2.b2WeldJoint.prototype.m_referenceAngle=null,b2.b2WeldJoint.prototype.m_impulse=new b2.b2Vec3,b2.b2WeldJoint.prototype.m_mass=new b2.b2Mat33,b2.b2Math=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Math.prototype.__constructor=function(){},b2.b2Math.prototype.__varz=function(){},b2.b2Math.IsValid=function(a){return isFinite(a)},b2.b2Math.Dot=function(a,b){return a.x*b.x+a.y*b.y},b2.b2Math.CrossVV=function(a,b){return a.x*b.y-a.y*b.x},b2.b2Math.CrossVF=function(a,b){var c=new b2.b2Vec2(b*a.y,-b*a.x);return c},b2.b2Math.CrossFV=function(a,b){var c=new b2.b2Vec2(-a*b.y,a*b.x);return c},b2.b2Math.MulMV=function(a,b){var c=new b2.b2Vec2(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+a.col2.y*b.y);return c},b2.b2Math.MulTMV=function(a,b){var c=new b2.b2Vec2(b2.b2Math.Dot(b,a.col1),b2.b2Math.Dot(b,a.col2));return c},b2.b2Math.MulX=function(a,b){var c=b2.b2Math.MulMV(a.R,b);return c.x+=a.position.x,c.y+=a.position.y,c},b2.b2Math.MulXT=function(a,b){var c=b2.b2Math.SubtractVV(b,a.position),d=c.x*a.R.col1.x+c.y*a.R.col1.y;return c.y=c.x*a.R.col2.x+c.y*a.R.col2.y,c.x=d,c},b2.b2Math.AddVV=function(a,b){var c=new b2.b2Vec2(a.x+b.x,a.y+b.y);return c},b2.b2Math.SubtractVV=function(a,b){var c=new b2.b2Vec2(a.x-b.x,a.y-b.y);return c},b2.b2Math.Distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)},b2.b2Math.DistanceSquared=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},b2.b2Math.MulFV=function(a,b){var c=new b2.b2Vec2(a*b.x,a*b.y);return c},b2.b2Math.AddMM=function(a,b){var c=b2.b2Mat22.FromVV(b2.b2Math.AddVV(a.col1,b.col1),b2.b2Math.AddVV(a.col2,b.col2));return c},b2.b2Math.MulMM=function(a,b){var c=b2.b2Mat22.FromVV(b2.b2Math.MulMV(a,b.col1),b2.b2Math.MulMV(a,b.col2));return c},b2.b2Math.MulTMM=function(a,b){var c=new b2.b2Vec2(b2.b2Math.Dot(a.col1,b.col1),b2.b2Math.Dot(a.col2,b.col1)),d=new b2.b2Vec2(b2.b2Math.Dot(a.col1,b.col2),b2.b2Math.Dot(a.col2,b.col2)),e=b2.b2Mat22.FromVV(c,d);return e},b2.b2Math.Abs=function(a){return a>0?a:-a},b2.b2Math.AbsV=function(a){var b=new b2.b2Vec2(b2.b2Math.Abs(a.x),b2.b2Math.Abs(a.y));return b},b2.b2Math.AbsM=function(a){var b=b2.b2Mat22.FromVV(b2.b2Math.AbsV(a.col1),b2.b2Math.AbsV(a.col2));return b},b2.b2Math.Min=function(a,b){return b>a?a:b},b2.b2Math.MinV=function(a,b){var c=new b2.b2Vec2(b2.b2Math.Min(a.x,b.x),b2.b2Math.Min(a.y,b.y));return c},b2.b2Math.Max=function(a,b){return a>b?a:b},b2.b2Math.MaxV=function(a,b){var c=new b2.b2Vec2(b2.b2Math.Max(a.x,b.x),b2.b2Math.Max(a.y,b.y));return c},b2.b2Math.Clamp=function(a,b,c){return b>a?b:a>c?c:a},b2.b2Math.ClampV=function(a,b,c){return b2.b2Math.MaxV(b,b2.b2Math.MinV(a,c))},b2.b2Math.Swap=function(a,b){var c=a[0];a[0]=b[0],b[0]=c},b2.b2Math.Random=function(){return 2*Math.random()-1},b2.b2Math.RandomRange=function(a,b){var c=Math.random();return c=(b-a)*c+a},b2.b2Math.NextPowerOfTwo=function(a){return a|=a>>1&2147483647,a|=a>>2&1073741823,a|=a>>4&268435455,a|=a>>8&16777215,a|=a>>16&65535,a+1},b2.b2Math.IsPowerOfTwo=function(a){var b=a>0&&0==(a&a-1);return b},b2.b2Math.b2Vec2_zero=new b2.b2Vec2(0,0),b2.b2Math.b2Mat22_identity=b2.b2Mat22.FromVV(new b2.b2Vec2(1,0),new b2.b2Vec2(0,1)),b2.b2Math.b2Transform_identity=new b2.b2Transform(b2.b2Math.b2Vec2_zero,b2.b2Math.b2Mat22_identity),b2.b2PulleyJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2PulleyJoint.prototype,b2.b2Joint.prototype),b2.b2PulleyJoint.prototype._super=b2.b2Joint.prototype,b2.b2PulleyJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]);this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=a.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=a.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=a.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=a.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(a.localAnchorA),this.m_localAnchor2.SetV(a.localAnchorB),this.m_ratio=a.ratio,this.m_constant=a.lengthA+this.m_ratio*a.lengthB,this.m_maxLength1=b2.b2Math.Min(a.maxLengthA,this.m_constant-this.m_ratio*b2.b2PulleyJoint.b2_minPulleyLength),this.m_maxLength2=b2.b2Math.Min(a.maxLengthB,(this.m_constant-b2.b2PulleyJoint.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},b2.b2PulleyJoint.prototype.__varz=function(){this.m_groundAnchor1=new b2.b2Vec2,this.m_groundAnchor2=new b2.b2Vec2,this.m_localAnchor1=new b2.b2Vec2,this.m_localAnchor2=new b2.b2Vec2,this.m_u1=new b2.b2Vec2,this.m_u2=new b2.b2Vec2},b2.b2PulleyJoint.b2_minPulleyLength=2,b2.b2PulleyJoint.prototype.InitVelocityConstraints=function(a){var b,c=this.m_bodyA,d=this.m_bodyB;b=c.m_xf.R;var e=this.m_localAnchor1.x-c.m_sweep.localCenter.x,f=this.m_localAnchor1.y-c.m_sweep.localCenter.y,g=b.col1.x*e+b.col2.x*f;f=b.col1.y*e+b.col2.y*f,e=g,b=d.m_xf.R;var h=this.m_localAnchor2.x-d.m_sweep.localCenter.x,i=this.m_localAnchor2.y-d.m_sweep.localCenter.y;g=b.col1.x*h+b.col2.x*i,i=b.col1.y*h+b.col2.y*i,h=g;var j=c.m_sweep.c.x+e,k=c.m_sweep.c.y+f,l=d.m_sweep.c.x+h,m=d.m_sweep.c.y+i,n=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,o=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,p=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,q=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(j-n,k-o),this.m_u2.Set(l-p,m-q);var r=this.m_u1.Length(),s=this.m_u2.Length();r>b2.b2Settings.b2_linearSlop?this.m_u1.Multiply(1/r):this.m_u1.SetZero(),s>b2.b2Settings.b2_linearSlop?this.m_u2.Multiply(1/s):this.m_u2.SetZero();var t=this.m_constant-r-this.m_ratio*s;t>0?(this.m_state=b2.b2Joint.e_inactiveLimit,this.m_impulse=0):this.m_state=b2.b2Joint.e_atUpperLimit,r<this.m_maxLength1?(this.m_limitState1=b2.b2Joint.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=b2.b2Joint.e_atUpperLimit,s<this.m_maxLength2?(this.m_limitState2=b2.b2Joint.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=b2.b2Joint.e_atUpperLimit;var u=e*this.m_u1.y-f*this.m_u1.x,v=h*this.m_u2.y-i*this.m_u2.x;if(this.m_limitMass1=c.m_invMass+c.m_invI*u*u,this.m_limitMass2=d.m_invMass+d.m_invI*v*v,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,a.warmStarting){this.m_impulse*=a.dtRatio,this.m_limitImpulse1*=a.dtRatio,this.m_limitImpulse2*=a.dtRatio;var w=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,x=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,y=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,z=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;c.m_linearVelocity.x+=c.m_invMass*w,c.m_linearVelocity.y+=c.m_invMass*x,c.m_angularVelocity+=c.m_invI*(e*x-f*w),d.m_linearVelocity.x+=d.m_invMass*y,d.m_linearVelocity.y+=d.m_invMass*z,d.m_angularVelocity+=d.m_invI*(h*z-i*y)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},b2.b2PulleyJoint.prototype.SolveVelocityConstraints=function(a){var b,c=this.m_bodyA,d=this.m_bodyB;b=c.m_xf.R;var e=this.m_localAnchor1.x-c.m_sweep.localCenter.x,f=this.m_localAnchor1.y-c.m_sweep.localCenter.y,g=b.col1.x*e+b.col2.x*f;f=b.col1.y*e+b.col2.y*f,e=g,b=d.m_xf.R;var h=this.m_localAnchor2.x-d.m_sweep.localCenter.x,i=this.m_localAnchor2.y-d.m_sweep.localCenter.y;g=b.col1.x*h+b.col2.x*i,i=b.col1.y*h+b.col2.y*i,h=g;var j,k,l,m,n,o,p,q,r,s,t;this.m_state==b2.b2Joint.e_atUpperLimit&&(j=c.m_linearVelocity.x+-c.m_angularVelocity*f,k=c.m_linearVelocity.y+c.m_angularVelocity*e,l=d.m_linearVelocity.x+-d.m_angularVelocity*i,m=d.m_linearVelocity.y+d.m_angularVelocity*h,r=-(this.m_u1.x*j+this.m_u1.y*k)-this.m_ratio*(this.m_u2.x*l+this.m_u2.y*m),s=this.m_pulleyMass*-r,t=this.m_impulse,this.m_impulse=b2.b2Math.Max(0,this.m_impulse+s),s=this.m_impulse-t,n=-s*this.m_u1.x,o=-s*this.m_u1.y,p=-this.m_ratio*s*this.m_u2.x,q=-this.m_ratio*s*this.m_u2.y,c.m_linearVelocity.x+=c.m_invMass*n,c.m_linearVelocity.y+=c.m_invMass*o,c.m_angularVelocity+=c.m_invI*(e*o-f*n),d.m_linearVelocity.x+=d.m_invMass*p,d.m_linearVelocity.y+=d.m_invMass*q,d.m_angularVelocity+=d.m_invI*(h*q-i*p)),this.m_limitState1==b2.b2Joint.e_atUpperLimit&&(j=c.m_linearVelocity.x+-c.m_angularVelocity*f,k=c.m_linearVelocity.y+c.m_angularVelocity*e,r=-(this.m_u1.x*j+this.m_u1.y*k),s=-this.m_limitMass1*r,t=this.m_limitImpulse1,this.m_limitImpulse1=b2.b2Math.Max(0,this.m_limitImpulse1+s),s=this.m_limitImpulse1-t,n=-s*this.m_u1.x,o=-s*this.m_u1.y,c.m_linearVelocity.x+=c.m_invMass*n,c.m_linearVelocity.y+=c.m_invMass*o,c.m_angularVelocity+=c.m_invI*(e*o-f*n)),this.m_limitState2==b2.b2Joint.e_atUpperLimit&&(l=d.m_linearVelocity.x+-d.m_angularVelocity*i,m=d.m_linearVelocity.y+d.m_angularVelocity*h,r=-(this.m_u2.x*l+this.m_u2.y*m),s=-this.m_limitMass2*r,t=this.m_limitImpulse2,this.m_limitImpulse2=b2.b2Math.Max(0,this.m_limitImpulse2+s),s=this.m_limitImpulse2-t,p=-s*this.m_u2.x,q=-s*this.m_u2.y,d.m_linearVelocity.x+=d.m_invMass*p,d.m_linearVelocity.y+=d.m_invMass*q,d.m_angularVelocity+=d.m_invI*(h*q-i*p))},b2.b2PulleyJoint.prototype.SolvePositionConstraints=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this.m_bodyA,q=this.m_bodyB,r=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,s=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,t=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,u=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,v=0;return this.m_state==b2.b2Joint.e_atUpperLimit&&(b=p.m_xf.R,c=this.m_localAnchor1.x-p.m_sweep.localCenter.x,d=this.m_localAnchor1.y-p.m_sweep.localCenter.y,o=b.col1.x*c+b.col2.x*d,d=b.col1.y*c+b.col2.y*d,c=o,b=q.m_xf.R,e=this.m_localAnchor2.x-q.m_sweep.localCenter.x,f=this.m_localAnchor2.y-q.m_sweep.localCenter.y,o=b.col1.x*e+b.col2.x*f,f=b.col1.y*e+b.col2.y*f,e=o,g=p.m_sweep.c.x+c,h=p.m_sweep.c.y+d,i=q.m_sweep.c.x+e,j=q.m_sweep.c.y+f,this.m_u1.Set(g-r,h-s),this.m_u2.Set(i-t,j-u),k=this.m_u1.Length(),l=this.m_u2.Length(),k>b2.b2Settings.b2_linearSlop?this.m_u1.Multiply(1/k):this.m_u1.SetZero(),l>b2.b2Settings.b2_linearSlop?this.m_u2.Multiply(1/l):this.m_u2.SetZero(),m=this.m_constant-k-this.m_ratio*l,v=b2.b2Math.Max(v,-m),m=b2.b2Math.Clamp(m+b2.b2Settings.b2_linearSlop,-b2.b2Settings.b2_maxLinearCorrection,0),n=-this.m_pulleyMass*m,g=-n*this.m_u1.x,h=-n*this.m_u1.y,i=-this.m_ratio*n*this.m_u2.x,j=-this.m_ratio*n*this.m_u2.y,p.m_sweep.c.x+=p.m_invMass*g,p.m_sweep.c.y+=p.m_invMass*h,p.m_sweep.a+=p.m_invI*(c*h-d*g),q.m_sweep.c.x+=q.m_invMass*i,q.m_sweep.c.y+=q.m_invMass*j,q.m_sweep.a+=q.m_invI*(e*j-f*i),p.SynchronizeTransform(),q.SynchronizeTransform()),this.m_limitState1==b2.b2Joint.e_atUpperLimit&&(b=p.m_xf.R,c=this.m_localAnchor1.x-p.m_sweep.localCenter.x,d=this.m_localAnchor1.y-p.m_sweep.localCenter.y,o=b.col1.x*c+b.col2.x*d,d=b.col1.y*c+b.col2.y*d,c=o,g=p.m_sweep.c.x+c,h=p.m_sweep.c.y+d,this.m_u1.Set(g-r,h-s),k=this.m_u1.Length(),k>b2.b2Settings.b2_linearSlop?(this.m_u1.x*=1/k,this.m_u1.y*=1/k):this.m_u1.SetZero(),m=this.m_maxLength1-k,v=b2.b2Math.Max(v,-m),m=b2.b2Math.Clamp(m+b2.b2Settings.b2_linearSlop,-b2.b2Settings.b2_maxLinearCorrection,0),n=-this.m_limitMass1*m,g=-n*this.m_u1.x,h=-n*this.m_u1.y,p.m_sweep.c.x+=p.m_invMass*g,p.m_sweep.c.y+=p.m_invMass*h,p.m_sweep.a+=p.m_invI*(c*h-d*g),p.SynchronizeTransform()),this.m_limitState2==b2.b2Joint.e_atUpperLimit&&(b=q.m_xf.R,e=this.m_localAnchor2.x-q.m_sweep.localCenter.x,f=this.m_localAnchor2.y-q.m_sweep.localCenter.y,o=b.col1.x*e+b.col2.x*f,f=b.col1.y*e+b.col2.y*f,e=o,i=q.m_sweep.c.x+e,j=q.m_sweep.c.y+f,this.m_u2.Set(i-t,j-u),l=this.m_u2.Length(),l>b2.b2Settings.b2_linearSlop?(this.m_u2.x*=1/l,this.m_u2.y*=1/l):this.m_u2.SetZero(),m=this.m_maxLength2-l,v=b2.b2Math.Max(v,-m),m=b2.b2Math.Clamp(m+b2.b2Settings.b2_linearSlop,-b2.b2Settings.b2_maxLinearCorrection,0),n=-this.m_limitMass2*m,i=-n*this.m_u2.x,j=-n*this.m_u2.y,q.m_sweep.c.x+=q.m_invMass*i,q.m_sweep.c.y+=q.m_invMass*j,q.m_sweep.a+=q.m_invI*(e*j-f*i),q.SynchronizeTransform()),
v<b2.b2Settings.b2_linearSlop},b2.b2PulleyJoint.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},b2.b2PulleyJoint.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},b2.b2PulleyJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*this.m_impulse*this.m_u2.x,a*this.m_impulse*this.m_u2.y)},b2.b2PulleyJoint.prototype.GetReactionTorque=function(a){return 0},b2.b2PulleyJoint.prototype.GetGroundAnchorA=function(){var a=this.m_ground.m_xf.position.Copy();return a.Add(this.m_groundAnchor1),a},b2.b2PulleyJoint.prototype.GetGroundAnchorB=function(){var a=this.m_ground.m_xf.position.Copy();return a.Add(this.m_groundAnchor2),a},b2.b2PulleyJoint.prototype.GetLength1=function(){var a=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),b=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,c=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,d=a.x-b,e=a.y-c;return Math.sqrt(d*d+e*e)},b2.b2PulleyJoint.prototype.GetLength2=function(){var a=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),b=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,c=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,d=a.x-b,e=a.y-c;return Math.sqrt(d*d+e*e)},b2.b2PulleyJoint.prototype.GetRatio=function(){return this.m_ratio},b2.b2PulleyJoint.prototype.m_ground=null,b2.b2PulleyJoint.prototype.m_groundAnchor1=new b2.b2Vec2,b2.b2PulleyJoint.prototype.m_groundAnchor2=new b2.b2Vec2,b2.b2PulleyJoint.prototype.m_localAnchor1=new b2.b2Vec2,b2.b2PulleyJoint.prototype.m_localAnchor2=new b2.b2Vec2,b2.b2PulleyJoint.prototype.m_u1=new b2.b2Vec2,b2.b2PulleyJoint.prototype.m_u2=new b2.b2Vec2,b2.b2PulleyJoint.prototype.m_constant=null,b2.b2PulleyJoint.prototype.m_ratio=null,b2.b2PulleyJoint.prototype.m_maxLength1=null,b2.b2PulleyJoint.prototype.m_maxLength2=null,b2.b2PulleyJoint.prototype.m_pulleyMass=null,b2.b2PulleyJoint.prototype.m_limitMass1=null,b2.b2PulleyJoint.prototype.m_limitMass2=null,b2.b2PulleyJoint.prototype.m_impulse=null,b2.b2PulleyJoint.prototype.m_limitImpulse1=null,b2.b2PulleyJoint.prototype.m_limitImpulse2=null,b2.b2PulleyJoint.prototype.m_state=0,b2.b2PulleyJoint.prototype.m_limitState1=0,b2.b2PulleyJoint.prototype.m_limitState2=0,b2.b2PrismaticJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2PrismaticJoint.prototype,b2.b2Joint.prototype),b2.b2PrismaticJoint.prototype._super=b2.b2Joint.prototype,b2.b2PrismaticJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]);this.m_localAnchor1.SetV(a.localAnchorA),this.m_localAnchor2.SetV(a.localAnchorB),this.m_localXAxis1.SetV(a.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=a.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=a.lowerTranslation,this.m_upperTranslation=a.upperTranslation,this.m_maxMotorForce=a.maxMotorForce,this.m_motorSpeed=a.motorSpeed,this.m_enableLimit=a.enableLimit,this.m_enableMotor=a.enableMotor,this.m_limitState=b2.b2Joint.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},b2.b2PrismaticJoint.prototype.__varz=function(){this.m_localAnchor1=new b2.b2Vec2,this.m_localAnchor2=new b2.b2Vec2,this.m_localXAxis1=new b2.b2Vec2,this.m_localYAxis1=new b2.b2Vec2,this.m_axis=new b2.b2Vec2,this.m_perp=new b2.b2Vec2,this.m_K=new b2.b2Mat33,this.m_impulse=new b2.b2Vec3},b2.b2PrismaticJoint.prototype.InitVelocityConstraints=function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;this.m_localCenterA.SetV(d.GetLocalCenter()),this.m_localCenterB.SetV(e.GetLocalCenter());var f=d.GetTransform();e.GetTransform();b=d.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,h=this.m_localAnchor1.y-this.m_localCenterA.y;c=b.col1.x*g+b.col2.x*h,h=b.col1.y*g+b.col2.y*h,g=c,b=e.m_xf.R;var i=this.m_localAnchor2.x-this.m_localCenterB.x,j=this.m_localAnchor2.y-this.m_localCenterB.y;c=b.col1.x*i+b.col2.x*j,j=b.col1.y*i+b.col2.y*j,i=c;var k=e.m_sweep.c.x+i-d.m_sweep.c.x-g,l=e.m_sweep.c.y+j-d.m_sweep.c.y-h;this.m_invMassA=d.m_invMass,this.m_invMassB=e.m_invMass,this.m_invIA=d.m_invI,this.m_invIB=e.m_invI,this.m_axis.SetV(b2.b2Math.MulMV(f.R,this.m_localXAxis1)),this.m_a1=(k+g)*this.m_axis.y-(l+h)*this.m_axis.x,this.m_a2=i*this.m_axis.y-j*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(b2.b2Math.MulMV(f.R,this.m_localYAxis1)),this.m_s1=(k+g)*this.m_perp.y-(l+h)*this.m_perp.x,this.m_s2=i*this.m_perp.y-j*this.m_perp.x;var m=this.m_invMassA,n=this.m_invMassB,o=this.m_invIA,p=this.m_invIB;if(this.m_K.col1.x=m+n+o*this.m_s1*this.m_s1+p*this.m_s2*this.m_s2,this.m_K.col1.y=o*this.m_s1+p*this.m_s2,this.m_K.col1.z=o*this.m_s1*this.m_a1+p*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=o+p,this.m_K.col2.z=o*this.m_a1+p*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=m+n+o*this.m_a1*this.m_a1+p*this.m_a2*this.m_a2,this.m_enableLimit){var q=this.m_axis.x*k+this.m_axis.y*l;b2.b2Math.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b2.b2Settings.b2_linearSlop?this.m_limitState=b2.b2Joint.e_equalLimits:q<=this.m_lowerTranslation?this.m_limitState!=b2.b2Joint.e_atLowerLimit&&(this.m_limitState=b2.b2Joint.e_atLowerLimit,this.m_impulse.z=0):q>=this.m_upperTranslation?this.m_limitState!=b2.b2Joint.e_atUpperLimit&&(this.m_limitState=b2.b2Joint.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=b2.b2Joint.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=b2.b2Joint.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),a.warmStarting){this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio;var r=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,s=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,t=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,u=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;d.m_linearVelocity.x-=this.m_invMassA*r,d.m_linearVelocity.y-=this.m_invMassA*s,d.m_angularVelocity-=this.m_invIA*t,e.m_linearVelocity.x+=this.m_invMassB*r,e.m_linearVelocity.y+=this.m_invMassB*s,e.m_angularVelocity+=this.m_invIB*u}else this.m_impulse.SetZero(),this.m_motorImpulse=0},b2.b2PrismaticJoint.prototype.SolveVelocityConstraints=function(a){var b,c,d,e,f=this.m_bodyA,g=this.m_bodyB,h=f.m_linearVelocity,i=f.m_angularVelocity,j=g.m_linearVelocity,k=g.m_angularVelocity;if(this.m_enableMotor&&this.m_limitState!=b2.b2Joint.e_equalLimits){var l=this.m_axis.x*(j.x-h.x)+this.m_axis.y*(j.y-h.y)+this.m_a2*k-this.m_a1*i,m=this.m_motorMass*(this.m_motorSpeed-l),n=this.m_motorImpulse,o=a.dt*this.m_maxMotorForce;this.m_motorImpulse=b2.b2Math.Clamp(this.m_motorImpulse+m,-o,o),m=this.m_motorImpulse-n,b=m*this.m_axis.x,c=m*this.m_axis.y,d=m*this.m_a1,e=m*this.m_a2,h.x-=this.m_invMassA*b,h.y-=this.m_invMassA*c,i-=this.m_invIA*d,j.x+=this.m_invMassB*b,j.y+=this.m_invMassB*c,k+=this.m_invIB*e}var p=this.m_perp.x*(j.x-h.x)+this.m_perp.y*(j.y-h.y)+this.m_s2*k-this.m_s1*i,q=k-i;if(this.m_enableLimit&&this.m_limitState!=b2.b2Joint.e_inactiveLimit){var r=this.m_axis.x*(j.x-h.x)+this.m_axis.y*(j.y-h.y)+this.m_a2*k-this.m_a1*i,s=this.m_impulse.Copy(),t=this.m_K.Solve33(new b2.b2Vec3,-p,-q,-r);this.m_impulse.Add(t),this.m_limitState==b2.b2Joint.e_atLowerLimit?this.m_impulse.z=b2.b2Math.Max(this.m_impulse.z,0):this.m_limitState==b2.b2Joint.e_atUpperLimit&&(this.m_impulse.z=b2.b2Math.Min(this.m_impulse.z,0));var u=-p-(this.m_impulse.z-s.z)*this.m_K.col3.x,v=-q-(this.m_impulse.z-s.z)*this.m_K.col3.y,w=this.m_K.Solve22(new b2.b2Vec2,u,v);w.x+=s.x,w.y+=s.y,this.m_impulse.x=w.x,this.m_impulse.y=w.y,t.x=this.m_impulse.x-s.x,t.y=this.m_impulse.y-s.y,t.z=this.m_impulse.z-s.z,b=t.x*this.m_perp.x+t.z*this.m_axis.x,c=t.x*this.m_perp.y+t.z*this.m_axis.y,d=t.x*this.m_s1+t.y+t.z*this.m_a1,e=t.x*this.m_s2+t.y+t.z*this.m_a2,h.x-=this.m_invMassA*b,h.y-=this.m_invMassA*c,i-=this.m_invIA*d,j.x+=this.m_invMassB*b,j.y+=this.m_invMassB*c,k+=this.m_invIB*e}else{var x=this.m_K.Solve22(new b2.b2Vec2,-p,-q);this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,b=x.x*this.m_perp.x,c=x.x*this.m_perp.y,d=x.x*this.m_s1+x.y,e=x.x*this.m_s2+x.y,h.x-=this.m_invMassA*b,h.y-=this.m_invMassA*c,i-=this.m_invIA*d,j.x+=this.m_invMassB*b,j.y+=this.m_invMassB*c,k+=this.m_invIB*e}f.m_linearVelocity.SetV(h),f.m_angularVelocity=i,g.m_linearVelocity.SetV(j),g.m_angularVelocity=k},b2.b2PrismaticJoint.prototype.SolvePositionConstraints=function(a){var b,c,d,e,f,g,h=this.m_bodyA,i=this.m_bodyB,j=h.m_sweep.c,k=h.m_sweep.a,l=i.m_sweep.c,m=i.m_sweep.a,n=0,o=0,p=!1,q=0,r=b2.b2Mat22.FromAngle(k),s=b2.b2Mat22.FromAngle(m);b=r;var t=this.m_localAnchor1.x-this.m_localCenterA.x,u=this.m_localAnchor1.y-this.m_localCenterA.y;c=b.col1.x*t+b.col2.x*u,u=b.col1.y*t+b.col2.y*u,t=c,b=s;var v=this.m_localAnchor2.x-this.m_localCenterB.x,w=this.m_localAnchor2.y-this.m_localCenterB.y;c=b.col1.x*v+b.col2.x*w,w=b.col1.y*v+b.col2.y*w,v=c;var x=l.x+v-j.x-t,y=l.y+w-j.y-u;if(this.m_enableLimit){this.m_axis=b2.b2Math.MulMV(r,this.m_localXAxis1),this.m_a1=(x+t)*this.m_axis.y-(y+u)*this.m_axis.x,this.m_a2=v*this.m_axis.y-w*this.m_axis.x;var z=this.m_axis.x*x+this.m_axis.y*y;b2.b2Math.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b2.b2Settings.b2_linearSlop?(q=b2.b2Math.Clamp(z,-b2.b2Settings.b2_maxLinearCorrection,b2.b2Settings.b2_maxLinearCorrection),n=b2.b2Math.Abs(z),p=!0):z<=this.m_lowerTranslation?(q=b2.b2Math.Clamp(z-this.m_lowerTranslation+b2.b2Settings.b2_linearSlop,-b2.b2Settings.b2_maxLinearCorrection,0),n=this.m_lowerTranslation-z,p=!0):z>=this.m_upperTranslation&&(q=b2.b2Math.Clamp(z-this.m_upperTranslation+b2.b2Settings.b2_linearSlop,0,b2.b2Settings.b2_maxLinearCorrection),n=z-this.m_upperTranslation,p=!0)}this.m_perp=b2.b2Math.MulMV(r,this.m_localYAxis1),this.m_s1=(x+t)*this.m_perp.y-(y+u)*this.m_perp.x,this.m_s2=v*this.m_perp.y-w*this.m_perp.x;var A=new b2.b2Vec3,B=this.m_perp.x*x+this.m_perp.y*y,C=m-k-this.m_refAngle;if(n=b2.b2Math.Max(n,b2.b2Math.Abs(B)),o=b2.b2Math.Abs(C),p)d=this.m_invMassA,e=this.m_invMassB,f=this.m_invIA,g=this.m_invIB,this.m_K.col1.x=d+e+f*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,this.m_K.col1.y=f*this.m_s1+g*this.m_s2,this.m_K.col1.z=f*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=f+g,this.m_K.col2.z=f*this.m_a1+g*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=d+e+f*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_K.Solve33(A,-B,-C,-q);else{d=this.m_invMassA,e=this.m_invMassB,f=this.m_invIA,g=this.m_invIB;var D=d+e+f*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,E=f*this.m_s1+g*this.m_s2,F=f+g;this.m_K.col1.Set(D,E,0),this.m_K.col2.Set(E,F,0);var G=this.m_K.Solve22(new b2.b2Vec2,-B,-C);A.x=G.x,A.y=G.y,A.z=0}var H=A.x*this.m_perp.x+A.z*this.m_axis.x,I=A.x*this.m_perp.y+A.z*this.m_axis.y,J=A.x*this.m_s1+A.y+A.z*this.m_a1,K=A.x*this.m_s2+A.y+A.z*this.m_a2;return j.x-=this.m_invMassA*H,j.y-=this.m_invMassA*I,k-=this.m_invIA*J,l.x+=this.m_invMassB*H,l.y+=this.m_invMassB*I,m+=this.m_invIB*K,h.m_sweep.a=k,i.m_sweep.a=m,h.SynchronizeTransform(),i.SynchronizeTransform(),n<=b2.b2Settings.b2_linearSlop&&o<=b2.b2Settings.b2_angularSlop},b2.b2PrismaticJoint.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},b2.b2PrismaticJoint.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},b2.b2PrismaticJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},b2.b2PrismaticJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.y},b2.b2PrismaticJoint.prototype.GetJointTranslation=function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.GetWorldPoint(this.m_localAnchor1),d=b.GetWorldPoint(this.m_localAnchor2),e=d.x-c.x,f=d.y-c.y,g=a.GetWorldVector(this.m_localXAxis1),h=g.x*e+g.y*f;return h},b2.b2PrismaticJoint.prototype.GetJointSpeed=function(){var a,b=this.m_bodyA,c=this.m_bodyB;a=b.m_xf.R;var d=this.m_localAnchor1.x-b.m_sweep.localCenter.x,e=this.m_localAnchor1.y-b.m_sweep.localCenter.y,f=a.col1.x*d+a.col2.x*e;e=a.col1.y*d+a.col2.y*e,d=f,a=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y;f=a.col1.x*g+a.col2.x*h,h=a.col1.y*g+a.col2.y*h,g=f;var i=b.m_sweep.c.x+d,j=b.m_sweep.c.y+e,k=c.m_sweep.c.x+g,l=c.m_sweep.c.y+h,m=k-i,n=l-j,o=b.GetWorldVector(this.m_localXAxis1),p=b.m_linearVelocity,q=c.m_linearVelocity,r=b.m_angularVelocity,s=c.m_angularVelocity,t=m*-r*o.y+n*r*o.x+(o.x*(q.x+-s*h-p.x- -r*e)+o.y*(q.y+s*g-p.y-r*d));return t},b2.b2PrismaticJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit},b2.b2PrismaticJoint.prototype.EnableLimit=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=a},b2.b2PrismaticJoint.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},b2.b2PrismaticJoint.prototype.GetUpperLimit=function(){return this.m_upperTranslation},b2.b2PrismaticJoint.prototype.SetLimits=function(a,b){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=a,this.m_upperTranslation=b},b2.b2PrismaticJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor},b2.b2PrismaticJoint.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=a},b2.b2PrismaticJoint.prototype.SetMotorSpeed=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=a},b2.b2PrismaticJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},b2.b2PrismaticJoint.prototype.SetMaxMotorForce=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=a},b2.b2PrismaticJoint.prototype.GetMotorForce=function(){return this.m_motorImpulse},b2.b2PrismaticJoint.prototype.m_localAnchor1=new b2.b2Vec2,b2.b2PrismaticJoint.prototype.m_localAnchor2=new b2.b2Vec2,b2.b2PrismaticJoint.prototype.m_localXAxis1=new b2.b2Vec2,b2.b2PrismaticJoint.prototype.m_localYAxis1=new b2.b2Vec2,b2.b2PrismaticJoint.prototype.m_refAngle=null,b2.b2PrismaticJoint.prototype.m_axis=new b2.b2Vec2,b2.b2PrismaticJoint.prototype.m_perp=new b2.b2Vec2,b2.b2PrismaticJoint.prototype.m_s1=null,b2.b2PrismaticJoint.prototype.m_s2=null,b2.b2PrismaticJoint.prototype.m_a1=null,b2.b2PrismaticJoint.prototype.m_a2=null,b2.b2PrismaticJoint.prototype.m_K=new b2.b2Mat33,b2.b2PrismaticJoint.prototype.m_impulse=new b2.b2Vec3,b2.b2PrismaticJoint.prototype.m_motorMass=null,b2.b2PrismaticJoint.prototype.m_motorImpulse=null,b2.b2PrismaticJoint.prototype.m_lowerTranslation=null,b2.b2PrismaticJoint.prototype.m_upperTranslation=null,b2.b2PrismaticJoint.prototype.m_maxMotorForce=null,b2.b2PrismaticJoint.prototype.m_motorSpeed=null,b2.b2PrismaticJoint.prototype.m_enableLimit=null,b2.b2PrismaticJoint.prototype.m_enableMotor=null,b2.b2PrismaticJoint.prototype.m_limitState=0,b2.b2RevoluteJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2RevoluteJoint.prototype,b2.b2Joint.prototype),b2.b2RevoluteJoint.prototype._super=b2.b2Joint.prototype,b2.b2RevoluteJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]),this.m_localAnchor1.SetV(a.localAnchorA),this.m_localAnchor2.SetV(a.localAnchorB),this.m_referenceAngle=a.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=a.lowerAngle,this.m_upperAngle=a.upperAngle,this.m_maxMotorTorque=a.maxMotorTorque,this.m_motorSpeed=a.motorSpeed,this.m_enableLimit=a.enableLimit,this.m_enableMotor=a.enableMotor,this.m_limitState=b2.b2Joint.e_inactiveLimit},b2.b2RevoluteJoint.prototype.__varz=function(){this.K=new b2.b2Mat22,this.K1=new b2.b2Mat22,this.K2=new b2.b2Mat22,this.K3=new b2.b2Mat22,this.impulse3=new b2.b2Vec3,this.impulse2=new b2.b2Vec2,this.reduced=new b2.b2Vec2,this.m_localAnchor1=new b2.b2Vec2,this.m_localAnchor2=new b2.b2Vec2,this.m_impulse=new b2.b2Vec3,this.m_mass=new b2.b2Mat33},b2.b2RevoluteJoint.tImpulse=new b2.b2Vec2,b2.b2RevoluteJoint.prototype.InitVelocityConstraints=function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;this.m_enableMotor||this.m_enableLimit,b=d.m_xf.R;var f=this.m_localAnchor1.x-d.m_sweep.localCenter.x,g=this.m_localAnchor1.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g,g=b.col1.y*f+b.col2.y*g,f=c,b=e.m_xf.R;var h=this.m_localAnchor2.x-e.m_sweep.localCenter.x,i=this.m_localAnchor2.y-e.m_sweep.localCenter.y;c=b.col1.x*h+b.col2.x*i,i=b.col1.y*h+b.col2.y*i,h=c;var j=d.m_invMass,k=e.m_invMass,l=d.m_invI,m=e.m_invI;if(this.m_mass.col1.x=j+k+g*g*l+i*i*m,this.m_mass.col2.x=-g*f*l-i*h*m,this.m_mass.col3.x=-g*l-i*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=j+k+f*f*l+h*h*m,this.m_mass.col3.y=f*l+h*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=l+m,this.m_motorMass=1/(l+m),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var n=e.m_sweep.a-d.m_sweep.a-this.m_referenceAngle;b2.b2Math.Abs(this.m_upperAngle-this.m_lowerAngle)<2*b2.b2Settings.b2_angularSlop?this.m_limitState=b2.b2Joint.e_equalLimits:n<=this.m_lowerAngle?(this.m_limitState!=b2.b2Joint.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=b2.b2Joint.e_atLowerLimit):n>=this.m_upperAngle?(this.m_limitState!=b2.b2Joint.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=b2.b2Joint.e_atUpperLimit):(this.m_limitState=b2.b2Joint.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=b2.b2Joint.e_inactiveLimit;if(a.warmStarting){this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio;var o=this.m_impulse.x,p=this.m_impulse.y;d.m_linearVelocity.x-=j*o,d.m_linearVelocity.y-=j*p,d.m_angularVelocity-=l*(f*p-g*o+this.m_motorImpulse+this.m_impulse.z),e.m_linearVelocity.x+=k*o,e.m_linearVelocity.y+=k*p,e.m_angularVelocity+=m*(h*p-i*o+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},b2.b2RevoluteJoint.prototype.SolveVelocityConstraints=function(a){var b,c,d,e,f,g,h,i=this.m_bodyA,j=this.m_bodyB,k=i.m_linearVelocity,l=i.m_angularVelocity,m=j.m_linearVelocity,n=j.m_angularVelocity,o=i.m_invMass,p=j.m_invMass,q=i.m_invI,r=j.m_invI;if(this.m_enableMotor&&this.m_limitState!=b2.b2Joint.e_equalLimits){var s=n-l-this.m_motorSpeed,t=this.m_motorMass*-s,u=this.m_motorImpulse,v=a.dt*this.m_maxMotorTorque;this.m_motorImpulse=b2.b2Math.Clamp(this.m_motorImpulse+t,-v,v),t=this.m_motorImpulse-u,l-=q*t,n+=r*t}if(this.m_enableLimit&&this.m_limitState!=b2.b2Joint.e_inactiveLimit){b=i.m_xf.R,e=this.m_localAnchor1.x-i.m_sweep.localCenter.x,f=this.m_localAnchor1.y-i.m_sweep.localCenter.y,c=b.col1.x*e+b.col2.x*f,f=b.col1.y*e+b.col2.y*f,e=c,b=j.m_xf.R,g=this.m_localAnchor2.x-j.m_sweep.localCenter.x,h=this.m_localAnchor2.y-j.m_sweep.localCenter.y,c=b.col1.x*g+b.col2.x*h,h=b.col1.y*g+b.col2.y*h,g=c;var w=m.x+-n*h-k.x- -l*f,x=m.y+n*g-k.y-l*e,y=n-l;this.m_mass.Solve33(this.impulse3,-w,-x,-y),this.m_limitState==b2.b2Joint.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==b2.b2Joint.e_atLowerLimit?(d=this.m_impulse.z+this.impulse3.z,0>d&&(this.m_mass.Solve22(this.reduced,-w,-x),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==b2.b2Joint.e_atUpperLimit&&(d=this.m_impulse.z+this.impulse3.z,d>0&&(this.m_mass.Solve22(this.reduced,-w,-x),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)),k.x-=o*this.impulse3.x,k.y-=o*this.impulse3.y,l-=q*(e*this.impulse3.y-f*this.impulse3.x+this.impulse3.z),m.x+=p*this.impulse3.x,m.y+=p*this.impulse3.y,n+=r*(g*this.impulse3.y-h*this.impulse3.x+this.impulse3.z)}else{b=i.m_xf.R,e=this.m_localAnchor1.x-i.m_sweep.localCenter.x,f=this.m_localAnchor1.y-i.m_sweep.localCenter.y,c=b.col1.x*e+b.col2.x*f,f=b.col1.y*e+b.col2.y*f,e=c,b=j.m_xf.R,g=this.m_localAnchor2.x-j.m_sweep.localCenter.x,h=this.m_localAnchor2.y-j.m_sweep.localCenter.y,c=b.col1.x*g+b.col2.x*h,h=b.col1.y*g+b.col2.y*h,g=c;var z=m.x+-n*h-k.x- -l*f,A=m.y+n*g-k.y-l*e;this.m_mass.Solve22(this.impulse2,-z,-A),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,k.x-=o*this.impulse2.x,k.y-=o*this.impulse2.y,l-=q*(e*this.impulse2.y-f*this.impulse2.x),m.x+=p*this.impulse2.x,m.y+=p*this.impulse2.y,n+=r*(g*this.impulse2.y-h*this.impulse2.x)}i.m_linearVelocity.SetV(k),i.m_angularVelocity=l,j.m_linearVelocity.SetV(m),j.m_angularVelocity=n},b2.b2RevoluteJoint.prototype.SolvePositionConstraints=function(a){var b,c,d,e,f,g=this.m_bodyA,h=this.m_bodyB,i=0,j=0;if(this.m_enableLimit&&this.m_limitState!=b2.b2Joint.e_inactiveLimit){var k=h.m_sweep.a-g.m_sweep.a-this.m_referenceAngle,l=0;this.m_limitState==b2.b2Joint.e_equalLimits?(b=b2.b2Math.Clamp(k-this.m_lowerAngle,-b2.b2Settings.b2_maxAngularCorrection,b2.b2Settings.b2_maxAngularCorrection),l=-this.m_motorMass*b,i=b2.b2Math.Abs(b)):this.m_limitState==b2.b2Joint.e_atLowerLimit?(b=k-this.m_lowerAngle,i=-b,b=b2.b2Math.Clamp(b+b2.b2Settings.b2_angularSlop,-b2.b2Settings.b2_maxAngularCorrection,0),l=-this.m_motorMass*b):this.m_limitState==b2.b2Joint.e_atUpperLimit&&(b=k-this.m_upperAngle,i=b,b=b2.b2Math.Clamp(b-b2.b2Settings.b2_angularSlop,0,b2.b2Settings.b2_maxAngularCorrection),l=-this.m_motorMass*b),g.m_sweep.a-=g.m_invI*l,h.m_sweep.a+=h.m_invI*l,g.SynchronizeTransform(),h.SynchronizeTransform()}c=g.m_xf.R;var m=this.m_localAnchor1.x-g.m_sweep.localCenter.x,n=this.m_localAnchor1.y-g.m_sweep.localCenter.y;d=c.col1.x*m+c.col2.x*n,n=c.col1.y*m+c.col2.y*n,m=d,c=h.m_xf.R;var o=this.m_localAnchor2.x-h.m_sweep.localCenter.x,p=this.m_localAnchor2.y-h.m_sweep.localCenter.y;d=c.col1.x*o+c.col2.x*p,p=c.col1.y*o+c.col2.y*p,o=d;var q=h.m_sweep.c.x+o-g.m_sweep.c.x-m,r=h.m_sweep.c.y+p-g.m_sweep.c.y-n,s=q*q+r*r,t=Math.sqrt(s);j=t;var u=g.m_invMass,v=h.m_invMass,w=g.m_invI,x=h.m_invI,y=10*b2.b2Settings.b2_linearSlop;if(s>y*y){var z=u+v,A=1/z;e=A*-q,f=A*-r;var B=.5;g.m_sweep.c.x-=B*u*e,g.m_sweep.c.y-=B*u*f,h.m_sweep.c.x+=B*v*e,h.m_sweep.c.y+=B*v*f,q=h.m_sweep.c.x+o-g.m_sweep.c.x-m,r=h.m_sweep.c.y+p-g.m_sweep.c.y-n}return this.K1.col1.x=u+v,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=u+v,this.K2.col1.x=w*n*n,this.K2.col2.x=-w*m*n,this.K2.col1.y=-w*m*n,this.K2.col2.y=w*m*m,this.K3.col1.x=x*p*p,this.K3.col2.x=-x*o*p,this.K3.col1.y=-x*o*p,this.K3.col2.y=x*o*o,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(b2.b2RevoluteJoint.tImpulse,-q,-r),e=b2.b2RevoluteJoint.tImpulse.x,f=b2.b2RevoluteJoint.tImpulse.y,g.m_sweep.c.x-=g.m_invMass*e,g.m_sweep.c.y-=g.m_invMass*f,g.m_sweep.a-=g.m_invI*(m*f-n*e),h.m_sweep.c.x+=h.m_invMass*e,h.m_sweep.c.y+=h.m_invMass*f,h.m_sweep.a+=h.m_invI*(o*f-p*e),g.SynchronizeTransform(),h.SynchronizeTransform(),j<=b2.b2Settings.b2_linearSlop&&i<=b2.b2Settings.b2_angularSlop},b2.b2RevoluteJoint.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},b2.b2RevoluteJoint.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},b2.b2RevoluteJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*this.m_impulse.x,a*this.m_impulse.y)},b2.b2RevoluteJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.z},b2.b2RevoluteJoint.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},b2.b2RevoluteJoint.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},b2.b2RevoluteJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit},b2.b2RevoluteJoint.prototype.EnableLimit=function(a){this.m_enableLimit=a},b2.b2RevoluteJoint.prototype.GetLowerLimit=function(){return this.m_lowerAngle},b2.b2RevoluteJoint.prototype.GetUpperLimit=function(){return this.m_upperAngle},b2.b2RevoluteJoint.prototype.SetLimits=function(a,b){this.m_lowerAngle=a,this.m_upperAngle=b},b2.b2RevoluteJoint.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},b2.b2RevoluteJoint.prototype.EnableMotor=function(a){this.m_enableMotor=a},b2.b2RevoluteJoint.prototype.SetMotorSpeed=function(a){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=a},b2.b2RevoluteJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},b2.b2RevoluteJoint.prototype.SetMaxMotorTorque=function(a){this.m_maxMotorTorque=a},b2.b2RevoluteJoint.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},b2.b2RevoluteJoint.prototype.K=new b2.b2Mat22,b2.b2RevoluteJoint.prototype.K1=new b2.b2Mat22,b2.b2RevoluteJoint.prototype.K2=new b2.b2Mat22,b2.b2RevoluteJoint.prototype.K3=new b2.b2Mat22,b2.b2RevoluteJoint.prototype.impulse3=new b2.b2Vec3,b2.b2RevoluteJoint.prototype.impulse2=new b2.b2Vec2,b2.b2RevoluteJoint.prototype.reduced=new b2.b2Vec2,b2.b2RevoluteJoint.prototype.m_localAnchor1=new b2.b2Vec2,b2.b2RevoluteJoint.prototype.m_localAnchor2=new b2.b2Vec2,b2.b2RevoluteJoint.prototype.m_impulse=new b2.b2Vec3,b2.b2RevoluteJoint.prototype.m_motorImpulse=null,b2.b2RevoluteJoint.prototype.m_mass=new b2.b2Mat33,b2.b2RevoluteJoint.prototype.m_motorMass=null,b2.b2RevoluteJoint.prototype.m_enableMotor=null,b2.b2RevoluteJoint.prototype.m_maxMotorTorque=null,b2.b2RevoluteJoint.prototype.m_motorSpeed=null,b2.b2RevoluteJoint.prototype.m_enableLimit=null,b2.b2RevoluteJoint.prototype.m_referenceAngle=null,b2.b2RevoluteJoint.prototype.m_lowerAngle=null,b2.b2RevoluteJoint.prototype.m_upperAngle=null,b2.b2RevoluteJoint.prototype.m_limitState=0,b2.b2JointDef=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2JointDef.prototype.__constructor=function(){this.type=b2.b2Joint.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},b2.b2JointDef.prototype.__varz=function(){},b2.b2JointDef.prototype.type=0,b2.b2JointDef.prototype.userData=null,b2.b2JointDef.prototype.bodyA=null,b2.b2JointDef.prototype.bodyB=null,b2.b2JointDef.prototype.collideConnected=null,b2.b2LineJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2LineJointDef.prototype,b2.b2JointDef.prototype),b2.b2LineJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2LineJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},b2.b2LineJointDef.prototype.__varz=function(){this.localAnchorA=new b2.b2Vec2,this.localAnchorB=new b2.b2Vec2,this.localAxisA=new b2.b2Vec2},b2.b2LineJointDef.prototype.Initialize=function(a,b,c,d){this.bodyA=a,this.bodyB=b,this.localAnchorA=this.bodyA.GetLocalPoint(c),this.localAnchorB=this.bodyB.GetLocalPoint(c),this.localAxisA=this.bodyA.GetLocalVector(d)},b2.b2LineJointDef.prototype.localAnchorA=new b2.b2Vec2,b2.b2LineJointDef.prototype.localAnchorB=new b2.b2Vec2,b2.b2LineJointDef.prototype.localAxisA=new b2.b2Vec2,b2.b2LineJointDef.prototype.enableLimit=null,b2.b2LineJointDef.prototype.lowerTranslation=null,b2.b2LineJointDef.prototype.upperTranslation=null,b2.b2LineJointDef.prototype.enableMotor=null,b2.b2LineJointDef.prototype.maxMotorForce=null,b2.b2LineJointDef.prototype.motorSpeed=null,b2.b2DistanceJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2DistanceJoint.prototype,b2.b2Joint.prototype),b2.b2DistanceJoint.prototype._super=b2.b2Joint.prototype,b2.b2DistanceJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]);this.m_localAnchor1.SetV(a.localAnchorA),this.m_localAnchor2.SetV(a.localAnchorB),this.m_length=a.length,this.m_frequencyHz=a.frequencyHz,this.m_dampingRatio=a.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},b2.b2DistanceJoint.prototype.__varz=function(){this.m_localAnchor1=new b2.b2Vec2,this.m_localAnchor2=new b2.b2Vec2,this.m_u=new b2.b2Vec2},b2.b2DistanceJoint.prototype.InitVelocityConstraints=function(a){var b,c,d,e,f,g,h,i,j,k,l=this.m_bodyA,m=this.m_bodyB;if(b=l.m_xf.R,d=this.m_localAnchor1.x-l.m_sweep.localCenter.x,e=this.m_localAnchor1.y-l.m_sweep.localCenter.y,c=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=c,b=m.m_xf.R,f=this.m_localAnchor2.x-m.m_sweep.localCenter.x,g=this.m_localAnchor2.y-m.m_sweep.localCenter.y,c=b.col1.x*f+b.col2.x*g,g=b.col1.y*f+b.col2.y*g,f=c,this.m_u.x=m.m_sweep.c.x+f-l.m_sweep.c.x-d,this.m_u.y=m.m_sweep.c.y+g-l.m_sweep.c.y-e,h=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y),h>b2.b2Settings.b2_linearSlop?this.m_u.Multiply(1/h):this.m_u.SetZero(),i=d*this.m_u.y-e*this.m_u.x,j=f*this.m_u.y-g*this.m_u.x,k=l.m_invMass+l.m_invI*i*i+m.m_invMass+m.m_invI*j*j,this.m_mass=0!=k?1/k:0,this.m_frequencyHz>0){var n=h-this.m_length,o=2*Math.PI*this.m_frequencyHz,p=2*this.m_mass*this.m_dampingRatio*o,q=this.m_mass*o*o;this.m_gamma=a.dt*(p+a.dt*q),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=n*a.dt*q*this.m_gamma,this.m_mass=k+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(a.warmStarting){this.m_impulse*=a.dtRatio;var r=this.m_impulse*this.m_u.x,s=this.m_impulse*this.m_u.y;l.m_linearVelocity.x-=l.m_invMass*r,l.m_linearVelocity.y-=l.m_invMass*s,l.m_angularVelocity-=l.m_invI*(d*s-e*r),m.m_linearVelocity.x+=m.m_invMass*r,m.m_linearVelocity.y+=m.m_invMass*s,m.m_angularVelocity+=m.m_invI*(f*s-g*r)}else this.m_impulse=0},b2.b2DistanceJoint.prototype.SolveVelocityConstraints=function(a){var b,c,d,e,f,g,h,i,j,k=this.m_bodyA,l=this.m_bodyB,m=k.m_xf.R,n=l.m_xf.R,o=this.m_localAnchor1.x-k.m_sweep.localCenter.x,p=this.m_localAnchor1.y-k.m_sweep.localCenter.y,q=this.m_localAnchor2.x-l.m_sweep.localCenter.x,r=this.m_localAnchor2.y-l.m_sweep.localCenter.y;b=m.col1.x*o+m.col2.x*p,p=m.col1.y*o+m.col2.y*p,o=b,b=n.col1.x*q+n.col2.x*r,r=n.col1.y*q+n.col2.y*r,q=b,c=k.m_linearVelocity.x+-k.m_angularVelocity*p,d=k.m_linearVelocity.y+k.m_angularVelocity*o,e=l.m_linearVelocity.x+-l.m_angularVelocity*r,f=l.m_linearVelocity.y+l.m_angularVelocity*q,g=this.m_u.x*(e-c)+this.m_u.y*(f-d),h=-this.m_mass*(g+this.m_bias+this.m_gamma*this.m_impulse),this.m_impulse+=h,i=h*this.m_u.x,j=h*this.m_u.y,k.m_linearVelocity.x-=k.m_invMass*i,k.m_linearVelocity.y-=k.m_invMass*j,k.m_angularVelocity-=k.m_invI*(o*j-p*i),l.m_linearVelocity.x+=l.m_invMass*i,l.m_linearVelocity.y+=l.m_invMass*j,l.m_angularVelocity+=l.m_invI*(q*j-r*i)},b2.b2DistanceJoint.prototype.SolvePositionConstraints=function(a){var b;if(this.m_frequencyHz>0)return!0;var c=this.m_bodyA,d=this.m_bodyB;b=c.m_xf.R;var e=this.m_localAnchor1.x-c.m_sweep.localCenter.x,f=this.m_localAnchor1.y-c.m_sweep.localCenter.y,g=b.col1.x*e+b.col2.x*f;f=b.col1.y*e+b.col2.y*f,e=g,b=d.m_xf.R;var h=this.m_localAnchor2.x-d.m_sweep.localCenter.x,i=this.m_localAnchor2.y-d.m_sweep.localCenter.y;g=b.col1.x*h+b.col2.x*i,i=b.col1.y*h+b.col2.y*i,h=g;var j=d.m_sweep.c.x+h-c.m_sweep.c.x-e,k=d.m_sweep.c.y+i-c.m_sweep.c.y-f,l=Math.sqrt(j*j+k*k);j/=l,k/=l;var m=l-this.m_length;m=b2.b2Math.Clamp(m,-b2.b2Settings.b2_maxLinearCorrection,b2.b2Settings.b2_maxLinearCorrection);var n=-this.m_mass*m;this.m_u.Set(j,k);var o=n*this.m_u.x,p=n*this.m_u.y;return c.m_sweep.c.x-=c.m_invMass*o,c.m_sweep.c.y-=c.m_invMass*p,c.m_sweep.a-=c.m_invI*(e*p-f*o),d.m_sweep.c.x+=d.m_invMass*o,d.m_sweep.c.y+=d.m_invMass*p,d.m_sweep.a+=d.m_invI*(h*p-i*o),c.SynchronizeTransform(),d.SynchronizeTransform(),
b2.b2Math.Abs(m)<b2.b2Settings.b2_linearSlop},b2.b2DistanceJoint.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},b2.b2DistanceJoint.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},b2.b2DistanceJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)},b2.b2DistanceJoint.prototype.GetReactionTorque=function(a){return 0},b2.b2DistanceJoint.prototype.GetLength=function(){return this.m_length},b2.b2DistanceJoint.prototype.SetLength=function(a){this.m_length=a},b2.b2DistanceJoint.prototype.GetFrequency=function(){return this.m_frequencyHz},b2.b2DistanceJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a},b2.b2DistanceJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio},b2.b2DistanceJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a},b2.b2DistanceJoint.prototype.m_localAnchor1=new b2.b2Vec2,b2.b2DistanceJoint.prototype.m_localAnchor2=new b2.b2Vec2,b2.b2DistanceJoint.prototype.m_u=new b2.b2Vec2,b2.b2DistanceJoint.prototype.m_frequencyHz=null,b2.b2DistanceJoint.prototype.m_dampingRatio=null,b2.b2DistanceJoint.prototype.m_gamma=null,b2.b2DistanceJoint.prototype.m_bias=null,b2.b2DistanceJoint.prototype.m_impulse=null,b2.b2DistanceJoint.prototype.m_mass=null,b2.b2DistanceJoint.prototype.m_length=null,b2.b2PulleyJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2PulleyJointDef.prototype,b2.b2JointDef.prototype),b2.b2PulleyJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2PulleyJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},b2.b2PulleyJointDef.prototype.__varz=function(){this.groundAnchorA=new b2.b2Vec2,this.groundAnchorB=new b2.b2Vec2,this.localAnchorA=new b2.b2Vec2,this.localAnchorB=new b2.b2Vec2},b2.b2PulleyJointDef.prototype.Initialize=function(a,b,c,d,e,f,g){this.bodyA=a,this.bodyB=b,this.groundAnchorA.SetV(c),this.groundAnchorB.SetV(d),this.localAnchorA=this.bodyA.GetLocalPoint(e),this.localAnchorB=this.bodyB.GetLocalPoint(f);var h=e.x-c.x,i=e.y-c.y;this.lengthA=Math.sqrt(h*h+i*i);var j=f.x-d.x,k=f.y-d.y;this.lengthB=Math.sqrt(j*j+k*k),this.ratio=g;var l=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=l-this.ratio*b2.b2PulleyJoint.b2_minPulleyLength,this.maxLengthB=(l-b2.b2PulleyJoint.b2_minPulleyLength)/this.ratio},b2.b2PulleyJointDef.prototype.groundAnchorA=new b2.b2Vec2,b2.b2PulleyJointDef.prototype.groundAnchorB=new b2.b2Vec2,b2.b2PulleyJointDef.prototype.localAnchorA=new b2.b2Vec2,b2.b2PulleyJointDef.prototype.localAnchorB=new b2.b2Vec2,b2.b2PulleyJointDef.prototype.lengthA=null,b2.b2PulleyJointDef.prototype.maxLengthA=null,b2.b2PulleyJointDef.prototype.lengthB=null,b2.b2PulleyJointDef.prototype.maxLengthB=null,b2.b2PulleyJointDef.prototype.ratio=null,b2.b2DistanceJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2DistanceJointDef.prototype,b2.b2JointDef.prototype),b2.b2DistanceJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2DistanceJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},b2.b2DistanceJointDef.prototype.__varz=function(){this.localAnchorA=new b2.b2Vec2,this.localAnchorB=new b2.b2Vec2},b2.b2DistanceJointDef.prototype.Initialize=function(a,b,c,d){this.bodyA=a,this.bodyB=b,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(d));var e=d.x-c.x,f=d.y-c.y;this.length=Math.sqrt(e*e+f*f),this.frequencyHz=0,this.dampingRatio=0},b2.b2DistanceJointDef.prototype.localAnchorA=new b2.b2Vec2,b2.b2DistanceJointDef.prototype.localAnchorB=new b2.b2Vec2,b2.b2DistanceJointDef.prototype.length=null,b2.b2DistanceJointDef.prototype.frequencyHz=null,b2.b2DistanceJointDef.prototype.dampingRatio=null,b2.b2FrictionJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2FrictionJointDef.prototype,b2.b2JointDef.prototype),b2.b2FrictionJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2FrictionJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_frictionJoint,this.maxForce=0,this.maxTorque=0},b2.b2FrictionJointDef.prototype.__varz=function(){this.localAnchorA=new b2.b2Vec2,this.localAnchorB=new b2.b2Vec2},b2.b2FrictionJointDef.prototype.Initialize=function(a,b,c){this.bodyA=a,this.bodyB=b,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(c))},b2.b2FrictionJointDef.prototype.localAnchorA=new b2.b2Vec2,b2.b2FrictionJointDef.prototype.localAnchorB=new b2.b2Vec2,b2.b2FrictionJointDef.prototype.maxForce=null,b2.b2FrictionJointDef.prototype.maxTorque=null,b2.b2WeldJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2WeldJointDef.prototype,b2.b2JointDef.prototype),b2.b2WeldJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2WeldJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_weldJoint,this.referenceAngle=0},b2.b2WeldJointDef.prototype.__varz=function(){this.localAnchorA=new b2.b2Vec2,this.localAnchorB=new b2.b2Vec2},b2.b2WeldJointDef.prototype.Initialize=function(a,b,c){this.bodyA=a,this.bodyB=b,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(c)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},b2.b2WeldJointDef.prototype.localAnchorA=new b2.b2Vec2,b2.b2WeldJointDef.prototype.localAnchorB=new b2.b2Vec2,b2.b2WeldJointDef.prototype.referenceAngle=null,b2.b2GearJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2GearJointDef.prototype,b2.b2JointDef.prototype),b2.b2GearJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2GearJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},b2.b2GearJointDef.prototype.__varz=function(){},b2.b2GearJointDef.prototype.joint1=null,b2.b2GearJointDef.prototype.joint2=null,b2.b2GearJointDef.prototype.ratio=null,b2.b2Color=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Color.prototype.__constructor=function(a,b,c){this._r=~~(255*b2.b2Math.Clamp(a,0,1)),this._g=~~(255*b2.b2Math.Clamp(b,0,1)),this._b=~~(255*b2.b2Math.Clamp(c,0,1))},b2.b2Color.prototype.__varz=function(){},b2.b2Color.prototype.Set=function(a,b,c){this._r=~~(255*b2.b2Math.Clamp(a,0,1)),this._g=~~(255*b2.b2Math.Clamp(b,0,1)),this._b=~~(255*b2.b2Math.Clamp(c,0,1))},"__defineSetter__"in Object&&"__defineGetter__"in Object?(b2.b2Color.prototype.__defineGetter__("r",function(){return this._r}),b2.b2Color.prototype.__defineSetter__("r",function(a){this._r=~~(255*b2.b2Math.Clamp(a,0,1))}),b2.b2Color.prototype.__defineGetter__("g",function(){return this._g}),b2.b2Color.prototype.__defineSetter__("g",function(a){this._g=~~(255*b2.b2Math.Clamp(a,0,1))}),b2.b2Color.prototype.__defineGetter__("b",function(){return this._b}),b2.b2Color.prototype.__defineSetter__("b",function(a){this._b=~~(255*b2.b2Math.Clamp(a,0,1))}),b2.b2Color.prototype.__defineGetter__("color",function(){return this._r<<16|this._g<<8|this._b})):(Object.defineProperty(b2.b2Color,"r",{get:function(){return this._r},set:function(a){this._r=~~(255*b2.b2Math.Clamp(a,0,1))}}),Object.defineProperty(b2.b2Color,"g",{get:function(){return this._g},set:function(a){this._g=~~(255*b2.b2Math.Clamp(a,0,1))}}),Object.defineProperty(b2.b2Color,"b",{get:function(){return this._b},set:function(a){this._b=~~(255*b2.b2Math.Clamp(a,0,1))}}),Object.defineProperty(b2.b2Color,"color",{get:function(){return this._r<<16|this._g<<8|this._b}})),b2.b2Color.prototype._r=0,b2.b2Color.prototype._g=0,b2.b2Color.prototype._b=0,b2.b2FrictionJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2FrictionJoint.prototype,b2.b2Joint.prototype),b2.b2FrictionJoint.prototype._super=b2.b2Joint.prototype,b2.b2FrictionJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]),this.m_localAnchorA.SetV(a.localAnchorA),this.m_localAnchorB.SetV(a.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=a.maxForce,this.m_maxTorque=a.maxTorque},b2.b2FrictionJoint.prototype.__varz=function(){this.m_localAnchorA=new b2.b2Vec2,this.m_localAnchorB=new b2.b2Vec2,this.m_linearImpulse=new b2.b2Vec2,this.m_linearMass=new b2.b2Mat22},b2.b2FrictionJoint.prototype.InitVelocityConstraints=function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g,g=b.col1.y*f+b.col2.y*g,f=c,b=e.m_xf.R;var h=this.m_localAnchorB.x-e.m_sweep.localCenter.x,i=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*h+b.col2.x*i,i=b.col1.y*h+b.col2.y*i,h=c;var j=d.m_invMass,k=e.m_invMass,l=d.m_invI,m=e.m_invI,n=new b2.b2Mat22;if(n.col1.x=j+k,n.col2.x=0,n.col1.y=0,n.col2.y=j+k,n.col1.x+=l*g*g,n.col2.x+=-l*f*g,n.col1.y+=-l*f*g,n.col2.y+=l*f*f,n.col1.x+=m*i*i,n.col2.x+=-m*h*i,n.col1.y+=-m*h*i,n.col2.y+=m*h*h,n.GetInverse(this.m_linearMass),this.m_angularMass=l+m,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),a.warmStarting){this.m_linearImpulse.x*=a.dtRatio,this.m_linearImpulse.y*=a.dtRatio,this.m_angularImpulse*=a.dtRatio;var o=this.m_linearImpulse;d.m_linearVelocity.x-=j*o.x,d.m_linearVelocity.y-=j*o.y,d.m_angularVelocity-=l*(f*o.y-g*o.x+this.m_angularImpulse),e.m_linearVelocity.x+=k*o.x,e.m_linearVelocity.y+=k*o.y,e.m_angularVelocity+=m*(h*o.y-i*o.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},b2.b2FrictionJoint.prototype.SolveVelocityConstraints=function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB,f=d.m_linearVelocity,g=d.m_angularVelocity,h=e.m_linearVelocity,i=e.m_angularVelocity,j=d.m_invMass,k=e.m_invMass,l=d.m_invI,m=e.m_invI;b=d.m_xf.R;var n=this.m_localAnchorA.x-d.m_sweep.localCenter.x,o=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*n+b.col2.x*o,o=b.col1.y*n+b.col2.y*o,n=c,b=e.m_xf.R;var p=this.m_localAnchorB.x-e.m_sweep.localCenter.x,q=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*p+b.col2.x*q,q=b.col1.y*p+b.col2.y*q,p=c;var r,s=i-g,t=-this.m_angularMass*s,u=this.m_angularImpulse;r=a.dt*this.m_maxTorque,this.m_angularImpulse=b2.b2Math.Clamp(this.m_angularImpulse+t,-r,r),t=this.m_angularImpulse-u,g-=l*t,i+=m*t;var v=h.x-i*q-f.x+g*o,w=h.y+i*p-f.y-g*n,x=b2.b2Math.MulMV(this.m_linearMass,new b2.b2Vec2(-v,-w)),y=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(x),r=a.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>r*r&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(r)),x=b2.b2Math.SubtractVV(this.m_linearImpulse,y),f.x-=j*x.x,f.y-=j*x.y,g-=l*(n*x.y-o*x.x),h.x+=k*x.x,h.y+=k*x.y,i+=m*(p*x.y-q*x.x),d.m_angularVelocity=g,e.m_angularVelocity=i},b2.b2FrictionJoint.prototype.SolvePositionConstraints=function(a){return!0},b2.b2FrictionJoint.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},b2.b2FrictionJoint.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},b2.b2FrictionJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)},b2.b2FrictionJoint.prototype.GetReactionTorque=function(a){return a*this.m_angularImpulse},b2.b2FrictionJoint.prototype.SetMaxForce=function(a){this.m_maxForce=a},b2.b2FrictionJoint.prototype.GetMaxForce=function(){return this.m_maxForce},b2.b2FrictionJoint.prototype.SetMaxTorque=function(a){this.m_maxTorque=a},b2.b2FrictionJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque},b2.b2FrictionJoint.prototype.m_localAnchorA=new b2.b2Vec2,b2.b2FrictionJoint.prototype.m_localAnchorB=new b2.b2Vec2,b2.b2FrictionJoint.prototype.m_linearImpulse=new b2.b2Vec2,b2.b2FrictionJoint.prototype.m_angularImpulse=null,b2.b2FrictionJoint.prototype.m_maxForce=null,b2.b2FrictionJoint.prototype.m_maxTorque=null,b2.b2FrictionJoint.prototype.m_linearMass=new b2.b2Mat22,b2.b2FrictionJoint.prototype.m_angularMass=null,b2.b2Distance=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Distance.prototype.__constructor=function(){},b2.b2Distance.prototype.__varz=function(){},b2.b2Distance.Distance=function(a,b,c){++b2.b2Distance.b2_gjkCalls;var d=c.proxyA,e=c.proxyB,f=c.transformA,g=c.transformB,h=b2.b2Distance.s_simplex;h.ReadCache(b,d,f,e,g);for(var i,j=h.m_vertices,k=20,l=b2.b2Distance.s_saveA,m=b2.b2Distance.s_saveB,n=0,o=h.GetClosestPoint(),p=o.LengthSquared(),q=p,r=0,s=0;k>s;){for(n=h.m_count,r=0;n>r;r++)l[r]=j[r].indexA,m[r]=j[r].indexB;switch(h.m_count){case 1:break;case 2:h.Solve2();break;case 3:h.Solve3();break;default:b2.b2Settings.b2Assert(!1)}if(3==h.m_count)break;i=h.GetClosestPoint(),q=i.LengthSquared(),p=q;var t=h.GetSearchDirection();if(t.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var u=j[h.m_count];u.indexA=d.GetSupport(b2.b2Math.MulTMV(f.R,t.GetNegative())),u.wA=b2.b2Math.MulX(f,d.GetVertex(u.indexA)),u.indexB=e.GetSupport(b2.b2Math.MulTMV(g.R,t)),u.wB=b2.b2Math.MulX(g,e.GetVertex(u.indexB)),u.w=b2.b2Math.SubtractVV(u.wB,u.wA),++s,++b2.b2Distance.b2_gjkIters;var v=!1;for(r=0;n>r;r++)if(u.indexA==l[r]&&u.indexB==m[r]){v=!0;break}if(v)break;++h.m_count}if(b2.b2Distance.b2_gjkMaxIters=b2.b2Math.Max(b2.b2Distance.b2_gjkMaxIters,s),h.GetWitnessPoints(a.pointA,a.pointB),a.distance=b2.b2Math.SubtractVV(a.pointA,a.pointB).Length(),a.iterations=s,h.WriteCache(b),c.useRadii){var w=d.m_radius,x=e.m_radius;if(a.distance>w+x&&a.distance>Number.MIN_VALUE){a.distance-=w+x;var y=b2.b2Math.SubtractVV(a.pointB,a.pointA);y.Normalize(),a.pointA.x+=w*y.x,a.pointA.y+=w*y.y,a.pointB.x-=x*y.x,a.pointB.y-=x*y.y}else i=new b2.b2Vec2,i.x=.5*(a.pointA.x+a.pointB.x),i.y=.5*(a.pointA.y+a.pointB.y),a.pointA.x=a.pointB.x=i.x,a.pointA.y=a.pointB.y=i.y,a.distance=0}},b2.b2Distance.b2_gjkCalls=0,b2.b2Distance.b2_gjkIters=0,b2.b2Distance.b2_gjkMaxIters=0,b2.b2Distance.s_simplex=new b2.b2Simplex,b2.b2Distance.s_saveA=new Array(3),b2.b2Distance.s_saveB=new Array(3),b2.b2MouseJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2MouseJoint.prototype,b2.b2Joint.prototype),b2.b2MouseJoint.prototype._super=b2.b2Joint.prototype,b2.b2MouseJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]),this.m_target.SetV(a.target);var b=this.m_target.x-this.m_bodyB.m_xf.position.x,c=this.m_target.y-this.m_bodyB.m_xf.position.y,d=this.m_bodyB.m_xf.R;this.m_localAnchor.x=b*d.col1.x+c*d.col1.y,this.m_localAnchor.y=b*d.col2.x+c*d.col2.y,this.m_maxForce=a.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=a.frequencyHz,this.m_dampingRatio=a.dampingRatio,this.m_beta=0,this.m_gamma=0},b2.b2MouseJoint.prototype.__varz=function(){this.K=new b2.b2Mat22,this.K1=new b2.b2Mat22,this.K2=new b2.b2Mat22,this.m_localAnchor=new b2.b2Vec2,this.m_target=new b2.b2Vec2,this.m_impulse=new b2.b2Vec2,this.m_mass=new b2.b2Mat22,this.m_C=new b2.b2Vec2},b2.b2MouseJoint.prototype.InitVelocityConstraints=function(a){var b=this.m_bodyB,c=b.GetMass(),d=2*Math.PI*this.m_frequencyHz,e=2*c*this.m_dampingRatio*d,f=c*d*d;this.m_gamma=a.dt*(e+a.dt*f),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=a.dt*f*this.m_gamma;var g;g=b.m_xf.R;var h=this.m_localAnchor.x-b.m_sweep.localCenter.x,i=this.m_localAnchor.y-b.m_sweep.localCenter.y,j=g.col1.x*h+g.col2.x*i;i=g.col1.y*h+g.col2.y*i,h=j;var k=b.m_invMass,l=b.m_invI;this.K1.col1.x=k,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=k,this.K2.col1.x=l*i*i,this.K2.col2.x=-l*h*i,this.K2.col1.y=-l*h*i,this.K2.col2.y=l*h*h,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=b.m_sweep.c.x+h-this.m_target.x,this.m_C.y=b.m_sweep.c.y+i-this.m_target.y,b.m_angularVelocity*=.98,this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,b.m_linearVelocity.x+=k*this.m_impulse.x,b.m_linearVelocity.y+=k*this.m_impulse.y,b.m_angularVelocity+=l*(h*this.m_impulse.y-i*this.m_impulse.x)},b2.b2MouseJoint.prototype.SolveVelocityConstraints=function(a){var b,c,d,e=this.m_bodyB;b=e.m_xf.R;var f=this.m_localAnchor.x-e.m_sweep.localCenter.x,g=this.m_localAnchor.y-e.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g,g=b.col1.y*f+b.col2.y*g,f=c;var h=e.m_linearVelocity.x+-e.m_angularVelocity*g,i=e.m_linearVelocity.y+e.m_angularVelocity*f;b=this.m_mass,c=h+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,d=i+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var j=-(b.col1.x*c+b.col2.x*d),k=-(b.col1.y*c+b.col2.y*d),l=this.m_impulse.x,m=this.m_impulse.y;this.m_impulse.x+=j,this.m_impulse.y+=k;var n=a.dt*this.m_maxForce;this.m_impulse.LengthSquared()>n*n&&this.m_impulse.Multiply(n/this.m_impulse.Length()),j=this.m_impulse.x-l,k=this.m_impulse.y-m,e.m_linearVelocity.x+=e.m_invMass*j,e.m_linearVelocity.y+=e.m_invMass*k,e.m_angularVelocity+=e.m_invI*(f*k-g*j)},b2.b2MouseJoint.prototype.SolvePositionConstraints=function(a){return!0},b2.b2MouseJoint.prototype.GetAnchorA=function(){return this.m_target},b2.b2MouseJoint.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},b2.b2MouseJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*this.m_impulse.x,a*this.m_impulse.y)},b2.b2MouseJoint.prototype.GetReactionTorque=function(a){return 0},b2.b2MouseJoint.prototype.GetTarget=function(){return this.m_target},b2.b2MouseJoint.prototype.SetTarget=function(a){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=a},b2.b2MouseJoint.prototype.GetMaxForce=function(){return this.m_maxForce},b2.b2MouseJoint.prototype.SetMaxForce=function(a){this.m_maxForce=a},b2.b2MouseJoint.prototype.GetFrequency=function(){return this.m_frequencyHz},b2.b2MouseJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a},b2.b2MouseJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio},b2.b2MouseJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a},b2.b2MouseJoint.prototype.K=new b2.b2Mat22,b2.b2MouseJoint.prototype.K1=new b2.b2Mat22,b2.b2MouseJoint.prototype.K2=new b2.b2Mat22,b2.b2MouseJoint.prototype.m_localAnchor=new b2.b2Vec2,b2.b2MouseJoint.prototype.m_target=new b2.b2Vec2,b2.b2MouseJoint.prototype.m_impulse=new b2.b2Vec2,b2.b2MouseJoint.prototype.m_mass=new b2.b2Mat22,b2.b2MouseJoint.prototype.m_C=new b2.b2Vec2,b2.b2MouseJoint.prototype.m_maxForce=null,b2.b2MouseJoint.prototype.m_frequencyHz=null,b2.b2MouseJoint.prototype.m_dampingRatio=null,b2.b2MouseJoint.prototype.m_beta=null,b2.b2MouseJoint.prototype.m_gamma=null,b2.b2PrismaticJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2PrismaticJointDef.prototype,b2.b2JointDef.prototype),b2.b2PrismaticJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2PrismaticJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},b2.b2PrismaticJointDef.prototype.__varz=function(){this.localAnchorA=new b2.b2Vec2,this.localAnchorB=new b2.b2Vec2,this.localAxisA=new b2.b2Vec2},b2.b2PrismaticJointDef.prototype.Initialize=function(a,b,c,d){this.bodyA=a,this.bodyB=b,this.localAnchorA=this.bodyA.GetLocalPoint(c),this.localAnchorB=this.bodyB.GetLocalPoint(c),this.localAxisA=this.bodyA.GetLocalVector(d),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},b2.b2PrismaticJointDef.prototype.localAnchorA=new b2.b2Vec2,b2.b2PrismaticJointDef.prototype.localAnchorB=new b2.b2Vec2,b2.b2PrismaticJointDef.prototype.localAxisA=new b2.b2Vec2,b2.b2PrismaticJointDef.prototype.referenceAngle=null,b2.b2PrismaticJointDef.prototype.enableLimit=null,b2.b2PrismaticJointDef.prototype.lowerTranslation=null,b2.b2PrismaticJointDef.prototype.upperTranslation=null,b2.b2PrismaticJointDef.prototype.enableMotor=null,b2.b2PrismaticJointDef.prototype.maxMotorForce=null,b2.b2PrismaticJointDef.prototype.motorSpeed=null,b2.b2TimeOfImpact=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2TimeOfImpact.prototype.__constructor=function(){},b2.b2TimeOfImpact.prototype.__varz=function(){},b2.b2TimeOfImpact.TimeOfImpact=function(a){++b2.b2TimeOfImpact.b2_toiCalls;var b=a.proxyA,c=a.proxyB,d=a.sweepA,e=a.sweepB;b2.b2Settings.b2Assert(d.t0==e.t0),b2.b2Settings.b2Assert(1-d.t0>Number.MIN_VALUE);var f=b.m_radius+c.m_radius,g=a.tolerance,h=0,i=1e3,j=0,k=0;for(b2.b2TimeOfImpact.s_cache.count=0,b2.b2TimeOfImpact.s_distanceInput.useRadii=!1;;){if(d.GetTransform(b2.b2TimeOfImpact.s_xfA,h),e.GetTransform(b2.b2TimeOfImpact.s_xfB,h),b2.b2TimeOfImpact.s_distanceInput.proxyA=b,b2.b2TimeOfImpact.s_distanceInput.proxyB=c,b2.b2TimeOfImpact.s_distanceInput.transformA=b2.b2TimeOfImpact.s_xfA,b2.b2TimeOfImpact.s_distanceInput.transformB=b2.b2TimeOfImpact.s_xfB,b2.b2Distance.Distance(b2.b2TimeOfImpact.s_distanceOutput,b2.b2TimeOfImpact.s_cache,b2.b2TimeOfImpact.s_distanceInput),b2.b2TimeOfImpact.s_distanceOutput.distance<=0){h=1;break}b2.b2TimeOfImpact.s_fcn.Initialize(b2.b2TimeOfImpact.s_cache,b,b2.b2TimeOfImpact.s_xfA,c,b2.b2TimeOfImpact.s_xfB);var l=b2.b2TimeOfImpact.s_fcn.Evaluate(b2.b2TimeOfImpact.s_xfA,b2.b2TimeOfImpact.s_xfB);if(0>=l){h=1;break}if(0==j&&(k=l>f?b2.b2Math.Max(f-g,.75*f):b2.b2Math.Max(l-g,.02*f)),.5*g>l-k){if(0==j){h=1;break}break}var m=h,n=h,o=1,p=l;d.GetTransform(b2.b2TimeOfImpact.s_xfA,o),e.GetTransform(b2.b2TimeOfImpact.s_xfB,o);var q=b2.b2TimeOfImpact.s_fcn.Evaluate(b2.b2TimeOfImpact.s_xfA,b2.b2TimeOfImpact.s_xfB);if(q>=k){h=1;break}for(var r=0;;){var s;s=1&r?n+(k-p)*(o-n)/(q-p):.5*(n+o),d.GetTransform(b2.b2TimeOfImpact.s_xfA,s),e.GetTransform(b2.b2TimeOfImpact.s_xfB,s);var t=b2.b2TimeOfImpact.s_fcn.Evaluate(b2.b2TimeOfImpact.s_xfA,b2.b2TimeOfImpact.s_xfB);if(b2.b2Math.Abs(t-k)<.025*g){m=s;break}if(t>k?(n=s,p=t):(o=s,q=t),++r,++b2.b2TimeOfImpact.b2_toiRootIters,50==r)break}if(b2.b2TimeOfImpact.b2_toiMaxRootIters=b2.b2Math.Max(b2.b2TimeOfImpact.b2_toiMaxRootIters,r),m<(1+100*Number.MIN_VALUE)*h)break;if(h=m,j++,++b2.b2TimeOfImpact.b2_toiIters,j==i)break}return b2.b2TimeOfImpact.b2_toiMaxIters=b2.b2Math.Max(b2.b2TimeOfImpact.b2_toiMaxIters,j),h},b2.b2TimeOfImpact.b2_toiCalls=0,b2.b2TimeOfImpact.b2_toiIters=0,b2.b2TimeOfImpact.b2_toiMaxIters=0,b2.b2TimeOfImpact.b2_toiRootIters=0,b2.b2TimeOfImpact.b2_toiMaxRootIters=0,b2.b2TimeOfImpact.s_cache=new b2.b2SimplexCache,b2.b2TimeOfImpact.s_distanceInput=new b2.b2DistanceInput,b2.b2TimeOfImpact.s_xfA=new b2.b2Transform,b2.b2TimeOfImpact.s_xfB=new b2.b2Transform,b2.b2TimeOfImpact.s_fcn=new b2.b2SeparationFunction,b2.b2TimeOfImpact.s_distanceOutput=new b2.b2DistanceOutput,b2.b2GearJoint=function(){b2.b2Joint.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2GearJoint.prototype,b2.b2Joint.prototype),b2.b2GearJoint.prototype._super=b2.b2Joint.prototype,b2.b2GearJoint.prototype.__constructor=function(a){this._super.__constructor.apply(this,[a]);var b=a.joint1.m_type,c=a.joint2.m_type;this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var d,e;this.m_ground1=a.joint1.GetBodyA(),this.m_bodyA=a.joint1.GetBodyB(),b==b2.b2Joint.e_revoluteJoint?(this.m_revolute1=a.joint1,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),d=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=a.joint1,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),d=this.m_prismatic1.GetJointTranslation()),this.m_ground2=a.joint2.GetBodyA(),this.m_bodyB=a.joint2.GetBodyB(),c==b2.b2Joint.e_revoluteJoint?(this.m_revolute2=a.joint2,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),e=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=a.joint2,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),e=this.m_prismatic2.GetJointTranslation()),this.m_ratio=a.ratio,this.m_constant=d+this.m_ratio*e,this.m_impulse=0},b2.b2GearJoint.prototype.__varz=function(){this.m_groundAnchor1=new b2.b2Vec2,this.m_groundAnchor2=new b2.b2Vec2,this.m_localAnchor1=new b2.b2Vec2,this.m_localAnchor2=new b2.b2Vec2,this.m_J=new b2.b2Jacobian},b2.b2GearJoint.prototype.InitVelocityConstraints=function(a){var b,c,d,e,f,g,h,i,j=this.m_ground1,k=this.m_ground2,l=this.m_bodyA,m=this.m_bodyB,n=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,n+=l.m_invI):(f=j.m_xf.R,g=this.m_prismatic1.m_localXAxis1,b=f.col1.x*g.x+f.col2.x*g.y,c=f.col1.y*g.x+f.col2.y*g.y,f=l.m_xf.R,d=this.m_localAnchor1.x-l.m_sweep.localCenter.x,e=this.m_localAnchor1.y-l.m_sweep.localCenter.y,i=f.col1.x*d+f.col2.x*e,e=f.col1.y*d+f.col2.y*e,d=i,h=d*c-e*b,this.m_J.linearA.Set(-b,-c),this.m_J.angularA=-h,n+=l.m_invMass+l.m_invI*h*h),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,n+=this.m_ratio*this.m_ratio*m.m_invI):(f=k.m_xf.R,g=this.m_prismatic2.m_localXAxis1,b=f.col1.x*g.x+f.col2.x*g.y,c=f.col1.y*g.x+f.col2.y*g.y,f=m.m_xf.R,d=this.m_localAnchor2.x-m.m_sweep.localCenter.x,e=this.m_localAnchor2.y-m.m_sweep.localCenter.y,i=f.col1.x*d+f.col2.x*e,e=f.col1.y*d+f.col2.y*e,d=i,h=d*c-e*b,this.m_J.linearB.Set(-this.m_ratio*b,-this.m_ratio*c),this.m_J.angularB=-this.m_ratio*h,n+=this.m_ratio*this.m_ratio*(m.m_invMass+m.m_invI*h*h)),this.m_mass=n>0?1/n:0,a.warmStarting?(l.m_linearVelocity.x+=l.m_invMass*this.m_impulse*this.m_J.linearA.x,l.m_linearVelocity.y+=l.m_invMass*this.m_impulse*this.m_J.linearA.y,l.m_angularVelocity+=l.m_invI*this.m_impulse*this.m_J.angularA,m.m_linearVelocity.x+=m.m_invMass*this.m_impulse*this.m_J.linearB.x,m.m_linearVelocity.y+=m.m_invMass*this.m_impulse*this.m_J.linearB.y,m.m_angularVelocity+=m.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},b2.b2GearJoint.prototype.SolveVelocityConstraints=function(a){var b=this.m_bodyA,c=this.m_bodyB,d=this.m_J.Compute(b.m_linearVelocity,b.m_angularVelocity,c.m_linearVelocity,c.m_angularVelocity),e=-this.m_mass*d;this.m_impulse+=e,b.m_linearVelocity.x+=b.m_invMass*e*this.m_J.linearA.x,b.m_linearVelocity.y+=b.m_invMass*e*this.m_J.linearA.y,b.m_angularVelocity+=b.m_invI*e*this.m_J.angularA,c.m_linearVelocity.x+=c.m_invMass*e*this.m_J.linearB.x,c.m_linearVelocity.y+=c.m_invMass*e*this.m_J.linearB.y,c.m_angularVelocity+=c.m_invI*e*this.m_J.angularB},b2.b2GearJoint.prototype.SolvePositionConstraints=function(a){var b,c,d=0,e=this.m_bodyA,f=this.m_bodyB;b=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),c=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var g=this.m_constant-(b+this.m_ratio*c),h=-this.m_mass*g;return e.m_sweep.c.x+=e.m_invMass*h*this.m_J.linearA.x,e.m_sweep.c.y+=e.m_invMass*h*this.m_J.linearA.y,e.m_sweep.a+=e.m_invI*h*this.m_J.angularA,f.m_sweep.c.x+=f.m_invMass*h*this.m_J.linearB.x,f.m_sweep.c.y+=f.m_invMass*h*this.m_J.linearB.y,f.m_sweep.a+=f.m_invI*h*this.m_J.angularB,e.SynchronizeTransform(),f.SynchronizeTransform(),d<b2.b2Settings.b2_linearSlop},b2.b2GearJoint.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},b2.b2GearJoint.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},b2.b2GearJoint.prototype.GetReactionForce=function(a){return new b2.b2Vec2(a*this.m_impulse*this.m_J.linearB.x,a*this.m_impulse*this.m_J.linearB.y)},b2.b2GearJoint.prototype.GetReactionTorque=function(a){var b=this.m_bodyB.m_xf.R,c=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,d=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,e=b.col1.x*c+b.col2.x*d;d=b.col1.y*c+b.col2.y*d,c=e;var f=this.m_impulse*this.m_J.linearB.x,g=this.m_impulse*this.m_J.linearB.y;return a*(this.m_impulse*this.m_J.angularB-c*g+d*f)},b2.b2GearJoint.prototype.GetRatio=function(){return this.m_ratio},b2.b2GearJoint.prototype.SetRatio=function(a){this.m_ratio=a},b2.b2GearJoint.prototype.m_ground1=null,b2.b2GearJoint.prototype.m_ground2=null,b2.b2GearJoint.prototype.m_revolute1=null,b2.b2GearJoint.prototype.m_prismatic1=null,b2.b2GearJoint.prototype.m_revolute2=null,b2.b2GearJoint.prototype.m_prismatic2=null,b2.b2GearJoint.prototype.m_groundAnchor1=new b2.b2Vec2,b2.b2GearJoint.prototype.m_groundAnchor2=new b2.b2Vec2,b2.b2GearJoint.prototype.m_localAnchor1=new b2.b2Vec2,b2.b2GearJoint.prototype.m_localAnchor2=new b2.b2Vec2,b2.b2GearJoint.prototype.m_J=new b2.b2Jacobian,b2.b2GearJoint.prototype.m_constant=null,b2.b2GearJoint.prototype.m_ratio=null,b2.b2GearJoint.prototype.m_mass=null,b2.b2GearJoint.prototype.m_impulse=null,b2.b2TOIInput=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2TOIInput.prototype.__constructor=function(){},b2.b2TOIInput.prototype.__varz=function(){this.proxyA=new b2.b2DistanceProxy,this.proxyB=new b2.b2DistanceProxy,this.sweepA=new b2.b2Sweep,this.sweepB=new b2.b2Sweep},b2.b2TOIInput.prototype.proxyA=new b2.b2DistanceProxy,b2.b2TOIInput.prototype.proxyB=new b2.b2DistanceProxy,b2.b2TOIInput.prototype.sweepA=new b2.b2Sweep,b2.b2TOIInput.prototype.sweepB=new b2.b2Sweep,b2.b2TOIInput.prototype.tolerance=null,b2.b2RevoluteJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2RevoluteJointDef.prototype,b2.b2JointDef.prototype),b2.b2RevoluteJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2RevoluteJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},b2.b2RevoluteJointDef.prototype.__varz=function(){this.localAnchorA=new b2.b2Vec2,this.localAnchorB=new b2.b2Vec2},b2.b2RevoluteJointDef.prototype.Initialize=function(a,b,c){this.bodyA=a,this.bodyB=b,this.localAnchorA=this.bodyA.GetLocalPoint(c),this.localAnchorB=this.bodyB.GetLocalPoint(c),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},b2.b2RevoluteJointDef.prototype.localAnchorA=new b2.b2Vec2,b2.b2RevoluteJointDef.prototype.localAnchorB=new b2.b2Vec2,b2.b2RevoluteJointDef.prototype.referenceAngle=null,b2.b2RevoluteJointDef.prototype.enableLimit=null,b2.b2RevoluteJointDef.prototype.lowerAngle=null,b2.b2RevoluteJointDef.prototype.upperAngle=null,b2.b2RevoluteJointDef.prototype.enableMotor=null,b2.b2RevoluteJointDef.prototype.motorSpeed=null,b2.b2RevoluteJointDef.prototype.maxMotorTorque=null,b2.b2MouseJointDef=function(){b2.b2JointDef.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2MouseJointDef.prototype,b2.b2JointDef.prototype),b2.b2MouseJointDef.prototype._super=b2.b2JointDef.prototype,b2.b2MouseJointDef.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.type=b2.b2Joint.e_mouseJoint,
this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},b2.b2MouseJointDef.prototype.__varz=function(){this.target=new b2.b2Vec2},b2.b2MouseJointDef.prototype.target=new b2.b2Vec2,b2.b2MouseJointDef.prototype.maxForce=null,b2.b2MouseJointDef.prototype.frequencyHz=null,b2.b2MouseJointDef.prototype.dampingRatio=null,b2.b2Contact=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Contact.prototype.__constructor=function(){},b2.b2Contact.prototype.__varz=function(){this.m_nodeA=new b2.b2ContactEdge,this.m_nodeB=new b2.b2ContactEdge,this.m_manifold=new b2.b2Manifold,this.m_oldManifold=new b2.b2Manifold},b2.b2Contact.s_input=new b2.b2TOIInput,b2.b2Contact.e_sensorFlag=1,b2.b2Contact.e_continuousFlag=2,b2.b2Contact.e_islandFlag=4,b2.b2Contact.e_toiFlag=8,b2.b2Contact.e_touchingFlag=16,b2.b2Contact.e_enabledFlag=32,b2.b2Contact.e_filterFlag=64,b2.b2Contact.prototype.Reset=function(a,b){if(this.m_flags=b2.b2Contact.e_enabledFlag,!a||!b)return this.m_fixtureA=null,void(this.m_fixtureB=null);(a.IsSensor()||b.IsSensor())&&(this.m_flags|=b2.b2Contact.e_sensorFlag);var c=a.GetBody(),d=b.GetBody();(c.GetType()!=b2.b2Body.b2_dynamicBody||c.IsBullet()||d.GetType()!=b2.b2Body.b2_dynamicBody||d.IsBullet())&&(this.m_flags|=b2.b2Contact.e_continuousFlag),this.m_fixtureA=a,this.m_fixtureB=b,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},b2.b2Contact.prototype.Update=function(a){var b=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=b,this.m_flags|=b2.b2Contact.e_enabledFlag;var c,d,e,f,g=!1,h=(this.m_flags&b2.b2Contact.e_touchingFlag)==b2.b2Contact.e_touchingFlag,i=this.m_fixtureA.m_body,j=this.m_fixtureB.m_body,k=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&b2.b2Contact.e_sensorFlag)k&&(c=this.m_fixtureA.GetShape(),d=this.m_fixtureB.GetShape(),e=i.GetTransform(),f=j.GetTransform(),g=b2.b2Shape.TestOverlap(c,e,d,f)),this.m_manifold.m_pointCount=0;else{if(i.GetType()!=b2.b2Body.b2_dynamicBody||i.IsBullet()||j.GetType()!=b2.b2Body.b2_dynamicBody||j.IsBullet()?this.m_flags|=b2.b2Contact.e_continuousFlag:this.m_flags&=~b2.b2Contact.e_continuousFlag,k){this.Evaluate(),g=this.m_manifold.m_pointCount>0;for(var l,m,n,o,p=0;p<this.m_manifold.m_pointCount;++p)for(m=this.m_manifold.m_points[p],m.m_normalImpulse=0,m.m_tangentImpulse=0,n=m.m_id,o=0;o<this.m_oldManifold.m_pointCount;++o)if(l=this.m_oldManifold.m_points[o],l.m_id.key==n.key){m.m_normalImpulse=l.m_normalImpulse,m.m_tangentImpulse=l.m_tangentImpulse;break}}else this.m_manifold.m_pointCount=0;g!=h&&(i.SetAwake(!0),j.SetAwake(!0))}g?this.m_flags|=b2.b2Contact.e_touchingFlag:this.m_flags&=~b2.b2Contact.e_touchingFlag,0==h&&1==g&&a.BeginContact(this),1==h&&0==g&&a.EndContact(this),0==(this.m_flags&b2.b2Contact.e_sensorFlag)&&a.PreSolve(this,this.m_oldManifold)},b2.b2Contact.prototype.Evaluate=function(){},b2.b2Contact.prototype.ComputeTOI=function(a,b){return b2.b2Contact.s_input.proxyA.Set(this.m_fixtureA.GetShape()),b2.b2Contact.s_input.proxyB.Set(this.m_fixtureB.GetShape()),b2.b2Contact.s_input.sweepA=a,b2.b2Contact.s_input.sweepB=b,b2.b2Contact.s_input.tolerance=b2.b2Settings.b2_linearSlop,b2.b2TimeOfImpact.TimeOfImpact(b2.b2Contact.s_input)},b2.b2Contact.prototype.GetManifold=function(){return this.m_manifold},b2.b2Contact.prototype.GetWorldManifold=function(a){var b=this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody(),d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();a.Initialize(this.m_manifold,b.GetTransform(),d.m_radius,c.GetTransform(),e.m_radius)},b2.b2Contact.prototype.IsTouching=function(){return(this.m_flags&b2.b2Contact.e_touchingFlag)==b2.b2Contact.e_touchingFlag},b2.b2Contact.prototype.IsContinuous=function(){return(this.m_flags&b2.b2Contact.e_continuousFlag)==b2.b2Contact.e_continuousFlag},b2.b2Contact.prototype.SetSensor=function(a){a?this.m_flags|=b2.b2Contact.e_sensorFlag:this.m_flags&=~b2.b2Contact.e_sensorFlag},b2.b2Contact.prototype.IsSensor=function(){return(this.m_flags&b2.b2Contact.e_sensorFlag)==b2.b2Contact.e_sensorFlag},b2.b2Contact.prototype.SetEnabled=function(a){a?this.m_flags|=b2.b2Contact.e_enabledFlag:this.m_flags&=~b2.b2Contact.e_enabledFlag},b2.b2Contact.prototype.IsEnabled=function(){return(this.m_flags&b2.b2Contact.e_enabledFlag)==b2.b2Contact.e_enabledFlag},b2.b2Contact.prototype.GetNext=function(){return this.m_next},b2.b2Contact.prototype.GetFixtureA=function(){return this.m_fixtureA},b2.b2Contact.prototype.GetFixtureB=function(){return this.m_fixtureB},b2.b2Contact.prototype.FlagForFiltering=function(){this.m_flags|=b2.b2Contact.e_filterFlag},b2.b2Contact.prototype.m_flags=0,b2.b2Contact.prototype.m_prev=null,b2.b2Contact.prototype.m_next=null,b2.b2Contact.prototype.m_nodeA=new b2.b2ContactEdge,b2.b2Contact.prototype.m_nodeB=new b2.b2ContactEdge,b2.b2Contact.prototype.m_fixtureA=null,b2.b2Contact.prototype.m_fixtureB=null,b2.b2Contact.prototype.m_manifold=new b2.b2Manifold,b2.b2Contact.prototype.m_oldManifold=new b2.b2Manifold,b2.b2Contact.prototype.m_toi=null,b2.b2ContactConstraint=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactConstraint.prototype.__constructor=function(){this.points=new Array(b2.b2Settings.b2_maxManifoldPoints);for(var a=0;a<b2.b2Settings.b2_maxManifoldPoints;a++)this.points[a]=new b2.b2ContactConstraintPoint},b2.b2ContactConstraint.prototype.__varz=function(){this.localPlaneNormal=new b2.b2Vec2,this.localPoint=new b2.b2Vec2,this.normal=new b2.b2Vec2,this.normalMass=new b2.b2Mat22,this.K=new b2.b2Mat22},b2.b2ContactConstraint.prototype.points=null,b2.b2ContactConstraint.prototype.localPlaneNormal=new b2.b2Vec2,b2.b2ContactConstraint.prototype.localPoint=new b2.b2Vec2,b2.b2ContactConstraint.prototype.normal=new b2.b2Vec2,b2.b2ContactConstraint.prototype.normalMass=new b2.b2Mat22,b2.b2ContactConstraint.prototype.K=new b2.b2Mat22,b2.b2ContactConstraint.prototype.bodyA=null,b2.b2ContactConstraint.prototype.bodyB=null,b2.b2ContactConstraint.prototype.type=0,b2.b2ContactConstraint.prototype.radius=null,b2.b2ContactConstraint.prototype.friction=null,b2.b2ContactConstraint.prototype.restitution=null,b2.b2ContactConstraint.prototype.pointCount=0,b2.b2ContactConstraint.prototype.manifold=null,b2.b2ContactResult=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactResult.prototype.__constructor=function(){},b2.b2ContactResult.prototype.__varz=function(){this.position=new b2.b2Vec2,this.normal=new b2.b2Vec2,this.id=new b2.b2ContactID},b2.b2ContactResult.prototype.shape1=null,b2.b2ContactResult.prototype.shape2=null,b2.b2ContactResult.prototype.position=new b2.b2Vec2,b2.b2ContactResult.prototype.normal=new b2.b2Vec2,b2.b2ContactResult.prototype.normalImpulse=null,b2.b2ContactResult.prototype.tangentImpulse=null,b2.b2ContactResult.prototype.id=new b2.b2ContactID,b2.b2PolygonContact=function(){b2.b2Contact.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2PolygonContact.prototype,b2.b2Contact.prototype),b2.b2PolygonContact.prototype._super=b2.b2Contact.prototype,b2.b2PolygonContact.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2PolygonContact.prototype.__varz=function(){},b2.b2PolygonContact.Create=function(a){return new b2.b2PolygonContact},b2.b2PolygonContact.Destroy=function(a,b){},b2.b2PolygonContact.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),b=this.m_fixtureB.GetBody();b2.b2Collision.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape(),a.m_xf,this.m_fixtureB.GetShape(),b.m_xf)},b2.b2PolygonContact.prototype.Reset=function(a,b){this._super.Reset.apply(this,[a,b])};var b=function(){this.__varz(),this.__constructor.apply(this,arguments)};b.prototype.__constructor=function(){},b.prototype.__varz=function(){this.v=new b2.b2Vec2,this.id=new b2.b2ContactID},b.prototype.Set=function(a){this.v.SetV(a.v),this.id.Set(a.id)},b.prototype.v=new b2.b2Vec2,b.prototype.id=new b2.b2ContactID,b2.b2ContactFilter=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactFilter.prototype.__constructor=function(){},b2.b2ContactFilter.prototype.__varz=function(){},b2.b2ContactFilter.b2_defaultFilter=new b2.b2ContactFilter,b2.b2ContactFilter.prototype.ShouldCollide=function(a,b){var c=a.GetFilterData(),d=b.GetFilterData();if(c.groupIndex==d.groupIndex&&0!=c.groupIndex)return c.groupIndex>0;var e=0!=(c.maskBits&d.categoryBits)&&0!=(c.categoryBits&d.maskBits);return e},b2.b2ContactFilter.prototype.RayCollide=function(a,b){return a?this.ShouldCollide(a,b):!0},b2.b2NullContact=function(){b2.b2Contact.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2NullContact.prototype,b2.b2Contact.prototype),b2.b2NullContact.prototype._super=b2.b2Contact.prototype,b2.b2NullContact.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2NullContact.prototype.__varz=function(){},b2.b2NullContact.prototype.Evaluate=function(){},b2.b2ContactListener=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactListener.prototype.__constructor=function(){},b2.b2ContactListener.prototype.__varz=function(){},b2.b2ContactListener.b2_defaultListener=new b2.b2ContactListener,b2.b2ContactListener.prototype.BeginContact=function(a){},b2.b2ContactListener.prototype.EndContact=function(a){},b2.b2ContactListener.prototype.PreSolve=function(a,b){},b2.b2ContactListener.prototype.PostSolve=function(a,b){},b2.b2Island=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Island.prototype.__constructor=function(){this.m_bodies=[],this.m_contacts=[],this.m_joints=new Array},b2.b2Island.prototype.__varz=function(){},b2.b2Island.s_impulse=new b2.b2ContactImpulse,b2.b2Island.prototype.Initialize=function(a,b,c,d,e,f){var g=0;for(this.m_bodyCapacity=a,this.m_contactCapacity=b,this.m_jointCapacity=c,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=d,this.m_listener=e,this.m_contactSolver=f,g=this.m_bodies.length;a>g;g++)this.m_bodies[g]=null;for(g=this.m_contacts.length;b>g;g++)this.m_contacts[g]=null;for(g=this.m_joints.length;c>g;g++)this.m_joints[g]=null},b2.b2Island.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},b2.b2Island.prototype.Solve=function(a,b,c){var d,e,f,g,h,i,j,k,l,m=0,n=0;for(m=0;m<this.m_bodyCount;++m)d=this.m_bodies[m],d.GetType()==b2.b2Body.b2_dynamicBody&&(d.m_linearVelocity.x+=a.dt*(b.x+d.m_invMass*d.m_force.x),d.m_linearVelocity.y+=a.dt*(b.y+d.m_invMass*d.m_force.y),d.m_angularVelocity+=a.dt*d.m_invI*d.m_torque,d.m_linearVelocity.Multiply(b2.b2Math.Clamp(1-a.dt*d.m_linearDamping,0,1)),d.m_angularVelocity*=b2.b2Math.Clamp(1-a.dt*d.m_angularDamping,0,1));for(this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator),f=this.m_contactSolver,f.InitVelocityConstraints(a),m=0;m<this.m_jointCount;++m)e=this.m_joints[m],e.InitVelocityConstraints(a);for(m=0;m<a.velocityIterations;++m){for(n=0;n<this.m_jointCount;++n)e=this.m_joints[n],e.SolveVelocityConstraints(a);f.SolveVelocityConstraints()}for(m=0;m<this.m_jointCount;++m)e=this.m_joints[m],e.FinalizeVelocityConstraints();for(f.FinalizeVelocityConstraints(),m=0;m<this.m_bodyCount;++m)d=this.m_bodies[m],d.GetType()!=b2.b2Body.b2_staticBody&&(g=a.dt*d.m_linearVelocity.x,h=a.dt*d.m_linearVelocity.y,g*g+h*h>b2.b2Settings.b2_maxTranslationSquared&&(d.m_linearVelocity.Normalize(),d.m_linearVelocity.x*=b2.b2Settings.b2_maxTranslation*a.inv_dt,d.m_linearVelocity.y*=b2.b2Settings.b2_maxTranslation*a.inv_dt),i=a.dt*d.m_angularVelocity,i*i>b2.b2Settings.b2_maxRotationSquared&&(d.m_angularVelocity<0?d.m_angularVelocity=-b2.b2Settings.b2_maxRotation*a.inv_dt:d.m_angularVelocity=b2.b2Settings.b2_maxRotation*a.inv_dt),d.m_sweep.c0.SetV(d.m_sweep.c),d.m_sweep.a0=d.m_sweep.a,d.m_sweep.c.x+=a.dt*d.m_linearVelocity.x,d.m_sweep.c.y+=a.dt*d.m_linearVelocity.y,d.m_sweep.a+=a.dt*d.m_angularVelocity,d.SynchronizeTransform());for(m=0;m<a.positionIterations;++m){for(j=f.SolvePositionConstraints(b2.b2Settings.b2_contactBaumgarte),k=!0,n=0;n<this.m_jointCount;++n)e=this.m_joints[n],l=e.SolvePositionConstraints(b2.b2Settings.b2_contactBaumgarte),k=k&&l;if(j&&k)break}if(this.Report(f.m_constraints),c){var o=Number.MAX_VALUE,p=b2.b2Settings.b2_linearSleepTolerance*b2.b2Settings.b2_linearSleepTolerance,q=b2.b2Settings.b2_angularSleepTolerance*b2.b2Settings.b2_angularSleepTolerance;for(m=0;m<this.m_bodyCount;++m)d=this.m_bodies[m],d.GetType()!=b2.b2Body.b2_staticBody&&(0==(d.m_flags&b2.b2Body.e_allowSleepFlag)&&(d.m_sleepTime=0,o=0),0==(d.m_flags&b2.b2Body.e_allowSleepFlag)||d.m_angularVelocity*d.m_angularVelocity>q||b2.b2Math.Dot(d.m_linearVelocity,d.m_linearVelocity)>p?(d.m_sleepTime=0,o=0):(d.m_sleepTime+=a.dt,o=b2.b2Math.Min(o,d.m_sleepTime)));if(o>=b2.b2Settings.b2_timeToSleep)for(m=0;m<this.m_bodyCount;++m)d=this.m_bodies[m],d.SetAwake(!1)}},b2.b2Island.prototype.SolveTOI=function(a){var b=0,c=0;this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);var d=this.m_contactSolver;for(b=0;b<this.m_jointCount;++b)this.m_joints[b].InitVelocityConstraints(a);for(b=0;b<a.velocityIterations;++b)for(d.SolveVelocityConstraints(),c=0;c<this.m_jointCount;++c)this.m_joints[c].SolveVelocityConstraints(a);for(b=0;b<this.m_bodyCount;++b){var e=this.m_bodies[b];if(e.GetType()!=b2.b2Body.b2_staticBody){var f=a.dt*e.m_linearVelocity.x,g=a.dt*e.m_linearVelocity.y;f*f+g*g>b2.b2Settings.b2_maxTranslationSquared&&(e.m_linearVelocity.Normalize(),e.m_linearVelocity.x*=b2.b2Settings.b2_maxTranslation*a.inv_dt,e.m_linearVelocity.y*=b2.b2Settings.b2_maxTranslation*a.inv_dt);var h=a.dt*e.m_angularVelocity;h*h>b2.b2Settings.b2_maxRotationSquared&&(e.m_angularVelocity<0?e.m_angularVelocity=-b2.b2Settings.b2_maxRotation*a.inv_dt:e.m_angularVelocity=b2.b2Settings.b2_maxRotation*a.inv_dt),e.m_sweep.c0.SetV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=a.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=a.dt*e.m_linearVelocity.y,e.m_sweep.a+=a.dt*e.m_angularVelocity,e.SynchronizeTransform()}}var i=.75;for(b=0;b<a.positionIterations;++b){var j=d.SolvePositionConstraints(i),k=!0;for(c=0;c<this.m_jointCount;++c){var l=this.m_joints[c].SolvePositionConstraints(b2.b2Settings.b2_contactBaumgarte);k=k&&l}if(j&&k)break}this.Report(d.m_constraints)},b2.b2Island.prototype.Report=function(a){if(null!=this.m_listener)for(var b=0;b<this.m_contactCount;++b){for(var c=this.m_contacts[b],d=a[b],e=0;e<d.pointCount;++e)b2.b2Island.s_impulse.normalImpulses[e]=d.points[e].normalImpulse,b2.b2Island.s_impulse.tangentImpulses[e]=d.points[e].tangentImpulse;this.m_listener.PostSolve(c,b2.b2Island.s_impulse)}},b2.b2Island.prototype.AddBody=function(a){a.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=a},b2.b2Island.prototype.AddContact=function(a){this.m_contacts[this.m_contactCount++]=a},b2.b2Island.prototype.AddJoint=function(a){this.m_joints[this.m_jointCount++]=a},b2.b2Island.prototype.m_allocator=null,b2.b2Island.prototype.m_listener=null,b2.b2Island.prototype.m_contactSolver=null,b2.b2Island.prototype.m_bodies=null,b2.b2Island.prototype.m_contacts=null,b2.b2Island.prototype.m_joints=null,b2.b2Island.prototype.m_bodyCount=0,b2.b2Island.prototype.m_jointCount=0,b2.b2Island.prototype.m_contactCount=0,b2.b2Island.prototype.m_bodyCapacity=0,b2.b2Island.prototype.m_contactCapacity=0,b2.b2Island.prototype.m_jointCapacity=0,b2.b2PolyAndEdgeContact=function(){b2.b2Contact.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2PolyAndEdgeContact.prototype,b2.b2Contact.prototype),b2.b2PolyAndEdgeContact.prototype._super=b2.b2Contact.prototype,b2.b2PolyAndEdgeContact.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2PolyAndEdgeContact.prototype.__varz=function(){},b2.b2PolyAndEdgeContact.Create=function(a){return new b2.b2PolyAndEdgeContact},b2.b2PolyAndEdgeContact.Destroy=function(a,b){},b2.b2PolyAndEdgeContact.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),b=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape(),a.m_xf,this.m_fixtureB.GetShape(),b.m_xf)},b2.b2PolyAndEdgeContact.prototype.b2CollidePolyAndEdge=function(a,b,c,d,e){},b2.b2PolyAndEdgeContact.prototype.Reset=function(a,b){this._super.Reset.apply(this,[a,b]),b2.b2Settings.b2Assert(a.GetType()==b2.b2Shape.e_polygonShape),b2.b2Settings.b2Assert(b.GetType()==b2.b2Shape.e_edgeShape)},b2.b2Collision=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2Collision.prototype.__constructor=function(){},b2.b2Collision.prototype.__varz=function(){},b2.b2Collision.MakeClipPointVector=function(){var a=new Array(2);return a[0]=new b,a[1]=new b,a},b2.b2Collision.ClipSegmentToLine=function(a,b,c,d){var e,f=0;e=b[0];var g=e.v;e=b[1];var h=e.v,i=c.x*g.x+c.y*g.y-d,j=c.x*h.x+c.y*h.y-d;if(0>=i&&a[f++].Set(b[0]),0>=j&&a[f++].Set(b[1]),0>i*j){var k=i/(i-j);e=a[f];var l=e.v;l.x=g.x+k*(h.x-g.x),l.y=g.y+k*(h.y-g.y),e=a[f];var m;i>0?(m=b[0],e.id=m.id):(m=b[1],e.id=m.id),++f}return f},b2.b2Collision.EdgeSeparation=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,p,r,s=(a.m_vertexCount,a.m_vertices),t=a.m_normals,u=d.m_vertexCount,v=d.m_vertices,w=0;for(f=b.R,g=t[c],h=f.col1.x*g.x+f.col2.x*g.y,i=f.col1.y*g.x+f.col2.y*g.y,f=e.R,j=f.col1.x*h+f.col1.y*i,k=f.col2.x*h+f.col2.y*i,l=0,m=Number.MAX_VALUE;u>w;++w)g=v[w],n=g.x*j+g.y*k,m>n&&(m=n,l=w);return g=s[c],f=b.R,o=b.position.x+(f.col1.x*g.x+f.col2.x*g.y),v1Y=b.position.y+(f.col1.y*g.x+f.col2.y*g.y),g=v[l],f=e.R,q=e.position.x+(f.col1.x*g.x+f.col2.x*g.y),p=e.position.y+(f.col1.y*g.x+f.col2.y*g.y),q-=o,p-=v1Y,r=q*h+p*i},b2.b2Collision.FindMaxSeparation=function(a,b,c,d,e){var f,g,h=b.m_vertexCount,i=b.m_normals;g=e.R,f=d.m_centroid;var j=e.position.x+(g.col1.x*f.x+g.col2.x*f.y),k=e.position.y+(g.col1.y*f.x+g.col2.y*f.y);g=c.R,f=b.m_centroid,j-=c.position.x+(g.col1.x*f.x+g.col2.x*f.y),k-=c.position.y+(g.col1.y*f.x+g.col2.y*f.y);for(var l=j*c.R.col1.x+k*c.R.col1.y,m=j*c.R.col2.x+k*c.R.col2.y,n=0,o=-Number.MAX_VALUE,p=0;h>p;++p){f=i[p];var q=f.x*l+f.y*m;q>o&&(o=q,n=p)}var r,s=b2.b2Collision.EdgeSeparation(b,c,n,d,e),t=n-1>=0?n-1:h-1,u=b2.b2Collision.EdgeSeparation(b,c,t,d,e),v=h>n+1?n+1:0,w=b2.b2Collision.EdgeSeparation(b,c,v,d,e),x=0,y=0;if(u>s&&u>w)y=-1,x=t,r=u;else{if(!(w>s))return a[0]=n,s;y=1,x=v,r=w}for(;;){if(n=-1==y?x-1>=0?x-1:h-1:h>x+1?x+1:0,s=b2.b2Collision.EdgeSeparation(b,c,n,d,e),!(s>r))break;x=n,r=s}return a[0]=x,r},b2.b2Collision.FindIncidentEdge=function(a,b,c,d,e,f){var g,h,i=(b.m_vertexCount,b.m_normals),j=e.m_vertexCount,k=e.m_vertices,l=e.m_normals;g=c.R,h=i[d];var m=g.col1.x*h.x+g.col2.x*h.y,n=g.col1.y*h.x+g.col2.y*h.y;g=f.R;var o=g.col1.x*m+g.col1.y*n;n=g.col2.x*m+g.col2.y*n,m=o;for(var p=0,q=Number.MAX_VALUE,r=0;j>r;++r){h=l[r];var s=m*h.x+n*h.y;q>s&&(q=s,p=r)}var t,u=p,v=j>u+1?u+1:0;t=a[0],h=k[u],g=f.R,t.v.x=f.position.x+(g.col1.x*h.x+g.col2.x*h.y),t.v.y=f.position.y+(g.col1.y*h.x+g.col2.y*h.y),t.id.features.referenceEdge=d,t.id.features.incidentEdge=u,t.id.features.incidentVertex=0,t=a[1],h=k[v],g=f.R,t.v.x=f.position.x+(g.col1.x*h.x+g.col2.x*h.y),t.v.y=f.position.y+(g.col1.y*h.x+g.col2.y*h.y),t.id.features.referenceEdge=d,t.id.features.incidentEdge=v,t.id.features.incidentVertex=1},b2.b2Collision.CollidePolygons=function(a,b,c,d,e){var f;a.m_pointCount=0;var g=b.m_radius+d.m_radius,h=0;b2.b2Collision.s_edgeAO[0]=h;var i=b2.b2Collision.FindMaxSeparation(b2.b2Collision.s_edgeAO,b,c,d,e);if(h=b2.b2Collision.s_edgeAO[0],!(i>g)){var j=0;b2.b2Collision.s_edgeBO[0]=j;var k=b2.b2Collision.FindMaxSeparation(b2.b2Collision.s_edgeBO,d,e,b,c);if(j=b2.b2Collision.s_edgeBO[0],!(k>g)){var l,m,n,o,p,q=0,r=0,s=.98,t=.001;k>s*i+t?(l=d,m=b,n=e,o=c,q=j,a.m_type=b2.b2Manifold.e_faceB,r=1):(l=b,m=d,n=c,o=e,q=h,a.m_type=b2.b2Manifold.e_faceA,r=0);var u=b2.b2Collision.s_incidentEdge;b2.b2Collision.FindIncidentEdge(u,l,n,q,m,o);var v,w=l.m_vertexCount,x=l.m_vertices,y=x[q];v=w>q+1?x[~~(q+1)]:x[0];var z=b2.b2Collision.s_localTangent;z.Set(v.x-y.x,v.y-y.y),z.Normalize();var A=b2.b2Collision.s_localNormal;A.x=z.y,A.y=-z.x;var B=b2.b2Collision.s_planePoint;B.Set(.5*(y.x+v.x),.5*(y.y+v.y));var C=b2.b2Collision.s_tangent;p=n.R,C.x=p.col1.x*z.x+p.col2.x*z.y,C.y=p.col1.y*z.x+p.col2.y*z.y;var D=b2.b2Collision.s_tangent2;D.x=-C.x,D.y=-C.y;var E=b2.b2Collision.s_normal;E.x=C.y,E.y=-C.x;var F=b2.b2Collision.s_v11,G=b2.b2Collision.s_v12;F.x=n.position.x+(p.col1.x*y.x+p.col2.x*y.y),F.y=n.position.y+(p.col1.y*y.x+p.col2.y*y.y),G.x=n.position.x+(p.col1.x*v.x+p.col2.x*v.y),G.y=n.position.y+(p.col1.y*v.x+p.col2.y*v.y);var H=E.x*F.x+E.y*F.y,I=-C.x*F.x-C.y*F.y+g,J=C.x*G.x+C.y*G.y+g,K=b2.b2Collision.s_clipPoints1,L=b2.b2Collision.s_clipPoints2,M=0;if(M=b2.b2Collision.ClipSegmentToLine(K,u,D,I),!(2>M||(M=b2.b2Collision.ClipSegmentToLine(L,K,C,J),2>M))){a.m_localPlaneNormal.SetV(A),a.m_localPoint.SetV(B);for(var N=0,O=0;O<b2.b2Settings.b2_maxManifoldPoints;++O){f=L[O];var P=E.x*f.v.x+E.y*f.v.y-H;if(g>=P){var Q=a.m_points[N];p=o.R;var R=f.v.x-o.position.x,S=f.v.y-o.position.y;Q.m_localPoint.x=R*p.col1.x+S*p.col1.y,Q.m_localPoint.y=R*p.col2.x+S*p.col2.y,Q.m_id.Set(f.id),Q.m_id.features.flip=r,++N}}a.m_pointCount=N}}}},b2.b2Collision.CollideCircles=function(a,b,c,d,e){a.m_pointCount=0;var f,g;f=c.R,g=b.m_p;var h=c.position.x+(f.col1.x*g.x+f.col2.x*g.y),i=c.position.y+(f.col1.y*g.x+f.col2.y*g.y);f=e.R,g=d.m_p;var j=e.position.x+(f.col1.x*g.x+f.col2.x*g.y),k=e.position.y+(f.col1.y*g.x+f.col2.y*g.y),l=j-h,m=k-i,n=l*l+m*m,o=b.m_radius+d.m_radius;n>o*o||(a.m_type=b2.b2Manifold.e_circles,a.m_localPoint.SetV(b.m_p),a.m_localPlaneNormal.SetZero(),a.m_pointCount=1,a.m_points[0].m_localPoint.SetV(d.m_p),a.m_points[0].m_id.key=0)},b2.b2Collision.CollidePolygonAndCircle=function(a,b,c,d,e){a.m_pointCount=0;var f,g,h,i;i=e.R,h=d.m_p;var j=e.position.x+(i.col1.x*h.x+i.col2.x*h.y),k=e.position.y+(i.col1.y*h.x+i.col2.y*h.y);f=j-c.position.x,g=k-c.position.y,i=c.R;for(var l=f*i.col1.x+g*i.col1.y,m=f*i.col2.x+g*i.col2.y,n=0,o=-Number.MAX_VALUE,p=b.m_radius+d.m_radius,q=b.m_vertexCount,r=b.m_vertices,s=b.m_normals,t=0;q>t;++t){h=r[t],f=l-h.x,g=m-h.y,h=s[t];var u=h.x*f+h.y*g;if(u>p)return;u>o&&(o=u,n=t)}var v=n,w=q>v+1?v+1:0,x=r[v],y=r[w];if(o<Number.MIN_VALUE)return a.m_pointCount=1,a.m_type=b2.b2Manifold.e_faceA,a.m_localPlaneNormal.SetV(s[n]),a.m_localPoint.x=.5*(x.x+y.x),a.m_localPoint.y=.5*(x.y+y.y),a.m_points[0].m_localPoint.SetV(d.m_p),void(a.m_points[0].m_id.key=0);var z=(l-x.x)*(y.x-x.x)+(m-x.y)*(y.y-x.y),A=(l-y.x)*(x.x-y.x)+(m-y.y)*(x.y-y.y);if(0>=z){if((l-x.x)*(l-x.x)+(m-x.y)*(m-x.y)>p*p)return;a.m_pointCount=1,a.m_type=b2.b2Manifold.e_faceA,a.m_localPlaneNormal.x=l-x.x,a.m_localPlaneNormal.y=m-x.y,a.m_localPlaneNormal.Normalize(),a.m_localPoint.SetV(x),a.m_points[0].m_localPoint.SetV(d.m_p),a.m_points[0].m_id.key=0}else if(0>=A){if((l-y.x)*(l-y.x)+(m-y.y)*(m-y.y)>p*p)return;a.m_pointCount=1,a.m_type=b2.b2Manifold.e_faceA,a.m_localPlaneNormal.x=l-y.x,a.m_localPlaneNormal.y=m-y.y,a.m_localPlaneNormal.Normalize(),a.m_localPoint.SetV(y),a.m_points[0].m_localPoint.SetV(d.m_p),a.m_points[0].m_id.key=0}else{var B=.5*(x.x+y.x),C=.5*(x.y+y.y);if(o=(l-B)*s[v].x+(m-C)*s[v].y,o>p)return;a.m_pointCount=1,a.m_type=b2.b2Manifold.e_faceA,a.m_localPlaneNormal.x=s[v].x,a.m_localPlaneNormal.y=s[v].y,a.m_localPlaneNormal.Normalize(),a.m_localPoint.Set(B,C),a.m_points[0].m_localPoint.SetV(d.m_p),a.m_points[0].m_id.key=0}},b2.b2Collision.TestOverlap=function(a,b){var c,d,e=b.lowerBound,f=a.upperBound,g=e.x-f.x,h=e.y-f.y;return e=a.lowerBound,f=b.upperBound,c=e.x-f.x,d=e.y-f.y,g>0||h>0?!1:c>0||d>0?!1:!0},b2.b2Collision.b2_nullFeature=255,b2.b2Collision.s_incidentEdge=b2.b2Collision.MakeClipPointVector(),b2.b2Collision.s_clipPoints1=b2.b2Collision.MakeClipPointVector(),b2.b2Collision.s_clipPoints2=b2.b2Collision.MakeClipPointVector(),b2.b2Collision.s_edgeAO=new Array(1),b2.b2Collision.s_edgeBO=new Array(1),b2.b2Collision.s_localTangent=new b2.b2Vec2,b2.b2Collision.s_localNormal=new b2.b2Vec2,b2.b2Collision.s_planePoint=new b2.b2Vec2,b2.b2Collision.s_normal=new b2.b2Vec2,b2.b2Collision.s_tangent=new b2.b2Vec2,b2.b2Collision.s_tangent2=new b2.b2Vec2,b2.b2Collision.s_v11=new b2.b2Vec2,b2.b2Collision.s_v12=new b2.b2Vec2,b2.b2Collision.b2CollidePolyTempVec=new b2.b2Vec2,b2.b2PolyAndCircleContact=function(){b2.b2Contact.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2PolyAndCircleContact.prototype,b2.b2Contact.prototype),b2.b2PolyAndCircleContact.prototype._super=b2.b2Contact.prototype,b2.b2PolyAndCircleContact.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2PolyAndCircleContact.prototype.__varz=function(){},b2.b2PolyAndCircleContact.Create=function(a){return new b2.b2PolyAndCircleContact},b2.b2PolyAndCircleContact.Destroy=function(a,b){},b2.b2PolyAndCircleContact.prototype.Evaluate=function(){var a=this.m_fixtureA.m_body,b=this.m_fixtureB.m_body;b2.b2Collision.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape(),a.m_xf,this.m_fixtureB.GetShape(),b.m_xf)},b2.b2PolyAndCircleContact.prototype.Reset=function(a,b){this._super.Reset.apply(this,[a,b]),b2.b2Settings.b2Assert(a.GetType()==b2.b2Shape.e_polygonShape),b2.b2Settings.b2Assert(b.GetType()==b2.b2Shape.e_circleShape)},b2.b2ContactPoint=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactPoint.prototype.__constructor=function(){},b2.b2ContactPoint.prototype.__varz=function(){this.position=new b2.b2Vec2,this.velocity=new b2.b2Vec2,this.normal=new b2.b2Vec2,this.id=new b2.b2ContactID},b2.b2ContactPoint.prototype.shape1=null,b2.b2ContactPoint.prototype.shape2=null,b2.b2ContactPoint.prototype.position=new b2.b2Vec2,b2.b2ContactPoint.prototype.velocity=new b2.b2Vec2,b2.b2ContactPoint.prototype.normal=new b2.b2Vec2,b2.b2ContactPoint.prototype.separation=null,b2.b2ContactPoint.prototype.friction=null,b2.b2ContactPoint.prototype.restitution=null,b2.b2ContactPoint.prototype.id=new b2.b2ContactID,b2.b2CircleContact=function(){b2.b2Contact.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2CircleContact.prototype,b2.b2Contact.prototype),b2.b2CircleContact.prototype._super=b2.b2Contact.prototype,b2.b2CircleContact.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2CircleContact.prototype.__varz=function(){},b2.b2CircleContact.Create=function(a){return new b2.b2CircleContact},b2.b2CircleContact.Destroy=function(a,b){},b2.b2CircleContact.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),b=this.m_fixtureB.GetBody();b2.b2Collision.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape(),a.m_xf,this.m_fixtureB.GetShape(),b.m_xf)},b2.b2CircleContact.prototype.Reset=function(a,b){this._super.Reset.apply(this,[a,b])},b2.b2EdgeAndCircleContact=function(){b2.b2Contact.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)},b2.extend(b2.b2EdgeAndCircleContact.prototype,b2.b2Contact.prototype),b2.b2EdgeAndCircleContact.prototype._super=b2.b2Contact.prototype,b2.b2EdgeAndCircleContact.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments)},b2.b2EdgeAndCircleContact.prototype.__varz=function(){},b2.b2EdgeAndCircleContact.Create=function(a){return new b2.b2EdgeAndCircleContact},b2.b2EdgeAndCircleContact.Destroy=function(a,b){},b2.b2EdgeAndCircleContact.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),b=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape(),a.m_xf,this.m_fixtureB.GetShape(),b.m_xf)},b2.b2EdgeAndCircleContact.prototype.b2CollideEdgeAndCircle=function(a,b,c,d,e){},b2.b2EdgeAndCircleContact.prototype.Reset=function(a,b){this._super.Reset.apply(this,[a,b])},b2.b2ContactManager=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2ContactManager.prototype.__constructor=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=b2.b2ContactFilter.b2_defaultFilter,this.m_contactListener=b2.b2ContactListener.b2_defaultListener,this.m_contactFactory=new b2.b2ContactFactory(this.m_allocator),this.m_broadPhase=new b2.b2DynamicTreeBroadPhase},b2.b2ContactManager.prototype.__varz=function(){},b2.b2ContactManager.s_evalCP=new b2.b2ContactPoint,b2.b2ContactManager.prototype.AddPair=function(a,b){var c=a,d=b,e=c.GetBody(),f=d.GetBody();if(e!=f){for(var g,h,i=f.GetContactList();i;){if(i.other==e){if(g=i.contact.GetFixtureA(),h=i.contact.GetFixtureB(),g==c&&h==d)return;if(g==d&&h==c)return}i=i.next}if(0!=f.ShouldCollide(e)&&0!=this.m_contactFilter.ShouldCollide(c,d)){var j=this.m_contactFactory.Create(c,d);c=j.GetFixtureA(),d=j.GetFixtureB(),e=c.m_body,f=d.m_body,j.m_prev=null,j.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=j),this.m_world.m_contactList=j,j.m_nodeA.contact=j,j.m_nodeA.other=f,j.m_nodeA.prev=null,j.m_nodeA.next=e.m_contactList,null!=e.m_contactList&&(e.m_contactList.prev=j.m_nodeA),e.m_contactList=j.m_nodeA,j.m_nodeB.contact=j,j.m_nodeB.other=e,j.m_nodeB.prev=null,j.m_nodeB.next=f.m_contactList,null!=f.m_contactList&&(f.m_contactList.prev=j.m_nodeB),f.m_contactList=j.m_nodeB,++this.m_world.m_contactCount}}},b2.b2ContactManager.prototype.FindNewContacts=function(){var a=this;this.m_broadPhase.UpdatePairs(function(b,c){return a.AddPair(b,c)})},b2.b2ContactManager.prototype.Destroy=function(a){var b=a.GetFixtureA(),c=a.GetFixtureB(),d=b.GetBody(),e=c.GetBody();a.IsTouching()&&this.m_contactListener.EndContact(a),a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a==this.m_world.m_contactList&&(this.m_world.m_contactList=a.m_next),a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next),a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev),a.m_nodeA==d.m_contactList&&(d.m_contactList=a.m_nodeA.next),a.m_nodeB.prev&&(a.m_nodeB.prev.next=a.m_nodeB.next),a.m_nodeB.next&&(a.m_nodeB.next.prev=a.m_nodeB.prev),a.m_nodeB==e.m_contactList&&(e.m_contactList=a.m_nodeB.next),this.m_contactFactory.Destroy(a),--this.m_contactCount},b2.b2ContactManager.prototype.Collide=function(){for(var a,b,c,d,e,f,g,h,i=this.m_world.m_contactList;i;)if(a=i.GetFixtureA(),b=i.GetFixtureB(),c=a.GetBody(),d=b.GetBody(),0!=c.IsAwake()||0!=d.IsAwake()){if(i.m_flags&b2.b2Contact.e_filterFlag){if(0==d.ShouldCollide(c)){e=i,i=e.GetNext(),this.Destroy(e);continue}if(0==this.m_contactFilter.ShouldCollide(a,b)){e=i,i=e.GetNext(),this.Destroy(e);continue}i.m_flags&=~b2.b2Contact.e_filterFlag}f=a.m_proxy,g=b.m_proxy,h=this.m_broadPhase.TestOverlap(f,g),0!=h?(i.Update(this.m_contactListener),i=i.GetNext()):(e=i,i=e.GetNext(),this.Destroy(e))}else i=i.GetNext()},b2.b2ContactManager.prototype.m_world=null,b2.b2ContactManager.prototype.m_broadPhase=null,b2.b2ContactManager.prototype.m_contactList=null,b2.b2ContactManager.prototype.m_contactCount=0,b2.b2ContactManager.prototype.m_contactFilter=null,b2.b2ContactManager.prototype.m_contactListener=null,b2.b2ContactManager.prototype.m_contactFactory=null,b2.b2ContactManager.prototype.m_allocator=null,b2.b2World=function(){this.__varz(),this.__constructor.apply(this,arguments)},b2.b2World.prototype.__constructor=function(a,b){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,b2.b2World.m_warmStarting=!0,b2.b2World.m_continuousPhysics=!0,this.m_allowSleep=b,this.m_gravity=a,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var c=new b2.b2BodyDef;this.m_groundBody=this.CreateBody(c)},b2.b2World.prototype.__varz=function(){this.s_stack=[],this.m_contactManager=new b2.b2ContactManager,
this.m_contactSolver=new b2.b2ContactSolver,this.m_island=new b2.b2Island},b2.b2World.s_timestep2=new b2.b2TimeStep,b2.b2World.s_backupA=new b2.b2Sweep,b2.b2World.s_backupB=new b2.b2Sweep,b2.b2World.s_timestep=new b2.b2TimeStep,b2.b2World.s_queue=[],b2.b2World.e_newFixture=1,b2.b2World.e_locked=2,b2.b2World.s_xf=new b2.b2Transform,b2.b2World.s_jointColor=new b2.b2Color(.5,.8,.8),b2.b2World.m_warmStarting=null,b2.b2World.m_continuousPhysics=null,b2.b2World.prototype.Solve=function(a){var b,c,d,e,f,g,h;for(c=this.m_controllerList;c;c=c.m_next)c.Step(a);for(d=this.m_island,d.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~b2.b2Body.e_islandFlag;for(e=this.m_contactList;e;e=e.m_next)e.m_flags&=~b2.b2Contact.e_islandFlag;for(j=this.m_jointList;j;j=j.m_next)j.m_islandFlag=!1;for(f=this.m_bodyCount,g=this.s_stack,h=this.m_bodyList;h;h=h.m_next)if(!(h.m_flags&b2.b2Body.e_islandFlag)&&0!=h.IsAwake()&&0!=h.IsActive()&&h.GetType()!=b2.b2Body.b2_staticBody){d.Clear();var i=0;for(g[i++]=h,h.m_flags|=b2.b2Body.e_islandFlag;i>0;)if(b=g[--i],d.AddBody(b),0==b.IsAwake()&&b.SetAwake(!0),b.GetType()!=b2.b2Body.b2_staticBody){for(var k,l=b.m_contactList;l;l=l.next)l.contact.m_flags&b2.b2Contact.e_islandFlag||1!=l.contact.IsSensor()&&0!=l.contact.IsEnabled()&&0!=l.contact.IsTouching()&&(d.AddContact(l.contact),l.contact.m_flags|=b2.b2Contact.e_islandFlag,k=l.other,k.m_flags&b2.b2Body.e_islandFlag||(g[i++]=k,k.m_flags|=b2.b2Body.e_islandFlag));for(var m=b.m_jointList;m;m=m.next)1!=m.joint.m_islandFlag&&(k=m.other,0!=k.IsActive()&&(d.AddJoint(m.joint),m.joint.m_islandFlag=!0,k.m_flags&b2.b2Body.e_islandFlag||(g[i++]=k,k.m_flags|=b2.b2Body.e_islandFlag)))}d.Solve(a,this.m_gravity,this.m_allowSleep);for(var n=0;n<d.m_bodyCount;++n)b=d.m_bodies[n],b.GetType()==b2.b2Body.b2_staticBody&&(b.m_flags&=~b2.b2Body.e_islandFlag)}for(n=0;n<g.length&&g[n];++n)g[n]=null;for(b=this.m_bodyList;b;b=b.m_next)0!=b.IsAwake()&&0!=b.IsActive()&&b.GetType()!=b2.b2Body.b2_staticBody&&b.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},b2.b2World.prototype.SolveTOI=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this.m_island;for(o.Initialize(this.m_bodyCount,b2.b2Settings.b2_maxTOIContactsPerIsland,b2.b2Settings.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver),i=b2.b2World.s_queue,b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~b2.b2Body.e_islandFlag,b.m_sweep.t0=0;for(j=this.m_contactList;j;j=j.m_next)j.m_flags&=~(b2.b2Contact.e_toiFlag|b2.b2Contact.e_islandFlag);for(h=this.m_jointList;h;h=h.m_next)h.m_islandFlag=!1;for(;;){for(k=null,l=1,j=this.m_contactList;j;j=j.m_next)if(1!=j.IsSensor()&&0!=j.IsEnabled()&&0!=j.IsContinuous()){if(m=1,j.m_flags&b2.b2Contact.e_toiFlag)m=j.m_toi;else{if(c=j.m_fixtureA,d=j.m_fixtureB,e=c.m_body,f=d.m_body,!(e.GetType()==b2.b2Body.b2_dynamicBody&&0!=e.IsAwake()||f.GetType()==b2.b2Body.b2_dynamicBody&&0!=f.IsAwake()))continue;n=e.m_sweep.t0,e.m_sweep.t0<f.m_sweep.t0?(n=f.m_sweep.t0,e.m_sweep.Advance(n)):f.m_sweep.t0<e.m_sweep.t0&&(n=e.m_sweep.t0,f.m_sweep.Advance(n)),m=j.ComputeTOI(e.m_sweep,f.m_sweep),b2.b2Settings.b2Assert(m>=0&&1>=m),m>0&&1>m&&(m=(1-m)*n+m,m>1&&(m=1)),j.m_toi=m,j.m_flags|=b2.b2Contact.e_toiFlag}Number.MIN_VALUE<m&&l>m&&(k=j,l=m)}if(null==k||1-100*Number.MIN_VALUE<l)break;if(c=k.m_fixtureA,d=k.m_fixtureB,e=c.m_body,f=d.m_body,b2.b2World.s_backupA.Set(e.m_sweep),b2.b2World.s_backupB.Set(f.m_sweep),e.Advance(l),f.Advance(l),k.Update(this.m_contactManager.m_contactListener),k.m_flags&=~b2.b2Contact.e_toiFlag,1!=k.IsSensor()&&0!=k.IsEnabled()){if(0!=k.IsTouching()){var p=e;p.GetType()!=b2.b2Body.b2_dynamicBody&&(p=f),o.Clear();var q=0,r=0;for(i[q+r++]=p,p.m_flags|=b2.b2Body.e_islandFlag;r>0;)if(b=i[q++],--r,o.AddBody(b),0==b.IsAwake()&&b.SetAwake(!0),b.GetType()==b2.b2Body.b2_dynamicBody){for(g=b.m_contactList;g&&o.m_contactCount!=o.m_contactCapacity;g=g.next)if(!(g.contact.m_flags&b2.b2Contact.e_islandFlag)&&1!=g.contact.IsSensor()&&0!=g.contact.IsEnabled()&&0!=g.contact.IsTouching()){o.AddContact(g.contact),g.contact.m_flags|=b2.b2Contact.e_islandFlag;var s=g.other;s.m_flags&b2.b2Body.e_islandFlag||(s.GetType()!=b2.b2Body.b2_staticBody&&(s.Advance(l),s.SetAwake(!0)),i[q+r]=s,++r,s.m_flags|=b2.b2Body.e_islandFlag)}for(var t=b.m_jointList;t;t=t.next)o.m_jointCount!=o.m_jointCapacity&&1!=t.joint.m_islandFlag&&(s=t.other,0!=s.IsActive()&&(o.AddJoint(t.joint),t.joint.m_islandFlag=!0,s.m_flags&b2.b2Body.e_islandFlag||(s.GetType()!=b2.b2Body.b2_staticBody&&(s.Advance(l),s.SetAwake(!0)),i[q+r]=s,++r,s.m_flags|=b2.b2Body.e_islandFlag)))}var u=b2.b2World.s_timestep;u.warmStarting=!1,u.dt=(1-l)*a.dt,u.inv_dt=1/u.dt,u.dtRatio=0,u.velocityIterations=a.velocityIterations,u.positionIterations=a.positionIterations,o.SolveTOI(u);var v=0;for(v=0;v<o.m_bodyCount;++v)if(b=o.m_bodies[v],b.m_flags&=~b2.b2Body.e_islandFlag,0!=b.IsAwake()&&b.GetType()==b2.b2Body.b2_dynamicBody)for(b.SynchronizeFixtures(),g=b.m_contactList;g;g=g.next)g.contact.m_flags&=~b2.b2Contact.e_toiFlag;for(v=0;v<o.m_contactCount;++v)j=o.m_contacts[v],j.m_flags&=~(b2.b2Contact.e_toiFlag|b2.b2Contact.e_islandFlag);for(v=0;v<o.m_jointCount;++v)h=o.m_joints[v],h.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else e.m_sweep.Set(b2.b2World.s_backupA),f.m_sweep.Set(b2.b2World.s_backupB),e.SynchronizeTransform(),f.SynchronizeTransform()}},b2.b2World.prototype.DrawJoint=function(a){var b=a.GetBodyA(),c=a.GetBodyB(),d=b.m_xf,e=c.m_xf,f=d.position,g=e.position,h=a.GetAnchorA(),i=a.GetAnchorB(),j=b2.b2World.s_jointColor;switch(a.m_type){case b2.b2Joint.e_distanceJoint:this.m_debugDraw.DrawSegment(h,i,j);break;case b2.b2Joint.e_pulleyJoint:var k=a,l=k.GetGroundAnchorA(),m=k.GetGroundAnchorB();this.m_debugDraw.DrawSegment(l,h,j),this.m_debugDraw.DrawSegment(m,i,j),this.m_debugDraw.DrawSegment(l,m,j);break;case b2.b2Joint.e_mouseJoint:this.m_debugDraw.DrawSegment(h,i,j);break;default:b!=this.m_groundBody&&this.m_debugDraw.DrawSegment(f,h,j),this.m_debugDraw.DrawSegment(h,i,j),c!=this.m_groundBody&&this.m_debugDraw.DrawSegment(g,i,j)}},b2.b2World.prototype.DrawShape=function(a,b,c){switch(a.m_type){case b2.b2Shape.e_circleShape:var d=a,e=b2.b2Math.MulX(b,d.m_p),f=d.m_radius,g=b.R.col1;this.m_debugDraw.DrawSolidCircle(e,f,g,c);break;case b2.b2Shape.e_polygonShape:var h=0,i=a,j=i.GetVertexCount(),k=i.GetVertices(),l=new Array(j);for(h=0;j>h;++h)l[h]=b2.b2Math.MulX(b,k[h]);this.m_debugDraw.DrawSolidPolygon(l,j,c);break;case b2.b2Shape.e_edgeShape:var m=a;this.m_debugDraw.DrawSegment(b2.b2Math.MulX(b,m.GetVertex1()),b2.b2Math.MulX(b,m.GetVertex2()),c)}},b2.b2World.prototype.SetDestructionListener=function(a){this.m_destructionListener=a},b2.b2World.prototype.SetContactFilter=function(a){this.m_contactManager.m_contactFilter=a},b2.b2World.prototype.SetContactListener=function(a){this.m_contactManager.m_contactListener=a},b2.b2World.prototype.SetDebugDraw=function(a){this.m_debugDraw=a},b2.b2World.prototype.SetBroadPhase=function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;c;c=c.m_next)for(var d=c.m_fixtureList;d;d=d.m_next)d.m_proxy=a.CreateProxy(b.GetFatAABB(d.m_proxy),d)},b2.b2World.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},b2.b2World.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},b2.b2World.prototype.CreateBody=function(a){if(1==this.IsLocked())return null;var b=new b2.b2Body(a,this);return b.m_prev=null,b.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=b),this.m_bodyList=b,++this.m_bodyCount,b},b2.b2World.prototype.DestroyBody=function(a){if(1!=this.IsLocked()){for(var b=a.m_jointList;b;){var c=b;b=b.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(c.joint),this.DestroyJoint(c.joint)}for(var d=a.m_controllerList;d;){var e=d;d=d.nextController,e.controller.RemoveBody(a)}for(var f=a.m_contactList;f;){var g=f;f=f.next,this.m_contactManager.Destroy(g.contact)}a.m_contactList=null;for(var h=a.m_fixtureList;h;){var i=h;h=h.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(i),i.DestroyProxy(this.m_contactManager.m_broadPhase),i.Destroy()}a.m_fixtureList=null,a.m_fixtureCount=0,a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a==this.m_bodyList&&(this.m_bodyList=a.m_next),--this.m_bodyCount}},b2.b2World.prototype.CreateJoint=function(a){var b=b2.b2Joint.Create(a,null);b.m_prev=null,b.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=b),this.m_jointList=b,++this.m_jointCount,b.m_edgeA.joint=b,b.m_edgeA.other=b.m_bodyB,b.m_edgeA.prev=null,b.m_edgeA.next=b.m_bodyA.m_jointList,b.m_bodyA.m_jointList&&(b.m_bodyA.m_jointList.prev=b.m_edgeA),b.m_bodyA.m_jointList=b.m_edgeA,b.m_edgeB.joint=b,b.m_edgeB.other=b.m_bodyA,b.m_edgeB.prev=null,b.m_edgeB.next=b.m_bodyB.m_jointList,b.m_bodyB.m_jointList&&(b.m_bodyB.m_jointList.prev=b.m_edgeB),b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(0==a.collideConnected)for(var e=d.GetContactList();e;)e.other==c&&e.contact.FlagForFiltering(),e=e.next;return b},b2.b2World.prototype.DestroyJoint=function(a){var b=a.m_collideConnected;a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a==this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,d=a.m_bodyB;if(c.SetAwake(!0),d.SetAwake(!0),a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next),a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev),a.m_edgeA==c.m_jointList&&(c.m_jointList=a.m_edgeA.next),a.m_edgeA.prev=null,a.m_edgeA.next=null,a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next),a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev),a.m_edgeB==d.m_jointList&&(d.m_jointList=a.m_edgeB.next),a.m_edgeB.prev=null,a.m_edgeB.next=null,b2.b2Joint.Destroy(a,null),--this.m_jointCount,0==b)for(var e=d.GetContactList();e;)e.other==c&&e.contact.FlagForFiltering(),e=e.next},b2.b2World.prototype.AddController=function(a){return a.m_next=this.m_controllerList,a.m_prev=null,this.m_controllerList=a,a.m_world=this,this.m_controllerCount++,a},b2.b2World.prototype.RemoveController=function(a){a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),this.m_controllerList==a&&(this.m_controllerList=a.m_next),this.m_controllerCount--},b2.b2World.prototype.CreateController=function(a){if(a.m_world!=this)throw new Error("Controller can only be a member of one world");return a.m_next=this.m_controllerList,a.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=a),this.m_controllerList=a,++this.m_controllerCount,a.m_world=this,a},b2.b2World.prototype.DestroyController=function(a){a.Clear(),a.m_next&&(a.m_next.m_prev=a.m_prev),a.m_prev&&(a.m_prev.m_next=a.m_next),a==this.m_controllerList&&(this.m_controllerList=a.m_next),--this.m_controllerCount},b2.b2World.prototype.SetWarmStarting=function(a){b2.b2World.m_warmStarting=a},b2.b2World.prototype.SetContinuousPhysics=function(a){b2.b2World.m_continuousPhysics=a},b2.b2World.prototype.GetBodyCount=function(){return this.m_bodyCount},b2.b2World.prototype.GetJointCount=function(){return this.m_jointCount},b2.b2World.prototype.GetContactCount=function(){return this.m_contactCount},b2.b2World.prototype.SetGravity=function(a){this.m_gravity=a},b2.b2World.prototype.GetGravity=function(){return this.m_gravity},b2.b2World.prototype.GetGroundBody=function(){return this.m_groundBody},b2.b2World.prototype.Step=function(a,b,c){this.m_flags&b2.b2World.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~b2.b2World.e_newFixture),this.m_flags|=b2.b2World.e_locked;var d=b2.b2World.s_timestep2;d.dt=a,d.velocityIterations=b,d.positionIterations=c,a>0?d.inv_dt=1/a:d.inv_dt=0,d.dtRatio=this.m_inv_dt0*a,d.warmStarting=b2.b2World.m_warmStarting,this.m_contactManager.Collide(),d.dt>0&&this.Solve(d),b2.b2World.m_continuousPhysics&&d.dt>0&&this.SolveTOI(d),d.dt>0&&(this.m_inv_dt0=d.inv_dt),this.m_flags&=~b2.b2World.e_locked},b2.b2World.prototype.ClearForces=function(){for(var a=this.m_bodyList;a;a=a.m_next)a.m_force.SetZero(),a.m_torque=0},b2.b2World.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.Clear();var a,b,c,d,e,f,g=this.m_debugDraw.GetFlags(),h=(new b2.b2Vec2,new b2.b2Vec2,new b2.b2Vec2,[new b2.b2Vec2,new b2.b2Vec2,new b2.b2Vec2,new b2.b2Vec2]),i=new b2.b2Color(0,0,0);if(g&b2.b2DebugDraw.e_shapeBit)for(a=this.m_bodyList;a;a=a.m_next)for(f=a.m_xf,b=a.GetFixtureList();b;b=b.m_next)c=b.GetShape(),0==a.IsActive()?(i.Set(.5,.5,.3),this.DrawShape(c,f,i)):a.GetType()==b2.b2Body.b2_staticBody?(i.Set(.5,.9,.5),this.DrawShape(c,f,i)):a.GetType()==b2.b2Body.b2_kinematicBody?(i.Set(.5,.5,.9),this.DrawShape(c,f,i)):(0==a.IsAwake()&&(i.Set(.6,.6,.6),this.DrawShape(c,f,i)),1==b.IsSensor()?(i.Set(.55,.56,.55),this.DrawShape(c,f,i)):(i.Set(.9,.7,.7),this.DrawShape(c,f,i)));if(g&b2.b2DebugDraw.e_jointBit)for(d=this.m_jointList;d;d=d.m_next)this.DrawJoint(d);if(g&b2.b2DebugDraw.e_controllerBit)for(var j=this.m_controllerList;j;j=j.m_next)j.Draw(this.m_debugDraw);if(g&b2.b2DebugDraw.e_pairBit){i.Set(.3,.9,.9);for(var k=this.m_contactManager.m_contactList;k;k=k.GetNext()){var l=k.GetFixtureA(),m=k.GetFixtureB(),n=l.GetAABB().GetCenter(),o=m.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(n,o,i)}}if(g&b2.b2DebugDraw.e_aabbBit)for(e=this.m_contactManager.m_broadPhase,h=[new b2.b2Vec2,new b2.b2Vec2,new b2.b2Vec2,new b2.b2Vec2],a=this.m_bodyList;a;a=a.GetNext())if(0!=a.IsActive())for(b=a.GetFixtureList();b;b=b.GetNext()){var p=e.GetFatAABB(b.m_proxy);h[0].Set(p.lowerBound.x,p.lowerBound.y),h[1].Set(p.upperBound.x,p.lowerBound.y),h[2].Set(p.upperBound.x,p.upperBound.y),h[3].Set(p.lowerBound.x,p.upperBound.y),this.m_debugDraw.DrawPolygon(h,4,i)}if(g&b2.b2DebugDraw.e_centerOfMassBit)for(a=this.m_bodyList;a;a=a.m_next)f=b2.b2World.s_xf,f.R=a.m_xf.R,f.position=a.GetWorldCenter(),this.m_debugDraw.DrawTransform(f)}},b2.b2World.prototype.QueryAABB=function(a,b){function c(b){return a(d.GetUserData(b))}var d=this.m_contactManager.m_broadPhase;d.Query(c,b)},b2.b2World.prototype.QueryShape=function(a,b,c){function d(d){var f=e.GetUserData(d);return b2.b2Shape.TestOverlap(b,c,f.GetShape(),f.GetBody().GetTransform())?a(f):!0}null==c&&(c=new b2.b2Transform,c.SetIdentity());var e=this.m_contactManager.m_broadPhase,f=new b2.b2AABB;b.ComputeAABB(f,c),e.Query(d,f)},b2.b2World.prototype.QueryPoint=function(a,b){function c(c){var e=d.GetUserData(c);return e.TestPoint(b)?a(e):!0}var d=this.m_contactManager.m_broadPhase,e=new b2.b2AABB;e.lowerBound.Set(b.x-b2.b2Settings.b2_linearSlop,b.y-b2.b2Settings.b2_linearSlop),e.upperBound.Set(b.x+b2.b2Settings.b2_linearSlop,b.y+b2.b2Settings.b2_linearSlop),d.Query(c,e)},b2.b2World.prototype.RayCast=function(a,b,c){function d(d,e){var h=f.GetUserData(e),i=h,j=i.RayCast(g,d);if(j){var k=g.fraction,l=new b2.b2Vec2((1-k)*b.x+k*c.x,(1-k)*b.y+k*c.y);return a(i,l,g.normal,k)}return d.maxFraction}var e,f=this.m_contactManager.m_broadPhase,g=new b2.b2RayCastOutput;e=new b2.b2RayCastInput(b,c),f.RayCast(d,e)},b2.b2World.prototype.RayCastOne=function(a,b){function c(a,b,c,e){return d=a,e}var d;return this.RayCast(c,a,b),d},b2.b2World.prototype.RayCastAll=function(a,b){function c(a,b,c,e){return d[d.length]=a,1}var d=[];return this.RayCast(c,a,b),d},b2.b2World.prototype.GetBodyList=function(){return this.m_bodyList},b2.b2World.prototype.GetJointList=function(){return this.m_jointList},b2.b2World.prototype.GetContactList=function(){return this.m_contactList},b2.b2World.prototype.IsLocked=function(){return(this.m_flags&b2.b2World.e_locked)>0},b2.b2World.prototype.s_stack=[],b2.b2World.prototype.m_flags=0,b2.b2World.prototype.m_contactManager=new b2.b2ContactManager,b2.b2World.prototype.m_contactSolver=new b2.b2ContactSolver,b2.b2World.prototype.m_island=new b2.b2Island,b2.b2World.prototype.m_bodyList=null,b2.b2World.prototype.m_jointList=null,b2.b2World.prototype.m_contactList=null,b2.b2World.prototype.m_bodyCount=0,b2.b2World.prototype.m_contactCount=0,b2.b2World.prototype.m_jointCount=0,b2.b2World.prototype.m_controllerList=null,b2.b2World.prototype.m_controllerCount=0,b2.b2World.prototype.m_gravity=null,b2.b2World.prototype.m_allowSleep=null,b2.b2World.prototype.m_groundBody=null,b2.b2World.prototype.m_destructionListener=null,b2.b2World.prototype.m_debugDraw=null,b2.b2World.prototype.m_inv_dt0=null}(),function(){"use strict";function a(){this.EventDispatcher_constructor()}var b=cjs.extend(a,cjs.EventDispatcher);b.listenForBackButton=function(){document.addEventListener("backbutton",this._onBackButtonEvent.bind(this)),cm.debug&&window.addEventListener("keydown",this._onTestKey.bind(this),!1)},b._onTestKey=function(a){var b=a.nativeEvent||a;66===b.keyCode&&this._onBackButtonEvent()},b._onBackButtonEvent=function(a){this.dispatchEvent(new cjs.Event("BACK_BUTTON",!0,!0))};var c=createjs.promote(a,"EventDispatcher");cm.CordovaUtils=new c}(),function(){"use strict";function a(){this.available=!1,this.requestFullscreen=null,this.cancelFullscreen=null,this.performCheck()}var b=a.prototype;b.performCheck=function(){for(var a=document.documentElement,b=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"],c=0;c<b.length;c++)if(a[b[c]]){this.requestFullscreen=b[c];break}if(this.requestFullscreen)for(b=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"],c=0;c<b.length;c++)if(document[b[c]]){this.cancelFullscreen=b[c];break}this.available=!!this.requestFullscreen&&!!this.cancelFullscreen},b.request=function(a){if(this.available)try{a[this.requestFullscreen]()}catch(b){}},b.cancel=function(){if(this.available)try{document[this.cancelFullscreen]()}catch(a){}},cm.Fullscreen=new a}(),function(){"use strict";if(cm.Device.OS.iOS===!0){cm.log("performAudioDistortionFix");var a=window.AudioContext||window.webkitAudioContext;if(a)try{var b=new a,c=b.createBuffer(1,1,44100),d=b.createBufferSource();d.buffer=c,d.connect(b.destination),d.start(0),d.disconnect(),b&&b.close&&b.close()}catch(e){}}}(),window.AppConfig={assets:{Boot:[{id:"AnimClear",src:"assets/animations/clear-transition.js",type:"flash_animation"},{id:"JellyfishLoader",src:"assets/animations/loader/loader.js",assetsPath:"assets/animations/loader/",type:"flash_animation"},{id:"UISS",src:"assets/images/ss-ui.json",type:"spritesheet"},{id:"DemoHand",src:"assets/images/hand.png"},{id:"sfx-loading1",src:"assets/audio/sfx/loading1.ogg"},{id:"sfx-loading2",src:"assets/audio/sfx/loading2.ogg"},{id:"musicMenu",src:"assets/audio/music/mainmenu.ogg"},{id:"sfx-ambience-loop",src:"assets/audio/sfx/ambience-loop.ogg"}],Global:[{id:"sfx-home",src:"assets/audio/sfx/home.ogg"},{id:"FontSS",src:"assets/fonts/font.json",type:"spritesheet"},{id:"MainCharacters",src:"assets/animations/gameplay/main-characters.js",assetsPath:"assets/animations/gameplay/",type:"flash_animation"}],OceanGuide:[{id:"SeaweedSS",src:"assets/images/guide/ss-seaweed.json",type:"spritesheet"},{id:"GuideItemsSS",src:"assets/images/guide/ss-guide-items.json",type:"spritesheet"},{id:"GuideBackgroundsSS",src:"assets/images/guide/ss-guide-backgrounds.json",type:"spritesheet"}],Title:[{id:"musicTitle",src:"assets/audio/music/titlescreen.ogg"},{id:"voTitle",src:"assets/audio/vo/titlescreen/title-adventure.ogg"},{id:"TitleBG",src:"assets/images/title/background.jpg"},{id:"TitleSS",src:"assets/images/title/ss-title.json",type:"spritesheet"},{id:"sfx-play",src:"assets/audio/sfx/play.ogg"}],Map:[{id:"voMap",src:"assets/audio/vo/map/map.ogg"},{id:"voMapSunkenShip",src:"assets/audio/vo/map/sunkenship.ogg"},{id:"voMapReeftown",src:"assets/audio/vo/map/reeftownrock.ogg"},{id:"voMapDeep",src:"assets/audio/vo/map/thedeep.ogg"},{id:"voMapKelpForest",src:"assets/audio/vo/map/kelpforest.ogg"},{id:"voMapAntarctic",src:"assets/audio/vo/map/antarctic.ogg"},{id:"sfx-populate",src:"assets/audio/sfx/populate.ogg"},{id:"sfx-game-select",src:"assets/audio/sfx/game-select.ogg"},{id:"MapBG",src:"assets/images/map/background.jpg"},{id:"MapSS",src:"assets/images/map/ss-map.json",type:"spritesheet"}],LevelExplorer:[{id:"LevelPhysics",src:"assets/levels/level-physics.json"},{id:"GameSS",src:"assets/images/ss-game.json",type:"spritesheet"},{id:"GameplayAnim",src:"assets/animations/gameplay/gameplay.js",assetsPath:"assets/animations/gameplay/",type:"flash_animation"},{id:"sfx-whirlpool-loop",src:"assets/audio/sfx/whirlpool-loop.ogg"},{id:"sfx-rock",src:"assets/audio/sfx/rock.ogg"},{id:"sfx-open-tray-1",src:"assets/audio/sfx/open-tray-1.ogg"},{id:"sfx-open-tray-2",src:"assets/audio/sfx/open-tray-2.ogg"},{id:"sfx-swim-loop",src:"assets/audio/sfx/swim-loop.ogg"},{id:"sfx-pebbles",src:"assets/audio/sfx/pebbles.ogg"},{id:"sfx-rockhit",src:"assets/audio/sfx/rockhit.ogg"},{id:"sfx-sand",src:"assets/audio/sfx/sand.ogg"},{id:"sfx-collect",src:"assets/audio/sfx/collect.ogg"},{id:"voExplorerMove-Splash",src:"assets/audio/vo/scroller/flo/move-splash.ogg"},{id:"voExplorerMove-Bubbles",src:"assets/audio/vo/scroller/flo/move-bubbles.ogg"},{id:"voExplorerMove-Dunk",src:"assets/audio/vo/scroller/flo/move-dunk.ogg"},{id:"voExplorerMove-Ripple",src:"assets/audio/vo/scroller/flo/move-ripple.ogg"},{id:"voExplorer2",src:"assets/audio/vo/scroller/flo/directions2.ogg"},{id:"voExplorer3",src:"assets/audio/vo/scroller/flo/directions3.ogg"},{id:"voExplorer4",src:"assets/audio/vo/scroller/flo/directions4.ogg"},{id:"voExplorer6",src:"assets/audio/vo/scroller/flo/directions6.ogg"}],LevelReeftown:[{id:"musicLocation",src:"assets/audio/music/reeftown.ogg"},{id:"voLevelWelcome",src:"assets/audio/vo/scroller/flo/welcome-reeftown.ogg"},{id:"LevelUISS",src:"assets/levels/reeftown/ss-reeftown.json",type:"spritesheet"},{id:"LevelLib",src:"assets/levels/reeftown/reeftown.js",assetsPath:"assets/levels/reeftown/",type:"flash_animation"},{id:"acroporacoral",src:"assets/audio/vo/guidebook/names/acroporacoral.ogg"},{id:"barnacles",src:"assets/audio/vo/guidebook/names/barnacles.ogg"},{id:"barrelsponge",src:"assets/audio/vo/guidebook/names/barrelsponge.ogg"},{id:"braincoral",src:"assets/audio/vo/guidebook/names/braincoral.ogg"},{id:"charlie",src:"assets/audio/vo/guidebook/names/charlie.ogg"},{id:"chompy",src:"assets/audio/vo/guidebook/names/chompy.ogg"},{id:"coralpolyp",src:"assets/audio/vo/guidebook/names/coralpolyp.ogg"},{id:"coralrubble",src:"assets/audio/vo/guidebook/names/coralrubble.ogg"},{id:"denny",src:"assets/audio/vo/guidebook/names/denny.ogg"},{id:"featherduster",src:"assets/audio/vo/guidebook/names/featherduster.ogg"},{id:"flo",src:"assets/audio/vo/guidebook/names/flo.ogg"},{id:"flowercoral",src:"assets/audio/vo/guidebook/names/flowercoral.ogg"},{id:"gorgonians",src:"assets/audio/vo/guidebook/names/gorgonians.ogg"},{id:"gush",src:"assets/audio/vo/guidebook/names/gush.ogg"},{id:"leathercoral",src:"assets/audio/vo/guidebook/names/leathercoral.ogg"},{id:"maury",src:"assets/audio/vo/guidebook/names/maury.ogg"},{id:"pearl",src:"assets/audio/vo/guidebook/names/pearl.ogg"},{id:"pearlene",src:"assets/audio/vo/guidebook/names/pearlene.ogg"},{id:"pinkanthias",src:"assets/audio/vo/guidebook/names/pinkanthias.ogg"},{id:"platecoral",src:"assets/audio/vo/guidebook/names/platecoral.ogg"},{id:"scoutandsnap",src:"assets/audio/vo/guidebook/names/scoutandsnap.ogg"},{id:"sharktooth",src:"assets/audio/vo/guidebook/names/sharktooth.ogg"},{id:"shell",src:"assets/audio/vo/guidebook/names/shell.ogg"},{id:"starfish",src:"assets/audio/vo/guidebook/names/starfish.ogg"},{id:"wave",src:"assets/audio/vo/guidebook/names/wave.ogg"},{id:"zee",src:"assets/audio/vo/guidebook/names/zee.ogg"},{id:"splash-awesome",src:"assets/audio/vo/scroller/splash/awesome.ogg"},{id:"splash-good",src:"assets/audio/vo/scroller/splash/good.ogg"},{id:"splash-great",src:"assets/audio/vo/scroller/splash/great.ogg"},{id:"splash-thatone",src:"assets/audio/vo/scroller/splash/thatone.ogg"},{id:"splash-yes",src:"assets/audio/vo/scroller/splash/yes.ogg"},{id:"splash-youfound",src:"assets/audio/vo/scroller/splash/youfound.ogg"},{id:"splash-yougot",src:"assets/audio/vo/scroller/splash/yougot.ogg"},{id:"splash-hey",src:"assets/audio/vo/scroller/splash/hey.ogg"},{id:"splash-short-laugh-a",src:"assets/audio/vo/scroller/splash/short-laugh-a.ogg"},{id:"splash-short-laugh-e",src:"assets/audio/vo/scroller/splash/short-laugh-e.ogg"},{id:"splash-whoa-a",src:"assets/audio/vo/scroller/splash/whoa-a.ogg"},{id:"splash-woo-b",src:"assets/audio/vo/scroller/splash/woo-b.ogg"},{id:"bubbles-awesome",src:"assets/audio/vo/scroller/bubbles/awesome.ogg"},{id:"bubbles-foundit",src:"assets/audio/vo/scroller/bubbles/foundit.ogg"},{id:"bubbles-goodjob",src:"assets/audio/vo/scroller/bubbles/goodjob.ogg"},{id:"bubbles-gotit",src:"assets/audio/vo/scroller/bubbles/gotit.ogg"},{id:"bubbles-greatwork",src:"assets/audio/vo/scroller/bubbles/greatwork.ogg"},{id:"bubbles-hidden",src:"assets/audio/vo/scroller/bubbles/hidden.ogg"},{id:"bubbles-yes",src:"assets/audio/vo/scroller/bubbles/yes.ogg"},{id:"bubbles-hey",src:"assets/audio/vo/scroller/bubbles/hey.ogg"},{id:"bubbles-heytk2",src:"assets/audio/vo/scroller/bubbles/heytk2.ogg"},{id:"bubbles-short-laugh-a",src:"assets/audio/vo/scroller/bubbles/short-laugh-a.ogg"},{id:"bubbles-short-laugh-b",src:"assets/audio/vo/scroller/bubbles/short-laugh-b.ogg"},{id:"bubbles-short-laugh-c",src:"assets/audio/vo/scroller/bubbles/short-laugh-c.ogg"},{id:"bubbles-short-laugh-g",src:"assets/audio/vo/scroller/bubbles/short-laugh-g.ogg"},{id:"bubbles-wee-a",src:"assets/audio/vo/scroller/bubbles/wee-a.ogg"},{id:"bubbles-whoa-a",src:"assets/audio/vo/scroller/bubbles/whoa-a.ogg"},{id:"bubbles-woo-b",src:"assets/audio/vo/scroller/bubbles/woo-b.ogg"},{id:"dunk-awesome",src:"assets/audio/vo/scroller/dunk/awesome.ogg"},{id:"dunk-good",src:"assets/audio/vo/scroller/dunk/good.ogg"},{id:"dunk-great",src:"assets/audio/vo/scroller/dunk/great.ogg"},{id:"dunk-thatone",src:"assets/audio/vo/scroller/dunk/thatone.ogg"},{id:"dunk-youfound",src:"assets/audio/vo/scroller/dunk/youfound.ogg"},{id:"dunk-yougot",src:"assets/audio/vo/scroller/dunk/yougot.ogg"},{id:"dunk-yea",src:"assets/audio/vo/scroller/dunk/yea.ogg"},{id:"dunk-hey",src:"assets/audio/vo/scroller/dunk/hey.ogg"},{id:"dunk-short-laugh-b",src:"assets/audio/vo/scroller/dunk/short-laugh-b.ogg"},{id:"dunk-short-laugh-c",src:"assets/audio/vo/scroller/dunk/short-laugh-c.ogg"},{id:"dunk-short-laugh-e",src:"assets/audio/vo/scroller/dunk/short-laugh-e.ogg"},{id:"dunk-wee-c",src:"assets/audio/vo/scroller/dunk/wee-c.ogg"},{id:"dunk-woa-a",src:"assets/audio/vo/scroller/dunk/woa-a.ogg"},{id:"ripple-awesome",src:"assets/audio/vo/scroller/ripple/awesome.ogg"},{id:"ripple-good",src:"assets/audio/vo/scroller/ripple/good.ogg"},{id:"ripple-great",src:"assets/audio/vo/scroller/ripple/great.ogg"},{id:"ripple-thatone",src:"assets/audio/vo/scroller/ripple/thatone.ogg"},{id:"ripple-yes-a",src:"assets/audio/vo/scroller/ripple/yes-a.ogg"},{id:"ripple-youfound",src:"assets/audio/vo/scroller/ripple/youfound.ogg"},{id:"ripple-yougot-a",src:"assets/audio/vo/scroller/ripple/yougot-a.ogg"},{id:"ripple-hey-c",src:"assets/audio/vo/scroller/ripple/hey-c.ogg"},{id:"ripple-short-laugh-a",src:"assets/audio/vo/scroller/ripple/short-laugh-a.ogg"},{id:"ripple-wee-b",src:"assets/audio/vo/scroller/ripple/wee-b.ogg"},{id:"ripple-whoa-a",src:"assets/audio/vo/scroller/ripple/whoa-a.ogg"},{id:"ripple-woo",src:"assets/audio/vo/scroller/ripple/woo.ogg"},{id:"1left-alt",src:"assets/audio/vo/scroller/flo/1left-alt.ogg"},{id:"1left",src:"assets/audio/vo/scroller/flo/1left.ogg"},{id:"3left-alt",src:"assets/audio/vo/scroller/flo/3left-alt.ogg"},{id:"3left-take1",src:"assets/audio/vo/scroller/flo/3left-take1.ogg"},{id:"3left-take2",src:"assets/audio/vo/scroller/flo/3left-take2.ogg"},{id:"oceanguidestart",src:"assets/audio/vo/guidebook/misc/oceanguidestart.ogg"},{id:"directions5",src:"assets/audio/vo/scroller/flo/directions5.ogg"},{id:"noobject45",src:"assets/audio/vo/scroller/flo/noobject45.ogg"},{id:"reeftownrock",src:"assets/audio/vo/map/reeftownrock.ogg"},{id:"reeftownrock-sunkenship",src:"assets/audio/vo/map/reeftownrock-sunkenship.ogg"},{id:"acroporacoralfact",src:"assets/audio/vo/guidebook/funfacts/acroporacoralfact.ogg"},{id:"barnaclesfact",src:"assets/audio/vo/guidebook/funfacts/barnaclesfact.ogg"},{id:"barrelfact",src:"assets/audio/vo/guidebook/funfacts/barrelfact.ogg"},{id:"barrelspongefact",src:"assets/audio/vo/guidebook/funfacts/barrelspongefact.ogg"},{id:"braincoralfact",src:"assets/audio/vo/guidebook/funfacts/braincoralfact.ogg"},{id:"charliefact",src:"assets/audio/vo/guidebook/funfacts/charliefact.ogg"},{id:"chompyfact",src:"assets/audio/vo/guidebook/funfacts/chompyfact.ogg"},{id:"coralpolypfact",src:"assets/audio/vo/guidebook/funfacts/coralpolypfact.ogg"},{id:"coralrubblefact",src:"assets/audio/vo/guidebook/funfacts/coralrubblefact.ogg"},{id:"dennyfact",src:"assets/audio/vo/guidebook/funfacts/dennyfact.ogg"},{id:"featherdusterfact",src:"assets/audio/vo/guidebook/funfacts/featherdusterfact.ogg"},{id:"flofact",src:"assets/audio/vo/guidebook/funfacts/flofact.ogg"},{id:"flowercoralfact",src:"assets/audio/vo/guidebook/funfacts/flowercoralfact.ogg"},{id:"gorgoniansfact",src:"assets/audio/vo/guidebook/funfacts/gorgoniansfact.ogg"},{id:"gushfact",src:"assets/audio/vo/guidebook/funfacts/gushfact.ogg"},{id:"leathercoralfact",src:"assets/audio/vo/guidebook/funfacts/leathercoralfact.ogg"},{id:"mauryfact",src:"assets/audio/vo/guidebook/funfacts/mauryfact.ogg"},{id:"pearlenefact",src:"assets/audio/vo/guidebook/funfacts/pearlenefact.ogg"},{id:"pearlfact",src:"assets/audio/vo/guidebook/funfacts/pearlfact.ogg"},{id:"pinkanthiasfact",src:"assets/audio/vo/guidebook/funfacts/pinkanthiasfact.ogg"},{id:"platecoralfact",src:"assets/audio/vo/guidebook/funfacts/platecoralfact.ogg"},{id:"scoutandsnapfact",src:"assets/audio/vo/guidebook/funfacts/scoutandsnapfact.ogg"},{id:"sharktoothfact",src:"assets/audio/vo/guidebook/funfacts/sharktoothfact.ogg"},{id:"shellfact",src:"assets/audio/vo/guidebook/funfacts/shellfact.ogg"},{id:"starfishfact",src:"assets/audio/vo/guidebook/funfacts/starfishfact.ogg"},{id:"wavefact",src:"assets/audio/vo/guidebook/funfacts/wavefact.ogg"},{id:"zeefact",src:"assets/audio/vo/guidebook/funfacts/zeefact.ogg"},{id:"algae",src:"assets/audio/vo/guidebook/misc/algae.ogg"},{id:"guidereminder",src:"assets/audio/vo/guidebook/misc/guidereminder.ogg"},{id:"invertebrate",src:"assets/audio/vo/guidebook/misc/invertebrate.ogg"},{id:"nonliving",src:"assets/audio/vo/guidebook/misc/nonliving.ogg"},{id:"vertebrate",src:"assets/audio/vo/guidebook/misc/vertebrate.ogg"},{id:"obstacle-bubbles",src:"assets/audio/vo/obstacle/bubbles.ogg"},{id:"obstacle-current",src:"assets/audio/vo/obstacle/current.ogg"},{id:"obstacle-dunk",src:"assets/audio/vo/obstacle/dunk.ogg"},{id:"obstacle-pebbles-take1",src:"assets/audio/vo/obstacle/pebbles-take1.ogg"},{id:"obstacle-pebbles-take2",src:"assets/audio/vo/obstacle/pebbles-take2.ogg"},{id:"obstacle-ripple",src:"assets/audio/vo/obstacle/ripple.ogg"},{id:"obstacle-rocks",src:"assets/audio/vo/obstacle/rocks.ogg"},{id:"obstacle-sand",src:"assets/audio/vo/obstacle/sand.ogg"},{id:"obstacle-splash",src:"assets/audio/vo/obstacle/splash.ogg"}],OceanBuilder:[{id:"AreaTerrainPhysics",src:"assets/oceanbuilder/areaterrain-physics.json"},{id:"GameSS",src:"assets/images/ss-game.json",type:"spritesheet"},{id:"sfx-grab-item",src:"assets/audio/sfx/grab-item.ogg"},{id:"sfx-drop-item",src:"assets/audio/sfx/drop-item.ogg"},{id:"sfx-reset",src:"assets/audio/sfx/reset.ogg"},{id:"sfx-reset-negative",src:"assets/audio/sfx/reset-negative.ogg"},{id:"sfx-reset-positive",src:"assets/audio/sfx/reset-positive.ogg"},{id:"build-intro",src:"assets/audio/vo/buildmode/build-intro.ogg"},{id:"build-reset",src:"assets/audio/vo/buildmode/build-reset.ogg"},{id:"guidereminder",
src:"assets/audio/vo/guidebook/misc/guidereminder.ogg"}],AreaReeftown:[{id:"LevelUISS",src:"assets/levels/reeftown/ss-reeftown.json",type:"spritesheet"},{id:"AreaBackground",src:"assets/images/area-backgrounds/reeftown.jpg"}],GameObjectsAntarctic:[{id:"CharMac",src:"assets/animations/characters/mac.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"GOAnimKrill",src:"assets/animations/gameobjects/krill.js",assetsPath:"assets/animations/gameobjects/",type:"flash_animation"},{id:"GOAnimPenguin",src:"assets/animations/gameobjects/penguin.js",assetsPath:"assets/animations/gameobjects/",type:"flash_animation"}],GameObjectsDeep:[{id:"CharOblo",src:"assets/animations/characters/oblo.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharBiggie",src:"assets/animations/characters/biggie.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharLuAndBob",src:"assets/animations/characters/luandbob.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharBoo",src:"assets/animations/characters/boo.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharMortimer",src:"assets/animations/characters/mortimer.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"GOAnimFireflySquid",src:"assets/animations/gameobjects/firefly-squid.js",assetsPath:"assets/animations/gameobjects/",type:"flash_animation"},{id:"GOAnimGiantTubeWorms",src:"assets/animations/gameobjects/gianttubeworms.js",assetsPath:"assets/animations/gameobjects/",type:"flash_animation"}],GameObjectsKelpForest:[{id:"CharTidy",src:"assets/animations/characters/tidy.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharMrsTidy",src:"assets/animations/characters/mrstidy.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharTyke",src:"assets/animations/characters/tyke.js",assetsPath:"assets/animations/characters/",type:"flash_animation"}],GameObjectsReeftown:[{id:"CharCharlie",src:"assets/animations/characters/charlie.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharMaury",src:"assets/animations/characters/maury.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharChompy",src:"assets/animations/characters/chompy.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharDenny",src:"assets/animations/characters/denny.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharFlo",src:"assets/animations/characters/flo.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharGush",src:"assets/animations/characters/gush.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharPearlene",src:"assets/animations/characters/pearlene.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharScoutAndSnap",src:"assets/animations/characters/scoutandsnap.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharWave",src:"assets/animations/characters/wave.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"CharZee",src:"assets/animations/characters/zee.js",assetsPath:"assets/animations/characters/",type:"flash_animation"},{id:"GOAnimDecoratorCrab",src:"assets/animations/gameobjects/decorator-crab.js",assetsPath:"assets/animations/gameobjects/",type:"flash_animation"},{id:"GOAnimPinkAnthias",src:"assets/animations/gameobjects/pink-anthias.js",assetsPath:"assets/animations/gameobjects/",type:"flash_animation"},{id:"GOAnimFeatherDuster",src:"assets/animations/gameobjects/feather-duster.js",assetsPath:"assets/animations/gameobjects/",type:"flash_animation"},{id:"SchoolPinkFishSS",src:"assets/animations/schools/school-pinkfish.json",type:"spritesheet"},{id:"SchoolBlueTangSS",src:"assets/animations/schools/school-bluetang.json",type:"spritesheet"}],GameObjectsSunkenShip:[{id:"GOAnimJellyfish",src:"assets/animations/gameobjects/jellyfish.js",assetsPath:"assets/animations/gameobjects/",type:"flash_animation"},{id:"SchoolPinkFishSS",src:"assets/animations/schools/school-pinkfish.json",type:"spritesheet"},{id:"SchoolSilverFishSS",src:"assets/animations/schools/school-silverfish.json",type:"spritesheet"},{id:"SchoolYellowFishSS",src:"assets/animations/schools/school-yellowfish.json",type:"spritesheet"}]},items:{list:[{id:"pink-anthias",title:"Pink Anthias",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"vert",icon:"reef"},{id:"shark-tooth",title:"Shark Tooth",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"other",icon:"reef"},{id:"pearl",title:"Pearl",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"other",icon:"reef"},{id:"coral-rubble",title:"Coral Rubble",explorer:!0,builder:!0,defaultBuildMode:!0,locations:"reeftown",tags:"other",icon:"reef"},{id:"feather-duster",title:"Tube Worm",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"invert",icon:"reef"},{id:"starfish",title:"Sea Stars",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"invert",icon:"reef"},{id:"shell",title:"Shell",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"other",icon:"reef"},{id:"charlie",title:"Charlie",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"vert",icon:"reef"},{id:"maury",title:"Maury",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"vert",icon:"reef"},{id:"chompy",title:"Chompy",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"vert",icon:"reef"},{id:"denny",title:"Denny",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"invert",icon:"reef"},{id:"flo",title:"Flo",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"vert",icon:"reef"},{id:"gush",title:"Gush",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"vert",icon:"reef"},{id:"pearlene",title:"Pearlene",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"invert",icon:"reef"},{id:"scout-and-snap",title:"Scout and Snap",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"vert",icon:"reef"},{id:"wave",title:"Wave",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"invert",icon:"reef"},{id:"zee",title:"Zee",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"reeftown",tags:"vert",icon:"reef"},{id:"barrel-sponge",title:"Barrel Sponge",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"},{id:"brain-coral",title:"Brain Coral",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"},{id:"coral-polyp",title:"Coral Polyp",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"},{id:"flower-coral",title:"Flower Coral",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"},{id:"leather-coral",title:"Leather Coral",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"},{id:"plate-coral",title:"Plate Coral",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"},{id:"gorgonians",title:"Gorgonians",explorer:!0,builder:!0,defaultBuildMode:!1,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"},{id:"acropora-coral",title:"Acropora Coral",explorer:!1,builder:!0,defaultBuildMode:!1,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"},{id:"barnacles",title:"Barnacles",explorer:!1,builder:!0,defaultBuildMode:!0,locations:"sunkenship,reeftown",tags:"invert",icon:"reef"}]},tracking:{views:{Deep:"The Deep",KelpForest:"Kelp Forest",Reeftown:"Reeftown Rock",SunkenShip:"Sunken Ship",Antarctic:"Arctic/Antarctic",OceanBuilder:"Ocean Builder",LevelSelect:"Level Select",OceanGuidePrefix:"Ocean Guide Screen - ",OceanBuilderPrefix:"Ocean Builder - "},events:{OceanGuideClickFromExplore:"Explore Mode"}}},function(){"use strict";function a(){this.View_constructor(),this.level=null,this.uiContainer=null,this.tutorialsState=0,this.tapInstructions=!1,this.timer=0,this.build()}a.CharacterRotation=["Splash","Dunk","Splash","Ripple"];var b=createjs.extend(a,cm.View);b.build=function(){this.buildLevel(),this.buildUI();var b=cm.PlayerData.needsFlag("TutorialControls",!1)?"Splash":a.CharacterRotation.randomRotation(2);this.ui.characterPicker.setCharacterVisiblity(b),this.level.player.changeTo(b)},b.buildLevel=function(){var a=cm.Globals.currentLevel;this.level=new cm.Level[a],this.addChild(this.level),this.numOfCollectiblesLeft=this.level.numOfCollectibles},b.buildUI=function(){this.ui=new cm.ExplorerUI(cm.Globals.currentLevel),this.addChild(this.ui)},b.start=function(){this.View_start();var a=cm.Globals.currentLevel;cm.Tracking.exploreView(a),cm.PlayerData.needsFlag("Level"+a+"Start")?cm.VO.play("voLevelWelcome",this.checkTutorialStatus.bind(this)):this.checkTutorialStatus(),cm.MusicPlayer.play("musicLocation",1,1e3)},b.animateOut=function(){cm.MusicPlayer.stop(200)},b.checkTutorialStatus=function(){var a=cm.PlayerData;a.needsFlag("TutorialControls",!1)?(this.tutorialsState=1,this.playControlTutorial()):a.needsFlag("TutorialCollection",!1)?this.tutorialsState=2:a.needsFlag("TutorialCharacterPicker",!1)?(this.tutorialsState=4,this.playCharacterPickerTutorial()):this.tutorialsState=0},b.playControlTutorial=function(a){(cm.PlayerData.needsFlag("TutorialControls")||a)&&(cm.DemoHand.showSwimControls(this.level.player),cm.VO.play("voExplorerMove-"+this.level.player.character,this.checkTutorialStatus.bind(this)))},b.playCollectTutorial=function(a){cm.PlayerData.needsFlag("TutorialCollection"),cm.DemoHand.tapObject(a),cm.VO.play("voExplorer2",this.checkTutorialStatus.bind(this))},b.playCharacterPickerTutorial=function(a){cm.PlayerData.needsFlag("TutorialCharacterPicker"),cm.DemoHand.tapObject(this.ui.characterPicker),cm.VO.play("voExplorer4",this.checkTutorialStatus.bind(this))},b.playNoSuccessTutorial=function(a){cm.DemoHand.slide({x:-400,y:300},{x:300,y:300},2e3),cm.VO.play("noobject45")},b.playOceanBuilderButtonTutorial=function(a){cm.PlayerData.needsFlag("TutorialOceanBuilderButton"),this.ui.addSparkleToItem(this.ui.oceanGuideBtn),cm.DemoHand.tapObject(this.ui.oceanGuideBtn)},b.onCharacterSelect=function(a){this.level.player.changeTo(a.character)},b._tick=function(a){if(this.View__tick(a),!cm.VO.isPlaying){if(this.level.movementIdle>45)return this.playControlTutorial(!0),void(this.level.movementIdle=0);if(2===this.tutorialsState)return void this.checkForItemOnScreen();this.timer+=cm.tick,this.timer>60&&this.numOfCollectiblesLeft<3?(this.timer=0,cm.VO.loadAndPlay("assets/audio/vo/scroller/flo/3left-alt.ogg"),cm.VO.play("3left-alt")):this.timer>60&&1===this.numOfCollectiblesLeft?(this.timer=0,cm.VO.loadAndPlay("assets/audio/vo/scroller/flo/1left.ogg"),cm.VO.play("1left")):this.timer>45&&(this.playNoSuccessTutorial(),this.timer=0)}},b.checkForItemOnScreen=function(){for(var a=this.level.collectibles,b=0;b<a.length;b++){var c=a[b];c.visible&&this.level.isItemFullyVisible(c)&&(this.playCollectTutorial(c),this.tutorialsState=0)}},b.resize=function(a,b){this.ui.resize(a,b),this.level.x=a*-.5,this.level.y=b*-.5},b.setActive=function(a){a?(this.level.on("COLLECTIBLE_FOUND",this.onCollectibleFound,this),this.ui.on("CHARACTER_SELECT",this.onCharacterSelect,this),this.on("GAME_PAUSE",this.onGamePause,this),this.on("GAME_RESUME",this.onGameResume,this)):(this.removeAllEventListeners(),this.ui.removeAllEventListeners(),this.level.removeAllEventListeners(),cm.CordovaUtils.removeAllEventListeners()),this.level.setActive(a),this.ui.setActive(a)},b.onBackClick=function(){this.ui.onHomeBtnClick()},b.onCollectibleFound=function(a){cjs.Sound.play("sfx-collect"),this.numOfCollectiblesLeft--;var b=a.data.collectibleID.split("-").join("");cm.VO.play(b),this.timer=0,this.ui.collectItem(a.data);var c=a.data.collectibleID;this.onGamePause(),this.ui.unlockCollectible(c,this.onCollectionComplete.bind(this)),cm.PlayerData.foundItem(c)},b.onCollectionComplete=function(){this.onGameResume(),cm.PlayerData.needsFlag("TutorialOceanGuide")?(cm.DemoHand.tapObject(this.ui.oceanGuideBtn,80,-80),cm.VO.play("voExplorer6"),this.checkTutorialStatus()):0===this.numOfCollectiblesLeft||cm.CharacterVO.playCongrats(this.level.player.character)},b.onGamePause=function(){this.level.tickEnabled=!1},b.onGameResume=function(){this.level.tickEnabled=!0},b.destroy=function(){this.View_destroy(),cm.Assets.unload(["LevelExplorer","Level"+cm.Globals.currentLevel,"GameObjects"+cm.Globals.currentLevel]),cm.Assets.unload("MainCharacterSplash"),cm.Assets.unload("MainCharacterBubbles"),cm.Assets.unload("MainCharacterRipple"),cm.Assets.unload("MainCharacterDunk")},cm.View.LevelExplorer=cjs.promote(a,"View")}(),function(){"use strict";function a(){this.View_constructor(),this.backBtn=null,this.oceanGuideBtn=null,this.buildModeBtn=null,this.viewButtons=[],this.idleTimer=Number.MAX_VALUE,this.isActive=!1,this.build()}a.DefaultLocation="Reeftown";var b=createjs.extend(a,cm.View);b.build=function(){var a=cm.Assets.lib;this.addChild(new cjs.Bitmap(a.MapBG).center()),this.backBtn=new cm.UIFloatingButton(a.UISS,"BackBtn"),this.oceanGuideBtn=new cm.UICornerButton(a.UISS,"OceanGuideBtn",0,1),this.buildModeBtn=new cm.UIFloatingButton(a.MapSS,"BuildModeBtn"),this.viewButtons=[new cm.MapButton("SunkenShip",new cjs.Rectangle(-275,-178,299,224)).set({x:13,y:280}),new cm.MapButton("Antarctic",new cjs.Rectangle(-275,-178,299,224)).set({x:-329,y:74}),new cm.MapButton("Deep",new cjs.Rectangle(-220,-120,313,227)).set({x:74,y:-265}),new cm.MapButton("KelpForest",new cjs.Rectangle(-143,-225,324,233)).set({x:330,y:-30}),new cm.MapButton("Reeftown",new cjs.Rectangle(-156,-218,289,210)).set({x:311,y:271}),this.buildModeBtn,this.oceanGuideBtn,this.backBtn];for(var b=0;b<this.viewButtons.length;b++){var c=this.viewButtons[b];c!==this.backBtn&&c.setScale(0),this.addChild(c)}cm.PlayerData.isFirstTimeUser()&&this.setToFirstTimeEdition()},b.start=function(){this.View_start(),cm.Globals.currentLevel="LevelSelect",this.idleTimer=45,!cm.PlayerData.isFirstTimeUser()&&cm.PlayerData.needsFlag("MapFullVisit")?(cm.DemoHand.tapObject(this.buildModeBtn),cm.VO.loadAndPlay("assets/audio/vo/map/oceanmenu.ogg")):cm.VO.play("voMap"),cm.MusicPlayer.play("musicMenu",1,500)},b.setToFirstTimeEdition=function(){for(var b=0;b<this.viewButtons.length;b++){var c=this.viewButtons[b];c.name!==a.DefaultLocation&&c!==this.backBtn&&this.lockButton(c)}},b.lockButton=function(a){var b=a.sprite||a;b.gotoAndStop(b.currentAnimation+"-Locked"),a.mouseEnabled=!1},b.playIdleHint=function(){for(var a=this.viewButtons.length-1,b=0;a>b;b++){var c=this.viewButtons[b];cjs.Tween.get(c).wait(100*b).to({scaleX:1.1,scaleY:1.1},100,cjs.Ease.quadOut).to({scaleX:1,scaleY:1},200,cjs.Ease.quadInOut)}cm.VO.loadAndPlay("assets/audio/vo/map/menutimeout.ogg")},b.resize=function(a,b){var c=.5*a,d=-c,e=.5*b,f=-e;this.backBtn.x=d+87,this.backBtn.y=f+77,this.oceanGuideBtn.x=d,this.oceanGuideBtn.y=e},b.animateIn=function(){var a=cm.ViewControl.transitOut();cjs.Sound.play("sfx-populate",{delay:a});var b,c;for(c=0;c<this.viewButtons.length;c++){var d=this.viewButtons[c];b=cjs.Tween.get(d).wait(a+100*c).to({scaleX:1,scaleY:1},400,cjs.Ease.backOut)}return b.duration},b.setActive=function(a){this.isActive=a,this.idleTimer=45;for(var b=0;b<this.viewButtons.length;b++){var c=this.viewButtons[b];a?(c.addEvents(),c instanceof cm.MapButton?c.on("click",this.onLocationClick,this):c.on("click",this.onButtonClick,this)):c.removeEvents()}a?cm.CordovaUtils.on("BACK_BUTTON",this.onBack,this):cm.CordovaUtils.removeAllEventListeners()},b.onButtonClick=function(a){this.setActive(!1);var b=a.target;switch(b){case this.oceanGuideBtn:cm.main.showOceanGuide();break;case this.buildModeBtn:cm.MusicPlayer.stop(1e3),cjs.Sound.play("sfx-game-select"),cm.ViewControl.gotoLoaderThen("OceanBuilder","OceanBuilder");break;case this.backBtn:cjs.Sound.play("sfx-home"),this.onBack()}},b.onBack=function(a){cm.ViewControl.gotoLoaderThen("Title","Title")},b.onLocationClick=function(a){cm.MusicPlayer.stop(1e3),cjs.Sound.play("sfx-game-select"),this.setActive(!1);var b=a.target.name;cm.VO.play([100,"voMap"+b],this.onLocationVOComplete.bind(this,b))},b.onLocationVOComplete=function(a){cm.MusicPlayer.stop(1e3),cm.main.gotoLevel(a)},b.update=function(){if(this.isActive){var a=cm.tick;this.idleTimer-=a,this.idleTimer<0&&(this.idleTimer=45,this.playIdleHint())}},b.destroy=function(){this.View_destroy(),cm.Assets.unload("Map")},cm.View.Map=cjs.promote(a,"View")}(),function(){"use strict";function a(){this.Container_constructor(),this.ui=null,this.lastMouseX=0,this.lastMouseY=0,this.easeMoveX=0,this.easeMoveY=0,this.easeBool=!1,this.transitionedBool=!1,this.activeUI=null,this.activeAreaName=null,this.activeManifest=null,this.physicsLayer=null,this.timer=0,this.activeObjectArray=[]}a.assetPath="assets/oceanbuilder/object-images/";var b=createjs.extend(a,cm.View);b.reset=function(){this.buildBlackScreen(),this.addControlHitbox(),this.gotoArea("Reeftown")},b.animateIn=function(){},b.start=function(){cm.Globals.currentLevel="OceanBuilder"},b.gotoArea=function(a){switch(cm.Tracking.builderView(a),this.activeAreaName=a,this.activeManifest="",a){case"KelpForest":this.activeManifest="AreaKelpForest";break;case"Reeftown":this.activeManifest="AreaReeftown";break;case"SunkenShip":this.activeManifest="AreaSunkenShip";break;case"Antarctic":this.activeManifest="AreaAntarctic";break;case"Deep":this.activeManifest="AreaDeep"}cm.Assets.load([this.activeManifest],this.build.bind(this))},b.build=function(){this.buildArea(),this.buildAreaUI(),this.addChild(this.blackScreen);var a=this.View_animateIn();cjs.Tween.get(this).wait(a).call(this.setActive,[!0],this).call(this.playStartVO,null,this),cjs.Tween.get(this.blackScreen).to({alpha:0},500,cjs.Ease.quadInOut).set({visible:!1}),cm.MusicPlayer.play("sfx-ambience-loop",.4,1e3),this.onAreaReset(),this.playWaveAnimation()},b.playStartVO=function(){if(cm.PlayerData.needsFlag("OceanBuilderIntro"))cm.DemoHand.slide({x:-400,y:300},{x:400,y:300},2e3,7e3),cm.VO.play("build-intro");else{var a="assets/audio/vo/map/";switch(this.activeAreaName){case"KelpForest":a+="kelpforest.ogg";break;case"Reeftown":a+="reeftownrock.ogg";break;case"SunkenShip":a+="sunkenship.ogg";break;case"Antarctic":a+="antarctic.ogg";break;case"Deep":a+="thedeep.ogg"}}},b.buildArea=function(){this.area=new cm.Area[this.activeAreaName],this.addChild(this.area)},b.buildAreaUI=function(){var b=this.activeAreaName+"builder";this.ui=new cm.BuilderUI(b),this.ui.path=a.assetPath,this.ui.on("ADD_OBJECT",this.onAddEvent,this),this.ui.on("AREA_CLICK",this.onAreaClick,this),this.ui.on("AREA_RESET",this.onAreaReset,this),this.ui.resize(cm.System.width,cm.System.height),this.addChild(this.ui),this.updateCharacters()},b.buildBlackScreen=function(){this.blackScreen=new cjs.Shape,this.blackScreen.graphics.f("#000").r(-713,-384,1426,768),this.blackScreen.visible=!1,this.blackScreen.alpha=0,this.addChild(this.blackScreen)},b.onAddEvent=function(a){var b=a.data,c=b.getBounds();c&&(b.width=c.width,b.height=c.height),this.dropItem(b)},b.dropItem=function(a){return cjs.Sound.play("sfx-drop-item"),this.checkToRemove()&&!a.isHero?void this.removeItem(a):(a.anim&&(a.anim.paused=!1),this.area.addItem(a),this.area.save(),void this.updateCharacters())},b.removeItem=function(a){a.parent&&a.parent.removeChild(a),this.area.save(),this.updateCharacters()},b.checkToRemove=function(){return cm.Mouse.y>631},b.updateCharacters=function(){var a=this.area.getCharacterList();this.ui.updateCharacterList(a)},b.onItemInteraction=function(a){var b=a.target;switch(a.type){case"mousedown":cjs.Sound.play("sfx-grab-item"),b.parent.localToLocal(b.x,b.y,this,b),this.addChild(b),b.pBody&&(b.pBody._kill=!0),b.ox=a.stageX,b.oy=a.stageY,b.anim&&(b.anim.paused=!0),b.on("pressmove",this.onItemInteraction,this),b.on("pressup",this.onItemInteraction,this),b.dragging=!0,b.tapTime=Date.now();break;case"pressmove":b.x+=a.stageX-b.ox,b.y+=a.stageY-b.oy,b.ox=a.stageX,b.oy=a.stageY;break;case"pressup":b.dragging=!1,b.removeAllEventListeners(),this.dropItem(b),b.isHero&&Date.now()-b.tapTime<100&&b.playEasterEgg()}},b._tick=function(a){this.View__tick(a),this.timer+=a.tick,this.timer>180&&(cm.VO.isPlaying?this.timer=150:(this.showOceanGuideHint(),this.timer=-180)),this.easeBool&&this.easeMove()},b.showOceanGuideHint=function(){cm.DemoHand.tapObject(this.ui.oceanGuideBtn,80,-80),cm.VO.loadAndPlay("assets/audio/vo/guidebook/misc/guidereminder.ogg")},b.onDragEvent=function(a){if("mousedown"===a.type)return this.lastMouseX=a.stageX,void(this.lastMouseY=a.stageY);if("pressup"===a.type)return void(this.easeBool=!0);var b=this.easeMoveX=a.stageX-this.lastMouseX,c=this.easeMoveY=a.stageY-this.lastMouseY;this.moveArea(b,c),this.lastMouseX=a.stageX,this.lastMouseY=a.stageY},b.moveArea=function(a,b){var c=this.area.x+a,d=this.area.y+b,e=cm.System.width,f=713-.5*e;c=Math.limit(c,-713-f,713+f),d=Math.limit(d,-520,384),this.area.x=c,this.area.y=d,this.area.updateBackground(),this.ui.updateAreaButtons(c,d),this.area.checkLevelVisibility()},b.easeMove=function(){var a=this.easeMoveX,b=this.easeMoveY;this.moveArea(a,b),this.easeMoveX*=.9,this.easeMoveY*=.9,Math.abs(this.easeMoveX)<.1&&Math.abs(this.easeMoveY)<.1&&(this.easeBool=!1)},b.checkLevelVisibility=function(){for(var a=cm.System.width,b=cm.System.height,c=this.children,d=0;d<c.length;d++){var e=c[d],f=e.children;if(f)for(var g=e.x,h=e.y,i=0;i<f.length;i++){var j=f[i];j.left&&(j.visible=j.right+g>0&&j.left+g<a&&j.top+h<b&&j.bottom+h>0)}}},b.resize=function(a,b){this.ui&&this.ui.resize(a,b),this.area&&this.area.updateBackground()},b.onAreaClick=function(a){var b=a.data;this.goBlack(b)},b.onAreaReset=function(){this.area.clear(),this.updateCharacters()},b.goBlack=function(a){this.setActive(!1),cjs.Tween.get(this.blackScreen).set({visible:!0}).to({alpha:1},500,cjs.Ease.quadInOut).call(this.unloadAssets,[a],this)},b.unloadAssets=function(a){cm.Assets.unload(this.activeManifest),window.levelAssets={},this.removeChild(this.area),this.removeChild(this.ui),this.area=this.ui=null,this.gotoArea(a),this.activeObjectArray=[]},b.playWaveAnimation=function(){var a=new cm.Assets.lib.AnimClear.ClearArea;a.regX=713,a.regY=384,a.onComplete=this.onWaveAnimationComplete.bind(this),a.framerate=24,a.name="AnimClear",this.addChild(a),cjs.Sound.play("sfx-loading1")},b.onWaveAnimationComplete=function(){var a=this.getChildByName("AnimClear");a&&(a.onComplete=null,a.onClear=null,this.removeChild(a)),this.waveAnimation=null},b.setActive=function(a){a?(this.movementBtn.on("mousedown",this.onDragEvent,this),this.movementBtn.on("pressmove",this.onDragEvent,this),this.movementBtn.on("pressup",this.onDragEvent,this),this.area.itemHolder.on("mousedown",this.onItemInteraction,this),cm.CordovaUtils.on("BACK_BUTTON",this.onBackClick,this)):(this.movementBtn.removeAllEventListeners(),this.area.itemHolder.removeAllEventListeners(),cm.CordovaUtils.removeAllEventListeners()),this.ui.setActive(a)},b.onBackClick=function(){this.ui.onHomeBtnClick()},b.addControlHitbox=function(){this.movementBtn=new cjs.DisplayObject,this.movementBtn.hitArea=new cjs.Shape,this.movementBtn.hitArea.graphics.f("#000").r(-713,-384,1426,768),this.addChild(this.movementBtn)},cm.View.OceanBuilder=cjs.promote(a,"View")}(),function(){"use strict";function a(){this.View_constructor(),this.characters=null,this.playBtn=null,this.textOcean=null,this.textExplorer=null,this.logo=null,this.inactivityTimer=99999,this.build()}var b=createjs.extend(a,cm.View);b.build=function(){var a=cm.Assets.lib,b=a.TitleSS,c=new cjs.Bitmap(a.TitleBG).center();this.playBtn=new cm.UIFloatingButton(b,"PlayBtn").set({x:-11,y:233});var d={regX:713,regY:384,snapToPixel:!1},e=new cjs.Sprite(b,"Char-Splash").set(d),f=new cjs.Sprite(b,"Char-Bubbles").set(d),g=new cjs.Sprite(b,"Char-Ripple").set({regX:755,regY:395,snapToPixel:!1}),h=new cjs.Sprite(b,"Char-Dunk").set({regX:713,regY:424,snapToPixel:!1});this.characters=[f,e,g,h],this.textOcean=new cjs.Sprite(b,"TextOcean").center(),this.textOcean.set({x:0,y:-55}),this.textExplorer=new cjs.Sprite(b,"TextExplorer").set(d),this.logo=new cjs.Sprite(b,"Logo").center().set({x:-5,y:-209}),this.quitPopup=(new cjs.Container).set({visible:!1}),this.quitPopup.addChild(new cjs.Shape((new cjs.Graphics).f("#000").r(-713,-384,1426,768)).set({alpha:.5}),new cjs.Sprite(b,"QuitPopup").set({name:"Popup",regX:713,regY:384}),new cm.UIFloatingButton(b,"ConfirmBtn").set({name:"ConfirmButton",x:365}),new cm.UIFloatingButton(b,"XBtn").set({name:"CloseButton",x:-365})),this.holder=new cjs.Container,this.holder.addChild(e,f,h,g,this.logo,this.textOcean,this.textExplorer,this.playBtn,this.quitPopup),this.addChild(c,this.holder)},b.reset=function(){for(var a=.25*Math.PI,b=0;b<this.characters.length;b++){var c=this.characters[b];c.x=500*Math.cos(a),c.y=500*Math.sin(a),a+=.5*Math.PI}this.textOcean.setScale(0),this.textExplorer.setScale(0),this.playBtn.setScale(0)},b.resize=function(){if(window.Trampoline){var a=Trampoline.container.getElementsByClassName("main")[0];if(a){var b=a.offsetHeight,c=b/window.innerHeight;c-=55/768,this.holder.setScale(1-c),this.holder.y=cm.System.height/2*c,this.quitPopup.children[0].setScale(1/(1-c))}}},b.start=function(){this.View_start(),this.inactivityTimer=15},b.animateIn=function(){window.Trampoline&&(window.Trampoline.container.style.display=""),this.resize();for(var a=0;a<this.characters.length;a++){var b=this.characters[a];cjs.Tween.get(b).to({x:0,y:0},1e3,cjs.Ease.cubicOut)}return cjs.Tween.get(this.textOcean).to({scaleX:1,scaleY:1},1e3,cjs.Ease.backOut),cjs.Tween.get(this.textExplorer).to({scaleX:1,scaleY:1},1e3,cjs.Ease.backOut),cjs.Tween.get(this.playBtn).wait(500).to({scaleX:1,scaleY:1},600,cjs.Ease.backOut),cm.ViewControl.transitionOverlay.visible&&cm.ViewControl.transitOut(),cm.VO.play("voTitle"),cm.MusicPlayer.play("musicTitle",1,1e3),1100},b.animateOut=function(){return cm.MusicPlayer.stop(400),this.View_animateOut()},b.setActive=function(a){cm.debug&&this.debugEvents(a),a?(this.playBtn.on("click",this.onClick,this),this.playBtn.addEvents(),cm.CordovaUtils.on("BACK_BUTTON",this.onBackClick,this)):(this.playBtn.removeEvents(),this.removeAllEventListeners(),cm.CordovaUtils.removeAllEventListeners(),window.Trampoline&&(window.Trampoline.container.style.display="none"))},b.onBackClick=function(){this.quitPopup.visible?this.hideBackPopup():this.showBackPopup()},b.debugEvents=function(a){var b=this.holder.children[0],c=this.holder.children[1];a?(b.on("click",this.onDebugEvent,this),c.on("click",this.onDebugEvent,this)):(b.removeAllEventListeners(),c.removeAllEventListeners())},b.onDebugEvent=function(a){var b=a.target;b.debugTap||(b.debugTap=0),b.debugTap++,b.debugTap>4&&(b.debugTap=0,cjs.Tween.get(b).to({rotation:360},1e3).to({rotation:0},0),"Char-Splash"===b.currentAnimation?cm.PlayerData.unlockAll():"Char-Bubbles"===b.currentAnimation&&cm.PlayerData.clearData())},b.onClick=function(a){cjs.Sound.play("sfx-play"),this.setActive(!1),cm.main.gotoLevel("Reeftown")},b.showBackPopup=function(){if(!cjs.Tween.hasActiveTweens(this.quitPopup)){var a=this.quitPopup.getChildByName("Popup"),b=this.quitPopup.getChildByName("ConfirmButton"),c=this.quitPopup.getChildByName("CloseButton");b.addEvents(),c.addEvents(),a.y=c.y=b.y=600,this.quitPopup.alpha=0,this.quitPopup.visible=!0,cjs.Tween.get(this.quitPopup).to({alpha:1},200,cjs.Ease.quadInOut).wait(100),cjs.Tween.get(a).wait(100).to({y:0},300,cjs.Ease.cubicOut),cjs.Tween.get(b).wait(100).to({y:0},300,cjs.Ease.cubicOut),cjs.Tween.get(c).wait(100).to({y:0},300,cjs.Ease.cubicOut),this.quitPopup.on("click",this.onBackPopupClick,this)}},b.hideBackPopup=function(){if(!cjs.Tween.hasActiveTweens(this.quitPopup)){var a=this.quitPopup.getChildByName("Popup"),b=this.quitPopup.getChildByName("ConfirmButton"),c=this.quitPopup.getChildByName("CloseButton");b.removeEvents(),c.removeEvents(),cjs.Tween.get(this.quitPopup).wait(300).to({alpha:0},200,cjs.Ease.quadInOut).set({visible:!1}),cjs.Tween.get(a).to({y:600},300,cjs.Ease.cubicIn),cjs.Tween.get(b).to({y:600},300,cjs.Ease.cubicIn),cjs.Tween.get(c).to({y:600},300,cjs.Ease.cubicIn),this.quitPopup.removeAllEventListeners()}},b.onBackPopupClick=function(a){switch(a.target.name){case"CloseButton":cjs.Sound.play("sfx-play"),this.hideBackPopup();break;case"ConfirmButton":try{navigator.app.exitApp()}catch(a){}}},b.update=function(){this.quitPopup.visible||(this.inactivityTimer-=cm.tick,this.inactivityTimer<0&&(this.wigglePlayButton(),this.inactivityTimer=8))},b.wigglePlayButton=function(){var a={rotation:8},b={rotation:-8};cjs.Tween.get(this.playBtn).to({scaleX:.9,scaleY:.9,rotation:-8},200).to({scaleX:1.1,scaleY:1.1,rotation:8},200,cjs.Ease.quadInOut).to(b,200,cjs.Ease.quadInOut).to(a,200,cjs.Ease.quadInOut).to(b,200,cjs.Ease.quadInOut).to(a,200,cjs.Ease.quadInOut).to({scaleX:1,scaleY:1,rotation:0},200)},b.destroy=function(){this.View_destroy(),cm.Assets.unload("Title")},cm.View.Title=cjs.promote(a,"View")}(),function(){"use strict";function a(a,b){this.Container_constructor(),this.mouseChildren=!1,this.name=a,this.sprite=new cjs.Sprite(cm.Assets.lib.MapSS,"Location"+a).center().hitbox(10),this.sprite.snapToPixel=!1;var c=new cjs.DisplayObject;c.hitArea=new cjs.Shape,c.hitArea.graphics.f("#000").r(b.x,b.y,b.width,b.height),this.addChild(c,this.sprite)}var b=createjs.extend(a,cjs.Container);b.addEvents=function(){this.on("mousedown",this.onEvent,this),this.on("pressup",this.onEvent,this),this.on("click",this.onEvent,this)},b.onEvent=function(a){switch(a.type){case"mousedown":cjs.Tween.removeTweens(this.sprite),cjs.Tween.removeTweens(this.sprite.hitArea),this.sprite.setScale(.9),this.sprite.hitArea.setScale(1.111);break;case"click":case"pressup":cjs.Tween.get(this.sprite).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut),cjs.Tween.get(this.sprite.hitArea).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut)}},b.removeEvents=function(a){this.removeAllEventListeners()},cm.MapButton=cjs.promote(a,"Container")}(),function(){"use strict";function a(a){this.Container_constructor(),this.builderName=a,this.locationName="Reeftown",this.builderMode=!1,this.lastMousePt=new cjs.Point,this.didDragHappen=!1;var b=cm.Assets.lib.UISS;this.homeBtn=new cm.UIFloatingButton(b,"HomeBtn"),"Reeftown"===this.builderName?this.oceanGuideBtn=new cm.UICornerButton(b,"OceanBuilderBtn",0,1):this.oceanGuideBtn=new cm.UICornerButton(b,"OceanExplorerBtn",0,1),this.oceanGuideBtn.name="oceanGuideBtn";var c=new cjs.Sprite(b,"tray-leftarrowbg").reg(1,1).set({x:-cm.System.width/2+325,y:384}),d=new cjs.Sprite(b,"tray-rightarrowbg").reg(1,1).set({x:cm.System.width/2,y:384});c.on("mousedown",function(){},this),c.on("mousedown",function(){},this),this.rightArrow=new cjs.Sprite(b,"tray-arrow").reg(1,1).set({x:cm.System.width/2-25,y:370,name:"rightArrow"}),this.leftArrow=new cjs.Sprite(b,"tray-arrow").reg(1,1).set({x:-cm.System.width/2+175,y:370,name:"leftArrow",scaleX:-1}),this.leftArrow.on("mousedown",this.handleArrowButton,this),this.rightArrow.on("mousedown",this.handleArrowButton,this),this.leftArrow.on("pressup",this.handleArrowButton,this),this.rightArrow.on("pressup",this.handleArrowButton,this),b=cm.Assets.lib.LevelUISS,this.levelNameTab=new cjs.Sprite(b,"NameTab").reg(1,1).set({y:-128}),this.itemContainer=(new cjs.Container).set({y:-63,vel:0}),this.bg=new cjs.Container,this.bg.addChild(new cjs.Sprite(b,"BottomTrayL").reg(1,1),new cjs.Sprite(b,"BottomTrayR").reg(0,1),this.levelNameTab,this.itemContainer),this.arrowPressed=!1,this.arrowDirection=1,this.addChild(this.bg,d,this.rightArrow,c,this.leftArrow,this.oceanGuideBtn,this.homeBtn),this.populate()}var b=a;b.GuideButtonOffset=180;var c=createjs.extend(a,cjs.Container);c.handleArrowButton=function(a){"mousedown"===a.type&&(this.arrowPressed=!0,"leftArrow"===a.target.name&&(this.arrowDirection=15),"rightArrow"===a.target.name&&(this.arrowDirection=-15)),
"pressup"===a.type&&(this.arrowPressed=!1,"leftArrow"===a.target.name&&(this.arrowDirection=0),"rightArrow"===a.target.name&&(this.arrowDirection=0))},c.populate=function(){function a(a,b){var c=a.tags,d=b.tags;if(c===d)return 0;switch(c){case"vert":return-1;case"invert":return"vert"===d?1:-1;case"plant":return"other"===d?-1:1;case"other":return 1}return 0}var c=this.getItemList();c.sort(a);for(var d=0,e=40,f=cm.Assets.lib.LevelUISS,g=this.itemContainer,h=0;h<c.length;h++){var i=c[h],j=new cjs.Sprite(f,i.id).center().hitbox();j.name=i.id,j.data=i,j.x=d+j.regX,g.addChild(j),d=g.getBounds().width+e}g.x=cm.System.width*-.5+b.GuideButtonOffset+185,c.length&&(g.width=g.getBounds().width)},c.getItemList=function(){},c.bounceOceanGuideButton=function(){cjs.Tween.get(this.oceanGuideBtn).to({scaleX:1.06,scaleY:1.06},150,cjs.Ease.backOut).to({scaleX:1,scaleY:1},150,cjs.Ease.quadOut)},c.onEvent=function(a){switch(a.type){case"mousedown":this.didDragHappen=!1,this.lastMousePt.x=a.stageX,this.itemContainer.applyVel=!1;break;case"pressmove":var b=a.stageX-this.lastMousePt.x;this.itemContainer.vel=b,this.itemContainer.x+=b,this.lastMousePt.x=a.stageX,this.didDragHappen=!0;break;case"click":!this.didDragHappen&&a.target.data&&this.onItemTap(a.target),this.itemContainer.applyVel=!0}},c._tick=function(a){var c=this.itemContainer;Math.isEpsilon(c.vel)&&(c.vel=0),c.vel&&c.applyVel&&(c.x+=c.vel,c.vel*=.9),this.arrowPressed&&(this.itemContainer.vel*=this.arrowDirection,this.itemContainer.x+=this.arrowDirection);var d=cm.System.width*-.5+100;c.width>cm.System.width-b.GuideButtonOffset&&(d+=b.GuideButtonOffset),d<c.x&&(c.x+=.2*(d-c.x));var e=.5*cm.System.width-100;e>c.x+c.width&&(c.x+=.2*(e-(c.x+c.width))),c.x!==c.lastX&&(this.setObjectVisiblities(),c.lastX=c.x),this.Container__tick(a)},c.setObjectVisiblities=function(){for(var a=this.itemContainer.children,b=this.itemContainer.x,c=.5*cm.System.width,d=0;d<a.length;d++){var e=a[d],f=b+e.x,g=f+e.regX,h=f-e.regX;e.visible=g>-c&&c>h}},c.setActive=function(a){a?(this.homeBtn.addEvents(),this.homeBtn.on("click",this.onHomeBtnClick,this),this.oceanGuideBtn.addEvents(),this.oceanGuideBtn.on("click",this.checkLocationClick,this),this.bg.on("mousedown",this.onEvent,this),this.bg.on("pressmove",this.onEvent,this),this.bg.on("pressup",this.onEvent,this),this.bg.on("click",this.onEvent,this)):(this.homeBtn.removeEvents(),this.oceanGuideBtn.removeEvents(),this.bg.removeAllEventListeners())},c.onItemTap=function(a){var b=a.data.id.split("-").join("");cm.VO.play(b),cjs.Tween.get(a).to({scaleX:1.05,scaleY:1.05},150,cjs.Ease.backOut).to({scaleX:1,scaleY:1},150,cjs.Ease.quadOut)},c.checkLocationClick=function(a){this.setActive(!1),"Reeftown"===this.builderName?cm.ViewControl.gotoLoaderThen("OceanBuilder","OceanBuilder"):cm.main.gotoLevel("Reeftown")},c.onOceanGuideClick=function(a){this.setActive(!1),cm.main.showOceanGuide()},c.onHomeBtnClick=function(a){cm.PlayerData.isFirstTimeUser()&&cm.PlayerData.setFirstTimerUserOff(),cjs.Sound.play("sfx-home"),this.setActive(!1),cm.ViewControl.gotoLoaderThen(["Title"],"Title")},c.highlightMenuBar=function(a){cjs.Tween.get(this.bg).wait(a||0).to({alpha:.1},400,cjs.Ease.quadInOut).to({alpha:1},400,cjs.Ease.quadInOut).to({alpha:.1},400,cjs.Ease.quadInOut).to({alpha:1},400,cjs.Ease.quadInOut).to({alpha:.1},400,cjs.Ease.quadInOut).to({alpha:1},400,cjs.Ease.quadInOut).to({alpha:.1},400,cjs.Ease.quadInOut).to({alpha:1},400,cjs.Ease.quadInOut)},c.resize=function(a,b){var c=.5*a,d=-c,e=.5*b,f=-e;this.oceanGuideBtn.x=d,this.levelNameTab.x=c,this.oceanGuideBtn.y=this.bg.y=e,this.homeBtn.x=d+87,this.homeBtn.y=f+77},cm.SharedUI=cjs.promote(a,"Container")}(),function(){"use strict";function a(a,b){this.Sprite_constructor(a,b),this.center(),this.hitbox(10),this.snapToPixel=!1}var b=createjs.extend(a,cjs.Sprite);b.addEvents=function(){this.on("mousedown",this.onEvent,this),this.on("pressup",this.onEvent,this),this.on("click",this.onEvent,this)},b.onEvent=function(a){switch(a.type){case"mousedown":cjs.Tween.removeTweens(this),cjs.Tween.removeTweens(this.hitArea),this.setScale(.9),this.hitArea.setScale(1.111);break;case"click":case"pressup":cjs.Tween.get(this).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut),cjs.Tween.get(this.hitArea).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut)}},b.removeEvents=function(a){this.removeAllEventListeners()},cm.UIFloatingButton=cjs.promote(a,"Sprite")}(),function(){"use strict";function a(a){this.Container_constructor();var b=cm.Assets.lib.LevelUISS,c=cm.Assets.lib.UISS;this.mainBtn=new cm.UIFloatingButton(c,"CharacterPickerBtn"),this.characterSlider=(new cjs.Container).set({regY:70}),this.characterSlider.mask=new cjs.Shape,this.characterSlider.mask.graphics.r(-580,-70,580,142),this.characterSlider.addChild(new cjs.Sprite(b,"CharacterTab").set({mouseEnabled:!1}),new cjs.Sprite(c,"Select-Dunk").hitbox(10).set({name:"Dunk"}),new cjs.Sprite(c,"Select-Splash").hitbox(10).set({name:"Splash"}),new cjs.Sprite(c,"Select-Ripple").hitbox(10).set({name:"Ripple"}),new cjs.Sprite(c,"Select-Bubbles").hitbox(10).set({name:"Bubbles"})),this.characterSlider.visible=!1,this.addChild(this.characterSlider,this.mainBtn)}var b=createjs.extend(a,cjs.Container);b.showSlider=function(){cjs.Sound.play("sfx-open-tray-1"),this.characterSlider.on("click",this.onSelectEvent,this),this.characterSlider.mouseChildren=!1,cjs.Tween.get(this.characterSlider,{override:!0}).set({visible:!0}).to({x:-580},600,cjs.Ease.cubicOut).set({mouseChildren:!0})},b.hideSlider=function(){cjs.Sound.play("sfx-open-tray-2"),this.characterSlider.removeAllEventListeners(),cjs.Tween.get(this.characterSlider,{override:!0}).to({x:0},400,cjs.Ease.quadIn).set({visible:!1})},b.setActive=function(a){a?(this.mainBtn.addEvents(),this.mainBtn.on("click",this.onMainClick,this)):(this.mainBtn.removeEvents(),this.characterSlider.removeAllEventListeners())},b.onMainClick=function(a){cjs.Tween.hasActiveTweens(this.characterSlider)||(this.characterSlider.visible?this.hideSlider():this.showSlider())},b.onSelectEvent=function(a){var b=a.target;if(null!==b.name){this.setCharacterVisiblity(b.name),this.hideSlider();var c=new cjs.Event("CHARACTER_SELECT",!0);c.character=b.name,this.dispatchEvent(c),cm.CharacterVO.playSelection(b.name)}},b.setCharacterVisiblity=function(a){for(var b=0;b<this.characterSlider.children.length;b++){var c=this.characterSlider.children[b];c.visible=!c.mouseEnabled||c.name!==a}},b.resize=function(a,b){var c=.5*a,d=.5*b,e=-d;this.x=c-102,this.y=e+88},cm.CharacterPicker=cjs.promote(a,"Container")}(),function(){"use strict";function a(a){this.SharedUI_constructor(a),this.builderMode=!1,this.switchToTintItems(),this.characterPicker=new cm.CharacterPicker,this.addChild(this.characterPicker)}var b=createjs.extend(a,cm.SharedUI);b.getItemList=function(){return cm.GameData.getExplorerItemListFor(this.locationName)},b.switchToTintItems=function(){for(var a=this.itemContainer.children,b=0;b<a.length;b++){var c=a[b],d=cm.PlayerData.isItemUnlocked(c.name);d?c.gotoAndStop(c.name):c.gotoAndStop(c.name+"-tint")}},b.collectItem=function(a){var b=a.collectibleID,c=this.itemContainer.getChildByName(b);this.putItemOnScreen(c),c.gotoAndStop(c.data.id),this.addSparkleToItem(c)},b.putItemOnScreen=function(a){var b=cm.SharedUI.GuideButtonOffset+135,c=cm.System.width-120,d=a.getBounds().clone();a.localToGlobal(d.x,d.y,d);var e=d.x+d.width>c||d.x<b;if(e){var f=d.x<.5*cm.System.width?this.itemContainer.x-(d.x-b):this.itemContainer.x+(c-(d.x+d.width));cjs.Tween.get(this.itemContainer).to({x:f},400,cjs.Ease.cubicInOut)}},b.addSparkleToItem=function(a){var b=new cjs.Sprite(cm.Assets.lib.GameSS,"Sparkle").set({alpha:0,scaleX:0,scaleY:0,regX:180,regY:172}),c=this.itemContainer;if("oceanGuideBtn"===a.name){b.x=-50,b.y=0;var d=1,e=1}else{b.x=a.x,b.y=a.y;var d=.6,e=.6}c.addChildAt(b,0),cjs.Tween.get(b,{loop:!0}).to({rotation:360},2e3,cjs.Ease.linear),cjs.Tween.get(b).to({alpha:1,scaleX:d,scaleY:e},600,cjs.Ease.cubicOut).wait(200).to({alpha:0},600,cjs.Ease.cubicIn).call(cjs.Tween.removeTweens,[b],cjs.Tween).call(c.removeChild,[b],c)},b.unlockCollectible=function(a,b){var c=this.itemContainer.getChildByName(a),d=new cm.UnlockSequence(c.data,b);this.addChild(d)},b.onOceanGuideClick=function(a){cm.Tracking.oceanGuideClick(cm.Globals.currentLevel),this.SharedUI_onOceanGuideClick(a)},b.setActive=function(a){this.SharedUI_setActive(a),this.characterPicker.setActive(a)},b.resize=function(a,b){this.SharedUI_resize(a,b),this.characterPicker.resize(a,b)},cm.ExplorerUI=cjs.promote(a,"SharedUI")}(),function(){"use strict";function a(a,b){this.Container_constructor();var c=this.darkShape=new cjs.Shape;c.graphics.f("#000").r(-713,-384,1426,768),c.alpha=0;var d=this.image=new cjs.Container;d.regX=226,d.regY=227;var e=new cjs.Bitmap("assets/images/guide/bgs/"+a.icon+"-locked.png"),f=new cjs.Bitmap("assets/images/guide/showcase/"+a.id+"-locked.png"),g=new cjs.Bitmap("assets/images/guide/bgs/"+a.icon+".png").set({visible:!1}),h=new cjs.Bitmap("assets/images/guide/showcase/"+a.id+".png").set({visible:!1});d.addChild(e,g,f,h),this.addChild(c,d),this.spinTime=10,cjs.Tween.get(c).to({alpha:.6},800,cjs.Ease.quadInOut),cjs.Tween.get(d).to({y:-70},1e3,cjs.Ease.backOut),cjs.Tween.get(this).to({spinTime:Math.asin(1)},2e3,cjs.Ease.quadOut).call(this.switchState,null,this),this.onComplete=b}var b=createjs.extend(a,cjs.Container);b.switchState=function(){for(var a=0;a<this.image.children.length;a++)this.image.children[a].visible=!this.image.children[a].visible;this.image.setScale(1.1),cjs.Tween.get(this.image).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut).wait(1e3).call(this.hide,null,this)},b.hide=function(){cjs.Tween.get(this.darkShape).to({alpha:0},800,cjs.Ease.quadInOut),cjs.Tween.get(this.image).to({x:cm.System.width/-2+48,y:cm.System.height/2-48,scaleX:.495,scaleY:.495},1e3,cjs.Ease.cubicInOut).call(this.onEnd,null,this)},b.onEnd=function(){this.parent.bounceOceanGuideButton(),this.parent.removeChild(this),this.onComplete()},b._tick=function(a){if(this.spinTime!==Math.asin(1)){var b=Math.sin(this.spinTime);this.image.scaleX=b}this.Container__tick(a)},cm.UnlockSequence=cjs.promote(a,"Container")}(),function(){"use strict";function a(a){this.Sprite_constructor(cm.Assets.lib.UISS,"AreaBtn"+a),this.hitbox(10),this.snapToPixel=!1,this.anchor="",this.isGoingAway=!1,this.setScale(0),this.visible=!1,this.active=!0,this.name=a}var b=createjs.extend(a,cjs.Sprite);b.setAnchor=function(a){switch(this.anchor=a,a){case"left":this.reg(0,.5);break;case"top":this.reg(.5,0);break;case"right":this.reg(1,.5);break;case"bottom":this.reg(.5,1)}},b.show=function(a){this.active&&(!a||this.visible&&!this.isGoingAway?a||!this.visible||this.isGoingToShow||(this.isGoingAway=!0,cjs.Tween.get(this,{override:!0}).to({scaleX:0,scaleY:0},250,cjs.Ease.backOut).set({visible:!1})):(this.isGoingAway=!1,this.visible=!0,cjs.Tween.get(this,{override:!0}).to({scaleX:1,scaleY:1},250,cjs.Ease.backOut)))},b.addEvents=function(){this.on("mousedown",this.onEvent,this),this.on("pressup",this.onEvent,this),this.on("click",this.onEvent,this)},b.onEvent=function(a){switch(a.type){case"mousedown":cjs.Tween.removeTweens(this),cjs.Tween.removeTweens(this.hitArea),this.setScale(.9),this.hitArea.setScale(1.111);break;case"click":case"pressup":cjs.Tween.get(this).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut),cjs.Tween.get(this.hitArea).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut)}},b.removeEvents=function(a){this.removeAllEventListeners()},cm.AreaButton=cjs.promote(a,"Sprite")}(),function(){"use strict";function a(a){this.SharedUI_constructor(a),this.path=null,this.setupAreaArrays("Reeftown"),this.builderMode=!0;var b=cm.Assets.lib.UISS;this.resetBtn=new cm.UIFloatingButton(b,"ResetBtn"),this.addChild(this.resetBtn),this.buildConfirmationDialog()}var b=createjs.extend(a,cm.SharedUI);b.buildConfirmationDialog=function(){var a=cm.Assets.lib.UISS,b=(new cjs.DisplayObject).set({name:"BackCancel"});b.hitArea=new cjs.Shape,b.hitArea.graphics.f("#000").r(-713,-384,1426,768),this.confirmDialog=new cjs.Container,this.confirmDialog.addChild(b,new cjs.Sprite(a,"ConfirmDialog").set({regX:375,regY:87}),new cm.UIFloatingButton(a,"SmallXBtn").set({x:123,y:4,name:"Cancel"}),new cm.UIFloatingButton(a,"SmallCheckBtn").set({x:263,y:4,name:"Confirm"}))},b.setAreaButtons=function(a){this.areaButtons=new cjs.Container,this.deepBtn=new cm.AreaButton("Deep"),this.kelpforestBtn=new cm.AreaButton("KelpForest"),this.reeftownBtn=new cm.AreaButton("Reeftown"),this.sunkenshipBtn=new cm.AreaButton("SunkenShip"),this.antarcticBtn=new cm.AreaButton("Antarctic"),this.deepBtn.setAnchor("bottom"),this.kelpforestBtn.setAnchor("right"),this.reeftownBtn.setAnchor("left"),this.sunkenshipBtn.setAnchor("left"),this.antarcticBtn.setAnchor("top"),this.deepBtn.active="Deep"!==a,this.kelpforestBtn.active="KelpForest"!==a,this.reeftownBtn.active="Reeftown"!==a,this.sunkenshipBtn.active="SunkenShip"!==a,this.antarcticBtn.active="Antarctic"!==a,this.reeftownBtn.active&&this.sunkenshipBtn.active&&(this.reeftownBtn.y=-100,this.sunkenshipBtn.y=100),this.areaButtons.addChild(this.reeftownBtn,this.sunkenshipBtn,this.deepBtn,this.kelpforestBtn,this.antarcticBtn),this.addChildAt(this.areaButtons,0)},b.getItemList=function(){return cm.GameData.getBuilderItemListFor(this.locationName)},b.updateAreaButtons=function(a,b){return},b.onEvent=function(a){var b=a.target;switch(a.type){case"mousedown":this.itemContainer.applyVel=!1,this.didDragHappen=!1,this.lastMousePt.x=a.stageX;break;case"pressmove":if(a.stageY>640&&!this.dragObject){var c=a.stageX-this.lastMousePt.x;this.itemContainer.vel=c,this.itemContainer.x+=c}if(a.stageY<640&&!this.dragObject&&b.data&&(cjs.Sound.play("sfx-grab-item"),this.dragObject=this.getDragObject(b.data.id),this.parent.addChild(this.dragObject)),this.dragObject){var d=this.globalToLocal(a.stageX,a.stageY);this.dragObject.x=d.x,this.dragObject.y=d.y,this.dragObject.getCenter&&this.dragObject.center(),this.dragObject.anim&&(this.dragObject.anim.paused=!0)}this.lastMousePt.x=a.stageX;break;case"pressup":this.dragObject&&(this.spawnObject(this.dragObject),this.dragObject=null),this.itemContainer.applyVel=!0;break;case"click":this.SharedUI_onEvent(a)}},b.getDragObject=function(a){var b,c=cm.GameObjectHelper.get(a);if(c)b=new c,b.name=a,b.allowFall=c.allowFall||!1;else{var d=this.checkSprite(a);b=new cjs.Bitmap(this.path+d+".png"),b.name=d,b.getCenter=!0}return b},b.setupAreaArrays=function(a){switch(a.toLowerCase()){case"kelpforest":this.kelpRootArray=["kelp-root-rock","kelp-root-rock2"],this.kelpArray=["kelp","kelp1","kelp2","kelp3"];break;case"sunkenship":this.barnaclesArray=["barnacles-2","barnacles"],this.barrelSpongeArray=["barrel-sponge-1","barrel-sponge-2"],this.brainArray=["brain-coral-1","brain-coral-2"],this.flowerArray=["flower-coral-1","flower-coral"],this.scallopArray=["scallopshell1","scallopshell2","scallopshell3","scallopshell4"],this.plateArray=["plate-coral-1","plate-coral-2","plate-coral-3","plate-coral-4"],this.acroporaArray=["acropora-coral-1","acropora-coral-2","acropora-coral-3","acropora-coral-4"];break;case"reeftown":this.acroporaArray=["acropora-coral-1","acropora-coral-2","acropora-coral-3","acropora-coral-4"],this.barnaclesArray=["barnacles-2","barnacles"],this.barrelSpongeArray=["barrel-sponge-1","barrel-sponge-2"],this.brainArray=["brain-coral-1","brain-coral-2"],this.flowerArray=["flower-coral-1","flower-coral"],this.plateArray=["plate-coral-1","plate-coral-2","plate-coral-3","plate-coral-4"];break;case"deep":this.magmaArray=["magma-rock-1","magma-rock"];break;case"antarctic":}},b.checkSprite=function(a){switch(a){case"kelp-root-rock":return this.setSprite(this.kelpRootArray);case"kelp":return this.setSprite(this.kelpArray);case"barnacles":return this.setSprite(this.barnaclesArray);case"barrel-sponge":return this.setSprite(this.barrelSpongeArray);case"flower-coral":return this.setSprite(this.flowerArray);case"scallop-shell":return this.setSprite(this.scallopArray);case"acropora-coral":return this.setSprite(this.acroporaArray);case"barnacles":return this.setSprite(this.barnaclesArray);case"barrel-sponge":return this.setSprite(this.barrelSpongeArray);case"brain-coral":return this.setSprite(this.brainArray);case"flower-coral":return this.setSprite(this.flowerArray);case"plate-coral":return this.setSprite(this.plateArray);case"magma-rock":return this.setSprite(this.magmaArray);case a:return a}},b.setActive=function(a){this.SharedUI_setActive(a),a?(this.resetBtn.addEvents(),this.resetBtn.on("click",this.onResetBtnClick,this)):this.resetBtn.removeEvents()},b.onResetBtnClick=function(){cjs.Sound.play("sfx-reset"),cm.VO.play("build-reset"),this.showConfirmation()},b.showConfirmation=function(){var a=this.confirmDialog,b=a.getChildByName("Cancel");b.addEvents();var c=a.getChildByName("Confirm");c.addEvents(),this.addChild(a),a.on("click",this.onConfirmationDialogEvent,this),a.setScale(0),a.alpha=0,a.mouseChildren=a.mouseEnabled=!1,cjs.Tween.get(a).to({scaleX:1,scaleY:1,alpha:1},500,cjs.Ease.backOut).set({mouseEnabled:!0,mouseChildren:!0})},b.hideConfirmation=function(){var a=this.confirmDialog,b=a.getChildByName("Cancel");b.removeEvents();var c=a.getChildByName("Confirm");c.removeEvents(),a.removeAllEventListeners(),a.mouseChildren=a.mouseEnabled=!1,cjs.Tween.get(a).to({scaleX:0,scaleY:0,alpha:0},300,cjs.Ease.backIn).call(this.removeChild,[a],this)},b.onConfirmationDialogEvent=function(a){var b,c=a.target;switch(c.name){case"Confirm":b="sfx-reset-positive",this.playResetAnimation();case"BackCancel":case"Cancel":b||(b="sfx-reset-negative"),this.hideConfirmation()}b&&cjs.Sound.play(b)},b.playResetAnimation=function(){var a=new cm.Assets.lib.AnimClear.ClearArea;a.regX=713,a.regY=384,a.onClear=this.onWaveAnimationClear.bind(this),a.onComplete=this.onWaveAnimationComplete.bind(this),a.framerate=24,a.name="AnimClear",this.addChild(a),cjs.Sound.play("sfx-loading1")},b.onWaveAnimationClear=function(){cjs.Sound.play("sfx-loading2");var a=new cjs.Event("AREA_RESET");this.dispatchEvent(a)},b.onWaveAnimationComplete=function(){var a=this.getChildByName("AnimClear");a&&(a.onComplete=null,a.onClear=null,this.removeChild(a))},b.onAreaButtonClick=function(a){var b=a.target,c=new cjs.Event("AREA_CLICK");c.data=b.name,this.dispatchEvent(c)},b.setSprite=function(a){var b=a[0];return a.shift(),a.push(b),b},b.spawnObject=function(a){var b=new cjs.Event("ADD_OBJECT");b.data=a,this.dispatchEvent(b)},b.updateCharacterList=function(a){for(var b=this.itemContainer.children,c=0;c<b.length;c++){var d=b[c],e=a.indexOf(d.currentAnimation)>=0;e?(d.alpha=.2,d.mouseEnabled=!1):(d.alpha=1,d.mouseEnabled=!0)}},b.resize=function(a,b){this.SharedUI_resize(a,b);var c=.5*a,d=.5*b,e=-d;this.resetBtn.x=c-87,this.resetBtn.y=e+77},cm.BuilderUI=cjs.promote(a,"SharedUI")}(),function(){"use strict";function a(a){if(this.Container_constructor(),this.regX=101,this.regY=102,this.data=a,this.mouseChildren=!1,a){var b=cm.PlayerData.isItemUnlocked(a.id),c=new cjs.Sprite(cm.Assets.lib.GuideBackgroundsSS,a.icon),d=new cjs.Sprite(cm.Assets.lib.GuideItemsSS,a.id);this.addChild(c,d),b||(c.gotoAndStop(c.currentAnimation+"_locked"),d.gotoAndStop(d.currentAnimation+"-locked"))}}createjs.extend(a,cjs.Container);cm.GuideItem=cjs.promote(a,"Container")}(),function(){"use strict";function a(a){this.Container_constructor(),this.data=a,this.badge1=this.getTagSprite(a.locations).set({x:-100,y:290}),this.badge2=this.getTagSprite(a.tags).center().set({x:100,y:290}),this.nameTag=new cjs.Container;var b=new cjs.BitmapText(a.title,cm.Assets.lib.FontSS).set({letterSpacing:-2});b.center();var c=b.getBounds(),d=c.width+120,e=new cjs.Shape;e.graphics.f("#3e6005").rr(0,0,d,68,34),e.regX=Math.floor(.5*(c.width+120)),e.regY=34,e.alpha=.75,this.nameTag.addChild(e,b),this.nameTag.cache(-e.regX,-e.regY,d,68),this.nameTag.y=-318,this.image=new cm.ShowcaseImage(a),this.image.y=-36,this.addChild(this.badge2,this.badge1,this.image,this.nameTag)}var b=createjs.extend(a,cjs.Container);b.setActive=function(a){a?(this.badge1.addEvents(),this.badge2.addEvents(),this.badge1.on("click",this.onBadgeTap,this),this.badge2.on("click",this.onBadgeTap,this),this.image.addEvents(),this.image.on("click",this.onShowcaseImageTap,this),this.nameTag.on("mousedown",this.onTitleTap,this),this.nameTag.on("pressup",this.onTitleTap,this),this.nameTag.on("click",this.onTitleTap,this)):(this.badge1.addEvents(),this.badge2.addEvents(),this.image.removeEvents(),this.nameTag.removeAllEventListeners())},b.onTitleTap=function(a){var b=this.nameTag;switch(a.type){case"mousedown":cjs.Tween.removeTweens(b),b.setScale(.95);break;case"click":var c=this.data.id.split("-").join("");cm.VO.play(c);case"pressup":cjs.Tween.get(b).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut)}},b.onShowcaseImageTap=function(){var a=this.data.id.split("-").join("");cm.VO.play(a+"fact")},b.onBadgeTap=function(a){var b="";switch(a.target.currentAnimation){case"TagIcon-Antarctic":b="assets/audio/vo/map/antarctic.ogg";break;case"TagIcon-Deep":b="assets/audio/vo/map/thedeep.ogg";break;case"TagIcon-Inanimate":b="assets/audio/vo/guidebook/misc/nonliving.ogg";break;case"TagIcon-Invertebrate":b="assets/audio/vo/guidebook/misc/invertebrate.ogg";break;case"TagIcon-Kelp":b="assets/audio/vo/map/kelpforest.ogg";break;case"TagIcon-Plant":b="assets/audio/vo/guidebook/misc/algae.ogg";break;case"TagIcon-Reef":b="reeftownrock";break;case"TagIcon-ReefShip":b="reeftownrock-sunkenship";break;case"TagIcon-Ship":b="assets/audio/vo/map/sunkenship.ogg";break;case"TagIcon-Vertebrate":b="assets/audio/vo/guidebook/misc/vertebrate.ogg"}cm.VO.play(b)},b.getTagSprite=function(a){var b;switch(a){case"sunkenship,reeftown":b="TagIcon-ReefShip";break;case"reeftown":b="TagIcon-Reef";break;case"kelpforest":b="TagIcon-Kelp";break;case"antarctic":b="TagIcon-Antarctic";break;case"deep":b="TagIcon-Deep";break;case"sunkenship":b="TagIcon-Ship";break;case"vert":b="TagIcon-Vertebrate";break;case"invert":b="TagIcon-Invertebrate";break;case"plant":b="TagIcon-Plant";break;case"other":b="TagIcon-Inanimate"}return new cm.UIFloatingButton(cm.Assets.lib.UISS,b).center()},cm.GuideShowcase=cjs.promote(a,"Container")}(),function(){"use strict";function a(){this.Container_constructor(),this.visible=!1,this.pageIndex=0,this.build()}var b=createjs.extend(a,cjs.Container);b.build=function(){var a=cm.Assets.lib.SeaweedSS,b={isKelp:!0,regX:713,regY:384},c=25;this.addChild(new cjs.Sprite(a,"Right3").set(b).set({xAnimateOffset:1426,wait:0}),new cjs.Sprite(a,"Left3A").set(b).set({xAnimateOffset:-1426,wait:c}),new cjs.Sprite(a,"Left3B").set(b).set({xAnimateOffset:-1426,wait:c}),new cjs.Sprite(a,"Right2").set(b).set({xAnimateOffset:1426,wait:2*c}),new cjs.Sprite(a,"Left2").set(b).set({xAnimateOffset:-1426,wait:3*c}),new cjs.Sprite(a,"Right1A").set(b).set({xAnimateOffset:1426,wait:4*c}),new cjs.Sprite(a,"Right1B").set(b).set({xAnimateOffset:1426,wait:4*c}),new cjs.Sprite(a,"Left1").set(b).set({xAnimateOffset:-1426,wait:5*c})),this.closeBtn=new cm.UIFloatingButton(cm.Assets.lib.UISS,"XBtn").set({yOffset:0}),this.leftArrow=new cm.UIFloatingButton(cm.Assets.lib.UISS,"LeftArrow").set({x:-450,visible:!1}),this.rightArrow=new cm.UIFloatingButton(cm.Assets.lib.UISS,"RightArrow").set({x:450}),this.buildList(),this.addChild(this.leftArrow,this.rightArrow,this.closeBtn),this.resize(cm.System.width,cm.System.height),this.makeAllPagesInvisibleExcept(0)},b.buildList=function(){for(var a=new cjs.Container,b=cm.config.items.list,c=b.length,d=6,e=Math.ceil(c/d),f=0;e>f;f++){var g=new cjs.Container;g.visible=!0,g.regX=353,g.regY=228;for(var h=0,i=d*f;d*f+d>i;i++){var j=new cm.GuideItem(b[i]);j.x=250*(h%3)+j.regX,j.y=252*Math.floor(h/3)+j.regY,g.addChild(j),h++}g.x=1426*f,a.addChild(g)}this.addChild(a),this.groupContainer=a,a.visible=!1},b.onItemInteract=function(a){var b=a.target;switch(a.type){case"mousedown":cjs.Tween.removeTweens(b),b.setScale(.9);break;case"click":cjs.Sound.play("sfx-home");var c=b.data.id.split("-").join("");cm.VO.play(c),this.gotoShowcase(b.data);case"pressup":cjs.Tween.get(b).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut)}},b.gotoGallery=function(){cm.VO.stop(),this.setActive(!1),this.closeBtn.gotoAndStop("XBtn"),cjs.Tween.get(this.groupContainer).set({visible:!0}).to({y:0},800,cjs.Ease.cubicInOut).call(this.setActive,[!0],this),cjs.Tween.get(this.showcase).to({y:-768},800,cjs.Ease.cubicInOut).set({visible:!1}),this.showcase=null},b.gotoShowcase=function(a){this.setActive(!1),this.closeBtn.gotoAndStop("BackBtn"),this.leftArrow.alpha=this.rightArrow.alpha=0,this.showcase=new cm.GuideShowcase(a),this.addChild(this.showcase),cjs.Tween.get(this.groupContainer).to({y:768},800,cjs.Ease.cubicInOut).set({visible:!1}),this.showcase.y=-768,cjs.Tween.get(this.showcase).set({visible:!0}).to({y:0},800,cjs.Ease.cubicInOut).call(this.setActive,[!0],this)},b.resize=function(a,b){var c=.5*a,d=-c;this.closeBtn.x=d+87},b.animateIn=function(){cm.Tracking.oceanGuideView(cm.Globals.currentLevel),this.leftArrow.alpha=this.rightArrow.alpha=0,cm.main.topStage.stopUpdate=!1,this.groupContainer.visible=!0,this.groupContainer.y=-768,this.resetKelp(),this.closeBtn.y=-500,this.visible=!0;for(var a=0;a<this.children.length;a++){var b=this.children[a];b.isKelp&&cjs.Tween.get(b).wait(b.wait).to({x:0},800,cjs.Ease.cubicOut)}cjs.Tween.get(this.groupContainer).wait(200).to({y:0},600,cjs.Ease.cubicOut).call(this.playStartVO,null,this).call(this.setActive,[!0],this),cjs.Tween.get(this.closeBtn).wait(200).to({y:-307},600,cjs.Ease.cubicOut),cjs.Tween.get(this.closeBtn).wait(200).to({y:-307},600,cjs.Ease.cubicOut),cjs.Tween.get(this.leftArrow).wait(200).to({alpha:1},600,cjs.Ease.quadInOut),cjs.Tween.get(this.rightArrow).wait(200).to({alpha:1},600,cjs.Ease.quadInOut)},b.animateOut=function(){for(var a,b=0;b<this.children.length;b++){var c=this.children[b];c.isKelp&&(a=cjs.Tween.get(c).wait(200).wait(c.wait).to({x:c.xAnimateOffset},800,cjs.Ease.cubicIn))}cjs.Tween.get(this.leftArrow).to({alpha:0},600,cjs.Ease.quadInOut).set({visible:!1}),cjs.Tween.get(this.rightArrow).to({alpha:0},600,cjs.Ease.quadInOut).set({visible:!1}),cjs.Tween.get(this.groupContainer).to({y:-768},600,cjs.Ease.cubicIn),cjs.Tween.get(this.closeBtn).to({y:-500},600,cjs.Ease.cubicIn),cjs.Tween.get(this).wait(a.duration).set({visible:!1}).call(this.stopTopStage,null,this)},b.stopTopStage=function(){cm.main.gameStage.tickChildren=!0,cm.main.gameStage.tickEnabled=!0,cm.main.gameStage.tickOnUpdate=!0,cm.main.topStage.tickChildren=!1,cm.main.topStage.tickEnabled=!1,cm.main.topStage.tickOnUpdate=!1,cm.main.topStage.clear()},b.playStartVO=function(){cm.PlayerData.needsFlag("OceanGuideIntro")&&cm.VO.play("oceanguidestart")},b.setActive=function(a){var b=!!this.showcase;a&&!b?(this.groupContainer.on("mousedown",this.onItemInteract,this),this.groupContainer.on("pressup",this.onItemInteract,this),this.groupContainer.on("click",this.onItemInteract,this),this.leftArrow.addEvents(),this.leftArrow.on("click",this.onArrowBtnClick,this),this.rightArrow.addEvents(),this.rightArrow.on("click",this.onArrowBtnClick,this)):(this.groupContainer.removeAllEventListeners(),this.leftArrow.removeEvents(),this.rightArrow.removeEvents()),this.showcase&&this.showcase.setActive(a),a?(this.closeBtn.addEvents(),this.closeBtn.on("click",this.onCloseBtnClick,this),cm.CordovaUtils.on("BACK_BUTTON",this.onCloseBtnClick,this)):(this.closeBtn.removeEvents(),cm.CordovaUtils.removeAllEventListeners())},b.onArrowBtnClick=function(a){cjs.Tween.hasActiveTweens(this.groupContainer)||(cjs.Sound.play("sfx-home"),a.target===this.rightArrow?this.nextPage():this.prevPage(),this.leftArrow.visible=this.pageIndex>0,this.rightArrow.visible=this.pageIndex<this.groupContainer.children.length-1)},b.nextPage=function(){this.pageIndex++,this.gotoPage()},b.prevPage=function(){this.pageIndex--,this.gotoPage()},b.gotoPage=function(){this.groupContainer.children[this.pageIndex].visible=!0,cjs.Tween.get(this.groupContainer).to({x:-1426*this.pageIndex},800,cjs.Ease.cubicInOut).call(this.makeAllPagesInvisibleExcept,[this.pageIndex],this)},b.makeAllPagesInvisibleExcept=function(a){for(var b=0;b<this.groupContainer.children.length;b++)this.groupContainer.children[b].visible=a===b},b.onCloseBtnClick=function(a){a.target===cm.CordovaUtils&&a.stopPropagation(),cjs.Sound.play("sfx-home"),"XBtn"===this.closeBtn.currentAnimation?this.selfClose():(this.leftArrow.alpha=this.rightArrow.alpha=1,this.gotoGallery())},b.selfClose=function(){this.setActive(!1),this.animateOut(),cm.Assets.unload("OceanGuide"),cm.ViewControl.current.setActive(!0),cm.main.gameStage.stopUpdate=!1},b.resetKelp=function(){for(var a=0;a<this.children.length;a++){var b=this.children[a];b.isKelp&&(b.x=b.xAnimateOffset)}},cm.OceanGuide=cjs.promote(a,"Container")}(),function(){"use strict";function a(a,b){this.Container_constructor(),this.regX=226,this.regY=227,this.snapToPixel=!1,this.mouseChildren=!1;var c=cm.PlayerData.isItemUnlocked(a.id)&&!b?"":"-locked",d=new cjs.Bitmap("assets/images/guide/bgs/"+a.icon+c+".png"),e=new cjs.Bitmap("assets/images/guide/showcase/"+a.id+c+".png");this.addChild(d,e)}var b=createjs.extend(a,cjs.Container);b.addEvents=function(){this.on("mousedown",this.onEvent,this),this.on("pressup",this.onEvent,this),this.on("click",this.onEvent,this)},b.onEvent=function(a){switch(a.type){case"mousedown":cjs.Tween.removeTweens(this),this.setScale(.95);break;case"click":case"pressup":cjs.Tween.get(this).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut)}},b.removeEvents=function(a){this.removeAllEventListeners()},cm.ShowcaseImage=cjs.promote(a,"Container")}(),function(){function a(){this.initializeStages(),this.initLayers(),this.boot(),b.main=this,this.ready=!0}var b=include("cm"),c=createjs.extend(a,b.App);c.boot=function(){b.config=window.AppConfig,b.GameData.setData(b.config),b.Assets.setData(b.config.assets),b.ViewControl.registerView("Title",b.View.Title,!1),b.ViewControl.registerView("Map",b.View.Map,!1),b.ViewControl.registerView("LevelExplorer",b.View.LevelExplorer,!1),b.ViewControl.registerView("OceanBuilder",b.View.OceanBuilder,!1),b.Assets.load(["Boot","Title"],this.onBootLoad.bind(this))},c.onBootLoad=function(){b.ViewControl.TransitionClass=b.LoaderTransition,b.ViewControl.setTransitionLayer(b.Layer.s.Transition),b.Layer.s.Demo.addChild(new b.DemoHand),b.Layer.s.Views.addChild(new cjs.Bitmap(b.Assets.lib.TitleBG).center()),this.gotoStartView()},c.initSound=function(){return b.log("Initialize sounds"),cjs.WebAudioPlugin.isSupported()&&cjs.WebAudioPlugin.playEmptySound(),cjs.Sound.initializeDefaultPlugins()?(cjs.Sound.alternateExtensions=["ogg","mp3"],void(cjs.Sound.defaultInterruptBehavior=cjs.Sound.INTERRUPT_EARLY)):void b.log("Sound Problem!!!")},c.onTrampolineReady=function(){Trampoline.events.removeEventListener("TRAMPOLINE_READY",this.trampolineListener),b.Tracking.addDeviceDimension(),this.gotoStartView()},c.gotoStartView=function(){b.ViewControl.gotoView("Title")},c.resize=function(a,c){b.Layer.alignLayers(a,c),b.ViewControl.resize(a,c),b.System.width=a,b.System.height=c},c.onMainLoad=function(){b.ViewControl.gotoView("Map")},c.initializeStages=function(){var a=this.gameStage=b.app.display.stage;a.snapToPixelEnabled=!0,a.autoClear=!0,b.Device.mobile&&cjs.Touch.isSupported()?a.enableDOMEvents(!1):a.enableMouseOver(30),b.Mouse.bind(b.Mouse.KEYS.LEFT,"mouse"),b.Keyboard.bind(b.Keyboard.KEYS.D,"debug"),cjs.Ticker.timingMode=createjs.Ticker.RAF},c.handleTopStage=function(){},c.initLayers=function(){this.gameStage.addChild(new b.Layer("Views",.5,.5),new b.Layer("Demo",.5,.5),new b.Layer("Transition",.5,.5));var a=b.app.display.stage;b.Layer.alignLayers(a.width,a.height),b.ViewControl.setViewLayer(b.Layer.s.Views),this.initSound()},c.showOceanGuide=function(){},c.readyForOceanGuide=function(){var a=new b.OceanGuide;b.Layer.s.OceanGuide.addChild(a),a.animateIn()},c.gotoLevel=function(a){b.Globals.currentLevel=a,b.ViewControl.gotoLoaderThen(["Global","LevelExplorer","Level"+b.Globals.currentLevel,"GameObjects"+b.Globals.currentLevel],"LevelExplorer")},c.update=function(a,c){
this.ready&&(b.debugDiv&&(b.debugDiv.innerHTML=Math.round(cjs.Ticker.getMeasuredFPS())+"\n"+window._cjsDrawCount),window._cjsDrawCount=0)},b.Main=createjs.promote(a,"App")}(),cm.deploy=function(a,b){var c=setInterval(function(){if(cm.ready&&cm.Main){clearInterval(c),cm.App.Paths.Media=b||"";var d={element:a,width:1024,height:768,minWidth:1024,maxWidth:768};cm.System.start(cm.Main,d)}},100)},function(){"use strict";function a(){throw"CharacterVO cannot be instantiated."}var b=a;b.clips={splash:{base:"splash",congrats:["awesome","good","great","thatone","yes","youfound","yougot"],easteregg:["hey","short-laugh-a","short-laugh-e","whoa-a","woo-b"],selection:["hey","short-laugh-e"]},bubbles:{base:"bubbles",congrats:["awesome","foundit","goodjob","gotit","greatwork","hidden","yes"],easteregg:["hey","heytk2","short-laugh-a","short-laugh-b","short-laugh-c","short-laugh-g","wee-a","whoa-a","woo-b"],selection:["hey","heytk2","wee-a"]},dunk:{base:"dunk",congrats:["awesome","good","great","thatone","youfound","yougot","yea"],easteregg:["hey","short-laugh-b","short-laugh-c","short-laugh-e","wee-c","woa-a"],selection:["hey","wee-c"]},ripple:{base:"ripple",congrats:["awesome","good","great","thatone","yes-a","youfound","yougot-a"],easteregg:["hey-c","short-laugh-a","wee-b","whoa-a","woo"],selection:["hey-c","wee-b"]}},b.playCongrats=function(a){a=a.toLowerCase();var c=b.clips[a],d=c.congrats.randomRotation(3);cm.VO.play(c.base+"-"+d)},b.playEasterEgg=function(a){if(!cm.VO.isPlaying){a=a.toLowerCase();var c=b.clips[a],d=c.easteregg.randomRotation(3);cm.VO.play(c.base+"-"+d)}},b.playSelection=function(a){a=a.toLowerCase();var c=b.clips[a],d=c.selection.randomRotation(2);cm.VO.play(c.base+"-"+d)},cm.CharacterVO=a}(),function(){"use strict";function a(){this.Container_constructor(),this.followObject=null,this.pt=new cjs.Point,this.offsetX=0,this.offsetY=0,this.sprite=new cjs.Bitmap(cm.Assets.lib.DemoHand).set({regX:32,regY:28}),this.addChild(this.sprite),this.alpha=0,cm.Layer.s.Demo.addChild(this),cm.DemoHand=this}var b=createjs.extend(a,cjs.Container);b.showSwimControls=function(a){var b=a.localToLocal(0,0,cm.Layer.s.Demo);this.set(b),this.alignHand(),cjs.Tween.get(this).to({alpha:1},100,cjs.Ease.quadInOut).to({scaleX:.9,scaleY:.9},200).to({x:b.x+300,y:b.y+100},2e3,cjs.Ease.quadInOut).to({alpha:0,scaleX:1,scaleY:1},200,cjs.Ease.quadInOut)},b.tapObject=function(a,b,c){this.followObject=a,this.offsetX=b||0,this.offsetY=c||0,this.alignHand(),cjs.Tween.get(this).to({alpha:1},100,cjs.Ease.quadInOut).wait(300).to({scaleX:.9,scaleY:.9},200).wait(100).to({scaleX:1,scaleY:1},200).wait(1e3).to({alpha:0},200,cjs.Ease.quadInOut).set({followObject:!1},this)},b.slide=function(a,b,c,d){this.set({alpha:0}),this.set(a),this.alignHand(),cjs.Tween.get(this).wait(d||0).to({alpha:1},100,cjs.Ease.quadInOut).to(b,c,cjs.Ease.quadInOut).to({alpha:0},200,cjs.Ease.quadInOut)},b.alignHand=function(){var a=this.sprite;a.scaleY=this.y>200?-1:1,a.scaleX=this.x>512?-1:1},b._tick=function(a){var b=this.followObject;if(b){var c=b.parent.localToLocal(b.x,b.y,this.parent,this.pt);this.x=c.x+this.offsetX,this.y=c.y+this.offsetY,this.alignHand()}this.Container__tick(a)},cm.DemoHand=cjs.promote(a,"Container")}(),function(){"use strict";function a(){throw"TrackingAssist cannot be instantiated."}var b=a;b.addDeviceDimension=function(){if(window.device){var a=window.device.model,c=window.device.platform;"iOS"===c&&b.dimension(3,a)}},b.exploreView=function(a){var c=cm.config.tracking.views[a];b.view(c)},b.builderView=function(a){var c=cm.config.tracking.views.OceanBuilderPrefix+cm.config.tracking.views[a];b.view(c)},b.oceanGuideView=function(a){var c=cm.config.tracking.views.OceanGuidePrefix+cm.config.tracking.views[a];b.view(c)},b.oceanGuideClick=function(a){var c=cm.config.tracking.views[a];b.event(cm.config.tracking.events.OceanGuideClickFromExplore,c)},b.view=function(a,c,d){window.ga&&window.ga.trackView&&window.ga.trackView(a,c,d),b._log("send, view, "+a+", "+c+", "+d)},b.event=function(a,c,d){window.ga&&window.ga.trackEvent&&window.ga.trackEvent(a,c,d),b._log("send, event, "+a+", "+c+", "+d)},b.dimension=function(a,c){window.ga&&window.ga.addCustomDimension&&window.ga.addCustomDimension(a,c),b._log("Set ga dimension, "+a+" , "+c)},b._log=function(a){"string"==typeof a&&(a="GAME TRACKING | "+a),"undefined"!=typeof console&&console.log},cm.Tracking=a}(),function(){"use strict";function a(){this.ViewTransition_constructor(),this.visible=!1}var b=createjs.extend(a,cm.ViewTransition);a.FULL_WIDTH=0,a.EASE=cjs.Ease.cubicInOut,a.TIME=1e3,b.build=function(){this.buildBackgroundShape();var a=cm.Assets.lib.UISS;this.spinner=new cjs.Sprite(a,"Spinner").center(),this.logo=new cjs.Sprite(a,"LoaderLogo").center(),this.addChild(this.backgroundShapes,this.spinner,this.logo)},b.buildBackgroundShape=function(){this.backgroundShapes=new cjs.Container;var a=new cjs.Shape;a.graphics.f("#0084B4").r(-713,-700,1426,1400);var b=new cjs.Shape;b.graphics.f("#CAFEFE").s().p("Eg/xAEiQhUgbj4hmQjShXiKghQjLgxjDASQklAjizAQQlFAfjtgJQhwgEhigNQn7hEiukvIAAgoQAOAOAQAOIAKAJIF+C3IDfAmIAkADQA/AGBFADIBOABIG3gUIBIgHIADAAIAHgBIB8gNQCDgOCogUQDDgTDLAyQCKAhDSBWQD4BmBUAbQC7A7CggDQD1gGFziIIB8gtICuhAQCsg9CEgcQEDg2EOAnQDPAeEwBpQEnBkE+AAQFMABEThsQA1gVCghFQCjhDCOgpIADgBQGph7FdBEQCxAjDtBRQCHAvELBhQDqBQCuAhQDiAtDOgPQDKgPDyhRQCKguEIhjQDnhOC5gIQDvgMD7BdIKeENQDEAxEygJQAqgBF/gbIBRgFQBEgFCogcQDXgjBSgLQF7gzCKBHIAAB2IAAAMQifgflSAzQliA9htAIIirAMQkrAUgkABQkyAJjEgxIqekOQj7hcjvAMQi5AIjnBNQkIBjiKAvQjyBRjKAPQjOAPjigtQiughjqhRQkLhhiHguQjthRixgjQlehEmrB8IhXAbQhoAihyAuQigBFg1AVQkTBtlMgBQk+AAknhlQkwhpjPgdQkOgnkDA1QiEAcisA9IkIBiIgiAMQlzCIj1AGIgSAAQiYAAixg4g"),b.set({regX:-5,regY:47,y:-700,visible:!1});var c=new cjs.Shape;c.graphics.f("#0084B4").s().p("EhvZAHlIAAvJQAPAYAQAXQAWAgAbAeQATAUAVATQgQgNgOgPIAAAoQCuEvH7BEQBiANBwAFQDtAJFFgfQCzgRElghQDDgTDLAwQCKAhDSBXQD4BnBUAaQC7A8CggEQD1gFFziIIAigNIEIhiQCsg9CEgaQEDg3EOAnQDPAdEwBpQEnBlE+ABQFMABEThuQA1gUCfhFQBzgvBogiIBXgbQGrh8FeBFQCxAiDtBSQCHAtELBhQDqBRCuAiQDiAsDOgPQDKgODyhSQCKguEIhjQDnhNC5gJQDvgLD7BcIKeEOQDEAwEygJQAkgBErgUICrgMQBtgHFig+QFSgyCfAfIAAgMIAAEygEhYsgB0IAngDIhIAGIAhgDg"),c.set({regX:0,regY:46,y:-700,visible:!1});var d=new cjs.Shape;d.graphics.f("#CAFEFE").s().p("Eg/xAEiQhUgbj4hmQjShXiKghQjLgxjDASQklAjizAQQlFAfjtgJQhwgEhigNQn7hEiukvIAAgoQAOAOAQAOIAKAJIF+C3IDfAmIAkADQA/AGBFADIBOABIG3gUIBIgHIADAAIAHgBIB8gNQCDgOCogUQDDgTDLAyQCKAhDSBWQD4BmBUAbQC7A7CggDQD1gGFziIIB8gtICuhAQCsg9CEgcQEDg2EOAnQDPAeEwBpQEnBkE+AAQFMABEThsQA1gVCghFQCjhDCOgpIADgBQGph7FdBEQCxAjDtBRQCHAvELBhQDqBQCuAhQDiAtDOgPQDKgPDyhRQCKguEIhjQDnhOC5gIQDvgMD7BdIKeENQDEAxEygJQAqgBF/gbIBRgFQBEgFCogcQDXgjBSgLQF7gzCKBHIAAB2IAAAMQifgflSAzQliA9htAIIirAMQkrAUgkABQkyAJjEgxIqekOQj7hcjvAMQi5AIjnBNQkIBjiKAvQjyBRjKAPQjOAPjigtQiughjqhRQkLhhiHguQjthRixgjQlehEmrB8IhXAbQhoAihyAuQigBFg1AVQkTBtlMgBQk+AAknhlQkwhpjPgdQkOgnkDA1QiEAcisA9IkIBiIgiAMQlzCIj1AGIgSAAQiYAAixg4g"),d.set({regX:-5,regY:47,scaleX:-1,scaleY:-1,y:700,visible:!1});var e=new cjs.Shape;e.graphics.f("#0084B4").s().p("EhvZAHlIAAvJQAPAYAQAXQAWAgAbAeQATAUAVATQgQgNgOgPIAAAoQCuEvH7BEQBiANBwAFQDtAJFFgfQCzgRElghQDDgTDLAwQCKAhDSBXQD4BnBUAaQC7A8CggEQD1gFFziIIAigNIEIhiQCsg9CEgaQEDg3EOAnQDPAdEwBpQEnBlE+ABQFMABEThuQA1gUCfhFQBzgvBogiIBXgbQGrh8FeBFQCxAiDtBSQCHAtELBhQDqBRCuAiQDiAsDOgPQDKgODyhSQCKguEIhjQDnhNC5gJQDvgLD7BcIKeEOQDEAwEygJQAkgBErgUICrgMQBtgHFig+QFSgyCfAfIAAgMIAAEygEhYsgB0IAngDIhIAGIAhgDg"),e.set({regX:0,regY:46,scaleX:-1,scaleY:-1,y:700,visible:!1}),this.backgroundShapes.addChild(a,c,b,e,d),this.backgroundShapes.topDark=c,this.backgroundShapes.topLight=b,this.backgroundShapes.bottomDark=e,this.backgroundShapes.bottomLight=d,this.jellyfish=new cm.Assets.lib.JellyfishLoader.WaveTop,this.jellyfish.regX=713,this.backgroundShapes.addChild(this.jellyfish)},b.transitIn=function(){var a=this.backgroundShapes;return a.y=1200,this.setEdgeVisiblityState(1),this.visible=!0,cjs.Sound.play("sfx-loading1"),cjs.Tween.get(a).to({y:0},1400,cjs.Ease.linear).call(this.setEdgeVisiblityState,[0],this),this.logo.y=800,cjs.Tween.get(this.logo).wait(700).to({y:0},800,cjs.Ease.backOut),this.spinner.y=800,cjs.Tween.get(this.spinner).wait(700).to({y:0},800,cjs.Ease.backOut),1400},b.transitOut=function(){var a=this.backgroundShapes;return this.setEdgeVisiblityState(2),cjs.Sound.play("sfx-loading2"),cjs.Tween.get(a).wait(600).to({y:-1600},1400,cjs.Ease.linear).set({visible:!1},this),cjs.Tween.get(this.logo).to({y:-800},1e3,cjs.Ease.backIn),cjs.Tween.get(this.spinner).to({y:-800},1e3,cjs.Ease.backIn),1500},b.setEdgeVisiblityState=function(a){var b=this.backgroundShapes;b.topLight.visible=b.topDark.visible=1===a,b.bottomLight.visible=b.bottomDark.visible=2===a,1===a?this.jellyfish.y=-700:2===a&&(this.jellyfish.y=700)},b._tick=function(a){this.spinner.rotation+=100*cm.tick,this.ViewTransition__tick(a)},cm.LoaderTransition=cjs.promote(a,"ViewTransition")}(),function(){"use strict";function a(a,b,c,d){this.Sprite_constructor(a,b),this.reg(c,d),this.snapToPixel=!1}var b=createjs.extend(a,cjs.Sprite);b.addEvents=function(){this.on("mousedown",this.onEvent,this),this.on("pressup",this.onEvent,this),this.on("click",this.onEvent,this)},b.onEvent=function(a){switch(a.type){case"mousedown":cjs.Tween.removeTweens(this),this.setScale(.9);break;case"click":case"pressup":cjs.Tween.get(this).to({scaleX:1,scaleY:1},200,cjs.Ease.backOut)}},b.removeEvents=function(a){this.removeAllEventListeners()},cm.UICornerButton=cjs.promote(a,"Sprite")}(),function(){"use strict";function a(){this.Character_constructor(),this.turnCountdown=4}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsDeep","CharBiggie"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharBiggie.Biggie_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.scaleX*=-1),this.x+=20*b*this.scaleX,this.Character__tick(a)}},cm.Character.Biggie=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.time=0}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsDeep","CharBoo"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharBoo.Boo_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.time+=b,this.anim.y=30*Math.sin(this.time),this.Character__tick(a)}},cm.Character.Boo=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.turnCountdown=4}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharCharlie"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharCharlie.Charlie_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.scaleX*=-1),this.x+=20*b*this.scaleX,this.Character__tick(a)}},cm.Character.Charlie=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.turnCountdown=4}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharChompy"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharChompy.Chompy_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.scaleX*=-1),this.x+=50*b*this.scaleX,this.Character__tick(a)}},cm.Character.Chompy=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor()}var b=a;b.isSingleCharacter=!0,b.allowFall=!0;var c=createjs.extend(a,cm.Character);c.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharDenny"))},c.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharDenny.Denny_1)},cm.Character.Denny=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.turnCountdown=4}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharFlo"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharFlo.Flo_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.scaleX*=-1),this.x-=20*b*this.scaleX,this.Character__tick(a)}},cm.Character.Flo=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor()}var b=a;b.isSingleCharacter=!0,b.allowFall=!0;var c=createjs.extend(a,cm.Character);c.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharGush"))},c.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharGush.Gush_1)},cm.Character.Gush=cjs.promote(a,"Character")}(),function(){"use strict";function a(a){this.Character_constructor(a),a&&this.addSensorCircle(a,250),this.time=0}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsDeep","CharLuAndBob"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharLuAndBob.LuandBob),this.findGlow()},b.switchSpots=function(a){this.Character_switchSpots(a),this.getPhysicsTransform()},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.time+=b,this.anim.y=30*Math.sin(this.time);var c=this._body;if(c){var d=c.GetPosition();d.x=this.x/b2.b2Scale,d.y=(this.y+this.anim.y)/b2.b2Scale,c.SetPosition(d)}this.Character__tick(a)}},b.findGlow=function(){for(var a=this.anim.instance,b=0;a;){var c=a.glow;if(c)return c.visible=!1,c.alpha=0,void(this.glow=c);b++,a=this.anim["instance_"+b]}},b.changeGlow=function(a){var b=a>0;b?cjs.Tween.get(this.glow,{override:!0}).set({visible:!0}).to({alpha:a},500,cjs.Ease.quadInOut):cjs.Tween.get(this.glow,{override:!0}).to({alpha:a},500,cjs.Ease.quadInOut).set({visible:!1})},b.beginContact=function(a,b,c,d,e,f){c.isHero&&this.changeGlow(1)},b.endContact=function(a,b,c,d,e,f){c.isHero&&this.changeGlow(0)},cm.Character.LuAndBob=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.turnCountdown=4}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsAntarctic","CharMac"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharMac.Mac_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.scaleX*=-1),this.x+=20*b*this.scaleX,this.Character__tick(a)}},cm.Character.Mac=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.time=0}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharMaury"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharMaury.Maury_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.time+=b,this.anim.y=30*Math.sin(this.time),this.Character__tick(a)}},cm.Character.Maury=cjs.promote(a,"Character")}(),function(){"use strict";function a(a){this.Character_constructor(a),a&&this.addSensorCircle(a,200),this.turnCountdown=4,this.target=!1,this.targetAngle=!1,this.swimCircle=0,this.needsToReturn=!1}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsDeep","CharMortimer"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharMortimer.Nautilus)},b.switchSpots=function(a){this.Character_switchSpots(a),this.getPhysicsTransform()},b.beginContact=function(a,b,c,d,e,f){c.isHero&&(this.target=c,this.targetAngle=!0)},b.endContact=function(a,b,c,d,e,f){c.isHero&&(this.target=!1,this.targetAngle=!1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick,c=0,d=0;if(this.target){var e=this.target.x-this.x,f=this.target.y-this.y,g=this.anim.x,h=this.anim.y,i=e-g,j=f-h,k=Math.sqrt(i*i+j*j),l=Math.atan2(j,i);l+=90*Math.DEGTORAD,k>200&&(e+=200*Math.cos(l),f+=200*Math.sin(l),i=e-g,j=f-h,l=Math.atan2(j,i)),c=300*Math.cos(l),d=300*Math.sin(l),this.needsToReturn=!0}else if(this.needsToReturn){var m=-this.anim.x,n=-this.anim.y,o=Math.sqrt(m*m+n*n),p=Math.atan2(n,m);c=50*Math.cos(p),d=50*Math.sin(p),10>o&&(this.needsToReturn=!1)}else this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.anim.scaleX*=-1),c=-40*this.anim.scaleX;this.anim.x+=c*b,this.anim.y+=d*b,this.anim.scaleX=c>0?-1:1,this.Character__tick(a)}},cm.Character.Mortimer=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.time=0}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsKelpForest","CharMrsTidy"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharMrsTidy.MrsTidy_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.time+=b,this.anim.y=30*Math.sin(this.time),this.Character__tick(a)}},cm.Character.MrsTidy=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.turnCountdown=4}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsDeep","CharOblo"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharOblo.Oblo_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.scaleX*=-1),this.x+=20*b*this.scaleX,this.Character__tick(a)}},cm.Character.Oblo=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor()}var b=a;b.isSingleCharacter=!0,b.allowFall=!0;var c=createjs.extend(a,cm.Character);c.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharPearlene"))},c.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharPearlene.Pearline)},cm.Character.Pearlene=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor()}var b=a;b.isSingleCharacter=!0,b.allowFall=!0;var c=createjs.extend(a,cm.Character);c.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharScoutAndSnap"))},c.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharScoutAndSnap.Snap)},cm.Character.ScoutAndSnap=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.turnCountdown=4}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsKelpForest","CharTidy"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharTidy.Tidy_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.scaleX*=-1),this.x+=20*b*this.scaleX,this.Character__tick(a)}},cm.Character.Tidy=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.time=0}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsKelpForest","CharTyke"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharTyke.Tyke_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.time+=b,this.anim.y=30*Math.sin(this.time),this.Character__tick(a)}},cm.Character.Tyke=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor()}var b=a;b.isSingleCharacter=!0,b.allowFall=!0;var c=createjs.extend(a,cm.Character);c.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharWave"))},c.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharWave.Wave_1)},cm.Character.Wave=cjs.promote(a,"Character")}(),function(){"use strict";function a(){this.Character_constructor(),this.turnCountdown=4}a.isSingleCharacter=!0;var b=createjs.extend(a,cm.Character);b.loadSelf=function(a){this.Character_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","CharZee"))},b.buildMovieClip=function(){this.Character_buildMovieClip(cm.Assets.lib.CharZee.Zee_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=6,this.scaleX*=-1),this.x+=-20*b*this.scaleX,this.Character__tick(a)}},cm.Character.Zee=cjs.promote(a,"Character")}(),function(){"use strict";function a(a){this.AutoLoadingAnimation_constructor(a),this.physicsWorld&&this.addSensorCircle(this.physicsWorld,250),this.isScared=!1,this.direction=-1}var b=createjs.extend(a,cm.AutoLoadingAnimation);b.loadSelf=function(a){this.AutoLoadingAnimation_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","GOAnimDecoratorCrab"))},b.buildMovieClip=function(){this.AutoLoadingAnimation_buildMovieClip(cm.Assets.lib.GOAnimDecoratorCrab.DecoratorCrab_1)},b.switchSpots=function(a){this.AutoLoadingAnimation_switchSpots(a),this.getPhysicsTransform()},b._tick=function(a){if(this.isLoaded){var b=cm.tick;if(this.isScared)return this.visible||(this.isScared=!1,this.anim.gotoAndPlay("Walk")),void this.AutoLoadingAnimation__tick(a);var c=this.direction;this.anim.x+=20*c*b,(0>c&&this.anim.x<-300||c>0&&this.anim.x>300)&&(this.direction*=-1);var d=this._body;if(d){var e=d.GetPosition(),f=this.x+this.anim.x;e.x=f/b2.b2Scale,d.SetPosition(e)}this.AutoLoadingAnimation__tick(a)}},b.beginContact=function(a,b,c,d,e,f){c.isHero&&!this.isScared&&(cm.CharacterVO.playEasterEgg(c.character),this.isScared=!0,this.anim.gotoAndPlay("Crouch"))},cm.GameObject.DecoratorCrab=cjs.promote(a,"AutoLoadingAnimation")}(),function(){"use strict";function a(){this.CollectibleAnimation_constructor()}var b=a;b.isSingleCharacter=!1,b.allowFall=!0;var c=createjs.extend(a,cm.CollectibleAnimation);c.loadSelf=function(a){this.CollectibleAnimation_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","GOAnimFeatherDuster"))},c.buildMovieClip=function(){this.CollectibleAnimation_buildMovieClip(cm.Assets.lib.GOAnimFeatherDuster.FeatherDuster_1)},cm.GameObject.FeatherDuster=cjs.promote(a,"CollectibleAnimation")}(),function(){"use strict";function a(a){this.CollectibleAnimation_constructor(a),a&&this.addSensorCircle(a,250),this.time=0}var b=createjs.extend(a,cm.CollectibleAnimation);b.loadSelf=function(a){this.CollectibleAnimation_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsDeep","GOAnimFireflySquid"))},b.buildMovieClip=function(){this.CollectibleAnimation_buildMovieClip(cm.Assets.lib.GOAnimFireflySquid.FireflySquid_1),this.findGlows()},b.switchSpots=function(a){this.CollectibleAnimation_switchSpots(a),this.getPhysicsTransform()},b.findGlows=function(){this.glows=[];for(var a=this.anim.instance,b=0;a;){var c=a.glow;c&&(c.visible=!1,c.alpha=0,this.glows.push(c)),b++,a=this.anim["instance_"+b]}},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.time+=b,this.anim.y=30*Math.sin(this.time);var c=this._body;if(c){var d=c.GetPosition();d.x=this.x/b2.b2Scale,d.y=(this.y+this.anim.y)/b2.b2Scale,c.SetPosition(d)}this.CollectibleAnimation__tick(a)}},b.changeGlow=function(a){for(var b=a>0,c=0;c<this.glows.length;c++)b?cjs.Tween.get(this.glows[c],{override:!0}).set({visible:!0}).to({alpha:a},500,cjs.Ease.quadInOut):cjs.Tween.get(this.glows[c],{override:!0}).to({alpha:a},500,cjs.Ease.quadInOut).set({visible:!1})},b.beginContact=function(a,b,c,d,e,f){c.isHero&&this.changeGlow(1)},b.endContact=function(a,b,c,d,e,f){c.isHero&&this.changeGlow(0)},cm.GameObject.FireflySquid=cjs.promote(a,"CollectibleAnimation")}(),function(){"use strict";function a(a){this.GameObject_constructor(a),this.isBuilt=!1,this.speed=150,this.time=0,this.chasePoint=new cjs.Point}var b=createjs.extend(a,cm.GameObject);b.buildSchool=function(a,b){for(var c=0;5>c;c++){var d=new cjs.Sprite(a,"SwimLoopR").set(b);d.x=Math.range(-90,90),d.y=Math.range(-70,70),d.mod=40*c,this.addChild(d)}this.isBuilt=!0},b._tick=function(a){if(this.GameObject__tick(a),this.isBuilt){var b=cm.tick;this.time+=b;var c=this.chasePoint,d=3,e=3,f=6,g=1,h=6,i=1,j=this.time/10;c.x=300*(Math.cos(f*j)-Math.pow(Math.cos(g*j),d)),c.y=200*(Math.sin(h*j)-Math.pow(Math.sin(i*j),e));for(var k=this.children,l=0,m=k.length;m>l;l++){var n=k[l],o=0;switch(n.currentAnimation){case"SwimLoopR":o=this.speed;break;case"SwimLoopL":o=-this.speed}var p=1,q=this.getClosetNeighbor(n,k),r=Math.pointAngle(n,c);if(q){var s=Math.pointAngle(q,n);r=(r+s)/2}var t=r*Math.RADTODEG;if("SwimLoopR"===n.currentAnimation?n.rotation+=(t-n.rotation)*b/2*p:"SwimLoopL"===n.currentAnimation&&(n.rotation-=(t-n.rotation)*b/2*p),n.rotation=Math.limit(n.rotation,-35,35),c.x<n.x-n.mod&&"SwimLoopR"===n.currentAnimation?n.gotoAndPlay("TurnL"):c.x>n.x+n.mod&&"SwimLoopL"===n.currentAnimation&&n.gotoAndPlay("TurnR"),o*=p){var u=n.rotation*Math.DEGTORAD;n.x+=o*Math.cos(u)*b,n.y+=o*Math.sin(u)*b}}}},b.getClosetNeighbor=function(a,b){for(var c=70,d=!1,e=0,f=b.length;f>e;e++){var g=b[e],h=Math.pointDistance(a,g);a!==g&&c>h&&(c=h,d=g)}return d},cm.GameObject.FishSchool=cjs.promote(a,"GameObject")}(),function(){"use strict";function a(a){this.FishSchool_constructor(a),this.buildSchool(cm.Assets.lib.SchoolBlueTangSS,{regX:40,regY:20,framerate:24})}createjs.extend(a,cm.GameObject.FishSchool);cm.GameObject.FishSchoolBlueTang=cjs.promote(a,"FishSchool")}(),function(){"use strict";function a(a){this.FishSchool_constructor(a),this.buildSchool(cm.Assets.lib.SchoolPinkFishSS,{regX:38,regY:21,framerate:24})}createjs.extend(a,cm.GameObject.FishSchool);cm.GameObject.FishSchoolPinkFish=cjs.promote(a,"FishSchool")}(),function(){"use strict";function a(a){this.FishSchool_constructor(a),this.buildSchool(cm.Assets.lib.SchoolYellowFishSS,{regX:38,regY:21,framerate:24})}createjs.extend(a,cm.GameObject.FishSchool);cm.GameObject.FishSchoolYellowFish=cjs.promote(a,"FishSchool")}(),function(){"use strict";function a(a){this.CollectibleAnimation_constructor(a),a&&this.addSensorCircle(a,380),this.isWithinZone=!1}var b=a;b.allowFall=!0;var c=createjs.extend(a,cm.CollectibleAnimation);c.loadSelf=function(a){this.CollectibleAnimation_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsDeep","GOAnimGiantTubeWorms"))},c.buildMovieClip=function(){this.CollectibleAnimation_buildMovieClip(cm.Assets.lib.GOAnimGiantTubeWorms.TubeWorms)},c.switchSpots=function(a){this.CollectibleAnimation_switchSpots(a),this.getPhysicsTransform()},c.beginContact=function(a,b,c,d,e,f){c.isHero&&(this.isWithinZone=!0)},c.endContact=function(a,b,c,d,e,f){c.isHero&&(this.isWithinZone=!1)},c._tick=function(a){this.isLoaded&&(this.anim.paused&&(this.isWithinZone&&"Hide"===this.anim.currentLabel?this.anim.play():this.isWithinZone||"Show"!==this.anim.currentLabel||this.anim.play()),this.CollectibleAnimation__tick(a))},cm.GameObject.GiantTubeWorms=cjs.promote(a,"CollectibleAnimation")}(),function(){"use strict";function a(){this.CollectibleAnimation_constructor(),this.thrustPercent=0,this.rotation=Math.range(-45,45)}var b=createjs.extend(a,cm.CollectibleAnimation);b.loadSelf=function(a){this.CollectibleAnimation_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsSunkenShip","GOAnimJellyfish"))},b.buildMovieClip=function(){this.CollectibleAnimation_buildMovieClip(cm.Assets.lib.GOAnimJellyfish.Jellyfish_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){this.anim.thrust&&(this.anim.thrust=!1,this.thrustPercent=1);var b=this.thrustPercent;if(b>1e-6){var c=cm.tick,d=(this.rotation-90)*Math.DEGTORAD;this.x+=Math.cos(d)*b*600*c,this.y+=Math.sin(d)*b*600*c,this.rotation+=100*b*cm.tick,this.thrustPercent*=.95}this.CollectibleAnimation__tick(a)}},cm.GameObject.Jellyfish=cjs.promote(a,"CollectibleAnimation")}(),function(){"use strict";function a(){this.CollectibleAnimation_constructor(),this.time=0}var b=createjs.extend(a,cm.CollectibleAnimation);b.loadSelf=function(a){this.CollectibleAnimation_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsAntarctic","GOAnimKrill"))},b.buildMovieClip=function(){this.CollectibleAnimation_buildMovieClip(cm.Assets.lib.GOAnimKrill.Krill_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.time+=b,this.anim.y=30*Math.sin(this.time),this.CollectibleAnimation__tick(a)}},cm.GameObject.Krill=cjs.promote(a,"CollectibleAnimation")}(),function(){"use strict";function a(){this.CollectibleAnimation_constructor(),this.time=0}var b=createjs.extend(a,cm.CollectibleAnimation);b.loadSelf=function(a){this.CollectibleAnimation_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsAntarctic","GOAnimPenguin"))},b.buildMovieClip=function(){this.CollectibleAnimation_buildMovieClip(cm.Assets.lib.GOAnimPenguin.Penguin_1)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;this.time+=b,this.anim.y=30*Math.sin(this.time),this.CollectibleAnimation__tick(a)}},cm.GameObject.Penguin=cjs.promote(a,"CollectibleAnimation")}(),function(){"use strict";function a(){this.CollectibleAnimation_constructor(),this.turnCountdown=1}var b=createjs.extend(a,cm.CollectibleAnimation);b.loadSelf=function(a){this.CollectibleAnimation_loadSelf(cm.GameObjectHelper.getLoaderData("GameObjectsReeftown","GOAnimPinkAnthias"))},b.buildMovieClip=function(){this.CollectibleAnimation_buildMovieClip(cm.Assets.lib.GOAnimPinkAnthias.PinkFish)},b._tick=function(a){if(this.isLoaded&&!this.anim.paused){var b=cm.tick;switch(this.turnCountdown-=b,this.turnCountdown<=0&&(this.anim.shouldTurn=!0,this.turnCountdown=4),this.anim.currentLabel){case"SwimLoopR":this.x+=200*b;break;case"SwimLoopL":this.x-=200*b}this.CollectibleAnimation__tick(a)}},cm.GameObject.PinkAnthias=cjs.promote(a,"CollectibleAnimation")}(),function(){"use strict";function a(a){this.GameObject_constructor(a),this.hacked=!0,this.anim=null}var b=createjs.extend(a,cm.GameObject);b.update=function(){this.GameObject_update(),!this.anim.visible&&this.anim.needsReset&&(this.anim.gotoAndStop(0),this.anim.needsReset=!1)},b.switchSpots=function(a){this.anim=a,this.anim.framerate=24,this.x=this.anim.x,this.y=this.anim.y;var b=100;switch(a.symbolName){case"TreasureChest":b=380;break;case"ScallopShellSandBurst":b=150;break;case"BarrelBubbles":case"Maury":case"PowderedBlueTang":case"SilverFishPeak":case"Flounder":case"Tidy":b=250}this.physicsWorld&&this.addSensorCircle(this.physicsWorld,b),this.getPhysicsTransform(),this.isLoaded=!0},b.beginContact=function(a,b,c,d,e,f){c.isHero&&("Idle"===this.anim.currentLabel?(cm.CharacterVO.playEasterEgg(c.character),this.anim.gotoAndPlay("Knockover")):this.anim.paused&&!this.anim.needsReset&&(cm.CharacterVO.playEasterEgg(c.character),this.anim.play()))},cm.GameObject.ProximityEasterEgg=cjs.promote(a,"GameObject")}(),function(){"use strict";function a(a){this.GameObject_constructor(a)}var b=createjs.extend(a,cm.GameObject);b.switchSpots=function(a){this.GameObject_switchSpots(a),a.setTransform(),this.addChild(a);
var b=cm.Assets.lib.LevelPhysics.sunkenbarrel;this.addPhysicsBody(b,this.physicsWorld,b2.b2Body.b2_staticBody),this.getPhysicsTransform()},b.beginContact=function(a,b,c,d,e,f){c.isHero&&e.IsSensor()&&cjs.Tween.get(this,{override:!0}).to({alpha:0},250,cjs.Ease.quadInOut)},b.endContact=function(a,b,c,d,e,f){c.isHero&&e.IsSensor()&&cjs.Tween.get(this,{override:!0}).to({alpha:1},250,cjs.Ease.quadInOut)},cm.GameObject.SunkenBarrel=cjs.promote(a,"GameObject")}(),function(){var a=include("springroll.Application");Display=include("springroll.easeljs.EaselJSDisplay");var b=include("cm"),c=new a({name:"catchaprizesurprise",canvasId:"stage",display:Display,displayOptions:{clearView:!0},maxWidth:1426,maxHeight:768});c.on("init",function(){this.game=new b.Main,this.triggerResize()}),c.on("resize",function(a,b){this.game&&this.game.resize(a,b)}),c.on("update",function(a){this.game&&(b.tick=a/1e3,this.game.update(a))}),b.app=c}();