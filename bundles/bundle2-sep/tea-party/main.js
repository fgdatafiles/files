!function(e){function t(t){for(var i,h,o=t[0],r=t[1],l=t[2],_=0,d=[];_<o.length;_++)h=o[_],Object.prototype.hasOwnProperty.call(a,h)&&a[h]&&d.push(a[h][0]),a[h]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);for(c&&c(t);d.length;)d.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],i=!0,o=1;o<s.length;o++){var r=s[o];0!==a[r]&&(i=!1)}i&&(n.splice(t--,1),e=h(h.s=s[0]))}return e}var i={},a={0:0},n=[];function h(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,h),s.l=!0,s.exports}h.m=e,h.c=i,h.d=function(e,t,s){h.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},h.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.t=function(e,t){if(1&t&&(e=h(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(h.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)h.d(s,i,function(t){return e[t]}.bind(null,i));return s},h.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return h.d(t,"a",t),t},h.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},h.p="";var o=window.webpackJsonp=window.webpackJsonp||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=r;n.push([138,1]),s()}({130:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragonBonesEvent=t.DragonBonesCharacter=t.DBTools=t.DBGenerator=void 0;const i=s(23),a=s(329),n=s(63);class h{constructor(){this.factory=new dragonBones.factorys.CreateJSFactory}get Factory(){return this.factory}static getInstance(){return h.instance||(h.instance=new h),h.instance}static createCharacter(e,t,s){this.characters.set(e,new r(e,t,s))}}t.DBGenerator=h;class o{constructor(){}static compressSkeleton(e,t){if(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/"displayIndex":/g,"~di")).replace(/"skX":/g,"~kX")).replace(/"skY":/g,"~kY")).replace(/"scX":/g,"~cX")).replace(/"scY":/g,"~cY")).replace(/"transform":/g,"~t")).replace(/"duration":/g,"~u")).replace(/"scale":/g,"~s")).replace(/"frame":/g,"~f")).replace(/"tweenEasing":/g,"~w")).replace(/"parent":/g,"~p")).replace(/"animation":/g,"~a")).replace(/"timeline":/g,"~i")).replace(/"name":/g,"~n")).replace(/"display":/g,"~d")).replace(/"offset":/g,"~o")).replace(/"type":/g,"~e")).replace(/"x":/g,"~x")).replace(/"y":/g,"~y")).replace(/"z":/g,"~z")).replace(/"pX":/g,"~j")).replace(/"pY":/g,"~k")).replace(/},{/g,"#")).concat(o.COMPRESSED),t){let t=new Blob([e],{type:"text/plain;charset=utf-8"});a.saveAs(t,"skeleton.txt")}return e}static uncompressSkeleton(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/~di/g,'"displayIndex":')).replace(/~kX/g,'"skX":')).replace(/~kY/g,'"skY":')).replace(/~cX/g,'"scX":')).replace(/~cY/g,'"scY":')).replace(/~t/g,'"transform":')).replace(/~u/g,'"duration":')).replace(/~s/g,'"scale":')).replace(/~f/g,'"frame":')).replace(/~w/g,'"tweenEasing":')).replace(/~p/g,'"parent":')).replace(/~a/g,'"animation":')).replace(/~i/g,'"timeline":')).replace(/~n/g,'"name":')).replace(/~d/g,'"display":')).replace(/~o/g,'"offset":')).replace(/~e/g,'"type":')).replace(/~x/g,'"x":')).replace(/~y/g,'"y":')).replace(/~z/g,'"z":')).replace(/~j/g,'"pX":')).replace(/~k/g,'"pY":')).replace(/#/g,"},{"),JSON.parse(e)}}t.DBTools=o,o.COMPRESSED="COMPRESSEDSKELETON",o.VERSION="0.1.1";class r extends createjs.EventDispatcher{constructor(e,t,s,a=!0,h=!0){super(),this.ready=!1,this.defaultIdle="",this.onAnimationAudioLoaded=e=>{this.loadTexture()},this.onTextureLoaded=e=>{this.loadQueue.removeEventListener("fileload",this.onTextureLoaded),this.texture=e.result,this.loadTextureDef()},this.onTextureDefLoaded=e=>{this.loadQueue.removeEventListener("fileload",this.onTextureDefLoaded),this._factory.addTextureAtlas(new dragonBones.textures.CreateJSTextureAtlas(this.texture,e.result)),this.armature=this._factory.buildArmature(this.data.armatureName),this.armature.addEventListener("boneFrameEvent",this.onBoneFrameEvent),this.display=this.armature.getDisplay(),dragonBones.animation.WorldClock.clock.add(this.armature),null!=this.readyCallback&&this.readyCallback(this)},this.onAnimationComplete=e=>{this.armature.removeEventListener("complete",this.onAnimationComplete),null!=this.animationCompleteCallback&&this.animationCompleteCallback()},this.onQueueComplete=e=>{let t,s=this.loadQueue.getResult(this.data.skeleton.id,!0);-1!=s.indexOf(o.COMPRESSED)?(s=s.slice(0,s.indexOf(o.COMPRESSED)),t=o.uncompressSkeleton(s)):t=JSON.parse(s);let i=t,a=JSON.parse(this.loadQueue.getResult(this.data.textureJSON.id,!0));this._factory.addSkeletonData(dragonBones.objects.DataParser.parseSkeletonData(i)),this._atlas=new dragonBones.textures.CreateJSTextureAtlas(this.loadQueue.getResult(this.data.texture.id),a),this._factory.addTextureAtlas(this._atlas),this.autoBuildArmature&&(this.armature=this._factory.buildArmature(this.data.armatureName),this.armature.addEventListener("boneFrameEvent",this.onBoneFrameEvent),this.display=this.armature.getDisplay(),dragonBones.animation.WorldClock.clock.add(this.armature)),this._skeletonData=i,this.autoLoadAudio?this.preloadAudio(i):(this.audioLoaded=!1,this.postBuild())},this.onBoneFrameEvent=e=>{-1!=e.frameLabel.indexOf("event_")?this.handleAnimationEvent(e.frameLabel):-1!=e.frameLabel.indexOf("vo_")?this.handleVOEvent(e.frameLabel):-1!=e.frameLabel.indexOf("sfx_")&&this.handleSFXEvent(e.frameLabel)},this.playVO=e=>{let t=null;return null!=this.VOQueue&&null!=this.VOQueue.getItem(e)&&(i.AudioManager.getInstance().triggerCaptions(i.AudioManager.GetFileNameFromPath(this.VOQueue.getItem(e).src)),t=createjs.Sound.play(e),null!=t&&(this._currentVOID=t,null!=n.SpringrollGame.getInstance().CaptionPlayer&&n.SpringrollGame.getInstance().CaptionPlayer.start(e))),t},this.VOLoaded=e=>{this.audioLoaded=!0,this.VOQueue.removeAllEventListeners(),this.postBuild()},this.name=e,this.data=t,this.autoLoadAudio=a,this.autoBuildArmature=h,this._factory=new dragonBones.factorys.CreateJSFactory,this.loadQueue=new createjs.LoadQueue,this.loadQueue.setPreferXHR(!0),this.loadQueue.setMaxConnections(1),this.loadQueue.addEventListener("complete",this.onQueueComplete),this.loadQueue.loadManifest([t.skeleton,t.texture,t.textureJSON]),this.readyCallback=s}destroy(){if(dragonBones.animation.WorldClock.clock.remove(this.armature),null!=this.audioManifest){let e=createjs.Sound.removeSounds(this.audioManifest,null);console.info(e)}null!=this.VOQueue&&(this.VOQueue.close(),this.VOQueue.destroy(),this.VOQueue=null),this.loadQueue.close(),this.loadQueue.destroy(),this.loadQueue=null,this.animationCompleteCallback=null,this.data=null,this.armature=null,this.texture=null}loadTexture(){this.loadQueue.addEventListener("fileload",this.onTextureLoaded),this.loadQueue.loadFile(this.data.texture)}loadTextureDef(){this.loadQueue.addEventListener("fileload",this.onTextureDefLoaded),this.loadQueue.loadFile(this.data.textureJSON)}playAnimation(e,t){if(this.armature.animation.getLastAnimationName()==e)return console.warn("Animation is already playing"),this.armature.animation.getLastAnimationState();if(this.armature.animation.hasAnimation(e)){this.animationCompleteCallback=null!=t?t:void 0;let s=this.armature.animation.gotoAndPlay(e);return this.armature.addEventListener("complete",this.onAnimationComplete),s}return console.warn("Animation does not contain label ["+e+"]"),null}loopAnimation(e,t){if(this.armature.animation.hasAnimation(e)){return this.animationCompleteCallback=null!=t?t:void 0,this.armature.animation.gotoAndPlay(e,-1,-1,1e3)}console.warn("Animation does not contain label ["+e+"]")}stopAnimation(e=!1){e&&(this.animationCompleteCallback=null,this.armature.removeEventListener("complete",this.onAnimationComplete)),this.armature.animation.stop(),null!=this._currentVOID&&(this._currentVOID.stop(),null!=n.SpringrollGame.getInstance().CaptionPlayer&&n.SpringrollGame.getInstance().CaptionPlayer.stop(),this._currentVOID.destroy(),this._currentVOID=null)}setDefaultIdle(e){this.defaultIdle=e}postBuild(){null!=this.readyCallback&&this.readyCallback(this)}allowForStage(){this.armature.addEventListener("boneFrameEvent",this.onBoneFrameEvent),this.display=this.armature.getDisplay(),dragonBones.animation.WorldClock.clock.add(this.armature)}handleAnimationEvent(e){this.dispatchEvent(new l(l.TIMELINE_EVENT,e.split("event_")[1]))}handleVOEvent(e){null!=this._currentVOID&&(this._currentVOID.stop(),null!=n.SpringrollGame.getInstance().CaptionPlayer&&n.SpringrollGame.getInstance().CaptionPlayer.stop(),this._currentVOID.destroy(),this._currentVOID=null);let t=e.split("vo_")[1];if(null!=this.VOQueue&&null!=this.VOQueue.getItem(t)){i.AudioManager.getInstance().triggerCaptions(i.AudioManager.GetFileNameFromPath(this.VOQueue.getItem(t).src));let e=createjs.Sound.play(t);null!=e&&(this._currentVOID=e,null!=n.SpringrollGame.getInstance().CaptionPlayer&&n.SpringrollGame.getInstance().CaptionPlayer.start(t))}}handleSFXEvent(e){i.AudioManager.getInstance().playSFX(e.split("sfx_")[1])}preloadAudio(e){let t=[];this.audioLoaded=!1;for(let s of e.armature)for(let e of s.animation)for(let s of e.timeline)for(let e of s.frame)if(null!=e.event){let s="";e.event.indexOf("vo_")>-1?s=e.event.substr(3):e.event.indexOf("sfx_")>-1&&(s=e.event.substr(4)),t.push({id:s,src:this.data.audioPath.concat(s)+".mp3"})}this.audioManifest=t,this.audioManifest.length>0?(this.VOQueue=new createjs.LoadQueue,this.VOQueue.installPlugin(createjs.Sound),this.VOQueue.addEventListener("complete",this.VOLoaded),this.VOQueue.loadManifest(this.audioManifest)):(this.audioLoaded=!0,this.postBuild())}}t.DragonBonesCharacter=r;class l extends createjs.Event{constructor(e,t){super(e,!1,!1),this._data=t}get Data(){return this._data}}t.DragonBonesEvent=l,l.TIMELINE_EVENT="timelineEvent"},131:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnackPlate=void 0;class i extends createjs.Container{constructor(e,t,s){super(),this._assets=s,this._config=e,this.setToStyle(t)}setToStyle(e){null!=this._plate&&this.removeChild(this._plate),this._plate=this._assets.getSpriteFromSheet(this._config.styles[e]),this._plate.name=i.NAME_PLATE,this.addChildAt(this._plate,0)}performHitTest(e,t){let s=this._plate.globalToLocal(e,t);return this._plate.hitTest(s.x,s.y)}}t.SnackPlate=i,i.NAME_PLATE="plate"},132:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TeaCup=void 0;const i=s(39);class a extends createjs.Container{constructor(e,t,s,i=-1){super(),this._teaLevel=.75,this._assets=s,this._seatTag=i,this._config=e,this._state=a.CUP_STRAIGHT,this.setToStyle(t)}get teaLevel(){return this._teaLevel}get canAcceptTea(){return this._teaLevel<1}adjustArt(){this._state==a.CUP_STRAIGHT?(this.addChild(this._cup),this.addChild(this._tea),this._teaLevel>1&&(this._teaLevel=1),this._tea.gotoAndStop(this._teaAnimation.frames[Math.floor(.999*this._numberofTeaFrames*this._teaLevel)]),this._tea.paused=!0):this._state==a.CUP_TIPPED?this.addChild(this._tippedCup):this._state==a.CUP_FORWARD&&this.addChild(this._forwardCup)}setState(e){this.removeAllChildren(),this._state=e,this.adjustArt()}fillOverTime(e){this._teaLevel<1&&(this._teaLevel+=e/1e3/(this._teaAnimation.frames.length/this._tea.spriteSheet.framerate),this._teaLevel>1&&(this._teaLevel=1),this.adjustArt())}changeTeaLevelBy(e){this._teaLevel+=e,this._teaLevel>1&&(this._teaLevel=1),this._teaLevel<.15&&(this._teaLevel=0),null!=this._tea&&(this._tea.gotoAndStop(this._teaAnimation.frames[Math.floor(this._numberofTeaFrames*this._teaLevel)]),this._tea.paused=!0)}setToStyle(e){if(this._style=e,this.removeAllChildren(),console.log(e,i.TeaPartyConstants.TEASET_ELAINA),this._style==i.TeaPartyConstants.TEASET_ELAINA){let t=this._config.styles[e][a.CUP_STRAIGHT].replace("_character",this._seatTag+"_character"),s=this._config.styles[e][a.CUP_TIPPED].replace("_TippedAway",this._seatTag+"_TippedAway");this._cup=this._assets.getSpriteFromSheet(t),this._tippedCup=this._assets.getSpriteFromSheet(s),this._forwardCup=this._assets.getSpriteFromSheet(this._config.styles[e][a.CUP_FORWARD])}else this._cup=this._assets.getSpriteFromSheet(this._config.styles[e][a.CUP_STRAIGHT]),this._tippedCup=this._assets.getSpriteFromSheet(this._config.styles[e][a.CUP_TIPPED]),this._forwardCup=this._assets.getSpriteFromSheet(this._config.styles[e][a.CUP_FORWARD]);this._tea=this._assets.getSpriteFromSheet(this._config.fills[e]),this._teaAnimation=this._tea.spriteSheet.getAnimation(this._config.fills[e]),this._numberofTeaFrames=this._tea.spriteSheet.getNumFrames(this._config.fills[e]),this._cup.name=a.NAME_CUP,this._tippedCup.name=a.NAME_CUP,this._tea.name=a.NAME_TEA,console.log("Changing style to:  "+this._style+".  Tea Level at:  "+this._teaLevel+", "+this._state),this.adjustArt()}}t.TeaCup=a,a.CUP_STRAIGHT=0,a.CUP_TIPPED=1,a.CUP_FORWARD=2,a.NAME_CUP="cup",a.NAME_TEA="tea"},133:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TeaSnack=void 0;class i extends createjs.Container{constructor(e,t,s,i=!1){super(),this._snackLevel=2,this._isPlayer=!1,this._assets=s,this._config=e,this._isPlayer=i,this.changeToType(t)}get type(){return this._type}get snackLevel(){return this._snackLevel}get empty(){return 0==this._snackLevel}changeToType(e){this._type=e,this.updateDisplay()}eat(){this._snackLevel>0&&(this._snackLevel--,this.updateDisplay())}refill(){this._snackLevel=2,this.updateDisplay()}updateDisplay(){this.removeAllChildren();let e=this._config.types[this._type][this._snackLevel];null!=e&&1==this._isPlayer&&(e=e.replace("2","")),this._snackDisplay=this._assets.getSpriteFromSheet(e),null!=this._snackDisplay&&(this._snackDisplay.name=i.NAME_SNACK,this.addChild(this._snackDisplay))}}t.TeaSnack=i,i.SNACK_COOKIE=0,i.SNACK_PRETZEL=1,i.SNACK_STRAWBERRY=2,i.SNACK_APPLE=3,i.NAME_SNACK="snack"},134:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tablecloth=void 0;class i extends createjs.Container{constructor(e,t,s,i){super(),null!=i&&(this._emptyRef=i),this._assets=s,this._ids=e,this.setToStyle(t)}setToStyle(e){null!=this._tablecloth&&(this.removeChild(this._tablecloth),this._tablecloth=null),e!=i.NO_TABLECLOTH?(this._tablecloth=this._assets.getSpriteFromSheet(this._ids[e]),this.addChild(this._tablecloth)):null!=this._emptyRef&&(this._tablecloth=this._assets.getSpriteFromSheet(this._emptyRef),this.addChild(this._tablecloth))}}t.Tablecloth=i,i.NO_TABLECLOTH=-1},135:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shelf=void 0;class i extends createjs.Container{constructor(e,t,s,a){super(),this.cycleShelf=()=>{this._style!=i.EMPTY_SHELF&&this._changeCallback(this._style),this._style++,this._style>=this._config.styles.length&&(this._style=0),this.changeStyleTo(this._style)},this._config=e,this._assets=s,this._style=t,this._changeCallback=a,this.changeStyleTo(this._style,!0)}destroy(){this._shelfSprite.removeAllEventListeners(),this._assets=null,this._changeCallback=null,this.removeAllChildren()}changeStyleTo(e,t=!1){null!=this._shelfSprite&&(this._shelfSprite.removeAllEventListeners(),this.removeChild(this._shelfSprite)),e<0?t||(e=this._config.styles.length-1):e>=this._config.styles.length&&(e=0),e!=i.EMPTY_SHELF?(this._style=e,this._shelfSprite=this._assets.getSpriteFromSheet(this._config.styles[e]),this._shelfSprite.addEventListener("mousedown",this.cycleShelf),this.addChild(this._shelfSprite)):(this._style=i.EMPTY_SHELF,this._shelfSprite=this._assets.getSpriteFromSheet(this._config.empty),this.addChild(this._shelfSprite))}getActiveStyle(){let e=this._style-1;return e<0&&(e=this._config.styles.length-1),e}}t.Shelf=i,i.EMPTY_SHELF=-1},136:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetupEvent=t.SetupScene=void 0;const i=s(92),a=s(40),n=s(94),h=s(39),o=s(135),r=s(134),l=s(334),c=s(335),_=s(93),d=s(137),u=s(23);class p extends i.GameScreen{constructor(e,t){super(),this.addTablecloths=e=>{if(this._dan.removeEventListener(g.ANIMATION_EVENT,this.addTablecloths),"event_showTablecloths"==e.event){console.log("add tablecloth buttons");for(let e=0;e<this._sceneConfig.tableclothButtons.length;e++){let t=new c.SetupButton(this._assets.getSpriteFromSheet(this._sceneConfig.tableclothButtons[e].spriteId),e,this.tableclothPicked);null!=this._sceneConfig.tableclothButtons[e].scale?t.setTransform(this._sceneConfig.tableclothButtons[e].position.x,this._sceneConfig.tableclothButtons[e].position.y,this._sceneConfig.tableclothButtons[e].scale,this._sceneConfig.tableclothButtons[e].scale):t.setTransform(this._sceneConfig.tableclothButtons[e].position.x,this._sceneConfig.tableclothButtons[e].position.y),t.turnOn(),this._buttonHolder.addChild(t)}}},this.tableclothPicked=e=>{this._dan.forceVOStop(),console.log("picked tablecloth "+e),this._chosenTableclothIndex=e;let t=this._chosenTableclothIndex+1;for(t>=this._sceneConfig.clothShelf.styles.length&&(t=0),this._clothShelf.changeStyleTo(t);this._buttonHolder.children.length>0;){let e=this._buttonHolder.getChildAt(0);this._buttonHolder.removeChild(e),e.destroy(),e=null}this.changeTableCothTo(e),this._dan.addEventListener(g.ANIMATION_EVENT,this.addTeasets),this._dan.playAnimation("intro2",this.gotoIdle)},this.addTeasets=e=>{if(this._dan.removeEventListener(g.ANIMATION_EVENT,this.addTeasets),"event_showTeasets"==e.event){console.log("add teaset buttons");for(let e=0;e<this._sceneConfig.teasetButtons.length;e++){let t=new c.SetupButton(this._assets.getSpriteFromSheet(this._sceneConfig.teasetButtons[e].spriteId),e,this.teasetPicked);t.align(d.AlignmentOption.BOTTOM),null!=this._sceneConfig.teasetButtons[e].scale?t.setTransform(this._sceneConfig.teasetButtons[e].position.x,this._sceneConfig.teasetButtons[e].position.y,this._sceneConfig.teasetButtons[e].scale,this._sceneConfig.teasetButtons[e].scale):t.setTransform(this._sceneConfig.teasetButtons[e].position.x,this._sceneConfig.teasetButtons[e].position.y),t.turnOn(),this._buttonHolder.addChild(t)}}},this.teasetPicked=e=>{console.log("picked teaset "+e),this._chosenTeasetIndex=e;let t=this._chosenTeasetIndex+1;for(t>=this._sceneConfig.teasetShelf.styles.length&&(t=0),this._teasetShelf.changeStyleTo(t);this._buttonHolder.children.length>0;){let e=this._buttonHolder.getChildAt(0);this._buttonHolder.removeChild(e),e.destroy(),e=null}this.changeTeasetTo(e),this._dan.forceVOStop(),this._dan.playAnimation("approve_teaset",this.gotoIdle),this._dan.addEventListener(n.TeaPartyCharacter.FINISH_TALKING,this.askAboutSnacks),this._dan.sayLine(this._sceneConfig.teapots[this._chosenTeasetIndex].voResponse)},this.askAboutSnacks=()=>{this._dan.removeEventListener(n.TeaPartyCharacter.FINISH_TALKING,this.askAboutSnacks),this._dan.addEventListener(g.ANIMATION_EVENT,this.addSnacks),this._dan.playAnimation("choose_snack",this.gotoIdle)},this.addSnacks=e=>{if(this._dan.removeEventListener(g.ANIMATION_EVENT,this.addSnacks),"event_showSnacks"==e.event){console.log("add snack buttons");for(let e=0;e<this._sceneConfig.snackButtons.length;e++){let t=new c.SetupButton(this._assets.getSpriteFromSheet(this._sceneConfig.snackButtons[e].spriteId),e,this.snackPicked);null!=this._sceneConfig.snackButtons[e].scale?t.setTransform(this._sceneConfig.snackButtons[e].position.x,this._sceneConfig.snackButtons[e].position.y,this._sceneConfig.snackButtons[e].scale,this._sceneConfig.snackButtons[e].scale):t.setTransform(this._sceneConfig.snackButtons[e].position.x,this._sceneConfig.snackButtons[e].position.y),t.turnOn(),this._buttonHolder.addChild(t)}}},this.snackPicked=e=>{console.log("picked snack "+e),this._chosenSnackIndex=e;let t=this._chosenSnackIndex+1;for(t>=this._sceneConfig.snackShelf.styles.length&&(t=0),this._snackShelf.changeStyleTo(t);this._buttonHolder.children.length>0;){let e=this._buttonHolder.getChildAt(0);this._buttonHolder.removeChild(e),e.destroy(),e=null}this.changeSnackTo(e),this._dan.forceVOStop(),this._dan.playAnimation("approve_snacktable",this.gotoIdle),this._dan.addEventListener(n.TeaPartyCharacter.FINISH_TALKING,this.inviteFriends),this._dan.sayLine(this._sceneConfig.snacks[this._chosenSnackIndex].voResponse)},this.inviteFriends=()=>{this._dan.removeEventListener(n.TeaPartyCharacter.FINISH_TALKING,this.inviteFriends),this._dan.playAnimation("invite_friends",this.leaveScene)},this.leaveScene=()=>{h.TeaParty.getInstance().setIntialChoices(this._clothShelf.getActiveStyle(),this._teasetShelf.getActiveStyle(),this._snackShelf.getActiveStyle()),this.dispatchEvent(this.dispatchEvent(new _.SceneLoadEvent(_.SceneLoadEvent.SCENE_REQUEST,h.TeaPartyConstants.PARTY_SCENE)))},this.gotoIdle=()=>{this._dan.playAnimation("idle")},this.configLoaded=()=>{this._sceneConfig=this._assets.getResult("scene_config"),console.log(this._sceneConfig),this._assets.loadManifest(this._sceneConfig.manifest,this.buildDaniel)},this.buildDaniel=()=>{console.log("build daniel"),this._dan=new l.SetupDaniel(this._sceneConfig.character.name,this._sceneConfig.character,this.setupScene)},this.setupScene=()=>{console.log("setup scene"),this._zoomContainer=new createjs.Container,this.addChild(this._zoomContainer),this._sceneContainer=new createjs.Container,this._zoomContainer.addChild(this._sceneContainer);let e=this._assets.getBitmap("bg");e.mouseEnabled=!1,this._sceneContainer.addChild(e),this._teasetShelf=new o.Shelf(this._sceneConfig.teasetShelf,o.Shelf.EMPTY_SHELF,this._assets,this.changeTeasetTo),this._teasetShelf.setTransform(this._sceneConfig.teasetShelf.position.x,this._sceneConfig.teasetShelf.position.y),this._sceneContainer.addChild(this._teasetShelf),this._clothShelf=new o.Shelf(this._sceneConfig.clothShelf,o.Shelf.EMPTY_SHELF,this._assets,this.changeTableCothTo),this._clothShelf.setTransform(this._sceneConfig.clothShelf.position.x,this._sceneConfig.clothShelf.position.y),this._sceneContainer.addChild(this._clothShelf),this._snackShelf=new o.Shelf(this._sceneConfig.snackShelf,o.Shelf.EMPTY_SHELF,this._assets,this.changeSnackTo),this._snackShelf.setTransform(this._sceneConfig.snackShelf.position.x,this._sceneConfig.snackShelf.position.y),this._sceneContainer.addChild(this._snackShelf),this._table=this._assets.getSpriteFromSheet(this._sceneConfig.table.spriteId),this._table.setTransform(this._sceneConfig.table.position.x,this._sceneConfig.table.position.y),this._table.mouseEnabled=!1,this._sceneContainer.addChild(this._table),this._sceneContainer.addChild(this._dan.display),this._dan.addTablecloth(new r.Tablecloth(this._sceneConfig.character.cloths,r.Tablecloth.NO_TABLECLOTH,this._assets,this._sceneConfig.character.emptyCloth)),this._dan.playAnimation("idle"),this._buttonHolder=new createjs.Container,this._buttonHolder.setTransform(this._sceneConfig.table.position.x,this._sceneConfig.table.position.y),this._sceneContainer.addChild(this._buttonHolder),this._sceneContainer.scaleX=this._sceneContainer.scaleY=2,this._sceneContainer.x=-.5*(2*h.TeaPartyConstants.GAME_WIDTH-h.TeaPartyConstants.GAME_WIDTH),this._sceneContainer.y=-.15*(2*h.TeaPartyConstants.GAME_HEIGHT-h.TeaPartyConstants.GAME_HEIGHT),this._ready=!0,this.resize({width:h.TeaParty.getInstance().width,height:h.TeaParty.getInstance().height}),this._readyCallback()},this.changeTeasetTo=e=>{this._chosenTeasetIndex=e,null!=this._teapot&&this._sceneContainer.removeChild(this._teapot),this._teapot=this._assets.getSpriteFromSheet(this._sceneConfig.teapots[e].spriteId),null!=this._sceneConfig.teapots[e].scale?this._teapot.setTransform(this._sceneConfig.teapots[e].position.x,this._sceneConfig.teapots[e].position.y,this._sceneConfig.teapots[e].scale,this._sceneConfig.teapots[e].scale):this._teapot.setTransform(this._sceneConfig.teapots[e].position.x,this._sceneConfig.teapots[e].position.y),this._teapot.mouseEnabled=!1,this._sceneContainer.addChildAt(this._teapot,this._sceneContainer.getChildIndex(this._dan.display)+1),null!=this._servingDish&&this._sceneContainer.removeChild(this._servingDish),this._servingDish=this._assets.getSpriteFromSheet(this._sceneConfig.snackPlate[e].spriteId),null!=this._sceneConfig.snackPlate[e].scale?this._servingDish.setTransform(this._sceneConfig.snackPlate[e].position.x,this._sceneConfig.snackPlate[e].position.y,this._sceneConfig.snackPlate[e].scale,this._sceneConfig.snackPlate[e].scale):this._servingDish.setTransform(this._sceneConfig.snackPlate[e].position.x,this._sceneConfig.snackPlate[e].position.y),this._servingDish.mouseEnabled=!1,null!=this._snack&&this._sceneContainer.addChildAt(this._servingDish,this._sceneContainer.getChildIndex(this._dan.display)+1),u.AudioManager.getInstance().playExternalSFX("Teaset_Swap")},this.changeTableCothTo=e=>{this._chosenTeasetIndex=e,null!=this._tablecloth&&this._sceneContainer.removeChild(this._tablecloth),this._tablecloth=this._assets.getSpriteFromSheet(this._sceneConfig.table.cloths[e]),this._tablecloth.setTransform(this._sceneConfig.table.position.x,this._sceneConfig.table.position.y),this._tablecloth.mouseEnabled=!1,this._sceneContainer.addChildAt(this._tablecloth,this._sceneContainer.getChildIndex(this._table)+1),this._dan.setTableStyleTo(e),u.AudioManager.getInstance().playExternalSFX("tablecloth_setup")},this.changeSnackTo=e=>{this._chosenSnackIndex=e,null!=this._snack&&this._sceneContainer.removeChild(this._snack),this._snack=this._assets.getSpriteFromSheet(this._sceneConfig.snacks[e].spriteId),null!=this._sceneConfig.snacks[e].scale?this._snack.setTransform(this._sceneConfig.snacks[e].position.x,this._sceneConfig.snacks[e].position.y,this._sceneConfig.snacks[e].scale,this._sceneConfig.snacks[e].scale):this._snack.setTransform(this._sceneConfig.snacks[e].position.x,this._sceneConfig.snacks[e].position.y),this._snack.mouseEnabled=!1,this._sceneContainer.addChildAt(this._servingDish,this._sceneContainer.getChildIndex(this._dan.display)+1),this._sceneContainer.addChildAt(this._snack,this._sceneContainer.getChildIndex(this._servingDish)+1),u.AudioManager.getInstance().playExternalSFX("Snack_Swap")},this.resize=({width:e,height:t})=>{if(this._ready){let s=e/t;this._zooming||(s<h.TeaPartyConstants.ASPECT_RATIO_MIN?(this._zoomContainer.scaleX=this._zoomContainer.scaleY=e/h.TeaPartyConstants.GAME_WIDTH,this._zoomContainer.x=0,this._zoomContainer.y=(t-h.TeaPartyConstants.GAME_HEIGHT*this._zoomContainer.scaleY)/2):(this._zoomContainer.scaleX=this._zoomContainer.scaleY=t/h.TeaPartyConstants.GAME_HEIGHT,this._zoomContainer.x=(e-h.TeaPartyConstants.GAME_WIDTH*this._zoomContainer.scaleX)/2,this._zoomContainer.y=0))}},this._readyCallback=t,this._zooming=!1,this._assets=new a.AssetPackage,this._assets.loadManifest([a.AssetPackage.makeManifestItem("scene_config",e.config,"json")],this.configLoaded)}destroy(){this._sceneContainer.removeAllChildren(),this._dan.removeAllEventListeners(),this._teasetShelf.destroy(),this._teasetShelf=null,this._clothShelf.destroy(),this._clothShelf=null,this._snackShelf.destroy(),this._snackShelf=null,this._dan.destroy(),this._dan=null,this._assets.destroy(),this._assets=null}start(){this._dan.addEventListener(g.ANIMATION_EVENT,this.addTablecloths),this._dan.playAnimation("intro",this.gotoIdle),this._zoomTween=createjs.Tween.get(this._sceneContainer).wait(1500).to({scaleX:1,scaleY:1,x:0,y:0},4500)}}t.SetupScene=p;class g extends createjs.Event{constructor(e,t){super(e,!1,!1),this._event=t}get event(){return this._event}}t.SetupEvent=g,g.ANIMATION_EVENT="animation_event"},137:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlignmentOption=void 0;class i{}t.AlignmentOption=i,i.TOP="top",i.LEFT="left",i.RIGHT="right",i.CENTER="center",i.TOP_LEFT="top-left",i.TOP_RIGHT="top-right",i.BOTTOM_LEFT="bottom-left",i.BOTTOM_RIGHT="bottom-right",i.BOTTOM="bottom"},138:function(e,t,s){s(95),e.exports=s(324)},23:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioEvent=t.AudioConstants=t.AudioManager=void 0;class i extends createjs.EventDispatcher{constructor(e){super(),this.onQueueLoadComplete=e=>{if(this._activelyLoading=!1,null!=this.loadedCallback&&(this.loadedCallback(),this.loadedCallback=void 0),this.queue.removeEventListener("complete",this.onQueueLoadComplete),this.delayedManifests.length>0){this.queue.addEventListener("complete",this.onQueueLoadComplete),this._activelyLoading=!0;let e=this.delayedManifests.shift();this.loadedCallback=this._callbacks.get(e),this._callbacks.delete(e),this.queue.loadManifest(e)}},this.playSound=e=>{let t=createjs.Sound.play(this.idCheck(e));return t.setVolume(this.volumeMap.get(a.SOUND)),t.addEventListener("complete",this.audioComplete),this.activeSounds.set(t.uniqueId,t),t},this.playExternalSFX=e=>{let t=createjs.Sound.play(e);return null!=t?(t.addEventListener("complete",this.audioComplete),t.volume=this.volumeMap.get(a.SFX),this.activeSounds.set(t.uniqueId,t)):console.warn("Failed to play SFX ("+e+")"),t},this.playExternalVO=e=>{let t=createjs.Sound.play(e);return null!=t?(t.addEventListener("complete",this.audioComplete),t.volume=this.volumeMap.get(a.VO),this.activeSounds.set(t.uniqueId,t)):console.warn("Failed to play VO ("+e+")"),t},this.playVO=e=>{if(null!=this.queue.getItem(e)||null!=this.queue.getItem(this.idCheck(e))){this.dispatchEvent(new n(n.PLAY_VO,i.GetFileNameFromPath(this.queue.getItem(this.idCheck(e)).src)));let t=createjs.Sound.play(this.idCheck(e));return t.volume=this.volumeMap.get(a.VO),t.addEventListener("complete",this.audioComplete),this.activeSounds.set(t.uniqueId,t),t}return console.warn("VO with ID ("+e+") is not loaded and will not play."),null},this.playSFX=e=>{if(null!=this.queue.getItem(e)||null!=this.queue.getItem(this.idCheck(e))){let t=createjs.Sound.play(this.idCheck(e));return t.volume=this.volumeMap.get(a.SFX),t.addEventListener("complete",this.audioComplete),this.activeSounds.set(t.uniqueId,t),t}return console.warn("SFX with ID ("+e+") is not loaded and will not play."),null},this.playMusic=(e,t,s)=>{let i=new createjs.PlayPropsConfig;t&&(i.loop=-1),i.volume=s>0?0:this.volumeMap.get(a.MUSIC);let n=createjs.Sound.play(this.idCheck(e),i);return s>0&&createjs.Tween.get(n).to({volume:this.volumeMap.get(a.MUSIC)},s).call(this.fadeInComplete),n.addEventListener("complete",this.audioComplete),this.activeSounds.set(n.uniqueId,n),n},this.triggerCaptions=e=>{this.dispatchEvent(new n(n.PLAY_VO,e))},this.stopMusic=(e,t)=>{let s=this.activeSounds.get(e);t>0?createjs.Tween.get(s).to({volume:0},t).call(()=>{s.stop(),s.removeAllEventListeners(),this.activeSounds.delete(e),s.destroy(),s=null,this._dispatcher.dispatchEvent(new createjs.Event(i.FADE_OUT_COMPLETE,!1,!1))}):(s.stop(),s.removeAllEventListeners(),this.activeSounds.delete(e),s.destroy(),s=null)},this.fadeInComplete=()=>{this._dispatcher.dispatchEvent(new createjs.Event(i.FADE_IN_COMPLETE,!1,!1))},this.audioComplete=e=>{var t=e.currentTarget;t.removeAllEventListeners(),this.activeSounds.delete(t.uniqueId),t.destroy(),t=null},this.queue=new createjs.LoadQueue(!0),this.queue.setPreferXHR(!0),this.queue.installPlugin(createjs.Sound),this.volumeMap=new Map,this.volumeMap.set(a.SOUND,1),this.volumeMap.set(a.MUSIC,1),this.volumeMap.set(a.SFX,1),this.volumeMap.set(a.VO,1),this.activeSounds=new Map,this._dispatcher=new createjs.EventDispatcher,this._idMapper=new Map,this.delayedManifests=[],this._callbacks=new Map}static GetFileNameFromPath(e){return e.split(/.*[\/|\\]/)[1].split(".")[0]}get ActiveSounds(){return this.activeSounds}get Dispatcher(){return this._dispatcher}static getInstance(){return i.instance||(i.instance=new i),i.instance}loadAudioManifest(e,t){this.queue.close(),this.queue.destroy(),this.queue=new createjs.LoadQueue(!0),this.queue.setPreferXHR(!0),this.queue.installPlugin(createjs.Sound),e=this.cleanManifest(e),null!=t&&this._callbacks.set(e,t),0==e.length?(this.loadedCallback=t,this.onQueueLoadComplete()):this._activelyLoading?this.delayedManifests.push(e):(this.queue.addEventListener("complete",this.onQueueLoadComplete),this._activelyLoading=!0,this.loadedCallback=t,this._callbacks.delete(e),this.queue.loadManifest(e))}unloadManifest(e){e.forEach(e=>{this.queue.remove(e.id)})}cleanManifest(e){let t=new Array;t.push(e.pop());for(var s=e.length-1;s>=0;s--){for(var i=!0,a=0;a<t.length;a++)t[a].src==e[s].src&&(i=!1,console.warn("Duplicate file found within manifest. Ignoring."),t[a].id!=e[s].id&&console.warn("That ignored file had a different id ["+e[s].id+"] - Use other previous ID instead ("+t[a].id+")"));let n=e.pop();i&&t.push(n)}return t}checkForDupes(e){let t=new Array,s=!0;for(var i=0;i<e.length;i++){s=!0;for(var a=0;a<this.queue.getItems(!0).length;a++)this.queue.getItems(!0)[a].item.src==e[i].src&&(console.warn("Audio Manager already has item with src ("+e[i].src+") and will not attempt to load"),this._idMapper.set(e[i].id,this.queue.getItems(!0)[a].item.id),s=!1);s&&t.push(e[i])}return t}idCheck(e){return null!=this._idMapper.get(e)?this._idMapper.get(e):e}killSoundById(e){if(this.activeSounds.has(e)){let t=this.activeSounds.get(e);t.stop(),t.destroy(),this.activeSounds.delete(e)}}setPauseState(e){for(let t of this.activeSounds.keys())this.activeSounds.get(t).paused=e}pauseAll(){for(let e of this.activeSounds.keys())this.activeSounds.get(e).paused=!0}unpauseAll(){for(let e of this.activeSounds.keys())this.activeSounds.get(e).paused=!1}killAll(){for(let e of this.activeSounds.keys())this.activeSounds.get(e).stop(),this.activeSounds.get(e).destroy(),this.activeSounds.delete(e)}}t.AudioManager=i,i.FADE_IN_COMPLETE="fade_in_complete",i.FADE_OUT_COMPLETE="fade_out_complete";class a{}t.AudioConstants=a,a.SOUND="sound",a.MUSIC="music",a.SFX="sfx",a.VO="vo";class n extends createjs.Event{constructor(e,t){super(e,!1,!1),this._id=t}get id(){return this._id}}t.AudioEvent=n,n.PLAY_VO="playVO"},324:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s(95);s(39).TeaParty.getInstance(window.innerWidth,window.innerHeight).run()},325:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DTLoadingScreen=void 0;const i=s(40),a=s(63);class n extends createjs.Container{constructor(e,t){super(),this.start=()=>{this._trolley.scaleX=.9,this._trolley.scaleY=1.1,createjs.Tween.get(this._trolley,{loop:1e4}).to({scaleX:1.05,scaleY:.95},400,createjs.Ease.backIn).to({scaleX:.95,scaleY:1.05},300,createjs.Ease.cubicInOut)},this.freeze=()=>{this._trolley.scaleX=this._trolley.scaleY=1,createjs.Tween.removeTweens(this._trolley)},this._bg=new createjs.Shape,null==t&&(this._color="#fff48b"),this._bg.graphics.beginFill(this._color),this._bg.graphics.drawRect(0,0,100,100),this._bg.graphics.endFill(),this.addChild(this._bg),this._trolley=new createjs.Container,this._trolley.x=50,this._trolley.y=50,this.addChild(this._trolley),this._textContainer=new createjs.Container,this._textContainer.x=50,this._textContainer.y=50,this.addChild(this._textContainer),this._assets=new i.AssetPackage;var s=[];s.push(i.AssetPackage.makeManifestItem(n.DT_LOADING_SS,"assets/sheets/loading.json","spritesheet")),this._assets.loadManifest(s,this.assetsReceived.bind(this))}assetsReceived(){this._trolleyAnim=this._assets.getSpriteFromSheet("loadingTrolley",n.DT_LOADING_SS),this._trolleyAnim.y=-1*this._trolleyAnim.getBounds().height,this._trolleyAnim.x=-.5*this._trolleyAnim.getBounds().width,this._trolley.addChild(this._trolleyAnim),this._loadingBG=new createjs.Text;let e=new createjs.Text;this._loadingBG.text=e.text="Loading",this._loadingBG.font=e.font="50px Joint",this._loadingBG.color="#f05119",this._loadingBG.x=e.x=-.55*this._loadingBG.getTransformedBounds().width,e.color="black",e.outline=3,this._textContainer.addChild(this._loadingBG)}setSize({width:e,height:t}){this._bg.graphics.clear(),this._bg.graphics.beginFill(this._color),this._bg.graphics.drawRect(0,0,e,t),this._trolley.scaleX=this._trolley.scaleY=t/(a.SpringrollConstants.BASE_HEIGHT*a.SpringrollConstants.ASSET_SCALE),this._trolley.x=this._textContainer.x=e/2,this._trolley.y=t/2,this._textContainer.y=.52*t}setColor(e,t){this._color=e,this._bg.graphics.beginFill(this._color),this._bg.graphics.drawRect(0,0,a.SpringrollGame.getInstance().width,a.SpringrollGame.getInstance().height),null!=t&&(this._loadingBG.color=t)}}t.DTLoadingScreen=n,n.DT_LOADING_SS="loadingScreenSheet"},326:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TitleScreen=void 0;const i=s(92),a=s(40),n=s(327),h=s(63),o=s(23),r=s(93),l=s(39);class c extends i.GameScreen{constructor(e,t,s){super(),this.onPackageReady=()=>{this.addChild(this._sceneContainer),this._bg=this._assets.getBitmap(this._data.image),this._sceneContainer.addChild(this._bg),this._playButton=new n.HoverButton(this._assets.getSpriteFromSheet(this._data.playButton.art.up,this._data.playButton.art.sheet),this._assets.getSpriteFromSheet(this._data.playButton.art.down,this._data.playButton.art.sheet)),this._sceneContainer.addChild(this._playButton),"center"==this._data.playButton.align&&(this._playButton.scaleX=this._playButton.scaleY=this._bg.getBounds().height/(h.SpringrollConstants.BASE_HEIGHT*h.SpringrollConstants.ASSET_SCALE),this._playButton.x=this._bg.getBounds().width*this._data.playButton.position.x-this._playButton.getBounds().width*this._playButton.scaleX*.5,this._playButton.y=this._bg.getBounds().height*this._data.playButton.position.y-this._playButton.getBounds().height*this._playButton.scaleX*.5),this._playButton.turnOn(),this.resize({width:h.SpringrollGame.getInstance().width,height:h.SpringrollGame.getInstance().height}),this._readyCallback()},this.onKeyDown=e=>{window.removeEventListener("keydown",this.onKeyDown.bind(this)),this.triggerAdvance()},this.triggerAdvance=e=>{this.removeEventListener("mousedown",this.triggerAdvance),window.removeEventListener("keydown",this.onKeyDown),this._playButton.removeEventListener(n.HoverButton.DOWN,this.triggerAdvance),this._playButton.turnOff(),createjs.Tween.removeTweens(this),createjs.Sound.play("global_click").on("complete",this.actuallyAdvance)},this.actuallyAdvance=e=>{this.dispatchEvent(new r.SceneLoadEvent(r.SceneLoadEvent.SCENE_REQUEST,this._startScene))},this._sceneContainer=new createjs.Container,this._startScene=t,this._readyCallback=s,this._data=e,this._assets=new a.AssetPackage,this._assets.loadManifest(e.manifest,this.onPackageReady)}start(){createjs.Tween.get(this).wait(1500,!0).call(o.AudioManager.getInstance().playVO,[this._data.audio]),this._playButton.addEventListener(n.HoverButton.DOWN,this.triggerAdvance),this.addEventListener("mousedown",this.triggerAdvance),window.addEventListener("keydown",this.onKeyDown)}resize({width:e,height:t}){e/t<l.TeaPartyConstants.ASPECT_RATIO_MIN?(this._sceneContainer.scaleX=this._sceneContainer.scaleY=e/l.TeaPartyConstants.GAME_WIDTH,this._sceneContainer.x=0,this._sceneContainer.y=(t-this._sceneContainer.getTransformedBounds().height)/2):(this._sceneContainer.scaleX=this._sceneContainer.scaleY=t/l.TeaPartyConstants.GAME_HEIGHT,this._sceneContainer.x=(e-this._sceneContainer.getTransformedBounds().width)/2,this._sceneContainer.y=0)}destroy(){createjs.Tween.removeTweens(this),this._bg=null,this._playButton.removeAllEventListeners(),this._playButton.destroy(),this._playButton=null,window.removeEventListener("keydown",this.onKeyDown),o.AudioManager.getInstance().killAll(),createjs.Sound.removeAllSounds()}}t.TitleScreen=c},327:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HoverButton=void 0;class i extends createjs.Container{constructor(e,t,s,a){super(),this.onOut=e=>{this._over.visible=!1,this._off.visible=!0},this.onOver=e=>{this._over.visible=!0,this._off.visible=!1,this.dispatchEvent(new createjs.Event(i.OVER,!1,!1))},this.onDown=e=>{null!=this._down&&(null!=this._over&&(this._over.visible=!1),this._off.visible=!1,this._down.visible=!0),this.dispatchEvent(new createjs.Event(i.DOWN,!1,!1))},null==a&&(a=e.getBounds()),this._hitbox=new createjs.Shape,this._hitbox.graphics.beginFill("#00ff00"),this._hitbox.graphics.drawRect(a.x,a.y,a.width,a.height),this._hitbox.graphics.endFill(),this.hitArea=this._hitbox,this._off=e,this.addChildAt(this._off,0),null!=t&&this.addOver(t),null==s&&null!=this._over?this._down=this._over:this._down=s}forceOver(){this._over.visible=!0,this._off.visible=!1}forceOut(){this._over.visible=!1,this._off.visible=!0}turnOn(){this.addEventListener("mousedown",this.onDown),null!=this._over&&(this.addEventListener("mouseover",this.onOver),this.addEventListener("mouseout",this.onOut))}turnOff(){this.removeEventListener("mousedown",this.onDown),null!=this._over&&(this.removeEventListener("mouseover",this.onOver),this.removeEventListener("mouseout",this.onOut))}addOver(e,t,s){this._over=e,null!=t&&(this._over.x=t.x,this._over.y=t.y),this.addChildAt(this._over,0),this._over.visible=!1,this._clearOnOver=s}destroy(){this.removeAllChildren(),this.turnOff()}}t.HoverButton=i,i.ACTIVATED="activated",i.DOWN="down",i.OVER="over"},328:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartyScene=void 0;const i=s(92),a=s(40),n=s(94),h=s(132),o=s(131),r=s(133),l=s(39),c=s(134),_=s(135),d=s(332),u=s(333),p=s(23);class g extends i.GameScreen{constructor(e,t,s){super(),this._ready=!1,this._playerEatingOrDrinking=!1,this._moreTeaNeigbhborIndex=0,this._greetingActive=!0,this._greetingTimer=2e3,this._greetingIndex=1,this.configLoaded=()=>{this._sceneConfig=this._assets.getResult("scene_config"),console.log(this._sceneConfig),this._assets.loadManifest(this._sceneConfig.manifest,this.buildRigs)},this.buildRigs=()=>{this._characterMap=new Map,this._atCharIndex=0,this.buildCharacter(this._sceneConfig.characters[this._atCharIndex])},this.buildCharacter=e=>{let t=new n.TeaPartyCharacter(e.name,e,()=>{this._atCharIndex++,console.log(this._atCharIndex),null!=this._sceneConfig.characters[this._atCharIndex]?this.buildCharacter(this._sceneConfig.characters[this._atCharIndex]):this.setupScene()});this._characterMap.set(e.name,t)},this.setupScene=()=>{this._sceneContainer=new createjs.Container,this.addChild(this._sceneContainer);let e=this._assets.getBitmap("bg");e.mouseEnabled=!1,this._sceneContainer.addChild(e),this._teasetShelf=new _.Shelf(this._sceneConfig.teasetShelf,this._startProps.teaset+1,this._assets,this.changeTeasetTo),this._teasetShelf.setTransform(this._sceneConfig.teasetShelf.position.x,this._sceneConfig.teasetShelf.position.y),this._sceneContainer.addChild(this._teasetShelf),this._clothShelf=new _.Shelf(this._sceneConfig.clothShelf,this._startProps.tablecloth+1,this._assets,this.changeTableCothTo),this._clothShelf.setTransform(this._sceneConfig.clothShelf.position.x,this._sceneConfig.clothShelf.position.y),this._sceneContainer.addChild(this._clothShelf),this._snackShelf=new _.Shelf(this._sceneConfig.snackShelf,this._startProps.snack+1,this._assets,this.changeSnackTo),this._snackShelf.setTransform(this._sceneConfig.snackShelf.position.x,this._sceneConfig.snackShelf.position.y),this._sceneContainer.addChild(this._snackShelf),this._table=this._assets.getSpriteFromSheet(this._sceneConfig.table.spriteId),this._table.setTransform(this._sceneConfig.table.position.x,this._sceneConfig.table.position.y),this._table.mouseEnabled=!1,this._sceneContainer.addChild(this._table);let t=0;this._characters=[],this._characterMap.forEach(e=>{e.addPlate(new o.SnackPlate(this._sceneConfig.snackPlate,this._startProps.teaset,this._assets)),e.addTeaCup(new h.TeaCup(this._sceneConfig.characterCup,this._startProps.teaset,this._assets,e.characterData.seat)),e.addSnack(new r.TeaSnack(this._sceneConfig.teaSnacks,this._startProps.snack,this._assets)),e.addTablecloth(new c.Tablecloth(e.characterData.cloths,this._startProps.tablecloth,this._assets)),e.registerTalkingCheck(this.talkingCharacter),e.addEventListener(n.TeaPartyCharacter.START_TALKING,this.characterTalkStateChange),e.addEventListener(n.TeaPartyCharacter.FINISH_TALKING,this.characterTalkStateChange),this._sceneContainer.addChild(e.display),e.gotoIdle(),this._characters[t]=e,t++}),this._tableClothIndex=this._startProps.tablecloth,this.changeTableCothTo(this._tableClothIndex),this._servingDish=new d.SnackServingDish(this._sceneConfig.servingDish,this._startProps.snack,this._startProps.teaset,this._assets),this._servingDish.setTransform(this._sceneConfig.servingDish.position.x,this._sceneConfig.servingDish.position.y),this._sceneContainer.addChild(this._servingDish),this._servingDish.addEventListener("mousedown",this.pickupSnack),this._playerCup=new h.TeaCup(this._sceneConfig.characterCup,this._startProps.teaset,this._assets,1),this._sceneContainer.addChild(this._playerCup),this._playerCup.setTransform(this._sceneConfig.playerCupPlacement.x,this._sceneConfig.playerCupPlacement.y-this._playerCup.getBounds().height,this._sceneConfig.playerItemScale,this._sceneConfig.playerItemScale),this._playerCup.addEventListener("mousedown",this.beginPlayerDrinking),this._playerSnackPlate=new o.SnackPlate(this._sceneConfig.snackPlate,this._startProps.teaset,this._assets),this._sceneContainer.addChild(this._playerSnackPlate),this._playerSnackPlate.setTransform(this._sceneConfig.playerSnackPlatePlacement.x,this._sceneConfig.playerSnackPlatePlacement.y,this._sceneConfig.playerItemScale,this._sceneConfig.playerItemScale),this._playerSnackPlate.addEventListener("mousedown",this.beginPlayerSnackConsumption),this._playerSnack=new r.TeaSnack(this._sceneConfig.teaSnacks,this._startProps.snack,this._assets,!0),this._sceneContainer.addChild(this._playerSnack),this._playerSnack.setTransform(this._sceneConfig.playerSnackPlacement.x,this._sceneConfig.playerSnackPlacement.y,this._sceneConfig.playerItemScale,this._sceneConfig.playerItemScale),this._teapot=new u.TeaPot(this._startProps.teaset,this._assets),this._teapot.setTransform(this._sceneConfig.teapotPlacement.x,this._sceneConfig.teapotPlacement.y),this._sceneContainer.addChild(this._teapot),this._teapot.addEventListener("mousedown",this.pickupTeapot),this._ready=!0,this._readyCallback(),this.resize({width:l.TeaParty.getInstance().width,height:l.TeaParty.getInstance().height}),this._characters[1].playGreeting()},this.pickupTeapot=e=>{0==this._greetingActive&&0==this._playerEatingOrDrinking&&(this._servingDish.removeAllEventListeners(),this._teapot.isHeld=!0,this._teapot.removeAllEventListeners(),this._teapotPickupTime=(new Date).getTime(),this._teapot.setTransform(e.stageX*this._scaleRec,e.stageY*this._scaleRec),this.stage.addEventListener("stagemousemove",this.moveTeapot),this.stage.addEventListener("stagemouseup",this.teapotReleaseCheck),this._teapot.setToOffset(),this.moveTeapot(e))},this.moveTeapot=e=>{e.stageX,this._scaleRec,this._sceneContainer.x,this._scaleRec;let t=e.stageY*this._scaleRec-this._sceneContainer.y*this._scaleRec,s=Math.min(Math.max(t/332,.75),1.25);this._teapot.scaleX=s*Math.sign(this._teapot.scaleX),this._teapot.scaleY=s,this._teapot.x=e.stageX*this._scaleRec-this._sceneContainer.x*this._scaleRec,this._teapot.y=e.stageY*this._scaleRec-this._sceneContainer.y*this._scaleRec,this._teapot.isPouring=!1;let i=-1;this._teapot.scaleValue=this._scaleRec,this._teapot.scaleContainerInfo=new createjs.Point(this._sceneContainer.x,this._sceneContainer.y);for(let t=0;t<this._characters.length;t++)if(this._characters[t].canAcceptTea){let s=this._characters[t].Cup.globalToLocal(e.stageX,e.stageY);if(this._characters[t].Cup.hitTest(s.x,s.y)){i=t;let e=this._characters[t].Cup.getTransformedBounds(),s=new createjs.Point(e.x+.5*e.width,e.y-10);this._teapot.pourGoalPosition=s}}else{let s=this._characters[t].Cup.globalToLocal(e.stageX,e.stageY);this._characters[t].Cup.hitTest(s.x,s.y)&&(this._characters[t].sayNoThanksToMoreTea(),3==t&&(this._teapot.scaleX=-1*Math.abs(this._teapot.scaleX)))}if(this._playerCup.canAcceptTea){let t=this._playerCup.globalToLocal(e.stageX,e.stageY);if(this._playerCup.hitTest(t.x,t.y)){i=100;let e=this._playerCup.getTransformedBounds(),t=new createjs.Point(e.x+.5*e.width,e.y-10);this._teapot.pourGoalPosition=t}}i>=0&&(this._teapot.isPouring=!0,i<100?(this._teapot.currentCharacter=this._characters[i],this._teapot.currentTeaCup=this._characters[i].Cup,this._teapot.pouringForPlayer=!1,this._teapot.scaleX=3==i?-1*Math.abs(this._teapot.scaleX):Math.abs(this._teapot.scaleX)):100==i&&(this._teapot.currentCharacter=null,this._teapot.currentTeaCup=this._playerCup,this._teapot.pouringForPlayer=!0,this._teapot.scaleX=Math.abs(this._teapot.scaleX)))},this.teapotReleaseCheck=e=>{console.log("teapot release"),this.stage.removeEventListener("stagemouseup",this.teapotReleaseCheck),this.stage.removeEventListener("stagemousemove",this.moveTeapot),console.log((new Date).getTime(),this._teapotPickupTime,(new Date).getTime()-this._teapotPickupTime),(new Date).getTime()-this._teapotPickupTime<this._sceneConfig.clickNstickThreshold?(console.log("click and stick"),this.stage.addEventListener("stagemousedown",this.checkTeapotPlacement),this.stage.addEventListener("stagemousemove",this.moveTeapot)):this.checkTeapotPlacement(e)},this.checkTeapotPlacement=e=>{this._teapot.resetOffset(),this._teapot.setTransform(this._sceneConfig.teapotPlacement.x,this._sceneConfig.teapotPlacement.y),this._teapot.isPouring=!1,this._teapot.isHeld=!1,this.stage.removeEventListener("stagemousedown",this.checkTeapotPlacement),this.stage.removeEventListener("stagemousemove",this.moveTeapot),this._teapot.addEventListener("mousedown",this.pickupTeapot),this._servingDish.addEventListener("mousedown",this.pickupSnack)},this.pickupSnack=e=>{this._servingDish.snackLevel>0&&0==this._greetingActive&&0==this._playerEatingOrDrinking&&(this._servingDish.removeAllEventListeners(),this._servingDish.removeSnack(),this._snackPickupTime=(new Date).getTime(),this._activeSnack=this._assets.getSpriteFromSheet(this._servingDish.getCurrentPickup().spriteId),this._activeSnack.setTransform(e.stageX*this._scaleRec+this._servingDish.getCurrentPickup().offset.x-this._sceneContainer.x*this._scaleRec,e.stageY*this._scaleRec+this._servingDish.getCurrentPickup().offset.y-this._sceneContainer.y*this._scaleRec),this.stage.addEventListener("stagemousemove",this.moveActiveSnack),this.stage.addEventListener("stagemouseup",this.snackReleaseCheck),this._sceneContainer.addChild(this._activeSnack))},this.beginPlayerDrinking=e=>{if(1!=this._greetingActive)if(this._playerCup.teaLevel>0)0==this._playerEatingOrDrinking&&(this._playerEatingOrDrinking=!0,this._playerCup.parent.setChildIndex(this._playerCup,this._playerCup.parent.children.length-1),createjs.Tween.get(this._playerCup).to({x:425,y:300,scaleX:1.25,scaleY:1.25},750,createjs.Ease.quadOut).call(this.playerDrinkTea));else if(null==this._characterTalking)for(let e=0;e<this._characters.length;e++){let t=(this._moreTeaNeigbhborIndex+e)%this._characters.length,s=this._characters[t];if(s.State==n.TeaPartyCharacter.STATE_IDLE){this._moreTeaNeigbhborIndex+=1,s.sayMoreTeaNeighbor();break}}},this.playerDrinkTea=()=>{this._playerCup.setState(2),this._playerCup.changeTeaLevelBy(-.3),createjs.Sound.play(this._characters[0].GetSipSound()),createjs.Tween.get(this._playerCup).wait(500).to({x:this._sceneConfig.playerCupPlacement.x,y:this._sceneConfig.playerCupPlacement.y-this._playerCup.getBounds().height,scaleX:this._sceneConfig.playerItemScale,scaleY:this._sceneConfig.playerItemScale},750,createjs.Ease.quadInOut).call(this.endPlayerDrinking)},this.endPlayerDrinking=()=>{if(this._playerCup.setState(0),this._playerCup.parent.setChildIndex(this._playerCup,this._playerCup.parent.getChildIndex(this._playerSnackPlate)),this._playerEatingOrDrinking=!1,this._playerCup.setTransform(this._sceneConfig.playerCupPlacement.x,this._sceneConfig.playerCupPlacement.y-this._playerCup.getBounds().height,this._sceneConfig.playerItemScale,this._sceneConfig.playerItemScale),p.AudioManager.getInstance().playExternalSFX("Cup_place"),this._playerCup.teaLevel<=0&&null==this._characterTalking)for(let e=0;e<this._characters.length;e++){let t=(this._moreTeaNeigbhborIndex+e)%this._characters.length,s=this._characters[t];if(s.State==n.TeaPartyCharacter.STATE_IDLE){this._moreTeaNeigbhborIndex+=1,s.sayMoreTeaNeighbor();break}}},this.beginPlayerSnackConsumption=e=>{1!=this._greetingActive&&this._playerSnack.snackLevel>0&&0==this._playerEatingOrDrinking&&(this._playerEatingOrDrinking=!0,this._playerSnack.parent.setChildIndex(this._playerSnack,this._playerSnack.parent.children.length-1),createjs.Tween.get(this._playerSnack).to({x:425,y:300,scaleX:1.25,scaleY:1.25},750,createjs.Ease.quadOut).call(this.bitePlayerSnack))},this.bitePlayerSnack=()=>{this._playerSnack.eat(),p.AudioManager.getInstance().playExternalSFX(this._characters[0].GetBiteSound()),this._playerSnack.snackLevel>0?createjs.Tween.get(this._playerSnack).wait(500).to({x:this._sceneConfig.playerSnackPlacement.x,y:this._sceneConfig.playerSnackPlacement.y,scaleX:this._sceneConfig.playerItemScale,scaleY:this._sceneConfig.playerItemScale},750,createjs.Ease.quadInOut).call(this.endPlayerSnack):(this._playerSnack.setTransform(this._sceneConfig.playerSnackPlacement.x,this._sceneConfig.playerSnackPlacement.y,this._sceneConfig.playerItemScale,this._sceneConfig.playerItemScale),this.endPlayerSnack())},this.endPlayerSnack=()=>{this._playerSnack.parent.setChildIndex(this._playerSnack,this._playerSnackPlate.parent.getChildIndex(this._teapot)),this._playerEatingOrDrinking=!1},this.moveActiveSnack=e=>{this._activeSnack.setTransform(e.stageX*this._scaleRec+this._servingDish.getCurrentPickup().offset.x-this._sceneContainer.x*this._scaleRec,e.stageY*this._scaleRec+this._servingDish.getCurrentPickup().offset.y-this._sceneContainer.y*this._scaleRec)},this.snackReleaseCheck=e=>{console.log("snack release"),this.stage.removeEventListener("stagemouseup",this.snackReleaseCheck),this.stage.removeEventListener("stagemousemove",this.moveActiveSnack),console.log((new Date).getTime(),this._snackPickupTime,(new Date).getTime()-this._snackPickupTime),(new Date).getTime()-this._snackPickupTime<this._sceneConfig.clickNstickThreshold?(console.log("click and stick"),this._activeSnack.addEventListener("mousedown",this.checkSnackPlacement),this.stage.addEventListener("stagemousemove",this.moveActiveSnack)):this.checkSnackPlacement(e)},this.checkSnackPlacement=e=>{this._activeSnack.removeEventListener("mousedown",this.checkSnackPlacement),this.stage.removeEventListener("stagemousemove",this.moveActiveSnack),console.log("check snack placement"),this._sceneContainer.removeChild(this._activeSnack),this._activeSnack.removeAllEventListeners(),this._activeSnack=null;let t=!1;this._characterMap.forEach(s=>{if(!t){s.display.globalToLocal(e.stageX,e.stageY);s.canAcceptSnack(e.stageX,e.stageY)?(console.log(s.name+" can accept snack"),t=!0,p.AudioManager.getInstance().playExternalSFX(this._sceneConfig.teaSnacks.serveSfx[this._servingDish.snackType])):console.log(s.name+" can not accept snack")}}),t||(this._playerSnack.snackLevel<=0&&this._playerSnackPlate.performHitTest(e.stageX,e.stageY)?this._playerSnack.refill():this._servingDish.returnSnack()),this._servingDish.addEventListener("mousedown",this.pickupSnack)},this.talkingCharacter=()=>this._characterTalking,this.characterTalkStateChange=e=>{e.type==n.TeaPartyCharacter.START_TALKING?this._characterTalking=e.target:e.type==n.TeaPartyCharacter.FINISH_TALKING&&(this._characterTalking=null)},this.changeTableCothTo=e=>{e<0?e=this._sceneConfig.table.cloths.length-1:e>=this._sceneConfig.table.cloths.length&&(e=0),null!=this._tablecloth&&this._sceneContainer.removeChild(this._tablecloth),this._tablecloth=this._assets.getSpriteFromSheet(this._sceneConfig.table.cloths[e]),this._tablecloth.setTransform(this._sceneConfig.table.position.x,this._sceneConfig.table.position.y),this._tablecloth.mouseEnabled=!1,this._sceneContainer.addChildAt(this._tablecloth,this._sceneContainer.getChildIndex(this._table)+1),this._characterMap.forEach(t=>{t.setTableStyleTo(e)}),p.AudioManager.getInstance().playExternalSFX("tablecloth_setup")},this.changeTeasetTo=e=>{switch(this._characterMap.forEach(t=>{t.setTeasetStyleTo(e)}),this._teapot.changeStyleTo(e),this._servingDish.changePlateTo(e),this._playerCup.setToStyle(e),this._playerSnackPlate.setToStyle(e),p.AudioManager.getInstance().playExternalSFX("Teaset_Swap"),e){case 0:this._characters[0].playFavorite(!0);break;case 1:this._characters[3].playFavorite();break;case 2:this._characters[0].playFavorite();break;case 3:this._characters[2].playFavorite();break;case 4:this._characters[4].playFavorite();break;case 5:this._characters[1].playFavorite()}},this.changeSnackTo=e=>{null==this._activeSnack&&(this._characterMap.forEach(t=>{t.setSnackStyleTo(e)}),this._servingDish.changeSnackTo(e),this._playerSnack.changeToType(e),p.AudioManager.getInstance().playExternalSFX("Snack_Swap"))},this._startProps=t,this._readyCallback=s,this._assets=new a.AssetPackage,this._assets.loadManifest([a.AssetPackage.makeManifestItem("scene_config",e.config,"json")],this.configLoaded)}update(e){if(1==this._ready&&1==this._greetingActive){if(this._greetingTimer-=e.delta,this._greetingTimer>0)return;if(this._characters[this._greetingIndex].State==n.TeaPartyCharacter.START_TALKING)return;if(this._greetingIndex+=1,this._greetingIndex<this._characters.length)return this._characters[this._greetingIndex].playGreeting(),void(this._greetingTimer=2e3);this._characters[0].playGreeting(!0),this._greetingActive=!1}null!=this._teapot&&0==this._greetingActive&&this._teapot.update(e)}resize({width:e,height:t}){if(this._ready){e/t<l.TeaPartyConstants.ASPECT_RATIO_MIN?(this._sceneContainer.scaleX=this._sceneContainer.scaleY=e/l.TeaPartyConstants.GAME_WIDTH,this._sceneContainer.x=0,this._sceneContainer.y=(t-l.TeaPartyConstants.GAME_HEIGHT*this._sceneContainer.scaleY)/2,this._scaleRec=1/this._sceneContainer.scaleX):(this._sceneContainer.scaleX=this._sceneContainer.scaleY=t/l.TeaPartyConstants.GAME_HEIGHT,this._sceneContainer.x=(e-l.TeaPartyConstants.GAME_WIDTH*this._sceneContainer.scaleX)/2,this._sceneContainer.y=0,this._scaleRec=1/this._sceneContainer.scaleX)}}}t.PartyScene=g},331:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayUtils=void 0;t.ArrayUtils=class{static cloneArray(e){return JSON.parse(JSON.stringify(e))}static shuffleArray(e){for(var t=[];e.length>0;)t.push(e.splice(Math.floor(Math.random()*e.length),1)[0]);return t}static randomItem(e){return e[Math.floor(Math.random()*e.length)]}}},332:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnackServingDish=void 0;class i extends createjs.Container{constructor(e,t,s,i){super(),this.getCurrentPickup=()=>this._config.pickups[this._snackType],this._assets=i,this._config=e,this._snackLevel=6,this.changePlateTo(s),this.changeSnackTo(t)}get snackType(){return this._snackType}changeSnackTo(e){this._snackLevel=6,this._snackType=e,this.adjustSnackArt()}changePlateTo(e){null!=this._plate&&this.removeChild(this._plate),this._plate=this._assets.getSpriteFromSheet(this._config.plates[e]),this.addChildAt(this._plate,0)}removeSnack(){console.log("snack removed"),this._snackLevel>=1&&(this._snackLevel--,this.adjustSnackArt())}returnSnack(){this._snackLevel++,this.adjustSnackArt()}adjustSnackArt(){null!=this._snack&&this.removeChild(this._snack),console.log(this._snackType,this._snackLevel),this._snack=this._assets.getSpriteFromSheet(this._config.snacks[this._snackType][this._snackLevel]),null!=this._snack&&(console.log(this._snack),this._snack.setTransform(-10,-40),this.addChild(this._snack))}get snackLevel(){return this._snackLevel}}t.SnackServingDish=i},333:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TeaPot=void 0;const i=s(23);class a extends createjs.Container{constructor(e,t){super(),this._teapotSpriteNames=["TeaParty_Teapot_A","TeaParty_Teapot_B","TeaParty_Teapot_C","TeaParty_Teapot_D","TeaParty_Teapot_E","TeaParty_Teapot_F"],this._teapotPourColors=["#a2b3a2","#a2b3a2","#c49c8e","#a2b3a2","#a2b3a2","#f7a8c9"],this.teapotHandlesX=[92,69,99,92,91,77],this.teapotHandlesY=[-90,-112,-68,-107,-89,-110],this.teapotSpoutX=[-94,-73,-106,-99,-95,-87],this.teapotSpoutY=[-103,-128,-99,-116,-94,-130],this.isPouring=!1,this.isHeld=!1,this.currentTeaCup=null,this.currentCharacter=null,this.pouringForPlayer=!1,this.goalAngle=0,this.currentAngle=0,this.yDistance=0,this._time=0,this._currentPourSFX=null,this._assets=t,this._teapotSprite=this._assets.getSpriteFromSheet("TeaParty_Teaset_A"),this.changeStyleTo(e),this._teapotSprite.x=.5*-this._teapotSprite.getBounds().width,this._teapotSprite.y=-this._teapotSprite.getBounds().height}get style(){return this._style}get teaspotGlobalPos(){return this.localToGlobal(-this.teapotHandlesX[this.style]+this.teapotSpoutX[this.style],-this.teapotHandlesY[this.style]+this.teapotSpoutY[this.style])}setToOffset(e=0){this._teapotSprite.x=e,this._teapotSprite.y=-this._teapotSprite.getBounds().height,this.spoutShape.x=e+.5*this._teapotSprite.getBounds().width+this.teapotSpoutX[this.style],this.spoutShape.y=this.teapotSpoutY[this.style]}resetOffset(){this._teapotSprite.x=.5*-this._teapotSprite.getBounds().width,this._teapotSprite.y=-this._teapotSprite.getBounds().height,this.spoutShape.x=this.teapotSpoutX[this.style],this.spoutShape.y=this.teapotSpoutY[this.style],this.currentAngle=0,this.goalAngle=0}changeStyleTo(e){this._style=e,null!=this._teapotSprite&&(this._teapotSprite.removeAllEventListeners(),this.removeChild(this._teapotSprite)),this._teapotSprite=this._assets.getSpriteFromSheet(this._teapotSpriteNames[e]),this._teapotSprite.x=.5*-this._teapotSprite.getBounds().width,this._teapotSprite.y=-this._teapotSprite.getBounds().height,this.addChild(this._teapotSprite),this.offsetX=this.teapotHandlesX[e],this.offsetY=this.teapotHandlesY[e],null!=this.spoutShape&&this.removeChild(this.spoutShape),this.spoutShape=new createjs.Shape,this.spoutShape.mouseEnabled=!1,this.addChild(this.spoutShape),this.spoutShape.x=this.teapotSpoutX[this.style],this.spoutShape.y=this.teapotSpoutY[this.style],null!=this.pourShape&&this.removeChild(this.pourShape),this.pourShape=new createjs.Shape,this.pourShape.mouseEnabled=!1,this.addChildAt(this.pourShape,0)}update(e){if(this.goalAngle=-45,this.goalAngle<-45?this.goalAngle=-45:this.goalAngle>0&&(this.goalAngle=0),this.pourShape.graphics.clear(),this._time+=e.delta,this.isPouring){this.currentAngle-=e.delta/1e3*90,this.currentAngle<this.goalAngle&&(this.currentAngle=this.goalAngle,this.goalAngle<-10&&null!=this.currentTeaCup&&(null==this._currentPourSFX&&(this._currentPourSFX=i.AudioManager.getInstance().playExternalSFX("tea_refill")),null==this.currentCharacter?this.currentTeaCup.fillOverTime(e.delta):this.currentCharacter.fillCup(e.delta),this.currentTeaCup.canAcceptTea||(this.isPouring=!1)));let t=this.pourDist;if(this.goalAngle>=-12.25)t=0;else{let e=this.scaleValue*(this.teaspotGlobalPos.y-this.scaleContainerInfo.y);t=.8*Math.abs(e-this.pourGoalPosition.y)}let s=new createjs.Point(this.spoutShape.x,this.spoutShape.y),a=new createjs.Point(this.spoutShape.x+Math.sin(this.currentAngle*Math.PI/180)*t/this.scaleY,this.spoutShape.y+Math.cos(this.currentAngle*Math.PI/180)*t/this.scaleY),n=5+Math.sin(this._time/50);this.pourShape.graphics.setStrokeStyle(n).beginLinearGradientStroke([this._teapotPourColors[this._style],this._teapotPourColors[this._style]+"00"],[.5,1],s.x,s.y,a.x,a.y).moveTo(s.x,s.y),this.pourShape.graphics.quadraticCurveTo(s.x-20,s.y,a.x,a.y),this.pourShape.graphics.endStroke()}else this.currentAngle+=e.delta/1e3*45,this.currentAngle>0&&(this.currentAngle=0),null!=this._currentPourSFX&&(this._currentPourSFX.stop(),this._currentPourSFX=null);this.isHeld&&this.setToOffset(1.75*-this.currentAngle),this.rotation=this.currentAngle*Math.sign(this.scaleX)}}t.TeaPot=a},334:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetupDaniel=void 0;const i=s(130),a=s(94),n=s(40),h=s(39),o=s(23),r=s(136);class l extends i.DragonBonesCharacter{constructor(e,t,s){super(e,t.dragonBonesData,s,!1),this.postBuild=()=>{console.log("post build for "+this.name),console.log(this.armature);let e=new dragonBones.factorys.CreateJSFactory;e.addSkeletonData(dragonBones.objects.DataParser.parseSkeletonData(this._skeletonData)),e.addTextureAtlas(this._atlas),this._mouthArmature=e.buildArmature(this._rigData.mouthArmature),dragonBones.animation.WorldClock.clock.add(this._mouthArmature);let t=this.armature.getBones();for(let e=0;e<t.length;e++)if(t[e].name.toLowerCase().includes("_head")&&(console.log("head bone: "+t[e].name),null!=t[e].slot.getChildArmature())){let s=t[e].slot.getChildArmature().getBones();for(let e=0;e<s.length;e++)if(s[e].name.toLowerCase().includes("mouth")){null!=this._mouthArmature&&s[e].slot.setDisplay(this._mouthArmature.getDisplay());break}}for(let e=0;e<t.length;e++)if("tableol"==t[e].name.toLowerCase()){this._tableclothBone=t[e];break}null!=this._rigData.VOManifest?(createjs.Sound.alternateExtensions=["mp3"],this.VOQueue=new createjs.LoadQueue,this.VOQueue.installPlugin(createjs.Sound),this.VOQueue.addEventListener("complete",this.VOLoaded),this.VOQueue.loadManifest([n.AssetPackage.makeManifestItem("VOManifest",this._rigData.VOManifest,"manifest")])):this.readyCallback(this)},this.VOLoaded=e=>{console.log(this.VOQueue),this.VOQueue.removeAllEventListeners(),this.readyCallback(this)},this.onVOComplete=()=>{this._activeVO.destroy(),this._activeVO=null,console.log("Play mouth idle"),this._mouthArmature.animation.gotoAndPlay("idle"),this.dispatchEvent(new createjs.Event(a.TeaPartyCharacter.FINISH_TALKING,!1,!1))},this.playVO2=e=>{console.log("Play VO: "+e);let t=null;return null!=this.VOQueue&&(t=o.AudioManager.getInstance().playExternalVO(e),null!=t&&(this._currentVO=t,null!=h.TeaParty.getInstance().CaptionPlayer&&(h.TeaParty.getInstance().CaptionPlayer.stop(),h.TeaParty.getInstance().CaptionPlayer.start(e)))),t},this._rigData=t}setTableStyleTo(e){this._tablecloth.setToStyle(e)}handleAnimationEvent(e){console.log("Animation Event: "+e),super.handleAnimationEvent(e);e.split("event_")[1];this.dispatchEvent(new r.SetupEvent(r.SetupEvent.ANIMATION_EVENT,e))}handleVOEvent(e){console.log("VO Event: "+e),this.sayLine(e.split("vo_")[1])}sayLine(e){console.log("Say line: "+e),this._activeVO=this.playVO2(e),this._activeVO.addEventListener("complete",this.onVOComplete),this._mouthArmature.animation.gotoAndPlay("talking"),this._state=a.TeaPartyCharacter.STATE_TALKING,this.dispatchEvent(new createjs.Event(a.TeaPartyCharacter.START_TALKING,!1,!1))}forceVOStop(){null!=this._activeVO&&(this._activeVO.removeAllEventListeners(),this._activeVO.stop(),this._activeVO=null)}playAnimation(e,t){return this.armature.removeAllEventListeners(),this.armature.addEventListener("boneFrameEvent",this.onBoneFrameEvent),null!=t&&this.armature.addEventListener("complete",t),this.armature.animation.gotoAndPlay(e)}addTablecloth(e){this._tablecloth=e,this._tableclothBone.slot.setDisplay(this._tablecloth)}}t.SetupDaniel=l},335:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetupButton=void 0;const i=s(336),a=s(137);class n extends i.TriggerButton{constructor(e,t,s){super(e,null),this.buttonPressed=e=>{this.turnOff(),null!=this._choiceCallback&&this._choiceCallback(this._index)},this._index=t,this._choiceCallback=s}destroy(){super.destroy(),this._choiceCallback=null}align(e){e==a.AlignmentOption.BOTTOM&&(this._up.regX=this._up.getBounds().width/2,this._up.regY=this._up.getBounds().height)}}t.SetupButton=n},336:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonEvent=t.TriggerButton=t.PushButton=t.ToggleButton=t.ToggleEvent=t.ToggleSet=void 0;class i extends createjs.EventDispatcher{constructor(){super(),this.pushButton=e=>{e.stopPropagation();for(var t=0;t<this._buttons.length;t++)this._buttons[t]!=e.currentTarget&&this._buttons[t].setState(n.UP);e.currentTarget.setState(n.DOWN),this._activeButton=e.currentTarget,this.dispatchEvent(new a(a.BUTTON_SELECTED))},this._buttons=new Array}get Buttons(){return this._buttons}get ActiveButton(){return this._activeButton}destroy(){for(var e of this._buttons)e.removeEventListener("mousedown",this.pushButton),e.destroy();this._activeButton=void 0,this.removeAllEventListeners()}addButton(e){e.addEventListener("mousedown",this.pushButton),this._buttons.push(e)}forceButton(e){for(var t=0;t<this._buttons.length;t++)this._buttons[t]!=e&&this._buttons[t].setState(n.UP);e.setState(n.DOWN),this._activeButton=e,this.dispatchEvent(new a(a.BUTTON_SELECTED))}}t.ToggleSet=i;class a extends createjs.Event{constructor(e,t){super(e,!1,!1),this._data=t}get data(){return this._data}}t.ToggleEvent=a,a.BUTTON_SELECTED="button_selected";class n extends createjs.Container{constructor(e,t){super(),this._up=e,this._down=t,this.setState(n.UP)}get Data(){return this._data}addData(e){this._data=e}destroy(){this.removeAllChildren(),this.removeAllEventListeners()}setState(e){this._state!=e&&(this._state=e,this._state==n.UP?(this.removeChild(this._down),this.addChild(this._up)):this._state==n.DOWN&&(this.removeChild(this._up),this.addChild(this._down)))}toggle(){this._state==n.UP?this.setState(n.DOWN):this._state==n.DOWN&&this.setState(n.UP)}}t.ToggleButton=n,n.UP="button_up",n.DOWN="button_down";class h extends createjs.Container{constructor(e,t,s){super(),this.onMouseDown=e=>{e.stopPropagation(),this._isEnabled&&this._state==h.STATE_UP&&(null!=this._down&&(this.removeAllChildren(),this.addChild(this._down)),this._state=h.STATE_DOWN,this.addEventListener("pressup",this.onMouseUp),this.dispatchEvent(new r(r.ACTIVATE)))},this.onMouseUp=e=>{e.stopPropagation(),this._isEnabled&&this._state==h.STATE_DOWN&&(this.removeAllChildren(),this.addChild(this._up),this._state=h.STATE_UP,this.removeEventListener("pressup",this.onMouseUp),this.dispatchEvent(new r(r.DECATIVATE)))},this._up=e,this._down=t,this._disabled=s,this.addEventListener("mousedown",this.onMouseDown),this.setEnabled(!0)}addDisabled(e){this._disabled=e}setEnabled(e){this._isEnabled!=e&&(this._isEnabled=e,e?(this.removeAllChildren(),this.addChild(this._up),this._state=h.STATE_UP):(this.removeAllChildren(),null!=this._disabled?this.addChild(this._disabled):this.addChild(this._up),this._state=h.STATE_DISABLED))}destroy(){this.removeAllEventListeners(),this.removeAllChildren()}}t.PushButton=h,h.STATE_UP="stateUp",h.STATE_DOWN="stateDown",h.STATE_DISABLED="stateDisabled";class o extends createjs.Container{constructor(e,t,s){super(),this.buttonPressed=e=>{null!=this._down&&(this.removeChild(this._up),this.addChild(this._down)),null!=this._pressCallback&&this._pressCallback(),this.onButtonPressed()},this._up=e,null!=t&&(this._down=t),null!=s&&(this._pressCallback=s),this.addChild(this._up)}get data(){return this._data}destroy(){this.turnOff(),this.removeAllChildren(),this.removeAllEventListeners(),this._pressCallback=null}addData(e){this._data=e}reset(){this.turnOff(),this.removeAllChildren(),this.addChild(this._up)}turnOn(){this.addEventListener("mousedown",this.buttonPressed)}turnOff(){this.removeEventListener("mousedown",this.buttonPressed)}onButtonPressed(...e){}}t.TriggerButton=o;class r extends createjs.Event{constructor(e){super(e,!1,!1)}}t.ButtonEvent=r,r.ACTIVATE="button_activate",r.DECATIVATE="button_deactivate"},39:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TeaPartyConstants=t.TeaParty=void 0;const i=s(63),a=s(325),n=s(40),h=s(326),o=s(93),r=s(328),l=s(136),c=s(23);class _ extends i.SpringrollGame{constructor(e,t){super(e,t),this.assetsLoaded=()=>{this._gameData=this.globalAssets.getResult(d.GAME_DATA),this.addCaptions("captions",this.globalAssets.getResult("captions")),this._gameData.debug.on&&_.getInstance().toggleDebug(!0),this._sceneData=new Map;for(let e=0;e<this._gameData.scenes.length;e++)this._sceneData.set(this._gameData.scenes[e].id,this._gameData.scenes[e]);this.app.state.pause.subscribe(this.pauseScene);let e=d.SETUP_SCENE;this._scene=new h.TitleScreen(this.globalAssets.getResult(d.TITLESCREEN_DATA),e,this.screenReady),this._scene.addEventListener(o.SceneLoadEvent.SCENE_REQUEST,this.sceneLoadRequest)},this.pauseScene=e=>{null!=this._scene&&this._scene.pause(e),e?(c.AudioManager.getInstance().pauseAll(),createjs.Ticker.removeEventListener("tick",this.update),createjs.Ticker.paused=!0):(c.AudioManager.getInstance().unpauseAll(),createjs.Ticker.addEventListener("tick",this.update),createjs.Ticker.paused=!1)},this.sceneLoadRequest=e=>{switch(this._loadStartTime=createjs.Ticker.getTime(!0),this._scene.removeEventListener(o.SceneLoadEvent.SCENE_REQUEST,this.sceneLoadRequest),this._loadingScreen.alpha=1,this.loadLayer.addChild(this._loadingScreen),this.gameLayer.removeAllChildren(),this._scene.destroy(),this._scene=null,this._loadingScreen.setColor(d.DT_ORANGE,d.DT_TEXT),e.sceneId){case d.SETUP_SCENE:this._scene=new l.SetupScene(this._sceneData.get(e.sceneId),this.screenReady);break;case d.PARTY_SCENE:this._scene=new r.PartyScene(this._sceneData.get(e.sceneId),this._setupChoices,this.screenReady)}this._scene.addEventListener(o.SceneLoadEvent.SCENE_REQUEST,this.sceneLoadRequest)},this.screenReady=()=>{createjs.Ticker.getTime(!0)-this._loadStartTime>d.LOAD_MIN_TIME?this.transitionToScreen():createjs.Tween.get(this).wait(d.LOAD_MIN_TIME-(createjs.Ticker.getTime(!0)-this._loadStartTime),!0).call(this.transitionToScreen)},this.transitionToScreen=()=>{this.gameLayer.addChild(this._scene),this._loadingScreen.parent==this.loadLayer&&this._loadingScreen.cache(0,0,i.SpringrollGame.getInstance().width,i.SpringrollGame.getInstance().height),createjs.Tween.get(this._loadingScreen).to({alpha:0},250,createjs.Ease.sineIn).call(this.startScreen)},this.startScreen=()=>{this.gameLayer.addChild(this._scene),this._loadingScreen.parent==this.loadLayer&&(this._loadingScreen.uncache(),this.loadLayer.removeChild(this._loadingScreen)),this._scene.start()},this.update=e=>{this.app.state.pause.value||(super.update(e),dragonBones.animation.WorldClock.clock.advanceTime(e.delta/1e3),null!=this._scene&&this._scene.update(e),this.stage.update(e))},createjs.Ticker.framerate=60,createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED,this.toggleDebug(!0),this._gameMask=new createjs.Shape,this._gameMask.graphics.clear(),this._gameMask.graphics.beginFill("red"),this._gameMask.graphics.drawRect(0,0,d.GAME_WIDTH,d.GAME_HEIGHT),this._gameMask.graphics.endFill(),this._loadingScreen=new a.DTLoadingScreen({width:this.width,height:this.height}),this._loadingScreen.setSize({width:this.width,height:this.height}),this._loadingScreen.addEventListener("added",this._loadingScreen.start),this._loadingScreen.addEventListener("removed",this._loadingScreen.freeze),this.loadLayer.addChild(this._loadingScreen),this.stage.mask=this._gameMask}get setupChoices(){return this._setupChoices}setIntialChoices(e,t,s){this._setupChoices={tablecloth:e,teaset:t,snack:s}}static getInstance(e,t){return _._instance||(_._instance=new _(e,t)),_._instance}run(){super.run(),createjs.Ticker.addEventListener("tick",this.update),this.setIntialChoices(0,0,0);let e=[];e.push(n.AssetPackage.makeManifestItem(d.TITLESCREEN_DATA,"assets/data/titlescreen_data.json","json")),e.push(n.AssetPackage.makeManifestItem(d.GAME_DATA,"assets/data/game_data.json","json")),e.push(n.AssetPackage.makeManifestItem("captions","assets/config/captions.json","json")),this.globalAssets=new n.AssetPackage,this.globalAssets.loadManifest(e,this.assetsLoaded)}resize({width:e,height:t}){if(super.resize({width:e,height:t}),null!=this._gameMask){this.width/this.height<d.ASPECT_RATIO_MIN?(this._gameMask.scaleX=this._gameMask.scaleY=e/d.GAME_WIDTH,this._gameMask.x=0,this._gameMask.y=(this.height-d.GAME_HEIGHT*this._gameMask.scaleY)/2):(this._gameMask.scaleX=this._gameMask.scaleY=t/d.GAME_HEIGHT,this._gameMask.x=(this.width-d.GAME_WIDTH*this._gameMask.scaleX)/2,this._gameMask.y=0)}null!=this._loadingScreen&&this._loadingScreen.setSize({width:this.width,height:this.height}),null!=this._scene&&this._scene.resize({width:this.width,height:this.height})}}t.TeaParty=_;class d{}t.TeaPartyConstants=d,d.LOAD_MIN_TIME=1e3,d.PICKUP_THRESHOLD=400,d.GAME_WIDTH=930,d.GAME_HEIGHT=490,d.ASPECT_RATIO_MIN=1.9,d.ASPECT_RATIO_MAX=1.9,d.GAME_NAME="TeaParty",d.SETUP_SCENE="setup_scene",d.PARTY_SCENE="party_scene",d.TITLE_SCENE="titleScene",d.TEST_SCENE="test_scene",d.TITLESCREEN_DATA="titlescreenData",d.GAME_DATA="gameData",d.CHARACTER_DATA="characterData",d.WHITE="#ffffff",d.DT_ORANGE="#fff48b",d.DT_TEXT="#f05119",d.TEASET_TROLLEY=0,d.TEASET_WEDNESDAY=1,d.TEASET_DANIEL=2,d.TEASET_OWL=3,d.TEASET_ELAINA=4,d.TEASET_KATERINA=5,d.TABLE_STYLE_A=0,d.TABLE_STYLE_B=1,d.TABLE_STYLE_C=2,d.TABLE_STYLE_D=3,d.TABLE_STYLE_E=4,d.TABLE_STYLE_F=5},40:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssetPackage=void 0;const i=s(23);t.AssetPackage=class{constructor(e){this._loaded=!1,this.loaded=!1,this.audioLoaded=()=>{this._loadTracker.audioLoaded=!0,this._loadTracker.queueLoaded&&(this.loaded=!0,this._completeCallback())},this.manifestLoaded=e=>{this._loadTracker.queueLoaded=!0,this._loadTracker.audioLoaded&&(this.loaded=!0,this._completeCallback())},this._loadQueue=new createjs.LoadQueue(!0,e),this._loadQueue.installPlugin(createjs.Sound),this._loadTracker={audioLoaded:!1,queueLoaded:!1}}destroy(){this._loadQueue.destroy(),this._loadQueue=void 0,this._completeCallback=void 0,this.loaded=!1,this._loadTracker=void 0}loadManifest(e,t){if(this.loaded=!1,this._loadTracker.audioLoaded=!1,this._loadTracker.queueLoaded=!1,null!=t&&(this._completeCallback=t),e.length>0){this._loadQueue.addEventListener("complete",this.manifestLoaded);let t=this.extractAudioItems(e);t.length>0?i.AudioManager.getInstance().loadAudioManifest(t,this.audioLoaded):this._loadTracker.audioLoaded=!0,this._loadQueue.loadManifest(e)}}extractAudioItems(e){for(var t=[],s=e.length-1;s>=0;s--)("sound"==e[s].type||e[s].src.indexOf(".mp3")>-1||e[s].src.indexOf(".ogg")>-1||e[s].src.indexOf(".wav")>-1)&&t.push(e.splice(s,1)[0]);return t}static makeManifestItem(e,t,s){return{id:e,src:t,type:s}}getSpriteFromSheet(e,t){if(null!=t&&""!=t)return new createjs.Sprite(this._loadQueue.getResult(t),e);for(var s=this._loadQueue.getItems(!0),i=0;i<s.length;i++){if("spritesheet"==s[i].item.type)if(-1!=this._loadQueue.getResult(s[i].item.id).animations.indexOf(e))return new createjs.Sprite(this._loadQueue.getResult(s[i].item.id),e)}return null}getBitmap(e){var t=this._loadQueue.getResult(e);return new createjs.Bitmap(t)}getResult(e){return this._loadQueue.getResult(e)}}},63:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpringrollConstants=t.SpringrollGame=void 0;const i=s(129),a=s(129),n=s(23);class h{constructor(e,t){this._isPaused=!1,this._isDebug=!1,this.changeCaptionsState=e=>{null!=this._captionsHolder&&(this._captionsHolder.style.display=e?"none":"block")},this.playCaption=e=>{this._captionsPlayer.start(e.id)},null==e&&(e=window.innerWidth),null==t&&(t=window.innerHeight),this._width=e,this._height=t;let s={},a={sfx:!0,sound:!0,music:!0,vo:!0,captions:!0};s.features=a,this._app=new i.Application(s),this._stage=new createjs.Stage("stage"),createjs.Touch.enable(this._stage,!0),this._app.state.pause.subscribe(this.pause),this._app.state.soundVolume.subscribe(this.changeVolume),this._app.state.sfxVolume.subscribe(this.changeSfxVolume),this._app.state.musicVolume.subscribe(this.changeMusicVolume),this._app.state.voVolume.subscribe(this.changeVOVolume),this._app.state.captionsMuted.subscribe(this.changeCaptionsState),this.changeCaptionsState(this._app.state.captionsMuted.value),this._loadLayer=new createjs.Container,this._gameLayer=new createjs.Container,this._debugLayer=new createjs.Container,this._stage.addChild(this._gameLayer),this._stage.addChild(this._loadLayer),this.isDebug&&this._stage.addChild(this._debugLayer),this.resize({width:this._width,height:this._height})}get width(){return this._width}get height(){return this._height}get positionScaler(){return this._positionScaler}get scaleRatio(){return this._scaleRatio}get app(){return this._app}get scaleManager(){return this._scaleManager}get stage(){return this._stage}get isPaused(){return this._isPaused}get isDebug(){return this._isDebug}get Dimensions(){return{width:this._width,height:this._height,positionScaler:this._positionScaler,scaleRatio:this._scaleRatio}}get CaptionPlayer(){return this._captionsPlayer}get loadLayer(){return this._loadLayer}get gameLayer(){return this._gameLayer}get debugLayer(){return this._debugLayer}static getInstance(e,t){return null==h._baseInstance&&(h._baseInstance=new h(e,t)),h._baseInstance}addCaptions(e,t,s="captionsHolder"){this._captionsElement=document.getElementById(e),this._captionsHolder=document.getElementById(s),this._captionsPlayer=new i.CaptionPlayer(t,new i.HtmlRenderer(this._captionsElement)),this.changeCaptionsState(this.app.state.captionsMuted.value),n.AudioManager.getInstance().addEventListener(n.AudioEvent.PLAY_VO,this.playCaption)}update(e){null!=this._captionsPlayer&&this._captionsPlayer.update(e.delta/1e3)}toggleDebug(e){this._isDebug=e,this.isDebug?this.stage.addChild(this._debugLayer):this.stage.removeChild(this._debugLayer)}resize({width:e,height:t},s){e/t<o.ASPECT_RATIO_MIN?t=e/o.ASPECT_RATIO_MIN:e/t>o.ASPECT_RATIO_MAX&&(e=t*o.ASPECT_RATIO_MAX),this._width=e,this._height=t;let i=this.width/this.height;this._positionScaler=(i-o.ASPECT_RATIO_MIN)/(o.ASPECT_RATIO_MAX-o.ASPECT_RATIO_MIN),this._scaleRatio=this.height/o.DEFAULT_HEIGHT,this.stage.canvas.setAttribute("width",e),this.stage.canvas.setAttribute("height",t)}pause(e){this._isPaused=e,e?n.AudioManager.getInstance().pauseAll():n.AudioManager.getInstance().unpauseAll()}run(){this._scaleManager=new a.ScaleManager(this.resize.bind(this))}changeVolume(e){createjs.Sound.volume=e}changeSfxVolume(e){}changeMusicVolume(e){}changeVOVolume(e){}}t.SpringrollGame=h;class o{}t.SpringrollConstants=o,o.BASE_WIDTH=2500,o.BASE_HEIGHT=1125,o.ASSET_SCALE=.7,o.DEFAULT_WIDTH=2500,o.DEFAULT_HEIGHT=1125,o.ASPECT_RATIO_MIN=1.33,o.ASPECT_RATIO_MAX=2.2},92:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameScreen=void 0;class i extends createjs.Container{constructor(){super(),this.name="unnamed"}update(e){}pause(e){this._paused=e}resize({width:e,height:t}){throw new Error("Resize event needs to be implemented in screen ("+this.name+")")}destroy(){throw new Error("Destroy needs to be implemented in screen ("+this.name+")")}start(){}}t.GameScreen=i},93:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameEvent=t.SceneLoadEvent=void 0;class i extends createjs.Event{constructor(e,t,s,i,a){super(e,i,a),this._sceneId=t,this._data=s}get data(){return this._data}get sceneId(){return this._sceneId}}t.SceneLoadEvent=i,i.SCENE_REQUEST="sceneRequest",i.GAME_RESTART="gameRestart";class a extends createjs.Event{constructor(e,t,s,i){super(e,s,i),this._data=t}get data(){return this._data}}t.GameEvent=a,a.COMPLETE="complete"},94:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TeaPartyCharacter=void 0;const i=s(130),a=s(331),n=s(23),h=s(131),o=s(132),r=s(133),l=s(39),c=s(40);class _ extends i.DragonBonesCharacter{constructor(e,t,s){super(e,t.dragonBonesData,s,!1),this._seat=3,this.postBuild=()=>{let e=new dragonBones.factorys.CreateJSFactory;e.addSkeletonData(dragonBones.objects.DataParser.parseSkeletonData(this._skeletonData)),e.addTextureAtlas(this._atlas),this._mouthArmature=e.buildArmature(this._rigData.mouthArmature),dragonBones.animation.WorldClock.clock.add(this._mouthArmature);let t=this.armature.getBones();for(let e=0;e<t.length;e++)if(t[e].name.toLowerCase().includes("_head")&&null!=t[e].slot.getChildArmature()){let s=t[e].slot.getChildArmature().getBones();for(let e=0;e<s.length;e++)if(s[e].name.toLowerCase().includes("mouth")){null!=this._mouthArmature&&s[e].slot.setDisplay(this._mouthArmature.getDisplay());break}}for(let e=0;e<t.length;e++)if("tableol"==t[e].name.toLowerCase()){this._tableclothBone=t[e];break}null!=this._rigData.VOManifest?(this.VOQueue=new createjs.LoadQueue,this.VOQueue.installPlugin(createjs.Sound),this.VOQueue.addEventListener("complete",this.VOLoaded),this.VOQueue.loadManifest([c.AssetPackage.makeManifestItem("VOManifest",this._rigData.VOManifest,"manifest")])):this.readyCallback(this)},this.activate=()=>{this.display.addEventListener("mousedown",this.reactToTouch)},this.reactToTouch=e=>{e.target.name==o.TeaCup.NAME_CUP||e.target.name==o.TeaCup.NAME_TEA?this._state!=_.STATE_EATING&&this._state!=_.STATE_DRINKING&&(this._cup.teaLevel>0?(this._getTalkingCharacter()==this&&this.stopTalking(),this.playAnimation("sip",this.gotoIdle),this._mouthArmature.animation.gotoAndPlay("sip"),this._state=_.STATE_DRINKING):null==this._getTalkingCharacter()&&(this.playAnimation("request_tea"),this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.moreTea)))):e.target.name==h.SnackPlate.NAME_PLATE||e.target.name==r.TeaSnack.NAME_SNACK?this._state!=_.STATE_EATING&&this._state!=_.STATE_DRINKING&&(this._snack.empty?null==this._getTalkingCharacter()&&(this.playAnimation("request_snack",this.gotoIdle),this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.moreSnacks))):(this._getTalkingCharacter()==this&&this.stopTalking(),this.playAnimation("eat",this.gotoIdle),this._mouthArmature.animation.gotoAndPlay("eat"),this._state=_.STATE_EATING)):this._state!=_.STATE_EATING&&this._state!=_.STATE_DRINKING&&null==this._getTalkingCharacter()&&(this.playAnimation(a.ArrayUtils.randomItem(this._rigData.animations.dialog),this.gotoIdle),this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.interests)))},this.VOLoaded=e=>{this.VOQueue.removeAllEventListeners(),this.readyCallback(this),this.activate()},this.onVOComplete=()=>{this._activeVO.destroy(),this._activeVO=null,this._mouthArmature.animation.gotoAndPlay("idle"),this.dispatchEvent(new createjs.Event(_.FINISH_TALKING,!1,!1))},this.gotoIdle=()=>{if(this._state==_.STATE_DRINKING){if(null==this._getTalkingCharacter()&&this._cup.teaLevel<=0)return this.playAnimation("request_tea"),void this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.moreTea))}else if(this._state==_.STATE_EATING&&null==this._getTalkingCharacter()&&this._snack.snackLevel<=0)return this.playAnimation("request_snack",this.gotoIdle),void this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.moreSnacks));this.playAnimation("idle"),this._state=_.STATE_IDLE},this.playVO2=e=>{let t=null;return null!=this.VOQueue&&(t=n.AudioManager.getInstance().playExternalVO(e),null!=t&&(this._currentVO=t,null!=l.TeaParty.getInstance().CaptionPlayer&&(l.TeaParty.getInstance().CaptionPlayer.stop(),l.TeaParty.getInstance().CaptionPlayer.start(e)))),t},this._rigData=t}get characterData(){return this._rigData}get seat(){return this._seat}get canAcceptTea(){return this._cup.canAcceptTea&&this._state!=_.STATE_DRINKING}get Cup(){return this._cup}get teacupBounds(){return this._cup.getTransformedBounds()}get teacupGlobalPos(){return this._cup.localToGlobal(0,0)}get teacupLevel(){return this._cup.teaLevel}get State(){return this._state}registerTalkingCheck(e){this._getTalkingCharacter=e}stopTalking(){this._activeVO.stop(),this._activeVO.destroy(),this._activeVO=null,this._mouthArmature.animation.gotoAndPlay("idle"),this.dispatchEvent(new createjs.Event(_.FINISH_TALKING,!1,!1))}playFavorite(e=!1){this._state!=_.STATE_EATING&&this._state!=_.STATE_DRINKING&&null==this._getTalkingCharacter()&&(this.playAnimation(a.ArrayUtils.randomItem(this._rigData.animations.dialog),this.gotoIdle),0==e?this.sayLine(this._rigData.VO.favorite):this.sayLine("Daniel_trolleyTeaPot"))}fillCup(e){this._cup.fillOverTime(e),0==this._cup.canAcceptTea&&this._state!=_.STATE_EATING&&this._state!=_.STATE_DRINKING&&null==this._getTalkingCharacter()&&(this.playAnimation(this._rigData.animations.thanks,this.gotoIdle),this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.thanks)))}canAcceptSnack(e,t){let s=this.display.globalToLocal(e,t);if(this.display.hitTest(s.x,s.y)){let s=this._cup.globalToLocal(e,t);if(this._cup.hitTest(s.x,s.y))return!1;let i=this._plate.globalToLocal(e,t);return this._plate.hitTest(i.x,i.y),this._snack.snackLevel>0?(this._state==_.STATE_IDLE&&null==this._getTalkingCharacter()&&(this.playAnimation(this._rigData.animations.fullSnack,this.gotoIdle),this.sayLine(this._rigData.VO.fullSnack)),!1):this._state!=_.STATE_EATING&&(this._snack.refill(),this._state==_.STATE_IDLE&&null==this._getTalkingCharacter()&&(this.playAnimation(this._rigData.animations.thanks,this.gotoIdle),this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.thanks))),!0)}return!1}handleAnimationEvent(e){super.handleAnimationEvent(e);let t=e.split("event_")[1];"cupTip"==t?(this._cup.setState(o.TeaCup.CUP_TIPPED),this._cup.changeTeaLevelBy(-.3)):"cupNormal"==t?this._cup.setState(o.TeaCup.CUP_STRAIGHT):"bite"==t?(this._snack.eat(),createjs.Sound.play(this._rigData.VO.eat[this._snack.type])):"sip"==t&&createjs.Sound.play(this._rigData.VO.sip)}sayNoThanksToMoreTea(){this._state==_.STATE_IDLE&&null==this._getTalkingCharacter()&&(this.playAnimation(this._rigData.animations.fullSnack,this.gotoIdle),this.sayLine(this._rigData.VO.fullSnack))}GetSipSound(){return this._rigData.VO.sip}GetBiteSound(){return this._rigData.VO.eat[this._snack.type]}handleVOEvent(e){this.sayLine(e.split("vo_")[1])}handleSFXEvent(e){}sayLine(e){this._activeVO=this.playVO2(e),null!=this._activeVO?(this._activeVO.addEventListener("complete",this.onVOComplete),this._mouthArmature.animation.gotoAndPlay("talking"),this._state=_.STATE_TALKING,this.dispatchEvent(new createjs.Event(_.START_TALKING,!1,!1))):console.warn("Attempt to speak line ("+e+") failed.")}sayMoreTeaNeighbor(){this.playAnimation(a.ArrayUtils.randomItem(this._rigData.animations.dialog),this.gotoIdle),this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.moreTeaNeighbor))}playGreeting(e=!1){this.playAnimation(a.ArrayUtils.randomItem(this._rigData.animations.dialog),this.gotoIdle),0==e?this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.greeting)):this.sayLine(a.ArrayUtils.randomItem(this._rigData.VO.interests))}playAnimation(e,t){return this.armature.removeAllEventListeners(),this.armature.addEventListener("boneFrameEvent",this.onBoneFrameEvent),null!=t&&this.armature.addEventListener("complete",t),this.armature.animation.gotoAndPlay(e)}addPlate(e){this._plate=e;let t=this.armature.getBones();for(let s=0;s<t.length;s++)if(t[s].name.toLowerCase().includes("plate")){t[s].slot.setDisplay(e);break}}addTeaCup(e){this._cup=e;let t=this.armature.getBones();for(let s=0;s<t.length;s++)if(t[s].name.toLowerCase().includes("cup")){t[s].slot.setDisplay(e);break}}addSnack(e){this._snack=e;let t=this.armature.getBones();for(let s=0;s<t.length;s++)if(t[s].name.toLowerCase().includes("snack")){t[s].slot.setDisplay(e);break}}addTablecloth(e){this._tablecloth=e,this._tableclothBone.slot.setDisplay(this._tablecloth)}setTeasetStyleTo(e){this._plate.setToStyle(e),this._cup.setToStyle(e)}setTableStyleTo(e){this._tablecloth.setToStyle(e)}setSnackStyleTo(e){this._snack.changeToType(e)}}t.TeaPartyCharacter=_,_.STATE_DRINKING="stateDrinking",_.STATE_EATING="stateEating",_.STATE_IDLE="stateIdle",_.STATE_TALKING="stateTalking",_.START_TALKING="startTalking",_.FINISH_TALKING="finishTalking"}});