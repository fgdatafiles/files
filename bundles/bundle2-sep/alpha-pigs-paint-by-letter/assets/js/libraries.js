/*!
* @license PreloadJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011-2015 gskinner.com, inc.
*
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
*/
this.createjs=this.createjs||{},function(){"use strict";var t=createjs.PreloadJS=createjs.PreloadJS||{};t.version="0.6.3",t.buildDate="Tue, 15 Sep 2015 20:59:37 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(t,e){"use strict";function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},createjs.promote=function(t,e){"use strict";var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var s in i[(e+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(s)&&"function"==typeof n[s]&&(i[e+s]=n[s]);return t},this.createjs=this.createjs||{},createjs.indexOf=function(t,e){"use strict";for(var i=0,n=t.length;n>i;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){"use strict";createjs.proxy=function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(i))}}}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"BrowserDetect cannot be instantiated"}var e=t.agent=window.navigator.userAgent;t.isWindowPhone=e.indexOf("IEMobile")>-1||e.indexOf("Windows Phone")>-1,t.isFirefox=e.indexOf("Firefox")>-1,t.isOpera=null!=window.opera,t.isChrome=e.indexOf("Chrome")>-1,t.isIOS=(e.indexOf("iPod")>-1||e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&!t.isWindowPhone,t.isAndroid=e.indexOf("Android")>-1&&!t.isWindowPhone,t.isBlackberry=e.indexOf("Blackberry")>-1,createjs.BrowserDetect=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.Event_constructor("error"),this.title=t,this.message=e,this.data=i}createjs.extend(t,createjs.Event).clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n,s=(n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{})[t];return s&&this.removeEventListener(t,e,i),(s=n[t])?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,r){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,(function(t){e.call(i,t,s),n&&t.remove()}),r)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var r=0,o=s.length;o>r;r++)if(s[r]==e){1==o?delete n[t]:s.splice(r,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t){if("string"==typeof t){var e=this._listeners;if(!e||!e[t])return!1;t=new createjs.Event(t)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(t){}if(t.bubbles&&this.parent){for(var i=this,n=[i];i.parent;)n.push(i=i.parent);var s,r=n.length;for(s=r-1;s>=0&&!t.propagationStopped;s--)n[s]._dispatchEvent(t,1+(0==s));for(s=1;r>s&&!t.propagationStopped;s++)n[s]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n=1==e?this._captureListeners:this._listeners;if(t&&n){var s=n[t.type];if(!s||!(i=s.length))return;try{t.currentTarget=this}catch(t){}try{t.eventPhase=e}catch(t){}t.removed=!1,s=s.slice();for(var r=0;i>r&&!t.immediatePropagationStopped;r++){var o=s[r];o.handleEvent?o.handleEvent(t):o(t),t.removed&&(this.off(t.type,o,1==e),t.removed=!1)}}},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(t){"use strict";function e(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}createjs.extend(e,createjs.Event).clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(e,"Event")}(window),function(){function t(e,n){function r(t){if(r[t]!==v)return r[t];var e;if("bug-string-char-index"==t)e="a"!="a"[0];else if("json"==t)e=r("json-stringify")&&r("json-parse");else{var i,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var h=n.stringify,u="function"==typeof h&&_;if(u){(i=function(){return 1}).toJSON=i;try{u="0"===h(0)&&"0"===h(new o)&&'""'==h(new a)&&h(y)===v&&h(v)===v&&h()===v&&"1"===h(i)&&"[1]"==h([i])&&"[null]"==h([v])&&"null"==h(null)&&"[null,null,null]"==h([v,y,null])&&h({a:[i,!0,!1,null,"\0\b\n\f\r\t"]})==s&&"1"===h(null,i)&&"[\n 1,\n 2\n]"==h([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==h(new l(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==h(new l(864e13))&&'"-000001-01-01T00:00:00.000Z"'==h(new l(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==h(new l(-1))}catch(t){u=!1}}e=u}if("json-parse"==t){var c=n.parse;if("function"==typeof c)try{if(0===c("0")&&!c(!1)){var d=5==(i=c(s)).a.length&&1===i.a[0];if(d){try{d=!c('"\t"')}catch(t){}if(d)try{d=1!==c("01")}catch(t){}if(d)try{d=1!==c("1.")}catch(t){}}}}catch(t){d=!1}e=d}}return r[t]=!!e}e||(e=s.Object()),n||(n=s.Object());var o=e.Number||s.Number,a=e.String||s.String,h=e.Object||s.Object,l=e.Date||s.Date,u=e.SyntaxError||s.SyntaxError,c=e.TypeError||s.TypeError,d=e.Math||s.Math,p=e.JSON||s.JSON;"object"==typeof p&&p&&(n.stringify=p.stringify,n.parse=p.parse);var f,g,v,m=h.prototype,y=m.toString,_=new l(-0xc782b5b800cec);try{_=-109252==_.getUTCFullYear()&&0===_.getUTCMonth()&&1===_.getUTCDate()&&10==_.getUTCHours()&&37==_.getUTCMinutes()&&6==_.getUTCSeconds()&&708==_.getUTCMilliseconds()}catch(t){}if(!r("json")){var b="[object Function]",w="[object Number]",x="[object String]",T="[object Array]",E=r("bug-string-char-index");if(!_)var S=d.floor,A=[0,31,59,90,120,151,181,212,243,273,304,334],P=function(t,e){return A[e]+365*(t-1970)+S((t-1969+(e=+(e>1)))/4)-S((t-1901+e)/100)+S((t-1601+e)/400)};if((f=m.hasOwnProperty)||(f=function(t){var e,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=y?f=function(t){var e=this.__proto__,i=t in(this.__proto__=null,this);return this.__proto__=e,i}:(e=i.constructor,f=function(t){var i=(this.constructor||e).prototype;return t in this&&!(t in i&&this[t]===i[t])}),i=null,f.call(this,t)}),g=function(t,e){var n,s,r,o=0;for(r in(n=function(){this.valueOf=0}).prototype.valueOf=0,s=new n)f.call(s,r)&&o++;return n=s=null,o?g=2==o?function(t,e){var i,n={},s=y.call(t)==b;for(i in t)s&&"prototype"==i||f.call(n,i)||!(n[i]=1)||!f.call(t,i)||e(i)}:function(t,e){var i,n,s=y.call(t)==b;for(i in t)s&&"prototype"==i||!f.call(t,i)||(n="constructor"===i)||e(i);(n||f.call(t,i="constructor"))&&e(i)}:(s=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],g=function(t,e){var n,r,o=y.call(t)==b,a=!o&&"function"!=typeof t.constructor&&i[typeof t.hasOwnProperty]&&t.hasOwnProperty||f;for(n in t)o&&"prototype"==n||!a.call(t,n)||e(n);for(r=s.length;n=s[--r];a.call(t,n)&&e(n));}),g(t,e)},!r("json-stringify")){var C={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},M=function(t,e){return("000000"+(e||0)).slice(-t)},L=function(t){for(var e='"',i=0,n=t.length,s=!E||n>10,r=s&&(E?t.split(""):t);n>i;i++){var o=t.charCodeAt(i);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=C[o];break;default:if(32>o){e+="\\u00"+M(2,o.toString(16));break}e+=s?r[i]:t.charAt(i)}}return e+'"'},O=function(t,e,i,n,s,r,o){var a,h,l,u,d,p,m,_,b,E,A,C,R,I,D,k;try{a=e[t]}catch(t){}if("object"==typeof a&&a)if("[object Date]"!=(h=y.call(a))||f.call(a,"toJSON"))"function"==typeof a.toJSON&&(h!=w&&h!=x&&h!=T||f.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&1/0>a){if(P){for(d=S(a/864e5),l=S(d/365.2425)+1970-1;P(l+1,0)<=d;l++);for(u=S((d-P(l,0))/30.42);P(l,u+1)<=d;u++);d=1+d-P(l,u),m=S((p=(a%864e5+864e5)%864e5)/36e5)%24,_=S(p/6e4)%60,b=S(p/1e3)%60,E=p%1e3}else l=a.getUTCFullYear(),u=a.getUTCMonth(),d=a.getUTCDate(),m=a.getUTCHours(),_=a.getUTCMinutes(),b=a.getUTCSeconds(),E=a.getUTCMilliseconds();a=(0>=l||l>=1e4?(0>l?"-":"+")+M(6,0>l?-l:l):M(4,l))+"-"+M(2,u+1)+"-"+M(2,d)+"T"+M(2,m)+":"+M(2,_)+":"+M(2,b)+"."+M(3,E)+"Z"}else a=null;if(i&&(a=i.call(e,t,a)),null===a)return"null";if("[object Boolean]"==(h=y.call(a)))return""+a;if(h==w)return a>-1/0&&1/0>a?""+a:"null";if(h==x)return L(""+a);if("object"==typeof a){for(I=o.length;I--;)if(o[I]===a)throw c();if(o.push(a),A=[],D=r,r+=s,h==T){for(R=0,I=a.length;I>R;R++)C=O(R,a,i,n,s,r,o),A.push(C===v?"null":C);k=A.length?s?"[\n"+r+A.join(",\n"+r)+"\n"+D+"]":"["+A.join(",")+"]":"[]"}else g(n||a,(function(t){var e=O(t,a,i,n,s,r,o);e!==v&&A.push(L(t)+":"+(s?" ":"")+e)})),k=A.length?s?"{\n"+r+A.join(",\n"+r)+"\n"+D+"}":"{"+A.join(",")+"}":"{}";return o.pop(),k}};n.stringify=function(t,e,n){var s,r,o,a;if(i[typeof e]&&e)if((a=y.call(e))==b)r=e;else if(a==T){o={};for(var h,l=0,u=e.length;u>l;h=e[l++],((a=y.call(h))==x||a==w)&&(o[h]=1));}if(n)if((a=y.call(n))==w){if((n-=n%1)>0)for(s="",n>10&&(n=10);s.length<n;s+=" ");}else a==x&&(s=n.length<=10?n:n.slice(0,10));return O("",((h={})[""]=t,h),r,o,s,"",[])}}if(!r("json-parse")){var R,I,D=a.fromCharCode,k={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},j=function(){throw R=I=null,u()},B=function(){for(var t,e,i,n,s,r=I,o=r.length;o>R;)switch(s=r.charCodeAt(R)){case 9:case 10:case 13:case 32:R++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=E?r.charAt(R):r[R],R++,t;case 34:for(t="@",R++;o>R;)if(32>(s=r.charCodeAt(R)))j();else if(92==s)switch(s=r.charCodeAt(++R)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=k[s],R++;break;case 117:for(e=++R,i=R+4;i>R;R++)(s=r.charCodeAt(R))>=48&&57>=s||s>=97&&102>=s||s>=65&&70>=s||j();t+=D("0x"+r.slice(e,R));break;default:j()}else{if(34==s)break;for(s=r.charCodeAt(R),e=R;s>=32&&92!=s&&34!=s;)s=r.charCodeAt(++R);t+=r.slice(e,R)}if(34==r.charCodeAt(R))return R++,t;j();default:if(e=R,45==s&&(n=!0,s=r.charCodeAt(++R)),s>=48&&57>=s){for(48==s&&((s=r.charCodeAt(R+1))>=48&&57>=s)&&j(),n=!1;o>R&&((s=r.charCodeAt(R))>=48&&57>=s);R++);if(46==r.charCodeAt(R)){for(i=++R;o>i&&((s=r.charCodeAt(i))>=48&&57>=s);i++);i==R&&j(),R=i}if(101==(s=r.charCodeAt(R))||69==s){for((43==(s=r.charCodeAt(++R))||45==s)&&R++,i=R;o>i&&((s=r.charCodeAt(i))>=48&&57>=s);i++);i==R&&j(),R=i}return+r.slice(e,R)}if(n&&j(),"true"==r.slice(R,R+4))return R+=4,!0;if("false"==r.slice(R,R+5))return R+=5,!1;if("null"==r.slice(R,R+4))return R+=4,null;j()}return"$"},F=function(t){var e,i;if("$"==t&&j(),"string"==typeof t){if("@"==(E?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];"]"!=(t=B());i||(i=!0))i&&(","==t?"]"==(t=B())&&j():j()),","==t&&j(),e.push(F(t));return e}if("{"==t){for(e={};"}"!=(t=B());i||(i=!0))i&&(","==t?"}"==(t=B())&&j():j()),(","==t||"string"!=typeof t||"@"!=(E?t.charAt(0):t[0])||":"!=B())&&j(),e[t.slice(1)]=F(B());return e}j()}return t},N=function(t,e,i){var n=U(t,e,i);n===v?delete t[e]:t[e]=n},U=function(t,e,i){var n,s=t[e];if("object"==typeof s&&s)if(y.call(s)==T)for(n=s.length;n--;)N(s,n,i);else g(s,(function(t){N(s,t,i)}));return i.call(t,e,s)};n.parse=function(t,e){var i,n;return R=0,I=""+t,i=F(B()),"$"!=B()&&j(),R=I=null,e&&y.call(e)==b?U(((n={})[""]=i,n),"",e):i}}}return n.runInContext=t,n}var e="function"==typeof define&&define.amd,i={function:!0,object:!0},n=i[typeof exports]&&exports&&!exports.nodeType&&exports,s=i[typeof window]&&window||this,r=n&&i[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(!r||r.global!==r&&r.window!==r&&r.self!==r||(s=r),n&&!e)t(s,n);else{var o=s.JSON,a=s.JSON3,h=!1,l=t(s,s.JSON3={noConflict:function(){return h||(h=!0,s.JSON=o,s.JSON3=a,o=a=null),l}});s.JSON={parse:l.parse,stringify:l.stringify}}e&&define((function(){return l}))}.call(this),function(){var t={appendToHead:function(e){t.getHead().appendChild(e)},getHead:function(){return document.head||document.getElementsByTagName("head")[0]},getBody:function(){return document.body||document.getElementsByTagName("body")[0]}};createjs.DomUtils=t}(),function(){var t={parseXML:function(t,e){var i=null;try{if(window.DOMParser)i=(new DOMParser).parseFromString(t,e)}catch(t){}if(!i)try{(i=new ActiveXObject("Microsoft.XMLDOM")).async=!1,i.loadXML(t)}catch(t){i=null}return i},parseJSON:function(t){if(null==t)return null;try{return JSON.parse(t)}catch(t){throw t}}};createjs.DataUtils=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=i.LOAD_TIMEOUT_DEFAULT}var e=t.prototype={},i=t;i.LOAD_TIMEOUT_DEFAULT=8e3,i.create=function(e){if("string"==typeof e){var n=new t;return n.src=e,n}if(e instanceof i)return e;if(e instanceof Object&&e.src)return null==e.loadTimeout&&(e.loadTimeout=i.LOAD_TIMEOUT_DEFAULT),e;throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},createjs.LoadItem=i}(),function(){var t={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[./]*?\//i,EXTENSION_PATT:/\/?[^/]+\.(\w{1,5})$/i,parseURI:function(e){var i={absolute:!1,relative:!1};if(null==e)return i;var n,s=e.indexOf("?");return s>-1&&(e=e.substr(0,s)),t.ABSOLUTE_PATT.test(e)?i.absolute=!0:t.RELATIVE_PATT.test(e)&&(i.relative=!0),(n=e.match(t.EXTENSION_PATT))&&(i.extension=n[1].toLowerCase()),i},formatQueryString:function(t,e){if(null==t)throw new Error("You must specify data.");var i=[];for(var n in t)i.push(n+"="+escape(t[n]));return e&&(i=i.concat(e)),i.join("&")},buildPath:function(t,e){if(null==e)return t;var i=[],n=t.indexOf("?");if(-1!=n){var s=t.slice(n+1);i=i.concat(s.split("&"))}return-1!=n?t.slice(0,n)+"?"+this._formatQueryString(e,i):t+"?"+this._formatQueryString(e,i)},isCrossDomain:function(t){var e=document.createElement("a");e.href=t.src;var i=document.createElement("a");return i.href=location.href,""!=e.hostname&&(e.port!=i.port||e.protocol!=i.protocol||e.hostname!=i.hostname)},isLocal:function(t){var e=document.createElement("a");return e.href=t.src,""==e.hostname&&"file:"==e.protocol},isBinary:function(t){switch(t){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},isImageTag:function(t){return t instanceof HTMLImageElement},isAudioTag:function(t){return!!window.HTMLAudioElement&&t instanceof HTMLAudioElement},isVideoTag:function(t){return!!window.HTMLVideoElement&&t instanceof HTMLVideoElement},isText:function(t){switch(t){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:case createjs.AbstractLoader.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(t){if(null==t)return createjs.AbstractLoader.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}}};createjs.RequestUtils=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=t?createjs.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var e=createjs.extend(t,createjs.EventDispatcher),i=t;i.POST="POST",i.GET="GET",i.BINARY="binary",i.CSS="css",i.IMAGE="image",i.JAVASCRIPT="javascript",i.JSON="json",i.JSONP="jsonp",i.MANIFEST="manifest",i.SOUND="sound",i.VIDEO="video",i.SPRITESHEET="spritesheet",i.SVG="svg",i.TEXT="text",i.XML="xml",e.getItem=function(){return this._item},e.getResult=function(t){return t?this._rawResult:this._result},e.getTag=function(){return this._tag},e.setTag=function(t){this._tag=t},e.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new createjs.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},e.cancel=function(){this.canceled=!0,this.destroy()},e.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},e.getLoadedItems=function(){return this._loadedItems},e._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._createTag=function(t){return null},e._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},e._sendProgress=function(t){if(!this._isCanceled()){var e=null;"number"==typeof t?(this.progress=t,e=new createjs.ProgressEvent(this.progress)):(e=t,this.progress=t.loaded/t.total,e.progress=this.progress,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e)}},e._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var t=new createjs.Event("complete");t.rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t)}},e._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},e._isCanceled=function(){return!(null!=window.createjs&&!this.canceled)},e.resultFormatter=null,e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this),i=this;e instanceof Function?e((function(t){i._result=t,i._sendComplete()})):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_"+t.type.toUpperCase()+"_ERROR"))}},e.buildPath=function(t,e){return createjs.RequestUtils.buildPath(t,e)},e.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src"}var e=createjs.extend(t,createjs.AbstractLoader);e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._formatResult=function(t){return this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(t.getTag().src=t.getResult(!0)),t.getTag()},createjs.AbstractMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";var t=function(t){this._item=t},e=createjs.extend(t,createjs.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},createjs.AbstractRequest=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var e=createjs.extend(t,createjs.AbstractRequest);e.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var t=new createjs.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._hideTag(),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0)},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleError=function(){this._clean(),this.dispatchEvent("error")},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},e._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},e._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},e._showTag=function(){this._tag.style.visibility=this._startTagVisibility},e._handleStalled=function(){},createjs.TagRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var e=createjs.extend(t,createjs.TagRequest);e.load=function(){var t=createjs.proxy(this._handleStalled,this);this._stalledCallback=t;var e=createjs.proxy(this._handleProgress,this);this._handleProgress=e,this._tag.addEventListener("stalled",t),this._tag.addEventListener("progress",e),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),this._createXHR(t)}var e=createjs.extend(t,createjs.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},e.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},e.load=function(){if(null!=this._request){null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,t))}}else this._handleError()},e.setResponseType=function(t){"blob"===t&&(t=window.URL?"blob":"arraybuffer",this._responseType=t),this._request.responseType=t},e.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},e.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._handleLoadStart=function(t){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},e._handleAbort=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,t))},e._handleError=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(t.message))},e._handleReadyStateChange=function(t){4==this._request.readyState&&this._handleLoad()},e._handleLoad=function(t){if(!this.loaded){this.loaded=!0;var e=this._checkError();if(e)return void this._handleError(e);if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(t){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===t.name&&window.BlobBuilder){var i=new BlobBuilder;i.append(this._response),this._response=i.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},e._handleTimeout=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,t))},e._checkError=function(){var t=parseInt(this._request.status);switch(t){case 404:return new Error(t);case 0:return this._getResponse()?null:new Error(t)}return null},e._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},e._createXHR=function(t){var e=createjs.RequestUtils.isCrossDomain(t),i={},n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest,e&&void 0===n.withCredentials&&window.XDomainRequest&&(n=new XDomainRequest);else{for(var r=0,o=s.ACTIVEX_VERSIONS.length;o>r;r++){var a=s.ACTIVEX_VERSIONS[r];try{n=new ActiveXObject(a);break}catch(t){}}if(null==n)return!1}null==t.mimeType&&createjs.RequestUtils.isText(t.type)&&(t.mimeType="text/plain; charset=utf-8"),t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType),this._xhrLevel="string"==typeof n.responseType?2:1;var h;if(h=t.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(t.src,t.values):t.src,n.open(t.method||createjs.AbstractLoader.GET,h,!0),e&&n instanceof XMLHttpRequest&&1==this._xhrLevel&&(i.Origin=location.origin),t.values&&t.method==createjs.AbstractLoader.POST&&(i["Content-Type"]="application/x-www-form-urlencoded"),e||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var l in t.headers)i[l]=t.headers[l];for(l in i)n.setRequestHeader(l,i[l]);return n instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(n.withCredentials=t.withCredentials),this._request=n,!0},e._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},e.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[createjs.ImageLoader,createjs.JavaScriptLoader,createjs.CSSLoader,createjs.JSONLoader,createjs.JSONPLoader,createjs.SoundLoader,createjs.ManifestLoader,createjs.SpriteSheetLoader,createjs.XMLLoader,createjs.SVGLoader,createjs.BinaryLoader,createjs.VideoLoader,createjs.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(t,e,i)}var e=createjs.extend(t,createjs.AbstractLoader),i=t;e.init=function(t,e,i){this.useXHR=!0,this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(t),this._paused=!1,this._basePath=e,this._crossOrigin=i,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=NaN},i.loadTimeout=8e3,i.LOAD_TIMEOUT=0,i.BINARY=createjs.AbstractLoader.BINARY,i.CSS=createjs.AbstractLoader.CSS,i.IMAGE=createjs.AbstractLoader.IMAGE,i.JAVASCRIPT=createjs.AbstractLoader.JAVASCRIPT,i.JSON=createjs.AbstractLoader.JSON,i.JSONP=createjs.AbstractLoader.JSONP,i.MANIFEST=createjs.AbstractLoader.MANIFEST,i.SOUND=createjs.AbstractLoader.SOUND,i.VIDEO=createjs.AbstractLoader.VIDEO,i.SVG=createjs.AbstractLoader.SVG,i.TEXT=createjs.AbstractLoader.TEXT,i.XML=createjs.AbstractLoader.XML,i.POST=createjs.AbstractLoader.POST,i.GET=createjs.AbstractLoader.GET,e.registerLoader=function(t){if(!t||!t.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(t))throw new Error("loader already exists.");this._availableLoaders.unshift(t)},e.unregisterLoader=function(t){var e=this._availableLoaders.indexOf(t);-1!=e&&e<this._defaultLoaderLength-1&&this._availableLoaders.splice(e,1)},e.setUseXHR=function(t){return this.setPreferXHR(t)},e.setPreferXHR=function(t){return this.preferXHR=0!=t&&null!=window.XMLHttpRequest,this.preferXHR},e.removeAll=function(){this.remove()},e.remove=function(t){var e=null;if(!t||t instanceof Array){if(t)e=t;else if(arguments.length>0)return}else e=[t];var i=!1;if(e){for(;e.length;){var n=e.pop(),s=this.getResult(n);for(r=this._loadQueue.length-1;r>=0;r--)if((o=this._loadQueue[r].getItem()).id==n||o.src==n){this._loadQueue.splice(r,1)[0].cancel();break}for(r=this._loadQueueBackup.length-1;r>=0;r--)if((o=this._loadQueueBackup[r].getItem()).id==n||o.src==n){this._loadQueueBackup.splice(r,1)[0].cancel();break}if(s)this._disposeItem(this.getItem(n));else for(var r=this._currentLoads.length-1;r>=0;r--){var o=this._currentLoads[r].getItem();if(o.id==n||o.src==n){this._currentLoads.splice(r,1)[0].cancel(),i=!0;break}}}i&&this._loadNext()}else{for(var a in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[a]);this.init(this.preferXHR,this._basePath,this._crossOrigin)}},e.reset=function(){for(var t in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[t]);for(var e=[],i=0,n=this._loadQueueBackup.length;n>i;i++)e.push(this._loadQueueBackup[i].getItem());this.loadManifest(e,!1)},e.installPlugin=function(t){if(null!=t&&null!=t.getPreloadHandlers){this._plugins.push(t);var e=t.getPreloadHandlers();if(e.scope=t,null!=e.types)for(var i=0,n=e.types.length;n>i;i++)this._typeCallbacks[e.types[i]]=e;if(null!=e.extensions)for(i=0,n=e.extensions.length;n>i;i++)this._extensionCallbacks[e.extensions[i]]=e}},e.setMaxConnections=function(t){this._maxConnections=t,!this._paused&&this._loadQueue.length>0&&this._loadNext()},e.loadFile=function(t,e,i){if(null!=t)this._addItem(t,null,i),!1!==e?this.setPaused(!1):this.setPaused(!0);else{var n=new createjs.ErrorEvent("PRELOAD_NO_FILE");this._sendError(n)}},e.loadManifest=function(t,e,n){var s=null,r=null;if(t instanceof Array){if(0==t.length){var o=new createjs.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(o)}s=t}else if("string"==typeof t)s=[{src:t,type:i.MANIFEST}];else{if("object"!=typeof t){o=new createjs.ErrorEvent("PRELOAD_MANIFEST_NULL");return void this._sendError(o)}if(void 0!==t.src){if(null==t.type)t.type=i.MANIFEST;else if(t.type!=i.MANIFEST){o=new createjs.ErrorEvent("PRELOAD_MANIFEST_TYPE");this._sendError(o)}s=[t]}else void 0!==t.manifest&&(s=t.manifest,r=t.path)}for(var a=0,h=s.length;h>a;a++)this._addItem(s[a],r,n);!1!==e?this.setPaused(!1):this.setPaused(!0)},e.load=function(){this.setPaused(!1)},e.getItem=function(t){return this._loadItemsById[t]||this._loadItemsBySrc[t]},e.getResult=function(t,e){var i=this._loadItemsById[t]||this._loadItemsBySrc[t];if(null==i)return null;var n=i.id;return e&&this._loadedRawResults[n]?this._loadedRawResults[n]:this._loadedResults[n]},e.getItems=function(t){var e=[];for(var i in this._loadItemsById){var n=this._loadItemsById[i],s=this.getResult(i);(!0!==t||null!=s)&&e.push({item:n,result:s,rawResult:this.getResult(i,!0)})}return e},e.setPaused=function(t){this._paused=t,this._paused||this._loadNext()},e.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=NaN},e._addItem=function(t,e,i){var n=this._createLoadItem(t,e,i);if(null!=n){var s=this._createLoader(n);null!=s&&("plugins"in s&&(s.plugins=this._plugins),n._loader=s,this._loadQueue.push(s),this._loadQueueBackup.push(s),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&n.type==createjs.LoadQueue.JAVASCRIPT||!0===n.maintainOrder)&&(this._scriptOrder.push(n),this._loadedScripts.push(null)))}},e._createLoadItem=function(t,e,i){var n=createjs.LoadItem.create(t);if(null==n)return null;var s="",r=i||this._basePath;if(n.src instanceof Object){if(!n.type)return null;if(e){s=e;var o=createjs.RequestUtils.parseURI(e);null==r||o.absolute||o.relative||(s=r+s)}else null!=r&&(s=r)}else{var a=createjs.RequestUtils.parseURI(n.src);a.extension&&(n.ext=a.extension),null==n.type&&(!n.ext&&window.console&&console.error("unable to get extension for "+n.src),n.type=createjs.RequestUtils.getTypeByExtension(n.ext));var h=n.src;if(!a.absolute&&!a.relative)if(e){s=e;o=createjs.RequestUtils.parseURI(e);h=e+h,null==r||o.absolute||o.relative||(s=r+s)}else null!=r&&(s=r);n.src=s+n.src}n.path=s,(void 0===n.id||null===n.id||""===n.id)&&(n.id=h);var l=this._typeCallbacks[n.type]||this._extensionCallbacks[n.ext];if(l){var u=l.callback.call(l.scope,n,this);if(!1===u)return null;!0===u||null!=u&&(n._loader=u),null!=(a=createjs.RequestUtils.parseURI(n.src)).extension&&(n.ext=a.extension)}return this._loadItemsById[n.id]=n,this._loadItemsBySrc[n.src]=n,null==n.crossOrigin&&(n.crossOrigin=this._crossOrigin),n},e._createLoader=function(t){if(null!=t._loader)return t._loader;for(var e=this.preferXHR,i=0;i<this._availableLoaders.length;i++){var n=this._availableLoaders[i];if(n&&n.canLoadItem(t))return new n(t,e)}return null},e._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var t=0;t<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);t++){var e=this._loadQueue[t];this._canStartLoad(e)&&(this._loadQueue.splice(t,1),t--,this._loadItem(e))}}},e._loadItem=function(t){t.on("fileload",this._handleFileLoad,this),t.on("progress",this._handleProgress,this),t.on("complete",this._handleFileComplete,this),t.on("error",this._handleError,this),t.on("fileerror",this._handleFileError,this),this._currentLoads.push(t),this._sendFileStart(t.getItem()),t.load()},e._handleFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleFileError=function(t){var e=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,t.item);this._sendError(e)},e._handleError=function(t){var e=t.target;this._numItemsLoaded++,this._finishOrderedItem(e,!0),this._updateProgress();var i=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,e.getItem());this._sendError(i),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(e),this._cleanLoadItem(e),this._loadNext())},e._handleFileComplete=function(t){var e=t.target,i=e.getItem(),n=e.getResult();this._loadedResults[i.id]=n;var s=e.getResult(!0);null!=s&&s!==n&&(this._loadedRawResults[i.id]=s),this._saveLoadedItems(e),this._removeLoadItem(e),this._finishOrderedItem(e)||this._processFinishedLoad(i,e),this._cleanLoadItem(e)},e._saveLoadedItems=function(t){var e=t.getLoadedItems();if(null!==e)for(var i=0;i<e.length;i++){var n=e[i].item;this._loadItemsBySrc[n.src]=n,this._loadItemsById[n.id]=n,this._loadedResults[n.id]=e[i].result,this._loadedRawResults[n.id]=e[i].rawResult}},e._finishOrderedItem=function(t,e){var i=t.getItem();if(this.maintainScriptOrder&&i.type==createjs.LoadQueue.JAVASCRIPT||i.maintainOrder){t instanceof createjs.JavaScriptLoader&&(this._currentlyLoadingScript=!1);var n=createjs.indexOf(this._scriptOrder,i);return-1!=n&&(this._loadedScripts[n]=!0===e||i,this._checkScriptLoadOrder(),!0)}return!1},e._checkScriptLoadOrder=function(){for(var t=this._loadedScripts.length,e=0;t>e;e++){var i=this._loadedScripts[e];if(null==i)break;if(!0!==i){var n=this._loadedResults[i.id];i.type==createjs.LoadQueue.JAVASCRIPT&&createjs.DomUtils.appendToHead(n);var s=i._loader;this._processFinishedLoad(i,s),this._loadedScripts[e]=!0}}},e._processFinishedLoad=function(t,e){if(this._numItemsLoaded++,!this.maintainScriptOrder&&t.type==createjs.LoadQueue.JAVASCRIPT){var i=e.getTag();createjs.DomUtils.appendToHead(i)}this._updateProgress(),this._sendFileComplete(t,e),this._loadNext()},e._canStartLoad=function(t){if(!this.maintainScriptOrder||t.preferXHR)return!0;var e=t.getItem();if(e.type!=createjs.LoadQueue.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;for(var i=this._scriptOrder.indexOf(e),n=0;i>n;){if(null==this._loadedScripts[n])return!1;n++}return this._currentlyLoadingScript=!0,!0},e._removeLoadItem=function(t){for(var e=this._currentLoads.length,i=0;e>i;i++)if(this._currentLoads[i]==t){this._currentLoads.splice(i,1);break}},e._cleanLoadItem=function(t){var e=t.getItem();e&&delete e._loader},e._handleProgress=function(t){var e=t.target;this._sendFileProgress(e.getItem(),e.progress),this._updateProgress()},e._updateProgress=function(){var t=this._numItemsLoaded/this._numItems,e=this._numItems-this._numItemsLoaded;if(e>0){for(var i=0,n=0,s=this._currentLoads.length;s>n;n++)i+=this._currentLoads[n].progress;t+=i/e*(e/this._numItems)}this._lastProgress!=t&&(this._sendProgress(t),this._lastProgress=t)},e._disposeItem=function(t){delete this._loadedResults[t.id],delete this._loadedRawResults[t.id],delete this._loadItemsById[t.id],delete this._loadItemsBySrc[t.src]},e._sendFileProgress=function(t,e){if(!this._isCanceled()&&!this._paused&&this.hasEventListener("fileprogress")){var i=new createjs.Event("fileprogress");i.progress=e,i.loaded=e,i.total=1,i.item=t,this.dispatchEvent(i)}},e._sendFileComplete=function(t,e){if(!this._isCanceled()&&!this._paused){var i=new createjs.Event("fileload");i.loader=e,i.item=t,i.result=this._loadedResults[t.id],i.rawResult=this._loadedRawResults[t.id],t.completeHandler&&t.completeHandler(i),this.hasEventListener("fileload")&&this.dispatchEvent(i)}},e._sendFileStart=function(t){var e=new createjs.Event("filestart");e.item=t,this.hasEventListener("filestart")&&this.dispatchEvent(e)},e.toString=function(){return"[PreloadJS LoadQueue]"},createjs.LoadQueue=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.TEXT)}(createjs.extend(t,createjs.AbstractLoader),t).canLoadItem=function(t){return t.type==createjs.AbstractLoader.TEXT},createjs.TextLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.BINARY),this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.BINARY},e._updateXHR=function(t){t.loader.setResponseType("arraybuffer")},createjs.BinaryLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=e?document.createElement("style"):document.createElement("link"),this._tag.rel="stylesheet",this._tag.type="text/css"}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.CSS},e._formatResult=function(t){if(this._preferXHR){var e=t.getTag();if(e.styleSheet)e.styleSheet.cssText=t.getResult(!0);else{var i=document.createTextNode(t.getResult(!0));e.appendChild(i)}}else e=this._tag;return createjs.DomUtils.appendToHead(e),e},createjs.CSSLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",createjs.RequestUtils.isImageTag(t)?this._tag=t:createjs.RequestUtils.isImageTag(t.src)?this._tag=t.src:createjs.RequestUtils.isImageTag(t.tag)&&(this._tag=t.tag),null!=this._tag?this._preferXHR=!1:this._tag=document.createElement("img"),this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.IMAGE},e.load=function(){if(""!=this._tag.src&&this._tag.complete)this._sendComplete();else{var t=this._item.crossOrigin;1==t&&(t="Anonymous"),null==t||createjs.RequestUtils.isLocal(this._item.src)||(this._tag.crossOrigin=t),this.AbstractLoader_load()}},e._updateXHR=function(t){t.loader.mimeType="text/plain; charset=x-user-defined-binary",t.loader.setResponseType&&t.loader.setResponseType("blob")},e._formatResult=function(t){var e=this;return function(i){var n=e._tag,s=window.URL||window.webkitURL;if(e._preferXHR)if(s){var r=s.createObjectURL(t.getResult(!0));r?(n.src=r,n.onload=function(){s.revokeObjectURL(this.src),i(this)}):(n.src=t.getItem().src,n.complete?i(n):n.onload=function(){i(this)})}else n.src=t.getItem().src,n.complete?i(n):n.onload=function(){i(this)}}},createjs.ImageLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(document.createElement("script"))}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JAVASCRIPT},e._formatResult=function(t){var e=t.getTag();return this._preferXHR&&(e.text=t.getResult(!0)),e},createjs.JavaScriptLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.JSON),this.resultFormatter=this._formatResult}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JSON},e._formatResult=function(t){var e=null;try{e=createjs.DataUtils.parseJSON(t.getResult(!0))}catch(t){var i=new createjs.ErrorEvent("JSON_FORMAT",null,t);return this._sendError(i),t}return e},createjs.JSONLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!1,createjs.AbstractLoader.JSONP),this.setTag(document.createElement("script")),this.getTag().type="text/javascript"}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JSONP},e.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},e.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=window[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=createjs.proxy(this._handleLoad,this),window.document.body.appendChild(this._tag),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},e._handleLoad=function(t){this._result=this._rawResult=t,this._sendComplete(),this._dispose()},e._handleTimeout=function(){this._dispose(),this.dispatchEvent(new createjs.ErrorEvent("timeout"))},e._dispose=function(){window.document.body.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},createjs.JSONPLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,null,createjs.AbstractLoader.MANIFEST),this.plugins=null,this._manifestQueue=null}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.MANIFEST_PROGRESS=.25,i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.MANIFEST},e.load=function(){this.AbstractLoader_load()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.MANIFEST_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._loadManifest=function(t){if(t&&t.manifest){var e=this._manifestQueue=new createjs.LoadQueue;e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("complete",this._handleManifestComplete,this,!0),e.on("error",this._handleManifestError,this,!0);for(var i=0,n=this.plugins.length;n>i;i++)e.installPlugin(this.plugins[i]);e.loadManifest(t)}else this._sendComplete()},e._handleManifestFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleManifestComplete=function(t){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.MANIFEST_PROGRESS)+i.MANIFEST_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new createjs.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},createjs.ManifestLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(t)||createjs.RequestUtils.isAudioTag(t.src)?this._tag=t:createjs.RequestUtils.isAudioTag(t.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=createjs.extend(t,createjs.AbstractMediaLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SOUND},e._createTag=function(t){var e=document.createElement("audio");return e.autoplay=!1,e.preload="none",e.src=t,e},createjs.SoundLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.VIDEO),createjs.RequestUtils.isVideoTag(t)||createjs.RequestUtils.isVideoTag(t.src)?(this.setTag(createjs.RequestUtils.isVideoTag(t)?t:t.src),this._preferXHR=!1):this.setTag(this._createTag())}var e=t;createjs.extend(t,createjs.AbstractMediaLoader)._createTag=function(){return document.createElement("video")},e.canLoadItem=function(t){return t.type==createjs.AbstractLoader.VIDEO},createjs.VideoLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,null,createjs.AbstractLoader.SPRITESHEET),this._manifestQueue=null}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.SPRITESHEET_PROGRESS=.25,i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SPRITESHEET},e.destroy=function(){this.AbstractLoader_destroy,this._manifestQueue.close()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.SPRITESHEET_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e._loadManifest=function(t){if(t&&t.images){var e=this._manifestQueue=new createjs.LoadQueue;e.on("complete",this._handleManifestComplete,this,!0),e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("error",this._handleManifestError,this,!0),e.loadManifest(t.images)}},e._handleManifestFileLoad=function(t){var e=t.result;if(null!=e){var i=this.getResult().images,n=i.indexOf(t.item.src);i[n]=e}},e._handleManifestComplete=function(t){this._result=new createjs.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.SPRITESHEET_PROGRESS)+i.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new createjs.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},createjs.SpriteSheetLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",e?this.setTag(document.createElement("svg")):(this.setTag(document.createElement("object")),this.getTag().type="image/svg+xml")}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SVG},e._formatResult=function(t){var e=createjs.DataUtils.parseXML(t.getResult(!0),"text/xml"),i=t.getTag();return!this._preferXHR&&document.body.contains(i)&&document.body.removeChild(i),null!=e.documentElement?(i.appendChild(e.documentElement),i.style.visibility="visible",i):e},createjs.SVGLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.XML),this.resultFormatter=this._formatResult}var e=createjs.extend(t,createjs.AbstractLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.XML},e._formatResult=function(t){return createjs.DataUtils.parseXML(t.getResult(!0),"text/xml")},createjs.XMLLoader=createjs.promote(t,"AbstractLoader")}(),
/*!
* @license TweenJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011-2015 gskinner.com, inc.
*
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
*/
this.createjs=this.createjs||{},createjs.extend=function(t,e){"use strict";function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},createjs.promote=function(t,e){"use strict";var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var s in i[(e+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(s)&&"function"==typeof n[s]&&(i[e+s]=n[s]);return t},this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n,s=(n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{})[t];return s&&this.removeEventListener(t,e,i),(s=n[t])?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,r){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,(function(t){e.call(i,t,s),n&&t.remove()}),r)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var r=0,o=s.length;o>r;r++)if(s[r]==e){1==o?delete n[t]:s.splice(r,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"==typeof t){var n=this._listeners;if(!(e||n&&n[t]))return!0;t=new createjs.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(t){}if(t.bubbles&&this.parent){for(var s=this,r=[s];s.parent;)r.push(s=s.parent);var o,a=r.length;for(o=a-1;o>=0&&!t.propagationStopped;o--)r[o]._dispatchEvent(t,1+(0==o));for(o=1;a>o&&!t.propagationStopped;o++)r[o]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n=1==e?this._captureListeners:this._listeners;if(t&&n){var s=n[t.type];if(!s||!(i=s.length))return;try{t.currentTarget=this}catch(t){}try{t.eventPhase=e}catch(t){}t.removed=!1,s=s.slice();for(var r=0;i>r&&!t.immediatePropagationStopped;r++){var o=s[r];o.handleEvent?o.handleEvent(t):o(t),t.removed&&(this.off(t.type,o,1==e),t.removed=!1)}}},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"Ticker cannot be instantiated."}t.RAF_SYNCHED="synched",t.RAF="raf",t.TIMEOUT="timeout",t.useRAF=!1,t.timingMode=null,t.maxDelta=0,t.paused=!1,t.removeEventListener=null,t.removeAllEventListeners=null,t.dispatchEvent=null,t.hasEventListener=null,t._listeners=null,createjs.EventDispatcher.initialize(t),t._addEventListener=t.addEventListener,t.addEventListener=function(){return!t._inited&&t.init(),t._addEventListener.apply(t,arguments)},t._inited=!1,t._startTime=0,t._pausedTime=0,t._ticks=0,t._pausedTicks=0,t._interval=50,t._lastTime=0,t._times=null,t._tickTimes=null,t._timerId=null,t._raf=!0,t.setInterval=function(e){t._interval=e,t._inited&&t._setupTick()},t.getInterval=function(){return t._interval},t.setFPS=function(e){t.setInterval(1e3/e)},t.getFPS=function(){return 1e3/t._interval};try{Object.defineProperties(t,{interval:{get:t.getInterval,set:t.setInterval},framerate:{get:t.getFPS,set:t.setFPS}})}catch(t){console.log(t)}t.init=function(){t._inited||(t._inited=!0,t._times=[],t._tickTimes=[],t._startTime=t._getTime(),t._times.push(t._lastTime=0),t.interval=t._interval)},t.reset=function(){if(t._raf){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;e&&e(t._timerId)}else clearTimeout(t._timerId);t.removeAllEventListeners("tick"),t._timerId=t._times=t._tickTimes=null,t._startTime=t._lastTime=t._ticks=0,t._inited=!1},t.getMeasuredTickTime=function(e){var i=0,n=t._tickTimes;if(!n||n.length<1)return-1;e=Math.min(n.length,e||0|t.getFPS());for(var s=0;e>s;s++)i+=n[s];return i/e},t.getMeasuredFPS=function(e){var i=t._times;return!i||i.length<2?-1:(e=Math.min(i.length-1,e||0|t.getFPS()),1e3/((i[0]-i[e])/e))},t.setPaused=function(e){t.paused=e},t.getPaused=function(){return t.paused},t.getTime=function(e){return t._startTime?t._getTime()-(e?t._pausedTime:0):-1},t.getEventTime=function(e){return t._startTime?(t._lastTime||t._startTime)-(e?t._pausedTime:0):-1},t.getTicks=function(e){return t._ticks-(e?t._pausedTicks:0)},t._handleSynch=function(){t._timerId=null,t._setupTick(),t._getTime()-t._lastTime>=.97*(t._interval-1)&&t._tick()},t._handleRAF=function(){t._timerId=null,t._setupTick(),t._tick()},t._handleTimeout=function(){t._timerId=null,t._setupTick(),t._tick()},t._setupTick=function(){if(null==t._timerId){var e=t.timingMode||t.useRAF&&t.RAF_SYNCHED;if(e==t.RAF_SYNCHED||e==t.RAF){var i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(i)return t._timerId=i(e==t.RAF?t._handleRAF:t._handleSynch),void(t._raf=!0)}t._raf=!1,t._timerId=setTimeout(t._handleTimeout,t._interval)}},t._tick=function(){var e=t.paused,i=t._getTime(),n=i-t._lastTime;if(t._lastTime=i,t._ticks++,e&&(t._pausedTicks++,t._pausedTime+=n),t.hasEventListener("tick")){var s=new createjs.Event("tick"),r=t.maxDelta;s.delta=r&&n>r?r:n,s.paused=e,s.time=i,s.runTime=i-t._pausedTime,t.dispatchEvent(s)}for(t._tickTimes.unshift(t._getTime()-i);t._tickTimes.length>100;)t._tickTimes.pop();for(t._times.unshift(i);t._times.length>100;)t._times.pop()};var e=window.performance&&(performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow);t._getTime=function(){return(e&&e.call(performance)||(new Date).getTime())-t._startTime},createjs.Ticker=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(e,i,n){this.ignoreGlobalPause=!1,this.loop=!1,this.duration=0,this.pluginData=n||{},this.target=e,this.position=null,this.passive=!1,this._paused=!1,this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],this._prevPosition=0,this._stepPosition=0,this._prevPos=-1,this._target=e,this._useTicks=!1,this._inited=!1,this._registered=!1,i&&(this._useTicks=i.useTicks,this.ignoreGlobalPause=i.ignoreGlobalPause,this.loop=i.loop,i.onChange&&this.addEventListener("change",i.onChange),i.override&&t.removeTweens(e)),i&&i.paused?this._paused=!0:createjs.Tween._register(this,!0),i&&null!=i.position&&this.setPosition(i.position,t.NONE)}var e=createjs.extend(t,createjs.EventDispatcher);t.NONE=0,t.LOOP=1,t.REVERSE=2,t.IGNORE={},t._tweens=[],t._plugins={},t.get=function(e,i,n,s){return s&&t.removeTweens(e),new t(e,i,n)},t.tick=function(e,i){for(var n=t._tweens.slice(),s=n.length-1;s>=0;s--){var r=n[s];i&&!r.ignoreGlobalPause||r._paused||r.tick(r._useTicks?1:e)}},t.handleEvent=function(t){"tick"==t.type&&this.tick(t.delta,t.paused)},t.removeTweens=function(e){if(e.tweenjs_count){for(var i=t._tweens,n=i.length-1;n>=0;n--){var s=i[n];s._target==e&&(s._paused=!0,i.splice(n,1))}e.tweenjs_count=0}},t.removeAllTweens=function(){for(var e=t._tweens,i=0,n=e.length;n>i;i++){var s=e[i];s._paused=!0,s.target&&(s.target.tweenjs_count=0)}e.length=0},t.hasActiveTweens=function(e){return e?null!=e.tweenjs_count&&!!e.tweenjs_count:t._tweens&&!!t._tweens.length},t.installPlugin=function(e,i){var n=e.priority;null==n&&(e.priority=n=0);for(var s=0,r=i.length,o=t._plugins;r>s;s++){var a=i[s];if(o[a]){for(var h=o[a],l=0,u=h.length;u>l&&!(n<h[l].priority);l++);o[a].splice(l,0,e)}else o[a]=[e]}},t._register=function(e,i){var n=e._target,s=t._tweens;if(i&&!e._registered)n&&(n.tweenjs_count=n.tweenjs_count?n.tweenjs_count+1:1),s.push(e),!t._inited&&createjs.Ticker&&(createjs.Ticker.addEventListener("tick",t),t._inited=!0);else if(!i&&e._registered){n&&n.tweenjs_count--;for(var r=s.length;r--;)if(s[r]==e){s.splice(r,1);break}}e._registered=i},e.wait=function(t,e){if(null==t||0>=t)return this;var i=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:i,e:this._linearEase,p1:i,v:e})},e.to=function(t,e,i){return(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))})},e.call=function(t,e,i){return this._addAction({f:t,p:e||[this],o:i||this._target})},e.set=function(t,e){return this._addAction({f:this._set,o:this,p:[t,e||this._target]})},e.play=function(t){return t||(t=this),this.call(t.setPaused,[!1],t)},e.pause=function(t){return t||(t=this),this.call(t.setPaused,[!0],t)},e.setPosition=function(t,e){0>t&&(t=0),null==e&&(e=1);var i=t,n=!1;if(i>=this.duration&&(this.loop?i%=this.duration:(i=this.duration,n=!0)),i==this._prevPos)return n;var s=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this._target)if(n)this._updateTargetProps(null,1);else if(this._steps.length>0){for(var r=0,o=this._steps.length;o>r&&!(this._steps[r].t>i);r++);var a=this._steps[r-1];this._updateTargetProps(a,(this._stepPosition=i-a.t)/a.d)}return 0!=e&&this._actions.length>0&&(this._useTicks?this._runActions(i,i):1==e&&s>i?(s!=this.duration&&this._runActions(s,this.duration),this._runActions(0,i,!0)):this._runActions(s,i)),n&&this.setPaused(!0),this.dispatchEvent("change"),n},e.tick=function(t){this._paused||this.setPosition(this._prevPosition+t)},e.setPaused=function(e){return this._paused===!!e||(this._paused=!!e,t._register(this,!e)),this},e.w=e.wait,e.t=e.to,e.c=e.call,e.s=e.set,e.toString=function(){return"[Tween]"},e.clone=function(){throw"Tween can not be cloned."},e._updateTargetProps=function(e,i){var n,s,r,o,a,h;if(e||1!=i){if(this.passive=!!e.v,this.passive)return;e.e&&(i=e.e(i,0,1,1)),n=e.p0,s=e.p1}else this.passive=!1,n=s=this._curQueueProps;for(var l in this._initQueueProps){null==(o=n[l])&&(n[l]=o=this._initQueueProps[l]),null==(a=s[l])&&(s[l]=a=o),r=o==a||0==i||1==i||"number"!=typeof o?1==i?a:o:o+(a-o)*i;var u=!1;if(h=t._plugins[l])for(var c=0,d=h.length;d>c;c++){var p=h[c].tween(this,l,r,n,s,i,!!e&&n==s,!e);p==t.IGNORE?u=!0:r=p}u||(this._target[l]=r)}},e._runActions=function(t,e,i){var n=t,s=e,r=-1,o=this._actions.length,a=1;for(t>e&&(n=e,s=t,r=o,o=a=-1);(r+=a)!=o;){var h=this._actions[r],l=h.t;(l==s||l>n&&s>l||i&&l==t)&&h.f.apply(h.o,h.p)}},e._appendQueueProps=function(e){var i,n,s,r,o;for(var a in e)if(void 0===this._initQueueProps[a]){if(n=this._target[a],i=t._plugins[a])for(s=0,r=i.length;r>s;s++)n=i[s].init(this,a,n);this._initQueueProps[a]=this._curQueueProps[a]=void 0===n?null:n}else n=this._curQueueProps[a];for(var a in e){if(n=this._curQueueProps[a],i=t._plugins[a])for(o=o||{},s=0,r=i.length;r>s;s++)i[s].step&&i[s].step(this,a,n,e[a],o);this._curQueueProps[a]=e[a]}return o&&this._appendQueueProps(o),this._curQueueProps},e._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},e._addStep=function(t){return t.d>0&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},e._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},e._set=function(t,e){for(var i in t)e[i]=t[i]},createjs.Tween=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.EventDispatcher_constructor(),this.ignoreGlobalPause=!1,this.duration=0,this.loop=!1,this.position=null,this._paused=!1,this._tweens=[],this._labels=null,this._labelList=null,this._prevPosition=0,this._prevPos=-1,this._useTicks=!1,this._registered=!1,i&&(this._useTicks=i.useTicks,this.loop=i.loop,this.ignoreGlobalPause=i.ignoreGlobalPause,i.onChange&&this.addEventListener("change",i.onChange)),t&&this.addTween.apply(this,t),this.setLabels(e),i&&i.paused?this._paused=!0:createjs.Tween._register(this,!0),i&&null!=i.position&&this.setPosition(i.position,createjs.Tween.NONE)}var e=createjs.extend(t,createjs.EventDispatcher);e.addTween=function(t){var e=arguments.length;if(e>1){for(var i=0;e>i;i++)this.addTween(arguments[i]);return arguments[0]}return 0==e?null:(this.removeTween(t),this._tweens.push(t),t.setPaused(!0),t._paused=!1,t._useTicks=this._useTicks,t.duration>this.duration&&(this.duration=t.duration),this._prevPos>=0&&t.setPosition(this._prevPos,createjs.Tween.NONE),t)},e.removeTween=function(t){var e=arguments.length;if(e>1){for(var i=!0,n=0;e>n;n++)i=i&&this.removeTween(arguments[n]);return i}if(0==e)return!1;var s=this._tweens;for(n=s.length;n--;)if(s[n]==t)return s.splice(n,1),t.duration>=this.duration&&this.updateDuration(),!0;return!1},e.addLabel=function(t,e){this._labels[t]=e;var i=this._labelList;if(i){for(var n=0,s=i.length;s>n&&!(e<i[n].position);n++);i.splice(n,0,{label:t,position:e})}},e.setLabels=function(t){this._labels=t||{}},e.getLabels=function(){var t=this._labelList;if(!t){t=this._labelList=[];var e=this._labels;for(var i in e)t.push({label:i,position:e[i]});t.sort((function(t,e){return t.position-e.position}))}return t},e.getCurrentLabel=function(){var t=this.getLabels(),e=this.position,i=t.length;if(i){for(var n=0;i>n&&!(e<t[n].position);n++);return 0==n?null:t[n-1].label}return null},e.gotoAndPlay=function(t){this.setPaused(!1),this._goto(t)},e.gotoAndStop=function(t){this.setPaused(!0),this._goto(t)},e.setPosition=function(t,e){var i=this._calcPosition(t),n=!this.loop&&t>=this.duration;if(i==this._prevPos)return n;this._prevPosition=t,this.position=this._prevPos=i;for(var s=0,r=this._tweens.length;r>s;s++)if(this._tweens[s].setPosition(i,e),i!=this._prevPos)return!1;return n&&this.setPaused(!0),this.dispatchEvent("change"),n},e.setPaused=function(t){this._paused=!!t,createjs.Tween._register(this,!t)},e.updateDuration=function(){this.duration=0;for(var t=0,e=this._tweens.length;e>t;t++){var i=this._tweens[t];i.duration>this.duration&&(this.duration=i.duration)}},e.tick=function(t){this.setPosition(this._prevPosition+t)},e.resolve=function(t){var e=Number(t);return isNaN(e)&&(e=this._labels[t]),e},e.toString=function(){return"[Timeline]"},e.clone=function(){throw"Timeline can not be cloned."},e._goto=function(t){var e=this.resolve(t);null!=e&&this.setPosition(e)},e._calcPosition=function(t){return 0>t?0:t<this.duration?t:this.loop?t%this.duration:this.duration},createjs.Timeline=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"Ease cannot be instantiated."}t.linear=function(t){return t},t.none=t.linear,t.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},t.getPowIn=function(t){return function(e){return Math.pow(e,t)}},t.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},t.getPowInOut=function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},t.quadIn=t.getPowIn(2),t.quadOut=t.getPowOut(2),t.quadInOut=t.getPowInOut(2),t.cubicIn=t.getPowIn(3),t.cubicOut=t.getPowOut(3),t.cubicInOut=t.getPowInOut(3),t.quartIn=t.getPowIn(4),t.quartOut=t.getPowOut(4),t.quartInOut=t.getPowInOut(4),t.quintIn=t.getPowIn(5),t.quintOut=t.getPowOut(5),t.quintInOut=t.getPowInOut(5),t.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},t.sineOut=function(t){return Math.sin(t*Math.PI/2)},t.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},t.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},t.backIn=t.getBackIn(1.7),t.getBackOut=function(t){return function(e){return--e*e*((t+1)*e+t)+1}},t.backOut=t.getBackOut(1.7),t.getBackInOut=function(t){return t*=1.525,function(e){return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},t.backInOut=t.getBackInOut(1.7),t.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},t.circOut=function(t){return Math.sqrt(1- --t*t)},t.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},t.bounceIn=function(e){return 1-t.bounceOut(1-e)},t.bounceOut=function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},t.bounceInOut=function(e){return.5>e?.5*t.bounceIn(2*e):.5*t.bounceOut(2*e-1)+.5},t.getElasticIn=function(t,e){var i=2*Math.PI;return function(n){if(0==n||1==n)return n;var s=e/i*Math.asin(1/t);return-t*Math.pow(2,10*(n-=1))*Math.sin((n-s)*i/e)}},t.elasticIn=t.getElasticIn(1,.3),t.getElasticOut=function(t,e){var i=2*Math.PI;return function(n){if(0==n||1==n)return n;var s=e/i*Math.asin(1/t);return t*Math.pow(2,-10*n)*Math.sin((n-s)*i/e)+1}},t.elasticOut=t.getElasticOut(1,.3),t.getElasticInOut=function(t,e){var i=2*Math.PI;return function(n){var s=e/i*Math.asin(1/t);return(n*=2)<1?-.5*t*Math.pow(2,10*(n-=1))*Math.sin((n-s)*i/e):t*Math.pow(2,-10*(n-=1))*Math.sin((n-s)*i/e)*.5+1}},t.elasticInOut=t.getElasticInOut(1,.3*1.5),createjs.Ease=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"MotionGuidePlugin cannot be instantiated."}t.priority=0,t._rotOffS,t._rotOffE,t._rotNormS,t._rotNormE,t.install=function(){return createjs.Tween.installPlugin(t,["guide","x","y","rotation"]),createjs.Tween.IGNORE},t.init=function(t,e,i){var n=t.target;return n.hasOwnProperty("x")||(n.x=0),n.hasOwnProperty("y")||(n.y=0),n.hasOwnProperty("rotation")||(n.rotation=0),"rotation"==e&&(t.__needsRot=!0),"guide"==e?null:i},t.step=function(e,i,n,s,r){if("rotation"==i&&(e.__rotGlobalS=n,e.__rotGlobalE=s,t.testRotData(e,r)),"guide"!=i)return s;var o,a=s;a.hasOwnProperty("path")||(a.path=[]);var h=a.path;if(a.hasOwnProperty("end")||(a.end=1),a.hasOwnProperty("start")||(a.start=n&&n.hasOwnProperty("end")&&n.path===h?n.end:0),a.hasOwnProperty("_segments")&&a._length)return s;var l=h.length;if(!(l>=6&&(l-2)%4==0))throw"invalid 'path' data, please see documentation for valid paths";a._segments=[],a._length=0;for(var u=2;l>u;u+=4){for(var c,d,p=h[u-2],f=h[u-1],g=h[u+0],v=h[u+1],m=h[u+2],y=h[u+3],_=p,b=f,w=0,x=[],T=1;10>=T;T++){var E=T/10,S=1-E;c=S*S*p+2*S*E*g+E*E*m,d=S*S*f+2*S*E*v+E*E*y,w+=x[x.push(Math.sqrt((o=c-_)*o+(o=d-b)*o))-1],_=c,b=d}a._segments.push(w),a._segments.push(x),a._length+=w}o=a.orient,a.orient=!0;var A={};return t.calc(a,a.start,A),e.__rotPathS=Number(A.rotation.toFixed(5)),t.calc(a,a.end,A),e.__rotPathE=Number(A.rotation.toFixed(5)),a.orient=!1,t.calc(a,a.end,r),a.orient=o,a.orient?(e.__guideData=a,t.testRotData(e,r),s):s},t.testRotData=function(t,e){if(void 0===t.__rotGlobalS||void 0===t.__rotGlobalE){if(t.__needsRot)return;t.__rotGlobalS=t.__rotGlobalE=void 0!==t._curQueueProps.rotation?t._curQueueProps.rotation:e.rotation=t.target.rotation||0}if(void 0!==t.__guideData){var i=t.__guideData,n=t.__rotGlobalE-t.__rotGlobalS,s=t.__rotPathE-t.__rotPathS,r=n-s;if("auto"==i.orient)r>180?r-=360:-180>r&&(r+=360);else if("cw"==i.orient){for(;0>r;)r+=360;0==r&&n>0&&180!=n&&(r+=360)}else if("ccw"==i.orient){for(r=n-(s>180?360-s:s);r>0;)r-=360;0==r&&0>n&&-180!=n&&(r-=360)}i.rotDelta=r,i.rotOffS=t.__rotGlobalS-t.__rotPathS,t.__rotGlobalS=t.__rotGlobalE=t.__guideData=t.__needsRot=void 0}},t.tween=function(e,i,n,s,r,o,a){var h=r.guide;if(null==h||h===s.guide)return n;if(h.lastRatio!=o){var l=(h.end-h.start)*(a?h.end:o)+h.start;switch(t.calc(h,l,e.target),h.orient){case"cw":case"ccw":case"auto":e.target.rotation+=h.rotOffS+h.rotDelta*o;break;case"fixed":default:e.target.rotation+=h.rotOffS}h.lastRatio=o}return"rotation"!=i||h.orient&&"false"!=h.orient?e.target[i]:n},t.calc=function(t,e,i){if(null==t._segments)throw"Missing critical pre-calculated information, please file a bug";null==i&&(i={x:0,y:0,rotation:0});for(var n=t._segments,s=t.path,r=t._length*e,o=n.length-2,a=0;r>n[a]&&o>a;)r-=n[a],a+=2;var h=n[a+1],l=0;for(o=h.length-1;r>h[l]&&o>l;)r-=h[l],l++;var u=l/++o+r/(o*h[l]);a=2*a+2;var c=1-u;return i.x=c*c*s[a-2]+2*c*u*s[a+0]+u*u*s[a+2],i.y=c*c*s[a-1]+2*c*u*s[a+1]+u*u*s[a+3],t.orient&&(i.rotation=57.2957795*Math.atan2((s[a+1]-s[a-1])*c+(s[a+3]-s[a+1])*u,(s[a+0]-s[a-2])*c+(s[a+2]-s[a+0])*u)),i},createjs.MotionGuidePlugin=t}(),this.createjs=this.createjs||{},function(){"use strict";var t=createjs.TweenJS=createjs.TweenJS||{};t.version="0.6.2",t.buildDate="Thu, 26 Nov 2015 20:44:31 GMT"}(),function(){"use strict";!function(t){function e(t,e){return t._priority-e._priority}var i=function(){this._listeners={}},n=i.prototype;n.on=function(t,i,n){if("string"!=typeof t)for(var s in t)this.on(s,t[s],n);else for(var r,o=t.split(" "),a=0,h=o.length;h>a;a++)t=o[a],(r=this._listeners[t])||(r=this._listeners[t]=[]),i._priority=parseInt(n)||0,-1===r.indexOf(i)&&(r.push(i),r.length>1&&r.sort(e));return this},n.off=function(t,e){if(void 0===t||!this._listeners)return this._listeners={},this;if(void 0===this._listeners[t])return this;if(void 0===e)delete this._listeners[t];else for(var i=this._listeners[t],n=0,s=i.length;s>n;n++)if(i[n]===e){i.splice(n,1);break}return this},n.trigger=function(t){"string"==typeof t&&(t={type:t});var e=this._listeners[t.type];if(void 0!==e)for(var i=e.length-1;i>=0;i--)e[i](t)},n.destroy=function(){this._listeners=null},t.BellhopEventDispatcher=i}(window),function(t,e){var i=t.BellhopEventDispatcher,n=function(){i.call(this),this.onReceive=this.receive.bind(this),this.connected=!1,this.name="",this.isChild=!0,this.connecting=!1,this.origin="*",this._sendLater=[],this.supported=null,this.iframe=null},s=i.prototype,r=n.prototype=Object.create(s);r.receive=function(t){if(t.source===this.target){var e=t.data;if("connected"===e){this.connecting=!1,this.connected=!0,this.trigger("connected"),this.isChild||this.target.postMessage(e,this.origin);var i,s=this._sendLater.length;if(s>0){for(i=0;s>i;i++){var r=this._sendLater[i];this.send(r.type,r.data)}this._sendLater.length=0}}else{if(!this.connected)return;try{e=JSON.parse(e,n.reviver)}catch(t){return}"object"==typeof e&&e.type&&this.trigger(e)}}},r.toString=function(){return"[Bellhop '"+this.name+"']"},Object.defineProperty(r,"target",{get:function(){return this.isChild?t.parent:this.iframe.contentWindow}}),r.connect=function(i,n){if(this.connecting)return this;this.disconnect(),this.connecting=!0,this._sendLater||(this._sendLater=[]),this.iframe=i||null;var s=this.isChild=i===e,r=this.target;return this.supported=s?!!r&&t!=r:!!r,this.origin=n===e?"*":n,t.attachEvent?t.attachEvent("onmessage",this.onReceive):t.addEventListener("message",this.onReceive),s&&(t===r?this.trigger("failed"):"complete"===t.document.readyState?r.postMessage("connected",this.origin):t.onload=function(){r.postMessage("connected",this.origin)}.bind(this)),this},r.disconnect=function(){return this.connected=!1,this.connecting=!1,this.origin=null,this.iframe=null,this._sendLater&&(this._sendLater.length=0),this.isChild=!0,t.detachEvent?t.detachEvent("onmessage",this.onReceive):t.removeEventListener("message",this.onReceive),this},r.send=function(t,i){if("string"!=typeof t)throw"The event type must be a string";if(t={type:t},i!==e&&(t.data=i),this.connecting)this._sendLater.push(t);else{if(!this.connected)return this;this.target.postMessage(JSON.stringify(t),this.origin)}return this},r.fetch=function(t,i,n,s){var r=this;if(!this.connecting&&!this.connected)throw"No connection, please call connect() first";s=s!==e&&s;var o=function(t){s&&r.off(t.type,o),i(t)};return this.on(t,o),this.send(t,n),this},r.respond=function(t,i,n){n=n!==e&&n;var s=this,r=function(e){n&&s.off(e.type,r),s.send(t,"function"==typeof i?i():i)};return this.on(t,r),this},r.destroy=function(){s.destroy.call(this),this.disconnect(),this._sendLater=null},n.reviver=function(t,e){if(e&&"string"==typeof e.__classname){var i=o(e.__classname);if(i){var n=new i;if(n.fromJSON)return n.fromJSON(e),n}}return e};var o=function(e){for(var i=e.split("."),n=t;i.length;)if(!(n=n[i.shift()]))return;return n};t.Bellhop=n}(window)}(),
/*!
* @license SoundJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011-2015 gskinner.com, inc.
*
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
*/
/**!
 * SoundJS FlashAudioPlugin also includes swfobject (http://code.google.com/p/swfobject/)
 */
this.createjs=this.createjs||{},function(){var t=createjs.SoundJS=createjs.SoundJS||{};t.version="0.6.6",t.buildDate="Thu, 10 May 2018 18:47:59 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(t,e){"use strict";function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},createjs.promote=function(t,e){"use strict";var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var s in i[(e+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(s)&&"function"==typeof n[s]&&(i[e+s]=n[s]);return t},this.createjs=this.createjs||{},createjs.indexOf=function(t,e){"use strict";for(var i=0,n=t.length;i<n;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){"use strict";createjs.proxy=function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(i))}}}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"BrowserDetect cannot be instantiated"}var e=t.agent=window.navigator.userAgent;t.isWindowPhone=e.indexOf("IEMobile")>-1||e.indexOf("Windows Phone")>-1,t.isFirefox=e.indexOf("Firefox")>-1,t.isOpera=null!=window.opera,t.isChrome=e.indexOf("Chrome")>-1,t.isIOS=(e.indexOf("iPod")>-1||e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&!t.isWindowPhone,t.isAndroid=e.indexOf("Android")>-1&&!t.isWindowPhone,t.isBlackberry=e.indexOf("Blackberry")>-1,createjs.BrowserDetect=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n,s=(n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{})[t];return s&&this.removeEventListener(t,e,i),(s=n[t])?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,r){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,(function(t){e.call(i,t,s),n&&t.remove()}),r)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var r=0,o=s.length;r<o;r++)if(s[r]==e){1==o?delete n[t]:s.splice(r,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"==typeof t){var n=this._listeners;if(!(e||n&&n[t]))return!0;t=new createjs.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(t){}if(t.bubbles&&this.parent){for(var s=this,r=[s];s.parent;)r.push(s=s.parent);var o,a=r.length;for(o=a-1;o>=0&&!t.propagationStopped;o--)r[o]._dispatchEvent(t,1+(0==o));for(o=1;o<a&&!t.propagationStopped;o++)r[o]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n=1==e?this._captureListeners:this._listeners;if(t&&n){var s=n[t.type];if(!s||!(i=s.length))return;try{t.currentTarget=this}catch(t){}try{t.eventPhase=e}catch(t){}t.removed=!1,s=s.slice();for(var r=0;r<i&&!t.immediatePropagationStopped;r++){var o=s[r];o.handleEvent?o.handleEvent(t):o(t),t.removed&&(this.off(t.type,o,1==e),t.removed=!1)}}},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.Event_constructor("error"),this.title=t,this.message=e,this.data=i}createjs.extend(t,createjs.Event).clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(t){"use strict";function e(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}createjs.extend(e,createjs.Event).clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(e,"Event")}(window),this.createjs=this.createjs||{},function(){"use strict";function t(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=i.LOAD_TIMEOUT_DEFAULT}var e=t.prototype={},i=t;i.LOAD_TIMEOUT_DEFAULT=8e3,i.create=function(e){if("string"==typeof e){var n=new t;return n.src=e,n}if(e instanceof i)return e;if(e instanceof Object&&e.src)return null==e.loadTimeout&&(e.loadTimeout=i.LOAD_TIMEOUT_DEFAULT),e;throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},createjs.LoadItem=i}(),function(){var t={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[.\/]*?\//i,EXTENSION_PATT:/\/?[^\/]+\.(\w{1,5})$/i,parseURI:function(e){var i={absolute:!1,relative:!1};if(null==e)return i;var n,s=e.indexOf("?");return s>-1&&(e=e.substr(0,s)),t.ABSOLUTE_PATT.test(e)?i.absolute=!0:t.RELATIVE_PATT.test(e)&&(i.relative=!0),(n=e.match(t.EXTENSION_PATT))&&(i.extension=n[1].toLowerCase()),i},formatQueryString:function(t,e){if(null==t)throw new Error("You must specify data.");var i=[];for(var n in t)i.push(n+"="+escape(t[n]));return e&&(i=i.concat(e)),i.join("&")},buildPath:function(t,e){if(null==e)return t;var i=[],n=t.indexOf("?");if(-1!=n){var s=t.slice(n+1);i=i.concat(s.split("&"))}return-1!=n?t.slice(0,n)+"?"+this.formatQueryString(e,i):t+"?"+this.formatQueryString(e,i)},isCrossDomain:function(t){var e=document.createElement("a");e.href=t.src;var i=document.createElement("a");return i.href=location.href,""!=e.hostname&&(e.port!=i.port||e.protocol!=i.protocol||e.hostname!=i.hostname)},isLocal:function(t){var e=document.createElement("a");return e.href=t.src,""==e.hostname&&"file:"==e.protocol},isBinary:function(t){switch(t){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},isImageTag:function(t){return t instanceof HTMLImageElement},isAudioTag:function(t){return!!window.HTMLAudioElement&&t instanceof HTMLAudioElement},isVideoTag:function(t){return!!window.HTMLVideoElement&&t instanceof HTMLVideoElement},isText:function(t){switch(t){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:case createjs.AbstractLoader.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(t){if(null==t)return createjs.AbstractLoader.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}}};createjs.RequestUtils=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=t?createjs.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var e=createjs.extend(t,createjs.EventDispatcher),i=t;i.POST="POST",i.GET="GET",i.BINARY="binary",i.CSS="css",i.IMAGE="image",i.JAVASCRIPT="javascript",i.JSON="json",i.JSONP="jsonp",i.MANIFEST="manifest",i.SOUND="sound",i.VIDEO="video",i.SPRITESHEET="spritesheet",i.SVG="svg",i.TEXT="text",i.XML="xml",e.getItem=function(){return this._item},e.getResult=function(t){return t?this._rawResult:this._result},e.getTag=function(){return this._tag},e.setTag=function(t){this._tag=t},e.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new createjs.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},e.cancel=function(){this.canceled=!0,this.destroy()},e.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},e.getLoadedItems=function(){return this._loadedItems},e._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._createTag=function(t){return null},e._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},e._sendProgress=function(t){if(!this._isCanceled()){var e=null;"number"==typeof t?(this.progress=t,e=new createjs.ProgressEvent(this.progress)):(e=t,this.progress=t.loaded/t.total,e.progress=this.progress,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e)}},e._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var t=new createjs.Event("complete");t.rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t)}},e._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},e._isCanceled=function(){return!(null!=window.createjs&&!this.canceled)},e.resultFormatter=null,e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this);e instanceof Function?e.call(this,createjs.proxy(this._resultFormatSuccess,this),createjs.proxy(this._resultFormatFailed,this)):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_"+t.type.toUpperCase()+"_ERROR"))}},e._resultFormatSuccess=function(t){this._result=t,this._sendComplete()},e._resultFormatFailed=function(t){this._sendError(t)},e.buildPath=function(t,e){return createjs.RequestUtils.buildPath(t,e)},e.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader);e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._preferXHR?this._request=new createjs.XHRRequest(this._item):this._request=new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._updateXHR=function(t){t.loader.setResponseType&&t.loader.setResponseType("blob")},e._formatResult=function(t){if(this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR){var e=window.URL||window.webkitURL,i=t.getResult(!0);t.getTag().src=e.createObjectURL(i)}return t.getTag()},createjs.AbstractMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";var t=function(t){this._item=t},e=createjs.extend(t,createjs.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},createjs.AbstractRequest=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var e=createjs.extend(t,createjs.AbstractRequest);e.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var t=new createjs.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._hideTag(),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0)},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;"loaded"!=t.readyState&&"complete"!=t.readyState||this._handleTagComplete()},e._handleError=function(){this._clean(),this.dispatchEvent("error")},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},e._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},e._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},e._showTag=function(){this._tag.style.visibility=this._startTagVisibility},e._handleStalled=function(){},createjs.TagRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var e=createjs.extend(t,createjs.TagRequest);e.load=function(){var t=createjs.proxy(this._handleStalled,this);this._stalledCallback=t;var e=createjs.proxy(this._handleProgress,this);this._handleProgress=e,this._tag.addEventListener("stalled",t),this._tag.addEventListener("progress",e),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;"loaded"!=t.readyState&&"complete"!=t.readyState||this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),this._createXHR(t)}var e=createjs.extend(t,createjs.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},e.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},e.load=function(){if(null!=this._request){null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,t))}}else this._handleError()},e.setResponseType=function(t){"blob"===t&&(t=window.URL?"blob":"arraybuffer",this._responseType=t),this._request.responseType=t},e.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},e.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._handleLoadStart=function(t){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},e._handleAbort=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,t))},e._handleError=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(t.message))},e._handleReadyStateChange=function(t){4==this._request.readyState&&this._handleLoad()},e._handleLoad=function(t){if(!this.loaded){this.loaded=!0;var e=this._checkError();if(e)return void this._handleError(e);if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(t){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===t.name&&window.BlobBuilder){var i=new BlobBuilder;i.append(this._response),this._response=i.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},e._handleTimeout=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,t))},e._checkError=function(){var t=parseInt(this._request.status);switch(t){case 404:return new Error(t);case 0:return this._getResponse()?null:new Error(t)}return null},e._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},e._createXHR=function(t){var e=createjs.RequestUtils.isCrossDomain(t),i={},n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest,e&&void 0===n.withCredentials&&window.XDomainRequest&&(n=new XDomainRequest);else{for(var r=0,o=s.ACTIVEX_VERSIONS.length;r<o;r++){var a=s.ACTIVEX_VERSIONS[r];try{n=new ActiveXObject(a);break}catch(t){}}if(null==n)return!1}null==t.mimeType&&createjs.RequestUtils.isText(t.type)&&(t.mimeType="text/plain; charset=utf-8"),t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType),this._xhrLevel="string"==typeof n.responseType?2:1;var h;if(h=t.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(t.src,t.values):t.src,n.open(t.method||createjs.AbstractLoader.GET,h,!0),e&&n instanceof XMLHttpRequest&&1==this._xhrLevel&&(i.Origin=location.origin),t.values&&t.method==createjs.AbstractLoader.POST&&(i["Content-Type"]="application/x-www-form-urlencoded"),e||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var l in t.headers)i[l]=t.headers[l];for(l in i)n.setRequestHeader(l,i[l]);return n instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(n.withCredentials=t.withCredentials),this._request=n,!0},e._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},e.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(t)||createjs.RequestUtils.isAudioTag(t.src)?this._tag=t:createjs.RequestUtils.isAudioTag(t.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=createjs.extend(t,createjs.AbstractMediaLoader);t.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SOUND},e._createTag=function(t){var e=document.createElement("audio");return e.autoplay=!1,e.preload="none",e.src=t,e},createjs.SoundLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";var t=function(){this.interrupt=null,this.delay=null,this.offset=null,this.loop=null,this.volume=null,this.pan=null,this.startTime=null,this.duration=null},e=t.prototype={},i=t;i.create=function(t){if(t instanceof i||t instanceof Object){var e=new createjs.PlayPropsConfig;return e.set(t),e}throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[PlayPropsConfig]"},createjs.PlayPropsConfig=i}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"Sound cannot be instantiated"}function e(t,e){this.init(t,e)}var i=t;i.INTERRUPT_ANY="any",i.INTERRUPT_EARLY="early",i.INTERRUPT_LATE="late",i.INTERRUPT_NONE="none",i.PLAY_INITED="playInited",i.PLAY_SUCCEEDED="playSucceeded",i.PLAY_INTERRUPTED="playInterrupted",i.PLAY_FINISHED="playFinished",i.PLAY_FAILED="playFailed",i.SUPPORTED_EXTENSIONS=["mp3","ogg","opus","mpeg","wav","m4a","mp4","aiff","wma","mid"],i.EXTENSION_MAP={m4a:"mp4"},i.FILE_PATTERN=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([\/.]*?(?:[^?]+)?\/)?(?:((?:[^\/?]+)\.(\w+))|(?:[^\/?]+))(?:\?((?:(?:[^&]*?[\/=])?(?:((?:(?:[^\/?&=]+)\.(\w+)))\S*?)|\S+))?)?$/,i.defaultInterruptBehavior=i.INTERRUPT_NONE,i.alternateExtensions=[],i.activePlugin=null,i._masterVolume=1,Object.defineProperty(i,"volume",{get:function(){return this._masterVolume},set:function(t){if(null==Number(t))return!1;if(t=Math.max(0,Math.min(1,t)),i._masterVolume=t,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(t))for(var e=this._instances,n=0,s=e.length;n<s;n++)e[n].setMasterVolume(t)}}),i._masterMute=!1,Object.defineProperty(i,"muted",{get:function(){return this._masterMute},set:function(t){if(null==t)return!1;if(this._masterMute=t,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(t))for(var e=this._instances,i=0,n=e.length;i<n;i++)e[i].setMasterMute(t);return!0}}),Object.defineProperty(i,"capabilities",{get:function(){return null==i.activePlugin?null:i.activePlugin._capabilities},set:function(t){return!1}}),i._pluginsRegistered=!1,i._lastID=0,i._instances=[],i._idHash={},i._preloadHash={},i._defaultPlayPropsHash={},i.addEventListener=null,i.removeEventListener=null,i.removeAllEventListeners=null,i.dispatchEvent=null,i.hasEventListener=null,i._listeners=null,createjs.EventDispatcher.initialize(i),i.getPreloadHandlers=function(){return{callback:createjs.proxy(i.initLoad,i),types:["sound"],extensions:i.SUPPORTED_EXTENSIONS}},i._handleLoadComplete=function(t){var e=t.target.getItem().src;if(i.preloadHash[e])for(var n=0,s=i._preloadHash[e].length;n<s;n++){var r=i._preloadHash[e][n];if(i._preloadHash[e][n]=!0,i.hasEventListener("fileload"))(t=new createjs.Event("fileload")).src=r.src,t.id=r.id,t.data=r.data,t.sprite=r.sprite,i.dispatchEvent(t)}},i._handleLoadError=function(t){var e=t.target.getItem().src;if(i._preloadHash[e])for(var n=0,s=i._preloadHash[e].length;n<s;n++){var r=i._preloadHash[e][n];if(i._preloadHash[e][n]=!1,i.hasEventListener("fileerror"))(t=new createjs.Event("fileerror")).src=r.src,t.id=r.id,t.data=r.data,t.sprite=r.sprite,i.dispatchEvent(t)}},i._registerPlugin=function(t){return!!t.isSupported()&&(i.activePlugin=new t,!0)},i.registerPlugins=function(t){i._pluginsRegistered=!0;for(var e=0,n=t.length;e<n;e++)if(i._registerPlugin(t[e]))return!0;return!1},i.initializeDefaultPlugins=function(){return null!=i.activePlugin||!i._pluginsRegistered&&!!i.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin])},i.isReady=function(){return null!=i.activePlugin},i.getCapabilities=function(){return null==i.activePlugin?null:i.activePlugin._capabilities},i.getCapability=function(t){return null==i.activePlugin?null:i.activePlugin._capabilities[t]},i.initLoad=function(t){return i._registerSound(t)},i._registerSound=function(t){if(!i.initializeDefaultPlugins())return!1;var n;if(t.src instanceof Object?(n=i._parseSrc(t.src)).src=t.path+n.src:n=i._parsePath(t.src),null==n)return!1;t.src=n.src,t.type="sound";var s=t.data,r=null;if(null!=s&&(isNaN(s.channels)?isNaN(s)||(r=parseInt(s)):r=parseInt(s.channels),s.audioSprite))for(var o,a=s.audioSprite.length;a--;)o=s.audioSprite[a],i._idHash[o.id]={src:t.src,startTime:parseInt(o.startTime),duration:parseInt(o.duration)},o.defaultPlayProps&&(i._defaultPlayPropsHash[o.id]=createjs.PlayPropsConfig.create(o.defaultPlayProps));null!=t.id&&(i._idHash[t.id]={src:t.src});var h=i.activePlugin.register(t);return e.create(t.src,r),null!=s&&isNaN(s)?t.data.channels=r||e.maxPerChannel():t.data=r||e.maxPerChannel(),h.type&&(t.type=h.type),t.defaultPlayProps&&(i._defaultPlayPropsHash[t.src]=createjs.PlayPropsConfig.create(t.defaultPlayProps)),h},i.registerSound=function(t,e,n,s,r){var o={src:t,id:e,data:n,defaultPlayProps:r};t instanceof Object&&t.src&&(s=e,o=t),(o=createjs.LoadItem.create(o)).path=s,null==s||o.src instanceof Object||(o.src=s+t);var a=i._registerSound(o);if(!a)return!1;if(i._preloadHash[o.src]||(i._preloadHash[o.src]=[]),i._preloadHash[o.src].push(o),1==i._preloadHash[o.src].length)a.on("complete",createjs.proxy(this._handleLoadComplete,this)),a.on("error",createjs.proxy(this._handleLoadError,this)),i.activePlugin.preload(a);else if(1==i._preloadHash[o.src][0])return!0;return o},i.registerSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path,t=t.manifest);for(var n=0,s=t.length;n<s;n++)i[n]=createjs.Sound.registerSound(t[n].src,t[n].id,t[n].data,e,t[n].defaultPlayProps);return i},i.removeSound=function(t,n){if(null==i.activePlugin)return!1;var s;if(t instanceof Object&&t.src&&(t=t.src),t instanceof Object?s=i._parseSrc(t):(t=i._getSrcById(t).src,s=i._parsePath(t)),null==s)return!1;for(var r in t=s.src,null!=n&&(t=n+t),i._idHash)i._idHash[r].src==t&&delete i._idHash[r];return e.removeSrc(t),delete i._preloadHash[t],i.activePlugin.removeSound(t),!0},i.removeSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path,t=t.manifest);for(var n=0,s=t.length;n<s;n++)i[n]=createjs.Sound.removeSound(t[n].src,e);return i},i.removeAllSounds=function(){i._idHash={},i._preloadHash={},e.removeAll(),i.activePlugin&&i.activePlugin.removeAllSounds()},i.loadComplete=function(t){if(!i.isReady())return!1;var e=i._parsePath(t);return t=e?i._getSrcById(e.src).src:i._getSrcById(t).src,null!=i._preloadHash[t]&&1==i._preloadHash[t][0]},i._parsePath=function(t){"string"!=typeof t&&(t=t.toString());var e=t.match(i.FILE_PATTERN);if(null===e)return!1;var n="",s="",r="";if(i.SUPPORTED_EXTENSIONS.indexOf(e[5])>=0)n=e[4],r=s=e[5];else{if(!(i.SUPPORTED_EXTENSIONS.indexOf(e[8])>=0))return null;n=e[7],r=s=e[8]}for(var o=i.capabilities,a=0;!o[s];)if(s=i.alternateExtensions[a++],a>i.alternateExtensions.length)return null;return{name:n,src:t=t.replace("."+r,"."+s),extension:s}},i._parseSrc=function(t){var e={name:void 0,src:void 0,extension:void 0},n=i.capabilities;for(var s in t)if(t.hasOwnProperty(s)&&n[s]){e.src=t[s],e.extension=s;break}if(!e.src)return!1;var r=e.src.lastIndexOf("/");return e.name=-1!=r?e.src.slice(r+1):e.src,e},i.play=function(t,e,n,s,r,o,a,h,l){var u;u=e instanceof Object||e instanceof createjs.PlayPropsConfig?createjs.PlayPropsConfig.create(e):createjs.PlayPropsConfig.create({interrupt:e,delay:n,offset:s,loop:r,volume:o,pan:a,startTime:h,duration:l});var c=i.createInstance(t,u.startTime,u.duration);return i._playInstance(c,u)||c._playFailed(),c},i.createInstance=function(t,n,s){if(!i.initializeDefaultPlugins())return new createjs.DefaultSoundInstance(t,n,s);var r=i._defaultPlayPropsHash[t];t=i._getSrcById(t);var o=i._parsePath(t.src),a=null;return null!=o&&null!=o.src?(e.create(o.src),null==n&&(n=t.startTime),a=i.activePlugin.create(o.src,n,s||t.duration),(r=r||i._defaultPlayPropsHash[o.src])&&a.applyPlayProps(r)):a=new createjs.DefaultSoundInstance(t,n,s),a.uniqueId=i._lastID++,a},i.stop=function(){for(var t=this._instances,e=t.length;e--;)t[e].stop()},i.setVolume=function(t){if(null==Number(t))return!1;if(t=Math.max(0,Math.min(1,t)),i._masterVolume=t,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(t))for(var e=this._instances,n=0,s=e.length;n<s;n++)e[n].setMasterVolume(t)},i.getVolume=function(){return this._masterVolume},i.setMute=function(t){if(null==t)return!1;if(this._masterMute=t,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(t))for(var e=this._instances,i=0,n=e.length;i<n;i++)e[i].setMasterMute(t);return!0},i.getMute=function(){return this._masterMute},i.setDefaultPlayProps=function(t,e){t=i._getSrcById(t),i._defaultPlayPropsHash[i._parsePath(t.src).src]=createjs.PlayPropsConfig.create(e)},i.getDefaultPlayProps=function(t){return t=i._getSrcById(t),i._defaultPlayPropsHash[i._parsePath(t.src).src]},i.pause=function(){for(var t=this.instances,e=t.length;e--;)t[e].paused=!0},i.resume=function(){for(var t=this.instances,e=t.length;e--;)t[e].paused=!1},i._playInstance=function(t,e){var n=i._defaultPlayPropsHash[t.src]||{};if(null==e.interrupt&&(e.interrupt=n.interrupt||i.defaultInterruptBehavior),null==e.delay&&(e.delay=n.delay||0),null==e.offset&&(e.offset=t.getPosition()),null==e.loop&&(e.loop=t.loop),null==e.volume&&(e.volume=t.volume),null==e.pan&&(e.pan=t.pan),0==e.delay){if(!i._beginPlaying(t,e))return!1}else{var s=setTimeout((function(){i._beginPlaying(t,e)}),e.delay);t.delayTimeoutId=s}return this._instances.push(t),!0},i._beginPlaying=function(t,i){if(!e.add(t,i.interrupt))return!1;if(!t._beginPlaying(i)){var n=createjs.indexOf(this._instances,t);return n>-1&&this._instances.splice(n,1),!1}return!0},i._getSrcById=function(t){return i._idHash[t]||{src:t}},i._playFinished=function(t){e.remove(t);var n=createjs.indexOf(this._instances,t);n>-1&&this._instances.splice(n,1);var s=i.activePlugin._soundInstances;s[t.src]&&s[t.src].indexOf(t)>-1&&s[t.src].splice(s[t.src].indexOf(t),1)},createjs.Sound=t,e.channels={},e.create=function(t,i){return null==e.get(t)&&(e.channels[t]=new e(t,i),!0)},e.removeSrc=function(t){var i=e.get(t);return null!=i&&(i._removeAll(),delete e.channels[t],!0)},e.removeAll=function(){for(var t in e.channels)e.channels[t]._removeAll();e.channels={}},e.add=function(t,i){var n=e.get(t.src);return null!=n&&n._add(t,i)},e.remove=function(t){var i=e.get(t.src);return null!=i&&(i._remove(t),!0)},e.maxPerChannel=function(){return n.maxDefault},e.get=function(t){return e.channels[t]};var n=e.prototype;n.constructor=e,n.src=null,n.max=null,n.maxDefault=100,n.length=0,n.init=function(t,e){this.src=t,this.max=e||this.maxDefault,-1==this.max&&(this.max=this.maxDefault),this._instances=[]},n._get=function(t){return this._instances[t]},n._add=function(t,e){return!!this._getSlot(e,t)&&(this._instances.push(t),this.length++,!0)},n._remove=function(t){var e=i.activePlugin._soundInstances;e[t.src]&&e[t.src].indexOf(t)>-1&&e[t.src].splice(e[t.src].indexOf(t),1);var n=createjs.indexOf(this._instances,t);return-1!=n&&(this._instances.splice(n,1),this.length--,!0)},n._removeAll=function(){for(var t=this.length-1;t>=0;t--)this._instances[t].stop()},n._getSlot=function(e,i){var n,s;if(e!=t.INTERRUPT_NONE&&null==(s=this._get(0)))return!0;for(var r=0,o=this.max;r<o;r++){if(null==(n=this._get(r)))return!0;if(n.playState==t.PLAY_FINISHED||n.playState==t.PLAY_INTERRUPTED||n.playState==t.PLAY_FAILED){s=n;break}e!=t.INTERRUPT_NONE&&(e==t.INTERRUPT_EARLY&&n.getPosition()<s.getPosition()||e==t.INTERRUPT_LATE&&n.getPosition()>s.getPosition())&&(s=n)}return null!=s&&(s._interrupt(),this._remove(s),!0)},n.toString=function(){return"[Sound SoundChannel]"}}(),this.createjs=this.createjs||{},function(){"use strict";var t=function(t,e,i,n){this.EventDispatcher_constructor(),this.src=t,this.uniqueId=-1,this.playState=null,this.delayTimeoutId=null,this._volume=1,Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),this._pan=0,Object.defineProperty(this,"pan",{get:this.getPan,set:this.setPan}),this._startTime=Math.max(0,e||0),Object.defineProperty(this,"startTime",{get:this.getStartTime,set:this.setStartTime}),this._duration=Math.max(0,i||0),Object.defineProperty(this,"duration",{get:this.getDuration,set:this.setDuration}),this._playbackResource=null,Object.defineProperty(this,"playbackResource",{get:this.getPlaybackResource,set:this.setPlaybackResource}),!1!==n&&!0!==n&&this.setPlaybackResource(n),this._position=0,Object.defineProperty(this,"position",{get:this.getPosition,set:this.setPosition}),this._loop=0,Object.defineProperty(this,"loop",{get:this.getLoop,set:this.setLoop}),this._muted=!1,Object.defineProperty(this,"muted",{get:this.getMuted,set:this.setMuted}),this._paused=!1,Object.defineProperty(this,"paused",{get:this.getPaused,set:this.setPaused})},e=createjs.extend(t,createjs.EventDispatcher);e.play=function(t,e,i,n,s,r){var o;return o=t instanceof Object||t instanceof createjs.PlayPropsConfig?createjs.PlayPropsConfig.create(t):createjs.PlayPropsConfig.create({interrupt:t,delay:e,offset:i,loop:n,volume:s,pan:r}),this.playState==createjs.Sound.PLAY_SUCCEEDED?(this.applyPlayProps(o),void(this._paused&&this.setPaused(!1))):(this._cleanUp(),createjs.Sound._playInstance(this,o),this)},e.stop=function(){return this._position=0,this._paused=!1,this._handleStop(),this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this},e.destroy=function(){this._cleanUp(),this.src=null,this.playbackResource=null,this.removeAllEventListeners()},e.applyPlayProps=function(t){return null!=t.offset&&this.setPosition(t.offset),null!=t.loop&&this.setLoop(t.loop),null!=t.volume&&this.setVolume(t.volume),null!=t.pan&&this.setPan(t.pan),null!=t.startTime&&(this.setStartTime(t.startTime),this.setDuration(t.duration)),this},e.toString=function(){return"[AbstractSoundInstance]"},e.getPaused=function(){return this._paused},e.setPaused=function(t){if(!(!0!==t&&!1!==t||this._paused==t||1==t&&this.playState!=createjs.Sound.PLAY_SUCCEEDED))return this._paused=t,t?this._pause():this._resume(),clearTimeout(this.delayTimeoutId),this},e.setVolume=function(t){return t==this._volume||(this._volume=Math.max(0,Math.min(1,t)),this._muted||this._updateVolume()),this},e.getVolume=function(){return this._volume},e.setMuted=function(t){if(!0===t||!1===t)return this._muted=t,this._updateVolume(),this},e.getMuted=function(){return this._muted},e.setPan=function(t){return t==this._pan||(this._pan=Math.max(-1,Math.min(1,t)),this._updatePan()),this},e.getPan=function(){return this._pan},e.getPosition=function(){return this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED||(this._position=this._calculateCurrentPosition()),this._position},e.setPosition=function(t){return this._position=Math.max(0,t),this.playState==createjs.Sound.PLAY_SUCCEEDED&&this._updatePosition(),this},e.getStartTime=function(){return this._startTime},e.setStartTime=function(t){return t==this._startTime||(this._startTime=Math.max(0,t||0),this._updateStartTime()),this},e.getDuration=function(){return this._duration},e.setDuration=function(t){return t==this._duration||(this._duration=Math.max(0,t||0),this._updateDuration()),this},e.setPlaybackResource=function(t){return this._playbackResource=t,0==this._duration&&this._setDurationFromSource(),this},e.getPlaybackResource=function(){return this._playbackResource},e.getLoop=function(){return this._loop},e.setLoop=function(t){null!=this._playbackResource&&(0!=this._loop&&0==t?this._removeLooping(t):0==this._loop&&0!=t&&this._addLooping(t)),this._loop=t},e._sendEvent=function(t){var e=new createjs.Event(t);this.dispatchEvent(e)},e._cleanUp=function(){clearTimeout(this.delayTimeoutId),this._handleCleanUp(),this._paused=!1,createjs.Sound._playFinished(this)},e._interrupt=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_INTERRUPTED,this._sendEvent("interrupted")},e._beginPlaying=function(t){return this.setPosition(t.offset),this.setLoop(t.loop),this.setVolume(t.volume),this.setPan(t.pan),null!=t.startTime&&(this.setStartTime(t.startTime),this.setDuration(t.duration)),null!=this._playbackResource&&this._position<this._duration?(this._paused=!1,this._handleSoundReady(),this.playState=createjs.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0):(this._playFailed(),!1)},e._playFailed=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_FAILED,this._sendEvent("failed")},e._handleSoundComplete=function(t){if(this._position=0,0!=this._loop)return this._loop--,this._handleLoop(),void this._sendEvent("loop");this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this._sendEvent("complete")},e._handleSoundReady=function(){},e._updateVolume=function(){},e._updatePan=function(){},e._updateStartTime=function(){},e._updateDuration=function(){},e._setDurationFromSource=function(){},e._calculateCurrentPosition=function(){},e._updatePosition=function(){},e._removeLooping=function(t){},e._addLooping=function(t){},e._pause=function(){},e._resume=function(){},e._handleStop=function(){},e._handleCleanUp=function(){},e._handleLoop=function(){},createjs.AbstractSoundInstance=createjs.promote(t,"EventDispatcher"),createjs.DefaultSoundInstance=createjs.AbstractSoundInstance}(),this.createjs=this.createjs||{},function(){"use strict";var t=function(){this._capabilities=null,this._loaders={},this._audioSources={},this._soundInstances={},this._volume=1,this._loaderClass,this._soundInstanceClass,this._volume=1},e=t.prototype;t._capabilities=null,t.isSupported=function(){return!0},e.register=function(t){var e=this._loaders[t.src];return e&&!e.canceled?this._loaders[t.src]:(this._audioSources[t.src]=!0,this._soundInstances[t.src]=[],(e=new this._loaderClass(t)).on("complete",this._handlePreloadComplete,this),this._loaders[t.src]=e,e)},e.preload=function(t){t.on("error",this._handlePreloadError,this),t.load()},e.isPreloadStarted=function(t){return null!=this._audioSources[t]},e.isPreloadComplete=function(t){return!(null==this._audioSources[t]||1==this._audioSources[t])},e.removeSound=function(t){if(this._soundInstances[t]){for(var e=this._soundInstances[t].length;e--;)this._soundInstances[t][e].destroy();delete this._soundInstances[t],delete this._audioSources[t],this._loaders[t]&&this._loaders[t].destroy(),delete this._loaders[t]}},e.removeAllSounds=function(){for(var t in this._audioSources)this.removeSound(t)},e.create=function(t,e,i){this.isPreloadStarted(t)||this.preload(this.register(t));var n=new this._soundInstanceClass(t,e,i,this._audioSources[t]);return this._soundInstances[t].push(n),n},e.setVolume=function(t){return this._volume=t,this._updateVolume(),!0},e.getVolume=function(){return this._volume},e.setMute=function(t){return this._updateVolume(),!0},e.toString=function(){return"[AbstractPlugin]"},e._handlePreloadComplete=function(t){var e=t.target.getItem().src;this._audioSources[e]=t.result;for(var i=0,n=this._soundInstances[e].length;i<n;i++)this._soundInstances[e][i].setPlaybackResource(this._audioSources[e])},e._handlePreloadError=function(t){},e._updateVolume=function(){},createjs.AbstractPlugin=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.SOUND)}var e=createjs.extend(t,createjs.AbstractLoader);t.context=null,e.toString=function(){return"[WebAudioLoader]"},e._createRequest=function(){this._request=new createjs.XHRRequest(this._item,!1),this._request.setResponseType("arraybuffer")},e._sendComplete=function(e){t.context.decodeAudioData(this._rawResult,createjs.proxy(this._handleAudioDecoded,this),createjs.proxy(this._sendError,this))},e._handleAudioDecoded=function(t){this._result=t,this.AbstractLoader__sendComplete()},createjs.WebAudioLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,n,s){this.AbstractSoundInstance_constructor(t,e,n,s),this.gainNode=i.context.createGain(),this.panNode=i.context.createPanner(),this.panNode.panningModel=i._panningModel,this.panNode.connect(this.gainNode),this._updatePan(),this.sourceNode=null,this._soundCompleteTimeout=null,this._sourceNodeNext=null,this._playbackStartTime=0,this._endedHandler=createjs.proxy(this._handleSoundComplete,this)}var e=createjs.extend(t,createjs.AbstractSoundInstance),i=t;i.context=null,i._scratchBuffer=null,i.destinationNode=null,i._panningModel="equalpower",e.destroy=function(){this.AbstractSoundInstance_destroy(),this.panNode.disconnect(0),this.panNode=null,this.gainNode.disconnect(0),this.gainNode=null},e.toString=function(){return"[WebAudioSoundInstance]"},e._updatePan=function(){this.panNode.setPosition(this._pan,0,-.5)},e._removeLooping=function(t){this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)},e._addLooping=function(t){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._setDurationFromSource=function(){this._duration=1e3*this.playbackResource.duration},e._handleCleanUp=function(){this.sourceNode&&this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout),this._playbackStartTime=0},e._cleanUpAudioNode=function(t){if(t){t.stop(0),t.disconnect(0);try{t.buffer=i._scratchBuffer}catch(t){}t=null}return t},e._handleSoundReady=function(t){this.gainNode.connect(i.destinationNode);var e=.001*this._duration,n=.001*this._position;n>e&&(n=e),this.sourceNode=this._createAndPlayAudioNode(i.context.currentTime-e,n),this._playbackStartTime=this.sourceNode.startTime-n,this._soundCompleteTimeout=setTimeout(this._endedHandler,1e3*(e-n)),0!=this._loop&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._createAndPlayAudioNode=function(t,e){var n=i.context.createBufferSource();n.buffer=this.playbackResource,n.connect(this.panNode);var s=.001*this._duration;return e>s&&(e=s-.001),n.startTime=t+s,n.start(n.startTime,e+.001*this._startTime,s-e),n},e._pause=function(){this._position=1e3*(i.context.currentTime-this._playbackStartTime),this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout)},e._resume=function(){this._handleSoundReady()},e._updateVolume=function(){var t=this._muted?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},e._calculateCurrentPosition=function(){return 1e3*(i.context.currentTime-this._playbackStartTime)},e._updatePosition=function(){this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),clearTimeout(this._soundCompleteTimeout),this._paused||this._handleSoundReady()},e._handleLoop=function(){this._cleanUpAudioNode(this.sourceNode),this.sourceNode=this._sourceNodeNext,this._playbackStartTime=this.sourceNode.startTime,this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0),this._soundCompleteTimeout=setTimeout(this._endedHandler,this._duration)},e._updateDuration=function(){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._pause(),this._resume())},createjs.WebAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.AbstractPlugin_constructor(),this._panningModel=i._panningModel,this.context=i.context,this.dynamicsCompressorNode=this.context.createDynamicsCompressor(),this.dynamicsCompressorNode.connect(this.context.destination),this.gainNode=this.context.createGain(),this.gainNode.connect(this.dynamicsCompressorNode),createjs.WebAudioSoundInstance.destinationNode=this.gainNode,this._capabilities=i._capabilities,this._loaderClass=createjs.WebAudioLoader,this._soundInstanceClass=createjs.WebAudioSoundInstance,this._addPropsToClasses()}var e=createjs.extend(t,createjs.AbstractPlugin),i=t;i._capabilities=null,i._panningModel="equalpower",i.context=null,i._scratchBuffer=null,i._unlocked=!1,i.isSupported=function(){var t=createjs.BrowserDetect.isIOS||createjs.BrowserDetect.isAndroid||createjs.BrowserDetect.isBlackberry;return!("file:"==location.protocol&&!t&&!this._isFileXHRSupported())&&(i._generateCapabilities(),null!=i.context)},i.playEmptySound=function(){if(null!=i.context){var t=i.context.createBufferSource();t.buffer=i._scratchBuffer,t.connect(i.context.destination),t.start(0,0,0),"suspended"===t.context.state&&t.context.resume()}},i._isFileXHRSupported=function(){var t=!0,e=new XMLHttpRequest;try{e.open("GET","WebAudioPluginTest.fail",!1)}catch(e){return t=!1}e.onerror=function(){t=!1},e.onload=function(){t=404==this.status||200==this.status||0==this.status&&""!=this.response};try{e.send()}catch(e){t=!1}return t},i._generateCapabilities=function(){if(null==i._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;if(null==i.context){if(window.AudioContext)i.context=new AudioContext;else{if(!window.webkitAudioContext)return null;i.context=new webkitAudioContext}document.addEventListener("click",(function(){"suspended"===i.context.state&&i.context.resume()}))}null==i._scratchBuffer&&(i._scratchBuffer=i.context.createBuffer(1,1,22050)),i._compatibilitySetUp(),"ontouchstart"in window&&"running"!=i.context.state&&(i._unlock(),document.addEventListener("mousedown",i._unlock,!0),document.addEventListener("touchstart",i._unlock,!0),document.addEventListener("touchend",i._unlock,!0)),i._capabilities={panning:!0,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,n=createjs.Sound.EXTENSION_MAP,s=0,r=e.length;s<r;s++){var o=e[s],a=n[o]||o;i._capabilities[o]="no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)||"no"!=t.canPlayType("audio/"+a)&&""!=t.canPlayType("audio/"+a)}i.context.destination.numberOfChannels<2&&(i._capabilities.panning=!1)}},i._compatibilitySetUp=function(){if(i._panningModel="equalpower",!i.context.createGain){i.context.createGain=i.context.createGainNode;var t=i.context.createBufferSource();t.__proto__.start=t.__proto__.noteGrainOn,t.__proto__.stop=t.__proto__.noteOff,i._panningModel=0}},i._unlock=function(){"suspended"===i.context.state&&i.context.resume(),i._unlocked||(i.playEmptySound(),"running"==i.context.state&&(document.removeEventListener("mousedown",i._unlock,!0),document.removeEventListener("touchend",i._unlock,!0),document.removeEventListener("touchstart",i._unlock,!0),i._unlocked=!0))},e.toString=function(){return"[WebAudioPlugin]"},e._addPropsToClasses=function(){var t=this._soundInstanceClass;t.context=this.context,t._scratchBuffer=i._scratchBuffer,t.destinationNode=this.gainNode,t._panningModel=this._panningModel,this._loaderClass.context=this.context},e._updateVolume=function(){var t=createjs.Sound._masterMute?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},createjs.WebAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"HTMLAudioTagPool cannot be instantiated"}function e(t){this._tags=[]}var i=t;i._tags={},i._tagPool=new e,i._tagUsed={},i.get=function(t){var e=i._tags[t];return null==e?(e=i._tags[t]=i._tagPool.get()).src=t:i._tagUsed[t]?(e=i._tagPool.get()).src=t:i._tagUsed[t]=!0,e},i.set=function(t,e){e==i._tags[t]?i._tagUsed[t]=!1:i._tagPool.set(e)},i.remove=function(t){var e=i._tags[t];return null!=e&&(i._tagPool.set(e),delete i._tags[t],delete i._tagUsed[t],!0)},i.getDuration=function(t){var e=i._tags[t];return null!=e&&e.duration?1e3*e.duration:0},createjs.HTMLAudioTagPool=t;var n=e.prototype;n.constructor=e,n.get=function(){var t;return null==(t=0==this._tags.length?this._createTag():this._tags.pop()).parentNode&&document.body.appendChild(t),t},n.set=function(t){-1==createjs.indexOf(this._tags,t)&&(this._tags.src=null,this._tags.push(t))},n.toString=function(){return"[TagPool]"},n._createTag=function(){var t=document.createElement("audio");return t.autoplay=!1,t.preload="none",t}}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i,n){this.AbstractSoundInstance_constructor(t,e,i,n),this._audioSpriteStopTime=null,this._delayTimeoutId=null,this._endedHandler=createjs.proxy(this._handleSoundComplete,this),this._readyHandler=createjs.proxy(this._handleTagReady,this),this._stalledHandler=createjs.proxy(this._playFailed,this),this._audioSpriteEndHandler=createjs.proxy(this._handleAudioSpriteLoop,this),this._loopHandler=createjs.proxy(this._handleSoundComplete,this),i?this._audioSpriteStopTime=.001*(e+i):this._duration=createjs.HTMLAudioTagPool.getDuration(this.src)}var e=createjs.extend(t,createjs.AbstractSoundInstance);e.setMasterVolume=function(t){this._updateVolume()},e.setMasterMute=function(t){this._updateVolume()},e.toString=function(){return"[HTMLAudioSoundInstance]"},e._removeLooping=function(){null!=this._playbackResource&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._addLooping=function(){null==this._playbackResource||this._audioSpriteStopTime||(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)},e._handleCleanUp=function(){var t=this._playbackResource;if(null!=t){t.pause(),t.loop=!1,t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1);try{t.currentTime=this._startTime}catch(t){}createjs.HTMLAudioTagPool.set(this.src,t),this._playbackResource=null}},e._beginPlaying=function(t){return this._playbackResource=createjs.HTMLAudioTagPool.get(this.src),this.AbstractSoundInstance__beginPlaying(t)},e._handleSoundReady=function(t){if(4!==this._playbackResource.readyState){var e=this._playbackResource;return e.addEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),e.addEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),e.preload="auto",void e.load()}this._updateVolume(),this._playbackResource.currentTime=.001*(this._startTime+this._position),this._audioSpriteStopTime?this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1):(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),0!=this._loop&&(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)),this._playbackResource.play()},e._handleTagReady=function(t){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),this._handleSoundReady()},e._pause=function(){this._playbackResource.pause()},e._resume=function(){this._playbackResource.play()},e._updateVolume=function(){if(null!=this._playbackResource){var t=this._muted||createjs.Sound._masterMute?0:this._volume*createjs.Sound._masterVolume;t!=this._playbackResource.volume&&(this._playbackResource.volume=t)}},e._calculateCurrentPosition=function(){return 1e3*this._playbackResource.currentTime-this._startTime},e._updatePosition=function(){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1);try{this._playbackResource.currentTime=.001*(this._position+this._startTime)}catch(t){this._handleSetPositionSeek(null)}},e._handleSetPositionSeek=function(t){null!=this._playbackResource&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._handleAudioSpriteLoop=function(t){this._playbackResource.currentTime<=this._audioSpriteStopTime||(this._playbackResource.pause(),0==this._loop?this._handleSoundComplete(null):(this._position=0,this._loop--,this._playbackResource.currentTime=.001*this._startTime,this._paused||this._playbackResource.play(),this._sendEvent("loop")))},e._handleLoop=function(t){0==this._loop&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._updateStartTime=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},e._updateDuration=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},e._setDurationFromSource=function(){this._duration=createjs.HTMLAudioTagPool.getDuration(this.src),this._playbackResource=null},createjs.HTMLAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.AbstractPlugin_constructor(),this.defaultNumChannels=2,this._capabilities=i._capabilities,this._loaderClass=createjs.SoundLoader,this._soundInstanceClass=createjs.HTMLAudioSoundInstance}var e=createjs.extend(t,createjs.AbstractPlugin),i=t;i.MAX_INSTANCES=30,i._AUDIO_READY="canplaythrough",i._AUDIO_ENDED="ended",i._AUDIO_SEEKED="seeked",i._AUDIO_STALLED="stalled",i._TIME_UPDATE="timeupdate",i._capabilities=null,i.isSupported=function(){return i._generateCapabilities(),null!=i._capabilities},i._generateCapabilities=function(){if(null==i._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;i._capabilities={panning:!1,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,n=createjs.Sound.EXTENSION_MAP,s=0,r=e.length;s<r;s++){var o=e[s],a=n[o]||o;i._capabilities[o]="no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)||"no"!=t.canPlayType("audio/"+a)&&""!=t.canPlayType("audio/"+a)}}},e.register=function(t){var e=createjs.HTMLAudioTagPool.get(t.src),i=this.AbstractPlugin_register(t);return i.setTag(e),i},e.removeSound=function(t){this.AbstractPlugin_removeSound(t),createjs.HTMLAudioTagPool.remove(t)},e.create=function(t,e,i){var n=this.AbstractPlugin_create(t,e,i);return n.setPlaybackResource(null),n},e.toString=function(){return"[HTMLAudioPlugin]"},e.setVolume=e.getVolume=e.setMute=null,createjs.HTMLAudioPlugin=createjs.promote(t,"AbstractPlugin")}();
/*!
* @license SoundJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011-2015 gskinner.com, inc.
*
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
*/
/**!
 * SoundJS FlashAudioPlugin also includes swfobject (http://code.google.com/p/swfobject/)
 */
/*!	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/
var swfobject=function(){function t(){if(!N){try{var t=R.getElementsByTagName("body")[0].appendChild(f("span"));t.parentNode.removeChild(t)}catch(t){return}N=!0;for(var e=k.length,i=0;i<e;i++)k[i]()}}function e(t){N?t():k[k.length]=t}function i(t){if(typeof O.addEventListener!=S)O.addEventListener("load",t,!1);else if(typeof R.addEventListener!=S)R.addEventListener("load",t,!1);else if(typeof O.attachEvent!=S)!function(t,e,i){t.attachEvent(e,i),F[F.length]=[t,e,i]}(O,"onload",t);else if("function"==typeof O.onload){var e=O.onload;O.onload=function(){e(),t()}}else O.onload=t}function n(){var t=j.length;if(t>0)for(var e=0;e<t;e++){var i=j[e].id,n=j[e].callbackFn,h={success:!1,id:i};if(H.pv[0]>0){var l=p(i);if(l)if(!g(j[e].swfVersion)||H.wk&&H.wk<312)if(j[e].expressInstall&&r()){var u={};u.data=j[e].expressInstall,u.width=l.getAttribute("width")||"0",u.height=l.getAttribute("height")||"0",l.getAttribute("class")&&(u.styleclass=l.getAttribute("class")),l.getAttribute("align")&&(u.align=l.getAttribute("align"));for(var c={},d=l.getElementsByTagName("param"),f=d.length,v=0;v<f;v++)"movie"!=d[v].getAttribute("name").toLowerCase()&&(c[d[v].getAttribute("name")]=d[v].getAttribute("value"));o(u,c,i,n)}else a(l),n&&n(h);else m(i,!0),n&&(h.success=!0,h.ref=s(i),n(h))}else if(m(i,!0),n){var y=s(i);y&&typeof y.SetVariable!=S&&(h.success=!0,h.ref=y),n(h)}}}function s(t){var e=null,i=p(t);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=S)e=i;else{var n=i.getElementsByTagName(A)[0];n&&(e=n)}return e}function r(){return!U&&g("6.0.65")&&(H.win||H.mac)&&!(H.wk&&H.wk<312)}function o(t,e,i,n){U=!0,w=n||null,x={success:!1,id:i};var s=p(i);if(s){"OBJECT"==s.nodeName?(_=h(s),b=null):(_=s,b=i),t.id=M,(typeof t.width==S||!/%$/.test(t.width)&&parseInt(t.width,10)<310)&&(t.width="310"),(typeof t.height==S||!/%$/.test(t.height)&&parseInt(t.height,10)<137)&&(t.height="137"),R.title=R.title.slice(0,47)+" - Flash Player Installation";var r=H.ie&&H.win?"ActiveX":"PlugIn",o="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+R.title;if(typeof e.flashvars!=S?e.flashvars+="&"+o:e.flashvars=o,H.ie&&H.win&&4!=s.readyState){var a=f("div");i+="SWFObjectNew",a.setAttribute("id",i),s.parentNode.insertBefore(a,s),s.style.display="none",function(){4==s.readyState?s.parentNode.removeChild(s):setTimeout(arguments.callee,10)}()}l(t,e,i)}}function a(t){if(H.ie&&H.win&&4!=t.readyState){var e=f("div");t.parentNode.insertBefore(e,t),e.parentNode.replaceChild(h(t),e),t.style.display="none",function(){4==t.readyState?t.parentNode.removeChild(t):setTimeout(arguments.callee,10)}()}else t.parentNode.replaceChild(h(t),t)}function h(t){var e=f("div");if(H.win&&H.ie)e.innerHTML=t.innerHTML;else{var i=t.getElementsByTagName(A)[0];if(i){var n=i.childNodes;if(n)for(var s=n.length,r=0;r<s;r++)1==n[r].nodeType&&"PARAM"==n[r].nodeName||8==n[r].nodeType||e.appendChild(n[r].cloneNode(!0))}}return e}function l(t,e,i){var n,s=p(i);if(H.wk&&H.wk<312)return n;if(s)if(typeof t.id==S&&(t.id=i),H.ie&&H.win){var r="";for(var o in t)t[o]!=Object.prototype[o]&&("data"==o.toLowerCase()?e.movie=t[o]:"styleclass"==o.toLowerCase()?r+=' class="'+t[o]+'"':"classid"!=o.toLowerCase()&&(r+=" "+o+'="'+t[o]+'"'));var a="";for(var h in e)e[h]!=Object.prototype[h]&&(a+='<param name="'+h+'" value="'+e[h]+'" />');s.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+a+"</object>",B[B.length]=t.id,n=p(t.id)}else{var l=f(A);for(var c in l.setAttribute("type",C),t)t[c]!=Object.prototype[c]&&("styleclass"==c.toLowerCase()?l.setAttribute("class",t[c]):"classid"!=c.toLowerCase()&&l.setAttribute(c,t[c]));for(var d in e)e[d]!=Object.prototype[d]&&"movie"!=d.toLowerCase()&&u(l,d,e[d]);s.parentNode.replaceChild(l,s),n=l}return n}function u(t,e,i){var n=f("param");n.setAttribute("name",e),n.setAttribute("value",i),t.appendChild(n)}function c(t){var e=p(t);e&&"OBJECT"==e.nodeName&&(H.ie&&H.win?(e.style.display="none",function(){4==e.readyState?d(t):setTimeout(arguments.callee,10)}()):e.parentNode.removeChild(e))}function d(t){var e=p(t);if(e){for(var i in e)"function"==typeof e[i]&&(e[i]=null);e.parentNode.removeChild(e)}}function p(t){var e=null;try{e=R.getElementById(t)}catch(t){}return e}function f(t){return R.createElement(t)}function g(t){var e=H.pv,i=t.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,e[0]>i[0]||e[0]==i[0]&&e[1]>i[1]||e[0]==i[0]&&e[1]==i[1]&&e[2]>=i[2]}function v(t,e,i,n){if(!H.ie||!H.mac){var s=R.getElementsByTagName("head")[0];if(s){var r=i&&"string"==typeof i?i:"screen";if(n&&(T=null,E=null),!T||E!=r){var o=f("style");o.setAttribute("type","text/css"),o.setAttribute("media",r),T=s.appendChild(o),H.ie&&H.win&&typeof R.styleSheets!=S&&R.styleSheets.length>0&&(T=R.styleSheets[R.styleSheets.length-1]),E=r}H.ie&&H.win?T&&typeof T.addRule==A&&T.addRule(t,e):T&&typeof R.createTextNode!=S&&T.appendChild(R.createTextNode(t+" {"+e+"}"))}}}function m(t,e){if(X){var i=e?"visible":"hidden";N&&p(t)?p(t).style.visibility=i:v("#"+t,"visibility:"+i)}}function y(t){return null!=/[\\\"<>\.;]/.exec(t)&&typeof encodeURIComponent!=S?encodeURIComponent(t):t}var _,b,w,x,T,E,S="undefined",A="object",P="Shockwave Flash",C="application/x-shockwave-flash",M="SWFObjectExprInst",L="onreadystatechange",O=window,R=document,I=navigator,D=!1,k=[function(){D?function(){var t=R.getElementsByTagName("body")[0],e=f(A);e.setAttribute("type",C);var i=t.appendChild(e);if(i){var s=0;!function(){if(typeof i.GetVariable!=S){var r=i.GetVariable("$version");r&&(r=r.split(" ")[1].split(","),H.pv=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)])}else if(s<10)return s++,void setTimeout(arguments.callee,10);t.removeChild(e),i=null,n()}()}else n()}():n()}],j=[],B=[],F=[],N=!1,U=!1,X=!0,H=function(){var t=typeof R.getElementById!=S&&typeof R.getElementsByTagName!=S&&typeof R.createElement!=S,e=I.userAgent.toLowerCase(),i=I.platform.toLowerCase(),n=/win/.test(i||e),s=/mac/.test(i||e),r=!!/webkit/.test(e)&&parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),o=!1,a=[0,0,0],h=null;if(typeof I.plugins!=S&&typeof I.plugins[P]==A)!(h=I.plugins[P].description)||typeof I.mimeTypes!=S&&I.mimeTypes[C]&&!I.mimeTypes[C].enabledPlugin||(D=!0,o=!1,h=h.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=parseInt(h.replace(/^(.*)\..*$/,"$1"),10),a[1]=parseInt(h.replace(/^.*\.(.*)\s.*$/,"$1"),10),a[2]=/[a-zA-Z]/.test(h)?parseInt(h.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof O.ActiveXObject!=S)try{var l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");l&&((h=l.GetVariable("$version"))&&(o=!0,h=h.split(" ")[1].split(","),a=[parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10)]))}catch(t){}return{w3:t,pv:a,wk:r,ie:o,win:n,mac:s}}();return H.w3&&((typeof R.readyState!=S&&"complete"==R.readyState||typeof R.readyState==S&&(R.getElementsByTagName("body")[0]||R.body))&&t(),N||(typeof R.addEventListener!=S&&R.addEventListener("DOMContentLoaded",t,!1),H.ie&&H.win&&(R.attachEvent(L,(function(){"complete"==R.readyState&&(R.detachEvent(L,arguments.callee),t())})),O==top&&function(){if(!N){try{R.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}t()}}()),H.wk&&function(){N||(/loaded|complete/.test(R.readyState)?t():setTimeout(arguments.callee,0))}(),i(t))),H.ie&&H.win&&window.attachEvent("onunload",(function(){for(var t=F.length,e=0;e<t;e++)F[e][0].detachEvent(F[e][1],F[e][2]);for(var i=B.length,n=0;n<i;n++)c(B[n]);for(var s in H)H[s]=null;for(var r in H=null,swfobject)swfobject[r]=null;swfobject=null})),{registerObject:function(t,e,i,n){if(H.w3&&t&&e){var s={};s.id=t,s.swfVersion=e,s.expressInstall=i,s.callbackFn=n,j[j.length]=s,m(t,!1)}else n&&n({success:!1,id:t})},getObjectById:function(t){if(H.w3)return s(t)},embedSWF:function(t,i,n,s,a,h,u,c,d,p){var f={success:!1,id:i};H.w3&&!(H.wk&&H.wk<312)&&t&&i&&n&&s&&a?(m(i,!1),e((function(){n+="",s+="";var e={};if(d&&typeof d===A)for(var v in d)e[v]=d[v];e.data=t,e.width=n,e.height=s;var y={};if(c&&typeof c===A)for(var _ in c)y[_]=c[_];if(u&&typeof u===A)for(var b in u)typeof y.flashvars!=S?y.flashvars+="&"+b+"="+u[b]:y.flashvars=b+"="+u[b];if(g(a)){var w=l(e,y,i);e.id==i&&m(i,!0),f.success=!0,f.ref=w}else{if(h&&r())return e.data=h,void o(e,y,i,p);m(i,!0)}p&&p(f)}))):p&&p(f)},switchOffAutoHideShow:function(){X=!1},ua:H,getFlashPlayerVersion:function(){return{major:H.pv[0],minor:H.pv[1],release:H.pv[2]}},hasFlashPlayerVersion:g,createSWF:function(t,e,i){return H.w3?l(t,e,i):void 0},showExpressInstall:function(t,e,i,n){H.w3&&r()&&o(t,e,i,n)},removeSWF:function(t){H.w3&&c(t)},createCSS:function(t,e,i,n){H.w3&&v(t,e,i,n)},addDomLoadEvent:e,addLoadEvent:i,getQueryParamValue:function(t){var e=R.location.search||R.location.hash;if(e){if(/\?/.test(e)&&(e=e.split("?")[1]),null==t)return y(e);for(var i=e.split("&"),n=0;n<i.length;n++)if(i[n].substring(0,i[n].indexOf("="))==t)return y(i[n].substring(i[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(U){var t=p(M);t&&_&&(t.parentNode.replaceChild(_,t),b&&(m(b,!0),H.ie&&H.win&&(_.style.display="block")),w&&w(x)),U=!1}}}}();this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!1,createjs.AbstractLoader.SOUND),this.flashId=null}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i._flash=null,i._preloadInstances=[],i.setFlash=function(t){i._flash=t;for(var e=i._preloadInstances.length;e--;){i._preloadInstances.pop().load()}},e.load=function(){if(null!=i._flash){this.flashId=i._flash.preload(this._item.src);var t=new createjs.Event(createjs.FlashAudioPlugin._REG_FLASHID);this.dispatchEvent(t)}else i._preloadInstances.push(this)},e.handleProgress=function(t,e){this._sendProgress(t/e)},e.handleComplete=function(){this._result=this._item.src,this._sendComplete()},e.handleError=function(t){this._handleError(t)},e.destroy=function(){var t=new createjs.Event(createjs.FlashAudioPlugin._UNREG_FLASHID);this.dispatchEvent(t),this.AbstractLoader_destroy()},e.toString=function(){return"[FlashAudioLoader]"},createjs.FlashAudioLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,n,s){this.AbstractSoundInstance_constructor(t,e,n,s),this.flashId=null,null==i._flash&&i._instances.push(this)}var e=createjs.extend(t,createjs.AbstractSoundInstance),i=t;i._flash=null,i._instances=[],i.setFlash=function(t){i._flash=t;for(var e=i._instances.length;e--;){i._instances.pop()._setDurationFromSource()}},e.setLoop=function(t){null!=this.flashId&&i._flash.setLoop(this.flashId,t),this._loop=t},e.toString=function(){return"[FlashAudioSoundInstance]"},e._updateVolume=function(){null!=this.flashId&&i._flash.setVolume(this.flashId,this._volume)},e._updatePan=function(){null!=this.flashId&&i._flash.setPan(this.flashId,this._pan)},e._setDurationFromSource=function(){this._duration=i._flash.getDurationBySrc(this.src)},e._interrupt=function(){null!=this.flashId&&(i._flash.interrupt(this.flashId),this.AbstractSoundInstance__interrupt())},e._handleCleanUp=function(){i._flash.stopSound(this.flashId),this._sendEvent(createjs.FlashAudioPlugin._UNREG_FLASHID),this.flashId=null},e._beginPlaying=function(t){return null!=i._flash&&(this.setPosition(t.offset),this.setLoop(t.loop),this.setVolume(t.volume),this.setPan(t.pan),null!=t.startTime&&(this.setStartTime(t.startTime),this.setDuration(t.duration)),this._paused=!1,this.flashId=i._flash.playSound(this.src,this._position,this._loop,this._volume,this._pan,this._startTime,this._duration),null==this.flashId?(this._playFailed(),!1):(this._muted&&this.setMute(!0),this._sendEvent(createjs.FlashAudioPlugin._REG_FLASHID),this.playState=createjs.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0))},e._pause=function(){null!=this.flashId&&(this._position=this._calculateCurrentPosition(),i._flash.pauseSound(this.flashId))},e._resume=function(){null!=this.flashId&&i._flash.resumeSound(this.flashId)},e._handleStop=function(){null!=this.flashId&&i._flash.stopSound(this.flashId)},e._updateVolume=function(){var t=this._muted?0:this._volume;i._flash.setVolume(this.flashId,t)},e._calculateCurrentPosition=function(){return i._flash.getPosition(this.flashId)},e._updatePosition=function(){null!=this.flashId&&i._flash.setPosition(this.flashId,this._position)},e.handleSoundFinished=function(){this._loop=0,this._handleSoundComplete()},e.handleSoundLoop=function(){this._loop--,this._sendEvent("loop")},createjs.FlashAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.AbstractPlugin_constructor(),this.showOutput=!1,this._CONTAINER_ID="flashAudioContainer",this._WRAPPER_ID="SoundJSFlashContainer",this._container=null,this._flash=null,this.flashReady=!1,this._flashInstances={},this._flashPreloadInstances={},this._capabilities=i._capabilities,this._loaderClass=createjs.FlashAudioLoader,this._soundInstanceClass=createjs.FlashAudioSoundInstance;var t=this.wrapper=document.createElement("div");t.id=this._WRAPPER_ID,t.style.position="absolute",t.style.marginLeft="-1px",t.className=this._WRAPPER_ID,document.body.appendChild(t);var e=this._container=document.createElement("div");e.id=this._CONTAINER_ID,e.appendChild(document.createTextNode("SoundJS Flash Container")),t.appendChild(e);var n=i.swfPath;swfobject.embedSWF(n+"FlashAudioPlugin.swf",this._CONTAINER_ID,"1","1","9.0.0",null,null,{AllowScriptAccess:"always"},null,createjs.proxy(this._handleSWFReady,this))}var e=createjs.extend(t,createjs.AbstractPlugin),i=t;i._REG_FLASHID="registerflashid",i._UNREG_FLASHID="unregisterflashid",i._capabilities=null,i.swfPath="src/soundjs/flashaudio/",i.isSupported=function(){return!(createjs.BrowserDetect.isIOS||createjs.BrowserDetect.isAndroid||createjs.BrowserDetect.isBlackberry||createjs.BrowserDetect.isWindowsPhone)&&(i._generateCapabilities(),null!=swfobject&&swfobject.hasFlashPlayerVersion("9.0.0"))},i._generateCapabilities=function(){null==i._capabilities&&(i._capabilities={panning:!0,volume:!0,tracks:-1,mp3:!0,ogg:!1,mpeg:!0,wav:!0,m4a:!1,mp4:!1,aiff:!1,wma:!1,mid:!1})},e.register=function(t,e){var n=this.AbstractPlugin_register(t,e);return n.addEventListener(i._REG_FLASHID,createjs.proxy(this.registerPreloadInstance,this)),n.addEventListener(i._UNREG_FLASHID,createjs.proxy(this.unregisterPreloadInstance,this)),n},e.removeAllSounds=function(){this._flashInstances={},this._flashPreloadInstances={},this.AbstractPlugin_removeAllSounds()},e.create=function(t,e,n){var s=this.AbstractPlugin_create(t,e,n);return s.on(i._REG_FLASHID,this.registerSoundInstance,this),s.on(i._UNREG_FLASHID,this.unregisterSoundInstance,this),s},e.toString=function(){return"[FlashAudioPlugin]"},e._handleSWFReady=function(t){this._flash=t.ref},e._handleFlashReady=function(){this.flashReady=!0,this._loaderClass.setFlash(this._flash),this._soundInstanceClass.setFlash(this._flash),this._updateVolume()},e._updateVolume=function(){if(!this.flashReady)return!0;var t=createjs.Sound._masterMute?0:this._volume;return this._flash.setMasterVolume(t)},e.registerPreloadInstance=function(t){this._flashPreloadInstances[t.target.flashId]=t.target},e.unregisterPreloadInstance=function(t){delete this._flashPreloadInstances[t.target.flashId]},e.registerSoundInstance=function(t){this._flashInstances[t.target.flashId]=t.target},e.unregisterSoundInstance=function(t){delete this._flashInstances[t.target.flashId]},e.flashLog=function(t){try{this.showOutput&&console.log(t)}catch(t){}},e.handleSoundEvent=function(t,e){var i=this._flashInstances[t];if(null!=i){for(var n=[],s=2,r=arguments.length;s<r;s++)n.push(arguments[s]);try{0==n.length?i[e]():i[e].apply(i,n)}catch(t){}}},e.handlePreloadEvent=function(t,e){var i=this._flashPreloadInstances[t];if(null!=i){for(var n=[],s=2,r=arguments.length;s<r;s++)n.push(arguments[s]);try{0==n.length?i[e]():i[e].apply(i,n)}catch(t){}}},e.handleEvent=function(t){switch(t){case"ready":this._handleFlashReady()}},e.handleErrorEvent=function(t){},createjs.FlashAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){var t=createjs.FlashAudioPlugin=createjs.FlashAudioPlugin||{};t.version="0.6.5",t.buildDate="Fri, 07 Apr 2017 15:14:47 GMT"}(),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PIXI=t()}}((function(){return function t(e,i,n){function s(o,a){if(!i[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[o]={exports:{}};e[o][0].call(u.exports,(function(t){var i=e[o][1][t];return s(i||t)}),u,u.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){(function(t,i){!function(){function n(){}function s(t){return t}function r(t){return!!t}function o(t){return!t}function a(t){return function(){if(null===t)throw new Error("Callback was already called.");t.apply(this,arguments),t=null}}function h(t){return function(){null!==t&&(t.apply(this,arguments),t=null)}}function l(t){return N(t)||"number"==typeof t.length&&t.length>=0&&t.length%1==0}function u(t,e){for(var i=-1,n=t.length;++i<n;)e(t[i],i,t)}function c(t,e){for(var i=-1,n=t.length,s=Array(n);++i<n;)s[i]=e(t[i],i,t);return s}function d(t){return c(Array(t),(function(t,e){return e}))}function p(t,e,i){return u(t,(function(t,n,s){i=e(i,t,n,s)})),i}function f(t,e){u(U(t),(function(i){e(t[i],i)}))}function g(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}function v(t){var e,i,n=-1;return l(t)?(e=t.length,function(){return n++,e>n?n:null}):(i=U(t),e=i.length,function(){return n++,e>n?i[n]:null})}function m(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),n=Array(i),s=0;i>s;s++)n[s]=arguments[s+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n)}}}function y(t){return function(e,i,n){return t(e,n)}}function _(t){return function(e,i,s){s=h(s||n);var r=v(e=e||[]);if(0>=t)return s(null);var o=!1,l=0,u=!1;!function n(){if(o&&0>=l)return s(null);for(;t>l&&!u;){var h=r();if(null===h)return o=!0,void(0>=l&&s(null));l+=1,i(e[h],h,a((function(t){l-=1,t?(s(t),u=!0):n()})))}}()}}function b(t){return function(e,i,n){return t(j.eachOf,e,i,n)}}function w(t){return function(e,i,n,s){return t(_(i),e,n,s)}}function x(t){return function(e,i,n){return t(j.eachOfSeries,e,i,n)}}function T(t,e,i,s){s=h(s||n);var r=l(e=e||[])?[]:{};t(e,(function(t,e,n){i(t,(function(t,i){r[e]=i,n(t)}))}),(function(t){s(t,r)}))}function E(t,e,i,n){var s=[];t(e,(function(t,e,n){i(t,(function(i){i&&s.push({index:e,value:t}),n()}))}),(function(){n(c(s.sort((function(t,e){return t.index-e.index})),(function(t){return t.value})))}))}function S(t,e,i,n){E(t,e,(function(t,e){i(t,(function(t){e(!t)}))}),n)}function A(t,e,i){return function(n,s,r,o){function a(){o&&o(i(!1,void 0))}function h(t,n,s){return o?void r(t,(function(n){o&&e(n)&&(o(i(!0,t)),o=r=!1),s()})):s()}arguments.length>3?t(n,s,h,a):(o=r,r=s,t(n,h,a))}}function P(t,e){return e}function C(t,e,i){i=i||n;var s=l(e)?[]:{};t(e,(function(t,e,i){t(m((function(t,n){n.length<=1&&(n=n[0]),s[e]=n,i(t)})))}),(function(t){i(t,s)}))}function M(t,e,i,n){var s=[];t(e,(function(t,e,n){i(t,(function(t,e){s=s.concat(e||[]),n(t)}))}),(function(t){n(t,s)}))}function L(t,e,i){function s(t,e,i,s){if(null!=s&&"function"!=typeof s)throw new Error("task callback must be a function");return t.started=!0,N(e)||(e=[e]),0===e.length&&t.idle()?j.setImmediate((function(){t.drain()})):(u(e,(function(e){var r={data:e,callback:s||n};i?t.tasks.unshift(r):t.tasks.push(r),t.tasks.length===t.concurrency&&t.saturated()})),void j.setImmediate(t.process))}function r(t,e){return function(){o-=1;var i=!1,n=arguments;u(e,(function(t){u(h,(function(e,n){e!==t||i||(h.splice(n,1),i=!0)})),t.callback.apply(t,n)})),t.tasks.length+o===0&&t.drain(),t.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var o=0,h=[],l={tasks:[],concurrency:e,payload:i,saturated:n,empty:n,drain:n,started:!1,paused:!1,push:function(t,e){s(l,t,!1,e)},kill:function(){l.drain=n,l.tasks=[]},unshift:function(t,e){s(l,t,!0,e)},process:function(){for(;!l.paused&&o<l.concurrency&&l.tasks.length;){var e=l.payload?l.tasks.splice(0,l.payload):l.tasks.splice(0,l.tasks.length),i=c(e,(function(t){return t.data}));0===l.tasks.length&&l.empty(),o+=1,h.push(e[0]);var n=a(r(l,e));t(i,n)}},length:function(){return l.tasks.length},running:function(){return o},workersList:function(){return h},idle:function(){return l.tasks.length+o===0},pause:function(){l.paused=!0},resume:function(){if(!1!==l.paused){l.paused=!1;for(var t=Math.min(l.concurrency,l.tasks.length),e=1;t>=e;e++)j.setImmediate(l.process)}}};return l}function O(t){return m((function(e,i){e.apply(null,i.concat([m((function(e,i){"object"==typeof console&&(e?console.error&&console.error(e):console[t]&&u(i,(function(e){console[t](e)})))}))]))}))}function R(t){return function(e,i,n){t(d(e),i,n)}}function I(t){return m((function(e,i){var n=m((function(i){var n=this,s=i.pop();return t(e,(function(t,e,s){t.apply(n,i.concat([s]))}),s)}));return i.length?n.apply(this,i):n}))}function D(t){return m((function(e){var i=e.pop();e.push((function(){var t=arguments;n?j.setImmediate((function(){i.apply(null,t)})):i.apply(null,t)}));var n=!0;t.apply(this,e),n=!1}))}var k,j={},B="object"==typeof self&&self.self===self&&self||"object"==typeof i&&i.global===i&&i||this;null!=B&&(k=B.async),j.noConflict=function(){return B.async=k,j};var F=Object.prototype.toString,N=Array.isArray||function(t){return"[object Array]"===F.call(t)},U=Object.keys||function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e},X="function"==typeof setImmediate&&setImmediate,H=X?function(t){X(t)}:function(t){setTimeout(t,0)};"object"==typeof t&&"function"==typeof t.nextTick?j.nextTick=t.nextTick:j.nextTick=H,j.setImmediate=X?H:j.nextTick,j.forEach=j.each=function(t,e,i){return j.eachOf(t,y(e),i)},j.forEachSeries=j.eachSeries=function(t,e,i){return j.eachOfSeries(t,y(e),i)},j.forEachLimit=j.eachLimit=function(t,e,i,n){return _(e)(t,y(i),n)},j.forEachOf=j.eachOf=function(t,e,i){function s(t){l--,t?i(t):null===r&&0>=l&&i(null)}i=h(i||n);for(var r,o=v(t=t||[]),l=0;null!=(r=o());)l+=1,e(t[r],r,a(s));0===l&&i(null)},j.forEachOfSeries=j.eachOfSeries=function(t,e,i){i=h(i||n);var s=v(t=t||[]),r=s();!function n(){var o=!0;return null===r?i(null):(e(t[r],r,a((function(t){if(t)i(t);else{if(null===(r=s()))return i(null);o?j.setImmediate(n):n()}}))),void(o=!1))}()},j.forEachOfLimit=j.eachOfLimit=function(t,e,i,n){_(e)(t,i,n)},j.map=b(T),j.mapSeries=x(T),j.mapLimit=w(T),j.inject=j.foldl=j.reduce=function(t,e,i,n){j.eachOfSeries(t,(function(t,n,s){i(e,t,(function(t,i){e=i,s(t)}))}),(function(t){n(t,e)}))},j.foldr=j.reduceRight=function(t,e,i,n){var r=c(t,s).reverse();j.reduce(r,e,i,n)},j.transform=function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=N(t)?[]:{}),j.eachOf(t,(function(t,n,s){i(e,t,n,s)}),(function(t){n(t,e)}))},j.select=j.filter=b(E),j.selectLimit=j.filterLimit=w(E),j.selectSeries=j.filterSeries=x(E),j.reject=b(S),j.rejectLimit=w(S),j.rejectSeries=x(S),j.any=j.some=A(j.eachOf,r,s),j.someLimit=A(j.eachOfLimit,r,s),j.all=j.every=A(j.eachOf,o,o),j.everyLimit=A(j.eachOfLimit,o,o),j.detect=A(j.eachOf,s,P),j.detectSeries=A(j.eachOfSeries,s,P),j.detectLimit=A(j.eachOfLimit,s,P),j.sortBy=function(t,e,i){function n(t,e){var i=t.criteria,n=e.criteria;return n>i?-1:i>n?1:0}j.map(t,(function(t,i){e(t,(function(e,n){e?i(e):i(null,{value:t,criteria:n})}))}),(function(t,e){return t?i(t):void i(null,c(e.sort(n),(function(t){return t.value})))}))},j.auto=function(t,e,i){function s(t){y.unshift(t)}function r(t){var e=g(y,t);e>=0&&y.splice(e,1)}function o(){l--,u(y.slice(0),(function(t){t()}))}"function"==typeof arguments[1]&&(i=e,e=null),i=h(i||n);var a=U(t),l=a.length;if(!l)return i(null);e||(e=l);var c={},d=0,v=!1,y=[];s((function(){l||i(null,c)})),u(a,(function(n){function a(){return e>d&&p(y,(function(t,e){return t&&c.hasOwnProperty(e)}),!0)&&!c.hasOwnProperty(n)}if(!v){for(var h,l=N(t[n])?t[n]:[t[n]],u=m((function(t,e){if(d--,e.length<=1&&(e=e[0]),t){var s={};f(c,(function(t,e){s[e]=t})),s[n]=e,v=!0,i(t,s)}else c[n]=e,j.setImmediate(o)})),y=l.slice(0,l.length-1),_=y.length;_--;){if(!(h=t[y[_]]))throw new Error("Has nonexistent dependency in "+y.join(", "));if(N(h)&&g(h,n)>=0)throw new Error("Has cyclic dependencies")}a()?(d++,l[l.length-1](u,c)):s((function t(){a()&&(d++,r(t),l[l.length-1](u,c))}))}}))},j.retry=function(t,e,i){function n(t,e){if("number"==typeof e)t.times=parseInt(e,10)||r;else{if("object"!=typeof e)throw new Error("Unsupported argument type for 'times': "+typeof e);t.times=parseInt(e.times,10)||r,t.interval=parseInt(e.interval,10)||o}}function s(t,e){function i(t,i){return function(n){t((function(t,e){n(!t||i,{err:t,result:e})}),e)}}function n(t){return function(e){setTimeout((function(){e(null)}),t)}}for(;h.times;){var s=!(h.times-=1);a.push(i(h.task,s)),!s&&h.interval>0&&a.push(n(h.interval))}j.series(a,(function(e,i){i=i[i.length-1],(t||h.callback)(i.err,i.result)}))}var r=5,o=0,a=[],h={times:r,interval:o},l=arguments.length;if(1>l||l>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=l&&"function"==typeof t&&(i=e,e=t),"function"!=typeof t&&n(h,t),h.callback=i,h.task=e,h.callback?s():s},j.waterfall=function(t,e){if(e=h(e||n),!N(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}return t.length?void function t(i){return m((function(n,s){if(n)e.apply(null,[n].concat(s));else{var r=i.next();r?s.push(t(r)):s.push(e),D(i).apply(null,s)}}))}(j.iterator(t))():e()},j.parallel=function(t,e){C(j.eachOf,t,e)},j.parallelLimit=function(t,e,i){C(_(e),t,i)},j.series=function(t,e){C(j.eachOfSeries,t,e)},j.iterator=function(t){return function e(i){function n(){return t.length&&t[i].apply(null,arguments),n.next()}return n.next=function(){return i<t.length-1?e(i+1):null},n}(0)},j.apply=m((function(t,e){return m((function(i){return t.apply(null,e.concat(i))}))})),j.concat=b(M),j.concatSeries=x(M),j.whilst=function(t,e,i){if(i=i||n,t()){var s=m((function(n,r){n?i(n):t.apply(this,r)?e(s):i.apply(null,[null].concat(r))}));e(s)}else i(null)},j.doWhilst=function(t,e,i){var n=0;return j.whilst((function(){return++n<=1||e.apply(this,arguments)}),t,i)},j.until=function(t,e,i){return j.whilst((function(){return!t.apply(this,arguments)}),e,i)},j.doUntil=function(t,e,i){return j.doWhilst(t,(function(){return!e.apply(this,arguments)}),i)},j.during=function(t,e,i){i=i||n;var s=m((function(e,n){e?i(e):(n.push(r),t.apply(this,n))})),r=function(t,n){t?i(t):n?e(s):i(null)};t(r)},j.doDuring=function(t,e,i){var n=0;j.during((function(t){n++<1?t(null,!0):e.apply(this,arguments)}),t,i)},j.queue=function(t,e){return L((function(e,i){t(e[0],i)}),e,1)},j.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}function s(t,e,s,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");return t.started=!0,N(e)||(e=[e]),0===e.length?j.setImmediate((function(){t.drain()})):void u(e,(function(e){var o={data:e,priority:s,callback:"function"==typeof r?r:n};t.tasks.splice(function(t,e,i){for(var n=-1,s=t.length-1;s>n;){var r=n+(s-n+1>>>1);i(e,t[r])>=0?n=r:s=r-1}return n}(t.tasks,o,i)+1,0,o),t.tasks.length===t.concurrency&&t.saturated(),j.setImmediate(t.process)}))}var r=j.queue(t,e);return r.push=function(t,e,i){s(r,t,e,i)},delete r.unshift,r},j.cargo=function(t,e){return L(t,1,e)},j.log=O("log"),j.dir=O("dir"),j.memoize=function(t,e){var i={},n={},r=Object.prototype.hasOwnProperty;e=e||s;var o=m((function(s){var o=s.pop(),a=e.apply(null,s);r.call(i,a)?j.setImmediate((function(){o.apply(null,i[a])})):r.call(n,a)?n[a].push(o):(n[a]=[o],t.apply(null,s.concat([m((function(t){i[a]=t;var e=n[a];delete n[a];for(var s=0,r=e.length;r>s;s++)e[s].apply(null,t)}))])))}));return o.memo=i,o.unmemoized=t,o},j.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},j.times=R(j.map),j.timesSeries=R(j.mapSeries),j.timesLimit=function(t,e,i,n){return j.mapLimit(d(t),e,i,n)},j.seq=function(){var t=arguments;return m((function(e){var i=this,s=e[e.length-1];"function"==typeof s?e.pop():s=n,j.reduce(t,e,(function(t,e,n){e.apply(i,t.concat([m((function(t,e){n(t,e)}))]))}),(function(t,e){s.apply(i,[t].concat(e))}))}))},j.compose=function(){return j.seq.apply(null,Array.prototype.reverse.call(arguments))},j.applyEach=I(j.eachOf),j.applyEachSeries=I(j.eachOfSeries),j.forever=function(t,e){var i=a(e||n),s=D(t);!function t(e){return e?i(e):void s(t)}()},j.ensureAsync=D,j.constant=m((function(t){var e=[null].concat(t);return function(t){return t.apply(this,e)}})),j.wrapSync=j.asyncify=function(t){return m((function(e){var i,n=e.pop();try{i=t.apply(this,e)}catch(t){return n(t)}!function(t){var e=typeof t;return"function"===e||"object"===e&&!!t}(i)||"function"!=typeof i.then?n(null,i):i.then((function(t){n(null,t)})).catch((function(t){n(t.message?t:new Error(t))}))}))},"object"==typeof e&&e.exports?e.exports=j:B.async=j}()}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],2:[function(t,e,i){(function(t){function e(t,e){for(var i=0,n=t.length-1;n>=0;n--){var s=t[n];"."===s?t.splice(n,1):".."===s?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(t){return s.exec(t).slice(1)};i.resolve=function(){for(var i="",s=!1,r=arguments.length-1;r>=-1&&!s;r--){var o=r>=0?arguments[r]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(i=o+"/"+i,s="/"===o.charAt(0))}return(s?"/":"")+(i=e(n(i.split("/"),(function(t){return!!t})),!s).join("/"))||"."},i.normalize=function(t){var s=i.isAbsolute(t),r="/"===o(t,-1);return(t=e(n(t.split("/"),(function(t){return!!t})),!s).join("/"))||s||(t="."),t&&r&&(t+="/"),(s?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(n(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},i.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var s=n(t.split("/")),r=n(e.split("/")),o=Math.min(s.length,r.length),a=o,h=0;o>h;h++)if(s[h]!==r[h]){a=h;break}var l=[];for(h=a;h<s.length;h++)l.push("..");return(l=l.concat(r.slice(a))).join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=r(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},i.basename=function(t,e){var i=r(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return r(t)[3]};var o="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return 0>e&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:3}],3:[function(t,e,i){function n(){u=!1,a.length?l=a.concat(l):c=-1,l.length&&s()}function s(){if(!u){var t=setTimeout(n);u=!0;for(var e=l.length;e;){for(a=l,l=[];++c<e;)a&&a[c].run();c=-1,e=l.length}a=null,u=!1,clearTimeout(t)}}function r(t,e){this.fun=t,this.array=e}function o(){}var a,h=e.exports={},l=[],u=!1,c=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new r(t,e)),1!==l.length||u||setTimeout(s,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=o,h.addListener=o,h.once=o,h.off=o,h.removeListener=o,h.removeAllListeners=o,h.emit=o,h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],4:[function(t,e,i){(function(t){!function(n){function s(t){throw new RangeError(O[t])}function r(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function o(t,e){var i=t.split("@"),n="";return i.length>1&&(n=i[0]+"@",t=i[1]),n+r((t=t.replace(L,".")).split("."),e).join(".")}function a(t){for(var e,i,n=[],s=0,r=t.length;r>s;)(e=t.charCodeAt(s++))>=55296&&56319>=e&&r>s?56320==(64512&(i=t.charCodeAt(s++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),s--):n.push(e);return n}function h(t){return r(t,(function(t){var e="";return t>65535&&(e+=D((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+D(t)})).join("")}function l(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:b}function u(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function c(t,e,i){var n=0;for(t=i?I(t/E):t>>1,t+=I(t/e);t>R*x>>1;n+=b)t=I(t/R);return I(n+(R+1)*t/(t+T))}function d(t){var e,i,n,r,o,a,u,d,p,f,g=[],v=t.length,m=0,y=A,T=S;for(0>(i=t.lastIndexOf(P))&&(i=0),n=0;i>n;++n)t.charCodeAt(n)>=128&&s("not-basic"),g.push(t.charCodeAt(n));for(r=i>0?i+1:0;v>r;){for(o=m,a=1,u=b;r>=v&&s("invalid-input"),((d=l(t.charCodeAt(r++)))>=b||d>I((_-m)/a))&&s("overflow"),m+=d*a,!((p=T>=u?w:u>=T+x?x:u-T)>d);u+=b)a>I(_/(f=b-p))&&s("overflow"),a*=f;T=c(m-o,e=g.length+1,0==o),I(m/e)>_-y&&s("overflow"),y+=I(m/e),m%=e,g.splice(m++,0,y)}return h(g)}function p(t){var e,i,n,r,o,h,l,d,p,f,g,v,m,y,T,E=[];for(v=(t=a(t)).length,e=A,i=0,o=S,h=0;v>h;++h)128>(g=t[h])&&E.push(D(g));for(n=r=E.length,r&&E.push(P);v>n;){for(l=_,h=0;v>h;++h)(g=t[h])>=e&&l>g&&(l=g);for(l-e>I((_-i)/(m=n+1))&&s("overflow"),i+=(l-e)*m,e=l,h=0;v>h;++h)if(e>(g=t[h])&&++i>_&&s("overflow"),g==e){for(d=i,p=b;!((f=o>=p?w:p>=o+x?x:p-o)>d);p+=b)T=d-f,y=b-f,E.push(D(u(f+T%y,0))),d=I(T/y);E.push(D(u(d,0))),o=c(i,m,n==r),i=0,++n}++i,++e}return E.join("")}var f="object"==typeof i&&i&&!i.nodeType&&i,g="object"==typeof e&&e&&!e.nodeType&&e,v="object"==typeof t&&t;(v.global===v||v.window===v||v.self===v)&&(n=v);var m,y,_=2147483647,b=36,w=1,x=26,T=38,E=700,S=72,A=128,P="-",C=/^xn--/,M=/[^\x20-\x7E]/,L=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=b-w,I=Math.floor,D=String.fromCharCode;if(m={version:"1.3.2",ucs2:{decode:a,encode:h},decode:d,encode:p,toASCII:function(t){return o(t,(function(t){return M.test(t)?"xn--"+p(t):t}))},toUnicode:function(t){return o(t,(function(t){return C.test(t)?d(t.slice(4).toLowerCase()):t}))}},f&&g)if(e.exports==f)g.exports=m;else for(y in m)m.hasOwnProperty(y)&&(f[y]=m[y]);else n.punycode=m}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,e,i){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,i,r){e=e||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(e);var h=1e3;r&&"number"==typeof r.maxKeys&&(h=r.maxKeys);var l=t.length;h>0&&l>h&&(l=h);for(var u=0;l>u;++u){var c,d,p,f,g=t[u].replace(a,"%20"),v=g.indexOf(i);v>=0?(c=g.substr(0,v),d=g.substr(v+1)):(c=g,d=""),p=decodeURIComponent(c),f=decodeURIComponent(d),n(o,p)?s(o[p])?o[p].push(f):o[p]=[o[p],f]:o[p]=f}return o};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],6:[function(t,e,i){"use strict";function n(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var s=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?n(o(t),(function(o){var a=encodeURIComponent(s(o))+i;return r(t[o])?n(t[o],(function(t){return a+encodeURIComponent(s(t))})).join(e):a+encodeURIComponent(s(t[o]))})).join(e):a?encodeURIComponent(s(a))+i+encodeURIComponent(s(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],7:[function(t,e,i){"use strict";i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":5,"./encode":6}],8:[function(t,e,i){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function s(t,e,i){if(t&&o(t)&&t instanceof n)return t;var s=new n;return s.parse(t,e,i),s}function r(t){return"string"==typeof t}function o(t){return"object"==typeof t&&null!==t}function a(t){return null===t}var h=t("punycode");i.parse=s,i.resolve=function(t,e){return s(t,!1,!0).resolve(e)},i.resolveObject=function(t,e){return t?s(t,!1,!0).resolveObject(e):e},i.format=function(t){return r(t)&&(t=s(t)),t instanceof n?t.format():n.prototype.format.call(t)},i.Url=n;var l=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(c),p=["%","/","?",";","#"].concat(d),f=["/","?","#"],g=/^[a-z0-9A-Z_-]{0,63}$/,v=/^([a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=t("querystring");n.prototype.parse=function(t,e,i){if(!r(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t;n=n.trim();var s=l.exec(n);if(s){var o=(s=s[0]).toLowerCase();this.protocol=o,n=n.substr(s.length)}if(i||s||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===n.substr(0,2);!a||s&&y[s]||(n=n.substr(2),this.slashes=!0)}if(!y[s]&&(a||s&&!_[s])){for(var u=-1,c=0;c<f.length;c++){-1!==(T=n.indexOf(f[c]))&&(-1===u||u>T)&&(u=T)}var w,x;-1!==(x=-1===u?n.lastIndexOf("@"):n.lastIndexOf("@",u))&&(w=n.slice(0,x),n=n.slice(x+1),this.auth=decodeURIComponent(w)),u=-1;for(c=0;c<p.length;c++){var T;-1!==(T=n.indexOf(p[c]))&&(-1===u||u>T)&&(u=T)}-1===u&&(u=n.length),this.host=n.slice(0,u),n=n.slice(u),this.parseHost(),this.hostname=this.hostname||"";var E="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!E)for(var S=this.hostname.split(/\./),A=(c=0,S.length);A>c;c++){var P=S[c];if(P&&!P.match(g)){for(var C="",M=0,L=P.length;L>M;M++)C+=P.charCodeAt(M)>127?"x":P[M];if(!C.match(g)){var O=S.slice(0,c),R=S.slice(c+1),I=P.match(v);I&&(O.push(I[1]),R.unshift(I[2])),R.length&&(n="/"+R.join(".")+n),this.hostname=O.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!E){var D=this.hostname.split("."),k=[];for(c=0;c<D.length;++c){var j=D[c];k.push(j.match(/[^A-Za-z0-9_-]/)?"xn--"+h.encode(j):j)}this.hostname=k.join(".")}var B=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+B,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!m[o])for(c=0,A=d.length;A>c;c++){var N=d[c],U=encodeURIComponent(N);U===N&&(U=escape(N)),n=n.split(N).join(U)}var X=n.indexOf("#");-1!==X&&(this.hash=n.substr(X),n=n.slice(0,X));var H=n.indexOf("?");if(-1!==H?(this.search=n.substr(H),this.query=n.substr(H+1),e&&(this.query=b.parse(this.query)),n=n.slice(0,H)):e&&(this.search="",this.query={}),n&&(this.pathname=n),_[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"",j=this.search||"";this.path=B+j}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",s=!1,r="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&o(this.query)&&Object.keys(this.query).length&&(r=b.stringify(this.query));var a=this.search||r&&"?"+r||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||_[e])&&!1!==s?(s="//"+(s||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):s||(s=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),e+s+(i=i.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+n},n.prototype.resolve=function(t){return this.resolveObject(s(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(r(t)){var e=new n;e.parse(t,!1,!0),t=e}var i=new n;if(Object.keys(this).forEach((function(t){i[t]=this[t]}),this),i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol)return Object.keys(t).forEach((function(e){"protocol"!==e&&(i[e]=t[e])})),_[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i;if(t.protocol&&t.protocol!==i.protocol){if(!_[t.protocol])return Object.keys(t).forEach((function(e){i[e]=t[e]})),i.href=i.format(),i;if(i.protocol=t.protocol,t.host||y[t.protocol])i.pathname=t.pathname;else{for(var s=(t.pathname||"").split("/");s.length&&!(t.host=s.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==s[0]&&s.unshift(""),s.length<2&&s.unshift(""),i.pathname=s.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var o=i.pathname||"",h=i.search||"";i.path=o+h}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var l=i.pathname&&"/"===i.pathname.charAt(0),u=t.host||t.pathname&&"/"===t.pathname.charAt(0),c=u||l||i.host&&t.pathname,d=c,p=i.pathname&&i.pathname.split("/")||[],f=(s=t.pathname&&t.pathname.split("/")||[],i.protocol&&!_[i.protocol]);if(f&&(i.hostname="",i.port=null,i.host&&(""===p[0]?p[0]=i.host:p.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===s[0]?s[0]=t.host:s.unshift(t.host)),t.host=null),c=c&&(""===s[0]||""===p[0])),u)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,p=s;else if(s.length)p||(p=[]),p.pop(),p=p.concat(s),i.search=t.search,i.query=t.query;else if(!function(t){return null==t}(t.search)){if(f)i.hostname=i.host=p.shift(),(w=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=w.shift(),i.host=i.hostname=w.shift());return i.search=t.search,i.query=t.query,a(i.pathname)&&a(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!p.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var g=p.slice(-1)[0],v=(i.host||t.host)&&("."===g||".."===g)||""===g,m=0,b=p.length;b>=0;b--)"."==(g=p[b])?p.splice(b,1):".."===g?(p.splice(b,1),m++):m&&(p.splice(b,1),m--);if(!c&&!d)for(;m--;m)p.unshift("..");!c||""===p[0]||p[0]&&"/"===p[0].charAt(0)||p.unshift(""),v&&"/"!==p.join("/").substr(-1)&&p.push("");var w,x=""===p[0]||p[0]&&"/"===p[0].charAt(0);f&&(i.hostname=i.host=x?"":p.length?p.shift():"",(w=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=w.shift(),i.host=i.hostname=w.shift()));return(c=c||i.host&&p.length)&&!x&&p.unshift(""),p.length?i.pathname=p.join("/"):(i.pathname=null,i.path=null),a(i.pathname)&&a(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},n.prototype.parseHost=function(){var t=this.host,e=u.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{punycode:4,querystring:7}],9:[function(t,e,i){"use strict";function n(t,e,i,n,s){var r,o,a,h=0;for(r=e,o=i-n;i>r;r+=n)h+=(t[o]-t[r])*(t[r+1]+t[o+1]),o=r;if(s===h>0)for(r=e;i>r;r+=n)a=T(r,t[r],t[r+1],a);else for(r=i-n;r>=e;r-=n)a=T(r,t[r],t[r+1],a);return a}function s(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!_(n,n.next)&&0!==y(n.prev,n,n.next))n=n.next;else{if(E(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e}function r(t,e,i,n,u,c,d){if(t){!d&&c&&p(t,n,u,c);for(var f,g,v=t;t.prev!==t.next;)if(f=t.prev,g=t.next,c?a(t,n,u,c):o(t))e.push(f.i/i),e.push(t.i/i),e.push(g.i/i),E(t),t=g.next,v=g.next;else if((t=g)===v){d?1===d?r(t=h(t,e,i),e,i,n,u,c,2):2===d&&l(t,e,i,n,u,c):r(s(t),e,i,n,u,c,1);break}}}function o(t){var e=t.prev,i=t,n=t.next;if(y(e,i,n)>=0)return!1;for(var s=t.next.next;s!==t.prev;){if(v(e.x,e.y,i.x,i.y,n.x,n.y,s.x,s.y)&&y(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function a(t,e,i,n){var s=t.prev,r=t,o=t.next;if(y(s,r,o)>=0)return!1;for(var a=s.x<r.x?s.x<o.x?s.x:o.x:r.x<o.x?r.x:o.x,h=s.y<r.y?s.y<o.y?s.y:o.y:r.y<o.y?r.y:o.y,l=s.x>r.x?s.x>o.x?s.x:o.x:r.x>o.x?r.x:o.x,u=s.y>r.y?s.y>o.y?s.y:o.y:r.y>o.y?r.y:o.y,c=f(a,h,e,i,n),d=f(l,u,e,i,n),p=t.nextZ;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&v(s.x,s.y,r.x,r.y,o.x,o.y,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&v(s.x,s.y,r.x,r.y,o.x,o.y,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function h(t,e,i){var n=t;do{var s=n.prev,r=n.next.next;b(s,n,n.next,r)&&w(s,r)&&w(r,s)&&(e.push(s.i/i),e.push(n.i/i),e.push(r.i/i),E(n),E(n.next),n=t=r),n=n.next}while(n!==t);return n}function l(t,e,i,n,o,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&m(h,l)){var u=x(h,l);return h=s(h,h.next),u=s(u,u.next),r(h,e,i,n,o,a),void r(u,e,i,n,o,a)}l=l.next}h=h.next}while(h!==t)}function u(t,e,i,r){var o,a,h,l=[];for(o=0,a=e.length;a>o;o++)(h=n(t,e[o]*r,a-1>o?e[o+1]*r:t.length,r,!1))===h.next&&(h.steiner=!0),l.push(g(h));for(l.sort(c),o=0;o<l.length;o++)d(l[o],i),i=s(i,i.next);return i}function c(t,e){return t.x-e.x}function d(t,e){if(e=function(t,e){var i,n=e,s=t.x,r=t.y,o=-1/0;do{if(r<=n.y&&r>=n.next.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);s>=a&&a>o&&(o=a,i=n.x<n.next.x?n:n.next)}n=n.next}while(n!==e);if(!i)return null;if(t.x===i.x)return i.prev;var h,l=i,u=1/0;for(n=i.next;n!==l;)s>=n.x&&n.x>=i.x&&v(r<i.y?s:o,r,i.x,i.y,r<i.y?o:s,r,n.x,n.y)&&(h=Math.abs(r-n.y)/(s-n.x),(u>h||h===u&&n.x>i.x)&&w(n,t)&&(i=n,u=h)),n=n.next;return i}(t,e)){var i=x(e,t);s(i,i.next)}}function p(t,e,i,n){var s=t;do{null===s.z&&(s.z=f(s.x,s.y,e,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==t);s.prevZ.nextZ=null,s.prevZ=null,function(t){var e,i,n,s,r,o,a,h,l=1;do{for(i=t,t=null,r=null,o=0;i;){for(o++,n=i,a=0,e=0;l>e&&(a++,n=n.nextZ);e++);for(h=l;a>0||h>0&&n;)0===a?(s=n,n=n.nextZ,h--):0!==h&&n?i.z<=n.z?(s=i,i=i.nextZ,a--):(s=n,n=n.nextZ,h--):(s=i,i=i.nextZ,a--),r?r.nextZ=s:t=s,s.prevZ=r,r=s;i=n}r.nextZ=null,l*=2}while(o>1)}(s)}function f(t,e,i,n,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)/s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function v(t,e,i,n,s,r,o,a){return(s-o)*(e-a)-(t-o)*(r-a)>=0&&(t-o)*(n-a)-(i-o)*(e-a)>=0&&(i-o)*(r-a)-(s-o)*(n-a)>=0}function m(t,e){return _(t,e)||t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&b(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&w(t,e)&&w(e,t)&&function(t,e){var i=t,n=!1,s=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)}function y(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,i,n){return y(t,e,i)>0!=y(t,e,n)>0&&y(i,n,t)>0!=y(i,n,e)>0}function w(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function x(t,e){var i=new S(t.i,t.x,t.y),n=new S(e.i,e.x,e.y),s=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function T(t,e,i,n){var s=new S(t,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}e.exports=function(t,e,i){i=i||2;var s,o,a,h,l,c,d,p=e&&e.length,f=p?e[0]*i:t.length,g=n(t,0,f,i,!0),v=[];if(!g)return v;if(p&&(g=u(t,e,g,i)),t.length>80*i){s=a=t[0],o=h=t[1];for(var m=i;f>m;m+=i)s>(l=t[m])&&(s=l),o>(c=t[m+1])&&(o=c),l>a&&(a=l),c>h&&(h=c);d=Math.max(a-s,h-o)}return r(g,v,i,s,o,d),v}},{}],10:[function(t,e,i){"use strict";function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(){}var r="function"!=typeof Object.create&&"~";s.prototype._events=void 0,s.prototype.listeners=function(t,e){var i=r?r+t:t,n=this._events&&this._events[i];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var s=0,o=n.length,a=new Array(o);o>s;s++)a[s]=n[s].fn;return a},s.prototype.emit=function(t,e,i,n,s,o){var a=r?r+t:t;if(!this._events||!this._events[a])return!1;var h,l,u=this._events[a],c=arguments.length;if("function"==typeof u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,n),!0;case 5:return u.fn.call(u.context,e,i,n,s),!0;case 6:return u.fn.call(u.context,e,i,n,s,o),!0}for(l=1,h=new Array(c-1);c>l;l++)h[l-1]=arguments[l];u.fn.apply(u.context,h)}else{var d,p=u.length;for(l=0;p>l;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,i);break;default:if(!h)for(d=1,h=new Array(c-1);c>d;d++)h[d-1]=arguments[d];u[l].fn.apply(u[l].context,h)}}return!0},s.prototype.on=function(t,e,i){var s=new n(e,i||this),o=r?r+t:t;return this._events||(this._events=r?{}:Object.create(null)),this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],s]:this._events[o].push(s):this._events[o]=s,this},s.prototype.once=function(t,e,i){var s=new n(e,i||this,!0),o=r?r+t:t;return this._events||(this._events=r?{}:Object.create(null)),this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],s]:this._events[o].push(s):this._events[o]=s,this},s.prototype.removeListener=function(t,e,i,n){var s=r?r+t:t;if(!this._events||!this._events[s])return this;var o=this._events[s],a=[];if(e)if(o.fn)(o.fn!==e||n&&!o.once||i&&o.context!==i)&&a.push(o);else for(var h=0,l=o.length;l>h;h++)(o[h].fn!==e||n&&!o[h].once||i&&o[h].context!==i)&&a.push(o[h]);return a.length?this._events[s]=1===a.length?a[0]:a:delete this._events[s],this},s.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[r?r+t:t]:this._events=r?{}:Object.create(null),this):this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prototype.setMaxListeners=function(){return this},s.prefixed=r,void 0!==e&&(e.exports=s)},{}],11:[function(t,e,i){"use strict";function n(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(t,e){for(var i,o,a=n(t),h=1;h<arguments.length;h++){for(var l in i=Object(arguments[h]))s.call(i,l)&&(a[l]=i[l]);if(Object.getOwnPropertySymbols){o=Object.getOwnPropertySymbols(i);for(var u=0;u<o.length;u++)r.call(i,o[u])&&(a[o[u]]=i[o[u]])}}return a}},{}],12:[function(t,e,i){(function(t){!function(){function i(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(n,arguments)}}var n,s,r={};null!=(n=this)&&(s=n.async),r.noConflict=function(){return n.async=s,r};var o=Object.prototype.toString,a=Array.isArray||function(t){return"[object Array]"===o.call(t)},h=function(t,e){for(var i=0;i<t.length;i+=1)e(t[i],i,t)},l=function(t,e){if(t.map)return t.map(e);var i=[];return h(t,(function(t,n,s){i.push(e(t,n,s))})),i},u=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e};void 0!==t&&t.nextTick?(r.nextTick=t.nextTick,"undefined"!=typeof setImmediate?r.setImmediate=function(t){setImmediate(t)}:r.setImmediate=r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(t){setImmediate(t)},r.setImmediate=r.nextTick):(r.nextTick=function(t){setTimeout(t,0)},r.setImmediate=r.nextTick),r.each=function(t,e,n){function s(e){e?(n(e),n=function(){}):(r+=1)>=t.length&&n()}if(n=n||function(){},!t.length)return n();var r=0;h(t,(function(t){e(t,i(s))}))},r.forEach=r.each,r.eachSeries=function(t,e,i){if(i=i||function(){},!t.length)return i();var n=0,s=function(){e(t[n],(function(e){e?(i(e),i=function(){}):(n+=1)>=t.length?i():s()}))};s()},r.forEachSeries=r.eachSeries,r.eachLimit=function(t,e,i,n){c(e).apply(null,[t,i,n])},r.forEachLimit=r.eachLimit;var c=function(t){return function(e,i,n){if(n=n||function(){},!e.length||0>=t)return n();var s=0,r=0,o=0;!function a(){if(s>=e.length)return n();for(;t>o&&r<e.length;)o+=1,i(e[(r+=1)-1],(function(t){t?(n(t),n=function(){}):(o-=1,(s+=1)>=e.length?n():a())}))}()}},d=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[r.each].concat(e))}},p=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[r.eachSeries].concat(e))}},f=function(t,e,i,n){if(e=l(e,(function(t,e){return{index:e,value:t}})),n){var s=[];t(e,(function(t,e){i(t.value,(function(i,n){s[t.index]=n,e(i)}))}),(function(t){n(t,s)}))}else t(e,(function(t,e){i(t.value,(function(t){e(t)}))}))};r.map=d(f),r.mapSeries=p(f),r.mapLimit=function(t,e,i,n){return g(e)(t,i,n)};var g=function(t){return function(t,e){return function(){var i=Array.prototype.slice.call(arguments);return e.apply(null,[c(t)].concat(i))}}(t,f)};r.reduce=function(t,e,i,n){r.eachSeries(t,(function(t,n){i(e,t,(function(t,i){e=i,n(t)}))}),(function(t){n(t,e)}))},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(t,e,i,n){var s=l(t,(function(t){return t})).reverse();r.reduce(s,e,i,n)},r.foldr=r.reduceRight;var v=function(t,e,i,n){var s=[];t(e=l(e,(function(t,e){return{index:e,value:t}})),(function(t,e){i(t.value,(function(i){i&&s.push(t),e()}))}),(function(t){n(l(s.sort((function(t,e){return t.index-e.index})),(function(t){return t.value})))}))};r.filter=d(v),r.filterSeries=p(v),r.select=r.filter,r.selectSeries=r.filterSeries;var m=function(t,e,i,n){var s=[];t(e=l(e,(function(t,e){return{index:e,value:t}})),(function(t,e){i(t.value,(function(i){i||s.push(t),e()}))}),(function(t){n(l(s.sort((function(t,e){return t.index-e.index})),(function(t){return t.value})))}))};r.reject=d(m),r.rejectSeries=p(m);var y=function(t,e,i,n){t(e,(function(t,e){i(t,(function(i){i?(n(t),n=function(){}):e()}))}),(function(t){n()}))};r.detect=d(y),r.detectSeries=p(y),r.some=function(t,e,i){r.each(t,(function(t,n){e(t,(function(t){t&&(i(!0),i=function(){}),n()}))}),(function(t){i(!1)}))},r.any=r.some,r.every=function(t,e,i){r.each(t,(function(t,n){e(t,(function(t){t||(i(!1),i=function(){}),n()}))}),(function(t){i(!0)}))},r.all=r.every,r.sortBy=function(t,e,i){r.map(t,(function(t,i){e(t,(function(e,n){e?i(e):i(null,{value:t,criteria:n})}))}),(function(t,e){if(t)return i(t);i(null,l(e.sort((function(t,e){var i=t.criteria,n=e.criteria;return n>i?-1:i>n?1:0})),(function(t){return t.value})))}))},r.auto=function(t,e){e=e||function(){};var i=u(t),n=i.length;if(!n)return e();var s={},o=[],l=function(t){o.unshift(t)},c=function(t){for(var e=0;e<o.length;e+=1)if(o[e]===t)return void o.splice(e,1)},d=function(){n--,h(o.slice(0),(function(t){t()}))};l((function(){if(!n){var t=e;e=function(){},t(null,s)}})),h(i,(function(i){var n=a(t[i])?t[i]:[t[i]],o=function(t){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1&&(n=n[0]),t){var o={};h(u(s),(function(t){o[t]=s[t]})),o[i]=n,e(t,o),e=function(){}}else s[i]=n,r.setImmediate(d)},p=n.slice(0,Math.abs(n.length-1))||[],f=function(){return function(t,e,i){return t.reduce?t.reduce(e,i):(h(t,(function(t,n,s){i=e(i,t,n,s)})),i)}(p,(function(t,e){return t&&s.hasOwnProperty(e)}),!0)&&!s.hasOwnProperty(i)};if(f())n[n.length-1](o,s);else{var g=function(){f()&&(c(g),n[n.length-1](o,s))};l(g)}}))},r.retry=function(t,e,i){var n=[];"function"==typeof t&&(i=e,e=t,t=5),t=parseInt(t,10)||5;var s=function(s,o){for(var a=function(t,e){return function(i){t((function(t,n){i(!t||e,{err:t,result:n})}),o)}};t;)n.push(a(e,!(t-=1)));r.series(n,(function(t,e){e=e[e.length-1],(s||i)(e.err,e.result)}))};return i?s():s},r.waterfall=function(t,e){if(e=e||function(){},!a(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length)return e();var n=function(t){return function(i){if(i)e.apply(null,arguments),e=function(){};else{var s=Array.prototype.slice.call(arguments,1),o=t.next();o?s.push(n(o)):s.push(e),r.setImmediate((function(){t.apply(null,s)}))}}};n(r.iterator(t))()};var _=function(t,e,i){if(i=i||function(){},a(e))t.map(e,(function(t,e){t&&t((function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)}))}),i);else{var n={};t.each(u(e),(function(t,i){e[t]((function(e){var s=Array.prototype.slice.call(arguments,1);s.length<=1&&(s=s[0]),n[t]=s,i(e)}))}),(function(t){i(t,n)}))}};r.parallel=function(t,e){_({map:r.map,each:r.each},t,e)},r.parallelLimit=function(t,e,i){_({map:g(e),each:c(e)},t,i)},r.series=function(t,e){if(e=e||function(){},a(t))r.mapSeries(t,(function(t,e){t&&t((function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)}))}),e);else{var i={};r.eachSeries(u(t),(function(e,n){t[e]((function(t){var s=Array.prototype.slice.call(arguments,1);s.length<=1&&(s=s[0]),i[e]=s,n(t)}))}),(function(t){e(t,i)}))}},r.iterator=function(t){var e=function(i){var n=function(){return t.length&&t[i].apply(null,arguments),n.next()};return n.next=function(){return i<t.length-1?e(i+1):null},n};return e(0)},r.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var b=function(t,e,i,n){var s=[];t(e,(function(t,e){i(t,(function(t,i){s=s.concat(i||[]),e(t)}))}),(function(t){n(t,s)}))};r.concat=d(b),r.concatSeries=p(b),r.whilst=function(t,e,i){t()?e((function(n){return n?i(n):void r.whilst(t,e,i)})):i()},r.doWhilst=function(t,e,i){t((function(n){if(n)return i(n);var s=Array.prototype.slice.call(arguments,1);e.apply(null,s)?r.doWhilst(t,e,i):i()}))},r.until=function(t,e,i){t()?i():e((function(n){return n?i(n):void r.until(t,e,i)}))},r.doUntil=function(t,e,i){t((function(n){if(n)return i(n);var s=Array.prototype.slice.call(arguments,1);e.apply(null,s)?i():r.doUntil(t,e,i)}))},r.queue=function(t,e){function n(t,e,i,n){return t.started||(t.started=!0),a(e)||(e=[e]),0==e.length?r.setImmediate((function(){t.drain&&t.drain()})):void h(e,(function(e){var s={data:e,callback:"function"==typeof n?n:null};i?t.tasks.unshift(s):t.tasks.push(s),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),r.setImmediate(t.process)}))}void 0===e&&(e=1);var s=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,e){n(o,t,!1,e)},kill:function(){o.drain=null,o.tasks=[]},unshift:function(t,e){n(o,t,!0,e)},process:function(){if(!o.paused&&s<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),s+=1;var n=i((function(){s-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+s===0&&o.drain(),o.process()}));t(e.data,n)}},length:function(){return o.tasks.length},running:function(){return s},idle:function(){return o.tasks.length+s===0},pause:function(){!0!==o.paused&&(o.paused=!0)},resume:function(){if(!1!==o.paused){o.paused=!1;for(var t=1;t<=o.concurrency;t++)r.setImmediate(o.process)}}};return o},r.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}function n(t,e,n,s){return t.started||(t.started=!0),a(e)||(e=[e]),0==e.length?r.setImmediate((function(){t.drain&&t.drain()})):void h(e,(function(e){var o={data:e,priority:n,callback:"function"==typeof s?s:null};t.tasks.splice(function(t,e,i){for(var n=-1,s=t.length-1;s>n;){var r=n+(s-n+1>>>1);i(e,t[r])>=0?n=r:s=r-1}return n}(t.tasks,o,i)+1,0,o),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),r.setImmediate(t.process)}))}var s=r.queue(t,e);return s.push=function(t,e,i){n(s,t,e,i)},delete s.unshift,s},r.cargo=function(t,e){var i=!1,n=[],s={tasks:n,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(t,i){a(t)||(t=[t]),h(t,(function(t){n.push({data:t,callback:"function"==typeof i?i:null}),s.drained=!1,s.saturated&&n.length===e&&s.saturated()})),r.setImmediate(s.process)},process:function r(){if(!i){if(0===n.length)return s.drain&&!s.drained&&s.drain(),void(s.drained=!0);var o="number"==typeof e?n.splice(0,e):n.splice(0,n.length),a=l(o,(function(t){return t.data}));s.empty&&s.empty(),i=!0,t(a,(function(){i=!1;var t=arguments;h(o,(function(e){e.callback&&e.callback.apply(null,t)})),r()}))}},length:function(){return n.length},running:function(){return i}};return s};var w=function(t){return function(e){var i=Array.prototype.slice.call(arguments,1);e.apply(null,i.concat([function(e){var i=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&h(i,(function(e){console[t](e)})))}]))}};r.log=w("log"),r.dir=w("dir"),r.memoize=function(t,e){var i={},n={};e=e||function(t){return t};var s=function(){var s=Array.prototype.slice.call(arguments),o=s.pop(),a=e.apply(null,s);a in i?r.nextTick((function(){o.apply(null,i[a])})):a in n?n[a].push(o):(n[a]=[o],t.apply(null,s.concat([function(){i[a]=arguments;var t=n[a];delete n[a];for(var e=0,s=t.length;s>e;e++)t[e].apply(null,arguments)}])))};return s.memo=i,s.unmemoized=t,s},r.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},r.times=function(t,e,i){for(var n=[],s=0;t>s;s++)n.push(s);return r.map(n,e,i)},r.timesSeries=function(t,e,i){for(var n=[],s=0;t>s;s++)n.push(s);return r.mapSeries(n,e,i)},r.seq=function(){var t=arguments;return function(){var e=this,i=Array.prototype.slice.call(arguments),n=i.pop();r.reduce(t,i,(function(t,i,n){i.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);n(t,e)}]))}),(function(t,i){n.apply(e,[t].concat(i))}))}},r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var x=function(t,e){var i=function(){var i=this,n=Array.prototype.slice.call(arguments),s=n.pop();return t(e,(function(t,e){t.apply(i,n.concat([e]))}),s)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return i.apply(this,n)}return i};r.applyEach=d(x),r.applyEachSeries=p(x),r.forever=function(t,e){!function i(n){if(n){if(e)return e(n);throw n}t(i)}()},void 0!==e&&e.exports?e.exports=r:n.async=r}()}).call(this,t("_process"))},{_process:3}],13:[function(t,e,i){function n(t,e){a.call(this),e=e||10,this.baseUrl=t||"",this.progress=0,this.loading=!1,this._progressChunk=0,this._beforeMiddleware=[],this._afterMiddleware=[],this._boundLoadResource=this._loadResource.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._buffer=[],this._numToLoad=0,this._queue=s.queue(this._boundLoadResource,e),this.resources={}}var s=t("async"),r=t("url"),o=t("./Resource"),a=t("eventemitter3");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.add=n.prototype.enqueue=function(t,e,i,n){if(Array.isArray(t)){for(var s=0;s<t.length;++s)this.add(t[s]);return this}if("object"==typeof t&&(n=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(n=i,i=null),this.resources[t])throw new Error('Resource with name "'+t+'" already exists.');return e=this._handleBaseUrl(e),this.resources[t]=new o(t,e,i),"function"==typeof n&&this.resources[t].once("afterMiddleware",n),this._numToLoad++,this._queue.started?(this._queue.push(this.resources[t]),this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[t]),this._progressChunk=100/this._buffer.length),this},n.prototype._handleBaseUrl=function(t){var e=r.parse(t);return e.protocol||0===e.pathname.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t},n.prototype.before=n.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},n.prototype.after=n.prototype.use=function(t){return this._afterMiddleware.push(t),this},n.prototype.reset=function(){this.progress=0,this.loading=!1,this._progressChunk=0,this._buffer.length=0,this._numToLoad=0,this._queue.kill(),this._queue.started=!1,this.resources={}},n.prototype.load=function(t){if("function"==typeof t&&this.once("complete",t),this._queue.started)return this;this.emit("start",this);for(var e=0;e<this._buffer.length;++e)this._queue.push(this._buffer[e]);return this._buffer.length=0,this},n.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,this._runMiddleware(t,this._beforeMiddleware,(function(){t.load(i._boundOnLoad)}))},n.prototype._onComplete=function(){this.emit("complete",this,this.resources)},n.prototype._onLoad=function(t){this.progress+=this._progressChunk,this.emit("progress",this,t),this._runMiddleware(t,this._afterMiddleware,(function(){t.emit("afterMiddleware",t),this._numToLoad--,0===this._numToLoad&&(this.progress=100,this._onComplete()),t.error?this.emit("error",t.error,this,t):this.emit("load",this,t)})),t._dequeue()},n.prototype._runMiddleware=function(t,e,i){var n=this;s.eachSeries(e,(function(e,i){e.call(n,t,i)}),i.bind(this,t))},n.LOAD_TYPE=o.LOAD_TYPE,n.XHR_READY_STATE=o.XHR_READY_STATE,n.XHR_RESPONSE_TYPE=o.XHR_RESPONSE_TYPE},{"./Resource":14,async:12,eventemitter3:10,url:8}],14:[function(t,e,i){function n(t,e,i){if(o.call(this),i=i||{},"string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");this.name=t,this.url=e,this.isDataUrl=0===this.url.indexOf("data:"),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.isJson=!1,this.isXml=!1,this.isImage=!1,this.isAudio=!1,this.isVideo=!1,this._dequeue=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function s(t){return t.toString().replace("object ","")}function r(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}var o=t("eventemitter3"),a=t("url"),h=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),l=null;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError),this.data.removeEventListener("load",this._boundComplete),this.data.removeEventListener("progress",this._boundOnProgress),this.data.removeEventListener("canplaythrough",this._boundComplete)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError),this.xhr.removeEventListener("abort",this._boundXhrOnAbort),this.xhr.removeEventListener("progress",this._boundOnProgress),this.xhr.removeEventListener("load",this._boundXhrOnLoad)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.emit("complete",this)},n.prototype.load=function(t){switch(this.emit("start",this),t&&this.once("complete",t),(!1===this.crossOrigin||"string"!=typeof this.crossOrigin)&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case n.LOAD_TYPE.IMAGE:this._loadImage();break;case n.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case n.LOAD_TYPE.VIDEO:this._loadElement("video");break;case n.LOAD_TYPE.XHR:default:h&&this.crossOrigin?this._loadXdr():this._loadXhr()}},n.prototype._loadImage=function(){this.data=new Image,this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.data.src=this.url,this.isImage=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},n.prototype._loadElement=function(t){if("audio"===t&&"undefined"!=typeof Audio?this.data=new Audio:this.data=document.createElement(t),null===this.data)return this.error=new Error("Unsupported element "+t),void this.complete();if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=0;e<this.url.length;++e)this.data.appendChild(this._createSource(t,this.url[e]));else this.data.appendChild(this._createSource(t,this.url));this["is"+t[0].toUpperCase()+t.substring(1)]=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},n.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),this.xhrType===n.XHR_RESPONSE_TYPE.JSON||this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=n.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},n.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){t.send()}),0)},n.prototype._createSource=function(t,e,i){i||(i=t+"/"+e.substr(e.lastIndexOf(".")+1));var n=document.createElement("source");return n.src=e,n.type=i,n},n.prototype._onError=function(t){this.error=new Error("Failed to load element using "+t.target.nodeName),this.complete()},n.prototype._onProgress=function(t){t&&t.lengthComputable&&this.emit("progress",this,t.loaded/t.total)},n.prototype._xhrOnError=function(){this.error=new Error(s(this.xhr)+" Request failed. Status: "+this.xhr.status+', text: "'+this.xhr.statusText+'"'),this.complete()},n.prototype._xhrOnAbort=function(){this.error=new Error(s(this.xhr)+" Request was aborted by the user."),this.complete()},n.prototype._xdrOnTimeout=function(){this.error=new Error(s(this.xhr)+" Request timed out."),this.complete()},n.prototype._xhrOnLoad=function(){var t=this.xhr,e=void 0!==t.status?t.status:200;if(200===e||204===e||0===e&&t.responseText.length>0)if(this.xhrType===n.XHR_RESPONSE_TYPE.TEXT)this.data=t.responseText;else if(this.xhrType===n.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(t.responseText),this.isJson=!0}catch(t){this.error=new Error("Error trying to parse loaded json:",t)}else if(this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var i=new DOMParser;this.data=i.parseFromString(t.responseText,"text/xml")}else{var s=document.createElement("div");s.innerHTML=t.responseText,this.data=s}this.isXml=!0}catch(t){this.error=new Error("Error trying to parse loaded xml:",t)}else this.data=t.response||t.responseText;else this.error=new Error("["+t.status+"]"+t.statusText+":"+t.responseURL);this.complete()},n.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,l||(l=document.createElement("a")),l.href=t;var i=!(t=a.parse(l.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"},n.prototype._determineXhrType=function(){return n._xhrTypeMap[this._getExtension()]||n.XHR_RESPONSE_TYPE.TEXT},n.prototype._determineLoadType=function(){return n._loadTypeMap[this._getExtension()]||n.LOAD_TYPE.XHR},n.prototype._getExtension=function(){var t,e=this.url;if(this.isDataUrl){var i=e.indexOf("/");t=e.substring(i+1,e.indexOf(";",i))}else{var n=e.indexOf("?");-1!==n&&(e=e.substring(0,n)),t=e.substring(e.lastIndexOf(".")+1)}return t},n.prototype._getMimeFromXhrType=function(t){switch(t){case n.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case n.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case n.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case n.XHR_RESPONSE_TYPE.JSON:return"application/json";case n.XHR_RESPONSE_TYPE.DEFAULT:case n.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},n.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},n.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},n.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},n._loadTypeMap={gif:n.LOAD_TYPE.IMAGE,png:n.LOAD_TYPE.IMAGE,bmp:n.LOAD_TYPE.IMAGE,jpg:n.LOAD_TYPE.IMAGE,jpeg:n.LOAD_TYPE.IMAGE,tif:n.LOAD_TYPE.IMAGE,tiff:n.LOAD_TYPE.IMAGE,webp:n.LOAD_TYPE.IMAGE,tga:n.LOAD_TYPE.IMAGE},n._xhrTypeMap={xhtml:n.XHR_RESPONSE_TYPE.DOCUMENT,html:n.XHR_RESPONSE_TYPE.DOCUMENT,htm:n.XHR_RESPONSE_TYPE.DOCUMENT,xml:n.XHR_RESPONSE_TYPE.DOCUMENT,tmx:n.XHR_RESPONSE_TYPE.DOCUMENT,tsx:n.XHR_RESPONSE_TYPE.DOCUMENT,svg:n.XHR_RESPONSE_TYPE.DOCUMENT,gif:n.XHR_RESPONSE_TYPE.BLOB,png:n.XHR_RESPONSE_TYPE.BLOB,bmp:n.XHR_RESPONSE_TYPE.BLOB,jpg:n.XHR_RESPONSE_TYPE.BLOB,jpeg:n.XHR_RESPONSE_TYPE.BLOB,tif:n.XHR_RESPONSE_TYPE.BLOB,tiff:n.XHR_RESPONSE_TYPE.BLOB,webp:n.XHR_RESPONSE_TYPE.BLOB,tga:n.XHR_RESPONSE_TYPE.BLOB,json:n.XHR_RESPONSE_TYPE.JSON,text:n.XHR_RESPONSE_TYPE.TEXT,txt:n.XHR_RESPONSE_TYPE.TEXT},n.setExtensionLoadType=function(t,e){r(n._loadTypeMap,t,e)},n.setExtensionXhrType=function(t,e){r(n._xhrTypeMap,t,e)}},{eventemitter3:10,url:8}],15:[function(t,e,i){e.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(t){for(var e,i="",n=new Array(4),s=0,r=0;s<t.length;){for(e=new Array(3),r=0;r<e.length;r++)s<t.length?e[r]=255&t.charCodeAt(s++):e[r]=0;switch(n[0]=e[0]>>2,n[1]=(3&e[0])<<4|e[1]>>4,n[2]=(15&e[1])<<2|e[2]>>6,n[3]=63&e[2],s-(t.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(r=0;r<n.length;r++)i+=this._keyStr.charAt(n[r])}return i}}},{}],16:[function(t,e,i){e.exports=t("./Loader"),e.exports.Resource=t("./Resource"),e.exports.middleware={caching:{memory:t("./middlewares/caching/memory")},parsing:{blob:t("./middlewares/parsing/blob")}}},{"./Loader":13,"./Resource":14,"./middlewares/caching/memory":17,"./middlewares/parsing/blob":18}],17:[function(t,e,i){var n={};e.exports=function(){return function(t,e){n[t.url]?(t.data=n[t.url],t.complete()):t.once("complete",(function(){n[this.url]=this.data})),e()}}},{}],18:[function(t,e,i){var n=t("../../Resource"),s=t("../../b64");window.URL=window.URL||window.webkitURL,e.exports=function(){return function(t,e){if(!t.data)return e();if(t.xhr&&t.xhrType===n.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=URL.createObjectURL(t.data);t.blob=t.data,t.data=new Image,t.data.src=i,t.isImage=!0,t.data.onload=function(){URL.revokeObjectURL(i),t.data.onload=null,e()}}}else{var r=t.xhr.getResponseHeader("content-type");r&&0===r.indexOf("image")&&(t.data=new Image,t.data.src="data:"+r+";base64,"+s.encodeBinary(t.xhr.responseText),t.isImage=!0,t.data.onload=function(){t.data.onload=null,e()})}else e()}}},{"../../Resource":14,"../../b64":15}],19:[function(t,e,i){e.exports={name:"pixi.js",version:"3.0.9",description:"Pixi.js is a fast lightweight 2D library that works across all devices.",author:"Mat Groves",contributors:["Chad Engler <chad@pantherdev.com>","Richard Davey <rdavey@gmail.com>"],main:"./src/index.js",homepage:"http://goodboydigital.com/",bugs:"https://github.com/pixijs/pixi.js/issues",license:"MIT",repository:{type:"git",url:"https://github.com/pixijs/pixi.js.git"},scripts:{start:"gulp && gulp watch",test:"gulp && testem ci",build:"gulp",docs:"jsdoc -c ./gulp/util/jsdoc.conf.json -R README.md"},files:["bin/","src/","CONTRIBUTING.md","LICENSE","package.json","README.md"],dependencies:{async:"^1.5.0",brfs:"^1.4.1",earcut:"^2.0.7",eventemitter3:"^1.1.1","object-assign":"^4.0.1","resource-loader":"^1.6.4"},devDependencies:{browserify:"^11.1.0",chai:"^3.2.0",del:"^2.0.2",gulp:"^3.9.0","gulp-cached":"^1.1.0","gulp-concat":"^2.6.0","gulp-debug":"^2.1.0","gulp-header":"^1.7.1","gulp-jshint":"^1.11.2","gulp-mirror":"^0.4.0","gulp-plumber":"^1.0.1","gulp-rename":"^1.2.2","gulp-sourcemaps":"^1.5.2","gulp-uglify":"^1.4.1","gulp-util":"^3.0.6","jaguarjs-jsdoc":"git+https://github.com/davidshimjs/jaguarjs-jsdoc.git",jsdoc:"^3.3.2","jshint-summary":"^0.4.0",minimist:"^1.2.0",mocha:"^2.3.2","require-dir":"^0.3.0","run-sequence":"^1.1.2",testem:"^0.9.4","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.1.0",watchify:"^3.4.0"},browserify:{transform:["brfs"]}}},{}],20:[function(t,e,i){function n(t){var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,window.addEventListener("keydown",this._onKeyDown,!1)}var s=t("../core");Object.assign(s.DisplayObject.prototype,t("./accessibleTarget")),n.prototype.constructor=n,e.exports=n,n.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode.appendChild(this.div))},n.prototype.deactivate=function(){this.isActive&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode.removeChild(this.div))},n.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=e.length-1;i>=0;i--)this.updateAccessibleObjects(e[i])}},n.prototype.update=function(){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,n=this.div;n.style.left=t.left+"px",n.style.top=t.top+"px",n.style.width=this.renderer.width+"px",n.style.height=this.renderer.height+"px";for(var r=0;r<this.children.length;r++){var o=this.children[r];if(o.renderId!==this.renderId)o._accessibleActive=!1,s.utils.removeItems(this.children,r,1),this.div.removeChild(o._accessibleDiv),this.pool.push(o._accessibleDiv),o._accessibleDiv=null,r--,0===this.children.length&&this.deactivate();else{n=o._accessibleDiv;var a=o.hitArea,h=o.worldTransform;o.hitArea?(n.style.left=(h.tx+a.x*h.a)*e+"px",n.style.top=(h.ty+a.y*h.d)*i+"px",n.style.width=a.width*h.a*e+"px",n.style.height=a.height*h.d*i+"px"):(a=o.getBounds(),this.capHitArea(a),n.style.left=a.x*e+"px",n.style.top=a.y*i+"px",n.style.width=a.width*e+"px",n.style.height=a.height*i+"px")}}this.renderId++},n.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},n.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.title=t.accessibleTitle||"displayObject "+this.tabIndex,t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},n.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},n.prototype._onFocus=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},n.prototype._onFocusOut=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},n.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},n.prototype._onMouseMove=function(){this.deactivate()},n.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},s.WebGLRenderer.registerPlugin("accessibility",n),s.CanvasRenderer.registerPlugin("accessibility",n)},{"../core":30,"./accessibleTarget":21}],21:[function(t,e,i){e.exports={accessible:!1,accessibleTitle:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],22:[function(t,e,i){e.exports={accessibleTarget:t("./accessibleTarget"),AccessibilityManager:t("./AccessibilityManager")}},{"./AccessibilityManager":20,"./accessibleTarget":21}],23:[function(t,e,i){var n={VERSION:t("../../package.json").version,PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,TARGET_FPMS:.06,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},DRAW_MODES:{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3};e.exports=n},{"../../package.json":19}],24:[function(t,e,i){function n(){o.call(this),this.children=[]}var s=t("../math"),r=t("../utils"),o=t("./DisplayObject"),a=t("../textures/RenderTexture"),h=new s.Matrix;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{width:{configurable:!0,get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},height:{configurable:!0,get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}}),n.prototype.onChildrenChange=function(){},n.prototype.addChild=function(t){var e=arguments.length;if(e>1)for(var i=0;e>i;i++)this.addChild(arguments[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.children.push(t),this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},n.prototype.addChildAt=function(t,e){if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.onChildrenChange(e),t.emit("added",this),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},n.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);if(0>i||0>n)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[i]=e,this.children[n]=t,this.onChildrenChange(n>i?i:n)}},n.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},n.prototype.setChildIndex=function(t,e){if(0>e||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);r.removeItems(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},n.prototype.getChildAt=function(t){if(0>t||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[t]},n.prototype.removeChild=function(t){var e=arguments.length;if(e>1)for(var i=0;e>i;i++)this.removeChild(arguments[i]);else{var n=this.children.indexOf(t);if(-1===n)return;t.parent=null,r.removeItems(this.children,n,1),this.onChildrenChange(n),t.emit("removed",this)}return t},n.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,r.removeItems(this.children,t,1),this.onChildrenChange(t),e.emit("removed",this),e},n.prototype.removeChildren=function(t,e){var i,n,s=t||0,r="number"==typeof e?e:this.children.length,o=r-s;if(o>0&&r>=o){for(i=this.children.splice(s,o),n=0;n<i.length;++n)i[n].parent=null;for(this.onChildrenChange(t),n=0;n<i.length;++n)i[n].emit("removed",this);return i}if(0===o&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},n.prototype.generateTexture=function(t,e,i){var n=this.getLocalBounds(),s=new a(t,0|n.width,0|n.height,i,e);return h.tx=-n.x,h.ty=-n.y,s.render(this,h),s},n.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var t=0,e=this.children.length;e>t;++t)this.children[t].updateTransform()}},n.prototype.containerUpdateTransform=n.prototype.updateTransform,n.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return s.Rectangle.EMPTY;for(var t,e,i,n=1/0,r=1/0,o=-1/0,a=-1/0,h=!1,l=0,u=this.children.length;u>l;++l){this.children[l].visible&&(h=!0,n=n<(t=this.children[l].getBounds()).x?n:t.x,r=r<t.y?r:t.y,o=o>(e=t.width+t.x)?o:e,a=a>(i=t.height+t.y)?a:i)}if(!h)return s.Rectangle.EMPTY;var c=this._bounds;c.x=n,c.y=r,c.width=o-n,c.height=a-r,this._currentBounds=c}return this._currentBounds},n.prototype.containerGetBounds=n.prototype.getBounds,n.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=s.Matrix.IDENTITY;for(var e=0,i=this.children.length;i>e;++e)this.children[e].updateTransform();return this.worldTransform=t,this._currentBounds=null,this.getBounds(s.Matrix.IDENTITY)},n.prototype.renderWebGL=function(t){var e,i;if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters){for(t.currentRenderer.flush(),this._filters&&this._filters.length&&t.filterManager.pushFilter(this,this._filters),this._mask&&t.maskManager.pushMask(this,this._mask),t.currentRenderer.start(),this._renderWebGL(t),e=0,i=this.children.length;i>e;e++)this.children[e].renderWebGL(t);t.currentRenderer.flush(),this._mask&&t.maskManager.popMask(this,this._mask),this._filters&&t.filterManager.popFilter(),t.currentRenderer.start()}else for(this._renderWebGL(t),e=0,i=this.children.length;i>e;++e)this.children[e].renderWebGL(t)},n.prototype._renderWebGL=function(t){},n.prototype._renderCanvas=function(t){},n.prototype.renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask,t),this._renderCanvas(t);for(var e=0,i=this.children.length;i>e;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},n.prototype.destroy=function(t){if(o.prototype.destroy.call(this),t)for(var e=0,i=this.children.length;i>e;++e)this.children[e].destroy(t);this.removeChildren(),this.children=null}},{"../math":33,"../textures/RenderTexture":71,"../utils":77,"./DisplayObject":25}],25:[function(t,e,i){function n(){o.call(this),this.position=new s.Point,this.scale=new s.Point(1,1),this.pivot=new s.Point(0,0),this.skew=new s.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new s.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new s.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null}var s=t("../math"),r=t("../textures/RenderTexture"),o=t("eventemitter3"),a=t("../const"),h=new s.Matrix,l={worldTransform:new s.Matrix,worldAlpha:1,children:[]};n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},worldVisible:{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},mask:{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}}),n.prototype.updateTransform=function(){var t,e,i,n,s,r,o=this.parent.worldTransform,l=this.worldTransform;this.skew.x||this.skew.y?(h.setTransform(this.position.x,this.position.y,this.pivot.x,this.pivot.y,this.scale.x,this.scale.y,this.rotation,this.skew.x,this.skew.y),l.a=h.a*o.a+h.b*o.c,l.b=h.a*o.b+h.b*o.d,l.c=h.c*o.a+h.d*o.c,l.d=h.c*o.b+h.d*o.d,l.tx=h.tx*o.a+h.ty*o.c+o.tx,l.ty=h.tx*o.b+h.ty*o.d+o.ty):this.rotation%a.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,e=this._sr*this.scale.x,i=-this._sr*this.scale.y,n=this._cr*this.scale.y,s=this.position.x,r=this.position.y,(this.pivot.x||this.pivot.y)&&(s-=this.pivot.x*t+this.pivot.y*i,r-=this.pivot.x*e+this.pivot.y*n),l.a=t*o.a+e*o.c,l.b=t*o.b+e*o.d,l.c=i*o.a+n*o.c,l.d=i*o.b+n*o.d,l.tx=s*o.a+r*o.c+o.tx,l.ty=s*o.b+r*o.d+o.ty):(t=this.scale.x,n=this.scale.y,s=this.position.x-this.pivot.x*t,r=this.position.y-this.pivot.y*n,l.a=t*o.a,l.b=t*o.b,l.c=n*o.c,l.d=n*o.d,l.tx=s*o.a+r*o.c+o.tx,l.ty=s*o.b+r*o.d+o.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},n.prototype.displayObjectUpdateTransform=n.prototype.updateTransform,n.prototype.getBounds=function(t){return s.Rectangle.EMPTY},n.prototype.getLocalBounds=function(){return this.getBounds(s.Matrix.IDENTITY)},n.prototype.toGlobal=function(t,e){return this.parent?this.displayObjectUpdateTransform():(this.parent=l,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i){return e&&(t=e.toGlobal(t,i)),this.parent?this.displayObjectUpdateTransform():(this.parent=l,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.applyInverse(t,i)},n.prototype.renderWebGL=function(t){},n.prototype.renderCanvas=function(t){},n.prototype.generateTexture=function(t,e,i){var n=this.getLocalBounds(),s=new r(t,0|n.width,0|n.height,e,i);return h.tx=-n.x,h.ty=-n.y,s.render(this,h),s},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,n,s,r,o,a,h){return this.position.x=t||0,this.position.y=e||0,this.scale.x=i||1,this.scale.y=n||1,this.rotation=s||0,this.skew.x=r||0,this.skew.y=o||0,this.pivot.x=a||0,this.pivot.y=h||0,this},n.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this.skew=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null}},{"../const":23,"../math":33,"../textures/RenderTexture":71,eventemitter3:10}],26:[function(t,e,i){function n(){s.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=u.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new l.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.boundsDirty=!0,this.cachedSpriteDirty=!1}var s=t("../display/Container"),r=t("../textures/Texture"),o=t("../renderers/canvas/utils/CanvasBuffer"),a=t("../renderers/canvas/utils/CanvasGraphics"),h=t("./GraphicsData"),l=t("../math"),u=t("../const"),c=new l.Point;n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){var t=new n;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=!0,t.glDirty=!0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var e=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},n.prototype.lineStyle=function(t,e,i){if(this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=void 0===i?1:i,this.currentPath)if(this.currentPath.shape.points.length){var n=new l.Polygon(this.currentPath.shape.points.slice(-2));n.closed=!1,this.drawShape(n)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},n.prototype.moveTo=function(t,e){var i=new l.Polygon([t,e]);return i.closed=!1,this.drawShape(i),this},n.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty=!0,this},n.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s,r,o=this.currentPath.shape.points;0===o.length&&this.moveTo(0,0);for(var a=o[o.length-2],h=o[o.length-1],l=0,u=1;20>=u;++u)s=a+(t-a)*(l=u/20),r=h+(e-h)*l,o.push(s+(t+(i-t)*l-s)*l,r+(e+(n-e)*l-r)*l);return this.dirty=this.boundsDirty=!0,this},n.prototype.bezierCurveTo=function(t,e,i,n,s,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var o,a,h,l,u,c=this.currentPath.shape.points,d=c[c.length-2],p=c[c.length-1],f=0,g=1;20>=g;++g)h=(a=(o=1-(f=g/20))*o)*o,u=(l=f*f)*f,c.push(h*d+3*a*f*t+3*o*l*i+u*s,h*p+3*a*f*e+3*o*l*n+u*r);return this.dirty=this.boundsDirty=!0,this},n.prototype.arcTo=function(t,e,i,n,s){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var r=this.currentPath.shape.points,o=r[r.length-2],a=r[r.length-1]-e,h=o-t,l=n-e,u=i-t,c=Math.abs(a*u-h*l);if(1e-8>c||0===s)(r[r.length-2]!==t||r[r.length-1]!==e)&&r.push(t,e);else{var d=a*a+h*h,p=l*l+u*u,f=a*l+h*u,g=s*Math.sqrt(d)/c,v=s*Math.sqrt(p)/c,m=g*f/d,y=v*f/p,_=g*u+v*h,b=g*l+v*a,w=h*(v+m),x=a*(v+m),T=u*(g+y),E=l*(g+y),S=Math.atan2(x-b,w-_),A=Math.atan2(E-b,T-_);this.arc(_+t,b+e,s,S,A,h*l>u*a)}return this.dirty=this.boundsDirty=!0,this},n.prototype.arc=function(t,e,i,n,s,r){if(n===s)return this;!(r=r||!1)&&n>=s?s+=2*Math.PI:r&&s>=n&&(n+=2*Math.PI);var o=r?-1*(n-s):s-n,a=40*Math.ceil(Math.abs(o)/(2*Math.PI));if(0===o)return this;var h=t+Math.cos(n)*i,l=e+Math.sin(n)*i;this.currentPath?this.currentPath.shape.points.push(h,l):this.moveTo(h,l);for(var u=this.currentPath.shape.points,c=o/(2*a),d=2*c,p=Math.cos(c),f=Math.sin(c),g=a-1,v=g%1/g,m=0;g>=m;m++){var y=c+n+d*(m+v*m),_=Math.cos(y),b=-Math.sin(y);u.push((p*_+f*b)*i+t,(p*-b+f*_)*i+e)}return this.dirty=this.boundsDirty=!0,this},n.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},n.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},n.prototype.drawRect=function(t,e,i,n){return this.drawShape(new l.Rectangle(t,e,i,n)),this},n.prototype.drawRoundedRect=function(t,e,i,n,s){return this.drawShape(new l.RoundedRectangle(t,e,i,n,s)),this},n.prototype.drawCircle=function(t,e,i){return this.drawShape(new l.Circle(t,e,i)),this},n.prototype.drawEllipse=function(t,e,i,n){return this.drawShape(new l.Ellipse(t,e,i,n)),this},n.prototype.drawPolygon=function(t){var e=t,i=!0;if(e instanceof l.Polygon&&(i=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}var s=new l.Polygon(e);return s.closed=i,this.drawShape(s),this},n.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},n.prototype.generateTexture=function(t,e,i){e=e||1;var n=this.getLocalBounds(),s=new o(n.width*e,n.height*e),h=r.fromCanvas(s.canvas,i);return h.baseTexture.resolution=e,s.context.scale(e,e),s.context.translate(-n.x,-n.y),a.renderGraphics(this,s.context),h},n.prototype._renderWebGL=function(t){this.glDirty&&(this.dirty=!0,this.glDirty=!1),t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this)},n.prototype._renderCanvas=function(t){if(!0!==this.isMask){this._prevTint!==this.tint&&(this.dirty=!0);var e=t.context,i=this.worldTransform,n=t.blendModes[this.blendMode];n!==e.globalCompositeOperation&&(e.globalCompositeOperation=n);var s=t.resolution;e.setTransform(i.a*s,i.b*s,i.c*s,i.d*s,i.tx*s,i.ty*s),a.renderGraphics(this,e)}},n.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable)return l.Rectangle.EMPTY;this.boundsDirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.boundsDirty=!1);var e=this._localBounds,i=e.x,n=e.width+e.x,s=e.y,r=e.height+e.y,o=t||this.worldTransform,a=o.a,h=o.b,u=o.c,c=o.d,d=o.tx,p=o.ty,f=a*n+u*r+d,g=c*r+h*n+p,v=a*i+u*r+d,m=c*r+h*i+p,y=a*i+u*s+d,_=c*s+h*i+p,b=a*n+u*s+d,w=c*s+h*n+p,x=f,T=g,E=f,S=g;E=(E=(E=E>v?v:E)>y?y:E)>b?b:E,S=(S=(S=S>m?m:S)>_?_:S)>w?w:S,x=b>(x=y>(x=v>x?v:x)?y:x)?b:x,T=w>(T=_>(T=m>T?m:T)?_:T)?w:T,this._bounds.x=E,this._bounds.width=x-E,this._bounds.y=S,this._bounds.height=T-S,this._currentBounds=this._bounds}return this._currentBounds},n.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,c);for(var e=this.graphicsData,i=0;i<e.length;i++){var n=e[i];if(n.fill&&n.shape&&n.shape.contains(c.x,c.y))return!0}return!1},n.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,i=1/0,n=-1/0;if(this.graphicsData.length)for(var s,r,o,a,h,l,c=0;c<this.graphicsData.length;c++){var d=this.graphicsData[c],p=d.type,f=d.lineWidth;if(s=d.shape,p===u.SHAPES.RECT||p===u.SHAPES.RREC)o=s.x-f/2,a=s.y-f/2,t=t>o?o:t,e=o+(h=s.width+f)>e?o+h:e,i=i>a?a:i,n=a+(l=s.height+f)>n?a+l:n;else if(p===u.SHAPES.CIRC)o=s.x,a=s.y,t=t>o-(h=s.radius+f/2)?o-h:t,e=o+h>e?o+h:e,i=i>a-(l=s.radius+f/2)?a-l:i,n=a+l>n?a+l:n;else if(p===u.SHAPES.ELIP)o=s.x,a=s.y,t=t>o-(h=s.width+f/2)?o-h:t,e=o+h>e?o+h:e,i=i>a-(l=s.height+f/2)?a-l:i,n=a+l>n?a+l:n;else{r=s.points;for(var g=0;g<r.length;g+=2)t=t>(o=r[g])-f?o-f:t,e=o+f>e?o+f:e,i=i>(a=r[g+1])-f?a-f:i,n=a+f>n?a+f:n}}else t=0,e=0,i=0,n=0;var v=this.boundsPadding;this._localBounds.x=t-v,this._localBounds.width=e-t+2*v,this._localBounds.y=i-v,this._localBounds.height=n-i+2*v},n.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new h(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(e),e.type===u.SHAPES.POLY&&(e.shape.closed=e.shape.closed||this.filling,this.currentPath=e),this.dirty=this.boundsDirty=!0,e},n.prototype.destroy=function(){s.prototype.destroy.apply(this,arguments);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();for(var e in this._webgl)for(var i=0;i<this._webgl[e].data.length;++i)this._webgl[e].data[i].destroy();this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null}},{"../const":23,"../display/Container":24,"../math":33,"../renderers/canvas/utils/CanvasBuffer":45,"../renderers/canvas/utils/CanvasGraphics":46,"../textures/Texture":72,"./GraphicsData":27}],27:[function(t,e,i){function n(t,e,i,n,s,r,o){this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this._lineTint=e,this.fillColor=n,this.fillAlpha=s,this._fillTint=n,this.fill=r,this.shape=o,this.type=o.type}n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},n.prototype.destroy=function(){this.shape=null}},{}],28:[function(t,e,i){function n(t){a.call(this,t),this.graphicsDataPool=[],this.primitiveShader=null,this.complexPrimitiveShader=null,this.maximumSimplePolySize=200}var s=t("../../utils"),r=t("../../math"),o=t("../../const"),a=t("../../renderers/webgl/utils/ObjectRenderer"),h=t("../../renderers/webgl/WebGLRenderer"),l=t("./WebGLGraphicsData"),u=t("earcut");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,e.exports=n,h.registerPlugin("graphics",n),n.prototype.onContextChange=function(){},n.prototype.destroy=function(){a.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},n.prototype.render=function(t){var e,i=this.renderer,n=i.gl,r=i.shaderManager.plugins.primitiveShader;(t.dirty||!t._webGL[n.id])&&this.updateGraphics(t);var o=t._webGL[n.id];i.blendModeManager.setBlendMode(t.blendMode);for(var a=0,h=o.data.length;h>a;a++)e=o.data[a],1===o.data[a].mode?(i.stencilManager.pushStencil(t,e),n.uniform1f(i.shaderManager.complexPrimitiveShader.uniforms.alpha._location,t.worldAlpha*e.alpha),n.drawElements(n.TRIANGLE_FAN,4,n.UNSIGNED_SHORT,2*(e.indices.length-4)),i.stencilManager.popStencil(t,e)):(r=i.shaderManager.primitiveShader,i.shaderManager.setShader(r),n.uniformMatrix3fv(r.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),n.uniformMatrix3fv(r.uniforms.projectionMatrix._location,!1,i.currentRenderTarget.projectionMatrix.toArray(!0)),n.uniform3fv(r.uniforms.tint._location,s.hex2rgb(t.tint)),n.uniform1f(r.uniforms.alpha._location,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,e.buffer),n.vertexAttribPointer(r.attributes.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(r.attributes.aColor,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer),n.drawElements(n.TRIANGLE_STRIP,e.indices.length,n.UNSIGNED_SHORT,0)),i.drawCount++},n.prototype.updateGraphics=function(t){var e,i,n=this.renderer.gl,s=t._webGL[n.id];if(s||(s=t._webGL[n.id]={lastIndex:0,data:[],gl:n}),t.dirty=!1,t.clearDirty){for(t.clearDirty=!1,e=0;e<s.data.length;e++){var r=s.data[e];r.reset(),this.graphicsDataPool.push(r)}s.data=[],s.lastIndex=0}for(e=s.lastIndex;e<t.graphicsData.length;e++){var a=t.graphicsData[e];if(a.type===o.SHAPES.POLY){if(a.points=a.shape.points.slice(),a.shape.closed&&(a.points[0]!==a.points[a.points.length-2]||a.points[1]!==a.points[a.points.length-1])&&a.points.push(a.points[0],a.points[1]),a.fill&&a.points.length>=6)if(a.points.length<2*this.maximumSimplePolySize){i=this.switchMode(s,0),this.buildPoly(a,i)||(i=this.switchMode(s,1),this.buildComplexPoly(a,i))}else i=this.switchMode(s,1),this.buildComplexPoly(a,i);a.lineWidth>0&&(i=this.switchMode(s,0),this.buildLine(a,i))}else i=this.switchMode(s,0),a.type===o.SHAPES.RECT?this.buildRectangle(a,i):a.type===o.SHAPES.CIRC||a.type===o.SHAPES.ELIP?this.buildCircle(a,i):a.type===o.SHAPES.RREC&&this.buildRoundedRectangle(a,i);s.lastIndex++}for(e=0;e<s.data.length;e++)(i=s.data[e]).dirty&&i.upload()},n.prototype.switchMode=function(t,e){var i;return t.data.length?((i=t.data[t.data.length-1]).points.length>32e4||i.mode!==e||1===e)&&((i=this.graphicsDataPool.pop()||new l(t.gl)).mode=e,t.data.push(i)):((i=this.graphicsDataPool.pop()||new l(t.gl)).mode=e,t.data.push(i)),i.dirty=!0,i},n.prototype.buildRectangle=function(t,e){var i=t.shape,n=i.x,r=i.y,o=i.width,a=i.height;if(t.fill){var h=s.hex2rgb(t.fillColor),l=t.fillAlpha,u=h[0]*l,c=h[1]*l,d=h[2]*l,p=e.points,f=e.indices,g=p.length/6;p.push(n,r),p.push(u,c,d,l),p.push(n+o,r),p.push(u,c,d,l),p.push(n,r+a),p.push(u,c,d,l),p.push(n+o,r+a),p.push(u,c,d,l),f.push(g,g,g+1,g+2,g+3,g+3)}if(t.lineWidth){var v=t.points;t.points=[n,r,n+o,r,n+o,r+a,n,r+a,n,r],this.buildLine(t,e),t.points=v}},n.prototype.buildRoundedRectangle=function(t,e){var i=t.shape,n=i.x,r=i.y,o=i.width,a=i.height,h=i.radius,l=[];if(l.push(n,r+h),this.quadraticBezierCurve(n,r+a-h,n,r+a,n+h,r+a,l),this.quadraticBezierCurve(n+o-h,r+a,n+o,r+a,n+o,r+a-h,l),this.quadraticBezierCurve(n+o,r+h,n+o,r,n+o-h,r,l),this.quadraticBezierCurve(n+h,r,n,r,n,r+h+1e-10,l),t.fill){var c=s.hex2rgb(t.fillColor),d=t.fillAlpha,p=c[0]*d,f=c[1]*d,g=c[2]*d,v=e.points,m=e.indices,y=v.length/6,_=u(l,null,2),b=0;for(b=0;b<_.length;b+=3)m.push(_[b]+y),m.push(_[b]+y),m.push(_[b+1]+y),m.push(_[b+2]+y),m.push(_[b+2]+y);for(b=0;b<l.length;b++)v.push(l[b],l[++b],p,f,g,d)}if(t.lineWidth){var w=t.points;t.points=l,this.buildLine(t,e),t.points=w}},n.prototype.quadraticBezierCurve=function(t,e,i,n,s,r,o){function a(t,e,i){return t+(e-t)*i}for(var h,l,u,c,d,p,f=o||[],g=0,v=0;20>=v;v++)h=a(t,i,g=v/20),l=a(e,n,g),u=a(i,s,g),c=a(n,r,g),d=a(h,u,g),p=a(l,c,g),f.push(d,p);return f},n.prototype.buildCircle=function(t,e){var i,n,r=t.shape,a=r.x,h=r.y;t.type===o.SHAPES.CIRC?(i=r.radius,n=r.radius):(i=r.width,n=r.height);var l=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(r.width+r.height)),u=2*Math.PI/l,c=0;if(t.fill){var d=s.hex2rgb(t.fillColor),p=t.fillAlpha,f=d[0]*p,g=d[1]*p,v=d[2]*p,m=e.points,y=e.indices,_=m.length/6;for(y.push(_),c=0;l+1>c;c++)m.push(a,h,f,g,v,p),m.push(a+Math.sin(u*c)*i,h+Math.cos(u*c)*n,f,g,v,p),y.push(_++,_++);y.push(_-1)}if(t.lineWidth){var b=t.points;for(t.points=[],c=0;l+1>c;c++)t.points.push(a+Math.sin(u*c)*i,h+Math.cos(u*c)*n);this.buildLine(t,e),t.points=b}},n.prototype.buildLine=function(t,e){var i=0,n=t.points;if(0!==n.length){var o=new r.Point(n[0],n[1]),a=new r.Point(n[n.length-2],n[n.length-1]);if(o.x===a.x&&o.y===a.y){(n=n.slice()).pop(),n.pop();var h=(a=new r.Point(n[n.length-2],n[n.length-1])).x+.5*(o.x-a.x),l=a.y+.5*(o.y-a.y);n.unshift(h,l),n.push(h,l)}var u,c,d,p,f,g,v,m,y,_,b,w,x,T,E,S,A,P,C,M,L,O,R=e.points,I=e.indices,D=n.length/2,k=n.length,j=R.length/6,B=t.lineWidth/2,F=s.hex2rgb(t.lineColor),N=t.lineAlpha,U=F[0]*N,X=F[1]*N,H=F[2]*N;for(d=n[0],p=n[1],f=n[2],y=-(p-(g=n[3])),_=d-f,y/=O=Math.sqrt(y*y+_*_),_/=O,y*=B,_*=B,R.push(d-y,p-_,U,X,H,N),R.push(d+y,p+_,U,X,H,N),i=1;D-1>i;i++)d=n[2*(i-1)],p=n[2*(i-1)+1],f=n[2*i],g=n[2*i+1],v=n[2*(i+1)],m=n[2*(i+1)+1],y=-(p-g),_=d-f,y/=O=Math.sqrt(y*y+_*_),_/=O,y*=B,_*=B,b=-(g-m),w=f-v,b/=O=Math.sqrt(b*b+w*w),w/=O,A=(-y+d)*(-_+g)-(-y+f)*(-_+p),M=(-(b*=B)+v)*(-(w*=B)+g)-(-b+f)*(-w+m),L=(E=-_+p-(-_+g))*(C=-b+f-(-b+v))-(P=-w+m-(-w+g))*(S=-y+f-(-y+d)),Math.abs(L)<.1?(L+=10.1,R.push(f-y,g-_,U,X,H,N),R.push(f+y,g+_,U,X,H,N)):((u=(S*M-C*A)/L)-f)*(u-f)+((c=(P*A-E*M)/L)-g)*(c-g)>19600?(x=y-b,T=_-w,x/=O=Math.sqrt(x*x+T*T),T/=O,x*=B,T*=B,R.push(f-x,g-T),R.push(U,X,H,N),R.push(f+x,g+T),R.push(U,X,H,N),R.push(f-x,g-T),R.push(U,X,H,N),k++):(R.push(u,c),R.push(U,X,H,N),R.push(f-(u-f),g-(c-g)),R.push(U,X,H,N));for(d=n[2*(D-2)],p=n[2*(D-2)+1],f=n[2*(D-1)],y=-(p-(g=n[2*(D-1)+1])),_=d-f,y/=O=Math.sqrt(y*y+_*_),_/=O,y*=B,_*=B,R.push(f-y,g-_),R.push(U,X,H,N),R.push(f+y,g+_),R.push(U,X,H,N),I.push(j),i=0;k>i;i++)I.push(j++);I.push(j-1)}},n.prototype.buildComplexPoly=function(t,e){var i=t.points.slice();if(!(i.length<6)){var n=e.indices;e.points=i,e.alpha=t.fillAlpha,e.color=s.hex2rgb(t.fillColor);for(var r,o,a=1/0,h=-1/0,l=1/0,u=-1/0,c=0;c<i.length;c+=2)a=a>(r=i[c])?r:a,h=r>h?r:h,l=l>(o=i[c+1])?o:l,u=o>u?o:u;i.push(a,l,h,l,h,u,a,u);var d=i.length/2;for(c=0;d>c;c++)n.push(c)}},n.prototype.buildPoly=function(t,e){var i=t.points;if(!(i.length<6)){var n=e.points,r=e.indices,o=i.length/2,a=s.hex2rgb(t.fillColor),h=t.fillAlpha,l=a[0]*h,c=a[1]*h,d=a[2]*h,p=u(i,null,2);if(!p)return!1;var f=n.length/6,g=0;for(g=0;g<p.length;g+=3)r.push(p[g]+f),r.push(p[g]+f),r.push(p[g+1]+f),r.push(p[g+2]+f),r.push(p[g+2]+f);for(g=0;o>g;g++)n.push(i[2*g],i[2*g+1],l,c,d,h);return!0}}},{"../../const":23,"../../math":33,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63,"../../utils":77,"./WebGLGraphicsData":29,earcut:9}],29:[function(t,e,i){function n(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0,this.glPoints=null,this.glIndices=null}n.prototype.constructor=n,e.exports=n,n.prototype.reset=function(){this.points.length=0,this.indices.length=0},n.prototype.upload=function(){var t=this.gl;this.glPoints=new Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndices=new Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndices,t.STATIC_DRAW),this.dirty=!1},n.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.gl.deleteBuffer(this.buffer),this.gl.deleteBuffer(this.indexBuffer),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null}},{}],30:[function(t,e,i){var n=e.exports=Object.assign(t("./const"),t("./math"),{utils:t("./utils"),ticker:t("./ticker"),DisplayObject:t("./display/DisplayObject"),Container:t("./display/Container"),Sprite:t("./sprites/Sprite"),ParticleContainer:t("./particles/ParticleContainer"),SpriteRenderer:t("./sprites/webgl/SpriteRenderer"),ParticleRenderer:t("./particles/webgl/ParticleRenderer"),Text:t("./text/Text"),Graphics:t("./graphics/Graphics"),GraphicsData:t("./graphics/GraphicsData"),GraphicsRenderer:t("./graphics/webgl/GraphicsRenderer"),Texture:t("./textures/Texture"),BaseTexture:t("./textures/BaseTexture"),RenderTexture:t("./textures/RenderTexture"),VideoBaseTexture:t("./textures/VideoBaseTexture"),TextureUvs:t("./textures/TextureUvs"),CanvasRenderer:t("./renderers/canvas/CanvasRenderer"),CanvasGraphics:t("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:t("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:t("./renderers/webgl/WebGLRenderer"),WebGLManager:t("./renderers/webgl/managers/WebGLManager"),ShaderManager:t("./renderers/webgl/managers/ShaderManager"),Shader:t("./renderers/webgl/shaders/Shader"),ObjectRenderer:t("./renderers/webgl/utils/ObjectRenderer"),RenderTarget:t("./renderers/webgl/utils/RenderTarget"),AbstractFilter:t("./renderers/webgl/filters/AbstractFilter"),FXAAFilter:t("./renderers/webgl/filters/FXAAFilter"),SpriteMaskFilter:t("./renderers/webgl/filters/SpriteMaskFilter"),autoDetectRenderer:function(t,e,i,s){return t=t||800,e=e||600,!s&&n.utils.isWebGLSupported()?new n.WebGLRenderer(t,e,i):new n.CanvasRenderer(t,e,i)}})},{"./const":23,"./display/Container":24,"./display/DisplayObject":25,"./graphics/Graphics":26,"./graphics/GraphicsData":27,"./graphics/webgl/GraphicsRenderer":28,"./math":33,"./particles/ParticleContainer":39,"./particles/webgl/ParticleRenderer":41,"./renderers/canvas/CanvasRenderer":44,"./renderers/canvas/utils/CanvasBuffer":45,"./renderers/canvas/utils/CanvasGraphics":46,"./renderers/webgl/WebGLRenderer":49,"./renderers/webgl/filters/AbstractFilter":50,"./renderers/webgl/filters/FXAAFilter":51,"./renderers/webgl/filters/SpriteMaskFilter":52,"./renderers/webgl/managers/ShaderManager":56,"./renderers/webgl/managers/WebGLManager":58,"./renderers/webgl/shaders/Shader":61,"./renderers/webgl/utils/ObjectRenderer":63,"./renderers/webgl/utils/RenderTarget":65,"./sprites/Sprite":67,"./sprites/webgl/SpriteRenderer":68,"./text/Text":69,"./textures/BaseTexture":70,"./textures/RenderTexture":71,"./textures/Texture":72,"./textures/TextureUvs":73,"./textures/VideoBaseTexture":74,"./ticker":76,"./utils":77}],31:[function(t,e,i){function n(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var s=t("./Point");n.prototype.constructor=n,e.exports=n,n.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},n.prototype.set=function(t,e,i,n,s,r){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=r,this},n.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},n.prototype.apply=function(t,e){e=e||new s;var i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e},n.prototype.applyInverse=function(t,e){e=e||new s;var i=1/(this.a*this.d+this.c*-this.b),n=t.x,r=t.y;return e.x=this.d*i*n+-this.c*i*r+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*r+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},n.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},n.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},n.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,s=this.c,r=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=s*e-this.d*i,this.d=s*i+this.d*e,this.tx=r*e-this.ty*i,this.ty=r*i+this.ty*e,this},n.prototype.append=function(t){var e=this.a,i=this.b,n=this.c,s=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*s,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*s,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*s+this.ty,this},n.prototype.setTransform=function(t,e,i,n,s,r,o,a,h){var l,u,c,d,p,f,g,v,m,y;return p=Math.sin(o),f=Math.cos(o),g=Math.cos(h),v=Math.sin(h),m=-Math.sin(a),y=Math.cos(a),l=f*s,u=p*s,c=-p*r,d=f*r,this.a=g*l+v*c,this.b=g*u+v*d,this.c=m*l+y*c,this.d=m*u+y*d,this.tx=t+(i*l+n*c),this.ty=e+(i*u+n*d),this},n.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},n.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,r=t*n-e*i;return this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*s)/r,this.ty=-(t*this.ty-e*s)/r,this},n.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},n.prototype.clone=function(){var t=new n;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n.IDENTITY=new n,n.TEMP_MATRIX=new n},{"./Point":32}],32:[function(t,e,i){function n(t,e){this.x=t||0,this.y=e||0}n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copy=function(t){this.set(t.x,t.y)},n.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},n.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)}},{}],33:[function(t,e,i){e.exports={Point:t("./Point"),Matrix:t("./Matrix"),Circle:t("./shapes/Circle"),Ellipse:t("./shapes/Ellipse"),Polygon:t("./shapes/Polygon"),Rectangle:t("./shapes/Rectangle"),RoundedRectangle:t("./shapes/RoundedRectangle")}},{"./Matrix":31,"./Point":32,"./shapes/Circle":34,"./shapes/Ellipse":35,"./shapes/Polygon":36,"./shapes/Rectangle":37,"./shapes/RoundedRectangle":38}],34:[function(t,e,i){function n(t,e,i){this.x=t||0,this.y=e||0,this.radius=i||0,this.type=r.SHAPES.CIRC}var s=t("./Rectangle"),r=t("../../const");n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.x,this.y,this.radius)},n.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.x-t,n=this.y-e;return this.radius*this.radius>=(i*=i)+(n*=n)},n.prototype.getBounds=function(){return new s(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}},{"../../const":23,"./Rectangle":37}],35:[function(t,e,i){function n(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this.type=r.SHAPES.ELIP}var s=t("./Rectangle"),r=t("../../const");n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return 1>=(i*=i)+(n*=n)},n.prototype.getBounds=function(){return new s(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":23,"./Rectangle":37}],36:[function(t,e,i){function n(t){var e=t;if(!Array.isArray(e)){e=new Array(arguments.length);for(var i=0;i<e.length;++i)e[i]=arguments[i]}if(e[0]instanceof s){for(var n=[],o=0,a=e.length;a>o;o++)n.push(e[o].x,e[o].y);e=n}this.closed=!0,this.points=e,this.type=r.SHAPES.POLY}var s=t("../Point"),r=t("../../const");n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.points.slice())},n.prototype.contains=function(t,e){for(var i=!1,n=this.points.length/2,s=0,r=n-1;n>s;r=s++){var o=this.points[2*s],a=this.points[2*s+1],h=this.points[2*r],l=this.points[2*r+1];a>e!=l>e&&(h-o)*(e-a)/(l-a)+o>t&&(i=!i)}return i}},{"../../const":23,"../Point":32}],37:[function(t,e,i){function n(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this.type=s.SHAPES.RECT}var s=t("../../const");n.prototype.constructor=n,e.exports=n,n.EMPTY=new n(0,0,0,0),n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)}},{"../../const":23}],38:[function(t,e,i){function n(t,e,i,n,r){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this.radius=r||20,this.type=s.SHAPES.RREC}var s=t("../../const");n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.radius)},n.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height)}},{"../../const":23}],39:[function(t,e,i){function n(t,e,i){s.call(this);(i=i||15e3)>16384&&(i=16384),i>(t=t||15e3)&&(i=t),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=i,this._buffers=null,this._bufferToUpdate=0,this.interactiveChildren=!1,this.blendMode=r.BLEND_MODES.NORMAL,this.roundPixels=!0,this.setProperties(e)}var s=t("../display/Container"),r=t("../const");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t?!!t.alpha:this._properties[4])},n.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},n.prototype.renderWebGL=function(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},n.prototype.onChildrenChange=function(t){var e=Math.floor(t/this._batchSize);e<this._bufferToUpdate&&(this._bufferToUpdate=e)},n.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,i=this.worldTransform,n=!0,s=0,r=0,o=0,a=0,h=t.blendModes[this.blendMode];h!==e.globalCompositeOperation&&(e.globalCompositeOperation=h),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var u=this.children[l];if(u.visible){var c=u.texture.frame;if(e.globalAlpha=this.worldAlpha*u.alpha,u.rotation%(2*Math.PI)==0)n&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),n=!1),s=u.anchor.x*(-c.width*u.scale.x)+u.position.x+.5,r=u.anchor.y*(-c.height*u.scale.y)+u.position.y+.5,o=c.width*u.scale.x,a=c.height*u.scale.y;else{n||(n=!0),u.displayObjectUpdateTransform();var d=u.worldTransform;t.roundPixels?e.setTransform(d.a,d.b,d.c,d.d,0|d.tx,0|d.ty):e.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty),s=u.anchor.x*-c.width+.5,r=u.anchor.y*-c.height+.5,o=c.width,a=c.height}e.drawImage(u.texture.baseTexture.source,c.x,c.y,c.width,c.height,s,r,o,a)}}}},n.prototype.destroy=function(){if(s.prototype.destroy.apply(this,arguments),this._buffers)for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._properties=null,this._buffers=null}},{"../const":23,"../display/Container":24}],40:[function(t,e,i){function n(t,e,i,n){this.gl=t,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var s=0;s<e.length;s++){var r=e[s];i[s]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}n.prototype.constructor=n,e.exports=n,n.prototype.initBuffers=function(){var t,e,i=this.gl,n=0;for(this.dynamicStride=0,t=0;t<this.dynamicProperties.length;t++)(e=this.dynamicProperties[t]).offset=n,n+=e.size,this.dynamicStride+=e.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.dynamicBuffer),i.bufferData(i.ARRAY_BUFFER,this.dynamicData,i.DYNAMIC_DRAW);var s=0;for(this.staticStride=0,t=0;t<this.staticProperties.length;t++)(e=this.staticProperties[t]).offset=s,s+=e.size,this.staticStride+=e.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.staticBuffer),i.bufferData(i.ARRAY_BUFFER,this.staticData,i.DYNAMIC_DRAW)},n.prototype.uploadDynamic=function(t,e,i){for(var n=this.gl,s=0;s<this.dynamicProperties.length;s++){var r=this.dynamicProperties[s];r.uploadFunction(t,e,i,this.dynamicData,this.dynamicStride,r.offset)}n.bindBuffer(n.ARRAY_BUFFER,this.dynamicBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,this.dynamicData)},n.prototype.uploadStatic=function(t,e,i){for(var n=this.gl,s=0;s<this.staticProperties.length;s++){var r=this.staticProperties[s];r.uploadFunction(t,e,i,this.staticData,this.staticStride,r.offset)}n.bindBuffer(n.ARRAY_BUFFER,this.staticBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,this.staticData)},n.prototype.bind=function(){var t,e,i=this.gl;for(i.bindBuffer(i.ARRAY_BUFFER,this.dynamicBuffer),t=0;t<this.dynamicProperties.length;t++)e=this.dynamicProperties[t],i.vertexAttribPointer(e.attribute,e.size,i.FLOAT,!1,4*this.dynamicStride,4*e.offset);for(i.bindBuffer(i.ARRAY_BUFFER,this.staticBuffer),t=0;t<this.staticProperties.length;t++)e=this.staticProperties[t],i.vertexAttribPointer(e.attribute,e.size,i.FLOAT,!1,4*this.staticStride,4*e.offset)},n.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.gl.deleteBuffer(this.dynamicBuffer),this.staticProperties=null,this.staticData=null,this.gl.deleteBuffer(this.staticBuffer)}},{}],41:[function(t,e,i){function n(t){s.call(this,t);this.indices=new Uint16Array(98304);for(var e=0,i=0;98304>e;e+=6,i+=4)this.indices[e+0]=i+0,this.indices[e+1]=i+1,this.indices[e+2]=i+2,this.indices[e+3]=i+0,this.indices[e+4]=i+2,this.indices[e+5]=i+3;this.shader=null,this.indexBuffer=null,this.properties=null,this.tempMatrix=new h.Matrix}var s=t("../../renderers/webgl/utils/ObjectRenderer"),r=t("../../renderers/webgl/WebGLRenderer"),o=t("./ParticleShader"),a=t("./ParticleBuffer"),h=t("../../math");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,r.registerPlugin("particle",n),n.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new o(this.renderer.shaderManager),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},n.prototype.start=function(){var t=this.renderer.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.shader;this.renderer.shaderManager.setShader(e)},n.prototype.render=function(t){var e=t.children,i=e.length,n=t._maxSize,s=t._batchSize;if(0!==i){i>n&&(i=n),t._buffers||(t._buffers=this.generateBuffers(t)),this.renderer.blendModeManager.setBlendMode(t.blendMode);var r=this.renderer.gl,o=t.worldTransform.copy(this.tempMatrix);o.prepend(this.renderer.currentRenderTarget.projectionMatrix),r.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,!1,o.toArray(!0)),r.uniform1f(this.shader.uniforms.uAlpha._location,t.worldAlpha);var a=e[0]._texture.baseTexture;if(a._glTextures[r.id])r.bindTexture(r.TEXTURE_2D,a._glTextures[r.id]);else{if(!this.renderer.updateTexture(a))return;t._properties[0]&&t._properties[3]||(t._bufferToUpdate=0)}for(var h=0,l=0;i>h;h+=s,l+=1){var u=i-h;u>s&&(u=s);var c=t._buffers[l];c.uploadDynamic(e,h,u),t._bufferToUpdate===l&&(c.uploadStatic(e,h,u),t._bufferToUpdate=l+1),c.bind(this.shader),r.drawElements(r.TRIANGLES,6*u,r.UNSIGNED_SHORT,0),this.renderer.drawCount++}}},n.prototype.generateBuffers=function(t){var e,i=this.renderer.gl,n=[],s=t._maxSize,r=t._batchSize,o=t._properties;for(e=0;s>e;e+=r)n.push(new a(i,this.properties,o,r));return n},n.prototype.uploadVertices=function(t,e,i,n,s,r){for(var o,a,h,l,u,c,d,p,f,g=0;i>g;g++)a=(o=t[e+g])._texture,l=o.scale.x,u=o.scale.y,a.trim?(c=(d=(h=a.trim).x-o.anchor.x*h.width)+a.crop.width,p=(f=h.y-o.anchor.y*h.height)+a.crop.height):(c=a._frame.width*(1-o.anchor.x),d=a._frame.width*-o.anchor.x,p=a._frame.height*(1-o.anchor.y),f=a._frame.height*-o.anchor.y),n[r]=d*l,n[r+1]=f*u,n[r+s]=c*l,n[r+s+1]=f*u,n[r+2*s]=c*l,n[r+2*s+1]=p*u,n[r+3*s]=d*l,n[r+3*s+1]=p*u,r+=4*s},n.prototype.uploadPosition=function(t,e,i,n,s,r){for(var o=0;i>o;o++){var a=t[e+o].position;n[r]=a.x,n[r+1]=a.y,n[r+s]=a.x,n[r+s+1]=a.y,n[r+2*s]=a.x,n[r+2*s+1]=a.y,n[r+3*s]=a.x,n[r+3*s+1]=a.y,r+=4*s}},n.prototype.uploadRotation=function(t,e,i,n,s,r){for(var o=0;i>o;o++){var a=t[e+o].rotation;n[r]=a,n[r+s]=a,n[r+2*s]=a,n[r+3*s]=a,r+=4*s}},n.prototype.uploadUvs=function(t,e,i,n,s,r){for(var o=0;i>o;o++){var a=t[e+o]._texture._uvs;a?(n[r]=a.x0,n[r+1]=a.y0,n[r+s]=a.x1,n[r+s+1]=a.y1,n[r+2*s]=a.x2,n[r+2*s+1]=a.y2,n[r+3*s]=a.x3,n[r+3*s+1]=a.y3,r+=4*s):(n[r]=0,n[r+1]=0,n[r+s]=0,n[r+s+1]=0,n[r+2*s]=0,n[r+2*s+1]=0,n[r+3*s]=0,n[r+3*s+1]=0,r+=4*s)}},n.prototype.uploadAlpha=function(t,e,i,n,s,r){for(var o=0;i>o;o++){var a=t[e+o].alpha;n[r]=a,n[r+s]=a,n[r+2*s]=a,n[r+3*s]=a,r+=4*s}},n.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),s.prototype.destroy.apply(this,arguments),this.shader.destroy(),this.indices=null,this.tempMatrix=null}},{"../../math":33,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63,"./ParticleBuffer":40,"./ParticleShader":42}],42:[function(t,e,i){function n(t){s.call(this,t,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float uAlpha;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n"),{uAlpha:{type:"1f",value:1}},{aPositionCoord:0,aRotation:0})}var s=t("../../renderers/webgl/shaders/TextureShader");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n},{"../../renderers/webgl/shaders/TextureShader":62}],43:[function(t,e,i){function n(t,e,i,n){if(a.call(this),s.sayHello(t),n)for(var h in o.DEFAULT_RENDER_OPTIONS)void 0===n[h]&&(n[h]=o.DEFAULT_RENDER_OPTIONS[h]);else n=o.DEFAULT_RENDER_OPTIONS;this.type=o.RENDERER_TYPE.UNKNOWN,this.width=e||800,this.height=i||600,this.view=n.view||document.createElement("canvas"),this.resolution=n.resolution,this.transparent=n.transparent,this.autoResize=n.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=n.preserveDrawingBuffer,this.clearBeforeRender=n.clearBeforeRender,this.roundPixels=n.roundPixels,this._backgroundColor=0,this._backgroundColorRgb=[0,0,0],this._backgroundColorString="#000000",this.backgroundColor=n.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent={worldTransform:new r.Matrix,worldAlpha:1,children:[]},this._lastObjectRendered=this._tempDisplayObjectParent}var s=t("../utils"),r=t("../math"),o=t("../const"),a=t("eventemitter3");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=s.hex2string(t),s.hex2rgb(t,this._backgroundColorRgb)}}}),n.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},n.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=o.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgb=null,this._backgroundColorString=null}},{"../const":23,"../math":33,"../utils":77,eventemitter3:10}],44:[function(t,e,i){function n(t,e,i){i=i||{},s.call(this,"Canvas",t,e,i),this.type=h.RENDERER_TYPE.CANVAS,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.maskManager=new r,this.smoothProperty="imageSmoothingEnabled",this.context.imageSmoothingEnabled||(this.context.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.context.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.context.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.context.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this._mapBlendModes(),this._tempDisplayObjectParent={worldTransform:new a.Matrix,worldAlpha:1},this.resize(t,e)}var s=t("../SystemRenderer"),r=t("./utils/CanvasMaskManager"),o=t("../../utils"),a=t("../../math"),h=t("../../const");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,o.pluginTarget.mixin(n),n.prototype.render=function(t){this.emit("prerender");var e=t.parent;this._lastObjectRendered=t,t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=e,this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.context.globalCompositeOperation=this.blendModes[h.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=this._backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t,this.context),this.emit("postrender")},n.prototype.destroy=function(t){this.destroyPlugins(),s.prototype.destroy.call(this,t),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},n.prototype.renderDisplayObject=function(t,e){var i=this.context;this.context=e,t.renderCanvas(this),this.context=i},n.prototype.resize=function(t,e){s.prototype.resize.call(this,t,e),this.smoothProperty&&(this.context[this.smoothProperty]=h.SCALE_MODES.DEFAULT===h.SCALE_MODES.LINEAR)},n.prototype._mapBlendModes=function(){this.blendModes||(this.blendModes={},o.canUseNewCanvasBlendModes()?(this.blendModes[h.BLEND_MODES.NORMAL]="source-over",this.blendModes[h.BLEND_MODES.ADD]="lighter",this.blendModes[h.BLEND_MODES.MULTIPLY]="multiply",this.blendModes[h.BLEND_MODES.SCREEN]="screen",this.blendModes[h.BLEND_MODES.OVERLAY]="overlay",this.blendModes[h.BLEND_MODES.DARKEN]="darken",this.blendModes[h.BLEND_MODES.LIGHTEN]="lighten",this.blendModes[h.BLEND_MODES.COLOR_DODGE]="color-dodge",this.blendModes[h.BLEND_MODES.COLOR_BURN]="color-burn",this.blendModes[h.BLEND_MODES.HARD_LIGHT]="hard-light",this.blendModes[h.BLEND_MODES.SOFT_LIGHT]="soft-light",this.blendModes[h.BLEND_MODES.DIFFERENCE]="difference",this.blendModes[h.BLEND_MODES.EXCLUSION]="exclusion",this.blendModes[h.BLEND_MODES.HUE]="hue",this.blendModes[h.BLEND_MODES.SATURATION]="saturate",this.blendModes[h.BLEND_MODES.COLOR]="color",this.blendModes[h.BLEND_MODES.LUMINOSITY]="luminosity"):(this.blendModes[h.BLEND_MODES.NORMAL]="source-over",this.blendModes[h.BLEND_MODES.ADD]="lighter",this.blendModes[h.BLEND_MODES.MULTIPLY]="source-over",this.blendModes[h.BLEND_MODES.SCREEN]="source-over",this.blendModes[h.BLEND_MODES.OVERLAY]="source-over",this.blendModes[h.BLEND_MODES.DARKEN]="source-over",this.blendModes[h.BLEND_MODES.LIGHTEN]="source-over",this.blendModes[h.BLEND_MODES.COLOR_DODGE]="source-over",this.blendModes[h.BLEND_MODES.COLOR_BURN]="source-over",this.blendModes[h.BLEND_MODES.HARD_LIGHT]="source-over",this.blendModes[h.BLEND_MODES.SOFT_LIGHT]="source-over",this.blendModes[h.BLEND_MODES.DIFFERENCE]="source-over",this.blendModes[h.BLEND_MODES.EXCLUSION]="source-over",this.blendModes[h.BLEND_MODES.HUE]="source-over",this.blendModes[h.BLEND_MODES.SATURATION]="source-over",this.blendModes[h.BLEND_MODES.COLOR]="source-over",this.blendModes[h.BLEND_MODES.LUMINOSITY]="source-over"))}},{"../../const":23,"../../math":33,"../../utils":77,"../SystemRenderer":43,"./utils/CanvasMaskManager":47}],45:[function(t,e,i){function n(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e}n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{width:{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},height:{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}}),n.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e},n.prototype.destroy=function(){this.context=null,this.canvas=null}},{}],46:[function(t,e,i){var n=t("../../../const"),s={};e.exports=s,s.renderGraphics=function(t,e){var i=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var s=0;s<t.graphicsData.length;s++){var r=t.graphicsData[s],o=r.shape,a=r._fillTint,h=r._lineTint;if(e.lineWidth=r.lineWidth,r.type===n.SHAPES.POLY){e.beginPath();var l=o.points;e.moveTo(l[0],l[1]);for(var u=1;u<l.length/2;u++)e.lineTo(l[2*u],l[2*u+1]);o.closed&&e.lineTo(l[0],l[1]),l[0]===l[l.length-2]&&l[1]===l[l.length-1]&&e.closePath(),r.fill&&(e.globalAlpha=r.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),r.lineWidth&&(e.globalAlpha=r.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.stroke())}else if(r.type===n.SHAPES.RECT)(r.fillColor||0===r.fillColor)&&(e.globalAlpha=r.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fillRect(o.x,o.y,o.width,o.height)),r.lineWidth&&(e.globalAlpha=r.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.strokeRect(o.x,o.y,o.width,o.height));else if(r.type===n.SHAPES.CIRC)e.beginPath(),e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.closePath(),r.fill&&(e.globalAlpha=r.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),r.lineWidth&&(e.globalAlpha=r.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.stroke());else if(r.type===n.SHAPES.ELIP){var c=2*o.width,d=2*o.height,p=o.x-c/2,f=o.y-d/2;e.beginPath();var g=.5522848,v=c/2*g,m=d/2*g,y=p+c,_=f+d,b=p+c/2,w=f+d/2;e.moveTo(p,w),e.bezierCurveTo(p,w-m,b-v,f,b,f),e.bezierCurveTo(b+v,f,y,w-m,y,w),e.bezierCurveTo(y,w+m,b+v,_,b,_),e.bezierCurveTo(b-v,_,p,w+m,p,w),e.closePath(),r.fill&&(e.globalAlpha=r.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),r.lineWidth&&(e.globalAlpha=r.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.stroke())}else if(r.type===n.SHAPES.RREC){var x=o.x,T=o.y,E=o.width,S=o.height,A=o.radius,P=Math.min(E,S)/2|0;A=A>P?P:A,e.beginPath(),e.moveTo(x,T+A),e.lineTo(x,T+S-A),e.quadraticCurveTo(x,T+S,x+A,T+S),e.lineTo(x+E-A,T+S),e.quadraticCurveTo(x+E,T+S,x+E,T+S-A),e.lineTo(x+E,T+A),e.quadraticCurveTo(x+E,T,x+E-A,T),e.lineTo(x+A,T),e.quadraticCurveTo(x,T,x,T+A),e.closePath(),(r.fillColor||0===r.fillColor)&&(e.globalAlpha=r.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),r.lineWidth&&(e.globalAlpha=r.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.stroke())}}},s.renderGraphicsMask=function(t,e){var i=t.graphicsData.length;if(0!==i){e.beginPath();for(var s=0;i>s;s++){var r=t.graphicsData[s],o=r.shape;if(r.type===n.SHAPES.POLY){var a=o.points;e.moveTo(a[0],a[1]);for(var h=1;h<a.length/2;h++)e.lineTo(a[2*h],a[2*h+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(r.type===n.SHAPES.RECT)e.rect(o.x,o.y,o.width,o.height),e.closePath();else if(r.type===n.SHAPES.CIRC)e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.closePath();else if(r.type===n.SHAPES.ELIP){var l=2*o.width,u=2*o.height,c=o.x-l/2,d=o.y-u/2,p=.5522848,f=l/2*p,g=u/2*p,v=c+l,m=d+u,y=c+l/2,_=d+u/2;e.moveTo(c,_),e.bezierCurveTo(c,_-g,y-f,d,y,d),e.bezierCurveTo(y+f,d,v,_-g,v,_),e.bezierCurveTo(v,_+g,y+f,m,y,m),e.bezierCurveTo(y-f,m,c,_+g,c,_),e.closePath()}else if(r.type===n.SHAPES.RREC){var b=o.x,w=o.y,x=o.width,T=o.height,E=o.radius,S=Math.min(x,T)/2|0;E=E>S?S:E,e.moveTo(b,w+E),e.lineTo(b,w+T-E),e.quadraticCurveTo(b,w+T,b+E,w+T),e.lineTo(b+x-E,w+T),e.quadraticCurveTo(b+x,w+T,b+x,w+T-E),e.lineTo(b+x,w+E),e.quadraticCurveTo(b+x,w,b+x-E,w),e.lineTo(b+E,w),e.quadraticCurveTo(b,w,b,w+E),e.closePath()}}}},s.updateGraphicsTint=function(t){if(16777215!==t.tint||t._prevTint!==t.tint){t._prevTint=t.tint;for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,n=(255&t.tint)/255,s=0;s<t.graphicsData.length;s++){var r=t.graphicsData[s],o=0|r.fillColor,a=0|r.lineColor;r._fillTint=((o>>16&255)/255*e*255<<16)+((o>>8&255)/255*i*255<<8)+(255&o)/255*n*255,r._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*i*255<<8)+(255&a)/255*n*255}}}},{"../../../const":23}],47:[function(t,e,i){function n(){}var s=t("./CanvasGraphics");n.prototype.constructor=n,e.exports=n,n.prototype.pushMask=function(t,e){e.context.save();var i=t.alpha,n=t.worldTransform,r=e.resolution;e.context.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,n.tx*r,n.ty*r),t.texture||(s.renderGraphicsMask(t,e.context),e.context.clip()),t.worldAlpha=i},n.prototype.popMask=function(t){t.context.restore()},n.prototype.destroy=function(){}},{"./CanvasGraphics":46}],48:[function(t,e,i){var n=t("../../../utils"),s={};e.exports=s,s.getTintedTexture=function(t,e){var i=t.texture,n="#"+("00000"+(0|(e=s.roundColor(e))).toString(16)).substr(-6);if(i.tintCache=i.tintCache||{},i.tintCache[n])return i.tintCache[n];var r=s.canvas||document.createElement("canvas");if(s.tintMethod(i,e,r),s.convertTintToImage){var o=new Image;o.src=r.toDataURL(),i.tintCache[n]=o}else i.tintCache[n]=r,s.canvas=null;return r},s.tintWithMultiply=function(t,e,i){var n=i.getContext("2d"),s=t.baseTexture.resolution,r=t.crop.clone();r.x*=s,r.y*=s,r.width*=s,r.height*=s,i.width=r.width,i.height=r.height,n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,r.width,r.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},s.tintWithOverlay=function(t,e,i){var n=i.getContext("2d"),s=t.baseTexture.resolution,r=t.crop.clone();r.x*=s,r.y*=s,r.width*=s,r.height*=s,i.width=r.width,i.height=r.height,n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,r.width,r.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},s.tintWithPerPixel=function(t,e,i){var s=i.getContext("2d"),r=t.baseTexture.resolution,o=t.crop.clone();o.x*=r,o.y*=r,o.width*=r,o.height*=r,i.width=o.width,i.height=o.height,s.globalCompositeOperation="copy",s.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height);for(var a=n.hex2rgb(e),h=a[0],l=a[1],u=a[2],c=s.getImageData(0,0,o.width,o.height),d=c.data,p=0;p<d.length;p+=4)d[p+0]*=h,d[p+1]*=l,d[p+2]*=u;s.putImageData(c,0,0)},s.roundColor=function(t){var e=s.cacheStepsPerColorChannel,i=n.hex2rgb(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),n.rgb2hex(i)},s.cacheStepsPerColorChannel=8,s.convertTintToImage=!1,s.canUseMultiply=n.canUseNewCanvasBlendModes(),s.tintMethod=s.canUseMultiply?s.tintWithMultiply:s.tintWithPerPixel},{"../../../utils":77}],49:[function(t,e,i){function n(t,e,i){i=i||{},s.call(this,"WebGL",t,e,i),this.type=f.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._useFXAA=!!i.forceFXAA&&i.antialias,this._FXAAFilter=null,this._contextOptions={alpha:this.transparent,antialias:i.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer},this.drawCount=0,this.shaderManager=new r(this),this.maskManager=new o(this),this.stencilManager=new a(this),this.filterManager=new h(this),this.blendModeManager=new l(this),this.currentRenderTarget=null,this.currentRenderer=new c(this),this.initPlugins(),this._createContext(),this._initContext(),this._mapGlModes(),this._managedTextures=[],this._renderTargetStack=[]}var s=t("../SystemRenderer"),r=t("./managers/ShaderManager"),o=t("./managers/MaskManager"),a=t("./managers/StencilManager"),h=t("./managers/FilterManager"),l=t("./managers/BlendModeManager"),u=t("./utils/RenderTarget"),c=t("./utils/ObjectRenderer"),d=t("./filters/FXAAFilter"),p=t("../../utils"),f=t("../../const");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,p.pluginTarget.mixin(n),n.glContextId=0,n.prototype._createContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=t,!t)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=n.glContextId++,t.id=this.glContextId,t.renderer=this},n.prototype._initContext=function(){var t=this.gl;t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),this.renderTarget=new u(t,this.width,this.height,null,this.resolution,!0),this.setRenderTarget(this.renderTarget),this.emit("context",t),this.resize(this.width,this.height),this._useFXAA||(this._useFXAA=this._contextOptions.antialias&&!t.getContextAttributes().antialias),this._useFXAA&&(window.console.warn("FXAA antialiasing being used instead of native antialiasing"),this._FXAAFilter=[new d])},n.prototype.render=function(t){if(this.emit("prerender"),!this.gl.isContextLost()){this.drawCount=0,this._lastObjectRendered=t,this._useFXAA&&(this._FXAAFilter[0].uniforms.resolution.value.x=this.width,this._FXAAFilter[0].uniforms.resolution.value.y=this.height,t.filterArea=this.renderTarget.size,t.filters=this._FXAAFilter);var e=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=e;var i=this.gl;this.setRenderTarget(this.renderTarget),this.clearBeforeRender&&(this.transparent?i.clearColor(0,0,0,0):i.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1),i.clear(i.COLOR_BUFFER_BIT)),this.renderDisplayObject(t,this.renderTarget),this.emit("postrender")}},n.prototype.renderDisplayObject=function(t,e,i){this.setRenderTarget(e),i&&e.clear(),this.filterManager.setFilterStack(e.filterStack),t.renderWebGL(this),this.currentRenderer.flush()},n.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},n.prototype.setRenderTarget=function(t){this.currentRenderTarget!==t&&(this.currentRenderTarget=t,this.currentRenderTarget.activate(),this.stencilManager.setMaskStack(t.stencilMaskStack))},n.prototype.resize=function(t,e){s.prototype.resize.call(this,t,e),this.filterManager.resize(t,e),this.renderTarget.resize(t,e),this.currentRenderTarget===this.renderTarget&&(this.renderTarget.activate(),this.gl.viewport(0,0,this.width,this.height))},n.prototype.updateTexture=function(t){if((t=t.baseTexture||t).hasLoaded){var e=this.gl;return t._glTextures[e.id]||(t._glTextures[e.id]=e.createTexture(),t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t)),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===f.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),t.mipmap&&t.isPowerOfTwo?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===f.SCALE_MODES.LINEAR?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===f.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),t.isPowerOfTwo?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),t._glTextures[e.id]}},n.prototype.destroyTexture=function(t,e){if((t=t.baseTexture||t).hasLoaded&&t._glTextures[this.gl.id]&&(this.gl.deleteTexture(t._glTextures[this.gl.id]),delete t._glTextures[this.gl.id],!e)){var i=this._managedTextures.indexOf(t);-1!==i&&p.removeItems(this._managedTextures,i,1)}},n.prototype.handleContextLost=function(t){t.preventDefault()},n.prototype.handleContextRestored=function(){this._initContext();for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.gl.id]&&delete e._glTextures[this.gl.id]}},n.prototype.destroy=function(t){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);for(var e=0;e<this._managedTextures.length;++e){var i=this._managedTextures[e];this.destroyTexture(i,!0),i.off("update",this.updateTexture,this),i.off("dispose",this.destroyTexture,this)}s.prototype.destroy.call(this,t),this.uid=0,this.shaderManager.destroy(),this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.blendModeManager.destroy(),this.shaderManager=null,this.maskManager=null,this.filterManager=null,this.blendModeManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this._managedTextures=null,this.drawCount=0,this.gl.useProgram(null),this.gl=null},n.prototype._mapGlModes=function(){var t=this.gl;this.blendModes||(this.blendModes={},this.blendModes[f.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.ADD]=[t.SRC_ALPHA,t.DST_ALPHA],this.blendModes[f.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.SCREEN]=[t.SRC_ALPHA,t.ONE],this.blendModes[f.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA]),this.drawModes||(this.drawModes={},this.drawModes[f.DRAW_MODES.POINTS]=t.POINTS,this.drawModes[f.DRAW_MODES.LINES]=t.LINES,this.drawModes[f.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,this.drawModes[f.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,this.drawModes[f.DRAW_MODES.TRIANGLES]=t.TRIANGLES,this.drawModes[f.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,this.drawModes[f.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN)}},{"../../const":23,"../../utils":77,"../SystemRenderer":43,"./filters/FXAAFilter":51,"./managers/BlendModeManager":53,"./managers/FilterManager":54,"./managers/MaskManager":55,"./managers/ShaderManager":56,"./managers/StencilManager":57,"./utils/ObjectRenderer":63,"./utils/RenderTarget":65}],50:[function(t,e,i){function n(t,e,i){this.shaders=[],this.padding=0,this.uniforms=i||{},this.vertexSrc=t||s.defaultVertexSrc,this.fragmentSrc=e||s.defaultFragmentSrc}var s=t("../shaders/TextureShader");n.prototype.constructor=n,e.exports=n,n.prototype.getShader=function(t){var e=t.gl,i=this.shaders[e.id];return i||(i=new s(t.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes),this.shaders[e.id]=i),i},n.prototype.applyFilter=function(t,e,i,n){var s=this.getShader(t);t.filterManager.applyFilter(s,e,i,n)},n.prototype.syncUniform=function(t){for(var e=0,i=this.shaders.length;i>e;++e)this.shaders[e].syncUniform(t)}},{"../shaders/TextureShader":62}],51:[function(t,e,i){function n(){s.call(this,"\nprecision mediump float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform vec2 resolution;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n   vResolution = resolution;\n\n   //compute the texture coords and send them to varyings\n   texcoords(aTextureCoord * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'precision lowp float;\n\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE,\n            vec2 v_rgbSW, vec2 v_rgbSE,\n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D uSampler;\n\n\nvoid main(void){\n\n    gl_FragColor = fxaa(uSampler, vTextureCoord * vResolution, vResolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n',{resolution:{type:"v2",value:{x:1,y:1}}})}var s=t("./AbstractFilter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager,s=this.getShader(t);n.applyFilter(s,e,i)}},{"./AbstractFilter":50}],52:[function(t,e,i){function n(t){var e=new r.Matrix;s.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * alpha * clip);\n    gl_FragColor = original;\n}\n",{mask:{type:"sampler2D",value:t._texture},alpha:{type:"f",value:1},otherMatrix:{type:"mat3",value:e.toArray(!0)}}),this.maskSprite=t,this.maskMatrix=e}var s=t("./AbstractFilter"),r=t("../../../math");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager;this.uniforms.mask.value=this.maskSprite._texture,n.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.alpha.value=this.maskSprite.worldAlpha;var s=this.getShader(t);n.applyFilter(s,e,i)},Object.defineProperties(n.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}},offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}})},{"../../../math":33,"./AbstractFilter":50}],53:[function(t,e,i){function n(t){s.call(this,t),this.currentBlendMode=99999}var s=t("./WebGLManager");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var e=this.renderer.blendModes[this.currentBlendMode];return this.renderer.gl.blendFunc(e[0],e[1]),!0}},{"./WebGLManager":58}],54:[function(t,e,i){function n(t){s.call(this,t),this.filterStack=[],this.filterStack.push({renderTarget:t.currentRenderTarget,filter:[],bounds:null}),this.texturePool=[],this.textureSize=new h.Rectangle(0,0,t.width,t.height),this.currentFrame=null}var s=t("./WebGLManager"),r=t("../utils/RenderTarget"),o=t("../../../const"),a=t("../utils/Quad"),h=t("../../../math");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.onContextChange=function(){this.texturePool.length=0;var t=this.renderer.gl;this.quad=new a(t)},n.prototype.setFilterStack=function(t){this.filterStack=t},n.prototype.pushFilter=function(t,e){var i=t.filterArea?t.filterArea.clone():t.getBounds();i.x=0|i.x,i.y=0|i.y,i.width=0|i.width,i.height=0|i.height;var n=0|e[0].padding;if(i.x-=n,i.y-=n,i.width+=2*n,i.height+=2*n,this.renderer.currentRenderTarget.transform){var s=this.renderer.currentRenderTarget.transform;i.x+=s.tx,i.y+=s.ty,this.capFilterArea(i),i.x-=s.tx,i.y-=s.ty}else this.capFilterArea(i);if(i.width>0&&i.height>0){this.currentFrame=i;var r=this.getRenderTarget();this.renderer.setRenderTarget(r),r.clear(),this.filterStack.push({renderTarget:r,filter:e})}else this.filterStack.push({renderTarget:null,filter:e})},n.prototype.popFilter=function(){var t=this.filterStack.pop(),e=this.filterStack[this.filterStack.length-1],i=t.renderTarget;if(t.renderTarget){var n=e.renderTarget,s=this.renderer.gl;this.currentFrame=i.frame,this.quad.map(this.textureSize,i.frame),s.bindBuffer(s.ARRAY_BUFFER,this.quad.vertexBuffer),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var r=t.filter;if(s.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition,2,s.FLOAT,!1,0,0),s.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord,2,s.FLOAT,!1,0,32),s.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor,4,s.FLOAT,!1,0,64),this.renderer.blendModeManager.setBlendMode(o.BLEND_MODES.NORMAL),1===r.length)r[0].uniforms.dimensions&&(r[0].uniforms.dimensions.value[0]=this.renderer.width,r[0].uniforms.dimensions.value[1]=this.renderer.height,r[0].uniforms.dimensions.value[2]=this.quad.vertices[0],r[0].uniforms.dimensions.value[3]=this.quad.vertices[5]),r[0].applyFilter(this.renderer,i,n),this.returnRenderTarget(i);else{for(var a=i,h=this.getRenderTarget(!0),l=0;l<r.length-1;l++){var u=r[l];u.uniforms.dimensions&&(u.uniforms.dimensions.value[0]=this.renderer.width,u.uniforms.dimensions.value[1]=this.renderer.height,u.uniforms.dimensions.value[2]=this.quad.vertices[0],u.uniforms.dimensions.value[3]=this.quad.vertices[5]),u.applyFilter(this.renderer,a,h);var c=a;a=h,h=c}r[r.length-1].applyFilter(this.renderer,a,n),this.returnRenderTarget(a),this.returnRenderTarget(h)}return t.filter}},n.prototype.getRenderTarget=function(t){var e=this.texturePool.pop()||new r(this.renderer.gl,this.textureSize.width,this.textureSize.height,o.SCALE_MODES.LINEAR,this.renderer.resolution*o.FILTER_RESOLUTION);return e.frame=this.currentFrame,t&&e.clear(!0),e},n.prototype.returnRenderTarget=function(t){this.texturePool.push(t)},n.prototype.applyFilter=function(t,e,i,n){var s=this.renderer.gl;this.renderer.setRenderTarget(i),n&&i.clear(),this.renderer.shaderManager.setShader(t),t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),t.syncUniforms(),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,e.texture),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),this.renderer.drawCount++},n.prototype.calculateMappedMatrix=function(t,e,i){var n=e.worldTransform.copy(h.Matrix.TEMP_MATRIX),s=e._texture.baseTexture,r=i.identity(),o=this.textureSize.height/this.textureSize.width;r.translate(t.x/this.textureSize.width,t.y/this.textureSize.height),r.scale(1,o);var a=this.textureSize.width/s.width,l=this.textureSize.height/s.height;return n.tx/=s.width*a,n.ty/=s.width*a,n.invert(),r.prepend(n),r.scale(1,1/o),r.scale(a,l),r.translate(e.anchor.x,e.anchor.y),r},n.prototype.capFilterArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.textureSize.width&&(t.width=this.textureSize.width-t.x),t.y+t.height>this.textureSize.height&&(t.height=this.textureSize.height-t.y)},n.prototype.resize=function(t,e){this.textureSize.width=t,this.textureSize.height=e;for(var i=0;i<this.texturePool.length;i++)this.texturePool[i].resize(t,e)},n.prototype.destroy=function(){this.quad.destroy(),s.prototype.destroy.call(this),this.filterStack=null,this.offsetY=0;for(var t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null}},{"../../../const":23,"../../../math":33,"../utils/Quad":64,"../utils/RenderTarget":65,"./WebGLManager":58}],55:[function(t,e,i){function n(t){s.call(this,t),this.stencilStack=[],this.reverse=!0,this.count=0,this.alphaMaskPool=[]}var s=t("./WebGLManager"),r=t("../filters/SpriteMaskFilter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.pushMask=function(t,e){e.texture?this.pushSpriteMask(t,e):this.pushStencilMask(t,e)},n.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.popStencilMask(t,e)},n.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool.pop();i||(i=[new r(e)]),i[0].maskSprite=e,this.renderer.filterManager.pushFilter(t,i)},n.prototype.popSpriteMask=function(){var t=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(t)},n.prototype.pushStencilMask=function(t,e){this.renderer.stencilManager.pushMask(e)},n.prototype.popStencilMask=function(t,e){this.renderer.stencilManager.popMask(e)}},{"../filters/SpriteMaskFilter":52,"./WebGLManager":58}],56:[function(t,e,i){function n(t){s.call(this,t),this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.stack=[],this._currentId=-1,this.currentShader=null}var s=t("./WebGLManager"),r=t("../shaders/TextureShader"),o=t("../shaders/ComplexPrimitiveShader"),a=t("../shaders/PrimitiveShader"),h=t("../../../utils");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,h.pluginTarget.mixin(n),e.exports=n,n.prototype.onContextChange=function(){this.initPlugins();var t=this.renderer.gl;this.maxAttibs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.defaultShader=new r(this),this.primitiveShader=new a(this),this.complexPrimitiveShader=new o(this)},n.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(var i in t)this.tempAttribState[t[i]]=!0;var n=this.renderer.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.attribState[e]?n.enableVertexAttribArray(e):n.disableVertexAttribArray(e))},n.prototype.setShader=function(t){return this._currentId!==t.uid&&(this._currentId=t.uid,this.currentShader=t,this.renderer.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},n.prototype.destroy=function(){this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),s.prototype.destroy.call(this),this.destroyPlugins(),this.attribState=null,this.tempAttribState=null}},{"../../../utils":77,"../shaders/ComplexPrimitiveShader":59,"../shaders/PrimitiveShader":60,"../shaders/TextureShader":62,"./WebGLManager":58}],57:[function(t,e,i){function n(t){s.call(this,t),this.stencilMaskStack=null}var s=t("./WebGLManager"),r=t("../../../utils");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.stencilStack.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},n.prototype.pushStencil=function(t,e){this.renderer.currentRenderTarget.attachStencilBuffer();var i=this.renderer.gl,n=this.stencilMaskStack;this.bindGraphics(t,e),0===n.stencilStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),n.reverse=!0,n.count=0),n.stencilStack.push(e);var s=n.count;i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.ALWAYS,0,255),i.stencilOp(i.KEEP,i.KEEP,i.INVERT),1===e.mode?(i.drawElements(i.TRIANGLE_FAN,e.indices.length-4,i.UNSIGNED_SHORT,0),n.reverse?(i.stencilFunc(i.EQUAL,255-s,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)):(i.stencilFunc(i.EQUAL,s,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(e.indices.length-4)),n.reverse?i.stencilFunc(i.EQUAL,255-(s+1),255):i.stencilFunc(i.EQUAL,s+1,255),n.reverse=!n.reverse):(n.reverse?(i.stencilFunc(i.EQUAL,s,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,255-s,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),i.drawElements(i.TRIANGLE_STRIP,e.indices.length,i.UNSIGNED_SHORT,0),n.reverse?i.stencilFunc(i.EQUAL,s+1,255):i.stencilFunc(i.EQUAL,255-(s+1),255)),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),n.count++},n.prototype.bindGraphics=function(t,e){var i,n=this.renderer.gl;1===e.mode?(i=this.renderer.shaderManager.complexPrimitiveShader,this.renderer.shaderManager.setShader(i),n.uniformMatrix3fv(i.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),n.uniformMatrix3fv(i.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),n.uniform3fv(i.uniforms.tint._location,r.hex2rgb(t.tint)),n.uniform3fv(i.uniforms.color._location,e.color),n.uniform1f(i.uniforms.alpha._location,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,e.buffer),n.vertexAttribPointer(i.attributes.aVertexPosition,2,n.FLOAT,!1,8,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer)):(i=this.renderer.shaderManager.primitiveShader,this.renderer.shaderManager.setShader(i),n.uniformMatrix3fv(i.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),n.uniformMatrix3fv(i.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),n.uniform3fv(i.uniforms.tint._location,r.hex2rgb(t.tint)),n.uniform1f(i.uniforms.alpha._location,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,e.buffer),n.vertexAttribPointer(i.attributes.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(i.attributes.aColor,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer))},n.prototype.popStencil=function(t,e){var i=this.renderer.gl,n=this.stencilMaskStack;if(n.stencilStack.pop(),n.count--,0===n.stencilStack.length)i.disable(i.STENCIL_TEST);else{var s=n.count;this.bindGraphics(t,e),i.colorMask(!1,!1,!1,!1),1===e.mode?(n.reverse=!n.reverse,n.reverse?(i.stencilFunc(i.EQUAL,255-(s+1),255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,s+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(e.indices.length-4)),i.stencilFunc(i.ALWAYS,0,255),i.stencilOp(i.KEEP,i.KEEP,i.INVERT),i.drawElements(i.TRIANGLE_FAN,e.indices.length-4,i.UNSIGNED_SHORT,0),this.renderer.drawCount+=2,n.reverse?i.stencilFunc(i.EQUAL,s,255):i.stencilFunc(i.EQUAL,255-s,255)):(n.reverse?(i.stencilFunc(i.EQUAL,s+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)):(i.stencilFunc(i.EQUAL,255-(s+1),255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)),i.drawElements(i.TRIANGLE_STRIP,e.indices.length,i.UNSIGNED_SHORT,0),this.renderer.drawCount++,n.reverse?i.stencilFunc(i.EQUAL,s,255):i.stencilFunc(i.EQUAL,255-s,255)),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}},n.prototype.destroy=function(){s.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},n.prototype.pushMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),t.dirty&&this.renderer.plugins.graphics.updateGraphics(t,this.renderer.gl),t._webGL[this.renderer.gl.id].data.length&&this.pushStencil(t,t._webGL[this.renderer.gl.id].data[0])},n.prototype.popMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.popStencil(t,t._webGL[this.renderer.gl.id].data[0])}},{"../../../utils":77,"./WebGLManager":58}],58:[function(t,e,i){function n(t){this.renderer=t,this.renderer.on("context",this.onContextChange,this)}n.prototype.constructor=n,e.exports=n,n.prototype.onContextChange=function(){},n.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null}},{}],59:[function(t,e,i){function n(t){s.call(this,t,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}var s=t("./Shader");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n},{"./Shader":61}],60:[function(t,e,i){function n(t){s.call(this,t,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}var s=t("./Shader");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n},{"./Shader":61}],61:[function(t,e,i){function n(t,e,i,n,r){if(!e||!i)throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc");this.uid=s.uid(),this.gl=t.renderer.gl,this.shaderManager=t,this.program=null,this.uniforms=n||{},this.attributes=r||{},this.textureCount=1,this.vertexSrc=e,this.fragmentSrc=i,this.init()}var s=t("../../../utils");n.prototype.constructor=n,e.exports=n,n.prototype.init=function(){this.compile(),this.gl.useProgram(this.program),this.cacheUniformLocations(Object.keys(this.uniforms)),this.cacheAttributeLocations(Object.keys(this.attributes))},n.prototype.cacheUniformLocations=function(t){for(var e=0;e<t.length;++e)this.uniforms[t[e]]._location=this.gl.getUniformLocation(this.program,t[e])},n.prototype.cacheAttributeLocations=function(t){for(var e=0;e<t.length;++e)this.attributes[t[e]]=this.gl.getAttribLocation(this.program,t[e])},n.prototype.compile=function(){var t=this.gl,e=this._glCompile(t.VERTEX_SHADER,this.vertexSrc),i=this._glCompile(t.FRAGMENT_SHADER,this.fragmentSrc),n=t.createProgram();return t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(n,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(n)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(n)),t.deleteProgram(n),n=null),t.deleteShader(e),t.deleteShader(i),this.program=n},n.prototype.syncUniform=function(t){var e,i,n=t._location,r=t.value,o=this.gl;switch(t.type){case"b":case"bool":case"boolean":o.uniform1i(n,r?1:0);break;case"i":case"1i":o.uniform1i(n,r);break;case"f":case"1f":o.uniform1f(n,r);break;case"2f":o.uniform2f(n,r[0],r[1]);break;case"3f":o.uniform3f(n,r[0],r[1],r[2]);break;case"4f":o.uniform4f(n,r[0],r[1],r[2],r[3]);break;case"v2":o.uniform2f(n,r.x,r.y);break;case"v3":o.uniform3f(n,r.x,r.y,r.z);break;case"v4":o.uniform4f(n,r.x,r.y,r.z,r.w);break;case"1iv":o.uniform1iv(n,r);break;case"2iv":o.uniform2iv(n,r);break;case"3iv":o.uniform3iv(n,r);break;case"4iv":o.uniform4iv(n,r);break;case"1fv":o.uniform1fv(n,r);break;case"2fv":o.uniform2fv(n,r);break;case"3fv":o.uniform3fv(n,r);break;case"4fv":o.uniform4fv(n,r);break;case"m2":case"mat2":case"Matrix2fv":o.uniformMatrix2fv(n,t.transpose,r);break;case"m3":case"mat3":case"Matrix3fv":o.uniformMatrix3fv(n,t.transpose,r);break;case"m4":case"mat4":case"Matrix4fv":o.uniformMatrix4fv(n,t.transpose,r);break;case"c":"number"==typeof r&&(r=s.hex2rgb(r)),o.uniform3f(n,r[0],r[1],r[2]);break;case"iv1":o.uniform1iv(n,r);break;case"iv":o.uniform3iv(n,r);break;case"fv1":o.uniform1fv(n,r);break;case"fv":o.uniform3fv(n,r);break;case"v2v":for(t._array||(t._array=new Float32Array(2*r.length)),e=0,i=r.length;i>e;++e)t._array[2*e]=r[e].x,t._array[2*e+1]=r[e].y;o.uniform2fv(n,t._array);break;case"v3v":for(t._array||(t._array=new Float32Array(3*r.length)),e=0,i=r.length;i>e;++e)t._array[3*e]=r[e].x,t._array[3*e+1]=r[e].y,t._array[3*e+2]=r[e].z;o.uniform3fv(n,t._array);break;case"v4v":for(t._array||(t._array=new Float32Array(4*r.length)),e=0,i=r.length;i>e;++e)t._array[4*e]=r[e].x,t._array[4*e+1]=r[e].y,t._array[4*e+2]=r[e].z,t._array[4*e+3]=r[e].w;o.uniform4fv(n,t._array);break;case"t":case"sampler2D":if(!t.value||!t.value.baseTexture.hasLoaded)break;o.activeTexture(o["TEXTURE"+this.textureCount]);var a=t.value.baseTexture._glTextures[o.id];a||(this.initSampler2D(t),a=t.value.baseTexture._glTextures[o.id]),o.bindTexture(o.TEXTURE_2D,a),o.uniform1i(t._location,this.textureCount),this.textureCount++;break;default:console.warn("Pixi.js Shader Warning: Unknown uniform type: "+t.type)}},n.prototype.syncUniforms=function(){for(var t in this.textureCount=1,this.uniforms)this.syncUniform(this.uniforms[t])},n.prototype.initSampler2D=function(t){var e=this.gl,i=t.value.baseTexture;if(i.hasLoaded)if(t.textureData){var n=t.textureData;i._glTextures[e.id]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,i._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,n.luminance?e.LUMINANCE:e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n.magFilter?n.magFilter:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n.wrapS?n.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n.wrapS?n.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n.wrapT?n.wrapT:e.CLAMP_TO_EDGE)}else this.shaderManager.renderer.updateTexture(i)},n.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.gl=null,this.uniforms=null,this.attributes=null,this.vertexSrc=null,this.fragmentSrc=null},n.prototype._glCompile=function(t,e){var i=this.gl.createShader(t);return this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.log(this.gl.getShaderInfoLog(i)),null)}},{"../../../utils":77}],62:[function(t,e,i){function n(t,e,i,r,o){var a={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array([1,0,0,0,1,0,0,0,1])}};if(r)for(var h in r)a[h]=r[h];var l={aVertexPosition:0,aTextureCoord:0,aColor:0};if(o)for(var u in o)l[u]=o[u];e=e||n.defaultVertexSrc,i=i||n.defaultFragmentSrc,s.call(this,t,e,i,a,l)}var s=t("./Shader");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),n.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n")},{"./Shader":61}],63:[function(t,e,i){function n(t){s.call(this,t)}var s=t("../managers/WebGLManager");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.start=function(){},n.prototype.stop=function(){this.flush()},n.prototype.flush=function(){},n.prototype.render=function(t){}},{"../managers/WebGLManager":58}],64:[function(t,e,i){function n(t){this.gl=t,this.vertices=new Float32Array([0,0,200,0,200,200,0,200]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,128,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.upload()}n.prototype.constructor=n,n.prototype.map=function(t,e){var i=0,n=0;this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+e.width/t.width,this.uvs[3]=n,this.uvs[4]=i+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=i,this.uvs[7]=n+e.height/t.height,i=e.x,n=e.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+e.width,this.vertices[3]=n,this.vertices[4]=i+e.width,this.vertices[5]=n+e.height,this.vertices[6]=i,this.vertices[7]=n+e.height,this.upload()},n.prototype.upload=function(){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices),t.bufferSubData(t.ARRAY_BUFFER,32,this.uvs),t.bufferSubData(t.ARRAY_BUFFER,64,this.colors)},n.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},e.exports=n},{}],65:[function(t,e,i){var n=t("../../../math"),s=t("../../../utils"),r=t("../../../const"),o=t("./StencilMaskStack"),a=function(t,e,i,a,h,l){(this.gl=t,this.frameBuffer=null,this.texture=null,this.size=new n.Rectangle(0,0,1,1),this.resolution=h||r.RESOLUTION,this.projectionMatrix=new n.Matrix,this.transform=null,this.frame=null,this.stencilBuffer=null,this.stencilMaskStack=new o,this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}],this.scaleMode=a||r.SCALE_MODES.DEFAULT,this.root=l,this.root)||(this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,a===r.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,a===r.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST),s.isPowerOfTwo(e,i)?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0));this.resize(e,i)};a.prototype.constructor=a,e.exports=a,a.prototype.clear=function(t){var e=this.gl;t&&e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},a.prototype.attachStencilBuffer=function(){if(!this.stencilBuffer&&!this.root){var t=this.gl;this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}},a.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);var e=this.frame||this.size;this.calculateProjection(e),this.transform&&this.projectionMatrix.append(this.transform),t.viewport(0,0,e.width*this.resolution,e.height*this.resolution)},a.prototype.calculateProjection=function(t){var e=this.projectionMatrix;e.identity(),this.root?(e.a=1/t.width*2,e.d=-1/t.height*2,e.tx=-1-t.x*e.a,e.ty=1-t.y*e.d):(e.a=1/t.width*2,e.d=1/t.height*2,e.tx=-1-t.x*e.a,e.ty=-1-t.y*e.d)},a.prototype.resize=function(t,e){if(t|=0,e|=0,this.size.width!==t||this.size.height!==e){if(this.size.width=t,this.size.height=e,!this.root){var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t*this.resolution,e*this.resolution,0,i.RGBA,i.UNSIGNED_BYTE,null),this.stencilBuffer&&(i.bindRenderbuffer(i.RENDERBUFFER,this.stencilBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t*this.resolution,e*this.resolution))}var n=this.frame||this.size;this.calculateProjection(n)}},a.prototype.destroy=function(){var t=this.gl;t.deleteRenderbuffer(this.stencilBuffer),t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null}},{"../../../const":23,"../../../math":33,"../../../utils":77,"./StencilMaskStack":66}],66:[function(t,e,i){function n(){this.stencilStack=[],this.reverse=!0,this.count=0}n.prototype.constructor=n,e.exports=n},{}],67:[function(t,e,i){function n(t){o.call(this),this.anchor=new s.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=l.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=t||r.EMPTY}var s=t("../math"),r=t("../textures/Texture"),o=t("../display/Container"),a=t("../renderers/canvas/utils/CanvasTinter"),h=t("../utils"),l=t("../const"),u=new s.Point;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{width:{get:function(){return Math.abs(this.scale.x)*this.texture.width},set:function(t){var e=h.sign(this.scale.x)||1;this.scale.x=e*t/this.texture.width,this._width=t}},height:{get:function(){return Math.abs(this.scale.y)*this.texture.height},set:function(t){var e=h.sign(this.scale.y)||1;this.scale.y=e*t/this.texture.height,this._height=t}},texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),n.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=h.sign(this.scale.x)*this._width/this.texture.width),this._height&&(this.scale.y=h.sign(this.scale.y)*this._height/this.texture.height)},n.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this)},n.prototype.getBounds=function(t){if(!this._currentBounds){var e,i,n,s,r=this._texture.width,o=this._texture.height,a=r*(1-this.anchor.x),h=r*-this.anchor.x,l=o*(1-this.anchor.y),u=o*-this.anchor.y,c=t||this.worldTransform,d=c.a,p=c.b,f=c.c,g=c.d,v=c.tx,m=c.ty,y=d*h+f*u+v,_=g*u+p*h+m,b=d*a+f*u+v,w=g*u+p*a+m,x=d*a+f*l+v,T=g*l+p*a+m,E=d*h+f*l+v,S=g*l+p*h+m;if(e=(e=(e=(e=y)>b?b:e)>x?x:e)>E?E:e,n=(n=(n=(n=_)>w?w:n)>T?T:n)>S?S:n,i=E>(i=x>(i=b>(i=y)?b:i)?x:i)?E:i,s=S>(s=T>(s=w>(s=_)?w:s)?T:s)?S:s,this.children.length){var A=this.containerGetBounds();a=A.x,h=A.x+A.width,e=a>e?e:a,n=(l=A.y)>n?n:l,i=i>h?i:h,s=s>(u=A.y+A.height)?s:u}var P=this._bounds;P.x=e,P.width=i-e,P.y=n,P.height=s-n,this._currentBounds=P}return this._currentBounds},n.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},n.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,u);var e,i=this._texture.width,n=this._texture.height,s=-i*this.anchor.x;return u.x>s&&u.x<s+i&&(e=-n*this.anchor.y,u.y>e&&u.y<e+n)},n.prototype._renderCanvas=function(t){if(!(this.texture.crop.width<=0||this.texture.crop.height<=0)){var e=t.blendModes[this.blendMode];if(e!==t.context.globalCompositeOperation&&(t.context.globalCompositeOperation=e),this.texture.valid){var i,n,s,r,o=this._texture,h=this.worldTransform;t.context.globalAlpha=this.worldAlpha;var u=o.baseTexture.scaleMode===l.SCALE_MODES.LINEAR;if(t.smoothProperty&&t.context[t.smoothProperty]!==u&&(t.context[t.smoothProperty]=u),o.rotate){s=o.crop.height,r=o.crop.width,i=o.trim?o.trim.y-this.anchor.y*o.trim.height:this.anchor.y*-o._frame.height,n=o.trim?o.trim.x-this.anchor.x*o.trim.width:this.anchor.x*-o._frame.width,i+=s,h.tx=n*h.a+i*h.c+h.tx,h.ty=n*h.b+i*h.d+h.ty;var c=h.a;h.a=-h.c,h.c=c,c=h.b,h.b=-h.d,h.d=c,i=0,n=0}else s=o.crop.width,r=o.crop.height,i=o.trim?o.trim.x-this.anchor.x*o.trim.width:this.anchor.x*-o._frame.width,n=o.trim?o.trim.y-this.anchor.y*o.trim.height:this.anchor.y*-o._frame.height;var d=o.baseTexture.resolution;t.roundPixels?(t.context.setTransform(h.a/d,h.b/d,h.c/d,h.d/d,h.tx*t.resolution|0,h.ty*t.resolution|0),i|=0,n|=0):t.context.setTransform(h.a/d,h.b/d,h.c/d,h.d/d,h.tx*t.resolution,h.ty*t.resolution),16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=a.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,s,r,i*t.resolution,n*t.resolution,s*t.resolution,r*t.resolution)):t.context.drawImage(o.baseTexture.source,o.crop.x,o.crop.y,s,r,i*t.resolution,n*t.resolution,s*t.resolution,r*t.resolution)}}},n.prototype.destroy=function(t,e){o.prototype.destroy.call(this),this.anchor=null,t&&this._texture.destroy(e),this._texture=null,this.shader=null},n.fromFrame=function(t){var e=h.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new n(e)},n.fromImage=function(t,e,i){return new n(r.fromImage(t,e,i))}},{"../const":23,"../display/Container":24,"../math":33,"../renderers/canvas/utils/CanvasTinter":48,"../textures/Texture":72,"../utils":77}],68:[function(t,e,i){function n(t){s.call(this,t),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=o.SPRITE_BATCH_SIZE;var e=4*this.size*this.vertByteSize,i=6*this.size;this.vertices=new ArrayBuffer(e),this.positions=new Float32Array(this.vertices),this.colors=new Uint32Array(this.vertices),this.indices=new Uint16Array(i);for(var n=0,r=0;i>n;n+=6,r+=4)this.indices[n+0]=r+0,this.indices[n+1]=r+1,this.indices[n+2]=r+2,this.indices[n+3]=r+0,this.indices[n+4]=r+2,this.indices[n+5]=r+3;this.currentBatchSize=0,this.sprites=[],this.shader=null}var s=t("../../renderers/webgl/utils/ObjectRenderer"),r=t("../../renderers/webgl/WebGLRenderer"),o=t("../../const");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,r.registerPlugin("sprite",n),n.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},n.prototype.render=function(t){var e=t._texture;this.currentBatchSize>=this.size&&this.flush();var i=e._uvs;if(i){var n,s,r,o,a=t.anchor.x,h=t.anchor.y;if(e.trim&&void 0===t.tileScale){var l=e.trim;n=(s=l.x-a*l.width)+e.crop.width,r=(o=l.y-h*l.height)+e.crop.height}else n=e._frame.width*(1-a),s=e._frame.width*-a,r=e._frame.height*(1-h),o=e._frame.height*-h;var u=this.currentBatchSize*this.vertByteSize,c=t.worldTransform,d=e.baseTexture.resolution,p=c.a/d,f=c.b/d,g=c.c/d,v=c.d/d,m=c.tx,y=c.ty,_=this.colors,b=this.positions;if(this.renderer.roundPixels){d=this.renderer.resolution;b[u]=((p*s+g*o+m)*d|0)/d,b[u+1]=((v*o+f*s+y)*d|0)/d,b[u+5]=((p*n+g*o+m)*d|0)/d,b[u+6]=((v*o+f*n+y)*d|0)/d,b[u+10]=((p*n+g*r+m)*d|0)/d,b[u+11]=((v*r+f*n+y)*d|0)/d,b[u+15]=((p*s+g*r+m)*d|0)/d,b[u+16]=((v*r+f*s+y)*d|0)/d}else b[u]=p*s+g*o+m,b[u+1]=v*o+f*s+y,b[u+5]=p*n+g*o+m,b[u+6]=v*o+f*n+y,b[u+10]=p*n+g*r+m,b[u+11]=v*r+f*n+y,b[u+15]=p*s+g*r+m,b[u+16]=v*r+f*s+y;b[u+2]=i.x0,b[u+3]=i.y0,b[u+7]=i.x1,b[u+8]=i.y1,b[u+12]=i.x2,b[u+13]=i.y2,b[u+17]=i.x3,b[u+18]=i.y3;var w=t.tint;_[u+4]=_[u+9]=_[u+14]=_[u+19]=(w>>16)+(65280&w)+((255&w)<<16)+(255*t.worldAlpha<<24),this.sprites[this.currentBatchSize++]=t}},n.prototype.flush=function(){if(0!==this.currentBatchSize){var t,e=this.renderer.gl;if(this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var i=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);e.bufferSubData(e.ARRAY_BUFFER,0,i)}for(var n,s,r,o,a=0,h=0,l=null,u=this.renderer.blendModeManager.currentBlendMode,c=null,d=!1,p=!1,f=0,g=this.currentBatchSize;g>f;f++)n=(o=this.sprites[f])._texture.baseTexture,d=u!==(s=o.blendMode),p=c!==(r=o.shader||this.shader),(l!==n||d||p)&&(this.renderBatch(l,a,h),h=f,a=0,l=n,d&&(u=s,this.renderer.blendModeManager.setBlendMode(u)),p&&((t=(c=r).shaders?c.shaders[e.id]:c)||(t=c.getShader(this.renderer)),this.renderer.shaderManager.setShader(t),t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),t.syncUniforms(),e.activeTexture(e.TEXTURE0))),a++;this.renderBatch(l,a,h),this.currentBatchSize=0}},n.prototype.renderBatch=function(t,e,i){if(0!==e){var n=this.renderer.gl;t._glTextures[n.id]?n.bindTexture(n.TEXTURE_2D,t._glTextures[n.id]):this.renderer.updateTexture(t),n.drawElements(n.TRIANGLES,6*e,n.UNSIGNED_SHORT,6*i*2),this.renderer.drawCount++}},n.prototype.start=function(){var t=this.renderer.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.vertByteSize;t.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,t.FLOAT,!1,e,0),t.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,t.FLOAT,!1,e,8),t.vertexAttribPointer(this.shader.attributes.aColor,4,t.UNSIGNED_BYTE,!0,e,16)},n.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer),this.renderer.gl.deleteBuffer(this.indexBuffer),s.prototype.destroy.call(this),this.shader.destroy(),this.renderer=null,this.vertices=null,this.positions=null,this.colors=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.sprites=null,this.shader=null}},{"../../const":23,"../../renderers/webgl/WebGLRenderer":49,"../../renderers/webgl/utils/ObjectRenderer":63}],69:[function(t,e,i){function n(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||h.RESOLUTION,this._text=null,this._style=null;var n=r.fromCanvas(this.canvas);n.trim=new o.Rectangle,s.call(this,n),this.text=t,this.style=e}var s=t("../sprites/Sprite"),r=t("../textures/Texture"),o=t("../math"),a=t("../utils"),h=t("../const");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.fontPropertiesCache={},n.fontPropertiesCanvas=document.createElement("canvas"),n.fontPropertiesContext=n.fontPropertiesCanvas.getContext("2d"),Object.defineProperties(n.prototype,{width:{get:function(){return this.dirty&&this.updateText(),this.scale.x*this._texture.width},set:function(t){this.scale.x=t/this._texture.width,this._width=t}},height:{get:function(){return this.dirty&&this.updateText(),this.scale.y*this._texture.height},set:function(t){this.scale.y=t/this._texture.height,this._height=t}},style:{get:function(){return this._style},set:function(t){"number"==typeof(t=t||{}).fill&&(t.fill=a.hex2string(t.fill)),"number"==typeof t.stroke&&(t.stroke=a.hex2string(t.stroke)),"number"==typeof t.dropShadowColor&&(t.dropShadowColor=a.hex2string(t.dropShadowColor)),t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowColor=t.dropShadowColor||"#000000",t.dropShadowAngle=void 0!==t.dropShadowAngle?t.dropShadowAngle:Math.PI/6,t.dropShadowDistance=void 0!==t.dropShadowDistance?t.dropShadowDistance:5,t.dropShadowBlur=void 0!==t.dropShadowBlur?t.dropShadowBlur:0,t.padding=t.padding||0,t.textBaseline=t.textBaseline||"alphabetic",t.lineJoin=t.lineJoin||"miter",t.miterLimit=t.miterLimit||10,this._style=t,this.dirty=!0}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),n.prototype.updateText=function(){var t=this._style;this.context.font=t.font;for(var e=(t.wordWrap?this.wordWrap(this._text):this._text).split(/(?:\r\n|\r|\n)/),i=new Array(e.length),n=0,s=this.determineFontProperties(t.font),r=0;r<e.length;r++){var o=this.context.measureText(e[r]).width;i[r]=o,n=Math.max(n,o)}var a=n+t.strokeThickness;t.dropShadow&&(a+=t.dropShadowDistance),this.canvas.width=(a+this.context.lineWidth)*this.resolution;var h,l,u=this.style.lineHeight||s.fontSize+t.strokeThickness,c=u*e.length;if(t.dropShadow&&(c+=t.dropShadowDistance),this.canvas.height=(c+2*this._style.padding)*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=t.font,this.context.strokeStyle=t.stroke,this.context.lineWidth=t.strokeThickness,this.context.textBaseline=t.textBaseline,this.context.lineJoin=t.lineJoin,this.context.miterLimit=t.miterLimit,t.dropShadow){t.dropShadowBlur>0?(this.context.shadowColor=t.dropShadowColor,this.context.shadowBlur=t.dropShadowBlur):this.context.fillStyle=t.dropShadowColor;var d=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,p=Math.sin(t.dropShadowAngle)*t.dropShadowDistance;for(r=0;r<e.length;r++)h=t.strokeThickness/2,l=t.strokeThickness/2+r*u+s.ascent,"right"===t.align?h+=n-i[r]:"center"===t.align&&(h+=(n-i[r])/2),t.fill&&this.context.fillText(e[r],h+d,l+p+this._style.padding)}for(this.context.fillStyle=t.fill,r=0;r<e.length;r++)h=t.strokeThickness/2,l=t.strokeThickness/2+r*u+s.ascent,"right"===t.align?h+=n-i[r]:"center"===t.align&&(h+=(n-i[r])/2),t.stroke&&t.strokeThickness&&this.context.strokeText(e[r],h,l+this._style.padding),t.fill&&this.context.fillText(e[r],h,l+this._style.padding);this.updateTexture()},n.prototype.updateTexture=function(){var t=this._texture;t.baseTexture.hasLoaded=!0,t.baseTexture.resolution=this.resolution,t.baseTexture.realWidth=this.canvas.width,t.baseTexture.realHeight=this.canvas.height,t.width=t.baseTexture.width=this.canvas.width/this.resolution,t.height=t.baseTexture.height=this.canvas.height/this.resolution,t.crop.width=t._frame.width=this.canvas.width/this.resolution,t.crop.height=t._frame.height=this.canvas.height/this.resolution,t.trim.x=0,t.trim.y=-this._style.padding,t.trim.width=t._frame.width,t.trim.height=t._frame.height-2*this._style.padding,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,t.baseTexture.emit("update",t.baseTexture),this.dirty=!1},n.prototype.renderWebGL=function(t){this.dirty&&this.updateText(),s.prototype.renderWebGL.call(this,t)},n.prototype._renderCanvas=function(t){this.dirty&&this.updateText(),s.prototype._renderCanvas.call(this,t)},n.prototype.determineFontProperties=function(t){var e=n.fontPropertiesCache[t];if(!e){e={};var i=n.fontPropertiesCanvas,s=n.fontPropertiesContext;s.font=t;var r=Math.ceil(s.measureText("|MÉq").width),o=Math.ceil(s.measureText("M").width),a=2*o;o=1.4*o|0,i.width=r,i.height=a,s.fillStyle="#f00",s.fillRect(0,0,r,a),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText("|MÉq",0,o);var h,l,u=s.getImageData(0,0,r,a).data,c=u.length,d=4*r,p=0,f=!1;for(h=0;o>h;h++){for(l=0;d>l;l+=4)if(255!==u[p+l]){f=!0;break}if(f)break;p+=d}for(e.ascent=o-h,p=c-d,f=!1,h=a;h>o;h--){for(l=0;d>l;l+=4)if(255!==u[p+l]){f=!0;break}if(f)break;p-=d}e.descent=h-o,e.fontSize=e.ascent+e.descent,n.fontPropertiesCache[t]=e}return e},n.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),n=this._style.wordWrapWidth,s=0;s<i.length;s++){for(var r=n,o=i[s].split(" "),a=0;a<o.length;a++){var h=this.context.measureText(o[a]).width,l=h+this.context.measureText(" ").width;0===a||l>r?(a>0&&(e+="\n"),e+=o[a],r=n-h):(r-=l,e+=" "+o[a])}s<i.length-1&&(e+="\n")}return e},n.prototype.getBounds=function(t){return this.dirty&&this.updateText(),s.prototype.getBounds.call(this,t)},n.prototype.destroy=function(t){this.context=null,this.canvas=null,this._style=null,this._texture.destroy(void 0===t||t)}},{"../const":23,"../math":33,"../sprites/Sprite":67,"../textures/Texture":72,"../utils":77}],70:[function(t,e,i){function n(t,e,i){o.call(this),this.uid=s.uid(),this.resolution=i||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=e||r.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures={},t&&this.loadSource(t)}var s=t("../utils"),r=t("../const"),o=t("eventemitter3");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=s.isPowerOfTwo(this.realWidth,this.realHeight),this.emit("update",this)},n.prototype.loadSource=function(t){var e=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=t,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!t.getContext){this.isLoading=!0;var i=this;t.onload=function(){t.onload=null,t.onerror=null,i.isLoading&&(i.isLoading=!1,i._sourceLoaded(),i.emit("loaded",i))},t.onerror=function(){t.onload=null,t.onerror=null,i.isLoading&&(i.isLoading=!1,i.emit("error",i))},t.complete&&t.src&&(this.isLoading=!1,t.onload=null,t.onerror=null,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this))}},n.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},n.prototype.destroy=function(){var t;this.imageUrl?(t=this.imageUrl,s.useFilenamesForTextures&&(t=s.getFilenameFromUrl(this.imageUrl)),delete s.BaseTextureCache[t],delete s.TextureCache[t],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete s.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose();var e=s.TextureCache;for(t in e){var i=e[t];i?i.baseTexture===this&&(i.destroy(),delete e[t]):delete e[t]}this.removeAllListeners()},n.prototype.dispose=function(){this.emit("dispose",this)},n.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},n.fromImage=function(t,e,i){var r=t;s.useFilenamesForTextures&&(r=s.getFilenameFromUrl(t));var o=s.BaseTextureCache[r];if(void 0===e&&0!==t.indexOf("data:")&&(e=!0),!o){var a=new Image;e&&(a.crossOrigin=""),(o=new n(a,i)).imageUrl=t,a.src=t,s.BaseTextureCache[r]=o,o.resolution=s.getResolutionOfUrl(t)}return o},n.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+s.uid());var i=s.BaseTextureCache[t._pixiId];return i||(i=new n(t,e),s.BaseTextureCache[t._pixiId]=i),i}},{"../const":23,"../utils":77,eventemitter3:10}],71:[function(t,e,i){function n(t,e,i,n,c){if(!t)throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.");e=e||100,i=i||100,c=c||u.RESOLUTION;var d=new s;if(d.width=e,d.height=i,d.realWidth=e*c,d.realHeight=i*c,d.resolution=c,d.scaleMode=n||u.SCALE_MODES.DEFAULT,d.hasLoaded=!0,r.call(this,d,new l.Rectangle(0,0,d.realWidth,d.realHeight)),this.width=e,this.height=i,this.resolution=c,this.render=null,this.renderer=t,this.renderer.type===u.RENDERER_TYPE.WEBGL){var p=this.renderer.gl;this.textureBuffer=new o(p,this.width,this.height,d.scaleMode,this.resolution),this.baseTexture._glTextures[p.id]=this.textureBuffer.texture,this.filterManager=new a(this.renderer),this.filterManager.onContextChange(),this.filterManager.resize(e,i),this.render=this.renderWebGL,this.renderer.currentRenderer.start(),this.renderer.currentRenderTarget.activate()}else this.render=this.renderCanvas,this.textureBuffer=new h(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()}var s=t("./BaseTexture"),r=t("./Texture"),o=t("../renderers/webgl/utils/RenderTarget"),a=t("../renderers/webgl/managers/FilterManager"),h=t("../renderers/canvas/utils/CanvasBuffer"),l=t("../math"),u=t("../const"),c=new l.Matrix;n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.resize=function(t,e,i){(t!==this.width||e!==this.height)&&(this.valid=t>0&&e>0,this.width=t,this.height=e,this._frame.width=this.crop.width=t*this.resolution,this._frame.height=this.crop.height=e*this.resolution,i&&(this.baseTexture.realWidth=t*this.resolution,this.baseTexture.realHeight=e*this.resolution,this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.valid&&(this.renderer.type===u.RENDERER_TYPE.WEBGL?this.textureBuffer.resize(this.width,this.height):this.textureBuffer.resize(this.baseTexture.realWidth,this.baseTexture.realHeight),this.filterManager&&this.filterManager.resize(this.width,this.height)))},n.prototype.clear=function(){this.valid&&(this.renderer.type===u.RENDERER_TYPE.WEBGL&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},n.prototype.renderWebGL=function(t,e,i,n){if(this.valid){if(n=void 0===n||n,this.textureBuffer.transform=e,this.textureBuffer.activate(),t.worldAlpha=1,n){t.worldTransform.identity(),t.currentBounds=null;var s,r,o=t.children;for(s=0,r=o.length;r>s;++s)o[s].updateTransform()}var a=this.renderer.filterManager;this.renderer.filterManager=this.filterManager,this.renderer.renderDisplayObject(t,this.textureBuffer,i),this.renderer.filterManager=a}},n.prototype.renderCanvas=function(t,e,i,n){if(this.valid){n=!!n;var s=c;s.identity(),e&&s.append(e);var r=t.worldTransform;t.worldTransform=s,t.worldAlpha=1;var o,a,h=t.children;for(o=0,a=h.length;a>o;++o)h[o].updateTransform();i&&this.textureBuffer.clear();var l=this.textureBuffer.context,u=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,l),this.renderer.resolution=u,t.worldTransform===s&&(t.worldTransform=r)}},n.prototype.destroy=function(){r.prototype.destroy.call(this,!0),this.textureBuffer.destroy(),this.filterManager&&this.filterManager.destroy(),this.renderer=null},n.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},n.prototype.getBase64=function(){return this.getCanvas().toDataURL()},n.prototype.getCanvas=function(){if(this.renderer.type===u.RENDERER_TYPE.WEBGL){var t=this.renderer.gl,e=this.textureBuffer.size.width,i=this.textureBuffer.size.height,n=new Uint8Array(4*e*i);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,i,t.RGBA,t.UNSIGNED_BYTE,n),t.bindFramebuffer(t.FRAMEBUFFER,null);var s=new h(e,i),r=s.context.getImageData(0,0,e,i);return r.data.set(n),s.context.putImageData(r,0,0),s.canvas}return this.textureBuffer.canvas},n.prototype.getPixels=function(){var t,e;if(this.renderer.type===u.RENDERER_TYPE.WEBGL){var i=this.renderer.gl;t=this.textureBuffer.size.width,e=this.textureBuffer.size.height;var n=new Uint8Array(4*t*e);return i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer),i.readPixels(0,0,t,e,i.RGBA,i.UNSIGNED_BYTE,n),i.bindFramebuffer(i.FRAMEBUFFER,null),n}return t=this.textureBuffer.canvas.width,e=this.textureBuffer.canvas.height,this.textureBuffer.canvas.getContext("2d").getImageData(0,0,t,e).data},n.prototype.getPixel=function(t,e){if(this.renderer.type===u.RENDERER_TYPE.WEBGL){var i=this.renderer.gl,n=new Uint8Array(4);return i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer),i.readPixels(t,e,1,1,i.RGBA,i.UNSIGNED_BYTE,n),i.bindFramebuffer(i.FRAMEBUFFER,null),n}return this.textureBuffer.canvas.getContext("2d").getImageData(t,e,1,1).data}},{"../const":23,"../math":33,"../renderers/canvas/utils/CanvasBuffer":45,"../renderers/webgl/managers/FilterManager":54,"../renderers/webgl/utils/RenderTarget":65,"./BaseTexture":70,"./Texture":72}],72:[function(t,e,i){function n(t,e,i,s,r){a.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new h.Rectangle(0,0,1,1)),t instanceof n&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=i||e,this.rotate=!!r,t.hasLoaded?(this.noFrame&&(e=new h.Rectangle(0,0,t.realWidth,t.realHeight)),this.frame=e):t.once("loaded",this.onBaseTextureLoaded,this),t.on("update",this.onBaseTextureUpdated,this)}var s=t("./BaseTexture"),r=t("./VideoBaseTexture"),o=t("./TextureUvs"),a=t("eventemitter3"),h=t("../math"),l=t("../utils");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{frame:{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=this.baseTexture.resolution;if(this.width=t.width/e,this.height=t.height/e,!this.trim&&!this.rotate&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded,this.trim?(this.width=this.trim.width/e,this.height=this.trim.height/e,this._frame.width=this.trim.width,this._frame.height=this.trim.height):this.crop=t,this.valid&&this._updateUvs()}}}),n.prototype.update=function(){this.baseTexture.update()},n.prototype.onBaseTextureLoaded=function(t){this.noFrame?this.frame=new h.Rectangle(0,0,t.realWidth,t.realHeight):this.frame=this._frame,this.emit("update",this)},n.prototype.onBaseTextureUpdated=function(t){this.noFrame?(this._frame.width=t.realWidth,this._frame.height=t.realHeight):this.frame=this._frame,this.emit("update",this)},n.prototype.destroy=function(t){this.baseTexture&&(t&&this.baseTexture.destroy(),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.crop=null,this.valid=!1,this.off("dispose",this.dispose,this),this.off("update",this.update,this)},n.prototype.clone=function(){return new n(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)},n.prototype._updateUvs=function(){this._uvs||(this._uvs=new o),this._uvs.set(this.crop,this.baseTexture,this.rotate)},n.fromImage=function(t,e,i){var r=t;l.useFilenamesForTextures&&(r=l.getFilenameFromUrl(t));var o=l.TextureCache[r];return o||(o=new n(s.fromImage(t,e,i)),l.TextureCache[r]=o),o},n.fromFrame=function(t,e){var i=t;l.useFilenamesForTextures&&(i=l.getFilenameFromUrl(t));var n=l.TextureCache[i];if(!n&&!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return n},n.fromCanvas=function(t,e){return new n(s.fromCanvas(t,e))},n.fromVideo=function(t,e){return"string"==typeof t?n.fromVideoUrl(t,e):new n(r.fromVideo(t,e))},n.fromVideoUrl=function(t,e){return new n(r.fromUrl(t,e))},n.addTextureToCache=function(t,e){l.TextureCache[e]=t},n.removeTextureFromCache=function(t){var e=l.TextureCache[t];return delete l.TextureCache[t],delete l.BaseTextureCache[t],e},n.EMPTY=new n(new s)},{"../math":33,"../utils":77,"./BaseTexture":70,"./TextureUvs":73,"./VideoBaseTexture":74,eventemitter3:10}],73:[function(t,e,i){function n(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1}e.exports=n,n.prototype.set=function(t,e,i){var n=e.realWidth,s=e.realHeight;i?(this.x0=(t.x+t.height)/n,this.y0=t.y/s,this.x1=(t.x+t.height)/n,this.y1=(t.y+t.width)/s,this.x2=t.x/n,this.y2=(t.y+t.width)/s,this.x3=t.x/n,this.y3=t.y/s):(this.x0=t.x/n,this.y0=t.y/s,this.x1=(t.x+t.width)/n,this.y1=t.y/s,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/s,this.x3=t.x/n,this.y3=(t.y+t.height)/s)}},{}],74:[function(t,e,i){function n(t,e){if(!t)throw new Error("No video source element specified.");(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),r.call(this,t,e),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),t.complete||(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function s(t,e){e||(e="video/"+t.substr(t.lastIndexOf(".")+1));var i=document.createElement("source");return i.src=t,i.type=e,i}var r=t("./BaseTexture"),o=t("../utils");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},n.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},n.prototype._onPlayStop=function(){this.autoUpdate=!1},n.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},n.prototype.destroy=function(){this.source&&this.source._pixiId&&(delete o.BaseTextureCache[this.source._pixiId],delete this.source._pixiId),r.prototype.destroy.call(this)},n.fromVideo=function(t,e){t._pixiId||(t._pixiId="video_"+o.uid());var i=o.BaseTextureCache[t._pixiId];return i||(i=new n(t,e),o.BaseTextureCache[t._pixiId]=i),i},n.fromUrl=function(t,e){var i=document.createElement("video");if(Array.isArray(t))for(var r=0;r<t.length;++r)i.appendChild(s(t[r].src||t[r],t[r].mime));else i.appendChild(s(t.src||t,t.mime));return i.load(),i.play(),n.fromVideo(i,e)},n.fromUrls=n.fromUrl},{"../utils":77,"./BaseTexture":70}],75:[function(t,e,i){function n(){var t=this;this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._emitter.listeners(o,!0)&&(t._requestId=requestAnimationFrame(t._tick)))},this._emitter=new r,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/s.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1}var s=t("../const"),r=t("eventemitter3"),o="tick";Object.defineProperties(n.prototype,{FPS:{get:function(){return 1e3/this.elapsedMS}},minFPS:{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,s.TARGET_FPMS);this._maxElapsedMS=1/e}}}),n.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners(o,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},n.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},n.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},n.prototype.add=function(t,e){return this._emitter.on(o,t,e),this._startIfPossible(),this},n.prototype.addOnce=function(t,e){return this._emitter.once(o,t,e),this._startIfPossible(),this},n.prototype.remove=function(t,e){return this._emitter.off(o,t,e),this._emitter.listeners(o,!0)||this._cancelIfNeeded(),this},n.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},n.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},n.prototype.update=function(t){var e;t=t||performance.now(),(e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*s.TARGET_FPMS*this.speed,this._emitter.emit(o,this.deltaTime),this.lastTime=t},e.exports=n},{"../const":23,eventemitter3:10}],76:[function(t,e,i){var n=t("./Ticker"),s=new n;s.autoStart=!0,e.exports={shared:s,Ticker:n}},{"./Ticker":75}],77:[function(t,e,i){var n=t("../const"),s=e.exports={_uid:0,_saidHello:!1,EventEmitter:t("eventemitter3"),pluginTarget:t("./pluginTarget"),async:t("async"),uid:function(){return++s._uid},hex2rgb:function(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},hex2string:function(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)},rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},canUseNewCanvasBlendModes:function(){if("undefined"==typeof document)return!1;var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",i=new Image;i.src=t+"AP804Oa6"+e;var n=new Image;n.src=t+"/wCKxvRF"+e;var s=document.createElement("canvas");s.width=6,s.height=1;var r=s.getContext("2d");r.globalCompositeOperation="multiply",r.drawImage(i,0,0),r.drawImage(n,2,0);var o=r.getImageData(2,0,1,1).data;return 255===o[0]&&0===o[1]&&0===o[2]},getNextPowerOfTwo:function(t){if(t>0&&0==(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},isPowerOfTwo:function(t,e){return t>0&&0==(t&t-1)&&e>0&&0==(e&e-1)},getResolutionOfUrl:function(t){var e=n.RETINA_PREFIX.exec(t);return e?parseFloat(e[1]):1},sayHello:function(t){if(!s._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c Pixi.js "+n.VERSION+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("Pixi.js "+n.VERSION+" - "+t+" - http://www.pixijs.com/");s._saidHello=!0}},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);return!(!i||!i.getContextAttributes().stencil)}catch(t){return!1}},sign:function(t){return t?0>t?-1:1:0},removeItems:function(t,e,i){var n=t.length;if(!(e>=n||0===i)){for(var s=e,r=n-(i=e+i>n?n-e:i);r>s;++s)t[s]=t[s+i];t.length=r}},TextureCache:{},BaseTextureCache:{},useFilenamesForTextures:!1,getFilenameFromUrl:function(t){if(0===t.indexOf("data:"))return t;var e=t.substring(t.lastIndexOf("/")+1),i=e.lastIndexOf(".");return-1!==i&&(e=e.substring(0,i)),e}}},{"../const":23,"./pluginTarget":78,async:1,eventemitter3:10}],78:[function(t,e,i){e.exports={mixin:function(t){!function(t){t.__plugins={},t.registerPlugin=function(e,i){t.__plugins[e]=i},t.prototype.initPlugins=function(){for(var e in this.plugins=this.plugins||{},t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}(t)}}},{}],79:[function(t,e,i){var n=t("./core"),s=t("./mesh"),r=t("./extras"),o=t("./filters");n.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},n.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.")},Object.defineProperties(n,{Stage:{get:function(){return console.warn("You do not need to use a PIXI Stage any more, you can simply render any container."),n.Container}},DisplayObjectContainer:{get:function(){return console.warn("DisplayObjectContainer has been shortened to Container, please use Container from now on."),n.Container}},Strip:{get:function(){return console.warn("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),s.Mesh}},Rope:{get:function(){return console.warn("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),s.Rope}},MovieClip:{get:function(){return console.warn("The MovieClip class has been moved to extras.MovieClip, please use extras.MovieClip from now on."),r.MovieClip}},TilingSprite:{get:function(){return console.warn("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),r.TilingSprite}},BitmapText:{get:function(){return console.warn("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),r.BitmapText}},blendModes:{get:function(){return console.warn("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),n.BLEND_MODES}},scaleModes:{get:function(){return console.warn("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),n.SCALE_MODES}},BaseTextureCache:{get:function(){return console.warn("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),n.utils.BaseTextureCache}},TextureCache:{get:function(){return console.warn("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),n.utils.TextureCache}},math:{get:function(){return console.warn("The math namespace is deprecated, please access members already accessible on PIXI."),n}}}),n.Sprite.prototype.setTexture=function(t){this.texture=t,console.warn("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},r.BitmapText.prototype.setText=function(t){this.text=t,console.warn("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")},n.Text.prototype.setText=function(t){this.text=t,console.warn("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},n.Text.prototype.setStyle=function(t){this.style=t,console.warn("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},n.Texture.prototype.setFrame=function(t){this.frame=t,console.warn("setFrame is now deprecated, please use the frame property, e.g : myTexture.frame = frame;")},Object.defineProperties(o,{AbstractFilter:{get:function(){return console.warn("filters.AbstractFilter is an undocumented alias, please use AbstractFilter from now on."),n.AbstractFilter}},FXAAFilter:{get:function(){return console.warn("filters.FXAAFilter is an undocumented alias, please use FXAAFilter from now on."),n.FXAAFilter}},SpriteMaskFilter:{get:function(){return console.warn("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),n.SpriteMaskFilter}}}),n.utils.uuid=function(){return console.warn("utils.uuid() is deprecated, please use utils.uid() from now on."),n.utils.uid()}},{"./core":30,"./extras":86,"./filters":103,"./mesh":128}],80:[function(t,e,i){function n(t,e){s.Container.call(this),e=e||{},this.textWidth=0,this.textHeight=0,this._glyphs=[],this._font={tint:void 0!==e.tint?e.tint:16777215,align:e.align||"left",name:null,size:0},this.font=e.font,this._text=t,this.maxWidth=0,this.maxLineHeight=0,this.dirty=!1,this.updateText()}var s=t("../core");n.prototype=Object.create(s.Container.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{tint:{get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},align:{get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},font:{get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):n.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),n.prototype.updateText=function(){for(var t=n.fonts[this._font.name],e=new s.Point,i=null,r=[],o=0,a=0,h=[],l=0,u=this._font.size/t.size,c=-1,d=0,p=0;p<this.text.length;p++){var f=this.text.charCodeAt(p);if(c=/(\s)/.test(this.text.charAt(p))?p:c,/(?:\r\n|\r|\n)/.test(this.text.charAt(p)))h.push(o),a=Math.max(a,o),l++,e.x=0,e.y+=t.lineHeight,i=null;else if(-1!==c&&this.maxWidth>0&&e.x*u>this.maxWidth)s.utils.removeItems(r,c,p-c),p=c,c=-1,h.push(o),a=Math.max(a,o),l++,e.x=0,e.y+=t.lineHeight,i=null;else{var g=t.chars[f];g&&(i&&g.kerning[i]&&(e.x+=g.kerning[i]),r.push({texture:g.texture,line:l,charCode:f,position:new s.Point(e.x+g.xOffset,e.y+g.yOffset)}),o=e.x+(g.texture.width+g.xOffset),e.x+=g.xAdvance,d=Math.max(d,g.yOffset+g.texture.height),i=f)}}h.push(o),a=Math.max(a,o);var v=[];for(p=0;l>=p;p++){var m=0;"right"===this._font.align?m=a-h[p]:"center"===this._font.align&&(m=(a-h[p])/2),v.push(m)}var y=r.length,_=this.tint;for(p=0;y>p;p++){var b=this._glyphs[p];b?b.texture=r[p].texture:(b=new s.Sprite(r[p].texture),this._glyphs.push(b)),b.position.x=(r[p].position.x+v[r[p].line])*u,b.position.y=r[p].position.y*u,b.scale.x=b.scale.y=u,b.tint=_,b.parent||this.addChild(b)}for(p=y;p<this._glyphs.length;++p)this.removeChild(this._glyphs[p]);this.textWidth=a*u,this.textHeight=(e.y+t.lineHeight)*u,this.maxLineHeight=d*u},n.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},n.prototype.getLocalBounds=function(){return this.validate(),s.Container.prototype.getLocalBounds.call(this)},n.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},n.fonts={}},{"../core":30}],81:[function(t,e,i){function n(t){s.Sprite.call(this,t[0]instanceof s.Texture?t[0]:t[0].texture),this._textures=null,this._durations=null,this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this._currentTime=0,this.playing=!1}var s=t("../core");n.prototype=Object.create(s.Sprite.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(t){if(t[0]instanceof s.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}}},currentFrame:{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return 0>t&&(t+=this._textures.length),t}}}),n.prototype.stop=function(){this.playing&&(this.playing=!1,s.ticker.shared.remove(this.update,this))},n.prototype.play=function(){this.playing||(this.playing=!0,s.ticker.shared.add(this.update,this))},n.prototype.gotoAndStop=function(t){this.stop(),this._currentTime=t,this._texture=this._textures[this.currentFrame]},n.prototype.gotoAndPlay=function(t){this._currentTime=t,this.play()},n.prototype.update=function(t){var e=this.animationSpeed*t;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;0>i;)this._currentTime--,i+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):this._texture=this._textures[this.currentFrame]},n.prototype.destroy=function(){this.stop(),s.Sprite.prototype.destroy.call(this)},n.fromFrames=function(t){for(var e=[],i=0;i<t.length;++i)e.push(new s.Texture.fromFrame(t[i]));return new n(e)},n.fromImages=function(t){for(var e=[],i=0;i<t.length;++i)e.push(new s.Texture.fromImage(t[i]));return new n(e)}},{"../core":30}],82:[function(t,e,i){function n(t,e,i){s.Sprite.call(this,t),this.tileScale=new s.Point(1,1),this.tilePosition=new s.Point(0,0),this._width=e||100,this._height=i||100,this._uvs=new s.TextureUvs,this._canvasPattern=null,this.shader=new s.AbstractFilter(["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","uniform vec4 uFrame;","uniform vec4 uTransform;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vec2 coord = aTextureCoord;","   coord -= uTransform.xy;","   coord /= uTransform.zw;","   vTextureCoord = coord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform vec4 uFrame;","uniform vec2 uPixelSize;","void main(void){","   vec2 coord = mod(vTextureCoord, uFrame.zw);","   coord = clamp(coord, uPixelSize, uFrame.zw - uPixelSize);","   coord += uFrame.xy;","   gl_FragColor =  texture2D(uSampler, coord) * vColor ;","}"].join("\n"),{uFrame:{type:"4fv",value:[0,0,1,1]},uTransform:{type:"4fv",value:[0,0,1,1]},uPixelSize:{type:"2fv",value:[1,1]}})}var s=t("../core"),r=new s.Point,o=t("../core/renderers/canvas/utils/CanvasTinter");n.prototype=Object.create(s.Sprite.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t}},height:{get:function(){return this._height},set:function(t){this._height=t}}}),n.prototype._onTextureUpdate=function(){},n.prototype._renderWebGL=function(t){var e=this._texture;if(e&&e._uvs){var i=e._uvs,n=e._frame.width,s=e._frame.height,r=e.baseTexture.width,o=e.baseTexture.height;e._uvs=this._uvs,e._frame.width=this.width,e._frame.height=this.height,this.shader.uniforms.uPixelSize.value[0]=1/r,this.shader.uniforms.uPixelSize.value[1]=1/o,this.shader.uniforms.uFrame.value[0]=i.x0,this.shader.uniforms.uFrame.value[1]=i.y0,this.shader.uniforms.uFrame.value[2]=i.x1-i.x0,this.shader.uniforms.uFrame.value[3]=i.y2-i.y0,this.shader.uniforms.uTransform.value[0]=this.tilePosition.x%(n*this.tileScale.x)/this._width,this.shader.uniforms.uTransform.value[1]=this.tilePosition.y%(s*this.tileScale.y)/this._height,this.shader.uniforms.uTransform.value[2]=r/this._width*this.tileScale.x,this.shader.uniforms.uTransform.value[3]=o/this._height*this.tileScale.y,t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this),e._uvs=i,e._frame.width=n,e._frame.height=s}},n.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var i=t.context,n=this.worldTransform,r=t.resolution,a=e.baseTexture,h=this.tilePosition.x/this.tileScale.x%e._frame.width,l=this.tilePosition.y/this.tileScale.y%e._frame.height;if(!this._canvasPattern){var u=new s.CanvasBuffer(e._frame.width,e._frame.height);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=o.getTintedTexture(this,this.tint)),u.context.drawImage(this.tintedTexture,0,0)):u.context.drawImage(a.source,-e._frame.x,-e._frame.y),this._canvasPattern=u.context.createPattern(u.canvas,"repeat")}i.globalAlpha=this.worldAlpha,i.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,n.tx*r,n.ty*r),i.scale(this.tileScale.x,this.tileScale.y),i.translate(h+this.anchor.x*-this._width,l+this.anchor.y*-this._height);var c=t.blendModes[this.blendMode];c!==t.context.globalCompositeOperation&&(i.globalCompositeOperation=c),i.fillStyle=this._canvasPattern,i.fillRect(-h,-l,this._width/this.tileScale.x,this._height/this.tileScale.y)}},n.prototype.getBounds=function(){var t,e,i,n,s=this._width,r=this._height,o=s*(1-this.anchor.x),a=s*-this.anchor.x,h=r*(1-this.anchor.y),l=r*-this.anchor.y,u=this.worldTransform,c=u.a,d=u.b,p=u.c,f=u.d,g=u.tx,v=u.ty,m=c*a+p*l+g,y=f*l+d*a+v,_=c*o+p*l+g,b=f*l+d*o+v,w=c*o+p*h+g,x=f*h+d*o+v,T=c*a+p*h+g,E=f*h+d*a+v;t=(t=(t=(t=m)>_?_:t)>w?w:t)>T?T:t,i=(i=(i=(i=y)>b?b:i)>x?x:i)>E?E:i,e=T>(e=w>(e=_>(e=m)?_:e)?w:e)?T:e,n=E>(n=x>(n=b>(n=y)?b:n)?x:n)?E:n;var S=this._bounds;return S.x=t,S.width=e-t,S.y=i,S.height=n-i,this._currentBounds=S,S},n.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,r);var e,i=this._width,n=this._height,s=-i*this.anchor.x;return r.x>s&&r.x<s+i&&(e=-n*this.anchor.y,r.y>e&&r.y<e+n)},n.prototype.destroy=function(){s.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._uvs=null},n.fromFrame=function(t,e,i){var r=s.utils.TextureCache[t];if(!r)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new n(r,e,i)},n.fromImage=function(t,e,i,r,o){return new n(s.Texture.fromImage(t,r,o),e,i)}},{"../core":30,"../core/renderers/canvas/utils/CanvasTinter":48}],83:[function(t,e,i){var n=t("../core"),s=n.DisplayObject,r=new n.Matrix;s.prototype._cacheAsBitmap=!1,s.prototype._originalRenderWebGL=null,s.prototype._originalRenderCanvas=null,s.prototype._originalUpdateTransform=null,s.prototype._originalHitTest=null,s.prototype._originalDestroy=null,s.prototype._cachedSprite=null,Object.defineProperties(s.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._originalRenderWebGL=this.renderWebGL,this._originalRenderCanvas=this.renderCanvas,this._originalUpdateTransform=this.updateTransform,this._originalGetBounds=this.getBounds,this._originalDestroy=this.destroy,this._originalContainsPoint=this.containsPoint,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(this._cachedSprite&&this._destroyCachedDisplayObject(),this.renderWebGL=this._originalRenderWebGL,this.renderCanvas=this._originalRenderCanvas,this.getBounds=this._originalGetBounds,this.destroy=this._originalDestroy,this.updateTransform=this._originalUpdateTransform,this.containsPoint=this._originalContainsPoint))}}}),s.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cachedSprite.worldAlpha=this.worldAlpha,t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this._cachedSprite))},s.prototype._initCachedDisplayObject=function(t){if(!this._cachedSprite){t.currentRenderer.flush();var e=this.getLocalBounds().clone();if(this._filters){var i=this._filters[0].padding;e.x-=i,e.y-=i,e.width+=2*i,e.height+=2*i}var s=t.currentRenderTarget,o=t.filterManager.filterStack,a=new n.RenderTexture(t,0|e.width,0|e.height),h=r;h.tx=-e.x,h.ty=-e.y,this.renderWebGL=this._originalRenderWebGL,a.render(this,h,!0,!0),t.setRenderTarget(s),t.filterManager.filterStack=o,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new n.Sprite(a),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-e.x/e.width,this._cachedSprite.anchor.y=-e.y/e.height,this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},s.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite.renderCanvas(t))},s.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cachedSprite){var e=this.getLocalBounds(),i=t.context,s=new n.RenderTexture(t,0|e.width,0|e.height),o=r;o.tx=-e.x,o.ty=-e.y,this.renderCanvas=this._originalRenderCanvas,s.render(this,o,!0),t.context=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new n.Sprite(s),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-e.x/e.width,this._cachedSprite.anchor.y=-e.y/e.height,this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},s.prototype._getCachedBounds=function(){return this._cachedSprite._currentBounds=null,this._cachedSprite.getBounds()},s.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy(),this._cachedSprite=null},s.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1,this._originalDestroy()}},{"../core":30}],84:[function(t,e,i){var n=t("../core");n.DisplayObject.prototype.name=null,n.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":30}],85:[function(t,e,i){var n=t("../core");n.DisplayObject.prototype.getGlobalPosition=function(t){return t=t||new n.Point,this.parent?(this.displayObjectUpdateTransform(),t.x=this.worldTransform.tx,t.y=this.worldTransform.ty):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":30}],86:[function(t,e,i){t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition"),e.exports={MovieClip:t("./MovieClip"),TilingSprite:t("./TilingSprite"),BitmapText:t("./BitmapText")}},{"./BitmapText":80,"./MovieClip":81,"./TilingSprite":82,"./cacheAsBitmap":83,"./getChildByName":84,"./getGlobalPosition":85}],87:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nuniform vec4 dimensions;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n    if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n    {\n        if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 uv = gl_FragCoord.xy;\n\n    vec3 col = texture2D(uSampler, floor( uv / pixelSize ) * pixelSize / dimensions.xy).rgb;\n\n    float gray = (col.r + col.g + col.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    vec2 p = mod( uv / ( pixelSize * 0.5 ), 2.0) - vec2(1.0);\n    col = col * character(n, p);\n\n    gl_FragColor = vec4(col, 1.0);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"1f",value:8}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.uniforms.pixelSize.value=t}}})},{"../../core":30}],88:[function(t,e,i){function n(){s.AbstractFilter.call(this),this.blurXFilter=new r,this.blurYFilter=new o,this.defaultFilter=new s.AbstractFilter}var s=t("../../core"),r=t("../blur/BlurXFilter"),o=t("../blur/BlurYFilter");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager.getRenderTarget(!0);this.defaultFilter.applyFilter(t,e,i),this.blurXFilter.applyFilter(t,e,n),t.blendModeManager.setBlendMode(s.BLEND_MODES.SCREEN),this.blurYFilter.applyFilter(t,n,i),t.blendModeManager.setBlendMode(s.BLEND_MODES.NORMAL),t.filterManager.returnRenderTarget(n)},Object.defineProperties(n.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}})},{"../../core":30,"../blur/BlurXFilter":91,"../blur/BlurYFilter":92}],89:[function(t,e,i){function n(t,e){s.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform float dirX;\nuniform float dirY;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[3];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[0] = aTextureCoord + vec2( (0.004 * strength) * dirX, (0.004 * strength) * dirY );\n    vBlurTexCoords[1] = aTextureCoord + vec2( (0.008 * strength) * dirX, (0.008 * strength) * dirY );\n    vBlurTexCoords[2] = aTextureCoord + vec2( (0.012 * strength) * dirX, (0.012 * strength) * dirY );\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[3];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vTextureCoord     ) * 0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0]) * 0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1]) * 0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2]) * 0.004431848411938341;\n}\n",{strength:{type:"1f",value:1},dirX:{type:"1f",value:t||0},dirY:{type:"1f",value:e||0}}),this.defaultFilter=new s.AbstractFilter,this.passes=1,this.dirX=t||0,this.dirY=e||0,this.strength=4}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i,n){var s=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width),1===this.passes)t.filterManager.applyFilter(s,e,i,n);else{var r=t.filterManager.getRenderTarget(!0);t.filterManager.applyFilter(s,e,r,n);for(var o=0;o<this.passes-2;o++)t.filterManager.applyFilter(s,r,r,n);t.filterManager.applyFilter(s,r,i,n),t.filterManager.returnRenderTarget(r)}},Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*t,this.strength=t}},dirX:{get:function(){return this.dirX},set:function(t){this.uniforms.dirX.value=t}},dirY:{get:function(){return this.dirY},set:function(t){this.uniforms.dirY.value=t}}})},{"../../core":30}],90:[function(t,e,i){function n(){s.AbstractFilter.call(this),this.blurXFilter=new r,this.blurYFilter=new o}var s=t("../../core"),r=t("./BlurXFilter"),o=t("./BlurYFilter");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager.getRenderTarget(!0);this.blurXFilter.applyFilter(t,e,n),this.blurYFilter.applyFilter(t,n,i),t.filterManager.returnRenderTarget(n)},Object.defineProperties(n.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.padding=.5*Math.abs(t),this.blurXFilter.blur=this.blurYFilter.blur=t}},passes:{get:function(){return this.blurXFilter.passes},set:function(t){this.blurXFilter.passes=this.blurYFilter.passes=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}})},{"../../core":30,"./BlurXFilter":91,"./BlurYFilter":92}],91:[function(t,e,i){function n(){s.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(-0.012 * strength, 0.0);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(-0.008 * strength, 0.0);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(-0.004 * strength, 0.0);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2( 0.004 * strength, 0.0);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2( 0.008 * strength, 0.0);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2( 0.012 * strength, 0.0);\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i,n){var s=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width),1===this.passes)t.filterManager.applyFilter(s,e,i,n);else{for(var r=t.filterManager.getRenderTarget(!0),o=e,a=r,h=0;h<this.passes-1;h++){t.filterManager.applyFilter(s,o,a,!0);var l=a;a=o,o=l}t.filterManager.applyFilter(s,o,i,n),t.filterManager.returnRenderTarget(r)}},Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*Math.abs(t),this.strength=t}}})},{"../../core":30}],92:[function(t,e,i){function n(){s.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i,n){var s=this.getShader(t);if(this.uniforms.strength.value=Math.abs(this.strength)/4/this.passes*(e.frame.height/e.size.height),1===this.passes)t.filterManager.applyFilter(s,e,i,n);else{for(var r=t.filterManager.getRenderTarget(!0),o=e,a=r,h=0;h<this.passes-1;h++){t.filterManager.applyFilter(s,o,a,!0);var l=a;a=o,o=l}t.filterManager.applyFilter(s,o,i,n),t.filterManager.returnRenderTarget(r)}},Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*Math.abs(t),this.strength=t}}})},{"../../core":30}],93:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 delta;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta * percent);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{delta:{type:"v2",value:{x:.1,y:0}}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n},{"../../core":30}],94:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[25];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4];\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9];\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14];\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19];\n\n}\n",{m:{type:"1fv",value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype._loadMatrix=function(t,e){var i=t;(e=!!e)&&(this._multiply(i,this.uniforms.m.value,t),i=this._colorMatrix(i)),this.uniforms.m.value=i},n.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19],t},n.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},n.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},n.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},n.prototype.grayscale=n.prototype.greyscale,n.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},n.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),s=.213,r=.715,o=.072,a=[s+i*(1-s)+n*-s,r+i*-r+n*-r,o+i*-o+n*(1-o),0,0,s+i*-s+.143*n,r+i*(1-r)+.14*n,o+i*-o+-.283*n,0,0,s+i*-s+-.787*n,r+i*-r+n*r,o+i*(1-o)+n*o,0,0,0,0,0,1,0];this._loadMatrix(a,e)},n.prototype.contrast=function(t,e){var i=(t||0)+1,n=-128*(i-1),s=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(s,e)},n.prototype.saturate=function(t,e){var i=2*(t||0)/3+1,n=-.5*(i-1),s=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(s,e)},n.prototype.desaturate=function(t){this.saturate(-1)},n.prototype.negative=function(t){this._loadMatrix([0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0],t)},n.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},n.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},n.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},n.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},n.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},n.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},n.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},n.prototype.colorTone=function(t,e,i,n,s){var r=((i=i||16770432)>>16&255)/255,o=(i>>8&255)/255,a=(255&i)/255,h=((n=n||3375104)>>16&255)/255,l=(n>>8&255)/255,u=(255&n)/255,c=[.3,.59,.11,0,0,r,o,a,t=t||.2,0,h,l,u,e=e||.15,0,r-h,o-l,a-u,0,0];this._loadMatrix(c,s)},n.prototype.night=function(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},n.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},n.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},n.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperties(n.prototype,{matrix:{get:function(){return this.uniforms.m.value},set:function(t){this.uniforms.m.value=t}}})},{"../../core":30}],95:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float step;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    color = floor(color * step) / step;\n\n    gl_FragColor = color;\n}\n",{step:{type:"1f",value:5}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{step:{get:function(){return this.uniforms.step.value},set:function(t){this.uniforms.step.value=t}}})},{"../../core":30}],96:[function(t,e,i){function n(t,e,i){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n",{matrix:{type:"1fv",value:new Float32Array(t)},texelSize:{type:"v2",value:{x:1/e,y:1/i}}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=new Float32Array(t)}},width:{get:function(){return 1/this.uniforms.texelSize.value.x},set:function(t){this.uniforms.texelSize.value.x=1/t}},height:{get:function(){return 1/this.uniforms.texelSize.value.y},set:function(t){this.uniforms.texelSize.value.y=1/t}}})},{"../../core":30}],97:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n},{"../../core":30}],98:[function(t,e,i){function n(t,e){var i=new s.Matrix;t.renderable=!1,s.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision mediump float;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y));\n}\n",{mapSampler:{type:"sampler2D",value:t.texture},otherMatrix:{type:"mat3",value:i.toArray(!0)},scale:{type:"v2",value:{x:1,y:1}}}),this.maskSprite=t,this.maskMatrix=i,null==e&&(e=20),this.scale=new s.Point(e,e)}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager;n.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.scale.value.x=this.scale.x*(1/e.frame.width),this.uniforms.scale.value.y=this.scale.y*(1/e.frame.height);var s=this.getShader(t);n.applyFilter(s,e,i)},Object.defineProperties(n.prototype,{map:{get:function(){return this.uniforms.mapSampler.value},set:function(t){this.uniforms.mapSampler.value=t}}})},{"../../core":30}],99:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 dimensions;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * dimensions.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n",{scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{scale:{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}})},{"../../core":30}],100:[function(t,e,i){function n(){s.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform vec2 offset;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition+offset), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform vec3 color;\nuniform float alpha;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec4 sum = vec4(0.0);\n\n    sum += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    sum += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    sum += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    sum += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    sum += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n\n    gl_FragColor = vec4( color.rgb * sum.a * alpha, sum.a * alpha );\n}\n",{blur:{type:"1f",value:1/512},color:{type:"c",value:[0,0,0]},alpha:{type:"1f",value:.7},offset:{type:"2f",value:[5,5]},strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i,n){var s=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.height/e.size.height),1===this.passes)t.filterManager.applyFilter(s,e,i,n);else{for(var r=t.filterManager.getRenderTarget(!0),o=e,a=r,h=0;h<this.passes-1;h++){t.filterManager.applyFilter(s,o,a,n);var l=a;a=o,o=l}t.filterManager.applyFilter(s,o,i,n),t.filterManager.returnRenderTarget(r)}},Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*t,this.strength=t}}})},{"../../core":30}],101:[function(t,e,i){function n(){s.AbstractFilter.call(this),this.blurXFilter=new r,this.blurYTintFilter=new o,this.defaultFilter=new s.AbstractFilter,this.padding=30,this._dirtyPosition=!0,this._angle=45*Math.PI/180,this._distance=10,this.alpha=.75,this.hideObject=!1,this.blendMode=s.BLEND_MODES.MULTIPLY}var s=t("../../core"),r=t("../blur/BlurXFilter"),o=t("./BlurYTintFilter");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager.getRenderTarget(!0);this._dirtyPosition&&(this._dirtyPosition=!1,this.blurYTintFilter.uniforms.offset.value[0]=Math.sin(this._angle)*this._distance,this.blurYTintFilter.uniforms.offset.value[1]=Math.cos(this._angle)*this._distance),this.blurXFilter.applyFilter(t,e,n),t.blendModeManager.setBlendMode(this.blendMode),this.blurYTintFilter.applyFilter(t,n,i),t.blendModeManager.setBlendMode(s.BLEND_MODES.NORMAL),this.hideObject||this.defaultFilter.applyFilter(t,e,i),t.filterManager.returnRenderTarget(n)},Object.defineProperties(n.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYTintFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYTintFilter.blur},set:function(t){this.blurYTintFilter.blur=t}},color:{get:function(){return s.utils.rgb2hex(this.blurYTintFilter.uniforms.color.value)},set:function(t){this.blurYTintFilter.uniforms.color.value=s.utils.hex2rgb(t)}},alpha:{get:function(){return this.blurYTintFilter.uniforms.alpha.value},set:function(t){this.blurYTintFilter.uniforms.alpha.value=t}},distance:{get:function(){return this._distance},set:function(t){this._dirtyPosition=!0,this._distance=t}},angle:{get:function(){return this._angle},set:function(t){this._dirtyPosition=!0,this._angle=t}}})},{"../../core":30,"../blur/BlurXFilter":91,"./BlurYTintFilter":100}],102:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n",{gray:{type:"1f",value:1}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{gray:{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}}})},{"../../core":30}],103:[function(t,e,i){e.exports={AsciiFilter:t("./ascii/AsciiFilter"),BloomFilter:t("./bloom/BloomFilter"),BlurFilter:t("./blur/BlurFilter"),BlurXFilter:t("./blur/BlurXFilter"),BlurYFilter:t("./blur/BlurYFilter"),BlurDirFilter:t("./blur/BlurDirFilter"),ColorMatrixFilter:t("./color/ColorMatrixFilter"),ColorStepFilter:t("./color/ColorStepFilter"),ConvolutionFilter:t("./convolution/ConvolutionFilter"),CrossHatchFilter:t("./crosshatch/CrossHatchFilter"),DisplacementFilter:t("./displacement/DisplacementFilter"),DotScreenFilter:t("./dot/DotScreenFilter"),GrayFilter:t("./gray/GrayFilter"),DropShadowFilter:t("./dropshadow/DropShadowFilter"),InvertFilter:t("./invert/InvertFilter"),NoiseFilter:t("./noise/NoiseFilter"),PixelateFilter:t("./pixelate/PixelateFilter"),RGBSplitFilter:t("./rgb/RGBSplitFilter"),ShockwaveFilter:t("./shockwave/ShockwaveFilter"),SepiaFilter:t("./sepia/SepiaFilter"),SmartBlurFilter:t("./blur/SmartBlurFilter"),TiltShiftFilter:t("./tiltshift/TiltShiftFilter"),TiltShiftXFilter:t("./tiltshift/TiltShiftXFilter"),TiltShiftYFilter:t("./tiltshift/TiltShiftYFilter"),TwistFilter:t("./twist/TwistFilter")}},{"./ascii/AsciiFilter":87,"./bloom/BloomFilter":88,"./blur/BlurDirFilter":89,"./blur/BlurFilter":90,"./blur/BlurXFilter":91,"./blur/BlurYFilter":92,"./blur/SmartBlurFilter":93,"./color/ColorMatrixFilter":94,"./color/ColorStepFilter":95,"./convolution/ConvolutionFilter":96,"./crosshatch/CrossHatchFilter":97,"./displacement/DisplacementFilter":98,"./dot/DotScreenFilter":99,"./dropshadow/DropShadowFilter":101,"./gray/GrayFilter":102,"./invert/InvertFilter":104,"./noise/NoiseFilter":105,"./pixelate/PixelateFilter":106,"./rgb/RGBSplitFilter":107,"./sepia/SepiaFilter":108,"./shockwave/ShockwaveFilter":109,"./tiltshift/TiltShiftFilter":111,"./tiltshift/TiltShiftXFilter":112,"./tiltshift/TiltShiftYFilter":113,"./twist/TwistFilter":114}],104:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform float invert;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);\n}\n",{invert:{type:"1f",value:1}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{invert:{get:function(){return this.uniforms.invert.value},set:function(t){this.uniforms.invert.value=t}}})},{"../../core":30}],105:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(vTextureCoord) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n",{noise:{type:"1f",value:.5}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{noise:{get:function(){return this.uniforms.noise.value},set:function(t){this.uniforms.noise.value=t}}})},{"../../core":30}],106:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 dimensions;\nuniform vec2 pixelSize;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord;\n\n    vec2 size = dimensions.xy / pixelSize;\n\n    vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;\n\n    gl_FragColor = texture2D(uSampler, color);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"v2",value:{x:10,y:10}}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.uniforms.pixelSize.value=t}}})},{"../../core":30}],107:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 dimensions;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n",{red:{type:"v2",value:{x:20,y:20}},green:{type:"v2",value:{x:-20,y:20}},blue:{type:"v2",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{red:{get:function(){return this.uniforms.red.value},set:function(t){this.uniforms.red.value=t}},green:{get:function(){return this.uniforms.green.value},set:function(t){this.uniforms.green.value=t}},blue:{get:function(){return this.uniforms.blue.value},set:function(t){this.uniforms.blue.value=t}}})},{"../../core":30}],108:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float sepia;\n\nconst mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);\n}\n",{sepia:{type:"1f",value:1}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{sepia:{get:function(){return this.uniforms.sepia.value},set:function(t){this.uniforms.sepia.value=t}}})},{"../../core":30}],109:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 center;\nuniform vec3 params; // 10.0, 0.8, 0.1\nuniform float time;\n\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    vec2 texCoord = uv;\n\n    float dist = distance(uv, center);\n\n    if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )\n    {\n        float diff = (dist - time);\n        float powDiff = 1.0 - pow(abs(diff*params.x), params.y);\n\n        float diffTime = diff  * powDiff;\n        vec2 diffUV = normalize(uv - center);\n        texCoord = uv + (diffUV * diffTime);\n    }\n\n    gl_FragColor = texture2D(uSampler, texCoord);\n}\n",{center:{type:"v2",value:{x:.5,y:.5}},params:{type:"v3",value:{x:10,y:.8,z:.1}},time:{type:"1f",value:0}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{center:{get:function(){return this.uniforms.center.value},set:function(t){this.uniforms.center.value=t}},params:{get:function(){return this.uniforms.params.value},set:function(t){this.uniforms.params.value=t}},time:{get:function(){return this.uniforms.time.value},set:function(t){this.uniforms.time.value=t}}})},{"../../core":30}],110:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{blur:{type:"1f",value:100},gradientBlur:{type:"1f",value:600},start:{type:"v2",value:{x:0,y:window.innerHeight/2}},end:{type:"v2",value:{x:600,y:window.innerHeight/2}},delta:{type:"v2",value:{x:30,y:30}},texSize:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}}),this.updateDelta()}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.updateDelta=function(){this.uniforms.delta.value.x=0,this.uniforms.delta.value.y=0},Object.defineProperties(n.prototype,{blur:{get:function(){return this.uniforms.blur.value},set:function(t){this.uniforms.blur.value=t}},gradientBlur:{get:function(){return this.uniforms.gradientBlur.value},set:function(t){this.uniforms.gradientBlur.value=t}},start:{get:function(){return this.uniforms.start.value},set:function(t){this.uniforms.start.value=t,this.updateDelta()}},end:{get:function(){return this.uniforms.end.value},set:function(t){this.uniforms.end.value=t,this.updateDelta()}}})},{"../../core":30}],111:[function(t,e,i){function n(){s.AbstractFilter.call(this),this.tiltShiftXFilter=new r,this.tiltShiftYFilter=new o}var s=t("../../core"),r=t("./TiltShiftXFilter"),o=t("./TiltShiftYFilter");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager.getRenderTarget(!0);this.tiltShiftXFilter.applyFilter(t,e,n),this.tiltShiftYFilter.applyFilter(t,n,i),t.filterManager.returnRenderTarget(n)},Object.defineProperties(n.prototype,{blur:{get:function(){return this.tiltShiftXFilter.blur},set:function(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}},gradientBlur:{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}},start:{get:function(){return this.tiltShiftXFilter.start},set:function(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}},end:{get:function(){return this.tiltShiftXFilter.end},set:function(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}}})},{"../../core":30,"./TiltShiftXFilter":112,"./TiltShiftYFilter":113}],112:[function(t,e,i){function n(){s.call(this)}var s=t("./TiltShiftAxisFilter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x,e=this.uniforms.end.value.y-this.uniforms.start.value.y,i=Math.sqrt(t*t+e*e);this.uniforms.delta.value.x=t/i,this.uniforms.delta.value.y=e/i}},{"./TiltShiftAxisFilter":110}],113:[function(t,e,i){function n(){s.call(this)}var s=t("./TiltShiftAxisFilter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x,e=this.uniforms.end.value.y-this.uniforms.start.value.y,i=Math.sqrt(t*t+e*e);this.uniforms.delta.value.x=-e/i,this.uniforms.delta.value.y=t/i}},{"./TiltShiftAxisFilter":110}],114:[function(t,e,i){function n(){s.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\n\nvoid main(void)\n{\n   vec2 coord = vTextureCoord - offset;\n   float dist = length(coord);\n\n   if (dist < radius)\n   {\n       float ratio = (radius - dist) / radius;\n       float angleMod = ratio * ratio * angle;\n       float s = sin(angleMod);\n       float c = cos(angleMod);\n       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n   }\n\n   gl_FragColor = texture2D(uSampler, coord+offset);\n}\n",{radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"v2",value:{x:.5,y:.5}}})}var s=t("../../core");n.prototype=Object.create(s.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}},radius:{get:function(){return this.uniforms.radius.value},set:function(t){this.uniforms.radius.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}})},{"../../core":30}],115:[function(t,e,i){(function(i){t("./polyfill");var n=e.exports=t("./core");n.extras=t("./extras"),n.filters=t("./filters"),n.interaction=t("./interaction"),n.loaders=t("./loaders"),n.mesh=t("./mesh"),n.accessibility=t("./accessibility"),n.loader=new n.loaders.Loader,Object.assign(n,t("./deprecation")),i.PIXI=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":22,"./core":30,"./deprecation":79,"./extras":86,"./filters":103,"./interaction":118,"./loaders":121,"./mesh":128,"./polyfill":133}],116:[function(t,e,i){function n(){this.global=new s.Point,this.target=null,this.originalEvent=null,this.identifier=-1}var s=t("../core");n.prototype.constructor=n,e.exports=n,n.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)}},{"../core":30}],117:[function(t,e,i){function n(t,e){e=e||{},o.call(this),this.renderer=t,this.autoPreventDefault=void 0===e.autoPreventDefault||e.autoPreventDefault,this.interactionFrequency=e.interactionFrequency||10,this.mouse=new r,this.eventData={stopped:!1,target:null,type:null,data:this.mouse,stopPropagation:function(){this.stopped=!0}},this.interactiveDataPool=[],this.interactionDOMElement=null,this.eventsAdded=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.handleCursorChange=null,this._tempPoint=new s.Point,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}var s=t("../core"),r=t("./InteractionData"),o=t("eventemitter3");Object.assign(s.DisplayObject.prototype,t("./interactiveTarget")),n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.setTargetElement=function(t,e){this.removeEvents(),this.interactionDOMElement=t,this.resolution=e||1,this.addEvents()},n.prototype.addEvents=function(){this.interactionDOMElement&&(s.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onMouseOver,!0),this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},n.prototype.removeEvents=function(){this.interactionDOMElement&&(s.ticker.shared.remove(this.update),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onMouseOver,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},n.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.handleCursorChange?this.handleCursorChange(this.cursor):this.interactionDOMElement.style.cursor=this.cursor)}},n.prototype.dispatchEvent=function(t,e,i){i.stopped||(i.target=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},n.prototype.mapPositionToPoint=function(t,e,i){var n=this.interactionDOMElement.getBoundingClientRect();t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)/this.resolution,t.y=(i-n.top)*(this.interactionDOMElement.height/n.height)/this.resolution},n.prototype.processInteractive=function(t,e,i,n,s){if(!e||!e.visible)return!1;var r=!1,o=s=e.interactive||s;if(e.hitArea&&(o=!1),e.interactiveChildren)for(var a=e.children,h=a.length-1;h>=0;h--)this.processInteractive(t,a[h],i,n,o)&&(r=!0,o=!1,a[h].interactive&&(n=!1));return s&&(n&&!r&&(e.hitArea?(e.worldTransform.applyInverse(t,this._tempPoint),r=e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):e.containsPoint&&(r=e.containsPoint(t))),e.interactive&&i(e,r)),r},n.prototype.onMouseDown=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.autoPreventDefault&&this.mouse.originalEvent.preventDefault(),this.emit("stagedown",this.eventData),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0)},n.prototype.processMouseDown=function(t,e){var i=this.mouse.originalEvent,n=2===i.button||3===i.which;e&&(t[n?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(t,n?"rightdown":"mousedown",this.eventData))},n.prototype.onMouseUp=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.emit("stageup",this.eventData),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0)},n.prototype.processMouseUp=function(t,e){var i=this.mouse.originalEvent,n=2===i.button||3===i.which,s=n?"_isRightDown":"_isLeftDown";e?(this.dispatchEvent(t,n?"rightup":"mouseup",this.eventData),t[s]&&(t[s]=!1,this.dispatchEvent(t,n?"rightclick":"click",this.eventData))):t[s]&&(t[s]=!1,this.dispatchEvent(t,n?"rightupoutside":"mouseupoutside",this.eventData))},n.prototype.onMouseMove=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.didMove=!0,this.cursor="inherit",this.emit("stagemove",this.eventData),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.handleCursorChange?this.handleCursorChange(this.cursor):this.interactionDOMElement.style.cursor=this.cursor)},n.prototype.processMouseMove=function(t,e){this.dispatchEvent(t,"mousemove",this.eventData),this.processMouseOverOut(t,e)},n.prototype.onMouseOut=function(t){this.mouse.originalEvent=t,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.handleCursorChange||(this.interactionDOMElement.style.cursor="inherit"),this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1),this.emit("stageout")},n.prototype.processMouseOverOut=function(t,e){e?(t._over||(t._over=!0,this.dispatchEvent(t,"mouseover",this.eventData)),t.buttonMode&&(this.cursor=t.defaultCursor)):t._over&&(t._over=!1,this.dispatchEvent(t,"mouseout",this.eventData))},n.prototype.onMouseOver=function(){this.emit("stagein")},n.prototype.onTouchStart=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,n=0;i>n;n++){var s=e[n],r=this.getTouchData(s);r.originalEvent=t,this.eventData.data=r,this.eventData.stopped=!1,this.emit("stagedown",this.eventData),this.processInteractive(r.global,this.renderer._lastObjectRendered,this.processTouchStart,!0),this.returnTouchData(r)}},n.prototype.processTouchStart=function(t,e){e&&(t._touchDown=this.eventData.data.identifier,this.dispatchEvent(t,"touchstart",this.eventData))},n.prototype.onTouchEnd=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,n=0;i>n;n++){var s=e[n],r=this.getTouchData(s);r.originalEvent=t,this.eventData.data=r,this.eventData.stopped=!1,this.emit("stageup",this.eventData),this.processInteractive(r.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0),this.returnTouchData(r)}},n.prototype.processTouchEnd=function(t,e){e?(this.dispatchEvent(t,"touchend",this.eventData),t._touchDown===this.eventData.data.identifier&&(t._touchDown=!1,this.dispatchEvent(t,"tap",this.eventData))):t._touchDown===this.eventData.data.identifier&&(t._touchDown=!1,this.dispatchEvent(t,"touchendoutside",this.eventData))},n.prototype.onTouchMove=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,n=0;i>n;n++){var s=e[n],r=this.getTouchData(s);r.originalEvent=t,this.eventData.data=r,this.eventData.stopped=!1,this.emit("stagemove",this.eventData),this.processInteractive(r.global,this.renderer._lastObjectRendered,this.processTouchMove,!0),this.returnTouchData(r)}},n.prototype.processTouchMove=function(t,e){e=e,this.dispatchEvent(t,"touchmove",this.eventData)},n.prototype.getTouchData=function(t){var e=this.interactiveDataPool.pop();return e||(e=new r),e.identifier=t.identifier,this.mapPositionToPoint(e.global,t.clientX,t.clientY),navigator.isCocoonJS&&(e.global.x=e.global.x/this.resolution,e.global.y=e.global.y/this.resolution),t.globalX=e.global.x,t.globalY=e.global.y,e},n.prototype.returnTouchData=function(t){this.interactiveDataPool.push(t)},n.prototype.destroy=function(){this.removeEvents(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactiveDataPool=null,this.interactionDOMElement=null,this.onMouseUp=null,this.processMouseUp=null,this.onMouseDown=null,this.processMouseDown=null,this.onMouseMove=null,this.processMouseMove=null,this.onMouseOut=null,this.processMouseOverOut=null,this.onMouseOver=null,this.onTouchStart=null,this.processTouchStart=null,this.onTouchEnd=null,this.processTouchEnd=null,this.onTouchMove=null,this.processTouchMove=null,this._tempPoint=null,this.handleCursorChange=null},s.WebGLRenderer.registerPlugin("interaction",n),s.CanvasRenderer.registerPlugin("interaction",n)},{"../core":30,"./InteractionData":116,"./interactiveTarget":119,eventemitter3:10}],118:[function(t,e,i){e.exports={InteractionData:t("./InteractionData"),InteractionManager:t("./InteractionManager"),interactiveTarget:t("./interactiveTarget")}},{"./InteractionData":116,"./InteractionManager":117,"./interactiveTarget":119}],119:[function(t,e,i){e.exports={interactive:!1,buttonMode:!1,interactiveChildren:!0,defaultCursor:"pointer",_over:!1,_touchDown:!1}},{}],120:[function(t,e,i){function n(t,e){var i={},n=t.data.getElementsByTagName("info")[0],s=t.data.getElementsByTagName("common")[0];i.font=n.getAttribute("face"),i.size=parseInt(n.getAttribute("size"),10),i.lineHeight=parseInt(s.getAttribute("lineHeight"),10),i.chars={};for(var a=t.data.getElementsByTagName("char"),h=0;h<a.length;h++){var l=parseInt(a[h].getAttribute("id"),10),u=new r.Rectangle(parseInt(a[h].getAttribute("x"),10)+e.frame.x,parseInt(a[h].getAttribute("y"),10)+e.frame.y,parseInt(a[h].getAttribute("width"),10),parseInt(a[h].getAttribute("height"),10));i.chars[l]={xOffset:parseInt(a[h].getAttribute("xoffset"),10),yOffset:parseInt(a[h].getAttribute("yoffset"),10),xAdvance:parseInt(a[h].getAttribute("xadvance"),10),kerning:{},texture:new r.Texture(e.baseTexture,u)}}var c=t.data.getElementsByTagName("kerning");for(h=0;h<c.length;h++){var d=parseInt(c[h].getAttribute("first"),10),p=parseInt(c[h].getAttribute("second"),10),f=parseInt(c[h].getAttribute("amount"),10);i.chars[p].kerning[d]=f}t.bitmapFont=i,o.BitmapText.fonts[i.font]=i}var s=t("resource-loader").Resource,r=t("../core"),o=t("../extras"),a=t("path");e.exports=function(){return function(t,e){if(!t.data||!t.isXml)return e();if(0===t.data.getElementsByTagName("page").length||0===t.data.getElementsByTagName("info").length||null===t.data.getElementsByTagName("info")[0].getAttribute("face"))return e();var i=a.dirname(t.url);"."===i&&(i=""),this.baseUrl&&i&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/"),i=i.replace(this.baseUrl,"")),i&&"/"!==i.charAt(i.length-1)&&(i+="/");var o=i+t.data.getElementsByTagName("page")[0].getAttribute("file"),h=o;if(r.utils.useFilenamesForTextures&&(h=r.utils.getFilenameFromUrl(h)),r.utils.TextureCache[h])n(t,r.utils.TextureCache[h]),e();else{var l={crossOrigin:t.crossOrigin,loadType:s.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata};this.add(t.name+"_image",o,l,(function(i){n(t,i.texture),e()}))}}}},{"../core":30,"../extras":86,path:2,"resource-loader":16}],121:[function(t,e,i){e.exports={Loader:t("./loader"),bitmapFontParser:t("./bitmapFontParser"),spritesheetParser:t("./spritesheetParser"),textureParser:t("./textureParser"),Resource:t("resource-loader").Resource}},{"./bitmapFontParser":120,"./loader":122,"./spritesheetParser":123,"./textureParser":124,"resource-loader":16}],122:[function(t,e,i){function n(t,e){s.call(this,t,e);for(var i=0;i<n._pixiMiddleware.length;++i)this.use(n._pixiMiddleware[i]())}var s=t("resource-loader"),r=t("./textureParser"),o=t("./spritesheetParser"),a=t("./bitmapFontParser");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n._pixiMiddleware=[s.middleware.parsing.blob,r,o,a],n.addPixiMiddleware=function(t){n._pixiMiddleware.push(t)};var h=s.Resource;h.setExtensionXhrType("fnt",h.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":120,"./spritesheetParser":123,"./textureParser":124,"resource-loader":16}],123:[function(t,e,i){var n=t("resource-loader").Resource,s=t("path"),r=t("../core");e.exports=function(){return function(t,e){if(!t.data||!t.isJson||!t.data.frames)return e();var i={crossOrigin:t.crossOrigin,loadType:n.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata},o=s.dirname(t.url.replace(this.baseUrl,"")),a=r.utils.getResolutionOfUrl(t.url);this.add(t.name+"_image",o+"/"+t.data.meta.image,i,(function(i){t.textures={};var n=t.data.frames;for(var s in n){var o=n[s].frame;if(o){var h=null,l=null;if(h=n[s].rotated?new r.Rectangle(o.x,o.y,o.h,o.w):new r.Rectangle(o.x,o.y,o.w,o.h),n[s].trimmed&&(l=new r.Rectangle(n[s].spriteSourceSize.x/a,n[s].spriteSourceSize.y/a,n[s].sourceSize.w/a,n[s].sourceSize.h/a)),n[s].rotated){var u=h.width;h.width=h.height,h.height=u}h.x/=a,h.y/=a,h.width/=a,h.height/=a;var c=s;r.utils.useFilenamesForTextures&&(c=r.utils.getFilenameFromUrl(s)),t.textures[c]=new r.Texture(i.texture.baseTexture,h,h.clone(),l,n[s].rotated),r.utils.TextureCache[c]=t.textures[c]}}e()}))}}},{"../core":30,path:2,"resource-loader":16}],124:[function(t,e,i){var n=t("../core");e.exports=function(){return function(t,e){if(t.data&&t.isImage){var i=new n.BaseTexture(t.data,null,n.utils.getResolutionOfUrl(t.url));i.imageUrl=t.url,t.texture=new n.Texture(i);var s=t.url;n.utils.useFilenamesForTextures&&(s=n.utils.getFilenameFromUrl(s)),n.utils.BaseTextureCache[s]=i,n.utils.TextureCache[s]=t.texture}e()}}},{"../core":30}],125:[function(t,e,i){function n(t,e,i,r,o){s.Container.call(this),this._texture=null,this.uvs=i||new Float32Array([0,0,1,0,1,1,0,1]),this.vertices=e||new Float32Array([0,0,100,0,100,100,0,100]),this.indices=r||new Uint16Array([0,1,3,2]),this.dirty=!0,this.blendMode=s.BLEND_MODES.NORMAL,this.canvasPadding=0,this.drawMode=o||n.DRAW_MODES.TRIANGLE_MESH,this.texture=t,this.shader=null}var s=t("../core"),r=new s.Point,o=new s.Polygon;n.prototype=Object.create(s.Container.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),n.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.mesh),t.plugins.mesh.render(this)},n.prototype._renderCanvas=function(t){var e=t.context,i=this.worldTransform;t.roundPixels?e.setTransform(i.a,i.b,i.c,i.d,0|i.tx,0|i.ty):e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.drawMode===n.DRAW_MODES.TRIANGLE_MESH?this._renderCanvasTriangleMesh(e):this._renderCanvasTriangles(e)},n.prototype._renderCanvasTriangleMesh=function(t){for(var e=this.vertices,i=this.uvs,n=e.length/2,s=0;n-2>s;s++){var r=2*s;this._renderCanvasDrawTriangle(t,e,i,r,r+2,r+4)}},n.prototype._renderCanvasTriangles=function(t){for(var e=this.vertices,i=this.uvs,n=this.indices,s=n.length,r=0;s>r;r+=3){var o=2*n[r],a=2*n[r+1],h=2*n[r+2];this._renderCanvasDrawTriangle(t,e,i,o,a,h)}},n.prototype._renderCanvasDrawTriangle=function(t,e,i,n,s,r){var o=this._texture.baseTexture.source,a=this._texture.baseTexture.width,h=this._texture.baseTexture.height,l=e[n],u=e[s],c=e[r],d=e[n+1],p=e[s+1],f=e[r+1],g=i[n]*a,v=i[s]*a,m=i[r]*a,y=i[n+1]*h,_=i[s+1]*h,b=i[r+1]*h;if(this.canvasPadding>0){var w=this.canvasPadding/this.worldTransform.a,x=this.canvasPadding/this.worldTransform.d,T=(l+u+c)/3,E=(d+p+f)/3,S=l-T,A=d-E,P=Math.sqrt(S*S+A*A);l=T+S/P*(P+w),d=E+A/P*(P+x),A=p-E,u=T+(S=u-T)/(P=Math.sqrt(S*S+A*A))*(P+w),p=E+A/P*(P+x),A=f-E,c=T+(S=c-T)/(P=Math.sqrt(S*S+A*A))*(P+w),f=E+A/P*(P+x)}t.save(),t.beginPath(),t.moveTo(l,d),t.lineTo(u,p),t.lineTo(c,f),t.closePath(),t.clip();var C=g*_+y*m+v*b-_*m-y*v-g*b,M=l*_+y*c+u*b-_*c-y*u-l*b,L=g*u+l*m+v*c-u*m-l*v-g*c,O=g*_*c+y*u*m+l*v*b-l*_*m-y*v*c-g*u*b,R=d*_+y*f+p*b-_*f-y*p-d*b,I=g*p+d*m+v*f-p*m-d*v-g*f,D=g*_*f+y*p*m+d*v*b-d*_*m-y*v*f-g*p*b;t.transform(M/C,R/C,L/C,I/C,O/C,D/C),t.drawImage(o,0,0),t.restore()},n.prototype.renderMeshFlat=function(t){var e=this.context,i=t.vertices,n=i.length/2;e.beginPath();for(var s=1;n-2>s;s++){var r=2*s,o=i[r],a=i[r+2],h=i[r+4],l=i[r+1],u=i[r+3],c=i[r+5];e.moveTo(o,l),e.lineTo(a,u),e.lineTo(h,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},n.prototype._onTextureUpdate=function(){this.updateFrame=!0},n.prototype.getBounds=function(t){if(!this._currentBounds){for(var e=t||this.worldTransform,i=e.a,n=e.b,r=e.c,o=e.d,a=e.tx,h=e.ty,l=-1/0,u=-1/0,c=1/0,d=1/0,p=this.vertices,f=0,g=p.length;g>f;f+=2){var v=p[f],m=p[f+1],y=i*v+r*m+a,_=o*m+n*v+h;c=c>y?y:c,d=d>_?_:d,l=y>l?y:l,u=_>u?_:u}if(c===-1/0||u===1/0)return s.Rectangle.EMPTY;var b=this._bounds;b.x=c,b.width=l-c,b.y=d,b.height=u-d,this._currentBounds=b}return this._currentBounds},n.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,r);var e,i,s=this.vertices,a=o.points;if(this.drawMode===n.DRAW_MODES.TRIANGLES){var h=this.indices;for(i=this.indices.length,e=0;i>e;e+=3){var l=2*h[e],u=2*h[e+1],c=2*h[e+2];if(a[0]=s[l],a[1]=s[l+1],a[2]=s[u],a[3]=s[u+1],a[4]=s[c],a[5]=s[c+1],o.contains(r.x,r.y))return!0}}else for(i=s.length,e=0;i>e;e+=6)if(a[0]=s[e],a[1]=s[e+1],a[2]=s[e+2],a[3]=s[e+3],a[4]=s[e+4],a[5]=s[e+5],o.contains(r.x,r.y))return!0;return!1},n.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":30}],126:[function(t,e,i){function n(t,e,i){s.call(this,t),this._ready=!0,this.segmentsX=e||10,this.segmentsY=i||10,this.drawMode=s.DRAW_MODES.TRIANGLES,this.refresh()}var s=t("./Mesh");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.refresh=function(){var t=this.segmentsX*this.segmentsY,e=[],i=[],n=[],s=this.texture,r=this.segmentsX-1,o=this.segmentsY-1,a=0,h=s.width/r,l=s.height/o;for(a=0;t>a;a++){var u=a%this.segmentsX,c=a/this.segmentsX|0;e.push(u*h,c*l),i.push(u/(this.segmentsX-1),c/(this.segmentsY-1))}var d=r*o;for(a=0;d>a;a++){var p=a%r,f=a/r|0,g=f*this.segmentsX+p,v=f*this.segmentsX+p+1,m=(f+1)*this.segmentsX+p,y=(f+1)*this.segmentsX+p+1;n.push(g,v,m),n.push(v,y,m)}this.vertices=new Float32Array(e),this.uvs=new Float32Array(i),this.colors=new Float32Array([]),this.indices=new Uint16Array(n)},n.prototype._onTextureUpdate=function(){s.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()}},{"./Mesh":125}],127:[function(t,e,i){function n(t,e){s.call(this,t),this.points=e,this.vertices=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length),this._ready=!0,this.refresh()}var s=t("./Mesh"),r=t("../core");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){var e=this.uvs,i=this.indices,n=this.colors,s=this._texture._uvs,o=new r.Point(s.x0,s.y0),a=new r.Point(s.x2-s.x0,s.y2-s.y0);e[0]=0+o.x,e[1]=0+o.y,e[2]=0+o.x,e[3]=1*a.y+o.y,n[0]=1,n[1]=1,i[0]=0,i[1]=1;for(var h,l,u=t.length,c=1;u>c;c++)t[c],l=c/(u-1),e[h=4*c]=l*a.x+o.x,e[h+1]=0+o.y,e[h+2]=l*a.x+o.x,e[h+3]=1*a.y+o.y,n[h=2*c]=1,n[h+1]=1,i[h=2*c]=h,i[h+1]=h+1;this.dirty=!0}},n.prototype._onTextureUpdate=function(){s.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},n.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){for(var e,i,n,s,r,o=t[0],a=0,h=0,l=this.vertices,u=t.length,c=0;u>c;c++)i=t[c],n=4*c,h=-((e=c<t.length-1?t[c+1]:i).x-o.x),a=e.y-o.y,10*(1-c/(u-1))>1&&1,a/=s=Math.sqrt(a*a+h*h),h/=s,a*=r=this._texture.height/2,h*=r,l[n]=i.x+a,l[n+1]=i.y+h,l[n+2]=i.x-a,l[n+3]=i.y-h,o=i;this.containerUpdateTransform()}}},{"../core":30,"./Mesh":125}],128:[function(t,e,i){e.exports={Mesh:t("./Mesh"),Plane:t("./Plane"),Rope:t("./Rope"),MeshRenderer:t("./webgl/MeshRenderer"),MeshShader:t("./webgl/MeshShader")}},{"./Mesh":125,"./Plane":126,"./Rope":127,"./webgl/MeshRenderer":129,"./webgl/MeshShader":130}],129:[function(t,e,i){function n(t){s.ObjectRenderer.call(this,t),this.indices=new Uint16Array(15e3);for(var e=0,i=0;15e3>e;e+=6,i+=4)this.indices[e+0]=i+0,this.indices[e+1]=i+1,this.indices[e+2]=i+2,this.indices[e+3]=i+0,this.indices[e+4]=i+2,this.indices[e+5]=i+3;this.currentShader=null}var s=t("../../core"),r=t("../Mesh");n.prototype=Object.create(s.ObjectRenderer.prototype),n.prototype.constructor=n,e.exports=n,s.WebGLRenderer.registerPlugin("mesh",n),n.prototype.onContextChange=function(){},n.prototype.render=function(t){t._vertexBuffer||this._initWebGL(t);var e=this.renderer,i=e.gl,n=t._texture.baseTexture,s=t.shader,o=t.drawMode===r.DRAW_MODES.TRIANGLE_MESH?i.TRIANGLE_STRIP:i.TRIANGLES;e.blendModeManager.setBlendMode(t.blendMode),s=s?s.shaders[i.id]||s.getShader(e):e.shaderManager.plugins.meshShader,this.renderer.shaderManager.setShader(s),s.uniforms.translationMatrix.value=t.worldTransform.toArray(!0),s.uniforms.projectionMatrix.value=e.currentRenderTarget.projectionMatrix.toArray(!0),s.uniforms.alpha.value=t.worldAlpha,s.syncUniforms(),t.dirty?(t.dirty=!1,i.bindBuffer(i.ARRAY_BUFFER,t._vertexBuffer),i.bufferData(i.ARRAY_BUFFER,t.vertices,i.STATIC_DRAW),i.vertexAttribPointer(s.attributes.aVertexPosition,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.bufferData(i.ARRAY_BUFFER,t.uvs,i.STATIC_DRAW),i.vertexAttribPointer(s.attributes.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),n._glTextures[i.id]?i.bindTexture(i.TEXTURE_2D,n._glTextures[i.id]):this.renderer.updateTexture(n),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t._indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.indices,i.STATIC_DRAW)):(i.bindBuffer(i.ARRAY_BUFFER,t._vertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,t.vertices),i.vertexAttribPointer(s.attributes.aVertexPosition,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.vertexAttribPointer(s.attributes.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),n._glTextures[i.id]?i.bindTexture(i.TEXTURE_2D,n._glTextures[i.id]):this.renderer.updateTexture(n),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t._indexBuffer),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,t.indices)),i.drawElements(o,t.indices.length,i.UNSIGNED_SHORT,0)},n.prototype._initWebGL=function(t){var e=this.renderer.gl;t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.STATIC_DRAW),t.colors&&(t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)},n.prototype.flush=function(){},n.prototype.start=function(){this.currentShader=null},n.prototype.destroy=function(){s.ObjectRenderer.prototype.destroy.call(this)}},{"../../core":30,"../Mesh":125}],130:[function(t,e,i){function n(t){s.Shader.call(this,t,["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"),{alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aTextureCoord:0})}var s=t("../../core");n.prototype=Object.create(s.Shader.prototype),n.prototype.constructor=n,e.exports=n,s.ShaderManager.registerPlugin("meshShader",n)},{"../../core":30}],131:[function(t,e,i){Math.sign||(Math.sign=function(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1})},{}],132:[function(t,e,i){Object.assign||(Object.assign=t("object-assign"))},{"object-assign":11}],133:[function(t,e,i){t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign")},{"./Math.sign":131,"./Object.assign":132,"./requestAnimationFrame":134}],134:[function(t,e,i){(function(t){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var i=Date.now(),n=["ms","moz","webkit","o"],s=0;s<n.length&&!t.requestAnimationFrame;++s)t.requestAnimationFrame=t[n[s]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[n[s]+"CancelAnimationFrame"]||t[n[s]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+i-e;return 0>n&&(n=0),i=e,setTimeout((function(){i=Date.now(),t(performance.now())}),n)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[115])(115)})),function(){"use strict";var t,e,i,n;"extend"in(n=window)||(n.extend=function(t,e){if(e){"string"==typeof e&&(e=n.include(e));var i=e.prototype;t.prototype=Object.create(i),Object.defineProperty(t.prototype,"__parent",{configurable:!0,writable:!0,value:i})}return Object.defineProperty(t.prototype,"constructor",{configurable:!0,writable:!0,value:t}),t.extend=function(e){return n.extend(e,t)},t.prototype}),function(t,e){if(!("include"in t)){t.include=function(e,i){var n=e.split("."),s=t,r="";i=void 0===i||!!i;for(var o=0,a=n.length;a>o;o++){if(!s[r=n[o]]){if(!i)return null;throw"Unable to include '"+e+"'"}s=s[r]}return s}}}(window),function(t,e){if(!("mixin"in t)){t.mixin=function(i,n){if("string"==typeof n&&(n=t.include(n)),!n.prototype)throw"no mixin prototype";var s=n.prototype;for(var r in s){var o=e.getOwnPropertyDescriptor(s,r);o?e.defineProperty(i,r,o):i[r]=s[r]}return n.apply(i,Array.prototype.slice.call(arguments,2)),i}}}(window,Object),function(t){if(!("namespace"in t)){t.namespace=function(e){for(var i=e.split("."),n=t,s="",r=0,o=i.length;o>r;r++)n[s=i[r]]=n[s]||{},n=n[s];return n}}}(window),function(t,e,i){t.prototype.shuffle||i.defineProperty(t.prototype,"shuffle",{enumerable:!1,writable:!1,value:function(){for(var t,i,n=this.length;n;t=e.floor(e.random()*n),i=this[--n],this[n]=this[t],this[t]=i);return this}}),t.prototype.random||i.defineProperty(t.prototype,"random",{enumerable:!1,writable:!1,value:function(){return this[e.floor(e.random()*this.length)]}}),t.prototype.last||i.defineProperty(t.prototype,"last",{enumerable:!1,writable:!1,value:function(){return this[this.length-1]}}),t.prototype.append||i.defineProperty(t.prototype,"append",{enumerable:!1,writable:!1,value:function(){for(var e=arguments,i=0,n=e.length;n>i;++i){var s=e[i];if(t.isArray(s))for(var r=0,o=s.length;o>r;++r)this.push(s[r]);else this.push(s)}return this}})}(Array,Math,Object),function(t){t.randomInt=function(e,i){return void 0===i&&(i=e,e=0),t.floor(t.random()*(i-e+1))+e},t.randomFloat=function(e,i){return void 0===i&&(i=e,e=0),t.random()*(i-e)+e},t.dist=function(e,i,n,s){return t.sqrt(t.distSq(e,i,n,s))},t.distSq=function(t,e,i,n){return"number"==typeof t.x&&t.x==t.x&&(n=i,i=e,e=t.y,t=t.x),"number"==typeof i.x&&i.x==i.x&&(n=i.y,i=i.x),(t-i)*(t-i)+(e-n)*(e-n)},t.clamp=function(t,e,i){return void 0===i&&(i=e,e=0),t>i?i:e>t?e:t},t.roundDecimal=function(e,i){return t.round(e/i)*i}}(Math),function(t,e){t.prototype.toPaddedString||e.defineProperty(t.prototype,"toPaddedString",{enumerable:!1,writable:!1,value:function(t){t||(t=2);var e,i=this;0>i&&(i*=-1,e="-");for(var n=String(Math.floor(i));n.length<t;)n="0"+n;return e&&(n=e+n),n}})}(Number,Object),function(t,e,i){t.merge=function(e,i){for(var n in e&&"object"==typeof e||(e={}),i)if(i.hasOwnProperty(n)){var s=i[n];if("object"==typeof s&&t.isPlain(s)){e[n]=t.merge(e[n],s);continue}e[n]=s}for(var r=2,o=arguments.length;o>r;r++)t.merge(e,arguments[r]);return e},t.isPlain=function(t){var i,n=e.hasOwnProperty;if(!t||"object"!=typeof t||t.nodeType||t===window)return!1;try{if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(e.ownLast)for(i in t)return n.call(t,i);for(i in t);return void 0===i||n.call(t,i)},t.prototype.clone||t.defineProperty(t.prototype,"clone",{enumerable:!1,writable:!0,value:function(){var t={};for(var e in this)t[e]=this[e];return t}})}(Object,{}),function(){var t=include("createjs.RequestUtils",!1),e=include("createjs.AbstractLoader",!1);if(t){var i=t.getTypeByExtension;t.getTypeByExtension=function(t){if(t)switch(t.toLowerCase()){case"fnt":return e.XML}return i(t)}}}(),function(t,e){e.defineProperty(t.prototype,"format",{enumerable:!1,writable:!1,value:function(){if(arguments.length<1)return this;var t=Array.isArray(t)?t:Array.prototype.slice.call(arguments);return this.replace(/([^%]|^)%(?:(\d+)\$)?s/g,(function(e,i,n){return n?i+t[parseInt(n)-1]:i+t.shift()})).replace(/%%s/g,"%s")}}),t.prototype.reverse||e.defineProperty(t.prototype,"reverse",{enumerable:!1,writable:!1,value:function(){for(var t="",e=this.length-1;e>=0;e--)t+=this[e];return t}})}(String,Object),function(){function t(){this.currentCallCount=0}var e={create:function(e,i){if(!e)return null;("number"!=typeof i||1>i)&&(i=2);var n=function(){++n.currentCallCount>=i&&e()};return n.currentCallCount=0,n.reset=t,n}};namespace("springroll").CombinedCallback=e}(),e=function(e,i,n,s,r){t||(t=include("springroll.Application")),"boolean"==typeof n&&(n={repeat:!!n,autoDestroy:void 0===s||!!s,useFrames:!!r}),n=Object.merge({repeat:!1,autoDestroy:!0,useFrames:!1},n||{}),this._callback=e,this._delay=i,this._timer=i,this._repeat=n.repeat,this._autoDestroy=n.autoDestroy,this._useFrames=n.useFrames,this._paused=!1,this._update=this._update.bind(this),t.instance.on("update",this._update)},(i=extend(e))._update=function(e){return this._callback?(this._timer-=this._useFrames?1:e,void(this._timer<=0&&(this._callback(this),this._repeat?this._timer+=this._delay:this._autoDestroy?this.destroy():t.instance.off("update",this._update)))):void this.destroy()},i.restart=function(){if(this._callback){var e=t.instance;e.has("update",this._update)||e.on("update",this._update),this._timer=this._delay,this._paused=!1}},i.stop=function(){t.instance.off("update",this._update),this._paused=!1},Object.defineProperty(i,"paused",{get:function(){return this._paused},set:function(e){if(this._callback){var i=t.instance;this._paused&&!e?(this._paused=!1,i.has("update",this._update)||i.on("update",this._update)):e&&i.has("update",this._update)&&(this._paused=!0,i.off("update",this._update))}}}),i.destroy=function(){t.instance.off("update",this._update),this._callback=null},namespace("springroll").DelayedCall=e,function(){var t,e=function(e,i,n){void 0===t&&(t=include("springroll.Debug",!1)),this.name=e,this._value=i,this._toString=n||this.name};Object.defineProperty(e.prototype,"asInt",{get:function(){return this._value}}),e.prototype.toString=function(){return this._toString};var i=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);Object.defineProperty(this,"_byValue",{enumerable:!1,writable:!1,value:[]}),Object.defineProperty(this,"rawEnumValues",{enumerable:!1,writable:!1,value:t});for(var i,n,s,r=0,o=0,a=t.length;a>o;++o)"string"==typeof t[o]?s=t[o]:(s=t[o].name,n=t[o].value||r,r=n),this[s]||(this[(i="string"==typeof t[o]?new e(s,r,s):new e(s,n,t[o].toString||s)).name]=i,this._byValue[r]?Array.isArray(this._byValue[r])?this._byValue[r].push(i):this._byValue[r]=[this._byValue[r],i]:this._byValue[r]=i,r++);Object.defineProperty(this,"length",{enumerable:!1,writable:!1,value:t.length}),Object.defineProperty(this,"next",{enumerable:!1,writable:!1,value:function(t){var e=t.asInt+1;return e>=r?this.first:this.valueFromInt(e)}}),Object.defineProperty(this,"first",{enumerable:!1,writable:!1,value:this.valueFromInt(t[0].value||0)}),Object.defineProperty(this,"last",{enumerable:!1,writable:!1,value:this.valueFromInt(r-1)})},n=extend(i);Object.defineProperty(n,"valueFromInt",{enumerable:!1,writable:!1,value:function(t){var e=this._byValue[t];return e?Array.isArray(e)?e[0]:e:null}}),namespace("springroll").Enum=i}(),function(t){var e={},i=void 0!==window.Storage;if(i)try{localStorage.setItem("LS_TEST","test"),localStorage.removeItem("LS_TEST")}catch(t){i=!1}e.remove=function(t){i?(localStorage.removeItem(t),sessionStorage.removeItem(t)):e.write(t,"",-1)},e.write=function(t,e,n){var s;i?n?sessionStorage.setItem(t,JSON.stringify(e)):localStorage.setItem(t,JSON.stringify(e)):(s=n?-1!==n?"":"; expires=Thu, 01 Jan 1970 00:00:00 GMT":"; expires="+new Date(2147483646e3).toGMTString(),document.cookie=t+"="+escape(JSON.stringify(e))+s+"; path=/")},e.read=function(t){if(i){var n=localStorage.getItem(t)||sessionStorage.getItem(t);return n?JSON.parse(n,e.reviver):null}var s,r,o=t+"=",a=document.cookie.split(";"),h=0;for(h=0,r=a.length;r>h;h++){for(s=a[h];" "==s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(o))return JSON.parse(unescape(s.substring(o.length,s.length)),e.reviver)}return null},e.reviver=function(t,e){if(e&&"string"==typeof e.__classname){var i=include(e.__classname,!1);if(i){var n=new i;if(n.fromJSON)return n.fromJSON(e),n}}return e},namespace("springroll").SavedData=e}(),function(t){var e=include("performance",!1),i=e&&(e.now||e.mozNow||e.msNow||e.oNow||e.webkitNow);i&&(e.now=i);var n={};n.now=i?function(){return e.now()}:Date.now,namespace("springroll").TimeUtils=n}(window),function(){var t=function(t){this.max=-1,this.options=[];var e=0;for(var i in t)e+=t[i],this.options.push({key:i,value:e}),this.max+=t[i]};extend(t).random=function(){for(var t=Math.randomInt(0,this.max),e=0,i=this.options,n=i.length;n>e;++e)if(t<i[e].value)return i[e].key;return null},namespace("springroll").WeightedRandom=t}(),function(){for(var t=["ms","moz","webkit","o"],e=t.length,i=0;e>i&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];if(!window.requestAnimationFrame){var n=include("springroll.TimeUtils"),s=0;window.requestAnimationFrame=function(t){var e=n.now(),i=Math.max(0,16-(e-s)),r=window.setTimeout((function(){t(e+i)}),i);return s=e+i,r},window.cancelAnimationFrame=function(t){clearTimeout(t)}}window.requestAnimFrame=window.requestAnimationFrame}(),function(t){function e(t,e){return t._priority-e._priority}function i(t){if(null===t)return"null";var e=typeof t;return"object"===e||"function"===e?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":e}var n=function(){this._listeners={},this._destroyed=!1},s=extend(n);Object.defineProperty(s,"destroyed",{enumerable:!0,get:function(){return this._destroyed}}),s.trigger=function(e){if(!this._destroyed&&this._listeners.hasOwnProperty(e)&&this._listeners[e]!==t){var i,n=this._listeners[e].slice();arguments.length>1&&(i=Array.prototype.slice.call(arguments,1));for(var s=n.length-1;s>=0;--s){var r=n[s];r._eventDispatcherOnce&&(delete r._eventDispatcherOnce,this.off(e,r)),r.apply(this,i)}}},s.once=function(t,e,i){return this.on(t,e,i,!0)},s.on=function(t,n,s,r){if(!this._destroyed){if("object"===i(t))for(var o in t)t.hasOwnProperty(o)&&this.on(o,t[o],s,r);else if("function"===i(n))for(var a,h=t.split(" "),l=null,u=0,c=h.length;c>u;u++)l=h[u],a=this._listeners.hasOwnProperty(l)?this._listeners[l]:this._listeners[l]=[],r&&(n._eventDispatcherOnce=!0),n._priority=parseInt(s)||0,-1===a.indexOf(n)&&(a.push(n),a.length>1&&a.sort(e));else if(Array.isArray(n))for(var d=0,p=n.length;p>d;d++)this.on(t,n[d],s,r);return this}},s.off=function(e,i){if(!this._destroyed){if(e===t)this._listeners={};else if(Array.isArray(i))for(var n=0,s=i.length;s>n;n++)this.off(e,i[n]);else for(var r,o,a=e.split(" "),h=null,l=0,u=a.length;u>l;l++)h=a[l],this._listeners.hasOwnProperty(h)&&(r=this._listeners[h],i===t?r.length=0:-1!==(o=r.indexOf(i))&&r.splice(o,1));return this}},s.has=function(t,e){if(!t||!this._listeners.hasOwnProperty(t))return!1;var i=this._listeners[t];return!!i&&(e?i.indexOf(e)>=0:i.length>0)},s.destroy=function(){this._destroyed=!0,this._listeners=null},namespace("springroll").EventDispatcher=n}(),function(t){var e=include("springroll.EventDispatcher"),i=function(){e.call(this),this._properties={}},n=e.prototype,s=e.extend(i),r=function(t,e){var i=this._properties[t];if(i.readOnly)throw"Property '"+t+"' is read-only";var n=i.value;i.value=e,n!=e&&this.trigger(t,e)},o=function(t){var e=this._properties[t];if(e.responder){var i=e.responder();return e.value=i,i}return e.value};s.add=function(e,i,n){var s=this._properties,h=s[e];if(h!==t)return h.setValue(i),h.setReadOnly(n===t?h.readOnly:n),this;if(this.hasOwnProperty(e))throw"Object already has property "+e;return s[e]=new a(e,i,n),Object.defineProperty(this,e,{get:o.bind(this,e),set:r.bind(this,e)}),this},s.respond=function(e,i){var n=this._properties[e];if(n===t)throw"Property "+e+" does not exist";return n.responder=i,n.value=i(),this},s.destroy=function(){var t;for(var e in this._properties)(t=this._properties[e]).value=null,t.responder=null;this._properties=null,n.destroy.call(this)};var a=function(t,e,i){this.name=t,this.setValue(e),this.setReadOnly(i),this.responder=null};a.prototype.setValue=function(e){this.value=e===t?null:e},a.prototype.setReadOnly=function(e){this.readOnly=e!==t&&!!e},namespace("springroll").PropertyDispatcher=i}(),function(t){var e,i=include("springroll.PropertyDispatcher"),n=function(n,s){e===t&&(e=include("springroll.Debug",!1)),i.call(this),this._options=s||{},this._app=n},s=i.extend(n);s.init=function(){var t=this._options;for(var e in this._app,(t=Object.merge({},t)).useQueryString&&Object.merge(t,r()),t)this.add(e,t[e]);var i=this._properties;for(var n in i)this.trigger(n,i[n].value)};var r=function(){var e={},i=window.location.search;if(!i)return e;for(var n,s=i.substr(i.indexOf("?")+1),r=s.indexOf("#"),o=(s=0>r?s:s.substring(0,r)).split("&"),a=0,h=o.length;h>a;a++){var l=(n=o[a].split("="))[1];"true"===l||l===t?l=!0:"false"===l&&(l=!1),e[n[0]]=l}return e};s.asDOMElement=function(t){var e=this._properties[t];e&&e.value&&"string"==typeof e.value&&(e.value=document.getElementById(e.value))},s.override=function(e,i){var n=this._properties[e];if(n===t)throw"Invalid override "+e;return n.setValue(i),this},namespace("springroll").ApplicationOptions=n}(),function(){var t;namespace("springroll").ApplicationPlugin=function(e){t||(t=include("springroll.Application")),this.priority=e||0,this.setup=function(){},this.preload=null,this.teardown=function(){},t._plugins.push(this),t._plugins.sort((function(t,e){return e.priority-t.priority}))}}(),function(t){var e=include("springroll.TimeUtils"),i=include("springroll.EventDispatcher"),n=include("springroll.ApplicationOptions"),s=include("springroll.DelayedCall"),r=function(t,e){if(m)throw"Only one Application can be opened at a time";m=this,i.call(this),this.options=new n(this,t),this.display=null,this.init=e||null,this.pluginLoad=null,v={},g=[],l=this._tick.bind(this),r._plugins.forEach((function(t){t.setup.call(m)})),this.options.init(),this.name=this.options.name,setTimeout(this._preInit.bind(this),0)};r.version="0.4.26";var o=i.prototype,a=i.extend(r);r._plugins=[];var h=0,l=null,u=!1,c=!0,d=-1,p=!1,f=0,g=null,v=null,m=null;Object.defineProperty(r,"instance",{get:function(){return m}}),a._preInit=function(){if(!this.destroyed){var t=this.options;p=t.raf,t.on("raf",(function(t){p=t})),t.on("fps",(function(t){"number"==typeof t&&(f=1e3/t|0)})),t.canvasId&&t.display&&this.addDisplay(t.canvasId,t.display,t.displayOptions);var e=[];r._plugins.forEach((function(t){t.preload&&e.push(t.preload.bind(m))})),this.pluginLoad=this.load(e,{complete:this._doInit.bind(this),progress:y.bind(this),autoStart:!1,startAll:!1}),this.pluginLoad.start()}};var y=function(t){this.trigger("pluginProgress",t)};a._doInit=function(){this.destroyed||(this.pluginLoad=null,this.trigger("beforeInit"),this.paused=!1,this.trigger("init"),this.init&&this.init.call(this),this.trigger("afterInit"))},Object.defineProperty(a,"enabled",{set:function(t){c=t,g.forEach((function(e){e.enabled=t}))},get:function(){return c}}),Object.defineProperty(a,"paused",{get:function(){return u},set:function(t){u=!!t,this.internalPaused(u)}}),a.internalPaused=function(t){this.trigger("pause",t),this.trigger(t?"paused":"resumed",t),t?-1!=d&&(p?cancelAnimationFrame(d):clearTimeout(d),d=-1):-1==d&&l&&(h=e.now(),d=p?requestAnimFrame(l):_(l))};var _=function(t,e){var i=f;return e&&(i=Math.max(0,f-e)),setTimeout(t,i)};a.addDisplay=function(t,e,i){if(v[t])throw"Display exists with id '"+t+"'";var n=new e(t,i);return v[t]=n,g.push(n),n.enabled=c,this.display||(this.display=n),this.trigger("displayAdded",n),n},Object.defineProperty(a,"displays",{get:function(){return g}}),a.getDisplay=function(t){return v[t]},a.removeDisplay=function(t){var e=v[t];e&&(g.splice(g.indexOf(e),1),e.destroy(),delete v[t],this.trigger("displayRemoved",t))},a._tick=function(){if(u)d=-1;else{var t=e.now(),i=t-h;if(h=t,this.trigger("update",i),g)for(var n=0;n<g.length;n++)g[n].render(i);l&&(d=p?requestAnimFrame(l):_(l,e.now()-h))}},a.setTimeout=function(t,e,i,n){return new s(t,e,!1,n,i)},a.setInterval=function(t,e,i){return new s(t,e,!0,!1,i)},a.destroy=function(){this.destroyed||(this.paused=!0,this.trigger("destroy"),r._plugins.slice().reverse().forEach((function(t){t.teardown.call(m)})),g.forEach((function(t){t.destroy()})),g=null,v=null,m=l=null,this.display=null,this.options.destroy(),this.options=null,o.destroy.call(this))},a.toString=function(){return"[Application name='"+this.name+"']"},namespace("springroll").Application=r}(),function(){var t=include("springroll.ApplicationPlugin"),e=include("createjs.Tween",!1),i=include("createjs.Ticker",!1);new t(120).setup=function(){var t=this.options;t.add("raf",!0,!0),t.add("fps",60,!0),t.add("useQueryString",!1,!0),t.add("canvasId",null,!0),t.add("display",null,!0),t.add("displayOptions",null,!0);var n=this;t.add("updateTween",!0,!0).on("updateTween",(function(t){e&&(i&&i.setPaused(!!t),n.off("update",e.tick),t&&n.on("update",e.tick))})),t.add("name","",!0)}}(),function(t,e,i){var n=function(t,n){this._onFocus=t,this._onBlur=n,this._enabled=!1,(r||e.onfocusin!==i)&&(this._onToggle=function(){e.hidden||e.webkitHidden||e.msHidden||e.mozHidden?this._onBlur():this._onFocus()}.bind(this),this.enabled=!0)},s=extend(n),r=null;e.hidden!==i?r="visibilitychange":e.mozHidden!==i?r="mozvisibilitychange":e.msHidden!==i?r="msvisibilitychange":e.webkitHidden!==i&&(r="webkitvisibilitychange");var o=!r&&e.onfocusin!==i;Object.defineProperty(s,"enabled",{get:function(){return this._enabled},set:function(i){i=!!i,this._enabled!=i&&(this._enabled=i,t.removeEventListener("pagehide",this._onBlur),t.removeEventListener("pageshow",this._onFocus),t.removeEventListener("blur",this._onBlur),t.removeEventListener("focus",this._onFocus),t.removeEventListener("visibilitychange",this._onToggle),e.removeEventListener(r,this._onToggle,!1),o&&(e.removeEventListener("focusin",this._onFocus),e.removeEventListener("focusout",this._onBlur)),i&&(e.addEventListener(r,this._onToggle,!1),t.addEventListener("pagehide",this._onBlur),t.addEventListener("pageshow",this._onFocus),t.addEventListener("blur",this._onBlur),t.addEventListener("focus",this._onFocus),t.addEventListener("visibilitychange",this._onToggle,!1),o&&(e.addEventListener("focusin",this._onFocus),e.addEventListener("focusout",this._onBlur))))}}),s.destroy=function(){r&&this._onToggle&&(this.enabled=!1,this._onToggle=null,this._onFocus=null,this._onBlur=null)},namespace("springroll").PageVisibility=n}(window,document),function(){var t=new(include("springroll.ApplicationPlugin"));t.setup=function(){var t=include("springroll.PageVisibility"),n=this._visibility=new t(i.bind(this),e.bind(this));this.options.add("autoPause",!0).on("autoPause",(function(t){n.enabled=t})).respond("autoPause",(function(){return n.enabled})),Object.defineProperty(this,"autoPaused",{set:function(t){this.paused||this.internalPaused(t)}})};var e=function(){this.autoPaused=!0},i=function(){this.autoPaused=!1};t.teardown=function(){this._visibility&&this._visibility.destroy(),this._visibility=null}}(),function(){var t=function(){this._filters=[]},e=extend(t);e.add=function(t,e){if(!t||"string"!=typeof t&&t instanceof RegExp==0)throw"invalide replace value";if("string"!=typeof e)throw"invalid replacement value";if(this._filters){for(var i=this._filters.length-1;i>=0;i--)if(t.toString()==this._filters[i].replace.toString())throw"Filter already exists.";this._filters.push({replace:t,replacement:e})}},e.filter=function(t){if(!this._filters)return t;for(var e=this._filters.length-1;e>=0;e--){var i=this._filters[e].replace,n=this._filters[e].replacement;t=t.replace(i,n)}return t},e.destroy=function(){this._filters=null},namespace("springroll").StringFilters=t}(),function(){var t=new(include("springroll.ApplicationPlugin"))(110);t.setup=function(){var t=include("springroll.StringFilters");this.filters=new t},t.teardown=function(){this.filters&&this.filters.destroy(),this.filters=null}}(),function(){var t=include("springroll.ApplicationPlugin"),e=include("devicePixelRatio",!1),i=new t(100),n=null,s=0,r=0,o=0,a=0,h={width:0,height:0,normalWidth:0,normalHeight:0},l=null;i.setup=function(){var t=this.options;t.add("maxWidth",0),t.add("maxHeight",0),t.add("uniformResize",!0),t.add("responsive",!1,!0),t.add("resizeElement","frame",!0),t.add("enableHiDPI",!1),t.on("maxWidth",(function(t){s=t})),t.on("maxHeight",(function(t){r=t})),this.once("displayAdded",(function(t){o=t.width,a=t.height,s||(s=o),r||(r=a)})),this.realWidth=0,this.realHeight=0,this.triggerResize=function(){if(n){h.width=0|(n.innerWidth||n.clientWidth),h.height=0|(n.innerHeight||n.clientHeight),this.calculateDisplaySize(h);var t=this.realWidth=h.width,i=this.realHeight=h.height,s=h.normalWidth,r=h.normalHeight,o=this.options.responsive,a=this.options.enableHiDPI;this.displays.forEach((function(n){o?(a&&e&&(n.canvas.style.width=t+"px",n.canvas.style.height=i+"px",t*=e,i*=e),n.resize(t,i)):(n.canvas.style.width=t+"px",n.canvas.style.height=i+"px",a&&e&&(s*=e,r*=e),n.resize(s,r))})),this.trigger("resize",o?t:s,o?i:r),this.displays.forEach((function(t){t.render(0,!0)}))}},this.onWindowResize=function(){this.triggerResize(),l=this.setTimeout(function(){this.triggerResize(),l=null}.bind(this),500)},this.calculateDisplaySize=function(t){if(a&&this.options.uniformResize){var e=s/a,i=o/r,n=o/a,h=t.width/t.height;i>h?t.height=t.width/i:h>e&&(t.width=t.height*e),h=t.width/t.height,t.normalWidth=o,t.normalHeight=a,h>n?t.normalWidth=a*h:n>h&&(t.normalHeight=o/h),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t.normalWidth=Math.ceil(t.normalWidth),t.normalHeight=Math.ceil(t.normalHeight)}},this.once("beforeInit",this.triggerResize)},i.preload=function(t){var e=this.options;e.asDOMElement("resizeElement"),e.resizeElement&&(n=e.resizeElement,this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize)),t()},i.teardown=function(){l&&(l.destroy(),l=null),n&&window.removeEventListener("resize",this.onWindowResize),n=null,h.width=h.height=h.normalWidth=h.normalHeight=o=a=r=s=0}}(),function(t){var e=function(t){this._app=t,this._versions={},this._filters=[],this._globalVersion=null,this._applySpecificVersion=this._applySpecificVersion.bind(this),this._applyGlobalVersion=this._applyGlobalVersion.bind(this),this.cacheBust=!1},i=extend(e);Object.defineProperty(i,"cacheBust",{get:function(){return!(!this._globalVersion||0!==this._globalVersion.indexOf("cb="))},set:function(t){if(t)this._globalVersion="cb="+Date.now(),this.unregisterURLFilter(this._applySpecificVersion),this.registerURLFilter(this._applyGlobalVersion);else{var e=this._app.options.version;this._globalVersion=e?"v="+e:null,this._globalVersion?(this.unregisterURLFilter(this._applySpecificVersion),this.registerURLFilter(this._applyGlobalVersion)):(this.unregisterURLFilter(this._applyGlobalVersion),this.registerURLFilter(this._applySpecificVersion))}}}),i.destroy=function(){this._app=null,this._versions=null,this._filters=null,this._applySpecificVersion=null,this._applyGlobalVersion=null},i.addVersionsFile=function(t,e,i){if(this.cacheBust)e&&e();else{this.addVersion(t,Date.now().toString()),t=this._applySpecificVersion(t);var n=this;this._app.load(t,(function(t){if(t){var s,r,o=t.replace(/\r/g,"").split("\n");for(s=0,len=o.length;s<len;s++)o[s]&&(2==(r=o[s].split(" ")).length&&n.addVersion((i||"")+r[0],r[1]))}e&&e()}))}},i.addVersion=function(t,e){this._versions[t]||(this._versions[t]=e)},i.registerURLFilter=function(t){-1==this._filters.indexOf(t)&&this._filters.push(t)},i.unregisterURLFilter=function(t){var e=this._filters.indexOf(t);e>-1&&this._filters.splice(e,1)},i._applySpecificVersion=function(t){var e=this._app.options.basePath;if(e&&e.indexOf("?")>0)return t;var i=this._versions[t];return i&&!1===/(\?|\&)v\=[0-9]*/.test(t)&&(t=t+(t.indexOf("?")<0?"?":"&")+"v="+i.version),t},i._applyGlobalVersion=function(t){if(!this._globalVersion)return t;var e=this._app.options.basePath;return e&&e.indexOf("?")>0||!1===(0===this._globalVersion.indexOf("cb=")?/(\?|\&)cb\=[0-9]*/:/(\?|\&)v\=/).test(t)&&(t=t+(t.indexOf("?")<0?"?":"&")+this._globalVersion),t},i._applyBasePath=function(t){var e=this._app.options.basePath;return e&&!1===/^http(s)?\:/.test(t)&&-1==t.search(e)&&(t=e+t),t},i.prepare=function(t,e){e&&(t=this._applyBasePath(t));for(var i=0,n=this._filters.length;n>i;++i)t=this._filters[i](t);return t},namespace("springroll").CacheManager=e}(),function(){var t,e=include("springroll.Application"),i=function(e,n){if(void 0===t&&(t=include("springroll.Debug",!1)),this.status=i.WAITING,this.complete=e.complete||null,this.cache=!!e.cache,this.id=e.id||null,this.type=e.type||null,this.original=e,this.cache&&!this.id){if(n&&"string"==typeof n){var s=n.lastIndexOf(".");s>-1&&(n=n.substr(0,s));var r=n.lastIndexOf("/");r>-1&&(n=n.substr(r+1)),e.id=this.id=n}this.id||(this.cache=!1)}},n=extend(i);i.WAITING=0,i.RUNNING=1,i.FINISHED=2,n.start=function(t){t()},n.filter=function(t){var i=e.instance.assetManager.sizes;if(t&&i.test(t)){var n=i.size(this.original.sizes);t=i.filter(t,n),this.original.scale=n.scale}return t},n.load=function(t,i){return e.instance.load(t,i)},n.simpleLoad=function(t,i,n,s){return e.instance.loader.load(t,i,n,s)},n.destroy=function(){this.status=i.FINISHED,this.id=null,this.type=null,this.complete=null,this.original=null},namespace("springroll").Task=i}(),function(){var t=include("springroll.Task"),e=function(e){t.call(this,e),this.async=e.async},i=t.extend(e);e.test=function(t){return!!t.async},i.start=function(t){this.async(t)},i.destroy=function(){t.prototype.destroy.call(this),this.async=null},namespace("springroll").FunctionTask=e}(),function(){var t=include("springroll.Task"),e=function(e){t.call(this,e,e.color),this.color=this.filter(e.color),this.alpha=this.filter(e.alpha)},i=t.extend(e);e.test=function(t){return!!t.color&&!!t.alpha},i.start=function(t){this.load({_alpha:this.alpha,_color:this.color},(function(i){t(e.mergeAlpha(i._color,i._alpha)),i._color.src=i._alpha.src=""}))},e.mergeAlpha=function(t,e,i){i||(i=document.createElement("canvas")),i.width=Math.max(e.width,t.width),i.height=Math.max(e.height,t.height);var n=i.getContext("2d");return n.save(),n.drawImage(t,0,0),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),n.restore(),i},namespace("springroll").ColorAlphaTask=e}(),function(){var t=include("springroll.Task"),e=function(e){t.call(this,e),this.assets=e.assets,this.cacheAll=e.cacheAll,this.progress=e.progress},i=t.extend(e);e.test=function(t){return!!t.assets&&(Array.isArray(t.assets)||Object.isPlain(t.assets))},i.start=function(t){this.load(this.assets,{complete:t,progress:this.progress,cacheAll:this.cacheAll})},i.destroy=function(){t.prototype.destroy.call(this),this.assets=null},namespace("springroll").ListTask=e}(),function(){var t=include("springroll.Task"),e=function(e){t.call(this,e,e.src),this.src=this.filter(e.src),this.progress=e.progress||null,this.data=e.data||null,this.advanced=!!e.advanced},i=t.extend(e);e.test=function(t){return!!t.src},i.start=function(t){var e=this.advanced;this.simpleLoad(this.src,(function(i){var n=i;n&&!e&&(n=i.content,i.destroy()),t(n)}),this.progress,this.data)},i.destroy=function(){t.prototype.destroy.call(this),this.data=null,this.progress=null},namespace("springroll").LoadTask=e}(),function(t){var e,i=include("createjs.LoadQueue"),n=include("createjs.Sound",!1),s=function(){i.call(this,!0),void 0===e&&(e=include("springroll.Debug",!1)),this.retries=0,this.url=null,this.preparedUrl=null,this.data=null,this.onComplete=null,this.onProgress=null,this._onFailed=this._onFailed.bind(this),this._onProgress=this._onProgress.bind(this),this._onCompleted=this._onCompleted.bind(this),n&&this.installPlugin(n)},r=extend(s,i);s.MAX_RETRIES=3,r.toString=function(){return"[LoaderItem(url:'"+this.url+"')]"},Object.defineProperty(r,"basePath",{set:function(t){this._basePath=t}}),Object.defineProperty(r,"crossOrigin",{set:function(t){this._crossOrigin=t}}),r.clear=function(){this.basePath="",this.crossOrigin=!1,this.retries=0,this.onComplete=null,this.onProgress=null,this.data=null,this.preparedUrl=null,this.url=null,this.removeAllEventListeners(),this.removeAll(),this.close()},r.start=function(t){this.addEventListener("fileload",this._onCompleted),this.addEventListener("error",this._onFailed),this.addEventListener("fileprogress",this._onProgress),this._internalStart()},r._internalStart=function(){var t=this.preparedUrl;this.data&&this.data.id&&(t={id:this.data.id,src:t,data:this.data}),this.loadFile(t)},r._onProgress=function(t){this.onProgress&&this.onProgress(this.progress)},r._onFailed=function(t){this.retry()},r.retry=function(){this.retries++,this.retries>s.MAX_RETRIES?this.onComplete(this,null):this._internalStart()},r._onCompleted=function(t){this.onComplete(this,t.result)},namespace("springroll").LoaderItem=s}(),function(){var t=function(t,e,i){this.content=t,this.url=e,this.data=i,this.id=null},e=extend(t);e.toString=function(){return"[LoaderResult(url: '"+this.url+"')]"},e.reset=function(){this.content=this.url=this.data=this.id=null},e.destroy=function(){this.reset()},namespace("springroll").LoaderResult=t}(),function(t){var e=include("springroll.LoaderItem"),i=include("springroll.CacheManager"),n=include("springroll.LoaderResult"),s=function(t){this.app=t,this.maxCurrentLoads=2,this.cacheManager=new i(t),this.items={},this.itemPool=[]},r=extend(s);r.destroy=function(){this.itemPool&&this.itemPool.forEach((function(t){t.clear()})),this.itemPool=null,this.cacheManager&&this.cacheManager.destroy(),this.cacheManager=null,this.items=null},r.load=function(t,e,i,n){var s=this.app.options,r=this._getItem(),o=s.basePath;return void 0!==o&&!1===/^http(s)?\:/.test(t)&&-1==t.search(o)&&(r.basePath=o),r.crossOrigin=s.crossOrigin,r.url=t,r.preparedUrl=this.cacheManager.prepare(t),r.onComplete=this._onComplete.bind(this,e),r.onProgress=i||null,r.data=n||null,r.setMaxConnections(this.maxCurrentLoads),this.items[t]=r,r.start(),r},r._onComplete=function(t,e,i){i&&(i=new n(i,e.url,e.data)),t(i),this._putItem(e)},r.cancel=function(t){var e=this.items[t];return!!e&&(e.clear(),this._putItem(e),!0)},r._getItem=function(){var t=this.itemPool;return t.length?t.pop():new e},r._putItem=function(t){delete this.items[t.url],t.clear(),this.itemPool.push(t)},namespace("springroll").Loader=s}(),function(t){function e(t){t&&(t.destroy&&t.destroy(),"IMG"==t.tagName&&(t.src=""))}var i,n=function(){void 0===i&&(i=include("springroll.Debug",!1)),this._cache={}},s=extend(n);s.read=function(t){return this._cache[t]||null},s.write=function(t,e){this._cache[t]&&this.delete(t),this._cache[t]=e},s.delete=function(t){var i="string"==typeof t?t:t.id;if(i){var n=this._cache[i];if(n){if(Object.isPlain(n))for(var s in n)e(n[s]);else Array.isArray(n)?n.forEach(e):e(n);delete this._cache[i]}}},s.empty=function(){for(var t in this._cache)this.delete(t)},s.destroy=function(){this.empty(),this._cache=null},namespace("springroll").AssetCache=n}(),function(){var t,e=include("devicePixelRatio",!1)||1,i=function(){void 0===t&&(t=include("springroll.Debug",!1)),this._sizes=[],this._sizesMap={},this._preferredSize=null},n=extend(i);i.SIZE_TOKEN="%SIZE%",n.reset=function(){this._sizes.length=0,this._sizesMap={}},n.define=function(t,e,i,n){var s={id:t,maxSize:e,scale:i,fallback:n};this._sizesMap[t]=s,this._sizes.push(s),this._sizes.sort((function(t,e){return t.maxSize-e.maxSize}))},n.filter=function(t,e){return e=e||this._preferredSize,t.replace(i.SIZE_TOKEN,e.id)},n.test=function(t){return t.indexOf(i.SIZE_TOKEN)>-1},n.size=function(t){var e=this._preferredSize,i=e.fallback;if(t&&!t[e.id])for(var n=0,s=i.length;s>n;n++){var r=i[n];if(!1!==t[r]){e=this._sizesMap[r];break}}if(!e)throw"Asset does not support any valid size";return e},n.refresh=function(t,i){for(var n=Math.min(t,i),s=null,r=this._sizes,o=r.length-1;o>=0&&r[o].maxSize/e>n;--o)s=r[o];this._preferredSize=s},n.destroy=function(){this._preferredSize=null,this._sizes=null,this._sizesMap=null},namespace("springroll").AssetSizes=i}(),function(t){function e(t){return function(t){return"string"==typeof t}(t)?{src:t}:function(t){return"function"==typeof t}(t)?{async:t}:t}var i=include("springroll.Task"),n=include("springroll.EventDispatcher"),s=function(t){n.call(this),this.manager=t,this.mode=o,this.startAll=!0,this.cacheAll=!1,this.tasks=[],this.results=null,this.running=!1,this.numLoaded=0,this.total=0,this.type=null},r=n.extend(s);r.setup=function(t,e){this.startAll=e.startAll,this.cacheAll=e.cacheAll,this.type=e.type,this.mode=this.addTasks(t),this.results=a(this.mode),e.autoStart&&this.start()},r.start=function(){this.trigger("progress",0),this.running=!0,this.nextTask()},r.reset=function(){this.tasks.forEach((function(t){t.status=i.FINISHED,t.destroy()})),this.total=0,this.numLoaded=0,this.mode=o,this.tasks.length=0,this.results=null,this.type=null,this.startAll=!0,this.cacheAll=!1,this.running=!1};var o=1;r.addTasks=function(i){var n,s,r=o;if((i=e(i)).type===t&&this.type&&(i.type=this.type),this.getTaskByAsset(i))return this.addTask(i),0;if(i.type===this.type&&this.type&&delete i.type,Array.isArray(i))for(var a=0;a<i.length;a++)n=e(i[a]),(s=this.addTask(n)).id||(r=2);else if(Object.isPlain(i))for(var h in i)n=e(i[h]),(s=this.addTask(n)).id||(s.id=h);return r},r.addTask=function(e){e.type===t&&this.type&&(e.type=this.type);var i,n=this.getTaskByAsset(e);return n&&(e.cache===t&&this.cacheAll&&(e.cache=!0),i=new n(e),this.tasks.push(i),++this.total),i},r.getTaskByAsset=function(t){for(var e,i=this.manager.taskDefs,n=0,s=i.length;s>n;n++)if((e=i[n]).test(t))return e;return null},r.nextTask=function(){for(var t=this.tasks,e=0;e<t.length;e++){var n=t[e];if(n.status===i.WAITING&&(n.status=i.RUNNING,n.start(this.taskDone.bind(this,n)),!this.startAll))return}},r.taskDone=function(t,e){if(this.running){e=e||null;var i=this.tasks.indexOf(t);if(-1!==i){this.tasks.splice(i,1);var n=[];if(e){switch(this.mode){case 0:this.results=e;break;case 2:this.results.push(e);break;case o:this.results[t.id]=e}t.cache&&this.manager.cache.write(t.id,e)}t.complete&&t.complete(e,t.original,n),this.trigger("taskDone",e,t.original,n),t.destroy();var s=this.addTasks(n);if(this.trigger("progress",++this.numLoaded/this.total),this.mode===o&&s!==this.mode)throw"Assets require IDs";this.tasks.length?this.nextTask():this.trigger("complete",this.results)}}};var a=function(t){switch(t){case 0:return null;case 2:return[];case o:return{}}};r.destroy=function(){n.prototype.destroy.call(this),this.reset(),this.tasks=null,this.manager=null},namespace("springroll").AssetLoad=s}(),function(t){var e=include("springroll.AssetLoad"),i=include("springroll.AssetCache"),n=include("springroll.AssetSizes"),s=(include("springroll.Task"),function(){this.loads=[],this.loadPool=[],this.taskDefs=[],this.cache=new i,this.sizes=new n,this.defaultType=null,this.sizes.define("half",400,.5,["full"]),this.sizes.define("full",1e4,1,["half"])}),r=extend(s);r.register=function(t,e){"string"==typeof t&&(t=include(t,!1)),t&&(t.priority=e||0,this.taskDefs.push(t),this.taskDefs.sort((function(t,e){return e.priority-t.priority})))},r.load=function(t,e){e=Object.merge({complete:null,progress:null,taskDone:null,cacheAll:!1,startAll:!0,autoStart:!0,type:this.defaultType},e);var i=this.getLoad();return this.loads.push(i),e.complete=this._onLoaded.bind(this,e.complete,i),i.once("complete",e.complete),e.progress&&i.on("progress",e.progress),e.taskDone&&i.on("taskDone",e.taskDone),i.setup(t,e),i},r.poolLoad=function(t){t.off("complete progress taskDone"),t.reset(),this.loadPool.push(t)},r.getLoad=function(){return this.loadPool.length>0?this.loadPool.pop():new e(this)},r._onLoaded=function(t,e,i){var n=this.loads.indexOf(e);n>-1&&this.loads.splice(n,1),t&&t(i),this.poolLoad(e)},r.destroy=function(){this.sizes.destroy(),this.sizes=null,this.cache.destroy(),this.cache=null,this.loadPool=null,this.loads=null,this.taskDefs=null},namespace("springroll").AssetManager=s}(),function(){var t=include("springroll.ApplicationPlugin"),e=include("springroll.Loader"),i=include("springroll.AssetManager"),n=new t(100);n.setup=function(){var t=this.loader=new e(this),n=this.assetManager=new i;n.register("springroll.LoadTask"),n.register("springroll.ListTask"),n.register("springroll.FunctionTask",10),n.register("springroll.ColorAlphaTask",20);var s=this.options;s.add("cacheBust",!1).respond("cacheBust",(function(){return t.cacheManager.cacheBust})).on("cacheBust",(function(e){t.cacheManager.cacheBust="true"==e||!!e})),s.add("basePath"),s.add("version",null,!0),s.add("versionsFile",null,!0),s.add("defaultAssetType").on("defaultAssetType",(function(t){n.defaultType=t})),this.load=function(t,e,i,s,r){var o;return"string"==typeof t?t={src:t,progress:i||null,complete:e||null,cache:!!s,data:r||null}:(o=e,"function"==typeof e&&(o={complete:e})),n.load(t,o)},this.unload=function(t){"string"==typeof t&&(t=Array.prototype.slice.call(arguments));for(var e=0;e<t.length;e++)n.cache.delete(t[e])},this.unloadAll=function(){n.cache.empty()},this.getCache=function(t){return n.cache.read(t)},this.on("resize",(function(){n.sizes.refresh(this.realWidth,this.realHeight)})),this.once("beforeInit",(function(){this.display&&n.sizes.refresh(this.realWidth,this.realHeight)}))},n.preload=function(t){this.triggerResize();var e=this.options.versionsFile;e?this.loader.cacheManager.addVersionsFile(e,t):t()},n.teardown=function(){this.loader&&(this.loader.destroy(),this.loader=null),this.assetManager&&(this.assetManager.destroy(),this.assetManager=null)}}(),function(){var t=new(include("springroll.ApplicationPlugin"))(80);t.setup=function(){include("springroll.Debug",!1);var t=this.options;t.add("configPath",null,!0),t.add("preload",[],!0),this.config=null,this._assetLoad=null,this._numLoaded=0,this._total=0,this._progress=-1,this.on("pluginProgress",e.bind(this))},t.preload=function(t){var r=[],o=this.options.configPath;o?r.push({id:"config",src:o,cache:!1,complete:n.bind(this)}):i(this,r);var a=s.bind(this,t);r.length?this._assetLoad=this.load(r,{complete:a,progress:e.bind(this),cacheAll:!0}):a()};var e=function(){this._assetLoad&&(this._numLoaded=this._assetLoad.numLoaded,this._total=this._assetLoad.total);var t=(this._numLoaded+this.pluginLoad.numLoaded)/(this._total+this.pluginLoad.total);t>this._progress&&(this._progress=t,this.trigger("progress",t))},i=function(t,e){e.append(t.options.preload),t.trigger("loading",e)},n=function(t,e,n){this.config=t,this.trigger("configLoaded",t,n),i(this,n)},s=function(t,e){this._assetLoad=null,this.trigger("loaded",e),t()};t.teardown=function(){this.config=null}}(),function(t){var e=include("springroll.EventDispatcher"),i=function(t,i){e.call(this),i=i||{},this.canvas=document.getElementById(t),this.id=t,this.width=this.canvas.width,this.height=this.canvas.height,this.stage=null,this.paused=!1,this._enabled=!1,this._visible="none"!=this.canvas.style.display,this.adapter=null},n=e.extend(i);Object.defineProperty(n,"enabled",{get:function(){return this._enabled},set:function(t){var e=this._enabled;this._enabled=t,e!=t&&(this.trigger(t?"enabled":"disabled"),this.trigger("enable",t))}}),Object.defineProperty(n,"visible",{get:function(){return this._visible},set:function(t){var e=this._visible;this._visible=t,this.canvas.style.display=t?"block":"none",e!=t&&(this.trigger(t?"visible":"hidden"),this.trigger("visibility",t))}}),n.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},n.render=function(t,e){},n.destroy=function(){this.enabled=!1,this.adapter=null,this.stage=null,this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.canvas.onmousedown=null,this.canvas=null},namespace("springroll").AbstractDisplay=i}(),function(){var t=include("springroll.Application"),e=include("springroll.Loader"),i=include("springroll.PropertyDispatcher"),n=include("springroll.EventDispatcher");t.prototype.getDisplays=function(t){return"function"==typeof t&&_displays.forEach(t),_displays},n.mixIn=function(t,e){return mixin(t,n)},Object.defineProperty(e,"instance",{get:function(){return t.instance.loader}}),i.prototype.readOnly=function(t){for(var e,i,n=0;n<arguments.length;n++){if(i=arguments[n],void 0===(e=this._properties[i]))throw"Property "+i+" does not exist";e.readOnly=!0}return this}}()}(),function(){"use strict";var t,e,i;t=include("springroll.SavedData"),e=function(t){this.container=t,this.id=""},(i=extend(e)).read=function(e,i){return this.container.supported?void this.container.fetch("userDataRead",(function(t){i(t.data)}),this.id+e,!0):i(t.read(this.id+e))},i.write=function(e,i,n){return this.container.supported?void this.container.fetch("userDataWrite",(function(t){n&&n()}),{name:this.id+e,value:i},!0):(t.write(this.id+e,i),void(n&&n()))},i.remove=function(e,i){return this.container.supported?void this.container.fetch("userDataRemove",(function(t){i&&i()}),this.id+e,!0):(t.remove(this.id+e),void(i&&i()))},i.destroy=function(){this.id=null,this.container=null},namespace("springroll").UserData=e,function(t){var e=include("springroll.ApplicationPlugin"),i=include("springroll.PageVisibility"),n=include("springroll.UserData"),s=include("Bellhop"),r=new e(200);r.setup=function(){var t=this.options,e=this.container=new s;e.connect(),this.userData=new n(e),t.add("keepFocus",!1).on("keepFocus",(function(t){e.send("keepFocus",t)})),this.once("beforeInit",(function(){e.send("loaded")})),e.send("loading"),this.singlePlay=!1,this.playOptions={},this.singlePlayEnd=function(){return!!this.singlePlay&&(this.endGame(),!0)},this.endGame=function(t){this.trigger("endGame",t||"game_completed"),this.destroy()},this.once("beforeInit",(function(){var t=!!this.sound;this.container.send("features",{sound:t,hints:!!this.hints,music:t&&this.sound.contextExists("music"),vo:t&&this.sound.contextExists("vo"),sfx:t&&this.sound.contextExists("sfx"),captions:!!this.captions})})),e.supported&&(e.fetch("singlePlay",f.bind(this)),e.fetch("playOptions",p.bind(this))),window.onerror=a.bind(this),window.onunload=window.onbeforeunload=o.bind(this)};var o=function(){return window.onunload=window.onbeforeunload=null,void this.endGame("left_site")},a=function(t){return this.container.supported?(this.container.send("localError",String(t)),!0):void 0};r.preload=function(t){if(!this.name)throw"Application name is empty";if(this.userData.id=this.name,this.container.supported){this.container.on({soundMuted:l.bind(this),captionsMuted:u.bind(this),musicMuted:c.bind(this,"music"),voMuted:c.bind(this,"vo"),sfxMuted:c.bind(this,"sfx"),captionsStyles:d.bind(this),pause:h.bind(this),close:g.bind(this)}),this.options.autoPause=!1;var e=this.container;this._pageVisibility=new i(e.send.bind(e,"focus",!0),e.send.bind(e,"focus",!1))}t()};var h=function(t){var e=!!t.data;this.autoPaused=e,this.enabled=!e},l=function(t){this.sound&&(this.sound.muteAll=!!t.data)},u=function(t){this.captions&&(this.captions.mute=!!t.data)},c=function(t,e){this.sound&&this.sound.setContextMute(t,!!e.data)},d=function(t){var e=t.data,i=(this.captions||{}).textField||null;i&&i.nodeName&&(i.className="size-"+e.size+" bg-"+e.background+" color-"+e.color+" edge-"+e.edge+" font-"+e.font+" align-"+e.align)},p=function(t){Object.merge(this.playOptions,t.data||{})},f=function(t){this.singlePlay=!!t.data},g=function(){this.endGame("closed_container")};r.teardown=function(){window.onerror=null,this._pageVisibility&&(this._pageVisibility.destroy(),this._pageVisibility=null),this.userData&&(this.userData.destroy(),this.userData=null),this.container&&(this.container.send("endGame"),this.container.destroy(),this.container=null)}}()}(),function(){"use strict";var t;!function(t){var e,i=include("springroll.EventDispatcher"),n=function(t,n){i.call(this),e||(e=include("springroll.Application"),include("springroll.Debug",!1)),n=Object.merge({next:null,previous:null,delayLoad:0,preload:[],scaling:null},n||{});var s=this.app=e.instance;this.voPlayer=s.voPlayer||null,this.sound=s.sound||null,this.config=s.config||null,this.scaling=s.scaling||null,this.scalingItems=n.scaling||null,this.stateId=null,this.manager=null,this.panel=t,this.preload=n.preload,this.preloaded=!1,this.assets=null,this._destroyed=!1,this._active=!1,this._isLoading=!1,this._canceled=!1,this._onEnterProceed=null,this._onLoadingComplete=null,this._enabled=!1,this._nextState=n.next,this._prevState=n.previous,this.delayLoad=n.delayLoad,this.panel.visible=!1},s=i.prototype,r=i.extend(n),o=function(){};r.exit=o,r.exitStart=o,r.cancel=o,r.enter=o,r.enterDone=o,r.nextState=function(){var t=typeof this._nextState;this._nextState&&("function"===t?this._nextState():"string"===t&&(this.manager.state=this._nextState))},r.previousState=function(){var t=typeof this._prevState;this._prevState&&("function"===t?this._prevState():"string"===t&&(this.manager.state=this._prevState))},r.loadingStart=function(){this._isLoading||(this._isLoading=!0,this.manager.loadingStart(),this._onLoadingComplete=this._onEnterProceed,this._onEnterProceed=null)},r.loadingDone=function(t){if(void 0===t&&(t=this.delayLoad),this._isLoading){if(t&&"number"==typeof t)return this.panel.visible=!0,void this.app.setTimeout(this.loadingDone.bind(this,0),t,!0);this._isLoading=!1,this.manager.loadingDone(),this._onLoadingComplete&&(this._onLoadingComplete(),this._onLoadingComplete=null)}},Object.defineProperty(r,"canceled",{get:function(){return this._canceled}}),Object.defineProperty(r,"active",{get:function(){return this._active}}),Object.defineProperty(r,"enabled",{get:function(){return this._enabled},set:function(t){var e=this._enabled;this._enabled=t,e!=t&&this.trigger("enabled",t)}}),Object.defineProperty(r,"destroyed",{get:function(){return this._destroyed}}),r._internalExit=function(){this.preloaded=!1;var t=this.panel,e=this.scalingItems,i=this.scaling;i&&e&&("panel"==e?i.removeItem(t):i.removeItems(t,e)),this.preload.length&&this.app.unload(this.preload),this._isTransitioning&&(this._isTransitioning=!1,this.manager.animator&&this.manager.animator.stop(t)),this._enabled=!1,t.visible=!1,this._active=!1,this.exit(),this.trigger("exit")},r._internalEntering=function(){this.enter(),this.trigger("enter"),this.loadingStart(),this.preloaded=!1;var t=[];this.trigger("loading",t),this.preload.length&&(t=this.preload.concat(t)),t.length?this.app.load(t,{complete:this._onLoaded.bind(this),progress:a.bind(this),cacheAll:!0}):this._onLoaded(null)};var a=function(t){this.trigger("progress",t),this.manager.trigger("progress",t)};r._onLoaded=function(t){if(this.assets=t,this.preloaded=!0,this.trigger("loaded",t),this.scaling){var e=this.scalingItems;e&&("panel"==e?(this.panel.x=this.panel.y=0,this.panel.scaleX=this.panel.scaleY=1,this.scaling.addItem(this.panel,{align:"top-left",titleSafe:!0})):this.scaling.addItems(this.panel,e))}this.loadingDone()},r._internalExitStart=function(){this.exitStart(),this.trigger("exitStart")},r._internalEnter=function(t){this._isTransitioning&&(this._isTransitioning=!1,this.manager.animator&&this.manager.animator.stop(this.panel)),this._enabled=!1,this._active=!0,this._canceled=!1,this._onEnterProceed=t,this._internalEntering(),this._onEnterProceed&&(this._onEnterProceed(),this._onEnterProceed=null)},r._internalCancel=function(){this._active=!1,this._canceled=!0,this._isLoading=!1,this._internalExit(),this.cancel(),this.trigger("cancel")},r._internalEnterDone=function(){this._canceled||(this.enabled=!0,this.enterDone(),this.trigger("enterDone"))},r.destroy=function(){this._destroyed||(this.trigger("destroy"),this.app=null,this.scaling=null,this.sound=null,this.voPlayer=null,this.config=null,this.scalingItems=null,this.assets=null,this.preload=null,this.panel=null,this.manager=null,this._destroyed=!0,this._onEnterProceed=null,this._onLoadingComplete=null,s.destroy.call(this))},namespace("springroll").State=n}(),t=function(t,e,i){this.currentState=e,this.visibleState=void 0===i?e:i,this.type=t},extend(t),t.VISIBLE="onVisible",t.HIDDEN="onHidden",namespace("springroll").StateEvent=t,function(t){var e=(include("springroll.Debug",!1),include("springroll.EventDispatcher")),i=(include("springroll.State"),include("springroll.StateEvent")),n=function(t){e.call(this),this.animator=null,this.transition=null,this.waitForLoadingComplete=!1,this._transitionSounds=t||null,this._states={},this._state=null,this._stateId=null,this._oldState=null,this._isLoading=!1,this._isTransitioning=!1,this._destroyed=!1,this.enabled=!0,this._onTransitionLoading=this._onTransitionLoading.bind(this),this._onTransitionOut=this._onTransitionOut.bind(this),this._onStateLoaded=this._onStateLoaded.bind(this),this._onTransitionIn=this._onTransitionIn.bind(this)},s=e.extend(n),r=n.TRANSITION_IN="onTransitionIn",o=n.TRANSITION_LOADING="onTransitionLoading",a=n.TRANSITION_IN_DONE="onTransitionInDone",h=n.TRANSITION_OUT="onTransitionOut",l=n.TRANSITION_OUT_DONE="onTransitionOutDone",u=n.TRANSITION_INIT_DONE="onInitDone",c=n.LOADING_START="onLoadingStart",d=n.LOADING_DONE="onLoadingDone";s.addState=function(t,e){this._states[t]=e,e.stateId=t,e.manager=this},Object.defineProperty(s,"currentState",{get:function(){return this._state}}),s.getStateById=function(t){return this._states[t]},s.isBusy=function(){return this._isLoading||this._isTransitioning},s.loadingStart=function(){this._destroyed||(this.trigger(c),this._onTransitionLoading())},s.loadingDone=function(){this._destroyed||this.trigger(d)},Object.defineProperty(s,"enabled",{set:function(t){this.trigger("enabled",t)}}),s.refresh=function(){this.state=this._stateId},Object.defineProperty(s,"state",{set:function(t){this._isTransitioning||(this._stateId=t,this.enabled=!1,this._oldState=this._state,this._state=this._states[t],this._oldState?this._isLoading?(this._oldState._internalCancel(),this._isLoading=!1,this._state._internalEnter(this._onStateLoaded)):(this._isTransitioning=!0,this._oldState._internalExitStart(),this.enabled=!1,this.trigger(h),this._transitioning(h,this._onTransitionOut)):(this._isTransitioning=!0,this.transition&&(this.transition.visible=!0),this._onTransitionLoading(),this.trigger(u),this._isLoading=!0,this._state._internalEnter(this._onStateLoaded)))},get:function(){return this._stateId}}),s._onTransitionOut=function(){this.trigger(l),this._isTransitioning=!1,this.has(i.HIDDEN)&&this.trigger(i.HIDDEN,new i(i.HIDDEN,this._state,this._oldState)),this._oldState.panel.visible=!1,this._oldState._internalExit(),this._oldState=null,this._onTransitionLoading(),this._isLoading=!0,this._state._internalEnter(this._onStateLoaded)},s._onStateLoaded=function(){if(this._isLoading=!1,this._isTransitioning=!0,this.has(i.VISIBLE)&&this.trigger(i.VISIBLE,new i(i.VISIBLE,this._state)),this._state.panel.visible=!0,this.waitForLoadingComplete&&this.animator.hasAnimation(this.transition,o)){var t=this.animator.getTimeline(this.transition);t.onComplete=function(){this.trigger(r),this._transitioning(r,this._onTransitionIn)}.bind(this),t.isLooping=!1}else this.trigger(r),this._transitioning(r,this._onTransitionIn)},s._onTransitionIn=function(){this.transition&&(this.transition.visible=!1),this.trigger(a),this._isTransitioning=!1,this.enabled=!0,this._state._internalEnterDone()},s._onTransitionLoading=function(){if(this.transition){var t,e=this._transitionSounds;e&&(t=e.loading||e.loop);var i=this.animator;i.hasAnimation(this.transition,o)?(this.trigger(o),i.play(this.transition,{anim:o,audio:t})):i.hasAnimation(this.transition,"transitionLoop")&&(this.trigger(o),i.play(this.transition,{anim:"transitionLoop",audio:t}))}},s.showTransitionOut=function(t){this.enabled=!1,this._transitioning(h,function(){this._onTransitionLoading(),t&&t()}.bind(this))},s.showTransitionIn=function(t){this._transitioning(r,function(){this.enabled=!0,this.transition.visible=!1,t&&t()}.bind(this))},s._transitioning=function(t,e){var i,n=this.transition,s=this._transitionSounds;if(!n)return e();n.visible=!0,s&&(i=t==r?s.in:s.out),this.animator.play(n,{anim:t,audio:i},e)},s.destroy=function(){if(this._destroyed=!0,this.off(),this.transition&&this.animator.stop(this.transition),this._state&&this._state._internalExit(),this._states)for(var t in this._states)this._states[t].destroy(),delete this._states[t];this.transition=null,this._state=null,this._oldState=null,this._states=null},namespace("springroll").StateManager=n}(),function(){var t=include("springroll.ApplicationPlugin"),e=include("springroll.StateManager"),i=(include("springroll.Debug",!1),new t);i.setup=function(){this._states=null,this.manager=null,this._transition=null,Object.defineProperty(this,"transition",{set:function(t){if(!this.display)throw"No default display";if(t&&!this.animator)throw"No animation module";var e=this.display.stage;this._transition&&e.removeChild(this._transition),this._transition=t,this.manager&&(this.manager.transition=t),t&&(t.stop&&t.stop(),e.addChild(t))},get:function(){return this._transition}}),this.options.add("state",null,!0),this.options.add("transition"),this.options.add("transitionSounds",{in:null,out:null},!0),Object.defineProperty(this,"states",{set:function(t){if(this.manager)throw"States already set";if(!this.display)throw"No default display";var i=this.manager=new e(this.options.transitionSounds);i.animator=this.animator,i.on("enabled",function(t){this.display.enabled=t}.bind(this));var n=this.display.stage;for(var s in t)i.addState(s,t[s]),n.addChild(t[s].panel),this.trigger("stateAdded",s,t[s]);this._states=t;var r=this._transition||this.options.transition;r&&(this.transition=r,r.gotoAndStop&&r.gotoAndStop("onTransitionOut_stop")),this.options.state&&(i.state=this.options.state)},get:function(){return this._states}})},i.teardown=function(){this._state=null,this.manager&&(this.manager.destroy(),this.manager=null),this.transition&&(this.display&&this.display.adapter.removeChildren(this.transition),this.transition=null)}}(),function(){var t=include("springroll.StateManager").prototype;t.changeTransition=function(t){this.transition=t},t.getCurrentState=function(){return this.currentState},t.setState=function(t){this.state=t},t.next=function(){this._state.nextState()},t.previous=function(){this._state.previousState()},Object.defineProperty(include("springroll"),"BaseState",{get:function(){return include("springroll.State")}})}()}(),function(){"use strict";var t,e,i;namespace("springroll").SoundContext=function(t){this.id=t,this.volume=1,this.muted=!1,this.sounds=[],this.subContexts=[]},e=function(){t||(t=include("springroll.Sound")),this._channel=null,this._endFunc=null,this._endCallback=null,this._startFunc=null,this._startParams=null,this.alias=null,this._fTime=0,this._fDur=0,this._fStart=0,this._fEnd=0,this.curVol=0,this._pan=0,this.length=0,this.paused=!1,this.globallyPaused=!1,this.isValid=!0},i=extend(e),Object.defineProperty(i,"position",{get:function(){return this._channel?this._channel.getPosition():0}}),i.stop=function(){var e=t.instance;if(e){var i=e._sounds[this.alias];if(!i)return;var n=i.playing.indexOf(this);n>-1&&i.playing.splice(n,1),(n=i.waitingToPlay.indexOf(this))>-1&&i.waitingToPlay.splice(n,1),e._stopInst(this)}},i.updateVolume=function(e){if(this._channel){if(void 0===e){var i=t.instance,n=i._sounds[this.alias];if(n.context){var s=i._contexts[n.context];e=s.muted?0:s.volume}else e=1}this._channel.setVolume(e*this.curVol)}},Object.defineProperty(i,"volume",{get:function(){return this.curVol},set:function(t){this.curVol=t,this.updateVolume()}}),Object.defineProperty(i,"pan",{get:function(){return this._pan},set:function(t){this._pan=t,this._channel&&(this._channel.pan=t)}}),i.pause=function(){this.globallyPaused=!1,this.paused||(this.paused=!0,this._channel&&(this._channel.pause(),t.instance._onInstancePaused()))},i.resume=function(){this.paused&&(this.paused=!1,this._channel&&(t.instance._onInstanceResume(),this._channel.resume(),this._channel.gainNode&&(this._channel._volume=-1,this._channel.gainNode.gain.value=0),this.updateVolume()))},namespace("springroll").SoundInstance=e,function(){var t=include("springroll.Task"),e=include("springroll.Application"),i=function(e){t.call(this,e,e.sounds[0]),this.sounds=e.sounds},n=t.prototype,s=t.extend(i);i.test=function(t){return!!t.sounds&&Array.isArray(t.sounds)},s.start=function(t){var i=e.instance.sound,n=this.sounds;i.preload(n,(function(){n.destroy=function(){i.unload(this),this.length=0,delete this.destroy},t(n)}))},s.destroy=function(){this.sounds=null,n.destroy.call(this)},namespace("springroll").SoundTask=i}(),function(){function t(){var t=u.activePlugin,e=t._audioSources,i=t._soundInstances,n=t._loaders;h.context.close&&h.context.close();var s=window.AudioContext||window.webkitAudioContext;for(var r in h.context=new s,h.call(t),t._loaders=n,t._audioSources=e,t._soundInstances=i,i)for(var o=i[r],a=0;a<o.length;++a){var l=o[a];l.panNode.disconnect(0),l.gainNode.disconnect(0),l.gainNode=h.context.createGain(),l.panNode=h.context.createPanner(),l.panNode.panningModel=h._panningModel,l.panNode.connect(l.gainNode),l._updatePan(),(l._position<0||void 0===l._position)&&(l._position=0)}}function e(t){h.playEmptySound(),("running"==h.context.state||void 0===h.context.state)&&(f.preventDefaultOnUnmute&&t.preventDefault(),document.removeEventListener("touchstart",e),document.removeEventListener("touchend",e),document.removeEventListener("mousedown",e),f.systemMuted=!1,f.trigger("systemUnmuted"))}function i(t){return"string"==typeof t}function n(t){return"function"==typeof t}var s,r,o=include("springroll.Application"),a=include("springroll.EventDispatcher"),h=include("createjs.WebAudioPlugin"),l=include("createjs.FlashAudioPlugin",!1),u=include("createjs.Sound"),c=include("springroll.Enum"),d=function(){r||(include("springroll.Debug",!1),s=include("springroll.SoundContext"),r=include("springroll.SoundInstance")),a.call(this),this._sounds={},this._fades=[],this._pool=[],this.supportedSound=null,this._contexts={},this._update=this._update.bind(this),this._markLoaded=this._markLoaded.bind(this),this._playAfterLoad=this._playAfterLoad.bind(this),this.isSupported=!0,this.systemMuted=createjs.BrowserDetect.isIOS,this.preventDefaultOnUnmute=!0},p=(a.prototype,a.extend(d)),f=null,g=new c("unloaded","loading","loaded");d.init=function(t,i){var s=o.instance.options;n(t)&&(t={ready:t});var r={plugins:s.forceFlashAudio?[l]:[h,l],types:["ogg","mp3"],swfPath:"assets/swfs/",ready:null};if((t=Object.merge({},r,t)).ready=t.ready||i,!t.ready)throw"springroll.Sound.init requires a ready callback";if(l){var a=s.basePath;l.swfPath=(a||"")+t.swfPath}if(u.registerPlugins(t.plugins),createjs.BrowserDetect.isIOS&&u.activePlugin instanceof h&&"running"!=u.activePlugin.context.state?(document.addEventListener("touchstart",e),document.addEventListener("touchend",e),document.addEventListener("mousedown",e)):this.systemMuted=!1,f=new d,u.getCapabilities())f._initComplete(t.types,t.ready);else if(u.activePlugin){var c;c=function(){u.getCapabilities()&&(o.instance.off("update",c),f._initComplete(t.types,t.ready))},o.instance.on("update",c)}else f.isSupported=!1,t.ready&&t.ready();return f},p._initComplete=function(t,e){if(l&&u.activePlugin instanceof l)f.supportedSound=".mp3";else for(var i,n=0,s=t.length;s>n;++n)if(i=t[n],u.getCapability(i)){f.supportedSound="."+i;break}this._fixAndroidAudio=createjs.BrowserDetect.isAndroid&&u.activePlugin instanceof h&&!(navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("Firefox")>-1),this._fixAndroidAudio&&(this._numPlayingAudio=0,this._lastAudioTime=Date.now()),e&&e()},Object.defineProperty(d,"instance",{get:function(){return f}}),p.addContext=function(t){if(t){for(var e,n=t.soundManifest||t.sounds||[],r=t.path||"",o=!0===t.preload||!1,a=t.context,h={},l=0,u=n.length;u>l;++l)i(e=n[l])&&(e={id:e}),(h=this._sounds[e.id]={id:e.id,src:r+(e.src?e.src:e.id)+this.supportedSound,volume:e.volume?e.volume:1,loop:!!e.loop,loadState:g.unloaded,playing:[],waitingToPlay:[],context:e.context||a,playAfterLoad:!1,preloadCallback:null,data:e,duration:0}).context&&(this._contexts[h.context]||(this._contexts[h.context]=new s(h.context)),this._contexts[h.context].sounds.push(h)),(o||!0===e.preload)&&this.preload(h.id);return this}},p.linkContexts=function(t,e){if(this._contexts[t]||(this._contexts[t]=new s(t)),t=this._contexts[t],Array.isArray(e))for(var i=0;i<e.length;++i)t.subContexts.indexOf(e[i])<0&&t.subContexts.push(e[i]);else t.subContexts.indexOf(e)<0&&t.subContexts.push(e)},p.exists=function(t){return!!this._sounds[t]},p.contextExists=function(t){return!!this._contexts[t]},p.isUnloaded=function(t){return!!this._sounds[t]&&this._sounds[t].loadState==g.unloaded},p.isLoaded=function(t){return!!this._sounds[t]&&this._sounds[t].loadState==g.loaded},p.isLoading=function(t){return!!this._sounds[t]&&this._sounds[t].loadState==g.loading},p.isPlaying=function(t){var e=this._sounds[t];return!!e&&e.playing.length+e.waitingToPlay.length>0},p.getDuration=function(t){var e=this._sounds[t];if(!e)return null;if(!e.duration&&e.loadState==g.loaded){var i=u.play(t,null,null,null,null,0);e.duration=i.getDuration(),i.stop()}return e.duration},p.fadeIn=function(t,e,n,s){var r,a;if(i(t)){if(!(r=this._sounds[t]))return;r.playing.length&&(a=r.playing[r.playing.length-1])}else a=t,r=this._sounds[a.alias];if(a&&a._channel){a._fTime=0,a._fDur=e>0?e:500,a._fEnd=n||a.curVol,a._fStop=!1;var h=s>0?s:0;a.volume=a._fStart=h,-1==this._fades.indexOf(a)&&(this._fades.push(a),1==this._fades.length&&o.instance.on("update",this._update))}},p.fadeOut=function(t,e,n,s,r){var a,h;if(i(t)){if(!(a=this._sounds[t]))return;a.playing.length&&(h=a.playing[a.playing.length-1])}else h=t;h&&h._channel&&(h._fTime=0,h._fDur=e>0?e:500,s>0?(h.volume=s,h._fStart=s):h._fStart=h.volume,h._fEnd=n||0,r=void 0===r?0===h._fEnd:!!r,h._fStop=r,-1==this._fades.indexOf(h)&&(this._fades.push(h),1==this._fades.length&&o.instance.on("update",this._update)))},p._update=function(t){for(var e,i,n,s,r,a=this._fades,h=a.length-1;h>=0;--h)(e=a[h]).paused||((i=e._fTime+=t)>=e._fDur?e._fStop?((n=this._sounds[e.alias])&&n.playing.splice(n.playing.indexOf(e),1),this._stopInst(e)):(e.curVol=e._fEnd,e.updateVolume(),a.splice(h,1)):(s=i/e._fDur,r=e._fEnd>e._fStart?e._fStart+(e._fEnd-e._fStart)*s:e._fEnd+(e._fStart-e._fEnd)*s,e.curVol=r,e.updateVolume()));0===a.length&&o.instance.off("update",this._update)},p.play=function(e,i,s,r,o,a,h,l,c){var d;if(i&&n(i)&&(d=i,i=null),d=(i?i.complete:d)||null,s=(i?i.start:s)||null,r=!!(i?i.interrupt:r),o=(i?i.delay:o)||0,a=(i?i.offset:a)||0,h=i?i.loop:h,l=i?i.volume:l,c=(i?i.pan:c)||0,this.isSupported){!0===h&&(h=-1);var p=this._sounds[e];if(p){(p.loop&&void 0===h||null===h)&&(h=-1),l="number"==typeof l?l:p.volume;var f,v,m=p.loadState;if(m==g.loaded){this._fixAndroidAudio&&(this._numPlayingAudio?(this._numPlayingAudio++,this._lastAudioTime=-1):(Date.now()-this._lastAudioTime>=3e4&&t(),this._numPlayingAudio=1,this._lastAudioTime=-1));var y=u.play(e,r,o,a,h,l,c);return y&&y.playState!=u.PLAY_FAILED?(f=this._getSoundInst(y,p.id),y.handleExtraData&&y.handleExtraData(p.data),f.curVol=l,f._pan=c,p.playing.push(f),f._endCallback=d,f.updateVolume(),f.length=y.getDuration(),p.duration||(p.duration=f.length),f._channel.addEventListener("complete",f._endFunc),s&&setTimeout(s,0),f):(d&&d(),null)}return m==g.unloaded?(p.playAfterLoad=!0,(f=this._getSoundInst(null,p.id)).curVol=l,f._pan=c,p.waitingToPlay.push(f),f._endCallback=d,f._startFunc=s,f._startParams?((v=f._startParams)[0]=r,v[1]=o,v[2]=a,v[3]=h):f._startParams=[r,o,a,h],this.preload(p.id),f):m==g.loading?(p.playAfterLoad=!0,(f=this._getSoundInst(null,p.id)).curVol=l,f._pan=c,p.waitingToPlay.push(f),f._endCallback=d,f._startFunc=s,f._startParams?((v=f._startParams)[0]=r,v[1]=o,v[2]=a,v[3]=h):f._startParams=[r,o,a,h],f):void 0}d&&d()}else d&&setTimeout(d,0)},p._getSoundInst=function(t,e){var i;return this._pool.length?i=this._pool.pop():(i=new r)._endFunc=this._onSoundComplete.bind(this,i),i._channel=t,i.alias=e,i.length=t?t.getDuration():0,i.isValid=!0,i},p._playAfterLoad=function(e){var n=i(e)?e:e.data.id,s=this._sounds[n];if(s.loadState=g.loaded,s.playAfterLoad){this._fixAndroidAudio&&this._lastAudioTime>0&&Date.now()-this._lastAudioTime>=3e4&&t();for(var r,o,a,h,l,c=s.waitingToPlay,d=0,p=c.length;p>d;++d)o=(r=c[d])._startParams,a=r.curVol,l=r._pan,(h=u.play(n,o[0],o[1],o[2],o[3],a,l))&&h.playState!=u.PLAY_FAILED?(this._fixAndroidAudio&&(this._numPlayingAudio?(this._numPlayingAudio++,this._lastAudioTime=-1):(this._numPlayingAudio=1,this._lastAudioTime=-1)),s.playing.push(r),r._channel=h,h.handleExtraData&&h.handleExtraData(s.data),r.length=h.getDuration(),s.duration||(s.duration=r.length),r.updateVolume(),h.addEventListener("complete",r._endFunc),r._startFunc&&r._startFunc(),r.paused&&h.pause()):(r._endCallback&&r._endCallback(),this._poolInst(r));c.length=0}},p._onSoundComplete=function(t){if(t._channel){this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now()),t._channel.removeEventListener("complete",t._endFunc);var e=this._sounds[t.alias],i=e.playing.indexOf(t);i>-1&&e.playing.splice(i,1);var n=t._endCallback;this._poolInst(t),n&&n()}},p.stop=function(t){var e=this._sounds[t];if(e)if(e.playing.length)this._stopSound(e);else if(e.loadState==g.loading){e.playAfterLoad=!1;for(var i,n=e.waitingToPlay,s=0,r=n.length;r>s;++s)i=n[s],this._poolInst(i);n.length=0}},p._stopSound=function(t){for(var e=t.playing,i=e.length-1;i>=0;--i)this._stopInst(e[i]);e.length=0},p._stopInst=function(t){t._channel&&(!t.paused&&this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now()),t._channel.removeEventListener("complete",t._endFunc),t._channel.stop());var e=this._fades.indexOf(t);e>-1&&this._fades.splice(e,1),this._poolInst(t)},p.stopContext=function(t){if(t=this._contexts[t]){var e,i,n=t.sounds;for(i=n.length-1;i>=0;--i)(e=n[i]).playing.length?this._stopSound(e):e.loadState==g.loading&&(e.playAfterLoad=!1);for(i=0;i<t.subContexts.length;++i)this.stopContext(t.subContexts[i])}},p.stopAll=function(){for(var t in this._sounds)this.stop(t)},p.pause=function(t,e){i(t)&&(t=this._sounds[t]),e=!!e;var n,s=t.playing;for(n=s.length-1;n>=0;--n)s[n].paused||(s[n].pause(),s[n].globallyPaused=e);for(n=(s=t.waitingToPlay).length-1;n>=0;--n)s[n].paused||(s[n].pause(),s[n].globallyPaused=e)},p.resume=function(t,e){i(t)&&(t=this._sounds[t]);var n,s=t.playing;for(n=s.length-1;n>=0;--n)s[n].globallyPaused==e&&s[n].resume();for(n=(s=t.waitingToPlay).length-1;n>=0;--n)s[n].globallyPaused==e&&s[n].resume()},p.pauseContext=function(t){if(t=this._contexts[t]){var e,i,n=t.sounds;for(i=n.length-1;i>=0;--i){var s;for(s=(e=n[i]).playing.length-1;s>=0;--s)e.playing[s].pause();for(s=e.waitingToPlay.length-1;s>=0;--s)e.waitingToPlay[s].pause()}for(i=0;i<t.subContexts.length;++i)this.pauseContext(t.subContexts[i])}},p.resumeContext=function(t){if(t=this._contexts[t]){var e,i,n=t.sounds;for(i=n.length-1;i>=0;--i){var s;for(s=(e=n[i]).playing.length-1;s>=0;--s)e.playing[s].resume();for(s=e.waitingToPlay.length-1;s>=0;--s)e.waitingToPlay[s].resume()}for(i=0;i<t.subContexts.length;++i)this.resumeContext(t.subContexts[i])}},p.pauseAll=function(){var t=this._sounds;for(var e in t)this.pause(t[e],!0)},p.resumeAll=function(){var t=this._sounds;for(var e in t)this.resume(t[e],!0)},p._onInstancePaused=function(){this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now())},p._onInstanceResume=function(){this._fixAndroidAudio&&(this._lastAudioTime>0&&Date.now()-this._lastAudioTime>3e4&&t(),this._numPlayingAudio++,this._lastAudioTime=-1)},p.setContextMute=function(t,e){if(t=this._contexts[t]){t.muted=e;var i,n,s,r,o=t.volume,a=t.sounds;for(r=a.length-1;r>=0;--r)if((i=a[r]).playing.length)for(s=(n=i.playing).length-1;s>=0;--s)n[s].updateVolume(e?0:o);for(r=0;r<t.subContexts.length;++r)this.setContextMute(t.subContexts[r],e)}},Object.defineProperty(p,"muteAll",{set:function(t){u.setMute(!!t)}}),p.setContextVolume=function(t,e){if(t=this._contexts[t]){var i=t.muted;t.volume=e;for(var n,s,r,o=t.sounds,a=o.length-1;a>=0;--a)if((n=o[a]).playing.length)for(r=(s=n.playing).length-1;r>=0;--r)s[r].updateVolume(i?0:e)}},p.preload=function(t,e){if(this.isSupported)if(i(t)&&(t=[t]),t&&0!==t.length){for(var n,s=[],r=0,a=t.length;a>r;++r)(n=this._sounds[t[r]])&&n.loadState==g.unloaded&&(n.loadState=g.loading,s.push({id:n.id,src:n.src,complete:this._markLoaded,data:n,advanced:!0}));s.length>0?o.instance.load(s,e):e&&e()}else e&&e();else e&&setTimeout(e,0)},p._markLoaded=function(t){var e=t.data.id,i=this._sounds[e];i&&(i.loadState=g.loaded,i.playAfterLoad&&this._playAfterLoad(e));var n=i.preloadCallback;n&&(i.preloadCallback=null,n())},p.unload=function(t){if(t)for(var e,i=0,n=t.length;n>i;++i)(e=this._sounds[t[i]])&&(this._stopSound(e),e.loadState=g.unloaded),u.removeSound(e.src)},p.unloadAll=function(){var t=[];for(var e in this._sounds)t.push(e);this.unload(t)},p._poolInst=function(t){-1==this._pool.indexOf(t)&&(t._endCallback=t.alias=t._channel=t._startFunc=null,t.curVol=0,t.globallyPaused=t.paused=t.isValid=!1,this._pool.push(t))},p.destroy=function(){if(this.stopAll(),u.removeAllSounds(),l&&u.activePlugin instanceof l){var t=document.getElementById("SoundJSFlashContainer");t&&t.parentNode&&t.parentNode.removeChild(t)}f=null,this._sounds=null,this._volumes=null,this._fades=null,this._contexts=null,this._pool=null},namespace("springroll").Sound=d}(),function(){var t,e=include("springroll.Sound"),i=include("springroll.Application"),n=include("springroll.EventDispatcher"),s=function(){n.call(this),t||(t=include("springroll.Captions",!1)),this._onSoundFinished=this._onSoundFinished.bind(this),this._updateSilence=this._updateSilence.bind(this),this._updateSoloCaption=this._updateSoloCaption.bind(this),this._syncCaptionToSound=this._syncCaptionToSound.bind(this),this._listHelper=[],this.trackSound=!1,this.paused=!1,this.voList=null,this._listCounter=0,this._currentVO=null,this._soundInstance=null,this._callback=null,this._cancelledCallback=null,this._trackedSounds=[],this._timer=0,this._captions=null},r=extend(s,n);Object.defineProperty(r,"playing",{get:function(){return null!==this._currentVO||this._timer>0}}),Object.defineProperty(r,"currentVO",{get:function(){return this._currentVO}}),Object.defineProperty(r,"captions",{set:function(t){this._captions=t,t&&(t.selfUpdate=!1)},get:function(){return this._captions}}),Object.defineProperty(r,"currentPosition",{get:function(){return this.playing?this._soundInstance?this._soundInstance.position:this._currentVO?this._timer:this.voList[this._listCounter]-this._timer:0}}),Object.defineProperty(r,"currentDuration",{get:function(){return this.playing?this._soundInstance?e.instance.getDuration(this._soundInstance.alias):this._currentVO&&this._captions?this._captions.currentDuration:this.voList[this._listCounter]:0}}),r.getElapsed=function(){var t,i,n=0;if(!this.voList)return 0;for(i=0;i<this._listCounter;++i)"string"==typeof(t=this.voList[i])?n+=e.instance.getDuration(t):"number"==typeof t&&(n+=t);return(i=this._listCounter)<this.voList.length&&("string"==typeof(t=this.voList[i])?n+=this._soundInstance.position:"number"==typeof t&&(n+=t-this._timer)),n},r.pause=function(){!this.paused&&this.playing&&(this.paused=!0,this._soundInstance&&this._soundInstance.pause(),i.instance.off("update",[this._updateSoloCaption,this._syncCaptionToSound,this._updateSilence]))},r.resume=function(){this.paused&&(this.paused=!1,this._soundInstance&&this._soundInstance.resume(),this._captions.playing?this._soundInstance?i.instance.on("update",this._syncCaptionToSound):i.instance.on("update",this._updateSoloCaption):i.instance.on("update",this._updateSilence))},r.play=function(t,e,i){this.stop(),this.playing&&this.stop(),this._listCounter=-1,"string"==typeof t?(this._listHelper.length=0,this._listHelper[0]=t,this.voList=this._listHelper):this.voList=t,this._callback=e,this._cancelledCallback=!0===i?e:i,this._onSoundFinished()},r._onSoundFinished=function(){if(this._listCounter>=0&&this.trigger("end",this._currentVO),i.instance.off("update",[this._updateSoloCaption,this._syncCaptionToSound,this._updateSilence]),this._captions&&this._soundInstance&&this._captions.seek(this._soundInstance.length),this._soundInstance=null,this._listCounter++,this._listCounter>=this.voList.length){this._captions&&this._captions.stop(),this._currentVO=null,this._cancelledCallback=null;var t=this._callback;this._callback=null,t&&t()}else this._currentVO=this.voList[this._listCounter],"string"==typeof this._currentVO?(this._playSound(),this.trigger("start",this._currentVO)):"function"==typeof this._currentVO?(this._currentVO(),this._onSoundFinished()):(this._timer=this._currentVO,this._currentVO=null,i.instance.on("update",this._updateSilence),this.trigger("start",null))},r._updateSilence=function(t){this._timer-=t,this._timer<=0&&this._onSoundFinished()},r._updateSoloCaption=function(t){this._timer+=t,this._captions.seek(this._timer),this._timer>=this._captions.currentDuration&&this._onSoundFinished()},r._syncCaptionToSound=function(t){this._soundInstance&&this._captions.seek(this._soundInstance.position)},r._playSound=function(){this.trackSound&&-1==this._trackedSounds.indexOf(this._currentVO)&&this._trackedSounds.push(this._currentVO);var t=e.instance;!t.exists(this._currentVO)&&this._captions&&this._captions.hasCaption(this._currentVO)?(this._captions.play(this._currentVO),this._timer=0,i.instance.on("update",this._updateSoloCaption)):(this._soundInstance=t.play(this._currentVO,this._onSoundFinished),this._captions&&(this._captions.play(this._currentVO),i.instance.on("update",this._syncCaptionToSound)));for(var n,s=this.voList.length,r=this._listCounter+1;s>r;++r)if("string"==typeof(n=this.voList[r])){t.exists(n)&&!t.isLoaded(n)&&t.preload(n);break}},r.stop=function(){this.paused=!1,this._soundInstance&&(this._soundInstance.stop(),this._soundInstance=null),this._currentVO=null,this._captions&&this._captions.stop(),i.instance.off("update",[this._updateSoloCaption,this._syncCaptionToSound,this._updateSilence]),this.voList=null,this._timer=0,this._callback=null;var t=this._cancelledCallback;this._cancelledCallback=null,t&&t()},r.unloadSound=function(){e.instance.unload(this._trackedSounds),this._trackedSounds.length=0},r.destroy=function(){this.stop(),this.voList=null,this._listHelper=null,this._currentVO=null,this._soundInstance=null,this._callback=null,this._cancelledCallback=null,this._trackedSounds=null,this._captions=null,n.prototype.destroy.call(this)},namespace("springroll").VOPlayer=s,namespace("springroll").Sound.VOPlayer=s}(),function(){var t=include("springroll.ApplicationPlugin"),e=include("springroll.Sound"),i=include("springroll.VOPlayer"),n=new t(90);n.setup=function(){this.options.add("swfPath","assets/swfs/",!0),this.options.add("forceFlashAudio",!1,!0),this.options.add("audioTypes",["ogg","mp3"],!0),this._music=null,this._musicInstance=null,this.voPlayer=new i,this.sound=null,this.assetManager.register("springroll.SoundTask"),Object.defineProperty(this,"music",{set:function(t){if(t!=this._music){var e=this.sound;this._music&&(e.fadeOut(this._music),this._musicInstance=null),this._music=t,t&&(this._musicInstance=e.play(this._music,{start:e.fadeIn.bind(e,t),loop:-1}))}},get:function(){return this._music}}),Object.defineProperty(this,"musicInstance",{get:function(){return this._musicInstance}}),this.once("configLoaded",(function(t){var e=t.sounds,i=this.sound;e&&(e.vo&&i.addContext(e.vo),e.sfx&&i.addContext(e.sfx),e.music&&i.addContext(e.music))}))};n.preload=function(t){e.init({swfPath:this.options.swfPath,types:this.options.audioTypes,ready:function(){if(!this.destroyed){var i=this.sound=e.instance;this.on({paused:function(){i.pauseAll()},resumed:function(){i.resumeAll()}}),this.trigger("soundReady"),t()}}.bind(this)})},n.teardown=function(){this.voPlayer&&(this.voPlayer.destroy(),this.voPlayer=null),this.sound&&(this.sound.destroy(),this.sound=null)}}(),function(){var t=include("springroll.Sound"),e=include("springroll.SoundInstance"),i=include("springroll.VOPlayer"),n=t.prototype;Object.defineProperty(n,"soundEnabled",{get:function(){return this.isSupported}}),n.loadConfig=function(t){return this.addContext(t)},n.preloadSound=function(t,e){this.preload(t,e)},n.unpauseAll=function(){this.resumeAll()},n.unpauseSound=function(t){this.resume(t)},n.pauseSound=function(t){this.pause(t)},(n=e.prototype).unpause=function(){this.resume()},n=i.prototype,Object.defineProperty(n,"soundList",{get:function(){return this.voList}})}()}(),function(){"use strict";var t;!function(t){var e=include("PIXI.extras.BitmapText",!1);if(e){var i=e.prototype;i.setPivotToAlign=!1,i._orig_updateText=i.updateText,i.updateText=function(){if(this._orig_updateText(),this.setPivotToAlign)switch(this.align){case"center":this.pivot.x=this.textWidth/2;break;case"right":this.pivot.x=this.textWidth;break;default:this.pivot.x=0}}}}(),function(t){var e=include("PIXI.Container",!1);if(e){var i=e.prototype;i.useBoundsForSize=!0,i._width=0,i._height=0,Object.getOwnPropertyDescriptor(i,"width").configurable&&(Object.defineProperty(i,"width",{configurable:!0,get:function(){return this.useBoundsForSize?this.scale.x*this.getLocalBounds().width:this.scale.x*this._width},set:function(t){if(this.useBoundsForSize){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}else 0===this._width?this._width=t/this.scale.x:this.scale.x=t/this._width}}),Object.defineProperty(i,"height",{configurable:!0,get:function(){return this.useBoundsForSize?this.scale.y*this.getLocalBounds().height:this.scale.y*this._height},set:function(t){if(this.useBoundsForSize){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}else 0===this._height?this._height=t/this.scale.y:this.scale.y=t/this._height}}))}}(),(t=include("PIXI.interaction.InteractionManager",!1))&&(t.prototype.removeClickEvents=function(){this.interactionDOMElement&&(window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),window.removeEventListener("mouseup",this.onMouseUp,!0))}),function(t){var e=include("PIXI.Point",!1);if(e){var i=e.prototype;i.dotProd=function(t){return this.x*t.x+this.y*t.y},i.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.lengthSq=function(){return this.x*this.x+this.y*this.y},i.normalize=function(){var t=1/this.length();this.x*=t,this.y*=t},i.subtract=function(t){this.x-=t.x,this.y-=t.y},i.add=function(t){this.x+=t.x,this.y+=t.y},i.truncate=function(t){var e=this.length();if(e>t){var i=t/e;this.x*=i,this.y*=i}},i.scaleBy=function(t){this.x*=t,this.y*=t},i.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},i.distanceSq=function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},e.localToGlobal=function(t,e,i,n){return n||(n=new PIXI.Point),n.x=e,n.y=i,t.toGlobal(n,n)},e.globalToLocal=function(t,e,i,n){return n||(n=new PIXI.Point),n.x=e,n.y=i,t.toLocal(n,null,n)},e.localToLocal=function(t,e,i,n,s){return s||(s=new PIXI.Point),s.x=i,s.y=n,e.toLocal(s,t,s)},i.toString=function(){return"("+this.x+", "+this.y+")"}}}(),function(t){var e=180/Math.PI,i=function(t,e,i,n,s){for(this.x=t||0,this.y=e||0,this.radius=i||0,this.startAngle=n||0;this.startAngle<0;)this.startAngle+=360;this.endAngle=s||0,this.endAngle<this.startAngle&&(this.endAngle+=360)},n=i.prototype;n.clone=function(){return new PIXI.Sector(this.x,this.y,this.radius,this.startAngle,this.endAngle)},n.contains=function(t,i){if(this.radius<=0)return!1;var n=this.x-t,s=this.y-i;if((n*=n)+(s*=s)>this.radius*this.radius)return!1;for(var r=Math.atan2(i-this.y,t-this.x)*e;r<this.startAngle;)r+=360;return r>=this.startAngle&&r<=this.endAngle},n.constructor=i,namespace("PIXI").Sector=i}(),function(t){var e=include("PIXI.Text",!1);if(e){var i=e.prototype;i.setPivotToAlign=!1,i._orig_updateText=i.updateText,i.updateText=function(){if(this._orig_updateText(),this.setPivotToAlign)switch(this.style.align){case"center":this.pivot.x=this._width/2;break;case"right":this.pivot.x=this._width;break;default:this.pivot.x=0}}}}(),function(){var t,e=include("springroll.ColorAlphaTask"),i=include("springroll.Task"),n=include("PIXI.Texture"),s=include("PIXI.BaseTexture"),r=include("PIXI.utils"),o=include("springroll.Application"),a=function(e,n){t||(t=include("springroll.pixi.PixiDisplay")),i.call(this,e,n||e.image),this.image=this.filter(e.image),this.color=this.filter(e.color),this.alpha=this.filter(e.alpha),this.uploadToGPU=!!e.uploadToGPU},h=i.extend(a);a.test=function(t){return"pixi"==t.type&&(!!t.image||!!t.alpha&&!!t.color)},h.start=function(t){this.loadImage({},t)},h.loadImage=function(i,a,h){this.image?i._image=this.image:(i._color=this.color,i._alpha=this.alpha),this.load(i,function(i){var l;l=i._image?i._image:e.mergeAlpha(i._color,i._alpha);var u=this.original.scale;u&&1!==u||(u=r.getResolutionOfUrl(this.image||this.color));var c=new n(new s(l,null,u));if(c.baseTexture.imageUrl=this.image,this.cache&&!h){var d=this.id;r.useFilenamesForTextures||(d=this.image||this.color),r.TextureCache[d]=c,r.BaseTextureCache[d]=c.baseTexture,c.__T_destroy=c.destroy,c.destroy=function(){this.__destroyed||(this.__destroyed=!0,this.__T_destroy(!0),r.TextureCache[d]==this&&delete r.TextureCache[d])}}if(this.uploadToGPU){var p=o.instance.displays;for(var f in p){var g=p[f];if(g instanceof t&&g.isWebGL){g.renderer.updateTexture(c);break}}}a(c,i)}.bind(this))},h.destroy=function(){i.prototype.destroy.call(this)},namespace("springroll.pixi").TextureTask=a}(),function(t){var e=include("PIXI.Rectangle"),i=include("PIXI.Texture"),n=include("PIXI.utils"),s=function(t,s,r){this.baseTexture=t.baseTexture,this.texture=t,this.frames={};var o=s.meta&&"http://www.codeandweb.com/texturepacker"==s.meta.app,a=s.frames;for(var h in a){var l=a[h],u=h.lastIndexOf(".");u>0&&(h=h.substring(0,u)),(u=h.lastIndexOf("/"))>=0&&(h=h.substring(u+1));var c=l.frame;if(c){var d=null,p=null;d=l.rotated&&o?new e(c.x,c.y,c.h,c.w):new e(c.x,c.y,c.w,c.h),l.trimmed&&(p=new e(l.spriteSourceSize.x,l.spriteSourceSize.y,l.sourceSize.w,l.sourceSize.h)),this.frames[h]=new i(this.baseTexture,d,d.clone(),p,l.rotated),r&&(n.TextureCache[h]=this.frames[h])}}},r=extend(s);r.getFrame=function(t){return this.frames[t]||null},r.getFrames=function(t,e,i,n,s){void 0===n&&(n=4),0>n&&(n=0),s||(s=[]);var r,o,a=[],h=[];for(r=1;n>r;++r){var l="";o=1;for(var u=0;r>u;++u)l+="0",o*=10;a.unshift(l),h.push(o)}var c,d,p=h.length;for(r=e,d=i;d>=r;++r){var f=null;for(o=0;p>o;++o)if(r<h[o]){f=a[o]+r;break}f||(f=r.toString());var g=t.replace("#",f),v=this.frames[g];v&&(c=v),c&&s.push(c)}return s},r.destroy=function(){this.texture.destroy(!0),this.texture=null,this.baseTexture=null,this.frames=null},namespace("springroll.pixi").TextureAtlas=s}(),function(){var t=include("springroll.pixi.TextureTask"),e=(include("PIXI.Texture"),include("springroll.pixi.TextureAtlas")),i=(include("PIXI.utils"),function(e,i){t.call(this,e,i||e.atlas),this.atlas=this.filter(e.atlas)}),n=t.extend(i);i.test=function(e){return!!e.atlas&&t.test(e)},n.start=function(t){this.loadAtlas({},t)},n.loadAtlas=function(t,i,n){t._atlas=this.atlas,this.loadImage(t,function(t,s){var r=s._atlas,o=new e(t,r,this.cache&&!n);r.meta&&r.meta.scale&&1!=parseFloat(r.meta.scale)&&(t.baseTexture.resolution=parseFloat(s._atlas.meta.scale),t.baseTexture.update()),i(o,s)}.bind(this),!0)},namespace("springroll.pixi").TextureAtlasTask=i}(),function(){var t=include("springroll.pixi.TextureTask"),e=include("PIXI.Texture"),i=include("PIXI.Rectangle"),n=include("PIXI.extras.BitmapText",!1);if(include("PIXI.utils"),n){var s=function(e){t.call(this,e,e.font),this.font=this.filter(e.font)},r=t.extend(s);s.test=function(e){return!!e.font&&t.test(e)},r.start=function(t){this.loadImage({_font:this.font},function(s,r){var o=r._font,a={},h=o.getElementsByTagName("info")[0],l=o.getElementsByTagName("common")[0];a.font=h.getAttribute("face"),a.size=parseInt(h.getAttribute("size"),10),a.lineHeight=parseInt(l.getAttribute("lineHeight"),10),a.chars={};var u,c=o.getElementsByTagName("char");for(u=0;u<c.length;u++){var d=c[u],p=parseInt(d.getAttribute("id"),10),f=new i(parseInt(d.getAttribute("x"),10)+s.frame.x,parseInt(d.getAttribute("y"),10)+s.frame.y,parseInt(d.getAttribute("width"),10),parseInt(d.getAttribute("height"),10));a.chars[p]={xOffset:parseInt(d.getAttribute("xoffset"),10),yOffset:parseInt(d.getAttribute("yoffset"),10),xAdvance:parseInt(d.getAttribute("xadvance"),10),kerning:{},texture:new e(s.baseTexture,f)}}var g=o.getElementsByTagName("kerning");for(u=0;u<g.length;u++){var v=g[u],m=parseInt(v.getAttribute("first"),10),y=parseInt(v.getAttribute("second"),10),_=parseInt(v.getAttribute("amount"),10);a.chars[y].kerning[m]=_}this.cache&&n.fonts&&(n.fonts[a.font]=a),a.destroy=function(){a.chars=null,s.destroy()},t(a,r)}.bind(this),!0)},namespace("springroll.pixi").BitmapFontTask=s}}(),(new(include("springroll.ApplicationPlugin"))).setup=function(){this.assetManager.register("springroll.pixi.TextureTask",60),this.assetManager.register("springroll.pixi.TextureAtlasTask",70),this.assetManager.register("springroll.pixi.BitmapFontTask",80),this.once("displayAdded",(function(t){var e=this.options;!e.defaultAssetType&&t instanceof include("springroll.PixiDisplay")&&(e.defaultAssetType="pixi")}))},function(t){var e={};e.Circle=include("PIXI.Circle"),e.Ellipse=include("PIXI.Ellipse"),e.Rectangle=include("PIXI.Rectangle"),e.Sector=include("PIXI.Sector"),e.Point=include("PIXI.Point"),e.Polygon=include("PIXI.Polygon"),e.useRadians=!0,e.getLocalBounds=function(t){var e,i=t.width,n=t.height;return(e=i&&n?new PIXI.Rectangle(-t.pivot.x,-t.pivot.y,i/t.scale.x,n/t.scale.y):new PIXI.Rectangle).right=e.x+e.width,e.bottom=e.y+e.height,e},e.getScale=function(e,i){return i!==t?e.scale[i]:e.scale},e.setPosition=function(e,i,n){return n!==t?e.position[n]=i:(i.x!==t&&(e.position.x=i.x),i.y!==t&&(e.position.y=i.y)),e},e.getPosition=function(e,i){return i!==t?e.position[i]:e.position},e.setScale=function(e,i,n){return n!==t?e.scale[n]=i:e.scale.x=e.scale.y=i,e},e.setPivot=function(e,i,n){return n!==t&&(e.pivot[n]=i),e.pivot=i,e},e.setHitArea=function(t,e){return t.hitArea=e,t},e.getBitmapSize=function(t){return{h:t.height/t.scale.y,w:t.width/t.scale.x}},e.removeChildren=function(t){t.removeChildren()},e.contains=function(t,e){for(;e;){if(e==t)return!0;e=e.parent}return!1},namespace("springroll.pixi").DisplayAdapter=e}(),function(t){var e=include("springroll.AbstractDisplay"),i=include("PIXI.Container"),n=include("PIXI.CanvasRenderer"),s=include("PIXI.WebGLRenderer"),r=include("PIXI.autoDetectRenderer"),o=function(t,o){e.call(this,t,o),o=o||{},this.keepMouseover=o.keepMouseover||!1,this._autoPreventDefault=!o.hasOwnProperty("autoPreventDefault")||o.autoPreventDefault,this.stage=new i,this.renderer=null;var a={view:this.canvas,transparent:!!o.transparent,antialias:!!o.antiAlias,preserveDrawingBuffer:!!o.preserveDrawingBuffer,clearBeforeRender:!!o.clearView,backgroundColor:o.backgroundColor||0,autoResize:!1},h=!!o.preMultAlpha;(a.transparent&&!h&&(a.transparent="notMultiplied"),"webgl"!=o.forceContext)&&(window.navigator.userAgent.indexOf("Trident/7.0")>0&&(o.forceContext="canvas2d"));"canvas2d"==o.forceContext?this.renderer=new n(this.width,this.height,a):"webgl"==o.forceContext?this.renderer=new s(this.width,this.height,a):this.renderer=r(this.width,this.height,a),this.isWebGL=this.renderer instanceof s,this.adapter=include("springroll.pixi.DisplayAdapter"),this.autoPreventDefault=this._autoPreventDefault},a=e.prototype,h=e.extend(o);Object.defineProperty(h,"enabled",{get:function(){return this._enabled},set:function(t){Object.getOwnPropertyDescriptor(a,"enabled").set.call(this,t);var e=this.renderer.plugins.interaction;e&&(t?e.setTargetElement(this.canvas):this.keepMouseover?e.removeClickEvents():e.removeEvents())}}),Object.defineProperty(h,"autoPreventDefault",{get:function(){return this._autoPreventDefault},set:function(t){this._autoPreventDefault=!!t;var e=this.renderer.plugins.interaction;e&&(e.autoPreventDefault=this._autoPreventDefault)}}),h.resize=function(t,e){a.resize.call(this,t,e),this.renderer.resize(t,e)},h.render=function(t,e){(e||!this.paused&&this._visible)&&this.renderer.render(this.stage)},h.destroy=function(){this.stage.destroy(),a.destroy.call(this),this.renderer.destroy(),this.renderer=null},namespace("springroll").PixiDisplay=o,namespace("springroll.pixi").PixiDisplay=o}(),function(){function t(t){s+=t,e.update(s)}var e=include("PIXI.ticker.shared",!1),i=include("springroll.ApplicationPlugin");if(e){var n=new i,s=0;e.autoStart=!1,e.stop(),n.setup=function(){this.on("update",t,300)}}}(),function(t){var e=include("springroll.pixi.PixiDisplay"),i=include("springroll.Application");t.defineProperty(e.prototype,"animator",{get:function(){return i.instance.animator}})}(Object)}(),function(){"use strict";var t,e,i;!function(t){function e(t){var e=t.lastIndexOf("."),i=parseInt(t.substr(e+1),10),n=t.substr(0,e).split(":");return 36e5*parseInt(n[0],10)+6e3*parseInt(n[1],10)+1e3*parseInt(n[2],10)+i}var i=include("springroll.Application"),n=function(t,e,i){include("springroll.Debug",!1),this._data=null,this._textField=null,this._completeCallback=null,this._lines=[],this._currentAlias=0,this._currentDuration=0,this._currentTime=0,this._currentLine=-1,this._lastActiveLine=-1,this._playing=!1,this._destroyed=!1,this._selfUpdate=!0,this._mute=!1,this.update=this.update.bind(this),this.data=t||{},this.textField=e||null,this.selfUpdate=void 0===i||!!i},s=extend(n);Object.defineProperty(s,"mute",{get:function(){return this._mute},set:function(t){this._mute=t,this._updateCaptions()}}),Object.defineProperty(s,"selfUpdate",{set:function(t){this._selfUpdate=!!t,i.instance.off("update",this.update),this._selfUpdate&&i.instance.on("update",this.update)},get:function(){return this._selfUpdate}}),Object.defineProperty(s,"data",{set:function(t){if(this._data=t,t){var i,n,s,r,o=/[0-9]+\:[0-9]{2}\:[0-9]{2}\.[0-9]{3}/;for(var a in t)if(Array.isArray(t[a])&&(t[a]={lines:t[a]}),i=t[a].lines)for(r=i.length,n=0;r>n;++n)"string"==typeof(s=i[n]).start&&(o.test(s.start)?s.start=e(s.start):s.start=parseInt(s.start,10)),"string"==typeof s.end&&(o.test(s.end)?s.end=e(s.end):s.end=parseInt(s.end,10))}},get:function(){return this._data}}),Object.defineProperty(s,"textField",{set:function(t){r(this._textField,""),this._textField="string"==typeof t?document.getElementById(t):t||null},get:function(){return this._textField}});var r=function(t,e){if(t){if(t.nodeName)t.innerHTML=e;else{if(!t.constructor.prototype.hasOwnProperty("text")&&!t.hasOwnProperty("text"))throw"Unrecognizable captions text field";t.text=e}return t}};s.hasCaption=function(t){return!!this._data&&!!this._data[t]},s.getFullCaption=function(t,e){if(this._data){var i,n,s;if(e=e||" ",Array.isArray(t))for(s=0;s<t.length;s++)"string"==typeof t[s]&&(n=this.getFullCaption(t[s],e),i?i+=e+n:i=n);else{if(!this._data[t])return t;var r=this._data[t].lines;for(s=0;s<r.length;s++)n=r[s].content,i?i+=e+n:i=n}return i}},s._load=function(t){return this._destroyed?void 0:(this._reset(),t?void(this._lines=t.lines):void(this._lines=null))},s._reset=function(){this._currentLine=-1,this._lastActiveLine=-1},Object.defineProperty(s,"playing",{get:function(){return this._playing}}),s._getTotalDuration=function(){var t=this._lines;return t?t[t.length-1].end:0},Object.defineProperty(s,"currentDuration",{get:function(){return this._currentDuration}}),Object.defineProperty(s,"currentAlias",{get:function(){return this._currentAlias}}),s.play=function(t,e){this.stop(),this._completeCallback=e,this._playing=!0,this._currentAlias=t,this._load(this._data[t]),this._currentDuration=this._getTotalDuration(),this.seek(0)},s.stop=function(){this._playing=!1,this._currentAlias=null,this._lines=null,this._completeCallback=null,this._reset(),this._updateCaptions()},s.seek=function(t){var e=this._currentTime=t,i=this._lines;if(i){if(e<i[0].start)return this._currentLine=this._lastActiveLine=-1,void this._updateCaptions();for(var n=i.length,s=0;n>s;s++){if(e>=i[s].start&&e<=i[s].end){this._currentLine=this._lastActiveLine=s,this._updateCaptions();break}e>i[s].end?(this._lastActiveLine=s,this._currentLine=-1,this._updateCaptions()):e<i[s].start&&(this._lastActiveLine=s-1,this._currentLine=-1,this._updateCaptions())}}else this._updateCaptions()},s._updatePercent=function(t){this._destroyed||(this._currentTime=t*this._currentDuration,this._calcUpdate())},s.update=function(t){!this._destroyed&&this._playing&&(this._currentTime+=t,this._calcUpdate())},s._calcUpdate=function(){var t=this._lines;if(t){var e=t.length,i=this._lastActiveLine+1,n=e-1,s=this._currentTime;s>=t[n].end?this.stop():n>=i&&s>=t[i].start&&s<=t[i].end?(this._currentLine=this._lastActiveLine=i,this._updateCaptions()):-1!=this._currentLine&&s>t[this._currentLine].end&&(this._lastActiveLine=this._currentLine,this._currentLine=-1,this._updateCaptions())}},s._updateCaptions=function(){r(this._textField,-1==this._currentLine||this._mute?"":this._lines[this._currentLine].content)},s.getLength=function(t){var e=0;if(Array.isArray(t))for(var i=0,n=t.length;n>i;i++)"string"==typeof t[i]?e+=this.getLength(t[i]):"number"==typeof t[i]&&(e+=t[i]);else{if(!this._data[t])return e;var s=this._data[t].lines;e+=s[s.length-1].end}return parseInt(e)},s.destroy=function(){this._destroyed||(this._destroyed=!0,this._data=null,this._lines=null)},namespace("springroll").Captions=n}(),t=include("springroll.ApplicationPlugin"),e=include("springroll.Captions"),include("springroll.Debug",!1),(i=new t(60)).setup=function(){this.options.add("captions","captions",!0),this.options.add("captionsPath",null,!0),this.captions=new e},i.preload=function(t){this.voPlayer&&(this.voPlayer.captions=this.captions),this.captions.textField=this.options.captions;var e=this.options.captionsPath;e?this.load(e,function(e){this.captions.data=e,t()}.bind(this)):t()},i.teardown=function(){this.captions&&(this.captions.destroy(),this.captions=null)}}(),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=t()}}((function(){return function t(e,i,n){function s(o,a){if(!i[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[o]={exports:{}};e[o][0].call(u.exports,(function(t){var i=e[o][1][t];return s(i||t)}),u,u.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}}return t},i.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var s={arraySet:function(t,e,i,n,s){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),s);else for(var r=0;n>r;r++)t[s+r]=e[i+r]},flattenChunks:function(t){var e,i,n,s,r,o;for(n=0,e=0,i=t.length;i>e;e++)n+=t[e].length;for(o=new Uint8Array(n),s=0,e=0,i=t.length;i>e;e++)r=t[e],o.set(r,s),s+=r.length;return o}},r={arraySet:function(t,e,i,n,s){for(var r=0;n>r;r++)t[s+r]=e[i+r]},flattenChunks:function(t){return[].concat.apply([],t)}};i.setTyped=function(t){t?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,r))},i.setTyped(n)},{}],2:[function(t,e,i){"use strict";function n(t,e){if(65537>e&&(t.subarray&&o||!t.subarray&&r))return String.fromCharCode.apply(null,s.shrinkBuf(t,e));for(var i="",n=0;e>n;n++)i+=String.fromCharCode(t[n]);return i}var s=t("./common"),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var a=new s.Buf8(256),h=0;256>h;h++)a[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;a[254]=a[254]=1,i.string2buf=function(t){var e,i,n,r,o,a=t.length,h=0;for(r=0;a>r;r++)55296==(64512&(i=t.charCodeAt(r)))&&a>r+1&&(56320==(64512&(n=t.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++)),h+=128>i?1:2048>i?2:65536>i?3:4;for(e=new s.Buf8(h),o=0,r=0;h>o;r++)55296==(64512&(i=t.charCodeAt(r)))&&a>r+1&&(56320==(64512&(n=t.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++)),128>i?e[o++]=i:2048>i?(e[o++]=192|i>>>6,e[o++]=128|63&i):65536>i?(e[o++]=224|i>>>12,e[o++]=128|i>>>6&63,e[o++]=128|63&i):(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63,e[o++]=128|i>>>6&63,e[o++]=128|63&i);return e},i.buf2binstring=function(t){return n(t,t.length)},i.binstring2buf=function(t){for(var e=new s.Buf8(t.length),i=0,n=e.length;n>i;i++)e[i]=t.charCodeAt(i);return e},i.buf2string=function(t,e){var i,s,r,o,h=e||t.length,l=new Array(2*h);for(s=0,i=0;h>i;)if(128>(r=t[i++]))l[s++]=r;else if((o=a[r])>4)l[s++]=65533,i+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&h>i;)r=r<<6|63&t[i++],o--;o>1?l[s++]=65533:65536>r?l[s++]=r:(r-=65536,l[s++]=55296|r>>10&1023,l[s++]=56320|1023&r)}return n(l,s)},i.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return 0>i||0===i?e:i+a[t[i]]>e?i:e}},{"./common":1}],3:[function(t,e,i){"use strict";e.exports=function(t,e,i,n){for(var s=65535&t|0,r=t>>>16&65535|0,o=0;0!==i;){i-=o=i>2e3?2e3:i;do{r=r+(s=s+e[n++]|0)|0}while(--o);s%=65521,r%=65521}return s|r<<16|0}},{}],4:[function(t,e,i){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(t,e,i){"use strict";var n=function(){for(var t,e=[],i=0;256>i;i++){t=i;for(var n=0;8>n;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();e.exports=function(t,e,i,s){var r=n,o=s+i;t^=-1;for(var a=s;o>a;a++)t=t>>>8^r[255&(t^e[a])];return-1^t}},{}],6:[function(t,e,i){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],7:[function(t,e,i){"use strict";e.exports=function(t,e){var i,n,s,r,o,a,h,l,u,c,d,p,f,g,v,m,y,_,b,w,x,T,E,S,A;i=t.state,n=t.next_in,S=t.input,s=n+(t.avail_in-5),r=t.next_out,A=t.output,o=r-(e-t.avail_out),a=r+(t.avail_out-257),h=i.dmax,l=i.wsize,u=i.whave,c=i.wnext,d=i.window,p=i.hold,f=i.bits,g=i.lencode,v=i.distcode,m=(1<<i.lenbits)-1,y=(1<<i.distbits)-1;t:do{15>f&&(p+=S[n++]<<f,f+=8,p+=S[n++]<<f,f+=8),_=g[p&m];e:for(;;){if(p>>>=b=_>>>24,f-=b,0===(b=_>>>16&255))A[r++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=g[(65535&_)+(p&(1<<b)-1)];continue e}if(32&b){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}w=65535&_,(b&=15)&&(b>f&&(p+=S[n++]<<f,f+=8),w+=p&(1<<b)-1,p>>>=b,f-=b),15>f&&(p+=S[n++]<<f,f+=8,p+=S[n++]<<f,f+=8),_=v[p&y];i:for(;;){if(p>>>=b=_>>>24,f-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=v[(65535&_)+(p&(1<<b)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(x=65535&_,(b&=15)>f&&(p+=S[n++]<<f,b>(f+=8)&&(p+=S[n++]<<f,f+=8)),(x+=p&(1<<b)-1)>h){t.msg="invalid distance too far back",i.mode=30;break t}if(p>>>=b,f-=b,x>(b=r-o)){if((b=x-b)>u&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(T=0,E=d,0===c){if(T+=l-b,w>b){w-=b;do{A[r++]=d[T++]}while(--b);T=r-x,E=A}}else if(b>c){if(T+=l+c-b,w>(b-=c)){w-=b;do{A[r++]=d[T++]}while(--b);if(T=0,w>c){w-=b=c;do{A[r++]=d[T++]}while(--b);T=r-x,E=A}}}else if(T+=c-b,w>b){w-=b;do{A[r++]=d[T++]}while(--b);T=r-x,E=A}for(;w>2;)A[r++]=E[T++],A[r++]=E[T++],A[r++]=E[T++],w-=3;w&&(A[r++]=E[T++],w>1&&(A[r++]=E[T++]))}else{T=r-x;do{A[r++]=A[T++],A[r++]=A[T++],A[r++]=A[T++],w-=3}while(w>2);w&&(A[r++]=A[T++],w>1&&(A[r++]=A[T++]))}break}}break}}while(s>n&&a>r);n-=w=f>>3,p&=(1<<(f-=w<<3))-1,t.next_in=n,t.next_out=r,t.avail_in=s>n?s-n+5:5-(n-s),t.avail_out=a>r?a-r+257:257-(r-a),i.hold=p,i.bits=f}},{}],8:[function(t,e,i){"use strict";function n(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function s(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new p.Buf16(320),this.work=new p.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function r(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=R,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new p.Buf32(ut),e.distcode=e.distdyn=new p.Buf32(ct),e.sane=1,e.back=-1,E):P}function o(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,r(t)):P}function a(t,e){var i,n;return t&&t.state?(n=t.state,0>e?(i=0,e=-e):(i=1+(e>>4),48>e&&(e&=15)),e&&(8>e||e>15)?P:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,o(t))):P}function h(t,e){var i,n;return t?(n=new s,t.state=n,n.window=null,(i=a(t,e))!==E&&(t.state=null),i):P}function l(t){if(pt){var e;for(c=new p.Buf32(512),d=new p.Buf32(32),e=0;144>e;)t.lens[e++]=8;for(;256>e;)t.lens[e++]=9;for(;280>e;)t.lens[e++]=7;for(;288>e;)t.lens[e++]=8;for(m(_,t.lens,0,288,c,0,t.work,{bits:9}),e=0;32>e;)t.lens[e++]=5;m(b,t.lens,0,32,d,0,t.work,{bits:5}),pt=!1}t.lencode=c,t.lenbits=9,t.distcode=d,t.distbits=5}function u(t,e,i,n){var s,r=t.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new p.Buf8(r.wsize)),n>=r.wsize?(p.arraySet(r.window,e,i-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):((s=r.wsize-r.wnext)>n&&(s=n),p.arraySet(r.window,e,i-n,s,r.wnext),(n-=s)?(p.arraySet(r.window,e,i-n,n,0),r.wnext=n,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0}var c,d,p=t("../utils/common"),f=t("./adler32"),g=t("./crc32"),v=t("./inffast"),m=t("./inftrees"),y=0,_=1,b=2,w=4,x=5,T=6,E=0,S=1,A=2,P=-2,C=-3,M=-4,L=-5,O=8,R=1,I=2,D=3,k=4,j=5,B=6,F=7,N=8,U=9,X=10,H=11,Y=12,z=13,q=14,V=15,G=16,W=17,Z=18,J=19,Q=20,K=21,$=22,tt=23,et=24,it=25,nt=26,st=27,rt=28,ot=29,at=30,ht=31,lt=32,ut=852,ct=592,dt=15,pt=!0;i.inflateReset=o,i.inflateReset2=a,i.inflateResetKeep=r,i.inflateInit=function(t){return h(t,dt)},i.inflateInit2=h,i.inflate=function(t,e){var i,s,r,o,a,h,c,d,ut,ct,dt,pt,ft,gt,vt,mt,yt,_t,bt,wt,xt,Tt,Et,St,At=0,Pt=new p.Buf8(4),Ct=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return P;(i=t.state).mode===Y&&(i.mode=z),a=t.next_out,r=t.output,c=t.avail_out,o=t.next_in,s=t.input,h=t.avail_in,d=i.hold,ut=i.bits,ct=h,dt=c,Tt=E;t:for(;;)switch(i.mode){case R:if(0===i.wrap){i.mode=z;break}for(;16>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(2&i.wrap&&35615===d){i.check=0,Pt[0]=255&d,Pt[1]=d>>>8&255,i.check=g(i.check,Pt,2,0),d=0,ut=0,i.mode=I;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&d)<<8)+(d>>8))%31){t.msg="incorrect header check",i.mode=at;break}if((15&d)!==O){t.msg="unknown compression method",i.mode=at;break}if(ut-=4,xt=8+(15&(d>>>=4)),0===i.wbits)i.wbits=xt;else if(xt>i.wbits){t.msg="invalid window size",i.mode=at;break}i.dmax=1<<xt,t.adler=i.check=1,i.mode=512&d?X:Y,d=0,ut=0;break;case I:for(;16>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(i.flags=d,(255&i.flags)!==O){t.msg="unknown compression method",i.mode=at;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=at;break}i.head&&(i.head.text=d>>8&1),512&i.flags&&(Pt[0]=255&d,Pt[1]=d>>>8&255,i.check=g(i.check,Pt,2,0)),d=0,ut=0,i.mode=D;case D:for(;32>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}i.head&&(i.head.time=d),512&i.flags&&(Pt[0]=255&d,Pt[1]=d>>>8&255,Pt[2]=d>>>16&255,Pt[3]=d>>>24&255,i.check=g(i.check,Pt,4,0)),d=0,ut=0,i.mode=k;case k:for(;16>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}i.head&&(i.head.xflags=255&d,i.head.os=d>>8),512&i.flags&&(Pt[0]=255&d,Pt[1]=d>>>8&255,i.check=g(i.check,Pt,2,0)),d=0,ut=0,i.mode=j;case j:if(1024&i.flags){for(;16>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}i.length=d,i.head&&(i.head.extra_len=d),512&i.flags&&(Pt[0]=255&d,Pt[1]=d>>>8&255,i.check=g(i.check,Pt,2,0)),d=0,ut=0}else i.head&&(i.head.extra=null);i.mode=B;case B:if(1024&i.flags&&((pt=i.length)>h&&(pt=h),pt&&(i.head&&(xt=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),p.arraySet(i.head.extra,s,o,pt,xt)),512&i.flags&&(i.check=g(i.check,s,pt,o)),h-=pt,o+=pt,i.length-=pt),i.length))break t;i.length=0,i.mode=F;case F:if(2048&i.flags){if(0===h)break t;pt=0;do{xt=s[o+pt++],i.head&&xt&&i.length<65536&&(i.head.name+=String.fromCharCode(xt))}while(xt&&h>pt);if(512&i.flags&&(i.check=g(i.check,s,pt,o)),h-=pt,o+=pt,xt)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=N;case N:if(4096&i.flags){if(0===h)break t;pt=0;do{xt=s[o+pt++],i.head&&xt&&i.length<65536&&(i.head.comment+=String.fromCharCode(xt))}while(xt&&h>pt);if(512&i.flags&&(i.check=g(i.check,s,pt,o)),h-=pt,o+=pt,xt)break t}else i.head&&(i.head.comment=null);i.mode=U;case U:if(512&i.flags){for(;16>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(d!==(65535&i.check)){t.msg="header crc mismatch",i.mode=at;break}d=0,ut=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Y;break;case X:for(;32>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}t.adler=i.check=n(d),d=0,ut=0,i.mode=H;case H:if(0===i.havedict)return t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=h,i.hold=d,i.bits=ut,A;t.adler=i.check=1,i.mode=Y;case Y:if(e===x||e===T)break t;case z:if(i.last){d>>>=7&ut,ut-=7&ut,i.mode=st;break}for(;3>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}switch(i.last=1&d,ut-=1,3&(d>>>=1)){case 0:i.mode=q;break;case 1:if(l(i),i.mode=Q,e===T){d>>>=2,ut-=2;break t}break;case 2:i.mode=W;break;case 3:t.msg="invalid block type",i.mode=at}d>>>=2,ut-=2;break;case q:for(d>>>=7&ut,ut-=7&ut;32>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if((65535&d)!=(d>>>16^65535)){t.msg="invalid stored block lengths",i.mode=at;break}if(i.length=65535&d,d=0,ut=0,i.mode=V,e===T)break t;case V:i.mode=G;case G:if(pt=i.length){if(pt>h&&(pt=h),pt>c&&(pt=c),0===pt)break t;p.arraySet(r,s,o,pt,a),h-=pt,o+=pt,c-=pt,a+=pt,i.length-=pt;break}i.mode=Y;break;case W:for(;14>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(i.nlen=257+(31&d),d>>>=5,ut-=5,i.ndist=1+(31&d),d>>>=5,ut-=5,i.ncode=4+(15&d),d>>>=4,ut-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=at;break}i.have=0,i.mode=Z;case Z:for(;i.have<i.ncode;){for(;3>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}i.lens[Ct[i.have++]]=7&d,d>>>=3,ut-=3}for(;i.have<19;)i.lens[Ct[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Et={bits:i.lenbits},Tt=m(y,i.lens,0,19,i.lencode,0,i.work,Et),i.lenbits=Et.bits,Tt){t.msg="invalid code lengths set",i.mode=at;break}i.have=0,i.mode=J;case J:for(;i.have<i.nlen+i.ndist;){for(;mt=(At=i.lencode[d&(1<<i.lenbits)-1])>>>16&255,yt=65535&At,!(ut>=(vt=At>>>24));){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(16>yt)d>>>=vt,ut-=vt,i.lens[i.have++]=yt;else{if(16===yt){for(St=vt+2;St>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(d>>>=vt,ut-=vt,0===i.have){t.msg="invalid bit length repeat",i.mode=at;break}xt=i.lens[i.have-1],pt=3+(3&d),d>>>=2,ut-=2}else if(17===yt){for(St=vt+3;St>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}ut-=vt,xt=0,pt=3+(7&(d>>>=vt)),d>>>=3,ut-=3}else{for(St=vt+7;St>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}ut-=vt,xt=0,pt=11+(127&(d>>>=vt)),d>>>=7,ut-=7}if(i.have+pt>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=at;break}for(;pt--;)i.lens[i.have++]=xt}}if(i.mode===at)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=at;break}if(i.lenbits=9,Et={bits:i.lenbits},Tt=m(_,i.lens,0,i.nlen,i.lencode,0,i.work,Et),i.lenbits=Et.bits,Tt){t.msg="invalid literal/lengths set",i.mode=at;break}if(i.distbits=6,i.distcode=i.distdyn,Et={bits:i.distbits},Tt=m(b,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Et),i.distbits=Et.bits,Tt){t.msg="invalid distances set",i.mode=at;break}if(i.mode=Q,e===T)break t;case Q:i.mode=K;case K:if(h>=6&&c>=258){t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=h,i.hold=d,i.bits=ut,v(t,dt),a=t.next_out,r=t.output,c=t.avail_out,o=t.next_in,s=t.input,h=t.avail_in,d=i.hold,ut=i.bits,i.mode===Y&&(i.back=-1);break}for(i.back=0;mt=(At=i.lencode[d&(1<<i.lenbits)-1])>>>16&255,yt=65535&At,!(ut>=(vt=At>>>24));){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(mt&&0==(240&mt)){for(_t=vt,bt=mt,wt=yt;mt=(At=i.lencode[wt+((d&(1<<_t+bt)-1)>>_t)])>>>16&255,yt=65535&At,!(ut>=_t+(vt=At>>>24));){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}d>>>=_t,ut-=_t,i.back+=_t}if(d>>>=vt,ut-=vt,i.back+=vt,i.length=yt,0===mt){i.mode=nt;break}if(32&mt){i.back=-1,i.mode=Y;break}if(64&mt){t.msg="invalid literal/length code",i.mode=at;break}i.extra=15&mt,i.mode=$;case $:if(i.extra){for(St=i.extra;St>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}i.length+=d&(1<<i.extra)-1,d>>>=i.extra,ut-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=tt;case tt:for(;mt=(At=i.distcode[d&(1<<i.distbits)-1])>>>16&255,yt=65535&At,!(ut>=(vt=At>>>24));){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(0==(240&mt)){for(_t=vt,bt=mt,wt=yt;mt=(At=i.distcode[wt+((d&(1<<_t+bt)-1)>>_t)])>>>16&255,yt=65535&At,!(ut>=_t+(vt=At>>>24));){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}d>>>=_t,ut-=_t,i.back+=_t}if(d>>>=vt,ut-=vt,i.back+=vt,64&mt){t.msg="invalid distance code",i.mode=at;break}i.offset=yt,i.extra=15&mt,i.mode=et;case et:if(i.extra){for(St=i.extra;St>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}i.offset+=d&(1<<i.extra)-1,d>>>=i.extra,ut-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=at;break}i.mode=it;case it:if(0===c)break t;if(pt=dt-c,i.offset>pt){if((pt=i.offset-pt)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=at;break}pt>i.wnext?(pt-=i.wnext,ft=i.wsize-pt):ft=i.wnext-pt,pt>i.length&&(pt=i.length),gt=i.window}else gt=r,ft=a-i.offset,pt=i.length;pt>c&&(pt=c),c-=pt,i.length-=pt;do{r[a++]=gt[ft++]}while(--pt);0===i.length&&(i.mode=K);break;case nt:if(0===c)break t;r[a++]=i.length,c--,i.mode=K;break;case st:if(i.wrap){for(;32>ut;){if(0===h)break t;h--,d|=s[o++]<<ut,ut+=8}if(dt-=c,t.total_out+=dt,i.total+=dt,dt&&(t.adler=i.check=i.flags?g(i.check,r,dt,a-dt):f(i.check,r,dt,a-dt)),dt=c,(i.flags?d:n(d))!==i.check){t.msg="incorrect data check",i.mode=at;break}d=0,ut=0}i.mode=rt;case rt:if(i.wrap&&i.flags){for(;32>ut;){if(0===h)break t;h--,d+=s[o++]<<ut,ut+=8}if(d!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=at;break}d=0,ut=0}i.mode=ot;case ot:Tt=S;break t;case at:Tt=C;break t;case ht:return M;case lt:default:return P}return t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=h,i.hold=d,i.bits=ut,(i.wsize||dt!==t.avail_out&&i.mode<at&&(i.mode<st||e!==w))&&u(t,t.output,t.next_out,dt-t.avail_out)?(i.mode=ht,M):(ct-=t.avail_in,dt-=t.avail_out,t.total_in+=ct,t.total_out+=dt,i.total+=dt,i.wrap&&dt&&(t.adler=i.check=i.flags?g(i.check,r,dt,t.next_out-dt):f(i.check,r,dt,t.next_out-dt)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Y?128:0)+(i.mode===Q||i.mode===V?256:0),(0===ct&&0===dt||e===w)&&Tt===E&&(Tt=L),Tt)},i.inflateEnd=function(t){if(!t||!t.state)return P;var e=t.state;return e.window&&(e.window=null),t.state=null,E},i.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?P:(i.head=e,e.done=!1,E):P},i.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&i.mode!==H?P:i.mode===H&&f(1,e,n,0)!==i.check?C:u(t,e,n,n)?(i.mode=ht,M):(i.havedict=1,E):P},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(t,e,i){"use strict";var n=t("../utils/common"),s=15,r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,i,l,u,c,d,p){var f,g,v,m,y,_,b,w,x,T=p.bits,E=0,S=0,A=0,P=0,C=0,M=0,L=0,O=0,R=0,I=0,D=null,k=0,j=new n.Buf16(16),B=new n.Buf16(16),F=null,N=0;for(E=0;s>=E;E++)j[E]=0;for(S=0;l>S;S++)j[e[i+S]]++;for(C=T,P=s;P>=1&&0===j[P];P--);if(C>P&&(C=P),0===P)return u[c++]=20971520,u[c++]=20971520,p.bits=1,0;for(A=1;P>A&&0===j[A];A++);for(A>C&&(C=A),O=1,E=1;s>=E;E++)if(O<<=1,0>(O-=j[E]))return-1;if(O>0&&(0===t||1!==P))return-1;for(B[1]=0,E=1;s>E;E++)B[E+1]=B[E]+j[E];for(S=0;l>S;S++)0!==e[i+S]&&(d[B[e[i+S]]++]=S);if(0===t?(D=F=d,_=19):1===t?(D=r,k-=257,F=o,N-=257,_=256):(D=a,F=h,_=-1),I=0,S=0,E=A,y=c,M=C,L=0,v=-1,m=(R=1<<C)-1,1===t&&R>852||2===t&&R>592)return 1;for(;;){b=E-L,d[S]<_?(w=0,x=d[S]):d[S]>_?(w=F[N+d[S]],x=D[k+d[S]]):(w=96,x=0),f=1<<E-L,A=g=1<<M;do{u[y+(I>>L)+(g-=f)]=b<<24|w<<16|x|0}while(0!==g);for(f=1<<E-1;I&f;)f>>=1;if(0!==f?(I&=f-1,I+=f):I=0,S++,0==--j[E]){if(E===P)break;E=e[i+d[S]]}if(E>C&&(I&m)!==v){for(0===L&&(L=C),y+=A,O=1<<(M=E-L);P>M+L&&!(0>=(O-=j[M+L]));)M++,O<<=1;if(R+=1<<M,1===t&&R>852||2===t&&R>592)return 1;u[v=I&m]=C<<24|M<<16|y-c|0}}return 0!==I&&(u[y+I]=E-L<<24|64<<16|0),p.bits=C,0}},{"../utils/common":1}],10:[function(t,e,i){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(t,e,i){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/lib/inflate.js":[function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var i=r.inflateInit2(this.strm,e.windowBits);if(i!==h.Z_OK)throw new Error(l[i]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function s(t,e){var i=new n(e);if(i.push(t,!0),i.err)throw i.msg;return i.result}var r=t("./zlib/inflate"),o=t("./utils/common"),a=t("./utils/strings"),h=t("./zlib/constants"),l=t("./zlib/messages"),u=t("./zlib/zstream"),c=t("./zlib/gzheader"),d=Object.prototype.toString;n.prototype.push=function(t,e){var i,n,s,l,u,c,p=this.strm,f=this.options.chunkSize,g=this.options.dictionary,v=!1;if(this.ended)return!1;n=e===~~e?e:!0===e?h.Z_FINISH:h.Z_NO_FLUSH,"string"==typeof t?p.input=a.binstring2buf(t):"[object ArrayBuffer]"===d.call(t)?p.input=new Uint8Array(t):p.input=t,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new o.Buf8(f),p.next_out=0,p.avail_out=f),(i=r.inflate(p,h.Z_NO_FLUSH))===h.Z_NEED_DICT&&g&&(c="string"==typeof g?a.string2buf(g):"[object ArrayBuffer]"===d.call(g)?new Uint8Array(g):g,i=r.inflateSetDictionary(this.strm,c)),i===h.Z_BUF_ERROR&&!0===v&&(i=h.Z_OK,v=!1),i!==h.Z_STREAM_END&&i!==h.Z_OK)return this.onEnd(i),this.ended=!0,!1;p.next_out&&(0===p.avail_out||i===h.Z_STREAM_END||0===p.avail_in&&(n===h.Z_FINISH||n===h.Z_SYNC_FLUSH))&&("string"===this.options.to?(s=a.utf8border(p.output,p.next_out),l=p.next_out-s,u=a.buf2string(p.output,s),p.next_out=l,p.avail_out=f-l,l&&o.arraySet(p.output,p.output,s,l,0),this.onData(u)):this.onData(o.shrinkBuf(p.output,p.next_out))),0===p.avail_in&&0===p.avail_out&&(v=!0)}while((p.avail_in>0||0===p.avail_out)&&i!==h.Z_STREAM_END);return i===h.Z_STREAM_END&&(n=h.Z_FINISH),n===h.Z_FINISH?(i=r.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===h.Z_OK):n!==h.Z_SYNC_FLUSH||(this.onEnd(h.Z_OK),p.avail_out=0,!0)},n.prototype.onData=function(t){this.chunks.push(t)},n.prototype.onEnd=function(t){t===h.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},i.Inflate=n,i.inflate=s,i.inflateRaw=function(t,e){return(e=e||{}).raw=!0,s(t,e)},i.ungzip=s},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")})),function(t,e,i){"use strict";var n={value:!1,writable:!0},s={},r=0;t.recycle={add:function(t,o,a,h){var l=t===i,u=[];return a&&s[a]&&console.warn('Recycle cache for "'+a+'" already exists.'),s[a||"cache-"+r++]=u,e.defineProperties(t,{setUp:{value:l?o?function(){var t=0,i=null;for(u.length?(i=u.pop()).recycled=!1:(i=[],e.defineProperty(i,"recycled",n)),t=0;t<arguments.length;t++)i.push(arguments[t]);return i}:function(){var t=0,e=null;for(e=u.length?u.pop():[],t=0;t<arguments.length;t++)e.push(arguments[t]);return e}:o?function(){var t=null;return u.length?(t=u.pop()).recycled=!1:(t=e.create(this.prototype),e.defineProperty(t,"recycled",n)),this.apply(t,arguments),t}:function(){var t=null;return t=u.length?u.pop():e.create(this.prototype),this.apply(t,arguments),t}},recycle:{value:o?function(t){t.recycled?console.warn("WHOA! I have already been recycled!",t):(t.recycled=!0,u.push(t))}:function(t){u.push(t)}}}),e.defineProperty(t.prototype,"recycle",{value:h||(l?function(e){var i=0;if(e>1)for(i=this.length,e-=1;i--;)this[i].recycle(e);this.length=0,t.recycle(this)}:function(){t.recycle(this)})}),u},cache:s}}(window,Object,Array),this.platypus=this.platypus||{},function(t){"use strict";var e=function(){},i=navigator.userAgent.toLowerCase(),n=i.search("edge")>-1,s=i.search("ipod")>-1,r=i.search("iphone")>-1,o=i.search("ipad")>-1,a=i.search("android")>-1,h=i.search("silk")>-1,l=s||r||o,u=l||a||h;t.supports={touch:"undefined"!==window.ontouchstart,edge:n,iPod:s,iPhone:r,iPad:o,safari:i.search("safari")>-1&&!n,ie:i.search("msie")>-1||i.search("trident")>-1,firefox:i.search("firefox")>-1,android:a,chrome:i.search("chrome")>-1&&!n,silk:h,iOS:l,mobile:u,desktop:!u},t.debug=springroll.Debug||{error:e,log:e,olive:e,warn:e},t.version="0.9.3",t.buildDate="Mon, 10 Oct 2016 18:55:25 GMT"}(this.platypus),function(t,e){"use strict";var i=t.prototype;i.union||e.defineProperty(i,"union",{value:function(t){var e=0,i=t.length;for(e=0;i>e;e++)-1===this.indexOf(t[e])&&this.push(t[e]);return this}}),i.greenSlice||e.defineProperty(i,"greenSlice",{value:function(){var e=t.setUp(),i=0,n=this.length;for(i=0;n>i;i++)e[i]=this[i];return e}}),i.greenSplice||e.defineProperty(i,"greenSplice",{value:function(t){var e=0,i=this[t],n=this.length;if(0>t||t>=n)return null;for(e=t+1;n>e;e++)this[e-1]=this[e];return n&&(this.length-=1),i}}),recycle.add(t,!!springroll.Debug,"Array")}(Array,Object),function(){"use strict";var t=function(t){return platypus.debug.olive('"'+t+'" is not an available PIXI.Graphics method.'),this},e=include("PIXI.Graphics").prototype;e.a=e.arc,e.at=e.arcTo,e.bt=e.bezierCurveTo,e.c=e.clear,e.dc=e.drawCircle,e.de=e.drawEllipse,e.dr=e.drawRect,e.ef=e.endFill,e.f=e.beginFill,e.lt=e.lineTo,e.mt=e.moveTo,e.qt=e.quadraticCurveTo,e.r=e.drawRect,e.rr=e.drawRoundedRect,e.cp=t.bind("cp"),e.lf=t.bind("lf"),e.rf=t.bind("rf"),e.bf=t.bind("bf"),e.ss=t.bind("ss"),e.sd=t.bind("sd"),e.s=t.bind("s"),e.ls=t.bind("ls"),e.rs=t.bind("rs"),e.bs=t.bind("bs"),e.es=t.bind("es"),e.rc=t.bind("rc"),e.dp=t.bind("dp"),e.p=t.bind("p")}(),function(){"use strict";var t=PIXI.Container.prototype;t.updateTransform=function(){var t=0,e=0;if(this.visible)for(this.transformMatrix?(this.transformMatrix.copy(this.worldTransform).prepend(this.parent.worldTransform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null):this.displayObjectUpdateTransform(),t=0,e=this.children.length;e>t;++t)this.children[t].updateTransform()},t.containerUpdateTransform=t.updateTransform}(),function(t,e){"use strict";var i=String.prototype;i.greenSplit||e.defineProperty(i,"greenSplit",{value:function(t){var e=this.toString(),i=0,n=0,s=Array.setUp();if(t){for(n=e.indexOf(t),i=t.length;n>=0;)s.push(e.substr(0,n)),n=(e=e.substr(n+i)).indexOf(t);s.push(e)}else for(i=(n=this.length)-1;n--;)s.push(this[i-n]);return s}})}(0,Object),function(t){"use strict";var e=null,i=null,n=null;window.Map||(e={value:null},n=(i=function(){e.value={},t.defineProperty(this,"map",e)}).prototype,t.defineProperties(n,{get:{value:function(t){return this.map[t]}},has:{value:function(t){return this.map.hasOwnProperty(t)}},set:{value:function(t,e){return this.map[t]=e,this}},delete:{value:function(t){var e=this.map[t];return delete this.map[t],e}}}),window.Map=i)}(Object),platypus.Data=function(){"use strict";var t=function(t){var e=arguments.length,i="";if(t)if("string"==typeof t)for(e%2&&(this[e]=null,e-=1);e;)this[arguments[e-2]]=arguments[e-1],e-=2;else for(i in t)t.hasOwnProperty(i)&&(this[i]=t[i])};return recycle.add(t,!!springroll.Debug,"Data",(function(){var e="";for(e in this)this.hasOwnProperty(e)&&delete this[e];t.recycle(this)})),t}(),platypus.DataMap=function(){"use strict";var t=include("window.Map"),e=function(t,e,i){return this.get(e)!==i&&(this.has(e)||t.push(e),this.set(e,i)),i},i=function(t,e){var i=t.indexOf(e),n=this.get(e);return i>=0&&(t.greenSplice(i),this.delete(e)),n},n=function(t){for(var e=t.length;e--;)this.delete(t[e]);t.length=0},s={get:{value:null},has:{value:null},keys:{value:null},set:{value:null},delete:{value:null},clear:{value:null}},r=function(r){var o=arguments.length,a="",h=null,l=null,u=null;if(this.map||(u=s,l=this.map=new t,h=u.keys.value=Array.setUp(),u.get.value=l.get.bind(l),u.has.value=l.has.bind(l),u.set.value=e.bind(l,h),u.delete.value=i.bind(l,h),u.clear.value=n.bind(l,h),Object.defineProperties(this,u)),r)if(h=r.keys,"string"==typeof r)for(o%2&&(o-=1,this.set(arguments[o],null));o;)o-=2,this.set(arguments[o],arguments[o+1]);else if(h)for(o=h.length;o--;)this.set(h[o],r.get(h[o]));else for(a in r)r.hasOwnProperty(a)&&this.set(a,r[a])};return recycle.add(r,!!springroll.Debug,"DataMap",(function(){this.clear(),r.recycle(this)})),r}(),function(){"use strict";var t=include("PIXI.BaseTexture"),e=include("platypus.Data"),i=include("PIXI.Point"),n=include("PIXI.Rectangle"),s=include("PIXI.Sprite"),r=include("PIXI.Texture"),o={},a={},h={texture:r.EMPTY,anchor:new i(0,0)},l=/[\[\]{},-]/g,u=function(e){var i=0,n=Array.setUp(),s=null,r=platypus.game.app.assetManager.cache,o=a,h=null;for(i=0;i<e.length;i++)if("string"==typeof(h=e[i])){if(!o[h]){if(!(s=r.read(h))){platypus.debug.warn('"'+h+'" is not a loaded asset.');break}o[h]=new t(s)}n.push(o[h])}else n.push(new t(h));return n},c=function(t,i){var n=Array.setUp(),s=0;for(s=0;t>s;s++)n.push(i[s]||h);return e.setUp("id","default","frames",n,"next","default","speed",1)},d=function(t,i){var n="",s=e.setUp(),r=0,o=null,a="";for(a in t)if(t.hasOwnProperty(a)){for(r=(o=(n=t[a]).frames.greenSlice()).length;r--;)o[r]=i[o[r]]||h;s[a]=e.setUp("id",a,"frames",o,"next",n.next,"speed",n.speed)}return s.default||(s.default=c(i.length,i)),s},p=function(t){var s=0,o=null,a=null,h=t.frames,l=t.images,p=null,f=Array.setUp(),g=u(l);for(s=0;s<h.length;s++)a=h[s],p=new r(g[a[4]],new n(a[0],a[1],a[2],a[3])),f.push({texture:p,anchor:new i((a[5]||0)/p.width,(a[6]||0)/p.height)});return(o=d(t.animations,f)).default||(o.default=c(f.length,f)),g.recycle(),e.setUp("textures",f,"animations",o)},f=function(t,s){var o,a=0,h=null,l=t.frames,c=t.images,p=null,f=Array.setUp(),g=u(c);for(a=0;a<l.length;a++)h=l[a],p=new r(g[h[4]],new n(h[0],h[1],h[2],h[3])),f.push({texture:p,anchor:new i((h[5]||0)/p.width,(h[6]||0)/p.height)});return o=d(t.animations,f),g.recycle(),e.setUp("textures",f,"animations",o,"viable",1,"cacheId",s)},g=function(t,e){var i=function(t){var e=0;if(t.id)return t.id;for(e=0;e<t.images.length;e++)if("string"!=typeof t.images[e])return"";return t.id=JSON.stringify(t).replace(l,""),t.id}(t),n=i?o[i]:null,r=(t.framerate||60)/60;i?n?(n.viable+=1,this.cacheId=i):(n=o[i]=f(t,i),this.cacheId=i):n=p(t),s.call(this,n.textures[0].texture),this._animations=n.animations,this._animation=null,this.animationSpeed=r,this.currentAnimation=null,this._currentTime=0,this.playing=!1,this._visible=!0,this._updating=!1,n.textures.length<2?this.gotoAndStop(e):this.gotoAndPlay(e)},v=g.prototype=Object.create(s.prototype);g.prototype.constructor=g,platypus.PIXIAnimation=g,Object.defineProperties(v,{visible:{get:function(){return this._visible},set:function(t){this._visible=t,this._syncUpdate()}},currentFrame:{get:function(){var t=this._animation.frames;return t[Math.floor(this._currentTime)%t.length]}},paused:{get:function(){return!this.playing},set:function(t){(t&&this.playing||!t&&!this.playing)&&(this.playing=!t,this._syncUpdate())}}}),v.stop=function(){this.paused=!0},v.play=function(){this.paused=!1},v._syncUpdate=function(){var t=this.playing&&this._visible;t!==this._updating&&(this._updating=t,t?PIXI.ticker.shared.add(this.update,this):PIXI.ticker.shared.remove(this.update,this))},v.gotoAndStop=function(t){this.stop(),this._currentTime=0,this._animation=this._animations[t],this._animation||(this._animation=this._animations.default),this._texture=this._animation.frames[0].texture,this.anchor=this._animation.frames[0].anchor},v.gotoAndPlay=function(t,e){(this.currentAnimation!==t||!1!==e)&&(this._currentTime=0,this._animation=this._animations[t],this.currentAnimation=t,this._animation||(this._animation=this._animations.default,this.currentAnimation="default"),this._texture=this._animation.frames[0].texture,this.anchor=this._animation.frames[0].anchor),this.play()},v.has=function(t){return!!this._animations[t]},v.update=function(t){var e=null,i="",n=0;this._currentTime+=this.animationSpeed*this._animation.speed*t,0>(n=Math.floor(this._currentTime))&&(n=0),n<this._animation.frames.length?(e=this._animation.frames[n%this._animation.frames.length],this._texture=e.texture,this.anchor=e.anchor):n>=this._animation.frames.length&&(i=this._animation.id,this.gotoAndPlay(this._animation.next),this.emit("complete",i))},v.destroy=function(){var t="";if(this.stop(),s.prototype.destroy.call(this),this.cacheId&&(o[this.cacheId].viable-=1,o[this.cacheId].viable<=0)){for(t in o[this.cacheId].textures.recycle(),o[this.cacheId].animations)o[this.cacheId].animations.hasOwnProperty(t)&&o[this.cacheId].animations[t].frames.recycle();delete o[this.cacheId]}},g.preloadBaseTextures=function(t){var e=a,i="";if(t.updateTexture)for(i in e)e.hasOwnProperty(i)&&t.updateTexture(e[i])},g.destroyBaseTextures=function(){var t=a,e="";for(e in t)t.hasOwnProperty(e)&&(t[e].destroy(),delete t[e])},g.EmptySpriteSheet={framerate:60,frames:[],images:[],animations:{},recycleSpriteSheet:function(){}},g.formatSpriteSheet=function(){var t=/([\w-]+)\.(\w+)$/,i=function(t,e,i,n,r){var o="";for(o in t)t.hasOwnProperty(o)&&(e[o]&&(e[o].frames.recycle(),e[o].recycle(),platypus.debug.olive('PIXIAnimation "'+r+'": Overwriting duplicate animation for "'+o+'".')),e[o]=s(o,t[o],i,n))},n=function(t,e){var n=null,s=e.animations,o=e.images,a=e.framerate||60,h=e.frames,l=0,c=Array.setUp(),d=o.length,p=h.length,f=t.animations,g=t.images,v=t.framerate||60,m=t.frames;for(e.id?e.id+=";"+(t.id||t.images.join(",")):e.id=t.id||t.images.join(","),l=0;l<g.length;l++)c.push(r(g[l])),o.push(c[l]);return Array.isArray(m)?function(t,e,i){var n=null,s=0;for(s=0;s<t.length;s++)n=t[s],e.push(Array.setUp(n[0],n[1],n[2],n[3],n[4]+i,n[5],n[6]))}(m,h,d):(function(t,e,i,n){var s=0,r=t.width,o=t.height,a=t.regX||0,h=t.regY||0,l=0,u=0,c=0,d=0;for(s=0;s<n.length;s++)for(l=n[s].realWidth-r,u=n[s].realHeight-o,d=0;u>=d;d+=o)for(c=0;l>=c;c+=r)e.push([c,d,r,o,s+i,a,h])}(m,h,d,n=u(c)),n.recycle()),i(f,s,v/a,p,e.id),c.recycle(),e},s=function(t,i,n,s){var r=0,o=0,a=Array.setUp(),h=0;if("number"==typeof i)return a.push(i+s),e.setUp("frames",a,"next",t,"speed",n);if(Array.isArray(i)){for(o=i[0]||0,h=(i[1]||o)+1+s,r=o+=s;h>r;r++)a.push(r);return e.setUp("frames",a,"next",i[2]||t,"speed",(i[3]||1)*n)}for(r=0;r<i.frames.length;r++)a.push(i.frames[r]+s);return e.setUp("frames",a,"next",i.next||t,"speed",(i.speed||1)*n)},r=function(e){var i=!1;return"string"==typeof e&&(i=e.match(t))?i[1]:e},o=function(){var t=this.animations,e="";for(e in t)t.hasOwnProperty(e)&&t[e].frames.recycle(),t[e].recycle();this.frames.recycle(2),this.images.recycle(),this.recycle()};return function(t){var i=g.EmptySpriteSheet,s=t;if("string"==typeof s&&(s=platypus.game.settings.spriteSheets[t]),s){if(i=e.setUp("animations",e.setUp(),"framerate",60,"frames",Array.setUp(),"id","","images",Array.setUp(),"recycleSpriteSheet",o),Array.isArray(s))return function(t,e){for(var i=t.length,s=null;i--;)"string"==typeof(s=t[i])&&(s=platypus.game.settings.spriteSheets[s]),s&&n(s,e);return e}(s,i);if(s)return n(s,i)}return i}}()}(),platypus.StateMap=function(){"use strict";var t=include("platypus.DataMap"),e=function(e){var i=arguments.length;i?1===i&&"string"==typeof e?(t.call(this),this.updateFromString(e)):t.apply(this,arguments):t.call(this)},i=extend(e,t);return Object.defineProperty(i,"updateFromString",{value:function(t){for(var e=t.greenSplit(","),i=e.length,n="";i--;)(n=e[i])&&("!"===n.substr(0,1)?this.set(n.substr(1),!1):this.set(n,!0));return e.recycle(),this}}),Object.defineProperty(i,"update",{value:function(t){for(var e=t.keys,i=e.length,n="",s=!1,r=!1;i--;)n=e[i],r=t.get(n),this.get(n)!==r&&(this.set(n,r),s=!0);return s}}),Object.defineProperty(i,"includes",{value:function(t){for(var e=t.keys,i=e.length,n="";i--;)if(n=e[i],this.get(n)!==t.get(n))return!1;return!0}}),Object.defineProperty(i,"intersects",{value:function(t){for(var e=t.keys,i=e.length,n="";i--;)if(n=e[i],this.get(n)===t.get(n))return!0;return!1}}),recycle.add(e,!!springroll.Debug,"StateMap",(function(){this.clear(),e.recycle(this)})),e}(),platypus.Component=function(){"use strict";var t=include("platypus.Data"),e=function(){return Array.setUp()},i=function(e,i){this.type=e,this.owner=i,this.publicMethods=t.setUp(),this.listener=t.setUp("events",Array.setUp(),"messages",Array.setUp())},n=i.prototype;return n.toString=function(){return"[Component "+this.type+"]"},n.destroy=function(){var t="";if(this.listener){for(t in this._destroy&&this._destroy(),this.publicMethods)this.publicMethods.hasOwnProperty(t)&&this.removeMethod(t);this.publicMethods.recycle(),this.removeEventListeners(),this.listener.events.recycle(),this.listener.messages.recycle(),this.listener.recycle(),this.listener=null}},n.removeEventListeners=function(t){var e=0,i=null,n=null;if(t)for(e=0;e<t.length;e++)this.removeEventListener(t[e]);else{for(i=this.listener.events,n=this.listener.messages,e=0;e<i.length;e++)this.owner.off(i[e],n[e]);i.length=0,n.length=0}},n.addEventListener=function(t,e,i){var n=e.bind(this);this.listener.events.push(t),this.listener.messages.push(n),this.owner.on(t,n,i)},n.addMethod=function(t,e){this.owner[t]?platypus.debug.warn(this.owner.type+': Entity already has a method called "'+t+'". Method not added.'):(this.owner[t]=function(){return e.apply(this,arguments)}.bind(this),this.publicMethods[t]=e)},n.removeEventListener=function(t,e){var i=0,n=this.listener.events,s=this.listener.messages;for(i=n.length-1;i>=0;i--)n[i]!==t||e&&s[i]!==e||(this.owner.off(t,s[i]),this.listener.events.greenSplice(i),this.listener.messages.greenSplice(i))},n.removeMethod=function(t){this.owner[t]?delete this.owner[t]:platypus.debug.warn(this.owner.type+': Entity does not have a method called "'+t+'".'),delete this.publicMethods[t]},i.getAssetList=e,i.getLateAssetList=e,i}(),platypus.Messenger=function(){"use strict";var t=include("springroll.EventDispatcher"),e=function(){t.call(this),this.loopCheck=Array.setUp()},i=!!springroll.Debug,n=i&&window.performance&&window.performance.mark&&window.performance.measure&&window.performance,s=extend(e,t);return s.toString=function(){return"[Messenger Object]"},s._trigger=s.trigger,s.trigger=function(t,e,i){var n=null,s=0,r=0,o=e;if("string"==typeof t)return this.triggerEvent.apply(this,arguments);if(Array.isArray(t)){for(n=Array.prototype.greenSlice.call(arguments),s=0;s<t.length;s++)n[0]=t[s],r+=this.trigger.apply(this,n);return n.recycle(),r}return t.event?(void 0!==t.message&&(o=t.message),this.triggerEvent(t.event,o,t.debug||i)):(platypus.debug.warn('Event incorrectly formatted: must be string, array, or object containing an "event" property.',t),0)},s.triggerEvent=function(t){var e=0,i=0,n=null,s=this._listeners,r=null;if(!this._destroyed&&s.hasOwnProperty(t)&&s[t]){for(s=s[t].greenSlice(),arguments.length>1&&(r=Array.prototype.greenSlice.call(arguments)).greenSplice(0),e=i=s.length;i--;)(n=s[i])._eventDispatcherOnce&&(delete n._eventDispatcherOnce,this.off(t,n)),n.apply(this,r);r&&r.recycle(),s.recycle()}return e},i&&(s._triggerEvent=s.triggerEvent,s.triggerEvent=function(t,e){var i=0,s=5,r=e&&e.debug,o=0,a=0;if(r||this.debug){for(i=0;i<this.loopCheck.length;i++)if(this.loopCheck[i]===t){if((o+=1)>s)throw"Endless loop detected for '"+t+"'.";platypus.debug.warn("Event '"+t+"' is nested inside another '"+t+"' event.")}return this.loopCheck.push(t),n&&n.mark("a"),a=this._triggerEvent.apply(this,arguments),n&&(n.mark("b"),n.measure(this.type+":"+t,"a","b")),this.loopCheck.length=this.loopCheck.length-1,r&&(a?platypus.debug.olive('Entity "'+this.type+'": Event "'+t+'" has '+a+" subscriber"+(a>1?"s":"")+".",e):platypus.debug.warn('Entity "'+this.type+'": Event "'+t+'" has no subscribers.',e)),a}return this._triggerEvent.apply(this,arguments)}),s.getMessageIds=function(){return Object.keys(this._listeners)},s.eventDispatcherDestroy=s.destroy,s.destroy=function(){this.loopCheck.recycle(),this.eventDispatcherDestroy()},e}(),platypus.Entity=function(){"use strict";var t=include("platypus.Data"),e=include("platypus.StateMap"),i={},n=function(n,s){var r=0,o=null,a=t.setUp(n),h=a.components,l=t.setUp(a.properties),u=t.setUp(s),c=t.setUp(u.properties),d=Array.setUp(),p=Array.setUp();if(platypus.Messenger.call(this),this.components=Array.setUp(),this.type=a.id||"none",this.id=u.id||c.id,this.id||(i[this.type]||(i[this.type]=0),this.id=this.type+"-"+i[this.type],i[this.type]+=1),this.setProperty(l),this.setProperty(c),this.on("set-property",function(t){this.setProperty(t)}.bind(this)),this.state=e.setUp(this.state),this.lastState=e.setUp(),this.trigger=this.triggerEvent=function(t,e){d.push(t),p.push(e)},h)for(r=0;r<h.length;r++)(o=h[r])&&(platypus.components[o.type]?this.addComponent(new platypus.components[o.type](this,o)):platypus.debug.warn('Entity "'+this.type+'": Component "'+o.type+'" is not defined.',o));for(delete this.trigger,delete this.triggerEvent,r=0;r<d.length;r++)this.trigger(d[r],p[r]);d.recycle(),p.recycle(),this.triggerEvent("load"),a.recycle(),l.recycle(),u.recycle(),c.recycle()},s=n.prototype=new platypus.Messenger;return s.toString=function(){return"[Entity "+this.type+"]"},s.addComponent=function(t){return this.components.push(t),this.triggerEvent("component-added",t),t},s.removeComponent=function(t){var e=0;if("string"==typeof t){for(e=0;e<this.components.length;e++)if(this.components[e].type===t)return t=this.components[e],this.components.greenSplice(e),this.triggerEvent("component-removed",t),t.destroy(),t}else for(e=0;e<this.components.length;e++)if(this.components[e]===t)return this.components.greenSplice(e),this.triggerEvent("component-removed",t),t.destroy(),t;return!1},s.setProperty=function(t){var e="";for(e in t)t.hasOwnProperty(e)&&(this[e]=t[e])},s.messengerDestroy=s.destroy,s.destroy=function(){var t=this.components,e=t.length;if(!this._destroyed){for(;e--;)t[e].destroy();t.recycle(),this.state.recycle(),this.state=null,this.lastState.recycle(),this.lastState=null,this.messengerDestroy()}},n.getAssetList=function(t,e){var i=0,s=null,r=null,o=null,a=null;if(t.type)return(a=platypus.game.settings.entities[t.type])?n.getAssetList(a,t.properties):(platypus.debug.warn('Entity "'+t.type+'": This entity is not defined.',t),o);for(o=Array.setUp(),i=0;i<t.components.length;i++)(s=t.components[i]&&t.components[i].type&&platypus.components[t.components[i].type])&&(r=s.getAssetList(t.components[i],t.properties,e),o.union(r),r.recycle());return o},n.getLateAssetList=function(t,e,i){var s=0,r=null,o=null,a=null;if(t.type)return n.getLateAssetList(platypus.game.settings.entities[t.type],e,i);for(a=Array.setUp(),s=0;s<t.components.length;s++)(r=t.components[s]&&t.components[s].type&&platypus.components[t.components[s].type])&&(o=r.getLateAssetList(t.components[s],t.properties,e,i),a.union(o),o.recycle());return a},n}(),platypus.Scene=function(){"use strict";var t=include("platypus.Data"),e=include("platypus.Entity"),i=include("platypus.PIXIAnimation"),n=include("springroll.State"),s=/^(?:\w+:\/{2}\w+(?:\.\w+)*\/?)?(?:[\/.]*?(?:[^?]+)?\/)?(?:([^\/?]+)\.(\w+))(?:\?\S*)?$/,r=function(){var t=function(t,e){for(var i=e.length;i--;)if(e[i].id===t)return!0;return!1};return function(e,i){for(var n=null,s=platypus.game.app.assetManager.cache._cache,r=Array.setUp(),a=e.length;a--;)s[(n=o(e[a])).id]||t(n.id,i)?n.recycle():r.push(n);return r}}(),o=function(e){var i=e.match(s),n=t.setUp("id",e,"src",e);return i?n.id=i[1]:platypus.debug.warn("Scene: A listed asset should provide the entire file path since version 0.9.0."),n},a=function(t){this.app.unload(t),t.recycle()},h=function(){var t=0,e="",n=this.layerDefinitions,s=!0,r=!1,o=null,a=null;for(this.storeMessages=!0,this.storedMessages=Array.setUp(),this.layers=Array.setUp(),t=0;t<n.length;t++){if(r=n[t],o={stage:this.stage,parent:this},r.properties)for(e in r.properties)r.properties.hasOwnProperty(e)&&(o[e]=r.properties[e]);if(r.type&&(r=platypus.game.settings.entities[r.type]),s=!0,r.filter){if(r.filter.includes)for(e in s=!1,r.filter.includes)r.filter.includes.hasOwnProperty(e)&&platypus.supports[r.filter.includes[e]]&&(s=!0);if(r.filter.excludes)for(e in r.filter.excludes)r.filter.excludes.hasOwnProperty(e)&&platypus.supports[r.filter.excludes[e]]&&(s=!1)}s&&this.layers.push(new platypus.Entity(r,{properties:o}))}for(a=this.storedMessages,this.storeMessages=!1,t=0;t<a.length;t++)this.triggerOnChildren(a[t].message,a[t].value);a.recycle(),this.storedMessages=null,platypus.debug.olive("Scene loaded: "+this.id),this.triggerOnChildren("scene-loaded",this.data),i.preloadBaseTextures(this.app.display.renderer)},l=function(t,e){var i=this.getLateAssetList(t);i.length?(e.union(i),this.once("exit",a.bind(this,i))):i.recycle()},u=function(t,e){var i=null;n.call(this,t,e.options),i=this.getAssetList(e),this.id=e.id,this.preload.union(i),this.layerDefinitions=e.layers,this.storeMessages=!1,this.storedMessages=null,this.stage=t,this.layers=null,this.assets=e.assets||null,this.on("loading",l.bind(this,e)),this.on("loaded",h),i.recycle()},c=extend(u,n);return c.enterDone=function(){platypus.game.currentScene=this,platypus.debug.olive("Scene live: "+this.id),this.triggerOnChildren("scene-live",this.data)},c.exitStart=function(){platypus.debug.olive("Scene ending: "+this.id),this.triggerOnChildren("scene-ended",this.data)},c.triggerOnChildren=function(t,e){var i=0;if(this.storeMessages)this.storedMessages.push({message:t,value:e});else for(i=0;i<this.layers.length;i++)this.layers[i].trigger(t,e)},c.getEntityById=function(t){var e=0,i=null;for(e=0;e<this.layers.length;e++){if(this.layers[e].id===t)return this.layers[e];if(this.layers[e].getEntityById&&(i=this.layers[e].getEntityById(t)))return i}return null},c.getEntitiesByType=function(t){var e=0,i=null,n=Array.setUp();for(e=0;e<this.layers.length;e++)this.layers[e].type===t&&n.push(this.layers[e]),this.layers[e].getEntitiesByType&&(i=this.layers[e].getEntitiesByType(t),n.union(i),i.recycle());return n},c.exit=function(){var t=0;for(t=0;t<this.layers.length;t++)this.layers[t].destroy();this.layers.recycle(),this.layers=null,i.destroyBaseTextures(),platypus.game.currentScene=null},c.getAssetList=function(t){var i=0,n=null,s=Array.setUp();for(t.assets&&s.union(t.assets),i=0;i<t.layers.length;i++)n=e.getAssetList(t.layers[i]),s.union(n),n.recycle();return n=r(s,this.preload),s.recycle(),n},c.getLateAssetList=function(t){var i=0,n=null,s=Array.setUp();for(i=0;i<t.layers.length;i++)n=e.getLateAssetList(t.layers[i],null,this.data),s.union(n),n.recycle();return n=r(s,this.preload),s.recycle(),n},u}(),platypus.Game=function(){"use strict";var t=include("PIXI.Container"),e=include("platypus.Scene"),i=include("window.XMLHttpRequest"),n=function(t,e){var n=new i;n.open("GET",t,!0),n.responseType="text",n.onload=function(){var i=null;if(200===n.status)try{i=JSON.parse(n.responseText)}catch(e){platypus.debug.warn('Error parsing "'+t+'": '+e.message)}else platypus.debug.warn('Error opening "'+t+'": '+n.description);e(i)},n.send()},s=function(t,e){var i=0,r="",o=0,a=function(){(o-=1)||e(t)},h=function(t,e,i){s(t[e],(function(n){t[e]=n,i(n)}))};if(t){if(Array.isArray(t)){if(o=t.length)for(i=0;i<t.length;i++)h(t,i,a);else e(t);return}if("object"==typeof t){if(t.src&&t.src.length>5&&".json"===t.src.substring(t.src.length-5).toLowerCase())s(t.src,(function(i){t.src!==i&&(t=i),e(t)}));else{for(r in t)t.hasOwnProperty(r)&&(o+=1);if(o)for(r in t)t.hasOwnProperty(r)&&h(t,r,a);else e(t)}return}if("string"==typeof t&&t.length>5&&".json"===t.substring(t.length-5).toLowerCase())return void n(t,(function(t){"object"==typeof t?s(t,e):e(t)}))}e(t)},r=function(i,n,r){var o=function(i){var n="",s=this.app.states||{};for(n in platypus.game=this,this.currentScene=null,this.settings=i,this.stage=this.app.display.stage,i.scenes)i.scenes.hasOwnProperty(n)&&(s[i.scenes[n].id=i.scenes[n].id||n]=new e(new t,i.scenes[n]));this.app.states||(this.app.states=s),r&&r(this),window.getEntityById=function(t){return this.getEntityById(t)}.bind(this),window.getEntitiesByType=function(t){return this.getEntitiesByType(t)}.bind(this),window.getVisibleSprites=function(t,e){var i=0;if(e=e||Array.setUp(),!(t=t||this.stage).texture&&t.visible){for(i=0;i<t.children.length;i++)window.getVisibleSprites(t.children[i],e);return e}return t.visible?(e.push(t),e):e}.bind(this)}.bind(this);return i?(this.app=n,void("string"==typeof i?s(i,o):o(i))):void platypus.debug.warn("No game definition is supplied. Game not created.")},o=r.prototype;return o.tick=function(t){this.currentScene&&this.currentScene.triggerOnChildren("tick",t)},o.loadScene=function(){var i=function(i,n){var s="",r=null;"string"==typeof i?(this.app.states[i].data=n,this.app.manager.state=i):(s=i.id=i.id||"new-scene",(r=new e(new t,i)).data=n,this.app.manager.addState(s,r),this.stage.addChild(r.panel),this.app.trigger("stateAdded",s,r),this.app.manager.state=s)};return function(t,e){window.setTimeout(i.bind(this,t,e),1)}}(),o.getEntityById=function(t){return this.currentScene?this.currentScene.getEntityById(t):null},o.getEntitiesByType=function(t){return this.currentScene?this.currentScene.getEntitiesByType(t):Array.setUp()},o.destroy=function(){},r}(),platypus.Vector=function(){"use strict";var t=function(t,e,i){this.matrix?(this.matrix[0]=0,this.matrix[1]=0,this.matrix[2]=0):this.matrix=Array.setUp(0,0,0),this.set(t,e,i)},e=t.prototype;return Object.defineProperty(e,"x",{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}}),Object.defineProperty(e,"y",{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}}),Object.defineProperty(e,"z",{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}}),e.toString=function(){return"["+this.matrix.join(",")+"]"},e.set=function(t,e,i){return t&&t.matrix?this.setVector(t,e):t&&Array.isArray(t)?this.setArray(t,e):this.setXYZ(t,e,i)},e.setXYZ=function(t,e,i){var n=this.matrix;return n[0]=t||0,n[1]=e||0,n[2]=i||0,this},e.setVector=function(t,e){return this.setArray(t.matrix,e)},e.setArray=function(t,e){for(var i=e||t.length,n=this.matrix;i--;)n[i]=t[i];return this},e.equals=function(t,e,i){var n=null,s=0,r=this.matrix;if(t&&Array.isArray(t)){for(s=e||t.length;s--;)if(r[s]!==t[s])return!1;return!0}if(t&&t.matrix){for(n=t.matrix,s=e||n.length;s--;)if(r[s]!==n[s])return!1;return!0}return!("number"!=typeof t||r[0]!==t||"number"==typeof e&&r[1]!==e||"number"==typeof i&&r[2]!==i)},e.magnitude=function(t){var e=0,i=0;for(t=t||this.matrix.length,i=0;t>i;i++)e+=Math.pow(this.matrix[i],2);return Math.sqrt(e)},e.getAngle=function(){var t=this.magnitude(2),e=0;return 0!==t&&(e=Math.acos(this.x/t),this.y<0&&(e=2*Math.PI-e)),e},e.getUnit=function(){return platypus.Vector.setUp(this).normalize()},e.getInverse=function(){return platypus.Vector.setUp(this).multiply(-1)},e.normalize=function(){var t=this.magnitude();return 0===t?this:this.multiply(1/t)},e.cross=function(){var t=function(t,e,i,n){return t*n-e*i};return function(e){var i=t(this.y,this.z,e.y,e.z),n=-t(this.x,this.z,e.x,e.z),s=t(this.x,this.y,e.x,e.y);return this.x=i,this.y=n,this.z=s,this}}(),e.getCrossProduct=function(t){return platypus.Vector.setUp(this).cross(t)},e.rotate=function(t,e){var i,n,s,r=e,o=null,a=Math.cos(t),h=Math.sin(t),l=1-a,u=platypus.Vector.setUp();return r?"x"===r?r=u.setXYZ(1,0,0):"y"===r?r=u.setXYZ(0,1,0):"z"===r&&(r=u.setXYZ(0,0,1)):r=u.setXYZ(0,0,1),i=r.x,n=r.y,s=r.z,o=Array.setUp(Array.setUp(a+i*i*l,i*n*l-s*h,i*s*l+n*h),Array.setUp(n*i*l+s*h,a+n*n*l,n*s*l-i*h),Array.setUp(s*i*l-n*h,s*n*l+i*h,a+s*s*l)),this.multiply(o),u.recycle(),o.recycle(2),this},e.multiply=function(t,e){var i=0,n=0,s=null,r=0;if(Array.isArray(t)){for(s=this.matrix.greenSlice(),r=e||t.length,i=0;r>i;i++)for(this.matrix[i]=0,n=0;r>n;n++)this.matrix[i]+=s[n]*t[i][n];s.recycle()}else for(r=e||this.matrix.length,i=0;r>i;i++)this.matrix[i]*=t;return this},e.add=function(e,i,n){var s=e,r=0,o=0;for(Array.isArray(s)?r=i||this.matrix.length:s instanceof t?(s=s.matrix,r=i||this.matrix.length):(s=[e||0,i||0,n||0],r=this.matrix.length),o=0;r>o;o++)this.matrix[o]+=s[o];return this},e.addVector=function(t,e){return this.add(t,e)},e.subtractVector=function(t,e){return this.add(t.getInverse(),e)},e.scale=function(t,e){return this.multiply(t,e)},e.dot=function(t,e){var i=0,n=0,s=this.matrix,r=t.matrix;for(n=e||s.length;n--;)i+=s[n]*(r[n]||0);return i},e.angleTo=function(t){var e=this.getUnit(),i=t.getUnit(),n=0;return e.magnitude()&&i.magnitude()?n=Math.acos(e.dot(i)):(platypus.debug.warn("Vector: Attempted to find the angle of a zero-length vector."),n=NaN),e.recycle(),i.recycle(),n},e.signedAngleTo=function(t,e){var i,n=this.getUnit(),s=t.getUnit(),r=n.getCrossProduct(s);return i=r.dot(e)<0?-Math.acos(n.dot(s)):Math.acos(n.dot(s)),n.recycle(),s.recycle(),r.recycle(),i},e.scalarProjection=function(e){var i=null,n=0;return"number"==typeof e?this.magnitude(2)*Math.cos(e):(i=t.setUp(e).normalize(),n=this.dot(i),i.recycle(),n)},e.copy=function(){return platypus.Vector.setUp(this)},t.assign=function(){var t=function(t,e,i,n){var s=null,r=!1;"string"==typeof t&&void 0!==e[t]&&(s=e[t],delete e[t],r=!0),Object.defineProperty(e,t,{get:function(){return i.matrix[n]},set:function(t){i.matrix[n]=t},enumerable:!0}),r&&(e[t]=s)};return function(e,i){var n=0;if(e&&i){if(!e[i]){for(e[i]=platypus.Vector.setUp(),n=2;n<arguments.length;n++)arguments[n]!==i&&t(arguments[n],e,e[i],n-2);return null}return e[i]}return null}}(),recycle.add(t,!!springroll.Debug,"Vector",(function(){this.matrix.length=0,t.recycle(this)})),t}(),platypus.AABB=function(){"use strict";var t=function(e,i,n,s){e instanceof t?this.set(e):(this.empty=!0,this.setAll(e,i,n,s))},e=t.prototype;return e.setAll=function(t,e,i,n){return this.empty=!1,this.x=t,this.y=e,this.resize(i,n),this},e.setBounds=function(t,e,i,n){return this.empty=!1,this.x=(i+t)/2,this.y=(e+n)/2,this.resize(i-t,n-e),this},e.set=function(t){return this.empty=t.empty,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this},e.reset=function(){return this.empty=!0,this},e.resize=function(t,e){var i=t||0,n=e||0,s=i/2,r=n/2;return this.width=i,this.height=n,this.halfWidth=s,this.halfHeight=r,"number"==typeof this.x?(this.left=-s+this.x,this.right=s+this.x):this.empty=!0,"number"==typeof this.y?(this.top=-r+this.y,this.bottom=r+this.y):this.empty=!0,this},e.include=function(t){return this.empty?this.set(t):(this.left>t.left&&(this.left=t.left),this.right<t.right&&(this.right=t.right),this.top>t.top&&(this.top=t.top),this.bottom<t.bottom&&(this.bottom=t.bottom),this.width=this.right-this.left,this.height=this.bottom-this.top,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.x=this.left+this.halfWidth,this.y=this.top+this.halfHeight),this},e.move=function(t,e){return this.moveX(t),this.moveY(e),this},e.moveX=function(t){return this.x=t,this.left=-this.halfWidth+t,this.right=this.halfWidth+t,this},e.moveY=function(t){return this.y=t,this.top=-this.halfHeight+t,this.bottom=this.halfHeight+t,this},e.moveXBy=function(t){return this.moveX(this.x+t)},e.moveYBy=function(t){return this.moveY(this.y+t)},e.equals=function(t){return!this.empty&&!t.empty&&this.left===t.left&&this.top===t.top&&this.right===t.right&&this.bottom===t.bottom},e.contains=function(t){return t.top>=this.top&&t.bottom<=this.bottom&&t.left>=this.left&&t.right<=this.right},e.containsVector=function(t){return this.containsPoint(t.x,t.y)},e.containsPoint=function(t,e){return e>=this.top&&e<=this.bottom&&t>=this.left&&t<=this.right},e.collides=function(t){return t.bottom>this.top&&t.top<this.bottom&&t.right>this.left&&t.left<this.right},e.intersects=function(t){return t.bottom>=this.top&&t.top<=this.bottom&&t.right>=this.left&&t.left<=this.right},e.getIntersectionArea=function(t){var e=Math.max,i=Math.min;return this.intersects(t)?(i(this.bottom,t.bottom)-e(this.top,t.top))*(i(this.right,t.right)-e(this.left,t.left)):0},recycle.add(t,!!springroll.Debug,"AABB"),t}(),platypus.ActionState=function(){"use strict";var t=include("platypus.Data"),e=include("platypus.StateMap"),i=function(i,n,s){this.event=i,this.trigger=s,this.active=!1,this.wasActive=!1,this.valid=!0,this.wasValid=!0,this.states=e.setUp(n),this.inputs=Array.setUp(),this.stateSummary=t.setUp("pressed",!1,"released",!1,"triggered",!1)},n=function(t){return t},s=i.prototype;return s.update=function(t){var e=this.stateSummary;return this.valid=t.includes(this.states),this.active=this.inputs.some(n),e.pressed=this.valid&&this.active,e.released=this.wasActive&&(!this.valid&&this.wasValid||this.valid&&!this.active),e.triggered=this.valid&&this.active&&!this.wasActive,this.wasValid=this.valid,this.wasActive=this.active,e.pressed||e.released||e.triggered},s.resolve=function(){this.trigger(this.event,this.stateSummary)},recycle.add(i,!!springroll.Debug,"ActionState",(function(){this.states.recycle(),this.stateSummary.recycle(),this.inputs.recycle(),i.recycle(this)})),i}(),platypus.CollisionData=function(){"use strict";var t=include("platypus.Vector"),e=function(i){this.vector||(this.vector=t.setUp()),i instanceof e?this.copy(i):this.set.apply(this,arguments)},i=e.prototype;return i.set=function(t,e,i,n,s,r,o,a,h){this.occurred=t||!1,this.direction=e||null,this.position=i||null,this.deltaMovement=n||null,this.aABB=s||null,this.thisShape=r||null,this.thatShape=o||null,this.vector.set(a),this.stuck=h||0},i.copy=function(t){this.occurred=t.occurred,this.direction=t.direction,this.position=t.position,this.deltaMovement=t.deltaMovement,this.aABB=t.aABB,this.thisShape=t.thisShape,this.thatShape=t.thatShape,this.vector.setVector(t.vector),this.stuck=t.stuck},recycle.add(e,!!springroll.Debug,"CollisionData"),e}(),platypus.CollisionDataContainer=function(){"use strict";var t=function(){this.xData||this.yData?this.reset():(this.xData=Array.setUp(),this.yData=Array.setUp(),this.xDeltaMovement=1/0,this.yDeltaMovement=1/0)},e=t.prototype;return e.getXEntry=function(t){return this.xData[t]},e.getYEntry=function(t){return this.yData[t]},e.tryToAddX=function(t){return!(t.deltaMovement>this.xDeltaMovement)&&(t.deltaMovement<this.xDeltaMovement&&this.resetX(t.deltaMovement),this.xData.push(t),!0)},e.tryToAddY=function(t){return!(t.deltaMovement>this.yDeltaMovement)&&(t.deltaMovement<this.yDeltaMovement&&this.resetY(t.deltaMovement),this.yData.push(t),!0)},e.reset=function(){this.resetX(1/0),this.resetY(1/0)},e.resetX=function(t){for(var e=this.xData,i=e.length;i--;)e[i].recycle();e.length=0,this.xDeltaMovement=t},e.resetY=function(t){for(var e=this.yData,i=e.length;i--;)e[i].recycle();e.length=0,this.yDeltaMovement=t},recycle.add(t,!!springroll.Debug,"CollisionDataContainer"),t}(),platypus.CollisionShape=function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.Vector"),i=function(t,e){var i=e.aABB,n=i.halfHeight,s=i.halfWidth,r=Math.abs,o=Math.pow,a=r(t.x-e.x),h=r(t.y-e.y),l=t.radius;return s>a||n>h||s+l>a&&n+l>h&&o(a-s,2)+o(h-n,2)<o(l,2)},n=function(t){var e=Math.pow;return this.aABB.collides(t.aABB)&&("rectangle"===t.type&&i(this,t)||"circle"===t.type&&e(this.x-t.x,2)+e(this.y-t.y,2)<=e(this.radius+t.radius,2))},s=function(){return!1},r=function(t){return this.aABB.collides(t.aABB)&&("rectangle"===t.type||"circle"===t.type&&i(t,this))},o=function(i,o,a){var h=o.regX,l=o.regY,u=o.width||2*o.radius||0,c=o.height||2*o.radius||0,d=o.radius||0,p=o.type||"rectangle";this.initialized||(this.initialized=!0,e.assign(this,"offset","offsetX","offsetY"),e.assign(this,"position","x","y"),e.assign(this,"size","width","height"),this.aABB=t.setUp()),this.owner=i,this.collisionType=a,this.type=p,this.subType="","circle"===p?(u=c=2*d,this.collides=n):this.collides="rectangle"===p?r:s,this.size.setXYZ(u,c),this.radius=d,"number"!=typeof h&&(h=u/2),"number"!=typeof l&&(l=c/2),this.offset.setXYZ(o.offsetX||u/2-h,o.offsetY||c/2-l),i?this.position.setXYZ(i.x,i.y).add(this.offset):this.position.setXYZ(o.x,o.y).add(this.offset),this.aABB.setAll(this.x,this.y,u,c)},a=o.prototype;return a.update=function(t,e){var i=t+this.offsetX,n=e+this.offsetY;this.position.setXYZ(i,n),this.aABB.move(i,n)},a.moveX=function(t){this.x=t,this.aABB.moveX(t)},a.moveY=function(t){this.y=t,this.aABB.moveY(t)},a.getAABB=function(){return this.aABB},a.setXWithEntityX=function(t){this.x=t+this.offsetX,this.aABB.moveX(this.x)},a.setYWithEntityY=function(t){this.y=t+this.offsetY,this.aABB.moveY(this.y)},a.multiply=function(t){var e=this.position,i=this.owner.position;e.subtractVector(i),e.multiply(t),this.offset.multiply(t),this.size.multiply(t),e.addVector(i),this.width=Math.abs(this.width),this.height=Math.abs(this.height),this.aABB.setAll(this.x,this.y,this.width,this.height)},recycle.add(o,!!springroll.Debug,"CollisionShape"),o}(),function(){"use strict";var t=include("platypus.Component"),e="",i=0,n=function(t,e,i){Object.defineProperty(e,t,{get:function(){return i[t]},set:function(e){i[t]=e},enumerable:!0})},s=function(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}};platypus.components={},platypus.createComponentClass=function(r,o){var a=function(e,s){var a="",h="",l="",u="";if(t.call(this,r.id,e),o&&o.call(this),r.properties)for(a in r.properties)r.properties.hasOwnProperty(a)&&(void 0!==s[a]?this[a]=s[a]:void 0!==this.owner[a]?this[a]=this.owner[a]:this[a]=r.properties[a]);if(r.publicProperties)for(a in r.publicProperties)r.publicProperties.hasOwnProperty(a)&&(n(a,this,e),void 0!==s[a]?this[a]=s[a]:void 0!==this.owner[a]?this[a]=this.owner[a]:this[a]=r.publicProperties[a]);if(r.events)for(h in i-=1,r.events)if(r.events.hasOwnProperty(h)&&(this.addEventListener(h,r.events[h],i),s.aliases))for(u in s.aliases)s.aliases.hasOwnProperty(u)&&s.aliases[u]===h&&this.addEventListener(u,r.events[h],i);if(r.publicMethods)for(h in r.publicMethods)if(r.publicMethods.hasOwnProperty(h)){if(l=h,s.aliases)for(u in s.aliases)s.aliases.hasOwnProperty(u)&&s.aliases[u]===h&&(l=u);this.addMethod(l,r.publicMethods[h])}this.constructor&&this.constructor(s)},h=null,l=a.prototype;if(o)for(e in l=extend(a,o),t.prototype)l[e]?l[e]=s(l[e],t.prototype[e]):l[e]=t.prototype[e];else l=extend(a,t);if(l.constructor=r.constructor,r.methods)for(h in r.methods)r.methods.hasOwnProperty(h)&&("destroy"===h?l._destroy=r.methods[h]:l[h]=r.methods[h]);if(r.publicMethods)for(h in r.publicMethods)r.publicMethods.hasOwnProperty(h)&&(l[h]=r.publicMethods[h]);return a.getAssetList=r.getAssetList||t.getAssetList,a.getLateAssetList=r.getLateAssetList||t.getLateAssetList,platypus.components[r.id]=a,a}}(),function(){"use strict";var t=include("springroll.Application"),e=include("springroll.ApplicationPlugin"),i=null,n=new e,s=null,r=function(){var e=function(t,e){return Math.floor(204*t/e)},i=function(t,i){var n,s=0,r=0,o=0,a=0,h=null;return i&&(h=i.greenSplit(".")),i&&3===h.length?(r=parseInt(h[0],10),o=parseInt(h[1],10),a=parseInt(h[2],10)):(r=t.charCodeAt(0)||0,o=t.charCodeAt(1)||0,a=t.charCodeAt(2)||0,r-=s=Math.min(r,o,a),o-=s,a-=s),h&&h.recycle(),n=Math.max(r,o,a,1),"color: #ffffff; padding:3px 0; border-radius: 6px; background: rgb("+e(r,n)+","+e(o,n)+","+e(a,n)+");"},n=function(t,e,n){var s=0,r="",o=Array.setUp(t,i(e,e.substr(e.lastIndexOf(" ")-e.length+1)),"");for(s=0;s<n.length;s++)r=n[s],o.push(i(r,r.substr(r.lastIndexOf(" ")-r.length+1)),"");return o};return function(e,i){var s=window.createjs,r=i.options,o=r.author?"by "+r.author:"",a=window.PIXI,h=i.name||document.title||"",l="Platypus "+platypus.version,u=r.version||"(?)",c=Array.setUp(),d=Array.setUp();r.hideHello||(c=Array.setUp("SpringRoll "+t.version),a&&c.push("Pixi.js "+a.VERSION),s&&(s.EaselJS&&c.push("EaselJS "+s.EaselJS.version),s.PreloadJS&&c.push("PreloadJS "+s.PreloadJS.version),s.SoundJS&&c.push("SoundJS "+s.SoundJS.version),s.TweenJS&&c.push("TweenJS "+s.TweenJS.version)),"(?)"!==u&&(h+=" "+u),platypus.supports.firefox||platypus.supports.chrome?(c.push(l),d=n("\n%c "+h+" %c "+o+" \n\nUsing %c "+c.join(" %c %c ")+" %c\n\n",h,c),console.log.apply(console,d),d.recycle()):console.log('--- "'+h+'" '+o+" - Using "+c.join(", ")+", and "+l+" ---"),c.recycle()),platypus.debug.olive("Game config loaded.",e)}}(),o=function(t){var e=null,i=null,n=null,s={};for(e in t)if(t[e].id)s[e]=t[e];else for(n in i=o(t[e]))i.hasOwnProperty(n)&&(s[n]=i[n]);return s};window.PIXI&&(window.PIXI.utils._saidHello=!0),n.setup=function(){var t="",e=document.getElementsByName("author"),i=this.options;e.length&&(t=e[0].getAttribute("content")||""),i.add("author",t,!0),i.add("hideHello",!1,!0)},n.preload=function(t){var e=this.config.platypus||this.config,n=null,a={delta:0};e?(this.options.debug&&(e.debug=!0),r(e,this),e.entities=o(e.entities),e.spriteSheets&&function(t){var e="";for(e in t)t.hasOwnProperty(e)&&(t[e].id=e)}(e.spriteSheets),n=this.platypus=new platypus.Game(e,this),i=function(t){a.delta=t,n.tick(a)},this.on("update",i,320),s=function(t){n.currentScene&&n.currentScene.triggerOnChildren("resize",t)},this.on("resize",s)):platypus.debug.warn("PlatypusPlugin: Platypus requires a game configuration."),t()},n.teardown=function(){this.platypus&&(this.off("update",i),this.off("resize",s),this.platypus.destroy(),delete this.platypus)}}(),function(){"use strict";return platypus.createComponentClass({id:"EventRender",properties:{animationMap:null,component:null,restart:!0},constructor:(t=function(t,e){this.owner.triggerEvent("play-animation",t,e)},e=function(t,e){this.playAnimation(t,e)},function(){var i="",n=this.animationMap;for(i in n)n.hasOwnProperty(i)&&(this.component?this.addEventListener(i,e.bind(this.component,n[i],this.restart)):this.addEventListener(i,t.bind(this,n[i],this.restart)))})});var t,e}(),function(){"use strict";var t=include("platypus.AABB"),e=include("PIXI.Circle"),i=include("platypus.Data"),n=include("PIXI.Rectangle");platypus.createComponentClass({id:"Interactive",properties:{container:null,hitArea:null,hover:!1,relativeToSelf:!1},publicProperties:{buttonMode:!1},constructor:function(){this.pressed=!1,this.camera=t.setUp(),this.hitArea&&(this.container.hitArea=this.setHitArea(this.hitArea))},events:{"camera-update":function(t){this.camera.set(t.viewport)},"handle-render":function(){this.buttonMode!==this.container.buttonMode&&(this.container.buttonMode=this.buttonMode)},"dispatch-event":function(t){this.sprite.dispatchEvent(this.sprite,t.event,t.data)},"input-on":function(){this.removeInputListeners||this.addInputs()},"input-off":function(){this.removeInputListeners&&this.removeInputListeners()}},methods:{addInputs:function(){var t=function(t,e){var n=this.camera,s=this.container,r=null,o=null;s&&e.data.originalEvent&&(o=this.relativeToSelf?s.transformMatrix:s.parent.transformMatrix,r=i.setUp("event",e.data.originalEvent,"pixiEvent",e,"x",e.data.global.x/o.a+n.left,"y",e.data.global.y/o.d+n.top,"entity",this.owner),this.owner.trigger(t,r),r.recycle())},e=function(e,i){this.pressed||(t.call(this,e,i),i.target.mouseTarget=!0,this.pressed=!0)},n=function(e,i,n){this.pressed?(t.call(this,e,n),n.target.mouseTarget=!0):t.call(this,i,n)},s=function(e,i){this.pressed&&(t.call(this,e,i),i.target.mouseTarget=!1,this.pressed=!1,i.target.removeDisplayObject&&i.target.removeDisplayObject())},r=function(t,e,i,n,s,r,o){t.removeListener("mousedown",e),t.removeListener("touchstart",e),t.removeListener("mouseup",i),t.removeListener("touchend",i),t.removeListener("mouseupoutside",i),t.removeListener("touchendoutside",i),t.removeListener("mousemove",n),t.removeListener("touchmove",n),t.removeListener("click",s),t.removeListener("tap",s),this.hover&&(t.removeListener("mouseover",r),t.removeListener("mouseout",o)),t.interactive=!1,this.removeInputListeners=null};return function(){var i,o,a,h,l=this.container,u=null,c=null;l.interactive=!0,i=e.bind(this,"mousedown"),o=n.bind(this,"pressmove","mousemove"),a=s.bind(this,"pressup"),h=t.bind(this,"click"),l.addListener("mousedown",i),l.addListener("touchstart",i),l.addListener("mouseup",a),l.addListener("touchend",a),l.addListener("mouseupoutside",a),l.addListener("touchendoutside",a),l.addListener("mousemove",o),l.addListener("touchmove",o),l.addListener("click",h),l.addListener("tap",h),this.hover&&(u=t.bind(this,"mouseover"),c=t.bind(this,"mouseout"),l.addListener("mouseover",u),l.addListener("mouseout",c)),this.removeInputListeners=r.bind(this,l,i,a,o,h,u,c)}}(),setHitArea:function(){var t={};return function(i){var s,r=null;return s=JSON.stringify(i),(r=t[s])||(r=i.radius?new e(i.x||0,i.y||0,i.radius):new n(i.x||0,i.y||0,i.width||this.owner.width||0,i.height||this.owner.height||0),t[s]=r),r}}(),destroy:function(){var t=function(){this.container.parent.removeChild(this.container),this.container=null};return function(){this.removeInputListeners&&this.removeInputListeners(),this.camera.recycle(),this.container.mouseTarget&&this.container.parent&&(this.container.visible=!1,this.container.removeDisplayObject=t.bind(this))}}()},publicMethods:{}})}(),function(){"use strict";var t=include("platypus.StateMap"),e=function(t){return t},i=function(t,e,i){return!!i.includes(e)&&t},n=function(n,s){return"default"===n?e.bind(null,s):i.bind(null,s,t.setUp(n))};platypus.createComponentClass({id:"StateRender",properties:{animationMap:null,component:null,forcePlayThrough:!1},constructor:function(){var t="",e="",i=this.animationMap;for(t in this.followThroughs={},this.checkStates=Array.setUp(),this.state=this.owner.state,this.stateChange=!0,this.lastState=-1,i)i.hasOwnProperty(t)&&("!"===(e=i[t])[e.length-1]?(e=e.substring(0,e.length-1),this.followThroughs[e]=!0):this.followThroughs[e]=!1,this.checkStates.push(n(t,e)));this.waitingAnimation=!1,this.waitingState=0,this.playWaiting=!1,this.animationFinished=!1},events:{"state-changed":function(){this.stateChange=!0},"animation-ended":function(t){t===this.currentAnimation&&(this.waitingAnimation?(this.currentAnimation=this.waitingAnimation,this.waitingAnimation=!1,this.lastState=this.waitingState,this.animationFinished=!1,this.owner.triggerEvent("play-animation",this.currentAnimation)):this.animationFinished=!0)},"update-animation":function(t){var e=0,i=!1;if(this.stateChange){if(this.state.has("visible")&&(this.visible=this.state.get("visible")),this.checkStates)for(e=0;e<this.checkStates.length;e++)if(i=this.checkStates[e](this.state)){this.currentAnimation!==i?!this.followThroughs[this.currentAnimation]&&(!this.forcePlaythrough||this.animationFinished||this.lastState>=+e)?(this.currentAnimation=i,this.lastState=+e,this.animationFinished=!1,t?this.owner.triggerEvent("play-animation",this.currentAnimation):this.owner.triggerEvent("stop-animation",this.currentAnimation)):(this.waitingAnimation=i,this.waitingState=+e):this.waitingAnimation&&!this.followThroughs[this.currentAnimation]&&(this.waitingAnimation=!1);break}this.stateChange=!1}}},methods:{destroy:function(){this.checkStates.recycle(),this.followThroughs=null,this.state=null}},publicMethods:{}})}(),function(){"use strict";var t=include("platypus.Vector");platypus.createComponentClass({id:"AIChaser",properties:{accelerate:!1,chasing:!0},publicProperties:{speed:.3},constructor:function(){this.target=this.owner.target||null,this.offset=t.setUp(0,0),this.state=this.owner.state,this.state.set("chasing",!1)},events:{load:function(){return this.owner.addMover?void(this.direction=this.owner.addMover({vector:[this.speed,0,0],event:"chase",accelerator:this.accelerate}).vector):void platypus.debug.warn('The "AIChaser" component requires a "Mover" component to function correctly.')},"handle-ai":function(){var e=null,i=!1;this.target&&this.chasing&&((e=t.setUp(this.offset).add(this.target.position).subtractVector(this.owner.position)).magnitude(2)&&(i=!0,this.direction.setVector(e).normalize().multiply(this.speed)),e.recycle()),i!==this.state.get("chasing")&&(this.state.set("chasing",i),this.owner.triggerEvent("chase",i))},"set-target":function(t){this.target=t,this.offset.x=0,this.offset.y=0},"set-target-offset":function(t){this.offset.x=t.x,this.offset.y=t.y},"start-chasing":function(t){t&&(this.target=t),this.chasing=!0},"stop-chasing":function(){this.chasing=!1}},methods:{destroy:function(){this.target=null,this.offset.recycle(),this.state=null}}})}(),function(){"use strict";platypus.createComponentClass({id:"AIPacer",properties:{movement:"both",direction:null},constructor:function(){this.lastDirection="",this.currentDirection=this.direction||("horizontal"===this.movement?"left":"up")},events:{"handle-ai":function(){this.currentDirection!==this.lastDirection&&(this.lastDirection=this.currentDirection,this.owner.triggerEvent("stop"),this.owner.triggerEvent("go-"+this.currentDirection))},"turn-around":function(t){("both"===this.movement||"horizontal"===this.movement)&&(t.x>0?this.currentDirection="left":t.x<0&&(this.currentDirection="right")),("both"===this.movement||"vertical"===this.movement)&&(t.y>0?this.currentDirection="up":t.y<0&&(this.currentDirection="down"))}}})}(),function(){"use strict";var t=include("platypus.Data"),e=include("platypus.StateMap"),i={interrupt:createjs.Sound.INTERRUPT_ANY,delay:0,offset:0,loop:0,volume:1,pan:0,mute:!1,paused:!1},n=function(e){var n="",s=null,r=function(t){t.audio&&this.onComplete(t.audio),t.recycle()};return"string"==typeof e?(n=e,s={}):(n=e.sound,s={interrupt:e.interrupt,delay:e.delay,offset:e.offset,loop:e.loop,volume:e.volume,pan:e.pan,startTime:e.startTime,duration:e.duration,mute:e.mute,paused:e.paused}),function(e){var o=null;e=e||s,(o=t.setUp("interrupt",e.interrupt||s.interrupt||i.interrupt,"delay",e.delay||s.delay||i.delay,"loop",e.loop||s.loop||i.loop,"offset",e.offset||s.offset||i.offset,"volume",void 0!==e.volume?e.volume:void 0!==s.volume?s.volume:i.volume,"pan",e.pan||s.pan||i.pan,"mute",e.mute||s.mute||i.mute,"paused",e.paused||s.paused||i.paused)).complete=r.bind(this,o),o.audio=this.player.play(n,o),o.audio&&(o.audio.soundId=n,this.activeAudioClips.push(o.audio))}},s=function(t,e,i,n){var s=n.includes(t.states);s!==t.playing&&(s?i():this.stopAudio(e,this.forcePlaythrough),t.playing=s)};platypus.createComponentClass({id:"AudioSFX",properties:{audioMap:null,forcePlayThrough:!0,eventBased:!0,stateBased:!1},constructor:function(t){var e="",i=null,s=null;if(this.activeAudioClips=Array.setUp(),this.state=this.owner.state,this.stateChange=!1,this.player=platypus.game.app.sound,t.audioMap)for(e in this.stateBased&&(this.checkStates=Array.setUp()),t.audioMap)t.audioMap.hasOwnProperty(e)&&(s=t.audioMap[e],i=n(s),s.sound&&(s=s.sound),this.eventBased&&this.addEventListener(e,i),this.stateBased&&this.addStateCheck(e,s,i));this.paused=!1},events:{"handle-render":function(){var t=0,e=null,i=this.state;if(!this.paused&&this.stateBased&&this.stateChange){for(t=(e=this.checkStates).length;t--;)e[t].check(i);this.stateChange=!1}},"state-changed":function(){this.stateChange=!0},"toggle-mute":function(t){this.handleClip(t,(function(t){t&&(t.unmuted?(t.volume=t.unmuted,delete t.unmuted):(t.unmuted=t.volume,t.volume=0))}))},"stop-audio":function(t){t?"string"==typeof t?this.stopAudio(t):this.stopAudio(t.audioId||!1,t.playthrough||!1):this.stopAudio()},"mute-audio":function(t){this.handleClip(t,(function(t){t&&(t.unmuted=t.volume,t.volume=0)}))},"unmute-audio":function(t){this.handleClip(t,(function(t){t&&(t.volume=t.unmuted,delete t.unmuted)}))},"pause-audio":function(t){this.handleClip(t,(function(t){t&&t.pause()}))},"unpause-audio":function(t){this.handleClip(t,(function(t){t&&t.unpause()}))},"set-volume":function(t){var e=0,i=function(t){t.volume=e};"number"==typeof t?(e=t,this.getAllClips(i)):t.volume&&(e=t.volume,this.handleClip(t.soundId,i))}},methods:{handleClip:function(t,e){"string"==typeof t?this.getClipById(t,e):this.getAllClips(e)},getClipById:function(t,e){var i=0,n=this.activeAudioClips;for(i=0;i<n.length;i++)if(n[i].soundId===t)return e&&e(n[i]),n[i];return e&&e(null),null},getAllClips:function(t){var e=0,i=this.activeAudioClips;if(t)for(e=0;e<i.length;e++)t(i[e]);return i},stopAudio:function(){var t=function(t){this.stopAudioInstance(t.currentTarget)};return function(e,i){var n=this.activeAudioClips,s=null,r=n.length;if(e)for(s=t.bind(this);r--;)n[r].soundId===e&&(i?n[r].addEventListener("loop",s):(n[r].stop(),n.greenSplice(r)));else if(i)for(s=t.bind(this);r--;)n[r].addEventListener("loop",s);else{for(;r--;)n[r].stop();n.length=0}}}(),stopAudioInstance:function(t){var e=this.activeAudioClips,i=e.indexOf(t);i>=0&&e.greenSplice(i).stop()},onComplete:function(t){this.owner.destroyed||(this.removeClip(t.audio),this.owner.triggerEvent("clip-complete"))},removeClip:function(t){var e=this.activeAudioClips.indexOf(t);e>=0&&this.activeAudioClips.greenSplice(e)},addStateCheck:function(i,n,r){var o=e.setUp(i),a=t.setUp("states",o,"playing",!1);a.check=s.bind(this,a,n,r.bind(this)),this.checkStates.push(a)},destroy:function(){var t=this.checkStates,e=null,i=0;if(this.stopAudio(),this.activeAudioClips.recycle(),this.state=null,t){for(i=t.length;i--;)(e=t[i]).states.recycle(),e.recycle();t.recycle(),this.checkStates=null}}}})}(),function(){"use strict";var t=include("platypus.Data"),e=function(t,e){return t.time-e.time},i=function(i,n){var s=0;for(s=0;s<i.length;s++)n.push(t.setUp("event",i[s].event,"time",i[s].time||0,"message",i[s].message));return s&&n.sort(e),n},n=function(i,n,s){var r=0,o=s.getElapsed();for(r=0;r<i.length;r++)n.push(t.setUp("event",i[r].event,"time",(i[r].time||0)+o,"message",i[r].message||null));r&&n.sort(e)},s=function(t,e,i){var s=0,r=Array.setUp();for(s=0;s<t.length;s++)t[s].sound?(t[s].events&&r.push(n.bind(this,t[s].events,e,i)),r.push(t[s].sound)):r.push(t[s]);return r},r=function(t,e){this.playingAudio=!1,this.owner.destroyed||(this.checkTimeEvents(!0),this.owner.triggerEvent("sequence-complete")),e.recycle()},o=function(t,e){var n=null,o=Array.setUp(),a=this.player;"string"==typeof t?n=Array.setUp(t):Array.isArray(t)?n=s(t,o,a):(t.events&&i(t.events,o),n=Array.isArray(t.sound)?s(t.sound,o,a):Array.setUp(t.sound)),e&&e.events&&i(e.events,o),a.play(n,r.bind(this,!0,n),r.bind(this,!1,n)),this.eventList.recycle(),this.eventList=o,this.playingAudio=!0};platypus.createComponentClass({id:"AudioVO",properties:{audioMap:null},constructor:function(){var t="";if(this.eventList=Array.setUp(),this.playingAudio=!1,this.player=platypus.game.app.voPlayer,this.audioMap)for(t in this.audioMap)this.audioMap.hasOwnProperty(t)&&this.addEventListener(t,o.bind(this,this.audioMap[t]));this.paused=!1},events:{"handle-render":function(){this.paused||this.checkTimeEvents(!1)},"stop-audio":function(){this.player.stop()}},methods:{checkTimeEvents:function(t){var e=null,i=this.eventList,n=0,s=this.owner;if(i&&i.length)for(n=this.player.getElapsed();i.length&&(t||i[0].time<=n);)e=i.greenSplice(0),s.trigger(e.event,e.message),e.recycle()},destroy:function(){this.playingAudio&&this.player.stop(),this.eventList.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.Data"),i=include("platypus.Vector"),n=function(e,i,n,s){var r=t.setUp(s.x+i,s.y+n,s.width,s.height),o=e.x,a=e.y;return r.top<e.top?a-=e.top-r.top:r.bottom>e.bottom&&(a+=e.bottom-r.bottom),r.left<e.left?o-=e.left-r.left:r.right>e.right&&(o+=e.right-r.right),r.recycle(),this.move(o,a,0)},s=function(){return!1};platypus.createComponentClass({id:"Camera",properties:{width:0,height:0,mode:"static",overflow:!1,stretch:!1,threshold:1,rotate:!1,x:0,y:0},publicProperties:{canvas:null,transitionX:400,transitionY:600,transitionAngle:600},constructor:function(i){var n=t.setUp(this.x,this.y,this.width,this.height),s=e.setUp("viewport",n,"orientation",i.orientation||0);this.viewport=t.setUp(0,0,0,0),this.worldCamera=s,this.worldDimensions=t.setUp(),this.message=e.setUp("viewport",t.setUp(),"scaleX",0,"scaleY",0,"orientation",0,"stationary",!1,"world",this.worldDimensions),this.cameraLoadedMessage=e.setUp("viewport",this.message.viewport,"world",this.worldDimensions),this.worldIsLoaded=!1,this.following=null,this.state="static","pan"===this.mode&&(this.state="mouse-pan"),this.boundingBox=t.setUp(n.x,n.y,n.width/2,n.height/2),this.lastX=n.x,this.lastY=n.y,this.lastOrientation=s.orientation,this.forwardX=0,this.forwardY=0,this.forwardAngle=0,this.averageOffsetX=0,this.averageOffsetY=0,this.averageOffsetAngle=0,this.offsetX=0,this.offsetY=0,this.offsetAngle=0,this.forwardFollower=e.setUp("x",this.lastX,"y",this.lastY,"orientation",this.lastOrientation),this.lastFollow=e.setUp("entity",null,"mode",null,"offsetX",0,"offsetY",0,"begin",0),this.xMagnitude=0,this.yMagnitude=0,this.xWaveLength=0,this.yWaveLength=0,this.xShakeTime=0,this.yShakeTime=0,this.shakeTime=0,this.shakeIncrementor=0,this.direction=!0,this.stationary=!1,this.viewportUpdate=!1,this.owner.container?this.parentContainer=this.owner.container:this.owner.stage?(this.canvas=this.canvas||platypus.game.app.display.canvas,this.parentContainer=this.owner.stage,this.owner.width=this.canvas.width,this.owner.height=this.canvas.height):platypus.debug.warn("Camera: There appears to be no Container on this entity for the camera to display."),this.container=new PIXI.Container,this.matrix=this.container.transformMatrix=new PIXI.Matrix,this.parentContainer.addChild(this.container),this.movedCamera=!1},events:{load:function(){this.resize()},"render-world":function(t){this.world=t.world,this.world.transformMatrix=this.world.transformMatrix||new PIXI.Matrix,this.container.addChild(this.world)},"child-entity-added":function(t){this.viewportUpdate=!0,this.worldIsLoaded&&t.triggerEvent("camera-loaded",this.cameraLoadedMessage)},"child-entity-updated":function(t){this.viewportUpdate=!0,this.worldIsLoaded&&t.triggerEvent("camera-update",this.message)},"world-loaded":function(t){this.message.viewport.set(this.worldCamera.viewport),this.worldDimensions.set(t.world),this.worldIsLoaded=!0,t.camera&&this.follow(t.camera),this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("camera-loaded",this.cameraLoadedMessage),this.updateMovementMethods()},mousedown:function(t){var e=this.worldCamera.viewport;"mouse-pan"===this.state&&(this.mouseVector||(this.mouseVector=i.setUp(),this.mouseWorldOrigin=i.setUp()),this.mouse=this.mouseVector,this.mouse.x=t.event.x,this.mouse.y=t.event.y,this.mouseWorldOrigin.x=e.x,this.mouseWorldOrigin.y=e.y,t.pixiEvent.stopPropagation())},pressmove:function(t){this.mouse&&this.move(this.mouseWorldOrigin.x+(this.mouse.x-t.event.x)/this.world.transformMatrix.a,this.mouseWorldOrigin.y+(this.mouse.y-t.event.y)/this.world.transformMatrix.d)&&(this.viewportUpdate=!0,this.movedCamera=!0,t.pixiEvent.stopPropagation())},pressup:function(t){this.mouse&&(this.mouse=null,this.movedCamera&&(this.movedCamera=!1,t.pixiEvent.stopPropagation()))},tick:function(t){var e=this.message,i=e.viewport,n=null,s=this.worldCamera;"following"===this.state&&this.followingFunction(this.following,t.delta)&&(this.viewportUpdate=!0),this.canvas&&(this.owner.width=this.canvas.width,this.owner.height=this.canvas.height),(this.owner.width!==this.lastWidth||this.owner.height!==this.lastHeight)&&(this.resize(),this.lastWidth=this.owner.width,this.lastHeight=this.owner.height),this.viewportUpdate?(this.viewportUpdate=!1,this.stationary=!1,e.stationary=!1,i.set(s.viewport),this.shakeIncrementor<this.shakeTime&&(this.viewportUpdate=!0,this.shakeIncrementor+=t.delta,this.shakeIncrementor=Math.min(this.shakeIncrementor,this.shakeTime),this.shakeIncrementor<this.xShakeTime&&i.moveX(i.x+Math.sin(this.shakeIncrementor/this.xWaveLength*2*Math.PI)*this.xMagnitude),this.shakeIncrementor<this.yShakeTime&&i.moveY(i.y+Math.sin(this.shakeIncrementor/this.yWaveLength*2*Math.PI)*this.yMagnitude)),e.scaleX=this.windowPerWorldUnitWidth,e.scaleY=this.windowPerWorldUnitHeight,e.orientation=s.orientation,(n=this.world.transformMatrix).a=e.scaleX,n.b=0,n.c=0,n.d=e.scaleY,e.orientation&&n.rotate(e.orientation),n.tx=(i.halfWidth-i.x)*e.scaleX,n.ty=(i.halfHeight-i.y)*e.scaleY,this.owner.triggerEvent("camera-update",e),this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("camera-update",e)):this.stationary||(this.stationary=!0,e.stationary=!0,this.owner.triggerEvent("camera-update",e),this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("camera-update",e)),this.lastFollow.begin&&this.lastFollow.begin<Date.now()&&this.follow(this.lastFollow)},"resize-camera":function(t){this.width=t.width,this.height=t.height,this.resize()},relocate:function(){var t=function(t){this.move(t.x,t.y)&&(this.viewportUpdate=!0)},e=function(){this.recycle()};return function(n){var s=null,r=this.worldCamera.viewport;n.time&&window.createjs&&createjs.Tween?(s=i.setUp(r.x,r.y),createjs.Tween.get(s).to({x:n.x,y:n.y},n.time,n.ease).on("change",t.bind(this,s)).call(e.bind(s))):this.move(n.x,n.y)&&(this.viewportUpdate=!0)}}(),follow:function(t){this.follow(t)},shake:function(t){var e=t||{},i=e.xMagnitude||0,n=e.yMagnitude||0,s=e.xFrequency||0,r=e.yFrequency||0,o=e.time||0;this.viewportUpdate=!0,this.shakeIncrementor=0,this.xMagnitude=i,this.yMagnitude=n,0===s?(this.xWaveLength=1,this.xShakeTime=0):(this.xWaveLength=1e3/s,this.xShakeTime=Math.ceil(o/this.xWaveLength)*this.xWaveLength),0===r?(this.yWaveLength=1,this.yShakeTime=0):(this.yWaveLength=1e3/r,this.yShakeTime=Math.ceil(o/this.yWaveLength)*this.yWaveLength),this.shakeTime=Math.max(this.xShakeTime,this.yShakeTime)}},methods:{follow:function(t){switch(t.time?(this.lastFollow.begin||(this.lastFollow.entity=this.following,this.lastFollow.mode=this.mode,this.lastFollow.offsetX=this.offsetX,this.lastFollow.offsetY=this.offsetY),this.lastFollow.begin=Date.now()+t.time):this.lastFollow.begin&&(this.lastFollow.begin=0),this.mode=t.mode,t.mode){case"locked":this.state="following",this.following=t.entity,this.followingFunction=this.lockedFollow,this.offsetX=t.offsetX||0,this.offsetY=t.offsetY||0,this.offsetAngle=t.offsetAngle||0;break;case"forward":this.state="following",this.followFocused=!1,this.following=t.entity,this.lastX=t.entity.x-t.offsetX||0,this.lastY=t.entity.y-t.offsetY||0,this.lastOrientation=t.entity.orientation||0,this.forwardX=t.movementX||.1*this.transitionX,this.forwardY=t.movementY||.1*this.transitionY,this.averageOffsetX=0,this.averageOffsetY=0,this.averageOffsetAngle=0,this.offsetX=t.offsetX||0,this.offsetY=t.offsetY||0,this.offsetAngle=t.offsetAngle||0,this.followingFunction=this.forwardFollow;break;case"bounding":this.state="following",this.following=t.entity,this.offsetX=t.offsetX||0,this.offsetY=t.offsetY||0,this.offsetAngle=t.offsetAngle||0,this.boundingBox.setAll(t.x,t.y,t.width,t.height),this.followingFunction=this.boundingFollow;break;case"anchor-bound":this.state="following",this.following=t.entity,this.followingFunction=n.bind(this,t.anchorAABB,t.offsetX||0,t.offsetY||0);break;case"pan":this.state="mouse-pan",this.following=null,this.followingFunction=null,t&&"number"==typeof t.x&&"number"==typeof t.y&&(this.move(t.x,t.y,t.orientation||0),this.viewportUpdate=!0);break;default:this.state="static",this.following=null,this.followingFunction=null,t&&"number"==typeof t.x&&"number"==typeof t.y&&(this.move(t.x,t.y,t.orientation||0),this.viewportUpdate=!0)}t.begin&&(t.begin=0)},move:function(t,e,i){var n=this.moveX(t);return n=this.moveY(e)||n,this.rotate&&(n=this.reorient(i||0)||n),n},moveX:s,moveY:s,reorient:function(t){var e=this.worldCamera;return Math.abs(e.orientation-t)>1e-4&&(e.orientation=t,!0)},lockedFollow:function(){var t=Math.min,e=function(t,e,i){return i*e+(1-i)*t},i=function(e,i){return e?t(i/e,1):1};return function(t,n){var s=this.worldCamera,r=s.viewport,o=e(r.x,t.x,i(this.transitionX,n)),a=e(r.y,t.y,i(this.transitionY,n));return this.rotate?this.move(o,a,e(s.orientation,-(t.orientation||0),i(this.transitionAngle,n))):this.move(o,a,0)}}(),forwardFollow:function(t,e){var i=.9,n=1-i,s=this.forwardFollower,r=!1,o=15/e,a=this.worldCamera,h=a.viewport,l=t.x+this.offsetX,u=t.y+this.offsetY,c=(t.orientation||0)+this.offsetAngle;return this.followFocused&&this.lastX===l&&this.lastY===u?this.lockedFollow(s,e):(this.averageOffsetX*=i,this.averageOffsetY*=i,this.averageOffsetX+=n*(l-this.lastX)*o,this.averageOffsetY+=n*(u-this.lastY)*o,Math.abs(this.averageOffsetX)>h.width/(2*this.forwardX)&&(this.averageOffsetX=0),Math.abs(this.averageOffsetY)>h.height/(2*this.forwardY)&&(this.averageOffsetY=0),this.rotate&&(this.averageOffsetAngle*=i,this.averageOffsetAngle+=n*(c-this.lastOrientation)*o,Math.abs(this.averageOffsetAngle)>a.orientation/(2*this.forwardAngle)&&(this.averageOffsetAngle=0)),s.x=this.averageOffsetX*this.forwardX+l,s.y=this.averageOffsetY*this.forwardY+u,s.orientation=this.averageOffsetAngle*this.forwardAngle+c,this.lastX=l,this.lastY=u,this.lastOrientation=c,r=this.lockedFollow(s,e),this.followFocused||r||(this.followFocused=!0),r)},boundingFollow:function(t,e){var i=0,n=0,s=this.transitionX?Math.min(e/this.transitionX,1):1,r=1-s,o=this.transitionY?Math.min(e/this.transitionY,1):1,a=1-o,h=this.worldCamera.viewport;return this.boundingBox.move(h.x,h.y),t.x>this.boundingBox.right?i=t.x-this.boundingBox.halfWidth:t.x<this.boundingBox.left&&(i=t.x+this.boundingBox.halfWidth),t.y>this.boundingBox.bottom?n=t.y-this.boundingBox.halfHeight:t.y<this.boundingBox.top&&(n=t.y+this.boundingBox.halfHeight),0!==i&&(i=this.moveX(s*i+r*h.x)),0!==n&&(n=this.moveY(o*n+a*h.y)),i||n},resize:function(){var t=this.width/this.height,e=this.owner.width/this.owner.height,i=this.worldCamera.viewport;this.viewport.setAll(this.owner.width/2,this.owner.height/2,this.owner.width,this.owner.height),this.stretch||(e>t?this.overflow?i.resize(this.height*e,this.height):this.viewport.resize(this.viewport.height*t,this.viewport.height):this.overflow?i.resize(this.width,this.width/e):this.viewport.resize(this.viewport.width,this.viewport.width/t)),this.worldPerWindowUnitWidth=i.width/this.viewport.width,this.worldPerWindowUnitHeight=i.height/this.viewport.height,this.windowPerWorldUnitWidth=this.viewport.width/i.width,this.windowPerWorldUnitHeight=this.viewport.height/i.height,this.matrix.tx=this.viewport.x-this.viewport.halfWidth,this.matrix.ty=this.viewport.y-this.viewport.halfHeight,this.viewportUpdate=!0,this.updateMovementMethods()},updateMovementMethods:function(){var t=s,e=function(){var e=this.worldDimensions;return this.worldCamera.viewport.moveX(e.width/2+e.left),this.moveX=t,!0},i=function(){var e=this.worldDimensions;return this.worldCamera.viewport.moveY(e.height/2+e.top),this.moveY=t,!0},n=function(t){var e=this.worldCamera.viewport,i=this.worldDimensions,n=i.width,s=i.left;return Math.abs(e.x-t)>this.threshold&&(t+e.halfWidth>n+s?e.moveX(n-e.halfWidth+s):t<e.halfWidth+s?e.moveX(e.halfWidth+s):e.moveX(t),!0)},r=function(t){var e=this.worldCamera.viewport,i=this.worldDimensions,n=i.height,s=i.top;return Math.abs(e.y-t)>this.threshold&&(t+e.halfHeight>n+s?e.moveY(n-e.halfHeight+s):t<e.halfHeight+s?e.moveY(e.halfHeight+s):e.moveY(t),!0)},o=function(t){var e=this.worldCamera.viewport;return Math.abs(e.x-t)>this.threshold&&(e.moveX(t),!0)},a=function(t){var e=this.worldCamera.viewport;return Math.abs(e.y-t)>this.threshold&&(e.moveY(t),!0)};return function(){var t=this.threshold,s=this.worldCamera.viewport,h=this.worldDimensions,l=h.width,u=h.height;l?l<s.width?this.moveX=e:this.moveX=n:this.moveX=o,u?u<s.height?this.moveY=i:this.moveY=r:this.moveY=a,this.threshold=-1,this.moveX(s.x),this.moveY(s.y),this.threshold=t}}(),destroy:function(){this.parentContainer.removeChild(this.container),this.parentContainer=null,this.container=null,this.mouseVector&&(this.mouseVector.recycle(),this.mouseWorldOrigin.recycle()),this.boundingBox.recycle(),this.viewport.recycle(),this.worldCamera.viewport.recycle(),this.worldCamera.recycle(),this.message.viewport.recycle(),this.message.recycle(),this.cameraLoadedMessage.recycle(),this.worldDimensions.recycle(),this.forwardFollower.recycle(),this.lastFollow.recycle()}}})}(),function(){"use strict";var t=include("platypus.Data");platypus.createComponentClass({id:"CameraFollowMe",properties:{camera:{},mode:"forward",pause:!1},constructor:function(){this.pauseGame=this.pause&&this.camera.time?{time:this.camera.time}:null,this.camera=t.setUp("entity",this.owner,"mode",this.camera.mode||this.mode,"top",this.camera.top,"left",this.camera.left,"offsetX",this.camera.offsetX,"offsetY",this.camera.offsetY,"width",this.camera.width,"height",this.camera.height,"time",this.camera.time)},events:{"follow-me":function(e){var i=null;i=e?t.setUp("entity",this.owner,"mode",e.mode||this.camera.mode,"top",e.top||this.camera.top,"left",e.left||this.camera.left,"offsetX",e.offsetX||this.camera.offsetX,"offsetY",e.offsetY||this.camera.offsetY,"width",e.width||this.camera.width,"height",e.height||this.camera.height,"time",e.time||this.camera.time):t.setUp(this.camera),this.pauseGame&&(this.owner.parent.triggerEvent("pause-logic",this.pauseGame),this.owner.parent.triggerEvent("pause-render",this.pauseGame)),this.owner.parent.triggerEvent("follow",i),i.recycle()}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.CollisionShape"),i=include("platypus.Data"),n=include("platypus.DataMap"),s=include("platypus.Vector"),r=function(){var t=function(t,e,i,n){n.myType===e&&n.hitType===i&&this.owner.triggerEvent(t,n)},e=function(t,e,i,n){var s=0;if(n.myType===e&&n.hitType===i)for(s=0;s<t.length;s++)this.owner.triggerEvent(t[s],n)},i=function(t,e,i,n){var s=n.x,r=n.y;!n.entity||s||r||(s=n.entity.x-this.owner.x,r=n.entity.y-this.owner.y),n.myType===e&&n.hitType===i&&(r>0&&t.bottom?this.owner.trigger(t.bottom,n):0>r&&t.top&&this.owner.trigger(t.top,n),s>0&&t.right?this.owner.trigger(t.right,n):0>s&&t.left&&this.owner.trigger(t.left,n),t.all&&this.owner.trigger(t.all,n))};return function(n,s,r){return"string"==typeof s?t.bind(n,s,n.collisionType,r):Array.isArray(s)?e.bind(n,s,n.collisionType,r):i.bind(n,s,n.collisionType,r)}}(),o=function(){var e=function(t,e,i){var n=e.keys,s=n.length,r=null;if(i)return(r=e.get(i))?r.getAABB():null;for(t.reset();s--;)t.include(e.get(n[s]).getAABB());return t},r=function(t,e){var i=t.get(e);return i?i.getPreviousAABB():null},o=function(t,e){var i=t.get(e);return i?i.getShapes():null},a=function(t,e){var i=t.get(e);return i?i.getPrevShapes():null},h=function(t,e,i){for(var n=t.keys,s=n.length;s--;)t.get(n[s]).prepareCollision(e,i)},l=function(){var t=function(t,e,i){var n=0,r=e.stuck;r&&(n=t.magnitude(),e.thatShape.owner&&Math.abs(r)>1&&(r*=.05),(!n||n>Math.abs(r))&&(e.vector.x&&(t.x=r,t.y=0),e.vector.y&&(t.x=0,t.y=r),i.stuckWith&&i.stuckWith.recycle(),i.stuckWith=s.setUp(e.thatShape.x,e.thatShape.y)))},e={position:null,unstick:null};return function(i,n){var r=n.xData[0],o=n.yData[0],a=e,h=null;r&&(h=s.setUp(0,0,0),t(h,r,this)),o&&(h=h||s.setUp(0,0,0),t(h,o,this)),a.position=i,a.unstick=h,this.triggerEvent("relocate-entity",a),h&&h.recycle()}}(),u=function(t,e){for(var i=t.keys,n=i.length;n--;)t.get(i[n]).movePreviousX(e)},c=function(){return this.collisionTypes},d=function(){return this.solidCollisionMap},p=function(){return this.getAABB()},f=function(){return this.getPreviousAABB()},g=function(){return this.getShapes()},v=function(){return this.getPrevShapes()},m=function(t,e){this.prepareCollision(t,e)},y=function(t){this.movePreviousX(t)};return function(s,_){var b=_.collisionFunctions;b||(b=_.collisionFunctions=n.setUp(),_.aabb=t.setUp(),_.getAABB=e.bind(_,_.aabb,b),_.getPreviousAABB=r.bind(_,b),_.getShapes=o.bind(_,b),_.getPrevShapes=a.bind(_,b),_.prepareCollision=h.bind(_,b),_.relocateEntity=l.bind(_),_.movePreviousX=u.bind(_,b),_.getCollisionTypes=c.bind(_),_.getSolidCollisions=d.bind(_)),b.set(s.collisionType,i.setUp("getAABB",p.bind(s),"getPreviousAABB",f.bind(s),"getShapes",g.bind(s),"getPrevShapes",v.bind(s),"prepareCollision",m.bind(s),"movePreviousX",y.bind(s)))}}();platypus.createComponentClass({id:"CollisionBasic",properties:{collisionType:"none",shapeType:"rectangle",ignoreOrientation:!1,regX:null,regY:null,width:0,height:0,radius:0,softCollisions:null,solidCollisions:null,margin:0,shapes:null},publicProperties:{immobile:!1,bullet:!1,jumpThrough:!1},constructor:function(i){var a=null,h=0,l="",u=null,c=this.regX,d=this.regY,p=this.width,f=this.height,g=this.radius,v=0,m=0,y=0,_=0;for("number"==typeof this.margin?(v=this.margin,m=this.margin,y=this.margin,_=this.margin):(v=this.margin.left||0,m=this.margin.right||0,y=this.margin.top||0,_=this.margin.bottom||0),null===c&&(c=this.regX=p/2),null===d&&(d=this.regY=f/2),s.assign(this.owner,"position","x","y","z"),s.assign(this.owner,"previousPosition","previousX","previousY","previousZ"),this.owner.previousX=this.owner.previousX||this.owner.x,this.owner.previousY=this.owner.previousY||this.owner.y,this.aabb=t.setUp(),this.prevAABB=t.setUp(),this.shapes?u=this.shapes:"circle"===this.shapeType?(g=g||((p||0)+(f||0))/4,u=[{regX:(isNaN(c)?g:c)-(m-v)/2,regY:(isNaN(d)?g:d)-(_-y)/2,radius:g,type:this.shapeType}]):u=[{regX:(isNaN(c)?(p||0)/2:c)+v,regY:(isNaN(d)?(f||0)/2:d)+y,points:i.points,width:(p||0)+v+m,height:(f||0)+y+_,type:this.shapeType}],this.owner.collisionTypes=this.owner.collisionTypes||Array.setUp(),this.owner.collisionTypes.push(this.collisionType),this.shapes=Array.setUp(),this.prevShapes=Array.setUp(),this.entities=null,h=0;h<u.length;h++)this.shapes.push(e.setUp(this.owner,u[h],this.collisionType)),this.prevShapes.push(e.setUp(this.owner,u[h],this.collisionType)),this.prevAABB.include(this.prevShapes[h].aABB),this.aabb.include(this.shapes[h].aABB);if(o(this,this.owner),this.owner.solidCollisionMap=this.owner.solidCollisionMap||n.setUp(),a=this.owner.solidCollisionMap.set(this.collisionType,Array.setUp()),this.solidCollisions)for(l in this.solidCollisions)this.solidCollisions.hasOwnProperty(l)&&(a.push(l),this.solidCollisions[l]&&this.addEventListener("hit-by-"+l,r(this,this.solidCollisions[l],"solid")));if(this.owner.softCollisionMap=this.owner.softCollisionMap||n.setUp(),a=this.owner.softCollisionMap.set(this.collisionType,Array.setUp()),this.softCollisions)for(l in this.softCollisions)this.softCollisions.hasOwnProperty(l)&&(a.push(l),this.softCollisions[l]&&this.addEventListener("hit-by-"+l,r(this,this.softCollisions[l],"soft")));this.stuck=!1},events:{"collide-on":function(t){var e=this.owner,i=this.collisionType,n=e.collisionTypes;("string"!=typeof t||t===i)&&(-1===n.indexOf(i)&&n.push(i),e.parent.triggerEvent("add-collision-entity",e),this.active=!0)},"collide-off":function(t){var e=0,i=this.owner,n=i.parent,s=this.collisionType,r=i.collisionTypes;("string"!=typeof t||t===s)&&(n.triggerEvent("remove-collision-entity",i),(e=r.indexOf(s))>=0&&r.greenSplice(e),this.active=!1,r.length&&n.triggerEvent("add-collision-entity",i))},"relocate-entity":function(t){var e,i,n=t.unstick,s=0,r=0,o=this.aabb,a=this.owner,h=null,l=this.shapes;for(n&&(s=n.magnitude()),this.move&&(this.move.recycle(),this.move=null),t.relative?a.position.setVector(a.previousPosition).add(t.position):a.position.setVector(t.position),this.stuck&&(s>0?a.position.add(n):this.stuck=!1),e=a.x,i=a.y,o.reset(),r=l.length;r--;)(h=l[r]).update(e,i),o.include(h.aABB);a.previousPosition.setVector(a.position),s>0&&(this.stuck||(this.stuck=!0),this.move=a.stuckWith.copy().add(-e,-i).normalize())},"handle-logic":function(){this.move&&this.owner.position.add(this.move)},"orientation-updated":function(t){var e=0;if(!this.ignoreOrientation)for(e=0;e<this.shapes.length;e++)this.shapes[e].multiply(t)}},methods:{getAABB:function(){return this.aabb},getPreviousAABB:function(){return this.prevAABB},getShapes:function(){return this.shapes},getPrevShapes:function(){return this.prevShapes},prepareCollision:function(t,e){var i=0,n=null,s=this.shapes,r=this.prevShapes,o=this.aabb;for(this.owner.x=t,this.owner.y=e,this.prevShapes=s,this.shapes=r,this.prevAABB.set(o),o.reset(),i=r.length;i--;)(n=r[i]).update(t,e),o.include(n.aABB)},movePreviousX:function(t){var e=0;for(this.prevAABB.moveX(t),e=0;e<this.prevShapes.length;e++)this.prevShapes[e].setXWithEntityX(t)},destroy:function(){var t=this.owner.collisionFunctions,e=this.collisionType,i=this.owner.collisionTypes.indexOf(e),n=this.owner;for(n.parent.triggerEvent("remove-collision-entity",n),this.aabb.recycle(),delete this.aabb,this.prevAABB.recycle(),delete this.prevAABB,i>=0&&n.collisionTypes.greenSplice(i),n.solidCollisionMap.has(e)&&n.solidCollisionMap.delete(e).recycle(),n.softCollisionMap.has(e)&&n.softCollisionMap.delete(e).recycle(),t.delete(e).recycle(),i=this.shapes.length;i--;)this.shapes[i].recycle(),this.prevShapes[i].recycle();this.shapes.recycle(),this.prevShapes.recycle(),delete this.shapes,delete this.prevShapes,delete this.entities,n.collisionTypes.length?n.parent.triggerEvent("add-collision-entity",n):(t.recycle(),n.collisionFunctions=null,n.solidCollisionMap.recycle(),n.solidCollisionMap=null,n.softCollisionMap.recycle(),n.softCollisionMap=null,n.aabb.recycle(),n.aabb=null)}}})}(),function(){"use strict";var t=function(t,e,i){this.state.get(t)&&this.trigger(e,i)},e=function(t,e,i){this.state.get(t)||this.trigger(e,i)};platypus.createComponentClass({id:"CollisionFilter",properties:{collisions:{},state:""},constructor:function(){var i="",n=this.collisions,s=this.state;if(n)if("!"===s[0])for(i in s=s.substring(1),n)n.hasOwnProperty(i)&&this.addEventListener(i,e.bind(this.owner,s,n[i]));else for(i in n)n.hasOwnProperty(i)&&this.addEventListener(i,t.bind(this.owner,s,n[i]))}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.DataMap"),i=include("platypus.Vector");platypus.createComponentClass({id:"CollisionGroup",constructor:function(){this.solidEntities=Array.setUp(),this.collisionTypes=Array.setUp(),this.shapes=Array.setUp(),this.prevShapes=Array.setUp(),this.terrain=null,this.aabb=t.setUp(this.owner.x,this.owner.y),this.prevAABB=t.setUp(this.owner.x,this.owner.y),this.filteredAABB=t.setUp(),i.assign(this.owner,"position","x","y","z"),i.assign(this.owner,"previousPosition","previousX","previousY","previousZ"),this.owner.previousX=this.owner.previousX||this.owner.x,this.owner.previousY=this.owner.previousY||this.owner.y,this.collisionGroup=this.owner.collisionGroup={getAllEntities:function(){var t=0,e=0,i=null;for(t=0;t<this.solidEntities.length;t++)e+=(i=this.solidEntities[t])!==this.owner&&i.collisionGroup?i.collisionGroup.getAllEntities():1;return e}.bind(this),getSize:function(){return this.solidEntities.length}.bind(this),getCollisionTypes:function(){return this.getCollisionTypes()}.bind(this),getSolidCollisions:function(){return this.getSolidCollisions()}.bind(this),getAABB:function(t){return this.getAABB(t)}.bind(this),getPreviousAABB:function(t){return this.getPreviousAABB(t)}.bind(this),getShapes:function(t){return this.getShapes(t)}.bind(this),getPrevShapes:function(t){return this.getPrevShapes(t)}.bind(this),prepareCollision:function(t,e){return this.prepareCollision(t,e)}.bind(this),relocateEntity:function(t,e){return this.relocateEntity(t,e)}.bind(this),movePreviousX:function(t){return this.movePreviousX(t)}.bind(this),getSolidEntities:function(){return this.solidEntities}.bind(this),jumpThrough:!1}},events:{"child-entity-added":function(t){this.addCollisionEntity(t)},"add-collision-entity":function(t){this.addCollisionEntity(t)},"child-entity-removed":function(t){this.removeCollisionEntity(t)},"remove-collision-entity":function(t){this.removeCollisionEntity(t)},"relocate-entity":function(){this.owner.previousPosition.setVector(this.owner.position),this.updateAABB()}},methods:{addCollisionEntity:function(t){var e=0,i=t.collisionTypes;if(i){for(e=i.length;e--;)t.solidCollisionMap.get(i[e]).length&&!t.immobile&&(this.solidEntities[this.solidEntities.length]=t);this.updateAABB()}},removeCollisionEntity:function(t){var e=0,i=0,n=t.collisionTypes;if(n){for(i=n.length;i--;)t.solidCollisionMap.get(n[i]).length&&((e=this.solidEntities.indexOf(t))>=0&&this.solidEntities.greenSplice(e));this.updateAABB()}},getCollisionTypes:function(){var t=null,e=this.collisionTypes,i=this.solidEntities,n=i.length;for(e.length=0;n--;)(t=i[n])!==this.owner&&t.collisionGroup&&(t=t.collisionGroup),e.union(t.getCollisionTypes());return e},getSolidCollisions:function(){var t=0,i="",n=null,s=null,r=e.setUp(),o=null,a=0,h=null,l=null,u=!1;for(t=0;t<this.solidEntities.length;t++){for(u=!1,(s=this.solidEntities[t])!==this.owner&&s.collisionGroup&&(s=s.collisionGroup,u=!0),a=(n=(o=s.getSolidCollisions()).keys).length;a--;)i=n[a],h=r.get(i),l=o.get(i),h||(h=r.set(i,Array.setUp())),h.union(l),u&&l.recycle();u&&o.recycle()}return r},getAABB:function(t){var e=0,i=this.filteredAABB,n=null,s=null,r=this.solidEntities;if(t){for(i.reset(),e=r.length;e--;)(n=r[e])!==this.owner&&n.collisionGroup&&(n=n.collisionGroup),(s=n.getAABB(t))&&i.include(s);return i}return this.aabb},getPreviousAABB:function(t){var e=0,i=this.filteredAABB,n=null,s=null,r=this.solidEntities;if(t){for(i.reset(),e=r.length;e--;)(n=r[e])!==this.owner&&n.collisionGroup&&(n=n.collisionGroup),(s=n.getPreviousAABB(t))&&i.include(s);return i}return this.prevAABB},updateAABB:function(){var t=this.aabb,e=this.solidEntities,i=null,n=e.length,s=this.owner;for(t.reset();n--;)i=e[n],t.include(i!==s&&i.getCollisionGroupAABB?i.getCollisionGroupAABB():i.getAABB())},getShapes:function(t){var e=0,i=null,n=this.shapes,s=null;for(n.length=0,e=0;e<this.solidEntities.length;e++)(i=this.solidEntities[e])!==this.owner&&i.collisionGroup&&(i=i.collisionGroup),(s=i.getShapes(t))&&n.union(s);return n},getPrevShapes:function(t){var e=0,i=null,n=null,s=this.prevShapes;for(s.length=0,e=0;e<this.solidEntities.length;e++)(i=this.solidEntities[e])!==this.owner&&i.collisionGroup&&(i=i.collisionGroup),(n=i.getPrevShapes(t))&&s.union(n);return s},prepareCollision:function(t,e){var i=0,n=null,s=0,r=0;for(i=0;i<this.solidEntities.length;i++)(n=this.solidEntities[i]).saveDX=n.x-n.previousX,n.saveDY=n.y-n.previousY,s=n.saveOX=this.owner.previousX-n.previousX,r=n.saveOY=this.owner.previousY-n.previousY,n!==this.owner&&n.collisionGroup&&(n=n.collisionGroup),n.prepareCollision(t-s,e-r)},movePreviousX:function(t){var e=null,i=0,n=0;for(n=0;n<this.solidEntities.length;n++)i=(e=this.solidEntities[n]).saveOX,e!==this.owner&&e.collisionGroup&&(e=e.collisionGroup),e.movePreviousX(t-i)},relocateEntity:function(t,e){var n=null,s=null,r=0,o=null,a=this.owner,h=this.solidEntities,l=null;for(a.saveDX-=t.x-a.previousX,a.saveDY-=t.y-a.previousY,r=(o=e.xData).length;r--;)if(o[r].thisShape.owner===a){a.saveDX=0;break}for(r=(o=e.yData).length;r--;)if(o[r].thisShape.owner===a){a.saveDY=0;break}for(r=0;r<h.length;r++)(n=s=h[r])!==a&&n.collisionGroup&&(n=n.collisionGroup),l=i.setUp(t.x-s.saveOX,t.y-s.saveOY,n.z),n.relocateEntity(l,e),l.recycle(),s.x+=s.saveDX,s.y+=s.saveDY,s!==a&&(s.x+=a.saveDX,s.y+=a.saveDY)},destroy:function(){this.solidEntities.recycle(),this.collisionTypes.recycle(),this.shapes.recycle(),this.prevShapes.recycle(),this.aabb.recycle(),this.prevAABB.recycle(),this.filteredAABB.recycle()}},publicMethods:{getCollisionGroupAABB:function(){return this.getAABB()},getWorldEntities:function(){return this.owner.parent.getWorldEntities()},getWorldTerrain:function(){return this.owner.parent.getWorldTerrain()}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.CollisionShape"),i=include("platypus.Data"),n=536870912,s=2147483648,r=1073741824,o=268435455,a=function(){return this.collisionType},h=function(t){return this.collisionTypeMap[t&o]||this.collisionType},l=function(t){return 0===t?t:t^r^n},u=function(t){return 0===t?t:t^s^n},c=function(t){return 0===t?t:t^s},d=function(t){return 0===t?t:t^r},p=function(t){return 0===t?t:n&t?t^r^n:t^s^n},f=function(t){return 0===t?t:t^s^r},g=function(t){return 0===t?t:n&t?t^s^n:t^r^n},v=function(t,e,i,n,s){var r=0,o=0,a=Array.setUp();for(o=0;s>o;o++)for(a[o]=Array.setUp(),r=0;n>r;r++)a[o][r]=t[e+r][i+o];return a},m={diagonal:function(t,e,i,n,s){var r=v(t,e,i,n,s),o=l,a=0,h=0;for(a=0;n>a;a++)for(h=0;s>h;h++)t[e+a][i+h]=o(r[a][h]);return r.recycle(2),t},"diagonal-inverse":function(t,e,i,n,s){var r=v(t,e,i,n,s),o=u,a=0,h=0;for(a=0;n>a;a++)for(h=0;s>h;h++)t[e+n-a-1][i+s-h-1]=o(r[a][h]);return r.recycle(2),t},horizontal:function(t,e,i,n,s){var r=v(t,e,i,n,s),o=c,a=0,h=0;for(h=0;s>h;h++)for(a=0;n>a;a++)t[e+n-a-1][i+h]=o(r[h][a]);return r.recycle(2),t},vertical:function(t,e,i,n,s){var r=v(t,e,i,n,s),o=d,a=0,h=0;for(h=0;s>h;h++)for(a=0;n>a;a++)t[e+a][i+s-h-1]=o(r[h][a]);return r.recycle(2),t},"rotate-90":function(t,e,i,n,s){var r=v(t,e,i,n,s),o=p,a=0,h=0;for(h=0;s>h;h++)for(a=0;n>a;a++)t[e+s-h-1][i+a]=o(r[h][a]);return r.recycle(2),t},"rotate-180":function(t,e,i,n,s){var r=v(t,e,i,n,s),o=f,a=0,h=0;for(h=0;s>h;h++)for(a=0;n>a;a++)t[e+n-a-1][i+s-h-1]=o(r[h][a]);return r.recycle(2),t},"rotate-270":function(t,e,i,n,s){var r=v(t,e,i,n,s),o=g,a=0,h=0;for(h=0;s>h;h++)for(a=0;n>a;a++)t[e+h][i+n-a-1]=o(r[h][a]);return r.recycle(2),t},translate:function(t,e,i,n,s,r,o){var a=function(t,e,i,n,s){var r=0,o=0,a=Array.setUp();for(o=0;s>o;o++)for(a[o]=Array.setUp(),r=0;n>r;r++)a[o][r]=t[e+r][i+o],t[e+r][i+o]=-1;return a}(t,e,i,n,s),h=0,l=0;for(l=0;s>l;l++)for(h=0;n>h;h++)t[e+h+r][i+l+o]=a[l][h];return a.recycle(2),t}};platypus.createComponentClass({id:"CollisionTiles",properties:{collisionTypeMap:null,collisionType:"tiles",top:0,left:0},publicProperties:{collisionMap:[],tileWidth:10,tileHeight:10},constructor:function(){this.tileOffsetLeft=this.tileWidth/2+this.left,this.tileOffsetTop=this.tileHeight/2+this.top,this.columns=this.collisionMap.length,this.rows=this.collisionMap[0].length,this.shapeDefinition=i.setUp("x",0,"y",0,"type","rectangle","width",this.tileWidth,"height",this.tileHeight),this.storedTiles=Array.setUp(),this.serveTiles=Array.setUp(),this.storedTileIndex=0,this.aabb=t.setUp(),this.aabb.setBounds(this.left,this.top,this.tileWidth*this.columns+this.left,this.tileHeight*this.rows+this.top),this.collisionTypeMap?this.getType=h:this.getType=a},events:{transform:function(t){this.transform(t)},translate:function(t){this.translate(t)}},methods:{getShape:function(t,i,n){var s=this.storedTileIndex,r=null,o=this.storedTiles;return s===o.length?(r=e.setUp(null,this.shapeDefinition,n),o.push(r)):(r=o[s]).collisionType=n,r.update(t*this.tileWidth+this.tileOffsetLeft,i*this.tileHeight+this.tileOffsetTop),this.storedTileIndex+=1,r},addShape:function(t,e,i,a,h){var l=this.collisionMap[i][a],u=l&o,c=268435456,d=n,p=s,f=r;return l&&this.getType(u)===h&&((c&=l)?(f&=l,(d&=l)&&(p&=l)?e.left>=(i+1)*this.tileWidth+this.left&&t.push(this.getShape(i,a,h)):d?e.right<=i*this.tileWidth+this.left&&t.push(this.getShape(i,a,h)):f?e.top>=(a+1)*this.tileHeight+this.top&&t.push(this.getShape(i,a,h)):e.bottom<=a*this.tileHeight+this.top&&t.push(this.getShape(i,a,h))):t.push(this.getShape(i,a,h))),t},destroy:function(){var t=this.storedTiles,e=t.length;for(this.shapeDefinition.recycle(),delete this.shapeDefinition;e--;)t[e].recycle();t.recycle(),delete this.storedTiles,this.serveTiles.recycle(),delete this.serveTiles,this.aabb.recycle(),delete this.aabb}},publicMethods:{getAABB:function(){return this.aabb},isTile:function(t,e){return!(0>t||0>e||t>=this.columns||e>=this.rows||-1===this.collisionMap[t][e])},getTileShapes:function(t,e,i){var n=i||"tiles",s=this.left,r=this.top,o=this.tileHeight,a=this.tileWidth,h=Math.max(Math.floor((t.left-s)/a),0),l=Math.max(Math.floor((t.top-r)/o),0),u=Math.min(Math.ceil((t.right-s)/a),this.columns),c=Math.min(Math.ceil((t.bottom-r)/o),this.rows),d=0,p=0,f=this.serveTiles;for(f.length=0,this.storedTileIndex=0,d=h;u>d;d++)for(p=l;c>p;p++)this.addShape(f,e,d,p,n);return f},transform:function(t){var e=t||{},i=e.left||0,n=e.top||0,s=e.width||this.rows,r=e.height||this.columns,o=e.type||"horizontal";return m[o]?m[o](this.collisionMap,i,n,s,r):null},translate:function(t){var e=t||{},i=e.left||0,n=e.top||0,s=e.width||this.rows,r=e.height||this.columns,o=e.dx||0,a=e.dy||0;return m.translate(this.collisionMap,i,n,s,r,o,a)},getCollisionMatrix:function(t,e,i,n){return v(this.collisionMap,t,e,i,n)},setCollisionMatrix:function(t,e,i,n,s){return function(t,e,i,n,s,r){var o=0,a=0;for(a=0;r>a;a++)for(o=0;s>o;o++)t[i+o][n+a]=e[a][o];return t}(this.collisionMap,t,e,i,n,s)}}})}(),function(){"use strict";var t=function(t){this.switches.push(t)};platypus.createComponentClass({id:"ComponentSwitcher",properties:{componentMap:null},constructor:function(){var e="";if(this.switches=Array.setUp(),this.componentMap)for(e in this.componentMap)this.componentMap.hasOwnProperty(e)&&this.addEventListener(e,t.bind(this,e))},events:{"prepare-logic":function(){var t=0;if(this.switches.length){for(t=0;t<this.switches.length;t++)this.switchComponents(this.componentMap[this.switches[t]]);this.switches.length=0}}},methods:{switchComponents:function(t){var e=0,i=0,n=this.owner,s=n.components,r=t.remove,o=t.add;if(r)if(Array.isArray(r))for(e=0;e<r.length;e++)for(i=s.length-1;i>-1;i--)s[i].type===r[e]&&n.removeComponent(s[i]);else for(e=s.length-1;e>-1;e--)s[e].type===r&&n.removeComponent(s[e]);if(o)if(Array.isArray(o))for(e=0;e<o.length;e++)n.addComponent(new platypus.components[o[e].type](n,o[e]));else n.addComponent(new platypus.components[o.type](n,o));n.parent&&n.parent.triggerEvent("child-entity-updated",n),n.triggerEvent("add-remove-component-complete")},destroy:function(){this.switches.recycle()}},getAssetList:function(t,e,i){var n=t.componentMap||e.componentMap||i.componentMap,s="",r=0,o=null,a=Array.setUp(),h=null;for(s in n)if(n.hasOwnProperty(s))for(r=0;r<n[s].add.length;r++)(o=platypus.components[n[s].add[r].type])&&(h=o.getAssetList(n[s].add[r],e,i),a.union(h),h.recycle());return a}})}(),function(){"use strict";var t=include("platypus.Data");platypus.createComponentClass({id:"Counter",publicProperties:{total:0},constructor:function(){this.count=0,this.lastTotal=0,this.lastCount=0,this.message=t.setUp("text","")},events:{"handle-logic":function(){var t=!1,e=this.message;this.total!==this.lastTotal&&(this.lastTotal=this.total,t=!0),this.count!==this.lastCount&&(this.lastCount=this.count,t=!0),t&&(this.total?e.text=String(this.count)+"/"+String(this.total):e.text=String(this.count),this.owner.triggerEvent("update-content",e))},"change-total":function(t){this.total=t},"change-count":function(t){this.count=t},"increment-count":function(){this.count+=1}},methods:{destroy:function(){this.message.recycle()}}})}(),function(){"use strict";var t=include("platypus.Data"),e=include("platypus.Entity");platypus.createComponentClass({id:"EntityContainer",properties:{childEvents:[]},constructor:function(t){var e=0,i=this.childEvents;for(this.entityDefinitions=null,t.entities&&this.owner.entities?this.entityDefinitions=t.entities.concat(this.owner.entities):this.entityDefinitions=t.entities||this.owner.entities||null,this.owner.entities=this.entities=Array.setUp(),this.childEvents=Array.setUp(),e=0;e<i.length;e++)this.addNewPublicEvent(i[e]);this.addNewPrivateEvent("peer-entity-added"),this.addNewPrivateEvent("peer-entity-removed")},events:{load:function(){var t=0,e=this.entityDefinitions;if(e)for(t=0;t<e.length;t++)this.addEntity(e[t]);delete this.entityDefinitions},"add-entity":function(t){this.addEntity(t)},"remove-entity":function(t){this.removeEntity(t)},"child-entity-updated":function(t){this.updateChildEventListeners(t)}},methods:{addNewPublicEvent:function(t){var e=0;for(this.addNewPrivateEvent(t),e=0;e<this.childEvents.length;e++)if(this.childEvents[e]===t)return!1;return this.childEvents.push(t),this.addEventListener(t,function(t){return function(e,i){this.triggerOnChildren(t,e,i)}}(t)),!0},addNewPrivateEvent:function(t){var e=0,i=0;if(this._listeners[t])return!1;for(this._listeners[t]=Array.setUp(),e=0;e<this.entities.length;e++)if(this.entities[e]._listeners[t])for(i=0;i<this.entities[e]._listeners[t].length;i++)this.addChildEventListener(this.entities[e],t,this.entities[e]._listeners[t][i]);return!0},updateChildEventListeners:function(t){this.removeChildEventListeners(t),this.addChildEventListeners(t)},addChildEventListeners:function(t){var e=0,i="";for(i in this._listeners)if(this._listeners.hasOwnProperty(i)&&t._listeners[i])for(e=0;e<t._listeners[i].length;e++)this.addChildEventListener(t,i,t._listeners[i][e])},removeChildEventListeners:function(t){var e=0,i=null,n=null;if(t.containerListener){for(i=t.containerListener.events,n=t.containerListener.messages,e=0;e<i.length;e++)this.removeChildEventListener(t,i[e],n[e]);i.recycle(),n.recycle(),t.containerListener.recycle(),t.containerListener=null}},addChildEventListener:function(e,i,n){e.containerListener||(e.containerListener=t.setUp("events",Array.setUp(),"messages",Array.setUp())),e.containerListener.events.push(i),e.containerListener.messages.push(n),this.on(i,n,n._priority||0)},removeChildEventListener:function(t,e,i){var n=0,s=t.containerListener.events,r=t.containerListener.messages;for(n=0;n<s.length;n++)s[n]!==e||i&&r[n]!==i||this.off(e,r[n])},destroy:function(){for(var t=this.entities.length,e=null;t--;)e=this.entities[t],this.removeChildEventListeners(e),e.destroy();this.entities.recycle(),delete this.owner.entities,this.childEvents.recycle()}},publicMethods:{getEntityById:function(t){var e=0,i=null;for(e=0;e<this.entities.length;e++){if(this.entities[e].id===t)return this.entities[e];if(this.entities[e].getEntityById&&(i=this.entities[e].getEntityById(t)))return i}return null},getEntitiesByType:function(t){var e=0,i=null,n=Array.setUp();for(e=0;e<this.entities.length;e++)this.entities[e].type===t&&n.push(this.entities[e]),this.entities[e].getEntitiesByType&&(i=this.entities[e].getEntitiesByType(t),n.union(i),i.recycle());return n},addEntity:function(t){var i=null,n=0;for(t instanceof e?i=t:(i="string"==typeof t?new e(platypus.game.settings.entities[t]):t.id?new e(t):new e(platypus.game.settings.entities[t.type],t),this.owner.triggerEvent("entity-created",i)),i.parent=this.owner,i.triggerEvent("adopted",i),n=0;n<this.entities.length&&i.triggerEvent("peer-entity-added",this.entities[n]);n++);return this.triggerEventOnChildren("peer-entity-added",i),this.addChildEventListeners(i),this.entities.push(i),this.owner.triggerEvent("child-entity-added",i),i},removeEntity:function(t){var e=this.entities.indexOf(t);return e>=0&&(this.removeChildEventListeners(t),this.entities.greenSplice(e),this.triggerEventOnChildren("peer-entity-removed",t),this.owner.triggerEvent("child-entity-removed",t),t.destroy(),t.parent=null,t)},triggerEventOnChildren:function(t,e,i){return this.destroyed?0:(this._listeners[t]||this.addNewPrivateEvent(t),this.triggerEvent(t,e,i))},triggerOnChildren:function(t,e,i){return this.destroyed?0:(this._listeners[t]||this.addNewPrivateEvent(t),this.trigger(t,e,i))}},getAssetList:function(t,i,n){var s=0,r=Array.setUp(),o=Array.setUp(),a=null;for(t.entities&&o.union(t.entities),i&&i.entities?o.union(i.entities):n&&n.entities&&o.union(n.entities),s=0;s<o.length;s++)a=e.getAssetList(o[s]),r.union(a),a.recycle();return o.recycle(),r}},platypus.Messenger)}(),function(){"use strict";var t=include("platypus.ActionState"),e=include("platypus.Data"),i=include("platypus.DataMap"),n=include("platypus.StateMap"),s=[null,null,null,null,["east","south","west","north"],null,null,null,["east","southeast","south","southwest","west","northwest","north","northeast"],null,null,null,null,null,null,null,["east","east-southeast","southeast","south-southeast","south","south-southwest","southwest","west-southwest","west","west-northwest","northwest","north-northwest","north","north-northeast","northeast","east-northeast"]],r=["left-button","middle-button","right-button"],o=function(t,e){this.paused||this.owner.trigger(t,e)},a=function(t,e,i){!this.paused&&i[t]&&this.owner.trigger(e,i)};platypus.createComponentClass({id:"EntityController",properties:{controlMap:{},stateMaps:{}},publicProperties:{paused:!1},constructor:function(t){var s="",r=null;if(this.actions=i.setUp(),this.stateMaps)for(s in this.stateMaps)this.stateMaps.hasOwnProperty(s)&&(r=n.setUp(s),this.addMap(this.stateMaps[s],s,r),r.recycle());this.addMap(this.controlMap,"default"),t.joystick&&(this.joystick=e.setUp("directions",t.joystick.directions||4,"handleEdge",t.joystick.handleEdge||!1,"innerRadius",t.joystick.innerRadius||0,"outerRadius",t.joystick.outerRadius||1/0))},events:{"handle-controller":function(){for(var t=this.actions,e=t.keys,i=e.length,n="",s=Array.setUp(),r=this.owner.state;i--;)(n=t.get(e[i])).update(r)&&s.push(n);for(i=s.length;i--;)s[i].resolve();s.recycle()},mousedown:function(t){this.owner.triggerEvent("mouse:"+r[t.event.button||0]+":down",t.event),this.joystick&&(this.owner.triggerEvent("joystick:down",t.event),this.handleJoy(t))},pressup:function(t){this.owner.triggerEvent("mouse:"+r[t.event.button||0]+":up",t.event),this.joystick&&(this.owner.triggerEvent("joystick:up",t.event),this.handleJoy(t))},pressmove:function(t){this.joystick&&this.handleJoy(t)},"pause-controls":function(){this.paused=!0},"unpause-controls":function(){this.paused=!1}},methods:{handleJoy:function(t){var e=Math.PI/(this.joystick.directions/2),i=function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}(this.owner,t),n=0,r="",o="";i>this.joystick.outerRadius||i<this.joystick.innerRadius||this.paused||(n=function(t,e,i){var n=e.x-t.x,s=e.y-t.y,r=0,o=2*Math.PI;return i?(r=Math.acos(n/i),0>s&&(r=o-r),r):r}(this.owner,t,i),r=s[this.joystick.directions][Math.floor((n+e/2)%(2*Math.PI)/e)],this.joystick.handleEdge&&(e=Math.PI/this.joystick.directions,(o=s[2*this.joystick.directions][Math.floor((n+e/2)%(2*Math.PI)/e)])!==r&&this.owner.triggerEvent(o.replace(r,"").replace("-",""),t)),this.owner.triggerEvent(r,t),this.owner.triggerEvent("joystick-orientation",n))},addController:function(){var e=function(t){this.inputs[t]=!1},i=function(t){this.inputs[t]=!0};return function(n,s,r,h,l){var u=this.actions,c=s+"-"+r+"-"+(l||"all"),d=u.get(c);d||(d=l?u.set(c,t.setUp(r,h,a.bind(this,l))):u.set(c,t.setUp(r,h,o.bind(this)))),this.addEventListener(n+":up",e.bind(d,d.inputs.length)),this.addEventListener(n+":down",i.bind(d,d.inputs.length)),d.inputs.push(!1)}}(),addMap:function(t,e,i){var n=null,s=0,r="",o="";for(o in t)if(t.hasOwnProperty(o))if("string"==typeof(n=t[o]))this.addController(o,e,n,i);else if(Array.isArray(n))for(s=0;s<n.length;s++)this.addController(o,e,n[s],i);else for(r in n)if(n.hasOwnProperty(r))if("string"==typeof n[r])this.addController(o,e,n[r],i,r);else for(s=0;s<n[r].length;s++)this.addController(o,e,n[r][s],i,r)},destroy:function(){for(var t=this.actions,e=t.keys,i=e.length;i--;)t.get(e[i]).recycle();t.recycle(),this.joystick&&this.joystick.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.CollisionData"),i=include("platypus.CollisionDataContainer"),n=include("platypus.Data"),s=include("platypus.DataMap"),r=include("platypus.Vector"),o={entity:null,type:null,x:0,y:0,hitType:null,myType:null},a=function(t,e){return t.collisionGroup.getAllEntities()-e.collisionGroup.getAllEntities()};platypus.createComponentClass({id:"HandlerCollision",properties:{gridBits:8},constructor:function(){this.againstGrid=n.setUp(),this.solidEntitiesLive=Array.setUp(),this.softEntitiesLive=Array.setUp(),this.allEntitiesLive=Array.setUp(),this.groupsLive=Array.setUp(),this.nonColliders=Array.setUp(),this.terrain=null,this.owner.previousX=this.owner.previousX||this.owner.x,this.owner.previousY=this.owner.previousY||this.owner.y,this.relocationMessage=n.setUp("position",r.setUp(),"relative",!1)},events:{"child-entity-added":function(t){t.collideOff||this.addCollisionEntity(t)},"add-collision-entity":function(t){this.addCollisionEntity(t)},"child-entity-removed":function(t){this.removeCollisionEntity(t)},"remove-collision-entity":function(t){this.removeCollisionEntity(t)},"child-entity-updated":function(t){this.removeCollisionEntity(t),this.addCollisionEntity(t)},"check-collision-group":function(t){this.checkCamera(t.camera,t.entities),this.checkGroupCollisions(),this.checkSolidCollisions(),this.resolveNonCollisions(),this.checkSoftCollisions(t)}},methods:{mapDown:function(e){var i=t.setUp(),n=this.gridBits;return i.setBounds(e.left>>n,e.top>>n,e.right>>n,e.bottom>>n)},getAgainstGrid:function(t,e,i){var s=this.mapDown(e),r=null,o=n.setUp(),a=0,h=null,l=this.againstGrid,u=null,c="",d=0,p=0;if(e.equals(t.againstAABB))return this.getEntityAgainstGrid(t,i);for(d=s.left;d<=s.right;d++)for(p=s.top;p<=s.bottom;p++)if(h=l[(p<<16^d)>>>0])for(a=i.length;a--;)c=i[a],(r=h.get(c))&&r.length&&((u=o[c])?u.union(r):o[c]=Array.setUp.apply(null,r));return s.recycle(),o},getEntityAgainstGrid:function(t,e){for(var i=t.againstGrid,s=null,r=n.setUp(),o=i.length,a=0,h=null,l=null,u="";o--;)for(h=i[o],a=e.length;a--;)u=e[a],(s=h.get(u))&&s.length&&((l=r[u])?l.union(s):r[u]=Array.setUp.apply(null,s));return r},removeAgainst:function(t){for(var e=t.againstGrid,i=t.collisionTypes,n=null,s=e.length,r=0,o=0,a=i.length,h=null;s--;)for(h=e[s],r=a;r--;)(n=h.get(i[r]))&&((o=n.indexOf(t))>=0&&n.greenSplice(o));e.length=0},updateAgainst:function(t){var e=null,i=0,n="",r=t.collisionTypes,o=this.mapDown(t.getAABB()),a=t.againstGrid,h=0,l=null,u=this.againstGrid,c=0,d=0;if(!o.equals(t.againstAABB))for(t.againstAABB.set(o),this.removeAgainst(t),c=o.left;c<=o.right;c++)for(d=o.top;d<=o.bottom;d++){for((l=u[h=(d<<16^c)>>>0])||(l=u[h]=s.setUp()),i=r.length;i--;)n=r[i],(e=l.get(n))||(e=l.set(n,Array.setUp())),e.push(t);a.push(l)}o.recycle()},addCollisionEntity:function(e){e.getTileShapes?this.terrain=e:e.collisionTypes&&(e.againstGrid=Array.setUp(),e.againstAABB=t.setUp(),this.updateAgainst(e))},removeCollisionEntity:function(t){t.againstGrid&&(this.removeAgainst(t),t.againstGrid.recycle(),t.againstGrid=null,t.againstAABB.recycle(),t.againstAABB=null)},checkCamera:function(t,e){var i=e.length,n=0,s=this.allEntitiesLive,r=this.softEntitiesLive,o=this.solidEntitiesLive,h=this.nonColliders,l=this.groupsLive,u=null,c=null,d=!1;for(s.length=0,o.length=0,r.length=0,h.length=0,l.length=0;i--;)if(d=!1,c=(u=e[i]).collisionTypes,!u.immobile&&c&&c.length){if(s.push(u),u!==this.owner)for(n=c.length;n--;)if(u.solidCollisionMap.get(c[n]).length){o.push(u),d=!0;break}for(n=c.length;n--;)if(u.softCollisionMap.get(c[n]).length){r.push(u);break}d||h.push(u),u.collisionGroup&&l.push(u)}l.sort(a)},resolveNonCollisions:function(){var t=null,e=this.relocationMessage,i=this.nonColliders,n=i.length;for(e.relative=!1;n--;)((t=i[n]).position.x!==t.previousPosition.x||t.position.y!==t.previousPosition.y)&&(e.position.setVector(t.position),t.triggerEvent("relocate-entity",e),this.updateAgainst(t))},checkGroupCollisions:function(){var t=function(t,e,i,n,s,r,a,h){var l=o;l.entity=e,l.myType=i,l.type=n,l.x=s,l.y=r,l.direction=h,l.hitType=a,t.triggerEvent("hit-by-"+n,l),e&&(l.entity=t,l.type=i,l.myType=n,l.x=-s,l.y=-r,l.direction=h.getInverse(),l.hitType=a,e.triggerEvent("hit-by-"+i,l),l.direction.recycle())};return function(){for(var e=0,i=this.groupsLive,n=i.length,s=null,r=null,o=null,a=null;n--;)if((s=i[n]).collisionGroup.getSize()>1){for(e=(r=(a=this.checkSolidEntityCollision(s,s.collisionGroup)).xData).length;e--;)o=r[e],t(o.thisShape.owner,o.thatShape.owner,o.thisShape.collisionType,o.thatShape.collisionType,o.direction,0,"solid",o.vector);for(e=(r=a.yData).length;e--;)o=r[e],t(o.thisShape.owner,o.thatShape.owner,o.thisShape.collisionType,o.thatShape.collisionType,0,o.direction,"solid",o.vector);a.recycle()}}}(),checkSolidCollisions:function(){var t=function(t,e,i,n,s,r,a,h){var l=o;l.entity=e,l.myType=i,l.type=n,l.x=s,l.y=r,l.direction=h,l.hitType=a,t.triggerEvent("hit-by-"+n,l),e&&(l.entity=t,l.type=i,l.myType=n,l.x=-s,l.y=-r,l.direction=h.getInverse(),l.hitType=a,e.triggerEvent("hit-by-"+i,l),l.direction.recycle())};return function(){for(var e=0,i=this.solidEntitiesLive,n=i.length,s=null,r=null,o=null,a=null,h=t;n--;){for(s=i[n],e=(r=(a=this.checkSolidEntityCollision(s,s)).xData).length;e--;)h((o=r[e]).thisShape.owner,o.thatShape.owner,o.thisShape.collisionType,o.thatShape.collisionType,o.direction,0,"solid",o.vector);for(e=(r=a.yData).length;e--;)h((o=r[e]).thisShape.owner,o.thatShape.owner,o.thisShape.collisionType,o.thatShape.collisionType,0,o.direction,"solid",o.vector);a.recycle()}}}(),checkSolidEntityCollision:function(t,e){var n=i.setUp(),s=0,o=null,a=null,h=t.previousX,l=t.previousY,u=t.x-h,c=t.y-l,d=1/0,p=1/0,f=e.getCollisionTypes(),g=0,v=!1,m=null;if(e.getSolidEntities&&(v=e.getSolidEntities()),o=r.setUp(t.position),u||c){if(t.bullet){for(m=Math.min,g=f.length;g--;)d=m(d,(a=e.getAABB(f[g])).width),p=m(p,a.height);for(u/=s=m(s=Math.ceil(Math.max(Math.abs(u)/d,Math.abs(c)/p)),100),c/=s;s--;){if(e.prepareCollision(t.previousX+u,t.previousY+c),(o=this.processCollisionStep(t,e,v,n,o.setVector(t.position),u,c,f)).x===t.previousX&&o.y===t.previousY){e.relocateEntity(o,n);break}e.relocateEntity(o,n)}}else e.prepareCollision(t.previousX+u,t.previousY+c),o=this.processCollisionStep(t,e,v,n,o,u,c,f),e.relocateEntity(o,n);(o.x!==h||o.y!==l)&&this.updateAgainst(t)}return o.recycle(),n},processCollisionStep:function(){var e=t.setUp(),i=function(t,e,i,n,s,r){var o=0;if(i===t)return!1;if(i.jumpThrough&&e.bottom>n.top)return!1;if(t.jumpThrough&&n.bottom>e.top)return!1;if(s)for(o=s.length;o--;)if(i===s[o])return!1;return r.collides(n)};return function(t,n,s,r,o,a,h,l){for(var u=l.length,c=0,d=0,p=0,f=i,g=!1,v=Array.setUp(),m=null,y=null,_=null,b=null,w=null,x="",T=null,E=null,S=null,A=this.terrain,P=null,C=n.getSolidCollisions(),M=null,L=e;u--;){for(v[u]=m=Array.setUp(),b=l[u],y=n.getPreviousAABB(b),_=n.getAABB(b),L.set(_),L.include(y),M=C.get(b),P=this.getAgainstGrid(t,L,M),c=M.length;c--;)if(S=P[x=M[c]]){for(d=S.length;d--;)if(T=(w=S[d]).getAABB(x),f(t,y,w,T,s,L)){for(p=(E=w.getShapes(x)).length;p--;)m.push(E[p]);g=!0}S.recycle()}else if(A)for(d=(E=A.getTileShapes(L,y,x)).length;d--;)m.push(E[d]),g=!0;P.recycle()}return g&&(o=this.resolveCollisionPosition(t,n,o,v,r,l,a,h)),v.recycle(2),o}}(),resolveCollisionPosition:function(t,e,i,n,s,r,o,a){var h=0,l=null;if(0!==o)for(h=r.length;h--;)(l=this.findMinAxisMovement(t,e,r[h],"x",n[h])).occurred&&s.tryToAddX(l)||l.recycle();if(l=s.xData[0],i.x=l?t.previousX+l.deltaMovement*l.direction:t.x,e.movePreviousX(i.x),0!==a)for(h=r.length;h--;)(l=this.findMinAxisMovement(t,e,r[h],"y",n[h])).occurred&&s.tryToAddY(l)||l.recycle();return l=s.yData[0],i.y=l?t.previousY+l.deltaMovement*l.direction:t.y,i},findMinAxisMovement:function(t,i,n,s,r){for(var o=e.setUp(),a=i.getShapes(n),h=i.getPrevShapes(n),l=null,u=a.length;u--;)(l=this.findMinShapeMovementCollision(h[u],a[u],s,r)).occurred&&(!o.occurred||l.deltaMovement<o.deltaMovement)?(o.recycle(),o=l):l.recycle();return o},findMinShapeMovementCollision:function(){var t={position:0,contactVector:r.setUp()},i=function(t,e){var i=Math.pow;return Math.sqrt(i(e,2)-i(t,2))},n=function(t,e,i){var n=t-e;return n-n/Math.abs(n)*i},s=function(t,e,s,r,o){var a=0,h=e.aABB,l=h.halfWidth,u=t.x,c=t.y;return c>=h.top&&c<=h.bottom?l+t.radius:(c=n(c,e.y,h.halfHeight),a=l+i(c,t.radius),s===t?(o.x=-n(u-r*a,e.x,l)/2,c=-c):o.x=n(u,e.x-r*a,l)/2,o.y=c,o.normalize(),a)},o=function(t,e,s,r,o){var a=0,h=e.aABB,l=h.halfHeight,u=t.x,c=t.y;return u>=h.left&&u<=h.right?l+t.radius:(u=n(u,e.x,h.halfWidth),a=l+i(u,t.radius),s===t?(u=-u,o.y=-n(c-r*a,e.y,l)/2):o.y=n(c,e.y-r*a,l)/2,o.x=u,o.normalize(),a)},a={x:{rectangle:{rectangle:function(e,i,n){var s=t;return s.position=n.x-e*(n.aABB.halfWidth+i.aABB.halfWidth),s.contactVector.setXYZ(e,0),s},circle:function(e,i,n){var r=t;return r.position=n.x-e*s(n,i,i,e,r.contactVector.setXYZ(e,0)),r}},circle:{rectangle:function(e,i,n){var r=t;return r.position=n.x-e*s(i,n,i,e,r.contactVector.setXYZ(e,0)),r},circle:function(e,n,s){var r=s.y-n.y,o=s.x-e*i(r,n.radius+s.radius),a=t;return a.contactVector.setXYZ(s.x-o,r).normalize(),a.position=o,a}}},y:{rectangle:{rectangle:function(e,i,n){var s=t;return s.position=n.y-e*(n.aABB.halfHeight+i.aABB.halfHeight),s.contactVector.setXYZ(0,e),s},circle:function(e,i,n){var s=t;return s.position=n.y-e*o(n,i,i,e,s.contactVector.setXYZ(0,e)),s}},circle:{rectangle:function(e,i,n){var s=t;return s.position=n.y-e*o(i,n,i,e,s.contactVector.setXYZ(0,e)),s},circle:function(e,n,s){var r=s.x-n.x,o=s.y-e*i(r,n.radius+s.radius),a=t;return a.contactVector.setXYZ(r,s.y-o).normalize(),a.position=o,a}}}};return function(t,i,n,s){var r=0,o=t[n],h=i[n],l=t,u=h>o?1:-1,c=h,d=null,p=e.setUp(),f=null,g=h,v=null;if(o!==h)for(v=a[n][l.type],"x"===n?l.moveX(h):"y"===n&&l.moveY(h),r=s.length;r--;)d=s[r],c=h,l.collides(d)&&(c=(f=v[d.type](u,l,d)).position,u>0?g>c&&(o>c&&(c=o),g=c,p.set(!0,u,g,Math.abs(g-o),d.aABB,i,d,f.contactVector,0)):c>g&&(c>o&&(c=o),g=c,p.set(!0,u,g,Math.abs(g-o),d.aABB,i,d,f.contactVector,0)));return p}}(),checkSoftCollisions:function(){var t=function(t){this.triggerEvent("hit-by-"+t.type,t)};return function(){for(var e=this.softEntitiesLive,i=null,n=e.length,s=t;n--;)i=e[n],this.checkEntityForSoftCollisions(i,s.bind(i))}}(),checkEntityForSoftCollisions:function(t,e){var i=null,n=null,s=o,r=t.collisionTypes.length,a=0,h=0,l=0,u=0,c=null,d=null,p=null,f=null,g=null,v=null,m=!1;for(s.x=0,s.y=0;r--;){for(c=t.collisionTypes[r],d=t.softCollisionMap.get(c),i=this.getEntityAgainstGrid(t,d),a=d.length;a--;)if(p=i[f=d[a]]){for(h=p.length;h--;)if((n=p[h])!==t&&t.getAABB(c).collides(n.getAABB(f)))for(m=!1,g=t.getShapes(c),v=n.getShapes(f),l=g.length;l--;){for(u=v.length;u--;)if(g[l].collides(v[u])){s.entity=n,s.type=f,s.myType=c,s.shape=v[u],s.hitType="soft",e(s),m=!0;break}if(m)break}p.recycle()}i.recycle()}},destroy:function(){var t=this.againstGrid,e=null,i="",n=null,s=0;for(i in this.groupsLive.recycle(),this.nonColliders.recycle(),this.allEntitiesLive.recycle(),this.softEntitiesLive.recycle(),this.solidEntitiesLive.recycle(),this.relocationMessage.position.recycle(),this.relocationMessage.recycle(),t)if(t.hasOwnProperty(i)){for(s=(n=(e=t[i]).keys).length;s--;)e.get(n[s]).recycle();e.recycle()}t.recycle(),this.againstGrid=null}},publicMethods:{getWorldEntities:function(){return this.allEntitiesLive},getWorldTerrain:function(){return this.terrain},getEntityCollisions:function(t){var e=Array.setUp();return this.checkEntityForSoftCollisions(t,(function(t){e.push(n.setUp(t))})),e}}})}(),function(){"use strict";var t={kc0:"unknown",kc8:"backspace",kc9:"tab",kc12:"numpad-5-shift",kc13:"enter",kc16:"shift",kc17:"ctrl",kc18:"alt",kc19:"pause",kc20:"caps-lock",kc27:"esc",kc32:"space",kc33:"page-up",kc34:"page-down",kc35:"end",kc36:"home",kc37:"left-arrow",kc38:"up-arrow",kc39:"right-arrow",kc40:"down-arrow",kc42:"numpad-multiply",kc43:"numpad-add",kc44:"print-screen",kc45:"insert",kc46:"delete",kc47:"numpad-division",kc48:"0",kc49:"1",kc50:"2",kc51:"3",kc52:"4",kc53:"5",kc54:"6",kc55:"7",kc56:"8",kc57:"9",kc59:"semicolon",kc61:"equals",kc65:"a",kc66:"b",kc67:"c",kc68:"d",kc69:"e",kc70:"f",kc71:"g",kc72:"h",kc73:"i",kc74:"j",kc75:"k",kc76:"l",kc77:"m",kc78:"n",kc79:"o",kc80:"p",kc81:"q",kc82:"r",kc83:"s",kc84:"t",kc85:"u",kc86:"v",kc87:"w",kc88:"x",kc89:"y",kc90:"z",kc91:"left-windows-start",kc92:"right-windows-start",kc93:"windows-menu",kc96:"back-quote",kc106:"numpad-multiply",kc107:"numpad-add",kc109:"numpad-minus",kc110:"numpad-period",kc111:"numpad-division",kc112:"f1",kc113:"f2",kc114:"f3",kc115:"f4",kc116:"f5",kc117:"f6",kc118:"f7",kc119:"f8",kc120:"f9",kc121:"f10",kc122:"f11",kc123:"f12",kc144:"num-lock",kc145:"scroll-lock",kc186:"semicolon",kc187:"equals",kc188:"comma",kc189:"hyphen",kc190:"period",kc191:"forward-slash",kc192:"back-quote",kc219:"open-bracket",kc220:"back-slash",kc221:"close-bracket",kc222:"quote"};platypus.createComponentClass({id:"HandlerController",constructor:function(){this.callbackKeyUp=null,this.callbackKeyDown=null,platypus.game.settings.debug?(this.callbackKeyDown=function(t){this.keyDown(t)}.bind(this),this.callbackKeyUp=function(t){this.keyUp(t)}.bind(this)):(this.callbackKeyDown=function(t){this.keyDown(t),t.preventDefault()}.bind(this),this.callbackKeyUp=function(t){this.keyUp(t),t.preventDefault()}.bind(this)),window.addEventListener("keydown",this.callbackKeyDown,!0),window.addEventListener("keyup",this.callbackKeyUp,!0)},events:{tick:function(t){this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("handle-controller",t)}},methods:{keyDown:function(e){this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("key:"+(t["kc"+e.keyCode]||"key-code-"+e.keyCode)+":down",e)},keyUp:function(e){this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("key:"+(t["kc"+e.keyCode]||"key-code-"+e.keyCode)+":up",e)},destroy:function(){window.removeEventListener("keydown",this.callbackKeyDown),window.removeEventListener("keyup",this.callbackKeyUp)}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=function(t,e){var i=t.length;for(e.length=0;i--;)e.push(t[i])},i=function(t,e){return t.alwaysOn||t.aabb&&e.collides(t.getAABB())||void 0===t.x||e.containsPoint(t.x,t.y)},n=function(t,e,n){var s=t.length,r=null;for(e.length=0;s--;)r=t[s],i(r,n)&&e.push(r)},s=function(t){return"handle-logic"===t||"handle-post-collision-logic"===t||"prepare-logic"===t||"state-changed"===t||"handle-movement"===t};platypus.createComponentClass({id:"HandlerLogic",properties:{alwaysOn:!1},publicProperties:{buffer:-1,stepLength:5,maxStepsPerTick:100,timeMultiplier:1},constructor:function(){this.entities=Array.setUp(),this.activeEntities=Array.setUp(),this.removals=Array.setUp(),this.inLogicLoop=!1,this.alwaysOn?(this.updateList=e,this.camera=null):(this.updateList=n,this.camera=t.setUp()),this.paused=0,this.leftoverTime=0,this.message={delta:this.stepLength,tick:null,camera:this.camera,entities:this.activeEntities}},events:{"child-entity-added":function(t){t.getMessageIds().some(s)&&(this.entities.push(t),!this.inLogicLoop||this.camera&&!i(t,this.camera)||this.activeEntities.push(t))},"child-entity-removed":function(t){var e=this.entities.indexOf(t);e>=0&&(this.entities.greenSplice(e),this.inLogicLoop&&this.removals.push(t))},"pause-logic":function(t){t&&t.time?this.paused=t.time:this.paused=-1,this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("logic-paused")},"unpause-logic":function(){this.paused=0,this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("logic-unpaused")},"camera-update":function(t){var e=this.buffer,i=this.camera,n=null;i&&(-1===e&&(e=t.viewport.width/10),n=t.viewport,i.setBounds(n.left-e,n.top-e,n.right+e,n.bottom+e))},tick:function(t){var e=0,i=0,n=0,s=null,r=this.message,o=this.activeEntities,a=this.removals,h=this.stepLength;for(this.leftoverTime+=t.delta*this.timeMultiplier,n=Math.floor(this.leftoverTime/h)||1,r.delta=h,this.leftoverTime=Math.max(this.leftoverTime-n*h,0),r.tick=t,this.updateList(this.entities,o,this.camera),n=Math.min(n,this.maxStepsPerTick);n--;)if(this.paused>0&&(this.paused-=h,this.paused<0&&(this.paused=0)),!this.paused){for(this.owner.triggerEvent("logic-tick",r),this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("handle-ai",r),this.inLogicLoop=!0,e=o.length;e--;)(s=o[e]).triggerEvent("prepare-logic",r),s.triggerEvent("handle-logic",r),s.triggerEvent("handle-movement",r);if(this.inLogicLoop=!1,a.length){for(e=a.length;e--;)(i=o.indexOf(a[e]))>=0&&o.greenSplice(i);a.length=0}if(e=o.length,this.owner.triggerEvent("check-collision-group",r))for(;e--;)(s=o[e]).triggerEvent("handle-post-collision-logic",r),s.lastState.update(s.state)&&s.triggerEvent("state-changed",s.state);else for(;e--;)(s=o[e]).lastState.update(s.state)&&s.triggerEvent("state-changed",s.state)}}},methods:{destroy:function(){this.entities.recycle(),this.activeEntities.recycle(),this.removals.recycle()}}})}(),function(){"use strict";var t=include("PIXI.Container"),e=include("platypus.Data"),i=include("platypus.components.Interactive"),n=include("platypus.Vector");platypus.createComponentClass({id:"HandlerRender",properties:{interactive:!1,acceptInput:null},constructor:function(){var n=null;this.container=new t,this.acceptInput&&(platypus.debug.warn('Entity "'+this.owner.type+'": HandlerRender "acceptInput" property has been deprecated since 0.9.1 in favor of the "interactive" property which adds an "Interactive" component to the entity to handle input.'),this.interactive=this.interactive||this.acceptInput),this.interactive&&(n=e.setUp("container",this.container,"hitArea",this.interactive.hitArea,"hover",this.interactive.hover,"relativeToSelf",!0),this.owner.addComponent(new i(this.owner,n)),n.recycle()),this.renderMessage=e.setUp("delta",0,"container",this.container)},events:{load:function(){this.owner.triggerEvent("render-world",{world:this.container}),this.owner.triggerEvent("input-on")},"child-entity-added":function(t){t.triggerEvent("handle-render-load",this.renderMessage)},"pause-render":function(t){t&&t.time?this.paused=t.time:this.paused=-1,this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("render-paused")},"unpause-render":function(){this.paused=0,this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("render-unpaused")},tick:function(){var t=function(t,e){return t.z-e.z};return function(e){var i=0,n=null,s=this.renderMessage;if(s.delta=e.delta,this.paused>0&&(this.paused-=e.delta,this.paused<=0&&(this.paused=0)),this.owner.triggerEventOnChildren&&this.owner.triggerEventOnChildren("handle-render",s),this.container){for(i=this.container.children.length;i--;)(n=this.container.children[i]).visible&&(n.paused&&!this.paused?n.paused=!1:this.paused&&(n.paused=!0));this.container.reorder&&(this.container.reorder=!1,this.container.children.sort(t))}}}()},methods:{destroy:function(){this.container=null,this.renderMessage.recycle()}},publicMethods:{windowToWorld:function(t,e,i){var s=i||n.setUp();return s.x=t.x*this.worldPerWindowUnitWidth,s.y=t.y*this.worldPerWindowUnitHeight,!1!==e&&(s.x-=this.viewport.x*this.worldPerWindowUnitWidth,s.y-=this.viewport.y*this.worldPerWindowUnitHeight),s},worldToWindow:function(t,e,i){var s=i||n.setUp();return s.x=t.x*this.windowPerWorldUnitWidth,s.y=t.y*this.windowPerWorldUnitHeight,!1!==e&&(s.x+=this.viewport.x,s.y+=this.viewport.y),s}}})}(),function(){"use strict";var t=function(t,e,i,n,s,r){var o=0,a=0,h=0,l=t.greenSlice();if("horizontal"===r){for(a=s-1;a>=0;a--)for(o=a*n,h=0;(a+1)*n>o;o++,h++)l.splice((a+1)*e+h,0,i[o]);return l}return"vertical"===r?t.concat(i):null},e=function(t,e,i,n){var s=0,r="",o=t.greenSlice(),a=null;for(s=0;s<e.length;s++){for(r in a={},e[s])e[s].hasOwnProperty(r)&&(a[r]=e[s][r]);"horizontal"===n?a.x+=i:"vertical"===n&&(a.y+=i),o.push(a)}return o},i=function(i,n,s,r){var o=0,a="";for(i.tilewidth||i.tileheight?(i.tilewidth!==n.tilewidth||i.tileheight!==n.tileheight)&&platypus.debug.warn("Tiled-Loader: Your map has segments with different tile sizes. All tile sizes must match. Segment: "+n):(i.tilewidth=n.tilewidth,i.tileheight=n.tileheight),"horizontal"===s?0===i.height?i.height=n.height:i.height!==n.height&&platypus.debug.warn("Tiled-Loader: You are trying to merge segments with different heights. All segments need to have the same height. Level: "+i+" Segment: "+n):"vertical"===s&&(0===i.width?i.width=n.width:i.width!==n.width&&platypus.debug.warn("Tiled-Loader: You are trying to merge segments with different widths. All segments need to have the same width. Level: "+i+" Segment: "+n)),o=0;o<n.layers.length;o++)if(i.layers[o])i.layers[o].type===n.layers[o].type?i.layers[o].data&&n.layers[o].data?(r(n.layers[o]),"horizontal"===s?(i.layers[o].data=t(i.layers[o].data,i.width,n.layers[o].data,n.width,i.height,s),i.layers[o].width+=n.width):"vertical"===s&&(i.layers[o].data=t(i.layers[o].data,i.height,n.layers[o].data,n.height,i.width,s),i.layers[o].height+=n.height)):i.layers[o].objects&&n.layers[o].objects&&("horizontal"===s?i.layers[o].objects=e(i.layers[o].objects,n.layers[o].objects,i.width*i.tilewidth,s):"vertical"===s&&(i.layers[o].objects=e(i.layers[o].objects,n.layers[o].objects,i.height*i.tileheight,s))):platypus.debug.warn("Tiled-Loader: The layers in your level segments do not match. Level: "+i+" Segment: "+n);else for(a in r(n.layers[o]),i.layers[o]={},n.layers[o])n.layers[o].hasOwnProperty(a)&&(i.layers[o][a]=n.layers[o][a]);for(a in"horizontal"===s?i.width+=n.width:"vertical"===s&&(i.height+=n.height),n)n.hasOwnProperty(a)&&!i[a]&&(i[a]=n[a])},n=function(t,e){var n=0,s=0,r=platypus.game.settings.levels,o={height:0,width:0,layers:[]},a={height:0,width:0,layers:[]},h=t[n].length;for(n=0;n<t.length;n++){for(h!==t[n].length&&platypus.debug.warn("Tiled-Loader: Your map is not square. Maps must have an equal number of segments in every row."),o={height:0,width:0,layers:[]},s=0;s<t[n].length;s++)"string"==typeof t[n][s]?i(o,r[t[n][s]],"horizontal",e):i(o,t[n][s],"horizontal",e);i(a,o,"vertical",e)}return a};platypus.createComponentClass({id:"LevelBuilder",properties:{useUniques:!0,levelTemplate:null,levelPieces:null},publicProperties:{},constructor:function(){this.levelMessage={level:null,persistentData:null}},events:{"scene-loaded":function(t){var e=null,i=null,s="",r=0,o=0,a=0;if(this.levelMessage.persistentData=t,this.levelTemplate=t.levelTemplate||this.levelTemplate,this.useUniques=t.useUniques||this.useUniques,i=t.levelPieces||this.levelPieces,this.levelPieces={},i)for(s in i)if(i.hasOwnProperty(s))if("string"==typeof i[s])this.levelPieces[s]=i[s];else{if(!i[s].length)throw"Level Builder: Level pieces of incorrect type: "+i[s];for(this.levelPieces[s]=[],r=0;r<i[s].length;r++)this.levelPieces[s].push(i[s][r])}if(!this.levelTemplate)throw"Level Builder: There is no level template.";if(!this.levelTemplate)throw"Level Builder: Template is not defined";for(this.levelMessage.level=[],o=0;o<this.levelTemplate.length;o++)if("string"==typeof(e=this.levelTemplate[o]))this.levelMessage.level[o]=this.getLevelPiece(e);else{if(!e.length)throw"Level Builder: Template row is neither a string or array. What is it?";for(this.levelMessage.level[o]=[],a=0;a<e.length;a++)this.levelMessage.level[o][a]=this.getLevelPiece(e[a])}this.levelMessage.level&&(this.levelMessage.level=n(this.levelMessage.level,this.owner.decodeLayer),this.owner.triggerEvent("load-level",this.levelMessage))}},methods:{getLevelPiece:function(t){var e=this.levelPieces[t]||t,i=null,n=0;if(e){if("string"==typeof e)return this.useUniques?(i=e,this.levelPieces[t]=null,i):e;if(e.length)return n=Math.floor(Math.random()*e.length),this.useUniques?this.levelPieces[t].greenSplice(n):e[n];throw"Level Builder: There are no MORE level pieces of type: "+t}throw"Level Builder: There are no level pieces of type: "+t},destroy:function(){this.levelMessage.level=null,this.levelMessage.persistentData=null,this.levelMessage=null}},publicMethods:{mergeLevels:function(t){return n(t,this.owner.decodeLayer)}},getAssetList:function(t,e,i){var n=0,s=null,r=Array.setUp(),o="",a=null;if(t&&t.levelPieces?a=t.levelPieces:e&&e.levelPieces?a=e.levelPieces:i&&i.levelPieces&&(a=i.levelPieces),a)for(o in a)if(a.hasOwnProperty(o))if(Array.isArray(a[o]))for(n=0;n<a[o].length;n++)s=platypus.components.TiledLoader.getAssetList({level:a[o][n]},e,i),r.union(s),s.recycle();else s=platypus.components.TiledLoader.getAssetList({level:a[o]},e,i),r.union(s),s.recycle();return r}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicAngularMovement",properties:{maxVelocity:3,acceleration:.01,visualOffset:0,startAngle:0},publicProperties:{},constructor:function(){this.angle=this.startAngle,this.v=Array.setUp(0,0),this.moving=!1,this.piOverTwo=Math.PI/2,this.owner.rotation=this.owner.rotation||this.visualOffset},events:{"handle-logic":function(t){var e=Math.PI,i=Math.sin,n=Math.cos,s=Math.min,r=Math.max,o=t.delta,a=0;this.moving&&(this.v[0]+=this.acceleration*n(this.angle)*o,this.v[1]+=this.acceleration*i(this.angle)*o,0===this.v[0]?a=this.v[1]>0?this.piOverTwo:this.v[1]<0?-this.piOverTwo:this.angle:(a=Math.atan(this.v[1]/this.v[0]),this.v[0]<0&&(a=e+a)),this.v[0]>=0?this.v[0]=s(this.v[0],this.maxVelocity*n(a)):this.v[0]=r(this.v[0],this.maxVelocity*n(a)),this.v[1]>=0?this.v[1]=s(this.v[1],this.maxVelocity*i(a)):this.v[1]=r(this.v[1],this.maxVelocity*i(a)),this.owner.x+=this.v[0],this.owner.y+=this.v[1],this.owner.rotation=a*(180/e)+this.visualOffset)},"set-angle":function(t){this.angle=t},move:function(){this.moving=!0},stop:function(){this.moving=!1,this.v[0]=0,this.v[1]=0},"set-max-velocity":function(t){this.maxVelocity=t}},methods:{destroy:function(){this.v.recycle()}}})}(),function(){"use strict";var t=include("platypus.Entity"),e=0;platypus.createComponentClass({id:"LogicAttachment",properties:{attachState:"attached",attachment:"",offsetX:0,offsetY:0,offsetZ:.01},publicProperties:{},constructor:function(){this.state=this.owner.state,this.owner.linkId||(this.owner.linkId="attachment-link-"+e,e+=1),this.state.set(this.attachState,!1),this.attachmentPosition={x:0,y:0,z:0,dx:0,dy:0,linkId:this.owner.linkId},this.attachmentProperties={type:this.attachment,properties:this.attachmentPosition},this.attachment=null,this.isAttached=!1},events:{"handle-logic":function(){var t=0,e=this.state;this.isAttached?(this.attachment||(this.attachmentPosition.x=this.owner.x,this.attachmentPosition.y=this.owner.y,this.attachmentPosition.z=this.owner.z,this.attachment=this.owner.parent.addEntity(this.attachmentProperties)),this.attachment.destroyed?(this.owner.parent.removeEntity(this.attachment),this.attachment=null,this.isAttached=!1):(this.attachment.x=this.owner.x,t=this.offsetX,e.get("left")?(t*=-1,this.attachment.rotation=180):e.get("right")&&(this.attachment.rotation=0),this.attachment.x+=t,this.attachment.y=this.owner.y,t=this.offsetY,e.get("top")?(t*=-1,this.attachment.rotation=90):e.get("bottom")&&(this.attachment.rotation=-90),this.attachment.y+=t,this.attachment.z=this.owner.z,this.attachment.z+=this.offsetZ)):this.attachment&&(this.owner.parent.removeEntity(this.attachment),this.attachment=null),e.set(this.attachState,this.isAttached)},attach:function(t){this.isAttached=!t||!1!==t.pressed},detach:function(){this.isAttached=!1}},methods:{destroy:function(){this.state.set(this.attachState,!1),this.attachment&&(this.owner.parent.removeEntity(this.attachment),this.attachment=null),this.isAttached=!1,this.state=null}},getAssetList:function(e,i,n){var s=e.attachment||i.attachment||n.attachment;return s?t.getAssetList({type:s}):Array.setUp()}})}(),function(){"use strict";var t=include("platypus.Data");platypus.components.LogicCanvasButton=platypus.createComponentClass({id:"LogicButton",properties:{onPress:"",onRelease:"",onCancel:"",onHover:"",useOnce:!1,disabled:!1,toggle:!1,pressed:!1},publicProperties:{bottom:null,left:null,right:null,top:null},constructor:function(){var t=this.owner.state;this.state=t,t.set("disabled",this.disabled),t.set("down",this.pressed),t.set("released",!this.pressed),t.set("pressed",this.pressed),t.set("highlighted",!1),this.owner.buttonMode=!this.disabled,this.cancelled=!1},events:{"camera-update":function(t){var e=this.bottom,i=this.left,n=this.owner,s=this.right,r=this.top,o=t.viewport;"number"==typeof i?n.x=o.left+i:"number"==typeof s&&(n.x=o.right-s),"number"==typeof r?n.y=o.top+r:"number"==typeof e&&(n.y=o.bottom-e)},mousedown:function(t){this.toggle||this.state.get("disabled")||(this.onPress&&this.owner.trigger(this.onPress),this.updateStateAndTrigger("pressed"),t.pixiEvent.stopPropagation(),this.useOnce&&this.removeEventListener("mousedown"))},pressup:function(t){var e=this.state;e.get("disabled")||(this.cancelled?(this.onCancel&&this.owner.trigger(this.onCancel),this.updateStateAndTrigger("cancelled")):this.toggle?e.get("pressed")?this.updateStateAndTrigger("released"):this.updateStateAndTrigger("pressed"):(this.onRelease&&this.owner.trigger(this.onRelease),this.updateStateAndTrigger("released")),t.pixiEvent.stopPropagation(),this.useOnce&&(this.removeEventListener("pressup"),this.state.set("disabled",!0),this.owner.buttonMode=!1)),this.cancelled=!1},mouseover:function(){this.onHover&&this.owner.trigger(this.onHover),this.state.get("pressed")&&(this.cancelled=!1)},mouseout:function(){this.state.get("pressed")&&(this.cancelled=!0)},disable:function(){this.state.set("disabled",!0),this.owner.buttonMode=!1},enable:function(){this.state.set("disabled",!1),this.owner.buttonMode=!0},"toggle-disabled":function(){var t=this.state.get("disabled");this.owner.buttonMode=t,this.state.set("disabled",!t)},highlight:function(){this.state.set("highlighted",!0)},unhighlight:function(){this.state.set("highlighted",!1)},"toggle-highlight":function(){var t=this.state;t.set("highlighted",!t.get("highlighted"))}},methods:{updateStateAndTrigger:function(e){var i=null,n=this.state,s=n.get("pressed"),r=n.get("released"),o=!1;r&&"pressed"===e?(n.set("pressed",!0),n.set("down",!1),n.set("released",!1),o=!0):!s||"released"!==e&&"cancelled"!==e||(n.set("pressed",!1),n.set("down",!1),n.set("released",!0),o=!0),o&&(i=t.setUp("released",s,"pressed",r,"triggered",r),this.owner.triggerEvent(e,i),i.recycle())},destroy:function(){this.owner.buttonMode=!1,this.state=null}}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicCarrier",constructor:function(){},events:{load:function(){this.owner.triggerEvent("add-collision-entity",this.owner)||(this.owner.addComponent(new platypus.components.CollisionGroup(this.owner,{})),this.owner.triggerEvent("add-collision-entity",this.owner))},"carry-me":function(t){this.owner.triggerEvent("add-collision-entity",t.entity)},"release-me":function(t){this.owner.triggerEvent("remove-collision-entity",t.entity)}}})}(),function(){"use strict";var t=function(t){var e=function(t,e){return e&&!t.message?{event:t.event,message:e,delay:t.delay,repeat:t.repeat}:t};return t.singleInstance?function(i){var n=0,s=!0;for(n=0;n<this.queue.length;n++)this.queue[n].event===t.event&&(s=!1);s&&(this.queue.push(e(t,i)),this.queueTimes.push(t.delay))}:function(i){this.queue.push(e(t,i)),this.queueTimes.push(t.delay)}},e=function(t){return function(){var e=0;for(e=this.queue.length-1;e>-1;e--)this.queue[e]===t&&(this.queueTimes.greenSplice(e),this.queue.greenSplice(e))}};platypus.createComponentClass({id:"LogicDelayMessage",constructor:function(i){var n="";if(this.queueTimes=Array.setUp(),this.queue=Array.setUp(),i.events)for(n in i.events)i.events.hasOwnProperty(n)&&(this.addEventListener(n,t(i.events[n])),i.events[n].cancelEvent&&this.addEventListener(i.events[n].cancelEvent,e(i.events[n])))},events:{"handle-logic":function(t){for(var e=this.queue.length;e--;)this.queueTimes[e]-=t.delta,this.queueTimes[e]<=0&&(this.owner.trigger(this.queue[e].event,this.queue[e].message),this.queue[e]&&(this.queue[e].repeat?this.queueTimes[e]+=this.queue[e].delay:(this.queueTimes.greenSplice(e),this.queue.greenSplice(e))))}},methods:{destroy:function(){this.queueTimes.recycle(),this.queue.recycle()}}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicDestroyMe",properties:{delay:0,destroyed:!1},events:{"prepare-logic":function(t){var e=t.delta;this.destroyed&&!this.owner.state.get("paused")&&(this.delay-=e,this.delay<=0&&this.owner.parent.removeEntity(this.owner))},"destroy-me":function(){this.destroyed=!0}}})}(),function(){"use strict";var t=function(t){return function(e){this[t]=!e||!1!==e.pressed}},e=function(){},i={x:function(t,e){t!==e&&(t>180&&180>=e||180>=t&&e>180)&&this.owner.triggerEvent("transform","vertical")},y:function(t,e){t!==e&&(t>90&&270>=t&&(90>=e||e>270)||(90>=t||t>270)&&e>90&&270>=e)&&this.owner.triggerEvent("transform","horizontal")},z:function(t,e){t!==e&&this.owner.triggerEvent("replace-transform","rotate-"+t)}};platypus.createComponentClass({id:"LogicDirectionalMovement",properties:{axis:"y",speed:.3},constructor:function(){var t=this.state=this.owner.state;"number"==typeof this.speed&&(this.speed=[this.speed,0,0]),this.initialVector=platypus.Vector.setUp(this.speed),this.reorient=i[this.axis],this.reorient||(this.reorient=e),this.moving=t.set("moving",!1),this.left=t.set("left",!1),this.right=t.set("right",!1),this.up=t.set("up",!1),this.down=t.set("down",!1),this.upLeft=!1,this.upRight=!1,this.downLeft=!1,this.downRight=!1,this.heading=0,this.owner.heading=this.owner.heading||0},events:{"component-added":function(t){if(t===this){if(!this.owner.addMover)return void platypus.debug.warn('The "LogicDirectionalMovement" component requires a "Mover" component to function correctly.');this.direction=this.owner.addMover({velocity:this.speed,drag:0,friction:0,stopOnCollision:!1,orient:!1,aliases:{moving:"control-velocity"}}).velocity,this.owner.heading!==this.heading&&(this.direction.setVector(this.initialVector).rotate(this.owner.heading/180*Math.PI),this.heading=this.owner.heading),this.owner.triggerEvent("moving",this.moving)}},"handle-logic":function(){var t=this.state,e=this.up||this.upLeft||this.downLeft,i=this.upLeft||this.up&&this.left,n=this.left||this.upLeft||this.downLeft,s=this.downLeft||this.down&&this.left,r=this.down||this.downLeft||this.downRight,o=this.downRight||this.down&&this.right,a=this.right||this.upRight||this.downRight,h=this.upRight||this.up&&this.right;if(n&&a||e&&r)this.moving=!1;else if(i)this.moving=!0,this.heading=225;else if(h)this.moving=!0,this.heading=315;else if(s)this.moving=!0,this.heading=135;else if(o)this.moving=!0,this.heading=45;else if(n)this.moving=!0,this.heading=180;else if(a)this.moving=!0,this.heading=0;else if(e)this.moving=!0,this.heading=270;else if(r)this.moving=!0,this.heading=90;else switch(this.moving=!1,this.heading){case 270:e=!0;break;case 90:r=!0;break;case 180:n=!0;break;case 225:e=!0,n=!0;break;case 315:e=!0,a=!0;break;case 135:r=!0,n=!0;break;case 45:r=!0,a=!0;break;case 0:default:a=!0}this.owner.heading!==this.heading&&(this.direction.setVector(this.initialVector).rotate(this.heading/180*Math.PI),this.reorient(this.heading,this.owner.heading),this.owner.heading=this.heading),t.get("moving")!==this.moving&&(this.owner.triggerEvent("moving",this.moving),t.set("moving",this.moving)),t.set("up",e),t.set("right",a),t.set("down",r),t.set("left",n)},"go-down":t("down"),"go-south":t("down"),"go-down-left":t("downLeft"),"go-southwest":t("downLeft"),"go-left":t("left"),"go-west":t("left"),"go-up-left":t("upLeft"),"go-northwest":t("upLeft"),"go-up":t("up"),"go-north":t("up"),"go-up-right":t("upRight"),"go-northeast":t("upRight"),"go-right":t("right"),"go-east":t("right"),"go-down-right":t("downRight"),"go-southeast":t("downRight"),stop:function(t){t&&!1===t.pressed||(this.left=!1,this.right=!1,this.up=!1,this.down=!1,this.upLeft=!1,this.upRight=!1,this.downLeft=!1,this.downRight=!1)},face:function(){var t={up:270,north:270,down:90,south:90,left:180,west:180,right:0,east:0,"up-left":225,northwest:225,"up-right":315,northeast:315,"down-left":135,southwest:135,"down-right":45,southeast:45};return function(e){this.heading=t[e]||0}}(),accelerate:function(t){this.initialVector.normalize().multiply(t),this.direction.normalize().multiply(t)}},methods:{destroy:function(){this.initialVector.recycle(),this.state=null}}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicDragDrop",properties:{dragZ:1e4,stickyClick:!1},constructor:function(){this.nextX=this.owner.x,this.nextY=this.owner.y,this.lastZ=this.owner.z,this.grabOffsetX=0,this.grabOffsetY=0,this.state=this.owner.state,this.state.set("dragging",!1),this.state.set("noDrop",!1),this.tryDrop=!1,this.hitSomething=!1,this.hasCollision=!1,platypus.supports.mobile&&(this.stickyClick=!1)},events:{"component-added":function(t){"CollisionBasic"===t.type&&(this.hasCollision=!0)},"handle-logic":function(){this.state.get("dragging")&&(this.owner.x=this.nextX,this.owner.y=this.nextY,this.owner.triggerEvent("hovering")),this.state.set("noDrop",!1)},"handle-post-collision-logic":function(){this.tryDrop?(this.tryDrop=!1,this.hitSomething?(this.dropFailed=!1,this.state.set("noDrop",!0),this.state.set("dragging",!0),this.owner.dragMode=!0):(this.state.set("noDrop",!1),this.state.set("dragging",!1),this.owner.dragMode=!1)):this.hitSomething&&this.state.set("noDrop",!0),this.hitSomething=!1},mousedown:function(t){this.sticking?(this.sticking=!1,this.release()):(this.nextX=this.owner.x,this.nextY=this.owner.y,this.lastZ=this.owner.z,this.grabOffsetX=t.x-this.owner.x,this.grabOffsetY=t.y-this.owner.y,this.owner.z=this.dragZ,this.state.set("dragging",!0),this.owner.dragMode=!0,this.sticking=this.stickyClick),t.pixiEvent.stopPropagation()},pressup:function(t){this.sticking||this.release(),t.pixiEvent.stopPropagation()},mousemove:function(t){this.sticking&&(this.nextX=t.x-this.grabOffsetX,this.nextY=t.y-this.grabOffsetY,t.event.preventDefault(),t.pixiEvent.stopPropagation())},pressmove:function(t){this.nextX=t.x-this.grabOffsetX,this.nextY=t.y-this.grabOffsetY,(this.nextX!==this.owner.x||this.nextY!==this.owner.y)&&(this.sticking=!1),t.event.preventDefault(),t.pixiEvent.stopPropagation()},"no-drop":function(){this.hitSomething=!0}},methods:{release:function(){this.hasCollision?this.tryDrop=!0:(this.state.set("noDrop",!1),this.state.set("dragging",!1),this.owner.dragMode=!1,this.owner.z=this.lastZ)},destroy:function(){this.state.set("dragging",!1),this.owner.dragMode=!1,this.state.set("noDrop",!1),this.state=null,this.owner.z=this.lastZ}}})}(),function(){"use strict";var t=include("platypus.Vector");platypus.createComponentClass({id:"LogicImpactLaunch",properties:{accelerationX:-.3,accelerationY:-.8,flipX:!0,flipY:!1},constructor:function(t){this.stunState=t.state||"stunned",this.flipX=this.flipX?-1:1,this.flipY=this.flipY?-1:1,this.justJumped=!1,this.stunned=!1,this.state=this.owner.state,this.state.set("impact",!1),this.state.set(this.stunState,!1)},events:{"component-added":function(e){if(e===this){if(!this.owner.addMover)return void platypus.debug.warn('The "LogicDirectionalMovement" component requires a "Mover" component to function correctly.');this.direction=this.owner.addMover({velocity:[0,0,0],orient:!1}).velocity,this.vector=t.setUp()}},"handle-logic":function(){this.state.set("impact",this.justJumped),this.state.set(this.stunState,this.stunned),this.justJumped&&(this.direction.setVector(this.vector),this.justJumped=!1,this.stunned=!0)},"impact-launch":function(t){var e=t.x,i=t.y;t.entity&&(e=t.entity.x-this.owner.x,i=t.entity.y-this.owner.y),this.stunned||(this.justJumped=!0,e>=0?this.vector.x=this.accelerationX:0>e&&(this.vector.x=this.accelerationX*this.flipX),i>=0?this.vector.y=this.accelerationY:0>i&&(this.vector.y=this.accelerationY*this.flipY))},"hit-solid":function(t){this.stunned&&t.y>0&&(this.direction.x=0,this.direction.y=0,this.stunned=!1)}},methods:{destroy:function(){this.vector.recycle(),this.state=null}}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicPacingPlatform",constructor:function(t){this.ang=this.owner.angle||t.angle||0,this.dist=this.owner.distance||t.distance||128,this.dX=this.dist*Math.cos(this.ang),this.dY=this.dist*Math.sin(this.ang),this.period=this.owner.period||t.period||4e3,this.time=0,this.startPos=this.owner.startPos||t.startPos||0,this.offset=0,this.originX=this.owner.x,this.originY=this.owner.y},events:{"handle-logic":function(t){var e=this.period,i=t.delta;this.time+=i,this.time>e&&(this.time=this.time%e),this.offset=this.time/e*2*Math.PI,this.owner.x=this.originX+Math.sin(this.offset+this.startPos)*this.dX,this.owner.y=this.originY+Math.sin(this.offset+this.startPos)*this.dY}}})}(),function(){"use strict";var t={down:!0};platypus.createComponentClass({id:"LogicPortable",constructor:function(e){this.portableDirections=e.portableDirections||t,this.carrier=this.lastCarrier=null,this.message={entity:this.owner}},events:{"handle-logic":function(){var t=this.message;this.carrierConnected?(this.carrier!==this.lastCarrier&&(this.lastCarrier&&this.lastCarrier.triggerEvent("release-me",t),this.carrier.triggerEvent("carry-me",t)),this.carrierConnected=!1):this.carrier&&(this.carrier.triggerEvent("release-me",t),this.carrier=null),this.lastCarrier=this.carrier},"hit-solid":function(t){t.y>0?this.updateCarrier(t.entity,"down"):t.y<0?this.updateCarrier(t.entity,"up"):t.x<0?this.updateCarrier(t.entity,"left"):t.x>0&&this.updateCarrier(t.entity,"right")}},methods:{updateCarrier:function(t,e){this.portableDirections[e]&&t&&(t!==this.carrier&&(this.carrier=t),this.carrierConnected=!0)}}})}(),function(){"use strict";var t=include("platypus.DataMap");platypus.createComponentClass({id:"LogicPortal",constructor:function(e){var i=0,n=e.entrants||e.entrant||"no one",s=this.owner.state;if(this.destination=this.owner.destination||e.destination,this.used=!1,this.ready=!1,this.wasReady=!1,this.entrants=t.setUp(),Array.isArray(n))for(i=0;i<n.length;i++)this.entrants.set(n[i],!1);else this.entrants.set(n,!1);this.state=s,s.set("occupied",!1),s.set("ready",!0)},events:{"handle-logic":function(){var t=this.entrants,e=t.keys,i=e.length,n=!1,s=!0,r=this.state;for(!this.used&&this.activated?(this.owner.triggerEvent("port-"+this.destination),this.used=!0):this.ready&&!this.wasReady?(this.owner.triggerEvent("portal-waiting"),this.wasReady=!0):this.wasReady&&!this.ready&&(this.owner.triggerEvent("portal-not-waiting"),this.wasReady=!1);i--;)t[e[i]]?(n=!0,t.set(e[i],!1)):s=!1;r.set("occupied",n),r.set("ready",s),this.ready=!1},"occupied-portal":function(t){var e=this.entrants,i=e.keys,n=i.length;for(e.set(t.entity.type,!0);n--;)if(!e.get(i[n]))return;this.ready=!0},"activate-portal":function(){this.activated=!0}},methods:{destroy:function(){this.state=null,this.entrants.recycle(),this.entrants=null}}})}(),function(){"use strict";var t=function(t,e){return t/Math.abs(t)*e};platypus.createComponentClass({id:"LogicPushable",constructor:function(t){this.yPush=t.push||t.yPush||0,this.xPush=t.push||t.xPush||.1,t.roll?(this.radius=t.radius||this.owner.radius||(this.owner.width||this.owner.height||2)/2,this.owner.orientation=this.owner.orientation||0):this.radius=0,this.currentPushX=0,this.currentPushY=0,this.lastX=this.owner.x,this.lastY=this.owner.y,this.pushers=Array.setUp()},events:{"handle-logic":function(e){var i=0,n=e.delta;for(this.currentPushY&&(this.owner.y+=t(this.currentPushY,this.yPush*n),this.currentPushY=0),this.currentPushX&&(this.owner.x+=t(this.currentPushX,this.xPush*n),this.currentPushX=0),(this.lastX!==this.owner.x||this.lastY!==this.owner.y)&&(this.radius&&(this.owner.orientation+=(this.owner.x+this.owner.y-this.lastX-this.lastY)/this.radius),this.lastX=this.owner.x,this.lastY=this.owner.y),i=0;i<this.pushers.length;i++)this.pushers[i].triggerEvent("pushed",this.owner);this.pushers.length=0},"push-entity":function(t){var e=t.x||0,i=t.y||0;this.currentPushX-=e,this.currentPushY-=i,(this.yPush&&i||this.xPush&&e)&&this.pushers.push(t.entity)},"hit-solid":function(t){return t.y>0&&this.vY>0||t.y<0&&this.vY<0?this.vY=0:(t.x<0&&this.vX<0||t.x>0&&this.vX>0)&&(this.vX=0),!0}},methods:{destroy:function(){this.pushers.recycle()}}})}(),function(){"use strict";var t=include("platypus.Vector");platypus.createComponentClass({id:"LogicRebounder",constructor:function(e){platypus.Vector.assign(this.owner,"velocity","dx","dy","dz"),this.owner.mass=this.owner.mass||e.mass||1,this.elasticity=e.elasticity||.8,this.v=t.setUp(0,0,0),this.incidentVector=t.setUp(0,0,0),this.staticCollisionOccurred=!1,this.nonStaticCollisionOccurred=!1,this.hitThisTick=Array.setUp(),this.otherV=t.setUp(0,0,0),this.otherVelocityData=Array.setUp()},events:{"handle-logic":function(){var t=0;for(this.hitThisTick.length=0,t=0;t<this.otherVelocityData.length;t++)this.otherVelocityData[t].velocity.recycle();this.otherVelocityData.length=0},"hit-static":function(t){var e,i=t.entity,n=0;for(n=0;n<this.hitThisTick.length;n++)if(i===this.hitThisTick[n])return;this.hitThisTick.push(i),this.v.setVector(this.owner.velocity),this.incidentVector.setVector(t.direction),e=this.v.scalarProjection(this.incidentVector),isNaN(e)||(this.incidentVector.scale(e*(1+this.elasticity)),this.v.subtractVector(this.incidentVector)),this.owner.velocity.setVector(this.v)},"hit-non-static":function(t){var e=0,i=t.entity,n=!1,s=0,r=0,o=0;if(!((e=this.hitThisTick.indexOf(i))>=0)){for(this.hitThisTick.push(i),e=0;e<this.otherVelocityData.length;e++)if(i===this.otherVelocityData[e].entity){this.otherV.setVector(this.otherVelocityData[e].velocity),n=!0;break}n||(this.otherV.setVector(i.velocity),i.triggerEvent("share-velocity",this.owner)),this.v.setVector(this.owner.velocity),this.incidentVector.setVector(t.direction),s=this.v.scalarProjection(this.incidentVector),s=isNaN(s)?0:s,r=this.otherV.scalarProjection(this.incidentVector),r=isNaN(r)?0:r,o=(s*(this.owner.mass-i.mass)+2*i.mass*r)/(this.owner.mass+i.mass),this.incidentVector.scale(o-s),this.owner.velocity.setVector(this.incidentVector)}},"share-velocity":function(e){this.otherVelocityData.push({entity:e,velocity:t.setUp(e.velocity)})}},methods:{destroy:function(){this.v.recycle(),this.incidentVector.recycle(),this.otherV.recycle(),this.hitThisTick.recycle(),this.otherVelocityData.recycle()}},publicMethods:{}})}(),function(){"use strict";var t=include("platypus.Entity");platypus.createComponentClass({id:"LogicRegionSpawner",constructor:function(t){var e=0,i=0,n=1,s=1,r=0,o=0,a=0,h=0;if(this.spawnPosition={x:0,y:0},this.spawnProperties={properties:this.spawnPosition},this.regions=null,this.usedRegions=null,this.regionWidth=0,this.regionHeight=0,t.regions)for(this.regions=Array.setUp(),this.usedRegions=Array.setUp(),this.regionWidth=r=t.regions.width||this.owner.width,this.regionHeight=o=t.regions.height||this.owner.height,n=Math.round(this.owner.width/r),s=Math.round(this.owner.height/o),e=0;n>e;e++)for(i=0;s>i;i++)a=Math.min(r,this.owner.width-e*r),h=Math.min(o,this.owner.height-i*o),this.regions.push({x:e*r,y:i*o,width:a,height:h});this.entityClass=platypus.game.settings.entities[t.spawn],this.interval=this.owner.interval||t.interval||1e3,this.time=0},events:{"handle-logic":function(t){var e=this.regions,i=null;this.time+=t.delta,this.time>this.interval&&(this.time-=this.interval,e?(e.length||(this.regions=this.usedRegions,this.usedRegions=e,e=this.regions),i=e[Math.floor(e.length*Math.random())],this.spawnPosition.x=this.owner.x-(this.owner.regX||0)+(i.x+Math.random()*i.width),this.spawnPosition.y=this.owner.y-(this.owner.regY||0)+(i.y+Math.random()*i.height)):(this.spawnPosition.x=this.owner.x-(this.owner.regX||0)+Math.random()*this.owner.width,this.spawnPosition.y=this.owner.y-(this.owner.regY||0)+Math.random()*this.owner.height),this.owner.triggerEvent("entity-created",this.owner.parent.addEntity(new platypus.Entity(this.entityClass,this.spawnProperties))))}},methods:{destroy:function(){this.regions.recycle(),this.usedRegions.recycle()}},getAssetList:function(e,i,n){var s=e.spawn||i.spawn||n.spawn;return s?t.getAssetList({type:s}):Array.setUp()}})}(),function(){"use strict";var t=Math.cos,e=Math.sin,i=function(e,i){return e*t(i)},n=function(t,i){return t*e(i)};platypus.createComponentClass({id:"LogicRotationalMovement",constructor:function(t){var e=this.owner.state;this.speed=t.speed||.3,this.magnitude=0,this.degree=t.degree||1,this.angle=t.angle||0,this.state=e,e.set("moving",!1),e.set("turningRight",!1),e.set("turningLeft",!1),this.owner.orientation=0,this.moving=!1,this.turningRight=!1,this.turningLeft=!1},events:{"handle-logic":function(t){var e=this.state,s=0,r=0;this.turningRight&&(this.angle+=this.degree*t.delta/15),this.turningLeft&&(this.angle-=this.degree*t.delta/15),this.moving&&(s=i(this.magnitude,this.angle),r=n(this.magnitude,this.angle)),this.owner.x+=s*t.delta,this.owner.y+=r*t.delta,e.set("moving",this.moving),e.set("turningLeft",this.turningLeft),e.set("turningRight",this.turningRight),this.owner.rotation!==this.angle&&(this.owner.rotation=this.angle)},"turn-right":function(t){this.turningRight=!t||t.pressed},"turn-left":function(t){this.turningLeft=!t||t.pressed},"go-forward":function(t){!t||t.pressed?(this.moving=!0,this.magnitude=this.speed):this.moving=!1},"go-backward":function(t){!t||t.pressed?(this.moving=!0,this.magnitude=-this.speed):this.moving=!1},stop:function(t){(!t||t.pressed)&&(this.moving=!1,this.turningLeft=!1,this.turningRight=!1)},"stop-moving":function(t){(!t||t.pressed)&&(this.moving=!1)},"stop-turning":function(t){(!t||t.pressed)&&(this.turningLeft=!1,this.turningRight=!1)}},methods:{destroy:function(){this.state=null}}})}(),function(){"use strict";var t=include("platypus.Entity");platypus.createComponentClass({id:"LogicSpawner",constructor:function(t){var e=this.owner.spawneeClass||t.spawneeClass,i="",n=0;if(this.state=this.owner.state,this.stateName=t.state||"spawning",this.entityClass=platypus.game.settings.entities[e],this.speed=t.speed||this.owner.speed||0,this.state.set(this.stateName,!1),this.spawneeProperties={x:0,y:0,z:0,dx:0,dy:0,spawner:this.owner},t.passOnProperties)for(n=0;n<t.passOnProperties.length;n++)i=t.passOnProperties[n],this.owner[i]&&(this.spawneeProperties[i]=this.owner[i]);this.propertiesContainer={properties:this.spawneeProperties},this.offsetX=this.owner.offsetX||t.offsetX||0,this.offsetY=this.owner.offsetY||t.offsetY||0,this.firing=!1},events:{"handle-logic":function(){var t=0,e=0,i=this.state;this.firing&&(this.spawneeProperties.x=this.owner.x,this.spawneeProperties.y=this.owner.y,e=this.entityClass.properties&&this.entityClass.properties.z?this.entityClass.properties.z:0,this.spawneeProperties.z=this.owner.z+e,t=this.offsetX,i.get("left")&&(t*=-1),this.spawneeProperties.x+=t,t=this.offsetY,i.get("top")&&(t*=-1),this.spawneeProperties.y+=t,this.speed?(i.get("top")?this.spawneeProperties.dy=-this.speed:i.get("bottom")?this.spawneeProperties.dy=this.speed:delete this.spawneeProperties.dy,i.get("left")?this.spawneeProperties.dx=-this.speed:i.get("right")?this.spawneeProperties.dx=this.speed:delete this.spawneeProperties.dx):(delete this.spawneeProperties.dx,delete this.spawneeProperties.dy),this.parent&&this.owner.triggerEvent("entity-created",this.parent.addEntity(new platypus.Entity(this.entityClass,this.propertiesContainer)))),i.set(this.stateName,this.firing),this.firing=!1},spawn:function(t){this.firing=!t||!1!==t.pressed,this.parent=this.owner.parent}},methods:{destroy:function(){this.state=null}},getAssetList:function(e,i,n){var s=e.spawneeClass||i.spawneeClass||n.spawneeClass;return s?t.getAssetList({type:s}):Array.setUp()}})}(),function(){"use strict";var t=include("platypus.DataMap"),e=include("platypus.StateMap"),i=function(t,e){e.update(t)},n=function(t,e){e.set(t,!0)},s=null,r=null,o=function(e){var i=null,n="";if(!e||"object"!=typeof e||Array.isArray(e)||e.event)return e;for(n in i=t.setUp(),e)e.hasOwnProperty(n)&&i.set(n,o(e[n]));return i};s=function(t,e,i,n,o,a,h){var l,u=0,c="",d=n.message||0===n.message||!1===n.message,p=null;if(o){if("string"==typeof n)return void a.triggerEvent(n);if(Array.isArray(n)){for(u=0;u<n.length;u++)s(t,e,i,n[u],o,a,h);return}if(n.event&&(d||n.delay))return void(n.delay?h.push(n):a.trigger(n.event,n.message));n.get&&((p=n.get("true"))&&s(t,e,i,p,o,a,h))}if(l=n.keys)for(u=l.length;u--;)"true"!==(c=l[u])&&r(c,e,i,n.get(c),o,a,h)},r=function(t,e,i,n,r,o,a){var h=r,l=!1,u="",c=!1;"!"===t.charAt(0)?(u=t.substring(1),l=!1===(c=e.get(u)),"outputs"!==t&&i.get(u)!==c&&(h=!0)):(l=!0===(c=e.get(t)),"outputs"!==t&&i.get(t)!==c&&(h=!0)),(l||"outputs"===t)&&s(t,e,i,n,h,o,a)},platypus.createComponentClass({id:"LogicStateMachine",properties:{inputs:null,outputs:null},constructor:function(t){var s=0,r=this.inputs,a="",h=null,l=null,u=null,c=t["sustained-inputs"],d=this.owner.state;if(this.state=d,r){for(a in u=Array.setUp(),r)if(r.hasOwnProperty(a))for(l=e.setUp(r[a]),u.push(l),this.addEventListener(a,i.bind(this,l,d)),s=(h=l.keys).length;s--;)d.set(h[s],!1);this.stateObjects=u}if(this.sustainedState=e.setUp(),c)for(a in c)c.hasOwnProperty(a)&&(this.addEventListener(a,n.bind(this,c[a],this.sustainedState)),this.sustainedState.set(c[a],!1),d.set(c[a],!1));this.snapshot=e.setUp(),this.last=e.setUp(),this.queueTimes=Array.setUp(),this.queue=Array.setUp(),this.outputs=o(this.outputs)},events:{"handle-logic":function(t){for(var e=this.sustainedState,i="",n=e.keys,s=n.length,r=this.state;s--;)i=n[s],r.set(i,e.get(i)),e.set(i,!1);for(s=this.queue.length;s--;)this.queueTimes[s]-=t.delta,this.queueTimes[s]<=0&&(this.owner.trigger(this.queue[s].event,this.queue[s].message),this.queueTimes.greenSplice(s),this.queue.greenSplice(s))},"update-state":function(t){this.state.update(t)},"state-changed":function(t){var e=0,i=null,n=this.snapshot;if(this.outputs){for(n.update(t),i=Array.setUp(),r("outputs",n,this.last,this.outputs,!1,this.owner,i),e=i.length;e--;)this.queue.push(i[e]),this.queueTimes.push(i[e].delay);i.recycle(),this.last.update(n)}}},methods:{destroy:function(){var t=0,e=this.stateObjects;if(this.queueTimes.recycle(),this.queue.recycle(),e){for(t=e.length;t--;)e[t].recycle();e.recycle(),this.stateObjects=null}this.sustainedState.recycle(),this.snapshot.recycle(),this.last.recycle(),this.state=null,this.inputs=null}}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicSwitch",constructor:function(t){this.state=this.owner.state,this.pressed=!1,this.wasPressed=this.pressed,this.sticky=t.sticky||!1,this.state.set("pressed",!1),this.initialPress=!0},events:{"handle-logic":function(){this.sticky?this.pressed&&!this.wasPressed&&(this.state.set("pressed",!0),this.wasPressed=!0,this.owner.triggerEvent("switch-on")):(this.pressed!==this.wasPressed&&(this.pressed?(this.state.set("pressed",!0),this.owner.triggerEvent("switch-on")):(this.state.set("pressed",!1),this.owner.triggerEvent("switch-off"))),this.wasPressed=this.pressed,this.pressed=!1)},"switch-pressed":function(){this.pressed=!0,this.initialPress&&(this.owner.triggerEvent("initial-press"),this.initialPress=!1)}},methods:{destroy:function(){this.state=null}}})}(),function(){"use strict";var t=include("platypus.Vector");platypus.createComponentClass({id:"LogicTeleportee",constructor:function(){this.teleportDestination=t.setUp(),this.teleportNow=!1,this.DestinationSet=!1,this.message={position:this.teleportDestination}},events:{"handle-logic":function(){this.teleportNow&&(this.owner.triggerEvent("relocate-entity",this.message),this.teleportNow=!1,this.owner.triggerEvent("teleport-complete"))},teleport:function(){this.destinationSet&&(this.teleportNow=!0)},"set-destination":function(t){this.setDestination(t)},"hit-telepoint":function(t){this.setDestination(t.entity)}},methods:{setDestination:function(t){this.teleportDestination.setXYZ(t.x,t.y,this.owner.z),this.destinationSet=!0},destroy:function(){this.teleportDestination.recycle()}}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicTeleporter",constructor:function(t){this.destination=null,this.linkId=this.owner.teleportId||t.teleportId,this.facing=this.owner.facing||t.facing||!1,this.facing&&this.owner.state.set("facing-"+this.facing,!0)},events:{"peer-entity-added":function(t){this.destination||t.linkId!==this.linkId||(this.destination=t)},"teleport-entity":function(t){switch(this.facing){case"up":t.y<0&&t.entity.triggerEvent("teleport",this.destination);break;case"right":t.x>0&&t.entity.triggerEvent("teleport",this.destination);break;case"down":t.y>0&&t.entity.triggerEvent("teleport",this.destination);break;case"left":t.x<0&&t.entity.triggerEvent("teleport",this.destination);break;default:t.entity.triggerEvent("teleport",this.destination)}}},methods:{destroy:function(){this.destination=null}}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicTimer",constructor:function(t){this.time=this.owner.time||t.time||0,this.prevTime=this.time,this.alarmTime=this.owner.alarmTime||t.alarmTime||0,this.isInterval=this.owner.isInterval||t.isInterval||!1,this.alarmMessage=this.owner.alarmMessage||t.alarmMessage||"",this.updateMessage=this.owner.updateMessage||t.updateMessage||"",this.isOn=this.owner.on||t.on||!0,this.isIncrementing=this.owner.isIncrementing||t.isIncrementing||!0,this.maxTime=this.owner.maxTime||t.maxTime||36e5},events:{"handle-logic":function(t){this.isOn&&(this.prevTime=this.time,this.isIncrementing?this.time+=t.delta:this.time-=t.delta,Math.abs(this.time)>this.maxTime&&(this.time>0?this.time=this.maxTime:this.time<0&&(this.time=-this.maxTime),this.triggerEvent("stop-timer")),0!==this.alarmTime&&(this.isInterval?this.isIncrementing?Math.floor(this.time/this.alarmTime)>Math.floor(this.prevTime/this.alarmTime)&&this.owner.trigger(this.alarmMessage):Math.floor(this.time/this.alarmTime)<Math.floor(this.prevTime/this.alarmTime)&&this.owner.trigger(this.alarmMessage):this.isIncrementing?this.time>this.alarmTime&&this.prevTime<this.alarmTime&&this.owner.trigger(this.alarmMessage):this.time<this.alarmTime&&this.prevTime>this.alarmTime&&this.owner.trigger(this.alarmMessage))),this.owner.trigger(this.updateMessage,{time:this.time})},"set-timer":function(t){this.time=t.time},"start-timer":function(){this.isOn=!0},"stop-timer":function(){this.isOn=!1}}})}(),function(){"use strict";platypus.createComponentClass({id:"LogicWindUpRacer",properties:{speed:.3,raceTime:5e3,windTime:500},constructor:function(){var t=this.owner.state;this.windProgress=0,this.winding=!1,this.racing=!1,this.blocked=!1,this.right=!1,this.left=!1,this.state=t,t.set("windingUp",!1),t.set("racing",!1),t.set("blocked",!1)},events:{"handle-logic":function(t){var e=this.state;this.racing?!this.blocked&&this.right&&e.get("right")?(this.owner.x+=this.speed*t.delta,this.owner.triggerEvent("racing")):!this.blocked&&this.left&&e.get("left")?(this.owner.x-=this.speed*t.delta,this.owner.triggerEvent("racing")):(this.racing=!1,this.owner.triggerEvent("stopped-racing")):this.winding?((this.right&&e.get("right")||this.left&&e.get("left"))&&(this.windProgress+=t.delta),this.owner.triggerEvent("winding",this.windProgress/this.windTime)):this.windProgress&&(this.windProgress>=this.windTime&&(this.racing=!0),this.windProgress=0,this.owner.triggerEvent("stopped-winding")),e.set("windingUp",this.winding),e.set("racing",this.racing),e.set("blocked",this.blocked),this.blocked=!1},"stop-racing":function(){this.racing=!1,this.owner.triggerEvent("stopped-racing")},"wind-up":function(t){this.winding=!t||!1!==t.pressed,this.right=this.state.get("right"),this.left=this.state.get("left")},"hit-solid":function(t){t.x&&this.racing&&(this.right&&t.x>0||this.left&&t.x<0)&&(this.blocked=!0,this.owner.triggerEvent("blocked",t))}},methods:{destroy:function(){this.state.set("windingUp",!1),this.state.set("racing",!1),this.state.set("blocked",!1),this.state=null}}})}(),function(){"use strict";var t=include("platypus.Vector"),e=function(){return!0},i=function(t,i){var n=e,s=e,r=e,o=t.owner.state,a=i.controlState,h=i.instantState,l=i.instantSuccess;a&&(s=function(){return o.get(a)}),t.instant||h?(h&&(r=function(){return o.get(h)}),t.instant=!0,t.update=function(){var t=r(),e=s();if(this.activeVelocity){if(this.enact&&!e&&(this.ready=!1),this.ready&&this.enact&&t)this.ready=!1,this.velocity.setVector(this.instant),l&&this.owner.triggerEvent(l);else if(this.ready||this.enact&&t){if(e)return null}else this.ready=!0,this.decay();return this.velocity}return null}):t.update=function(t){return this.activeVelocity&&s()?(this.activeAcceleration&&n()&&this.move(t),this.velocity):null}};platypus.createComponentClass({id:"Motion",properties:{orient:!0,acceleration:0,activeAcceleration:!0,activeVelocity:!0,maxMagnitude:1/0,controlState:"",instant:!1,instantState:"",instantSuccess:"",instantDecay:null,velocity:0,stopOnCollision:!0,drag:-1,friction:-1},constructor:function(e){this.acceleration||(this.activeAcceleration=!1),this.acceleration=t.setUp(this.acceleration),this.velocity=t.setUp(this.velocity),this.triggered=!1,this.ready=!0,"number"==typeof this.instantDecay?this.capMagnitude=this.velocity.magnitude()*this.instantDecay:this.capMagnitude=-1,i(this,e),this.instant&&(this.enact=!1,this.instant=t.setUp(this.velocity),this.velocity.setXYZ(0,0,0)),this.orient&&(this.owner.triggerEvent("orient-vector",this.velocity),this.owner.triggerEvent("orient-vector",this.acceleration))},events:{"control-velocity":function(t){this.activeVelocity=t&&!1!==t.pressed},"stop-velocity":function(){this.activeVelocity=!1},"start-velocity":function(){this.activeVelocity=!0},"control-acceleration":function(t){this.activeAcceleration=t&&!1!==t.pressed},"stop-acceleration":function(){this.activeAcceleration=!1},"start-acceleration":function(){this.activeAcceleration=!0},"instant-motion":function(t){this.enact=t&&!1!==t.triggered},"instant-begin":function(){this.enact=!0},"instant-end":function(){this.enact=!1},"set-motion":function(t){t.acceleration&&this.acceleration.set(t.acceleration),t.velocity&&(this.velocity.set(t.velocity),"number"==typeof this.instantDecay?this.capMagnitude=this.velocity.magnitude()*this.instantDecay:this.capMagnitude=-1),"number"==typeof t.maxMagnitude&&(this.maxMagnitude=t.maxMagnitude)}},methods:{move:function(e){var i=t.setUp(this.acceleration).multiply(e);return this.velocity.add(i),i.recycle(),this.velocity.magnitude()>this.maxMagnitude&&this.velocity.normalize().multiply(this.maxMagnitude),this.velocity},decay:function(){this.capMagnitude>=0&&this.velocity.magnitude()>this.capMagnitude&&this.velocity.normalize().multiply(this.capMagnitude)},destroy:function(){this.orient&&(this.owner.triggerEvent("remove-vector",this.acceleration),this.owner.triggerEvent("remove-vector",this.velocity)),this.acceleration.recycle(),this.velocity.recycle(),this.instant&&this.instant.recycle()}},publicMethods:{}})}(),function(){"use strict";var t=include("platypus.Vector"),e=t.setUp(),i=function(t,e,i,n){return t&&e!==i?i>e?Math.min(e+t*n,i):Math.max(e-t*n,i):e},n=function(t,e){var n=this.maxMagnitudeInterim=i(this.maxMagnitudeDelta,this.maxMagnitudeInterim,this.maxMagnitude,e);t.magnitude()>n&&t.normalize().multiply(n)},s=function(t,e){var n=this.maxMagnitude,s=this.maxMagnitudeDelta,r=this.maxMagnitudeInterim;r.up=i(s,r.up,n.up,e),r.right=i(s,r.right,n.right,e),r.down=i(s,r.down,n.down,e),r.left=i(s,r.left,n.left,e),t.x>0?t.x>r.right&&(t.x=r.right):t.x<0&&t.x<-r.left&&(t.x=-r.left),t.y>0?t.y>r.down&&(t.y=r.down):t.y<0&&t.y<-r.up&&(t.y=-r.up)};platypus.createComponentClass({id:"Mover",properties:{ground:[0,1]},publicProperties:{movers:[],gravity:0,jump:0,speed:0,drag:.01,friction:.06,maxMagnitude:1/0,maxMagnitudeDelta:0,reorientVelocities:!0},constructor:function(){var e=1/0,i=this.maxMagnitude,r=this.owner.state;platypus.Vector.assign(this.owner,"position","x","y","z"),platypus.Vector.assign(this.owner,"velocity","dx","dy","dz"),this.position=this.owner.position,this.velocity=this.owner.velocity,this.lastVelocity=t.setUp(this.velocity),this.collision=null,this.pause=!1,this.moversCopy=this.movers,this.movers=Array.setUp(),this.velocityChanges=Array.setUp(),this.velocityDirections=Array.setUp(),this.ground=t.setUp(this.ground),this.state=r,r.set("grounded",!1),Object.defineProperty(this.owner,"maxMagnitude",{get:function(){return e},set:function(t){"number"==typeof t?(this.clamp=n,e=t,this.maxMagnitudeDelta||(this.maxMagnitudeInterim=t)):(this.clamp=s,"number"==typeof e&&(e={up:e,right:e,down:e,left:e}),"number"==typeof t.up&&(e.up=t.up),"number"==typeof t.right&&(e.right=t.right),"number"==typeof t.down&&(e.down=t.down),"number"==typeof t.left&&(e.left=t.left),"number"==typeof this.maxMagnitudeInterim?this.maxMagnitudeDelta?this.maxMagnitudeInterim={up:this.maxMagnitudeInterim,right:this.maxMagnitudeInterim,down:this.maxMagnitudeInterim,left:this.maxMagnitudeInterim}:this.maxMagnitudeInterim={up:e.up,right:e.right,down:e.down,left:e.left}:this.maxMagnitudeDelta||(this.maxMagnitudeInterim.up=e.up,this.maxMagnitudeInterim.right=e.right,this.maxMagnitudeInterim.down=e.down,this.maxMagnitudeInterim.left=e.left))}.bind(this)}),this.maxMagnitudeInterim=0,this.maxMagnitude=i},events:{"component-added":function(t){"Motion"===t.type&&this.movers.push(t)},"component-removed":function(t){var e=0;"Motion"===t.type&&((e=this.movers.indexOf(t))>=0&&this.movers.greenSplice(e))},load:function(){var t=0,e=this.moversCopy;for(delete this.moversCopy,t=0;t<e.length;t++)this.addMover(e[t]);this.externalForces=this.addMover({velocity:[0,0,0],orient:!1}).velocity,this.speed&&(isNaN(this.speed)||(this.speed=[this.speed,0,0]),this.speed=this.addMover({velocity:this.speed,controlState:"moving"}).velocity),this.gravity&&(isNaN(this.gravity)||(this.gravity=[0,this.gravity,0]),this.gravity=this.addMover({acceleration:this.gravity,orient:!1,aliases:{gravitate:"control-acceleration"}}).acceleration),this.jump&&(isNaN(this.jump)||(this.jump=[0,this.jump,0]),this.jump=this.addMover({velocity:this.jump,instant:!0,controlState:"grounded",state:"jumping",instantSuccess:"just-jumped",instantDecay:.2,aliases:{jump:"instant-motion"}}).instant)},"handle-movement":function(e){var i=e.delta,n=null,s=this.state,r=null,o=this.velocity,a=this.position,h=this.movers,l=h.length;if(!s.get("paused")&&!this.paused){for(o.equals(this.lastVelocity,2)||this.externalForces.addVector(o).subtractVector(this.lastVelocity),o.setXYZ(0,0,0);l--;)(n=h[l].update(i))&&(this.grounded?-1!==h[l].friction?n.multiply(1-h[l].friction):n.multiply(1-this.friction):-1!==h[l].drag?n.multiply(1-h[l].drag):n.multiply(1-this.drag),o.add(n));this.clamp(o,i),this.lastVelocity.setVector(o),r=t.setUp(o).multiply(i),a.add(r),r.recycle(),s.set("grounded",this.grounded),this.grounded=!1}},"hit-solid":function(e){var i=0,n=0,s=e.entity&&e.entity.velocity,r=e.direction,o=!0,a=this.velocityChanges,h=this.velocityDirections,l=a.length;if(r.dot(this.ground)>0&&(this.grounded=!0),(i=this.velocity.scalarProjection(r))>0){for(s?i=i>(n=Math.max(s.scalarProjection(r),0))?n:0:i=0;l--;)if(i<a[l]&&h[l].dot(r)>0){a[l]=i,h[l].setVector(r),o=!1;break}o&&(a.push(i),h.push(t.setUp(r)))}},"handle-post-collision-logic":function(){var t=null,i=this.movers,n=this.velocityChanges,s=this.velocityDirections,r=n.length,o=i.length,a=null,h=0,l=null,u=e;if(r){for(l=Array.setUp();o--;)(a=i[o]).stopOnCollision&&l.push(a);for(;r--;){for(t=s[r],h=n[r]/(o=l.length);o--;)a=l[o],u.setVector(t).normalize().multiply(h-a.velocity.scalarProjection(t)),a.velocity.add(u);t.recycle()}n.length=0,s.length=0}},"set-mover":function(t){"number"==typeof t.maxMagnitudeDelta&&(this.maxMagnitudeDelta=t.maxMagnitudeDelta),t.maxMagnitude&&(this.maxMagnitude=t.maxMagnitude)},"pause-movement":function(){this.paused=!0},"unpause-movement":function(){this.paused=!1},"orientation-updated":function(t){this.reorientVelocities||this.lastVelocity.multiply(t)}},methods:{destroy:function(){var t=0,e=this.maxMagnitude;for(t=this.movers.length-1;t>=0;t--)this.removeMover(this.movers[t]);this.movers.recycle(),this.ground.recycle(),this.lastVelocity.recycle(),this.velocityChanges.recycle(),this.velocityDirections.recycle(),delete this.owner.maxMagnitude,this.owner.maxMagnitude=e,this.state=null}},publicMethods:{addMover:function(t){return this.owner.addComponent(new platypus.components.Motion(this.owner,t))},removeMover:function(t){this.owner.removeComponent(t)}}})}(),function(){"use strict";platypus.createComponentClass({id:"Node",publicProperties:{x:0,y:0,z:0},constructor:function(t){this.nodeId=t.nodeId||this.owner.nodeId||this.owner.id||String(Math.random()),"string"!=typeof this.nodeId&&this.nodeId.length&&(this.nodeId=t.nodeId.join("|")),this.owner.nodeId=this.nodeId,this.owner.isNode=!0,this.map=this.owner.map=this.owner.map||null,this.contains=this.owner.contains=Array.setUp(),this.edgesContain=this.owner.edgesContain=Array.setUp(),platypus.Vector.assign(this.owner,"position","x","y","z"),this.neighbors=this.owner.neighbors=t.neighbors||this.owner.neighbors||{}},events:{"add-neighbors":function(t){var e=0,i=null;for(i in t)t.hasOwnProperty(i)&&(this.neighbors[i]=t[i]);for(e=0;e<this.contains.length;e++)this.contains[e].triggerEvent("set-directions")},"remove-neighbor":function(t){var e=null,i=t;for(e in"string"!=typeof i&&(i=i.nodeId),this.neighbors)if(this.neighbors.hasOwnProperty(e))if("string"==typeof this.neighbors[e]){if(this.neighbors[e]===i){delete this.neighbors[e];break}}else if(this.neighbors[e].nodeId===i){delete this.neighbors[e];break}}},methods:{destroy:function(){this.contains.recycle(),this.edgesContain.recycle()}},publicMethods:{getNode:function(t){var e=null;if(!this.map&&this.owner.map&&(this.map=this.owner.map),this.neighbors[t]){if((e=this.neighbors[t]).isNode)return e;if("string"==typeof e){if(e=this.map.getNode(e))return this.neighbors[t]=e,e}else if(e.length&&(e=this.map.getNode(e.join("|"))))return this.neighbors[t]=e,e;return null}return null},addToNode:function(t){var e=0;for(e=0;e<this.contains.length;e++)if(this.contains[e]===t)return!1;return this.contains.push(t),t},removeFromNode:function(t){var e=0;for(e=0;e<this.contains.length;e++)if(this.contains[e]===t)return this.contains.greenSplice(e);return!1},addToEdge:function(t){var e=0;for(e=0;e<this.edgesContain.length;e++)if(this.edgesContain[e]===t)return!1;return this.edgesContain.push(t),t},removeFromEdge:function(t){var e=0;for(e=0;e<this.edgesContain.length;e++)if(this.edgesContain[e]===t)return this.edgesContain.greenSplice(e);return!1}}})}(),function(){"use strict";var t=include("platypus.Vector"),e=function(t,e){t.id?"string"==typeof t.id?this.id=t.id:Array.isArray(t.id)?this.id=t.id.join("|"):this.id=String(Math.random()):this.id=String(Math.random()),this.isNode=!0,this.map=e,this.contains=Array.setUp(),this.type=t.type||"",this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.neighbors=t.neighbors||{}},i=e.prototype;i.getNode=function(t){var e=null;if(this.neighbors[t]){if((e=this.neighbors[t]).isNode)return e;if("string"==typeof e){if(e=this.map.getNode(e))return this.neighbors[t]=e,e}else if(Array.isArray(e)&&(e=this.map.getNode(e.join("|"))))return this.neighbors[t]=e,e;return null}return null},i.add=function(t){var e=0;for(e=0;e<this.contains.length;e++)if(this.contains[e]===t)return!1;return this.contains.push(t),t},i.remove=function(t){var e=0;for(e=0;e<this.contains.length;e++)if(this.contains[e]===t)return this.contains.greenSplice(e);return!1},i.recycle=function(){this.contains.recycle(),this.recycle()},recycle.add(e,!!springroll.Debug,"Node"),platypus.createComponentClass({id:"NodeMap",publicProperties:{map:[]},constructor:function(){var t=0,i=this.map;for(this.map=Array.setUp(),this.nodes={},this.residentsAwaitingNode=Array.setUp(),t=0;t<i.length;t++)this.addNode(e.setUp(i[t],this))},events:{"add-node":function(t){var i=0,n=null,s=null;for(t.isNode?(s=t,t.map=this):s=e.setUp(t,this),this.addNode(s),i=this.residentsAwaitingNode.length-1;i>=0;i--)n=this.residentsAwaitingNode[i],s.id===n.nodeId&&(this.residentsAwaitingNode.greenSplice(i),n.node=this.getNode(n.nodeId),n.triggerEvent("on-node",n.node))},"child-entity-added":function(t){t.isNode?this.owner.triggerEvent("add-node",t):t.nodeId&&(t.node=this.getNode(t.nodeId),t.node?t.triggerEvent("on-node",t.node):this.residentsAwaitingNode.push(t))}},methods:{addNode:function(t){this.map.push(t),this.nodes[t.id]=t},destroy:function(){var t=0;for(t=0;t<this.map.length;t++)this.map[t]instanceof platypus.Entity||this.map[t].recycle();this.map.recycle(),this.residentsAwaitingNode.recycle()}},publicMethods:{getNode:function(){var t=0,e="",i="",n=arguments;if(1===n.length){if(n[0].isNode)return n[0];Array.isArray(n[0])&&(n=n[0])}for(t=0;t<n.length;t++)e+=i+n[t],i="|";return this.nodes[e]||null},getClosestNode:function(e,i,n){var s=0,r=t.setUp(e),o=t.setUp(),a=0,h=i||this.map,l=null,u=1/0;for(s=0;s<h.length;s++)if(u>(a=o.setVector(r).subtractVector(h[s].position).magnitude())){if(n&&n.indexOf(h[s])>=0)break;u=a,l=h[s]}return r.recycle(),o.recycle(),l}}})}(),function(){"use strict";var t=function(t,e,i){return function(){var n=e.getNode(t);return!!this.isPassable(n)&&(this.destinationNodes.length=0,this.destinationNodes.push(n),this.node?this.onEdge(n):this.distance=0,this.progress=0,this.setState("going-"+i),!0)}},e=function(t,e){var i=e.x-t.x,n=e.y-t.y,s=e.z-t.z;return Math.sqrt(i*i+n*n+s*s)},i=function(t,e,i,n){var s=e.x-t.x,r=e.y-t.y,o=0;return t.rotation&&e.rotation?((s=(t.rotation+180)%360)*(1-n)+(r=(e.rotation+180)%360)*n+180)%360:i?(o=Math.acos(s/i),0>r&&(o=2*Math.PI-o),180*o/Math.PI):o},n=function(t,e,i,n){return e*(1-t)+i*t+n};platypus.createComponentClass({id:"NodeResident",publicProperties:{speed:0},constructor:function(t){var i=t.offset||this.owner.nodeOffset||{};this.nodeId=this.owner.nodeId=t.nodeId||this.owner.nodeId,this.neighbors={},this.friendlyNodes=t.nodes||null,this.friendlyEntities=t.shares||null,this.snapToNodes=t.snapToNodes||!1,this.updateOrientation=t.updateOrientation||!1,this.distance=0,this.buffer=t.buffer||0,this.progress=0,this.offset={x:i.x||0,y:i.y||0,z:i.z||0},this.destinationNodes=Array.setUp(),this.algorithm=t.algorithm||e,this.state=this.owner.state,this.state.set("moving",!1),this.state.set("on-node",!1),this.currentState=""},events:{"set-algorithm":function(t){this.algorithm=t||e},"handle-logic":function(t){var e=0,s=0,r=0,o=null,a=null;if(this.owner.node||(a=Array.setUp(this.owner.x,this.owner.y),this.owner.triggerEvent("on-node",this.owner.parent.getClosestNode(a)),a.recycle(),this.owner.triggerEvent("in-location",this.owner)),this.followEntity?(o=this.followEntity.node||this.followEntity)&&o.isNode&&o!==this.node?(this.lag=0,this.state.set("moving",this.gotoNode()),this.followDistance&&(r=this.lag)):this.followEntity=null:r=this.speed*t.delta,this.blocked&&(this.blocked=!1,this.goingToNode&&this.owner.triggerEvent("goto-closest-node",this.goingToNode)),this.destinationNodes.length){if(this.state.set("moving",0!==this.speed),this.node)this.onEdge(this.destinationNodes[0]);else if(!this.lastNode&&(this.owner.triggerEvent("on-node",this.destinationNodes[0]),this.destinationNodes.greenSplice(0),!this.destinationNodes.length))return void this.state.set("moving",!1);if(this.snapToNodes){for(e=0;e<this.destinationNodes.length;e++)this.owner.triggerEvent("on-node",this.destinationNodes[e]);this.destinationNodes.length=0}else for(;this.destinationNodes.length&&r;)this.progress+r>=this.distance?(o=this.destinationNodes[0],r-=this.distance-this.progress,this.progress=0,this.destinationNodes.greenSplice(0),this.owner.triggerEvent("on-node",o),this.destinationNodes.length&&r&&this.onEdge(this.destinationNodes[0])):(this.progress+=r,s=this.progress/this.distance,this.owner.x=n(s,this.lastNode.x,this.destinationNodes[0].x,this.offset.x),this.owner.y=n(s,this.lastNode.y,this.destinationNodes[0].y,this.offset.y),this.owner.z=n(s,this.lastNode.z,this.destinationNodes[0].z,this.offset.z),this.updateOrientation&&(this.owner.rotation=i(this.lastNode,this.destinationNodes[0],this.distance,s)),r=0)}else this.state.set("moving",!1)},"on-node":function(t){var e=0,i=null;for(this.owner.node=this.node=t,this.node.removeFromEdge(this.owner),this.lastNode&&this.lastNode.removeFromEdge(this.owner),this.node.addToNode(this.owner),this.setState("on-node"),this.owner.x=this.node.x+this.offset.x,this.owner.y=this.node.y+this.offset.y,this.owner.z=this.node.z+this.offset.z,this.updateOrientation&&this.node.rotation&&(this.owner.rotation=this.node.rotation),this.owner.triggerEvent("set-directions"),this.friendlyNodes&&this.friendlyNodes[t.type]&&this.owner.trigger(this.friendlyNodes[t.type],t),i=t.contains,e=0;e<i.length;e++)this.owner!==i[e]&&(i[e].triggerEvent("with-"+this.owner.type,this.owner),this.owner.triggerEvent("with-"+i[e].type,i[e]))},"leave-node":function(){this.node&&(this.node.removeFromNode(this.owner),this.owner.triggerEvent("left-node",this.node),this.owner.triggerEvent("remove-directions")),this.lastNode=this.node,this.node=null},"goto-node":function(t){this.gotoNode(t)},follow:function(t){t.entity?(this.followDistance=t.distance,this.followEntity=t.entity):(this.followDistance=0,this.followEntity=t)},"goto-closest-node":function(){var t=function(t,e){var i=0;for(i=0;i<e.length;i++)if(e[i]===t)return!0;return!1},e=function(t,e){return t.type===e},i=function(t,e){return t.type===e.type};return function(n){var s=null,r=this.node||this.lastNode,o=null,a=n.steps||0,h=null;this.goingToNode=n,o="string"==typeof n?e:"string"==typeof n.type?i:t,r&&n&&!o(r,n)&&(h=Array.setUp(),(s=this.traverseNode({depth:20,origin:r,position:r,test:o,destination:n,nodes:h,shortestPath:1/0,distance:0,found:!1,algorithm:this.algorithm,blocked:!1})).distance-=this.progress,s.found?this.followEntity&&this.followDistance?s.distance+(this.followEntity.progress||0)>this.followDistance?(this.lag=s.distance+(this.followEntity.progress||0)-this.followDistance,this.setPath(s,a)):this.lag=0:this.setPath(s,a):s.blocked&&(this.blocked=!0),h.recycle())}}(),"set-directions":function(){var e="",i=0,n=null,s=this.node,r=null;for(e in this.owner.triggerEvent("remove-directions"),s.neighbors)if(s.neighbors.hasOwnProperty(e)&&(this.neighbors[e]=t(s.neighbors[e],s.map,e),this.addEventListener(e,this.neighbors[e]),r=s.map.getNode(s.neighbors[e])))for(n=r.contains,i=0;i<n.length;i++)n[i].triggerEvent("next-to-"+this.owner.type,this.owner),this.owner.triggerEvent("next-to-"+n[i].type,n[i])},"remove-directions":function(){var t="";for(t in this.neighbors)this.neighbors.hasOwnProperty(t)&&(this.removeEventListener(t,this.neighbors[t]),delete this.neighbors[t])}},methods:{gotoNode:function(){var t=function(t,e){return t===e};return function(e){var i=null,n=this.node||this.lastNode,s=null,r=!1;return!e&&this.followEntity&&(e=this.followEntity.node||this.followEntity.lastNode||this.followEntity),n&&e&&this.node!==e&&(s=Array.setUp(),(i=this.traverseNode({depth:20,origin:n,position:n,test:t,destination:e,nodes:s,shortestPath:1/0,distance:0,found:!1,algorithm:this.algorithm,blocked:!1})).distance-=this.progress,i.found?this.followEntity&&this.followDistance?i.distance+(this.followEntity.progress||0)>this.followDistance?(this.lag=i.distance+(this.followEntity.progress||0)-this.followDistance,this.setPath(i),r=!0):this.lag=0:(this.setPath(i),r=!0):i.blocked&&(this.blocked=!0),s.recycle()),r}}(),isPassable:function(t){return!(!t||this.node===t||this.friendlyNodes&&void 0===this.friendlyNodes[t.type]||t.contains.length&&!function(t,e){var i=0,n=0,s=!1;if(null===e)return!0;for(i=0;i<t.length;i++){for(n=0;n<e.length;n++)t[i].type===e[n]&&(s=!0);if(!s)return!1;s=!1}return!0}(t.contains,this.friendlyEntities))},traverseNode:function(t){var i=1,n="",s=t.position.map,r=null,o=null,a=null,h=null,l=t.algorithm||e,u={shortestPath:1/0,found:!1,blocked:!1},c=!0,d=!1;if(0===t.depth||t.distance>t.shortestPath)return t;if(t.test(t.position,t.destination))return t.found=!0,t.shortestPath=t.distance,t;for(a=t.nodes,i=1;i<a.length-1;i++)if(a[i]===t.position)return t;for(n in r=t.position.neighbors)r.hasOwnProperty(n)&&(o=s.getNode(r[n]),d=!0,this.isPassable(o)&&((a=t.nodes.greenSlice()).push(o),h=this.traverseNode({depth:t.depth-1,origin:t.origin,position:o,destination:t.destination,test:t.test,algorithm:l,nodes:a,shortestPath:t.shortestPath,distance:t.distance+l(t.position,o),gateway:t.gateway||n,found:!1,blocked:!1}),a.recycle(),h.found&&u.shortestPath>h.shortestPath&&(u=h),c=!1));return u.blocked=d&&c,u},setPath:function(t,e){t.nodes[0]===this.node&&t.nodes.greenSplice(0),this.destinationNodes.recycle(),this.destinationNodes=t.nodes.greenSlice(),e&&(this.destinationNodes.length=Math.min(e,this.destinationNodes.length))},setState:function(t){"on-node"===t?this.state.set("on-node",!0):(this.state.set("on-node",!1),this.currentState&&this.state.set(this.currentState,!1),this.currentState=t,this.state.set(t,!0))},onEdge:function(t){this.distance=e(this.node,t),this.updateOrientation&&(this.owner.rotation=i(this.node,t,this.distance,this.progress/this.distance)),this.node.addToEdge(this.owner),t.addToEdge(this.owner),this.owner.triggerEvent("leave-node")},destroy:function(){this.destinationNodes.recycle(),this.state=null}}})}(),function(){"use strict";var t=include("platypus.Data"),e=include("platypus.Vector"),i=e.setUp(0,0,1),n=e.setUp(1,0,0),s={horizontal:[[-1,0,0],[0,1,0],[0,0,-1]],vertical:[[1,0,0],[0,-1,0],[0,0,-1]],diagonal:[[0,1,0],[1,0,0],[0,0,-1]],"diagonal-inverse":[[0,-1,0],[-1,0,0],[0,0,-1]],"rotate-90":[[0,-1,0],[1,0,0],[0,0,1]],"rotate-180":[[-1,0,0],[0,-1,0],[0,0,1]],"rotate-270":[[0,1,0],[-1,0,0],[0,0,1]]},r=function(){var t=function(t,e,i){var n=0,s=0;for(n=0;n<t.length;n++)s+=t[n]*i[n][e];return s};return function(e,i,n){var s=0,r=0,o=Array.setUp();for(s=0;s<e.length;s++)for(r=0;r<e[0].length;r++)o.push(t(e[s],r,i));for(s=0;s<e.length;s++)for(r=0;r<e[0].length;r++)n[s][r]=o.greenSplice(0);o.recycle()}}(),o=function(t){var e=0,i=0;for(e=0;3>e;e++)for(i=0;3>i;i++)t[e][i]=e===i?1:0;return t};platypus.createComponentClass({id:"Orientation",publicProperties:{scaleX:1,scaleY:1,rotation:0,orientation:0,orientationMatrix:null},constructor:function(){this.loadedOrientationMatrix=this.orientationMatrix,this.matrix=Array.setUp(Array.setUp(1,0,0),Array.setUp(0,1,0),Array.setUp(0,0,1)),this.matrixTween=Array.setUp(Array.setUp(1,0,0),Array.setUp(0,1,0),Array.setUp(0,0,1)),this.relocationMessage=t.setUp("position",null),this.vectors=Array.setUp(),this.inverses=Array.setUp(),this.tweens=Array.setUp(),this.orientationVector=function(t,s){var a=e.setUp(1,0,0),h=t.owner,l=Array.setUp(Array.setUp(1,0,0),Array.setUp(0,1,0),Array.setUp(0,0,1));return Object.defineProperty(h,"orientationMatrix",{get:function(){return r(t.matrixTween,t.matrix,o(l)),l},enumerable:!0}),delete h.orientation,Object.defineProperty(h,"orientation",{get:function(){return a.signedAngleTo(n,i)},set:function(t){a.setVector(n).rotate(t)},enumerable:!0}),s&&("number"!=typeof s?a.set(s):a.rotate(s)),a}(this,this.orientation),this.owner.triggerEvent("orient-vector",this.orientationVector),this.owner.state.set("reorienting",!1)},events:{load:function(){this.loadedOrientationMatrix?this.transform(this.loadedOrientationMatrix):(this.scaleX&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.transform("horizontal")),this.scaleY&&this.scaleY<0&&(this.scaleY=-this.scaleY,this.transform("vertical")),this.rotation&&((this.rotation+270)%360==0?(this.rotation=0,this.transform("rotate-90")):(this.rotation+180)%360==0?(this.rotation=0,this.transform("rotate-180")):(this.rotation+90)%360==0&&(this.rotation=0,this.transform("rotate-270")))),delete this.loadedOrientationMatrix},"handle-logic":function(t){var e=this.tweens.length,i=t.delta,n=this.owner.state,s=null,r=null,a=this.relocationMessage;if(e){for(s=Array.setUp(),n.set("reorienting",!0),o(this.matrixTween);e--;)this.updateTween(this.tweens[e],i)&&s.push(this.tweens.greenSplice(e));for(e=this.vectors.length;e--;)this.updateVector(this.vectors[e],this.inverses[e]);for(e=s.length;e--;)r=s[e],this.transform(r.endMatrix),r.anchor&&(r.offset.multiply(r.endMatrix).addVector(r.anchor),a.position=r.offset,this.owner.triggerEvent("relocate-entity",a),r.recycleOffset&&r.offset.recycle()),r.onFinished(r.endMatrix),r.recycle();s.recycle()}else n.get("reorienting")&&(o(this.matrixTween),n.set("reorienting",!1))},"complete-tweens":function(){var t=0;for(t=0;t<this.tweens.length;t++)this.tweens[t].time=this.tweens[t].endTime},"drop-tweens":function(){var t=0;for(t=this.tweens.length;t--;)this.tweens[t].offset&&this.tweens[t].offset.recycle();for(this.tweens.length=0,t=this.vectors.length;t--;)this.updateVector(this.vectors[t],this.inverses[t])},"orient-vector":function(t){var i=t.aligned||!1;t.vector&&(t=t.vector),-1===this.vectors.indexOf(t)&&(i||t.multiply(this.matrix),this.vectors.push(t),this.inverses.push(e.setUp()))},"remove-vector":function(t){var e=this.vectors.indexOf(t);e>=0&&(this.vectors.greenSplice(e),this.inverses.greenSplice(e).recycle())},"tween-transform":function(){var e=function(){},i=function(){return!0},n=function(t){return t};return function(r){var o=null,a=r.angle||0,h=r.matrix,l=t.setUp("transform",r.transform,"anchor",r.anchor,"endTime",r.time||0,"time",0,"tween",r.tween||n,"onFinished",r.onFinished||e,"beforeTick",r.beforeTick||i,"afterTick",r.onTick||r.afterTick||e);if(h||(h=s[r.transform]),l.endMatrix=h,!a&&0===r.transform.indexOf("rotate"))switch(r.transform){case"rotate-90":a=Math.PI/2;break;case"rotate-180":a=Math.PI;break;case"rotate-270":a=-Math.PI/2;break;default:a=(o=r.transform.greenSplit("-"))[1]/180*Math.PI,o.recycle()}l.angle=a,r.anchor&&(l.offset=r.offset,l.offset||(l.offset=this.owner.position.copy().subtractVector(r.anchor,2),l.recycleOffset=!0)),this.tweens.push(l)}}(),transform:function(t){this.transform(t)},"prepend-transform":function(t){this.transform(t)},"append-transform":function(t){this.transform(t,!0)},"replace-transform":function(t){this.replace(t)}},methods:{transform:function(t,e){Array.isArray(t)?this.multiply(t,e):"string"==typeof t&&s[t]&&this.multiply(s[t],e)},multiply:function(t,e){var i=0;for(e?r(this.matrix,t,this.matrix):r(t,this.matrix,this.matrix),i=0;i<this.vectors.length;i++)this.vectors[i].multiply(t),this.inverses[i].multiply(t);this.owner.triggerEvent("orientation-updated",t)},replace:function(){var t=function(t,e,i,n){return t*n-e*i},e=function(e){var i=Array.setUp(Array.setUp(),Array.setUp(),Array.setUp()),n=1/function(t){var e=0,i=0;for(e=0;3>e;e++)i+=t[e][0]*t[(e+1)%3][1]*t[(e+2)%3][2],i-=t[e][2]*t[(e+1)%3][1]*t[(e+2)%3][0];return i}(e);return i[0].push(t(e[1][1],e[1][2],e[2][1],e[2][2])*n),i[0].push(t(e[0][2],e[0][1],e[2][2],e[2][1])*n),i[0].push(t(e[0][1],e[0][2],e[1][1],e[1][2])*n),i[1].push(t(e[1][2],e[1][0],e[2][2],e[2][0])*n),i[1].push(t(e[0][0],e[0][2],e[2][0],e[2][2])*n),i[1].push(t(e[0][2],e[0][0],e[1][2],e[1][0])*n),i[2].push(t(e[1][0],e[1][1],e[2][0],e[2][1])*n),i[2].push(t(e[0][1],e[0][0],e[2][1],e[2][0])*n),i[2].push(t(e[0][0],e[0][1],e[1][0],e[1][1])*n),i};return function(t){var i=e(this.matrix);this.multiply(i),this.multiply(t),i.recycle(2)}}(),updateTween:function(){var t=function(t,e,i){return t*(1-i)+e*i};return function(i,n){var s=0,o=1,a=0,h=0,l=1,u=1,c=0,d=i.endMatrix,p=null,f=null,g=null;return i.beforeTick(i.time)&&(i.time+=n),i.time>=i.endTime||(s=i.tween(i.time/i.endTime),i.angle?(c=s*i.angle,o=l=Math.cos(c),h=-(a=Math.sin(c))):(o=t(o,d[0][0],s),a=t(a,d[1][0],s),h=t(h,d[0][1],s),l=t(l,d[1][1],s),u=t(u,d[2][2],s)),p=Array.setUp(Array.setUp(o,h,0),Array.setUp(a,l,0),Array.setUp(0,0,u)),r(this.matrixTween,p,this.matrixTween),i.anchor&&(f=e.setUp(i.offset).multiply(1-s),g=e.setUp(i.offset).multiply(s),this.owner.triggerEvent("relocate-entity",{position:f.add(g).multiply(p).addVector(i.anchor)}),f.recycle(),g.recycle()),i.afterTick(s,p),p.recycle(2),!1)}}(),updateVector:function(t,e){e.setVector(t.add(e)),t.multiply(this.matrixTween),e.subtractVector(t)},destroy:function(){this.vectors.recycle(),this.inverses.recycle(),this.tweens.recycle(),this.orientationVector.recycle(),this.orientationMatrix.recycle(2),this.matrix.recycle(2),this.matrixTween.recycle(2),this.relocationMessage.recycle()}}})}(),function(){"use strict";var t=function(t){return function(e,i){this.owner.trigger(t[Math.floor(Math.random()*t.length)],e,i)}};platypus.createComponentClass({id:"RandomEvents",constructor:function(e){var i="";if(e.events)for(i in e.events)e.events.hasOwnProperty(i)&&this.addEventListener(i,t(e.events[i]))}})}(),function(){"use strict";platypus.createComponentClass({id:"RelayFamily",properties:{events:null},constructor:function(){var t="";if(this.events)for(t in this.events)this.events.hasOwnProperty(t)&&this.addEventListener(t,this.broadcast.bind(this,null,this.events[t]));this.owner.familyLinks=Array.setUp(this.owner)},events:{"link-family":function(t){var e=0,i=this.owner.familyLinks,n=Array.setUp().union(t).union(i);for(e=0;e<n.length;e++)n[e].familyLinks=n;this.broadcast(t,"family-members-added",i),this.broadcast(i,"family-members-added",t),i.recycle()},"entity-created":function(t){t.triggerEvent("link-family",this.owner.familyLinks)||(t.addComponent(new platypus.components.RelayFamily(t,{})),t.triggerEvent("link-family",this.owner.familyLinks))}},methods:{broadcast:function(t){var e=t||this.owner.familyLinks,i=0,n=Array.prototype.greenSlice.call(arguments);for(n.greenSplice(0),i=0;i<e.length;i++)e[i].trigger.apply(e[i],n);n.recycle()},destroy:function(){var t=this.owner.familyLinks,e=t.indexOf(this.owner);e>=0&&t.greenSplice(e),this.broadcast(t,"family-member-removed",this.owner),this.events=null}}})}(),function(){"use strict";var t=function(){var t=platypus.game.currentScene;t.triggerOnChildren.apply(t,arguments)};platypus.createComponentClass({id:"RelayGame",properties:{events:null},constructor:function(){var e="",i=this.events;if(i)for(e in i)i.hasOwnProperty(e)&&this.addEventListener(e,t.bind(this,i[e]))}})}(),function(){"use strict";var t=function(){var t=0,e=null;for(t=0;t<this.links.length;t++)(e=this.links[t]).trigger.apply(e,arguments)};platypus.createComponentClass({id:"RelayLinker",properties:{linkId:"linked",events:null},constructor:function(){var e=0,i="";if(this.events)for(i in this.events)this.events.hasOwnProperty(i)&&this.addEventListener(i,t.bind(this,this.events[i]));if(this.owner.linkId||(this.owner.linkId=this.linkId),this.addEventListener("to-"+this.linkId+"-entities",t.bind(this,"from-"+this.linkId+"-entities")),this.addEventListener("from-"+this.linkId+"-entities",function(t){this.owner.trigger(t.message,t.value,t.debug)}.bind(this)),this.links=Array.setUp(),this.owner.linkEntities)for(e=0;e<this.owner.linkEntities.length;e++)this.links.push(this.owner.linkEntities[e]);this.message={message:"",value:null},this.linkMessage={entity:this.owner,linkId:this.linkId,reciprocate:!1},this.owner.parent&&this.resolveAdoption()},events:{adopted:function(t){this.resolveAdoption(t)},"link-entity":function(t){t.linkId===this.linkId&&t.entity!==this.owner&&-1===this.links.indexOf(t.entity)&&(this.links.push(t.entity),t.reciprocate&&(this.linkMessage.reciprocate=!1,t.entity.triggerEvent("link-entity",this.linkMessage)))},"unlink-entity":function(t){var e=this.links.indexOf(t.entity);e>=0&&this.links.greenSplice(e)}},methods:{resolveAdoption:function(){for(var t=this.owner.parent;t.parent;)t=t.parent;this.linkMessage.reciprocate=!0,t.triggerOnChildren("link-entity",this.linkMessage)},destroy:function(){var t=0;for(t=0;t<this.links.length;t++)this.links[t].triggerEvent("unlink-entity",this.linkMessage);this.links.recycle(),this.links=null,this.events=null}}})}(),function(){"use strict";var t=function(){var t=this.owner.parent;t&&t.trigger.apply(t,arguments)};platypus.createComponentClass({id:"RelayParent",properties:{events:null},constructor:function(){var e="",i=this.events;if(i)for(e in i)i.hasOwnProperty(e)&&this.addEventListener(e,t.bind(this,i[e]))}})}(),function(){"use strict";var t=function(){var t=this.owner;t.trigger.apply(t,arguments)};platypus.createComponentClass({id:"RelaySelf",properties:{events:null},constructor:function(){var e="",i=this.events;if(i)for(e in i)i.hasOwnProperty(e)&&this.addEventListener(e,t.bind(this,i[e]))}})}(),function(){"use strict";var t=include("PIXI.Graphics"),e={aabb:16746751,render:255,collision:16711935,group:65280},i=function(i,n,s,r,o,a,h){var l=null;switch(i){case"rectangle":l=(new t).beginFill(e[n],.1).drawRect(s,r,o,a);break;case"circle":l=(new t).beginFill(e[n],.1).drawCircle(0,0,o)}return l.z=h,l};platypus.createComponentClass({id:"RenderDebug",constructor:function(){this.parentContainer=null,this.shapes=Array.setUp(),this.isOutdated=!0},events:{"handle-render-load":function(t){platypus.game.settings.debug?!this.parentContainer&&t&&t.container&&(this.parentContainer=t.container):this.owner.removeComponent(this)},"handle-render":function(e){var i=0,n=null;if(!this.parentContainer){if(!platypus.game.settings.debug)return void this.owner.removeComponent(this);if(!e.container)return platypus.debug.warn('No Container, removing render debug component from "'+this.owner.type+'".'),void this.owner.removeComponent(this);this.parentContainer=e.container}for(this.isOutdated&&(this.updateSprites(),this.isOutdated=!1),i=0;i<this.shapes.length;i++)this.shapes[i].x=this.owner.x,this.shapes[i].y=this.owner.y;this.owner.getCollisionGroupAABB&&(n=this.owner.getCollisionGroupAABB(),this.groupShape||(this.groupShape=(new t).beginFill("rgba(255,255,0,0.2)").drawRect(-.5,-.5,1,1),this.groupShape.z=(this.owner.z||0)+1e4,this.parentContainer.addChild(this.groupShape)),this.groupShape.scaleX=n.width,this.groupShape.scaleY=n.height,this.groupShape.x=n.x,this.groupShape.y=n.y)},"orientation-updated":function(){this.isOutdated=!0}},methods:{updateSprites:function(){var t=(this.owner.z||0)+1e4,e=0,n=0,s=this.owner.width=this.owner.width||100,r=this.owner.height=this.owner.height||100,o=null,a=null,h=null;for(e=0;e<this.shapes.length;e++)this.parentContainer.removeChild(this.shapes[e]);if(this.shapes.length=0,this.owner.getAABB)for(n=0;n<this.owner.collisionTypes.length;n++)for(a=this.owner.getAABB(this.owner.collisionTypes[n]),s=this.initialWidth=a.width,r=this.initialHeight=a.height,o=this.owner.getShapes(this.owner.collisionTypes[n]),h=i("rectangle","aabb",a.left-this.owner.x,a.top-this.owner.y,s,r,t--),this.shapes.push(h),this.parentContainer.addChild(h),this.addInput(h),e=0;e<o.length;e++)h=i(o[e].type,"collision",o[e].offsetX-o[e].width/2,o[e].offsetY-o[e].height/2,o[e].radius||o[e].width,o[e].height,t--),this.shapes.push(h),this.parentContainer.addChild(h),this.addInput(h);else h=i("rectangle","render",-s/2,-r/2,s,r,t--),this.shapes.push(h),this.parentContainer.addChild(h),this.addInput(h)},addInput:function(){var t=null,e=function(){return t!==this.owner&&(t=this.owner,platypus.debug.olive('Entity "'+t.type+'":',t)),!1};return function(t){t.interactive=!0,t.addListener("rightdown",e.bind(this))}}(),destroy:function(){var t=0;for(t=0;t<this.shapes.length;t++)this.parentContainer.removeChild(this.shapes[t]);this.shapes.recycle(),this.parentContainer=null}}})}(),function(){"use strict";platypus.createComponentClass({id:"RenderDestroyMe",properties:{animationId:"",animationIds:null},constructor:function(t){this.animationId?this.animationIds=Array.setUp(t.animationId):this.animationIds&&(this.animationIds=this.animationIds.greenSlice())},events:{"animation-ended":function(t){(!this.animationIds||this.animationIds.indexOf(t)>=0)&&this.owner.parent.removeEntity(this.owner)}},methods:{destroy:function(){this.animationIds&&(this.animationIds.recycle(),delete this.animationIds)}}})}(),function(){"use strict";platypus.createComponentClass({id:"RenderProgress",properties:{backgroundColor:0,color:16777215,rotate:!1,mirror:!1,flip:!1,width:100,height:20,regX:0,regY:0},publicProperties:{x:0,y:0,z:0},constructor:function(){var t=new PIXI.Graphics,e=new PIXI.Graphics,i=new PIXI.Container;this.parentContainer=null,this.background=t,this.progress=e,this.container=i,"string"==typeof this.backgroundColor&&(this.backgroundColor=+this.backgroundColor.replace("#","0x")),"string"==typeof this.color&&(this.color=+this.color.replace("#","0x")),t.f(this.backgroundColor).r(-this.regX,-this.regY,this.width,this.height),e.f(this.color).r(-this.regX,-this.regY,this.width,this.height),e.scale=new PIXI.Point(1e-4,1),i.addChild(t),i.addChild(e)},events:{"handle-render-load":function(t){!this.parentContainer&&t&&t.container&&(this.parentContainer=t.container,this.parentContainer.addChild(this.container))},"handle-render":function(t){this.container&&(this.parentContainer||(t&&t.container?(this.parentContainer=t.container,this.parentContainer.addChild(this.container)):(platypus.debug.warn('No PIXI Stage, removing ProgressRender component from "'+this.owner.type+'".'),this.owner.removeComponent(this))),this.container.x=this.x,this.container.y=this.y,this.container.z=this.z)},"update-progress":function(t){isNaN(t)?"number"==typeof t.fraction?this.progress.scale.x=t.fraction:"number"==typeof t.total&&"number"==typeof t.progress&&(this.progress.scale.x=t.progress/t.total):this.progress.scale.x=t}},methods:{destroy:function(){this.parentContainer&&(this.parentContainer.removeChild(this.container),this.parentContainer=null),this.container=null}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("PIXI.spine.SpineRuntime.Atlas",!1),i=include("PIXI.spine.SpineRuntime.AtlasAttachmentParser",!1),n=include("PIXI.BaseTexture"),s=include("platypus.Data"),r=include("platypus.components.EventRender"),o=include("PIXI.Graphics"),a=include("PIXI.Matrix"),h=include("PIXI.spine.SpineRuntime.SkeletonJsonParser",!1),l=include("PIXI.spine.Spine",!1),u=include("platypus.components.StateRender"),c=(new a,function(){var t=function(t,e){var i=0,n=e.indexOf("("),s=e.substring(0,n),r=e.substring(n+1,e.indexOf(")"));if(r.length){for(i=(r=r.greenSplit(",")).length;i--;)r[i]=+r[i];t[s].apply(t,r),r.recycle()}else t[s]()};return function(e,i){var n=0,s=i.greenSplit(".");for(n=0;n<s.length;n++)t(e,s[n]);s.recycle()}}());l&&platypus.createComponentClass({id:"RenderSpine",properties:{animationMap:null,mask:null,interactive:!1,mixTimes:0,offsetZ:0,atlas:"",skeleton:null,visible:!0,eventBased:!1,stateBased:!0},publicProperties:{dragMode:!1,scaleX:1,scaleY:1,skewX:0,skewY:0,rotation:0,x:0,y:0,z:0},constructor:function(){var o=function(t,e){e(n.fromImage(t))},c=function(){this.owner.triggerEvent("animation-ended",this.currentAnimation)};return function(){var n,d="",p=null,f=platypus.game.settings,g=f.atlases[this.atlas],v=f.skeletons[this.skeleton],m=new e(g,o),y=new h(new i(m)).readSkeletonData(v),_=this.spine=new l(y);_.transformMatrix=new a,_.state.onComplete=c.bind(this),n=function(t,e){var i=null,n="";if(t)return t;for(n in i={},e)e.hasOwnProperty(n)&&(i[n]=n);return i}(this.animationMap,v.animations),this.stateBased=n&&this.stateBased,this.eventBased=n&&this.eventBased,n&&(d=n.default||"",this.eventBased&&(p=s.setUp("animationMap",n),this.owner.addComponent(new r(this.owner,p)),p.recycle()),this.stateBased&&(p=s.setUp("animationMap",n,"forcePlayThrough",this.forcePlayThrough),this.owner.addComponent(new u(this.owner,p)),p.recycle())),this.parentContainer=null,this.wasVisible=this.visible,this.lastX=this.owner.x,this.lastY=this.owner.y,this.camera=t.setUp(),this.affine=new a,this.isOnCamera=!0,this.interactive&&(p=s.setUp("container",this.spine,"hitArea",this.interactive.hitArea,"hover",this.interactive.hover),this.owner.addComponent(new platypus.components.Interactive(this.owner,p)),p.recycle()),this.mixTimes&&this.setMixTimes(this.mixTimes),d&&(this.currentAnimation=d,_.state.setAnimationByName(0,d,!0))}}(),events:{"camera-update":function(t){this.camera.set(t.viewport),this.spine&&this.checkCameraBounds()},"handle-render-load":function(t){!this.parentContainer&&t&&t.container&&(this.addStage(t.container),this.updateSprite(!0))},"handle-render":function(t){return this.spine?this.parentContainer||this.addStage(t.container)?void this.updateSprite(!0):(platypus.debug.warn('No PIXI Stage, removing render component from "'+this.owner.type+'".'),void this.owner.removeComponent(this)):void 0},"set-mix-times":function(t){this.setMixTimes(t)},hide:function(){this.visible=!1},show:function(){this.visible=!0},"set-mask":function(t){this.setMask(t)},"stop-animation":function(t){var e=this.spine;t&&e.state.hasAnimationByName(t)&&(this.currentAnimation=t,e.state.setAnimationByName(0,t,!1)),this.paused=!0},"play-animation":function(t){var e=this.spine;t&&e.state.hasAnimationByName(t)&&(this.currentAnimation=t,e.state.setAnimationByName(0,t,!0)),this.paused=!1}},methods:{addStage:function(t){return t?(this.parentContainer=t,this.parentContainer.addChild(this.spine),this.mask&&this.setMask(this.mask),this.owner.triggerEvent("input-on"),t):null},checkCameraBounds:function(){this.isOnCamera=!0},setMixTimes:function(t){var e=this.spine,i=e.spineData.animations,n=0,s=0,r=0,o="",a=e.stateData;if("number"==typeof t)for(s=i.length;s--;)for(r=i.length;r--;)s!==r&&a.setMixByName(i[s].name,i[r].name,t);else for(o in t)t.hasOwnProperty(o)&&((n=o.indexOf(":"))>=0&&a.setMixByName(o.substring(0,n),o.substring(n+1),t[o]));this.mixTimes=a.animationToMixTime},setMask:function(t){var e=null;return this.mask&&this.parentContainer&&this.parentContainer.removeChild(this.mask),t?(t instanceof o?e=t:((e=new o).beginFill(0,1),"string"==typeof t?c(e,t):t.radius?e.dc(t.x||0,t.y||0,t.radius):t.width&&t.height&&e.r(t.x||0,t.y||0,t.width,t.height),e.endFill()),e.isMask=!0,this.mask=this.container.mask=e,void(this.parentContainer&&this.parentContainer.addChild(this.mask))):void(this.mask=this.container.mask=null)},updateSprite:function(t){var e=this.spine,i=this.affine.copy(e.transformMatrix),n=null,s=a.TEMP_MATRIX;this.owner.triggerEvent("update-animation",t),e.z!==this.owner.z+this.offsetZ&&(this.parentContainer&&(this.parentContainer.reorder=!0),e.z=this.owner.z+this.offsetZ),"number"==typeof this.owner.opacity&&(e.alpha=this.owner.opacity),this.owner.orientationMatrix&&(n=this.owner.orientationMatrix,s.tx=n[0][2],s.ty=n[1][2],s.a=n[0][0],s.b=n[1][0],s.c=n[0][1],s.d=n[1][1],i.prepend(s)),s.tx=this.owner.x,s.ty=this.owner.y,s.a=this.scaleX||1,s.b=this.owner.skewX||0,s.c=this.owner.skewY||0,s.d=this.scaleY||1,i.prepend(s),(!this.wasVisible&&this.visible||this.lastX!==this.owner.x||this.lastY!==this.owner.y)&&this.checkCameraBounds(),this.lastX=this.owner.x,this.lastY=this.owner.y,this.wasVisible=this.visible,this.spine.visible=this.visible&&this.isOnCamera||this.dragMode},destroy:function(){this.camera.recycle(),this.parentContainer&&!this.spine.mouseTarget&&(this.parentContainer.removeChild(this.spine),this.parentContainer=null,this.spine.destroy()),this.spine=null,this.mixTimes=null}},getAssetList:function(){var t=function(e,i){var n=0;return e?0>(n=e.indexOf("\n"))?t(i[e],i):Array.setUp(e.substring(0,n).replace("\r","")):Array.setUp()};return function(e,i,n){var s=null,r=0,o=null,a=platypus.game.settings.atlases,h=e.atlas||i.atlas||n.atlas;if(Array.isArray(h)){for(r=h.length,o=Array.setUp();r--;)s=t(h[r],a),o.union(s),s.recycle();return o}return t(h,a)}}()})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("PIXI.Container"),i=include("platypus.Data"),n=include("platypus.components.EventRender"),s=include("PIXI.Graphics"),r=include("platypus.components.Interactive"),o=include("PIXI.Matrix"),a=include("platypus.PIXIAnimation"),h=include("platypus.components.StateRender"),l=new o,u=function(){var t=function(t,e){var i=0,n=e.indexOf("("),s=e.substring(0,n),r=e.substring(n+1,e.indexOf(")"));if(r.length){for(i=(r=r.greenSplit(",")).length;i--;)r[i]=+r[i];t[s].apply(t,r),r.recycle()}else t[s]()};return function(e,i){var n=0,s=i.greenSplit(".");for(n=0;n<s.length;n++)t(e,s[n]);s.recycle()}}();platypus.createComponentClass({id:"RenderSprite",properties:{spriteSheet:null,animationMap:null,mask:null,interactive:!1,acceptInput:null,pinLocations:null,pinTo:null,offsetZ:0,restart:!0,rotate:!1,mirror:!1,flip:!1,visible:!0,eventBased:!1,stateBased:!0,cache:!1,forcePlayThrough:!1,ignoreOpacity:!1},publicProperties:{dragMode:!1,scaleX:1,scaleY:1,skewX:0,skewY:0,rotation:0,x:0,y:0,z:0},constructor:function(){var s=function(t){this.owner.triggerEvent("animation-ended",t)};return function(){var l,u="",c=null,d=a.formatSpriteSheet(this.spriteSheet);this.acceptInput&&(platypus.debug.warn('Entity "'+this.owner.type+'": RenderSprite "acceptInput" property has been deprecated since 0.9.0 in favor of the "interactive" property which adds an "Interactive" component to the entity to handle input.'),this.interactive=this.interactive||this.acceptInput),d===a.EmptySpriteSheet&&platypus.debug.warn('Entity "'+this.owner.type+'": RenderSprite sprite sheet not defined.'),l=function(t,e){var i=null,n="";if(t)return t;if(Array.isArray(e.frames)&&1===e.frames.length)return null;for(n in i={},e.animations)e.animations.hasOwnProperty(n)&&(i[n]=n);return i}(this.animationMap,d),this.stateBased=l&&this.stateBased,this.eventBased=l&&this.eventBased,l&&(u=l.default||"",this.eventBased&&(c=i.setUp("animationMap",l,"restart",this.restart,"component",this),this.owner.addComponent(new n(this.owner,c)),c.recycle()),this.stateBased&&(c=i.setUp("animationMap",l,"forcePlayThrough",this.forcePlayThrough),this.owner.addComponent(new h(this.owner,c)),c.recycle())),this.parentContainer=null,this.wasVisible=this.visible,this.lastX=this.owner.x,this.lastY=this.owner.y,this.camera=t.setUp(),this.affine=new o,this.isOnCamera=!0,this.sprite=new a(d,u),this.sprite.on("complete",s.bind(this)),this.pinLocations?(platypus.debug.warn('Entity "'+this.owner.type+'": RenderSprite pinning has been deprecated in favor of the "RenderSpine" component which provides better functionality.'),this.container=new e,this.container.transformMatrix=new o,this.container.addChild(this.sprite),this.sprite.z=0,this.addPins(this.pinLocations,d.frames),this.sprite.transformMatrix=new o):(this.container=this.sprite,this.sprite.transformMatrix=new o),this.pinTo&&this.owner.triggerEvent("pin-me",this.pinTo),this.interactive&&(c=i.setUp("container",this.container,"hitArea",this.interactive.hitArea,"hover",this.interactive.hover),this.owner.addComponent(new r(this.owner,c)),c.recycle()),this.cache&&(this.updateSprite(!1),this.owner.cacheRender=this.container),d.recycleSpriteSheet()}}(),events:{cache:function(){this.updateSprite(!1),this.owner.cacheRender=this.container,this.cache=!0,this.owner.parent&&this.owner.parent.triggerEventOnChildren?this.owner.parent.triggerEventOnChildren("cache-sprite",this.owner):platypus.debug.warn("Unable to cache sprite for "+this.owner.type)},"camera-update":function(t){this.camera.set(t.viewport),this.sprite&&this.checkCameraBounds()},"handle-render-load":function(t){!this.parentContainer&&t&&t.container&&(this.addStage(t.container),this.updateSprite(!0))},"handle-render":function(t){if(this.container){if(!this.parentContainer){if(this.pinTo)return;if(!this.addStage(t.container))return platypus.debug.warn('No PIXI Stage, removing render component from "'+this.owner.type+'".'),void this.owner.removeComponent(this)}this.updateSprite(!0)}},"hide-sprite":function(){this.visible=!1},"show-sprite":function(){this.visible=!0},"pin-me":function(t){this.pins&&this.pins[t]&&this.owner.triggerEvent("attach-pin",this.pins[t])},"attach-pin":function(t){t.pinId===this.pinTo&&(this.parentContainer=t.container,this.parentContainer.addChild(this.container),this.owner.triggerEvent("input-on"),this.pinnedTo=t,this.updateSprite(!0))},"remove-pin":function(t){t.pinId===this.pinTo&&(this.parentContainer.removeChild(this.container),this.parentContainer=null,this.pinnedTo=null)},"set-mask":function(t){this.setMask(t)},"stop-animation":function(t){var e=this.sprite;t&&e.has(t)?e.gotoAndStop(t):e.stop()},"play-animation":function(t,e){this.playAnimation(t,e)},"stop-sprite":function(){this.sprite.stop()},"play-sprite":function(){this.sprite.play()}},methods:{checkCameraBounds:function(){var t,e=this.sprite,i=null,n=null;for(i=e.transformMatrix.copy(l),n=this.pinnedTo;n;)i.prepend(n.container.transformMatrix),n=n.pinnedTo;e._currentBounds=null,(t=e.getBounds(i))&&(t.x+t.width<this.camera.left||t.x>this.camera.right||t.y+t.height<this.camera.top||t.y>this.camera.bottom)?this.isOnCamera=!1:this.isOnCamera=!0},addStage:function(t){return t&&!this.pinTo?(this.parentContainer=t,this.parentContainer.addChild(this.container),this.mask&&this.setMask(this.mask),this.owner.triggerEvent("input-on"),t):null},updateSprite:function(){var t=function(t,e){return t.z-e.z};return function(e){var i=0,n=0,s=null,r=0,a=1,h=1,l=null,u=this.affine.copy(this.container.transformMatrix),c=o.TEMP_MATRIX;this.pinnedTo?this.pinnedTo.frames&&this.pinnedTo.frames[this.pinnedTo.sprite.currentFrame]?(i=this.pinnedTo.frames[this.pinnedTo.sprite.currentFrame].x,n=this.pinnedTo.frames[this.pinnedTo.sprite.currentFrame].y,this.container.z!==this.pinnedTo.frames[this.pinnedTo.sprite.currentFrame].z&&(this.parentContainer&&(this.parentContainer.reorder=!0),this.container.z=this.pinnedTo.frames[this.pinnedTo.sprite.currentFrame].z),r=this.pinnedTo.frames[this.pinnedTo.sprite.currentFrame].angle||0,this.visible=!0):this.pinnedTo.defaultPin?(i=this.pinnedTo.defaultPin.x,n=this.pinnedTo.defaultPin.y,this.container.z!==this.pinnedTo.defaultPin.z&&(this.parentContainer&&(this.parentContainer.reorder=!0),this.container.z=this.pinnedTo.defaultPin.z),r=this.pinnedTo.defaultPin.angle||0,this.visible=!0):this.visible=!1:(i=this.owner.x,n=this.owner.y,this.rotate&&(r=this.rotation),this.container.z!==this.owner.z+this.offsetZ&&(this.parentContainer&&(this.parentContainer.reorder=!0),this.container.z=this.owner.z+this.offsetZ),this.ignoreOpacity||!this.owner.opacity&&0!==this.owner.opacity||(this.container.alpha=this.owner.opacity)),this.container.reorder&&(this.container.reorder=!1,this.container.children.sort(t)),(this.mirror||this.flip)&&(l=this.rotation%360,this.mirror&&l>90&&270>l&&(a=-1),this.flip&&180>l&&(h=-1)),this.owner.triggerEvent("update-animation",e),r&&u.rotate(r/180*Math.PI),this.pinnedTo?(c.tx=i,c.ty=n,c.a=a,c.b=0,c.c=0,c.d=h,u.prepend(c)):(this.owner.orientationMatrix&&(s=this.owner.orientationMatrix,c.tx=s[0][2],c.ty=s[1][2],c.a=s[0][0],c.b=s[1][0],c.c=s[0][1],c.d=s[1][1],u.prepend(c)),c.tx=i,c.ty=n,c.a=this.scaleX*a,c.b=this.owner.skewX,c.c=this.owner.skewY,c.d=this.scaleY*h,u.prepend(c)),this.sprite&&(!this.wasVisible&&this.visible||this.lastX!==this.owner.x||this.lastY!==this.owner.y)&&this.checkCameraBounds(),this.lastX=this.owner.x,this.lastY=this.owner.y,this.wasVisible=this.visible,this.container.visible=this.visible&&this.isOnCamera||this.dragMode}}(),addPins:function(t,e){var i=0,n=0,s=null,r=e.regX||0,o=e.regY||0,a=Array.isArray(e);for(this.pinsToRemove=this.pinsToRemove||Array.setUp(),this.pins={},i=0;i<t.length;i++){if(this.pinsToRemove.push(t[i].pinId),a&&(r=e[0][5]||0,o=e[0][6]||0),this.pins[t[i].pinId]=s={pinId:t[i].pinId,sprite:this.sprite,container:this.container},"number"==typeof t[i].x&&"number"==typeof t[i].y&&(s.defaultPin={x:t[i].x-r,y:t[i].y-o,z:t[i].z||1e-8,angle:t[i].angle||0}),t[i].frames)for(s.frames=Array.setUp(),n=0;n<t[i].frames.length;n++)t[i].frames[n]?(a&&(r=e[n][5]||0,o=e[n][6]||0),"number"==typeof t[i].frames[n].x&&"number"==typeof t[i].frames[n].y?s.frames.push({x:t[i].frames[n].x-r,y:t[i].frames[n].y-o,z:t[i].frames[n].z||(s.defaultPin?s.defaultPin.z:1e-8),angle:t[i].frames[n].angle||(s.defaultPin?s.defaultPin.angle:0)}):s.defaultPin?"number"==typeof t[i].frames[n].x?s.frames.push({x:t[i].frames[n].x-r,y:s.defaultPin.y,z:t[i].frames[n].z||s.defaultPin.z,angle:t[i].frames[n].angle||s.defaultPin.angle}):"number"==typeof t[i].frames[n].y?s.frames.push({x:s.defaultPin.x,y:t[i].frames[n].y-o,z:t[i].frames[n].z||s.defaultPin.z,angle:t[i].frames[n].angle||s.defaultPin.angle}):s.frames.push(null):s.frames.push(null)):s.frames.push(null);this.owner.triggerEvent("attach-pin",s)}},playAnimation:function(t,e){var i=this.sprite;t&&i.has(t)?i.gotoAndPlay(t,e):i.play()},removePins:function(){var t=0;if(this.pins&&this.pinsToRemove){for(t=0;t<this.pinsToRemove.length;t++)this.owner.triggerEvent("remove-pin",this.pins[this.pinsToRemove[t]].pinId),this.pins[this.pinsToRemove[t]].frames&&this.pins[this.pinsToRemove[t]].frames.recycle(),delete this.pins[this.pinsToRemove[t]];this.pinsToRemove.recycle()}},setMask:function(t){var e=null;return this.mask&&this.parentContainer&&this.parentContainer.removeChild(this.mask),t?(t instanceof s?e=t:((e=new s).beginFill(0,1),"string"==typeof t?u(e,t):t.radius?e.dc(t.x||0,t.y||0,t.radius):t.width&&t.height&&e.r(t.x||0,t.y||0,t.width,t.height),e.endFill()),e.isMask=!0,this.mask=this.container.mask=e,this.mask.z=0,void(this.parentContainer&&this.parentContainer.addChild(this.mask))):void(this.mask=this.container.mask=null)},destroy:function(){this.camera.recycle(),this.parentContainer&&!this.container.mouseTarget&&(this.parentContainer.removeChild(this.container),this.parentContainer=null,this.container=null),this.removePins(),this.cache||this.sprite.destroy(),this.sprite=null}},getAssetList:function(){var t=function(e,i){if(e){if("string"==typeof e)return t(i[e],i);if(e.images)return e.images.greenSlice()}return Array.setUp()};return function(e,i,n){var s=null,r=0,o=null,a=platypus.game.settings.spriteSheets,h=e.spriteSheet||i.spriteSheet||n.spriteSheet;if(Array.isArray(h)){for(r=h.length,o=Array.setUp();r--;)s=t(h[r],a),o.union(s),s.recycle();return o}return t(h,a)}}()})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.PIXIAnimation"),i=include("springroll.Application"),n=include("PIXI.CanvasRenderer"),s=include("PIXI.Container"),r=include("PIXI.Graphics"),o=include("PIXI.ParticleContainer"),a=include("PIXI.Rectangle"),h=include("PIXI.RenderTexture"),l=include("PIXI.Sprite"),u=function(){return null},c=t.setUp(),d=function(t,e){return t.z-e.z},p=function(t){for(var e=1;t>e;)e*=2;return e},f=function(t,e){this.id=e,this.instances=Array.setUp(t),this.index=0,t.template=this},g={getNext:u,destroy:u},v=f.prototype;v.getNext=function(){var t=this.instances[this.index],e=null;return t||(e=this.instances[0],(t=this.instances[this.index]=new l(e.texture)).scale=e.scale,t.rotation=e.rotation,t.anchor=e.anchor),this.index+=1,t},v.clear=function(){this.index=0},v.destroy=function(){var t=0;for(t=0;t<this.instances.length;t++)this.instances[t].destroy();this.instances.recycle(),this.recycle()},recycle.add(f,!!springroll.Debug,"Template"),platypus.createComponentClass({id:"RenderTiles",properties:{buffer:0,cacheAll:!1,entityCache:!1,imageMap:[],maximumBuffer:2048,scaleX:1,scaleY:1,spriteSheet:null,tileCache:!0,tileHeight:10,tileWidth:10,top:0,left:0},constructor:function(){var r=this.imageMap;this.doMap=null,this.cachedDisplayObjects=null,this.populate=this.populateTiles,this.tiles={},this.renderer=i.instance.display.renderer,this.tilesSprite=null,this.cacheTexture=null,this.mapContainer=null,this.laxCam=t.setUp(),this.worldWidth=this.tileWidth,this.worldHeight=this.tileHeight,this.cache=t.setUp(),this.cachePixels=t.setUp(),this.spriteSheet=e.formatSpriteSheet(this.spriteSheet),this.tileContainer=this.spriteSheet.images.length>1||this.renderer instanceof n?new s:new o(15e3,{position:!0,rotation:!0,scale:!0}),this.mapContainer=new s,this.mapContainer.addChild(this.tileContainer),this.reorderedStage=!1,this.updateCache=!1,this.imageMap=Array.setUp(this.createMap(r)),this.tilesWidth=this.imageMap[0].length,this.tilesHeight=this.imageMap[0][0].length,this.layerWidth=this.tilesWidth*this.tileWidth,this.layerHeight=this.tilesHeight*this.tileHeight,this.cacheWidth=Math.min(p(this.layerWidth),this.maximumBuffer),this.cacheHeight=Math.min(p(this.layerHeight),this.maximumBuffer),this.tileCache||(this.buffer=0,this.cacheAll=!1)},events:{"handle-render-load":function(t){var e=this.mapContainer,i=null,n=this.renderer,r=null,o=this.owner.z;t&&t.container&&((i=this.parentContainer=t.container)&&!this.reorderedStage&&(i.reorder=!0,this.reorderedStage=!0),this.updateRegion(0),this.tileCache?(this.mapContainerWrapper=new s,this.mapContainerWrapper.addChild(e),this.layerWidth<=this.cacheWidth&&this.layerHeight<=this.cacheHeight?(this.cacheAll=!0,this.render=this.renderCache,this.cacheTexture=new h(n,this.cacheWidth,this.cacheHeight),this.tilesSprite=r=new l(this.cacheTexture),r.scaleX=this.scaleX,r.scaleY=this.scaleY,r.z=o,this.cache.setBounds(0,0,this.tilesWidth-1,this.tilesHeight-1),this.update(this.cacheTexture,this.cache),i.addChild(r)):this.cacheAll||this.layerWidth<=2*this.cacheWidth&&this.layerHeight<=this.cacheHeight||this.layerWidth<=this.cacheWidth&&this.layerHeight<=2*this.cacheHeight?(this.cacheAll=!0,this.cacheWidth=Math.min(p(this.layerWidth+2),this.maximumBuffer),this.cacheHeight=Math.min(p(this.layerHeight+2),this.maximumBuffer),this.updateRegion(2),this.render=this.renderCacheWithExtrusion,this.cacheGrid=this.createGrid(i,n),this.updateCache=!0):(this.render=this.renderCache,this.cacheAll=!1,this.cacheTexture=new h(n,this.cacheWidth,this.cacheHeight),this.tilesSprite=new l(this.cacheTexture),this.tilesSprite.scaleX=this.scaleX,this.tilesSprite.scaleY=this.scaleY,this.tilesSprite.z=o,this.cacheTexture.alternate=new h(n,this.cacheWidth,this.cacheHeight),this.tilesSpriteCache=new l(this.cacheTexture.alternate),this.cacheTexture.alternate.alternate=this.cacheTexture,i.addChild(this.tilesSprite))):(this.render=u,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.x=this.left,e.y=this.top,e.z=o,i.addChild(e)))},"cache-sprite":function(t){this.cacheSprite(t)},"peer-entity-added":function(t){this.cacheSprite(t)},"add-tiles":function(t){var e=t.imageMap;e&&(this.imageMap.push(this.createMap(e)),this.updateCache=!0)},"change-tile":function(t,e,i,n){var s=this.imageMap;s&&(this.updateTile(t,s[n||0],e,i),this.updateCache=!0)},"camera-loaded":function(t){this.worldWidth=t.world.width,this.worldHeight=t.world.height,this.buffer&&!this.cacheAll&&this.updateBufferRegion(t.viewport)},"camera-update":function(t){var e=0,i=0,n=!1,s=null,r=0,o=0,a=0,h=0,l=this.cache,u=this.cachePixels,d=t.viewport,p=this.buffer&&(d.width!==this.laxCam.width||d.height!==this.laxCam.height),f=c,g=this.convertCamera(d);if(!this.cacheAll&&(u.empty||!u.contains(g))&&this.imageMap.length>0&&(p&&this.updateBufferRegion(g),a=(r=this.cacheTilesWidth-1)/2,h=(o=this.cacheTilesHeight-1)/2,f.setAll(Math.round((g.x-this.left)/this.tileWidth-a)+a,Math.round((g.y-this.top)/this.tileHeight-h)+h,r,o),f.left<0?f.moveX(f.halfWidth):f.right>this.tilesWidth-1&&f.moveX(this.tilesWidth-1-f.halfWidth),f.top<0?f.moveY(f.halfHeight):f.bottom>this.tilesHeight-1&&f.moveY(this.tilesHeight-1-f.halfHeight),this.tileCache?(l.empty||!f.contains(l))&&(this.tilesSpriteCache.texture=this.cacheTexture,this.cacheTexture=this.cacheTexture.alternate,this.tilesSprite.texture=this.cacheTexture,this.update(this.cacheTexture,f,this.tilesSpriteCache,l)):this.update(null,f),u.setAll((l.x+.5)*this.tileWidth+this.left,(l.y+.5)*this.tileHeight+this.top,(l.width+1)*this.tileWidth,(l.height+1)*this.tileHeight)),this.cacheGrid)for(e=0;e<this.cacheGrid.length;e++)for(i=0;i<this.cacheGrid[e].length;i++)s=this.cacheGrid[e][i],u.setAll((e+.5)*this.cacheClipWidth+this.left,(i+.5)*this.cacheClipHeight+this.top,this.cacheClipWidth,this.cacheClipHeight),n=u.intersects(g),s.visible&&!n?s.visible=!1:!s.visible&&n&&(s.visible=!0),s.visible&&n&&(s.x=d.left-g.left+e*this.cacheClipWidth+this.left,s.y=d.top-g.top+i*this.cacheClipHeight+this.top);else this.tileCache&&(this.tilesSprite.x=d.left-g.left+l.left*this.tileWidth+this.left,this.tilesSprite.y=d.top-g.top+l.top*this.tileHeight+this.top)},"handle-render":function(){this.updateCache&&(this.updateCache=!1,this.cacheGrid?this.updateGrid():this.update(this.cacheTexture,this.cache))}},methods:{cacheSprite:function(t){var e=0,i=0,n=t.cacheRender,s=null,r=0,o=0,a=0,h=0;if(this.entityCache&&n){for(this.doMap||(this.doMap=Array.setUp(),this.cachedDisplayObjects=Array.setUp(),this.populate=this.populateTilesAndEntities),this.cachedDisplayObjects.push(n),(s=n.getBounds(n.transformMatrix)).x-=this.left,s.y-=this.top,r=Math.max(0,Math.floor(s.y/this.tileHeight)),o=Math.min(this.tilesHeight,Math.ceil((s.y+s.height)/this.tileHeight)),h=Math.max(0,Math.floor(s.x/this.tileWidth)),a=Math.min(this.tilesWidth,Math.ceil((s.x+s.width)/this.tileWidth)),e=h;a>e;e++)for(this.doMap[e]||(this.doMap[e]=Array.setUp()),i=r;o>i;i++)this.doMap[e][i]||(this.doMap[e][i]=Array.setUp()),this.doMap[e][i].push(n);t.removeComponent("RenderSprite"),this.updateCache=!0}},convertCamera:function(t){var e=this.worldWidth/this.scaleX,i=e-t.width,n=this.worldHeight/this.scaleY,s=n-t.height,r=this.laxCam;return e!==this.layerWidth&&i?r.moveX((t.left-this.left)*(this.layerWidth-t.width)/i+t.halfWidth+this.left):r.moveX(t.x),n!==this.layerHeight&&s?r.moveY((t.top-this.top)*(this.layerHeight-t.height)/s+t.halfHeight+this.top):r.moveY(t.y),(t.width!==r.width||t.height!==r.height)&&r.resize(t.width,t.height),r},createTile:function(t){var i=null,n="";return"tile-1"===t?g:(n="tile"+function(t,e){var i=+t.substring(4),n=0;return 2147483648&i&&(e.scale.x=-1),1073741824&i&&(e.scale.y=-1),536870912&i&&(n=e.scale.x,e.scale.x=e.scale.y,e.scale.y=-n,e.rotation=Math.PI/2),268435455&i}(t,i=new e(this.spriteSheet)),i.gotoAndStop(n),f.setUp(i,t))},createMap:function(t){var e=0,i=0,n="",s=null;if("string"!=typeof t[0][0])return t;for(s=Array.setUp(),e=0;e<t.length;e++)for(s[e]=Array.setUp(),i=0;i<t[e].length;i++)n=t[e][i],this.updateTile(n,s,e,i);return s},updateTile:function(t,e,i,n){var s=null,r=this.tiles;t.id&&(t=t.id),(s=r[t])||null===s||(s=r[t]=this.createTile(t)),e[i][n]=s},createGrid:function(t,e){var i=this.cacheHeight,n=this.cacheWidth,s=this.cacheTilesHeight,r=this.cacheTilesWidth,o=0,u=0,c=null,d=this.scaleX,f=this.scaleY,g=this.tileHeight,v=this.tileWidth,m=this.tilesHeight,y=this.tilesWidth,_=0,b=0,w=this.owner.z,x=null,T=null,E=Array.setUp();for(_=0;y>_;_+=r)for(x=Array.setUp(),E.push(x),b=0;m>b;b+=s)u=Math.min(p((y-_)*v+2),n),o=Math.min(p((m-b)*g+2),i),(c=new h(e,u,o)).frame=new a(1,1,(u/v>>0)*v+1,(o/g>>0)*g+1),(T=new l(c)).z=w,T.scaleX=d,T.scaleY=f,x.push(T),t.addChild(T),w-=1e-6;return E},updateRegion:function(t){var e=Math.floor(this.cacheWidth/this.tileWidth),i=Math.floor(this.cacheHeight/this.tileHeight);this.cacheTilesWidth=Math.min(this.tilesWidth,e),this.cacheTilesHeight=Math.min(this.tilesHeight,i),this.cacheClipWidth=this.cacheTilesWidth*this.tileWidth,this.cacheClipHeight=this.cacheTilesHeight*this.tileHeight,this.tileCache&&(this.mapContainer.mask=(new r).beginFill(0).drawRect(0,0,this.cacheClipWidth+t,this.cacheClipHeight+t).endFill())},updateBufferRegion:function(t){var e=Math.floor(this.cacheWidth/this.tileWidth),i=Math.floor(this.cacheHeight/this.tileHeight);this.cacheTilesWidth=Math.min(this.tilesWidth,Math.ceil((t.width+2*this.buffer)/this.tileWidth),e),this.cacheTilesHeight=Math.min(this.tilesHeight,Math.ceil((t.height+2*this.buffer)/this.tileHeight),i),this.cacheClipWidth=this.cacheTilesWidth*this.tileWidth,this.cacheClipHeight=this.cacheTilesHeight*this.tileHeight,this.mapContainer.mask=(new r).beginFill(0).drawRect(0,0,this.cacheClipWidth,this.cacheClipHeight).endFill()},update:function(t,e,i,n){this.populate(e,n),this.render(e,t,this.mapContainer,this.mapContainerWrapper,i,n),n&&n.set(e)},populateTiles:function(t,e){var i=0,n=0,s=0,r=0,o=null,a=Array.setUp();for(this.tileContainer.removeChildren(),i=t.left;i<=t.right;i++)for(n=t.top;n<=t.bottom;n++)if(!e||e.empty||n>e.bottom||n<e.top||i>e.right||i<e.left)for(r=0;r<this.imageMap.length;r++)(o=this.imageMap[r][i][n].getNext())&&(o.template&&a.push(o.template),o.x=(i+.5)*this.tileWidth,o.y=(n+.5)*this.tileHeight,this.tileContainer.addChild(o));for(s=0;s<a.length;s++)a[s].clear();a.recycle()},populateTilesAndEntities:function(t,e){var i=0,n=0,s=0,r=0,o=null,a=null,h=Array.setUp(),l=Array.setUp(),u=null;for(this.tileContainer.removeChildren(),i=t.left;i<=t.right;i++)for(n=t.top;n<=t.bottom;n++)if(!e||e.empty||n>e.bottom||n<e.top||i>e.right||i<e.left){for(r=0;r<this.imageMap.length;r++)(o=this.imageMap[r][i][n].getNext())&&(o.template&&l.push(o.template),o.x=(i+.5)*this.tileWidth,o.y=(n+.5)*this.tileHeight,this.tileContainer.addChild(o));if(this.doMap[i]&&this.doMap[i][n])for(u=this.doMap[i][n],s=0;s<u.length;s++)u[s].drawn||(u[s].drawn=!0,h.push(u[s]))}if(this.mapContainer.removeChildren(),this.mapContainer.addChild(this.tileContainer),h.length)for(h.sort(d),s=0;s<h.length;s++)delete(a=h[s]).drawn,this.mapContainer.addChild(a),a.mask&&this.mapContainer.addChild(a.mask);for(s=0;s<l.length;s++)l[s].clear();l.recycle(),h.recycle()},renderCache:function(t,e,i,n,s,r){s&&!r.empty&&(s.x=r.left*this.tileWidth,s.y=r.top*this.tileHeight,i.addChild(s)),e.clear(),i.x=-t.left*this.tileWidth,i.y=-t.top*this.tileHeight,e.render(n),e.requiresUpdate=!0},renderCacheWithExtrusion:function(t,e,i,n){var s=new r;s.lineStyle(1,0),s.drawRect(.5,.5,this.cacheClipWidth+1,this.cacheClipHeight+1),e.clear(),n.mask=s,i.x=-t.left*this.tileWidth,i.y=-t.top*this.tileHeight+1,e.render(n),i.x=-t.left*this.tileWidth+1,i.y=-t.top*this.tileHeight,e.render(n),i.x=-t.left*this.tileWidth+2,i.y=-t.top*this.tileHeight+1,e.render(n),i.x=-t.left*this.tileWidth+1,i.y=-t.top*this.tileHeight+2,e.render(n),n.mask=null,i.x=-t.left*this.tileWidth+1,i.y=-t.top*this.tileHeight+1,e.render(n),e.requiresUpdate=!0},updateGrid:function(){var t=this.cache,e=this.cacheTilesHeight,i=this.cacheTilesWidth,n=this.tilesHeight-1,s=this.tilesWidth-1,r=0,o=0,a=this.cacheGrid;for(r=0;r<a.length;r++)for(o=0;o<a[r].length;o++)t.setBounds(r*i,o*e,Math.min((r+1)*i,s),Math.min((o+1)*e,n)),this.update(a[r][o].texture,t)},destroy:function(){var t=0,e=0,i="",n=this.cacheGrid,s=this.doMap,r=this.imageMap;if(n){for(t=0;t<n.length;t++)for(e=0;e<n[t].length;e++)n[t][e].texture.destroy(!0),this.parentContainer.removeChild(n[t][e]);n.recycle(2),delete this.cacheGrid}else this.tilesSprite?(this.tilesSprite.texture.alternate&&this.tilesSprite.texture.alternate.destroy(!0),this.tilesSprite.texture.destroy(!0),this.parentContainer.removeChild(this.tilesSprite)):this.parentContainer.removeChild(this.mapContainer);for(i in r.recycle(2),this.tiles)this.tiles.hasOwnProperty(i)&&this.tiles[i].destroy();if(this.tiles=null,this.parentContainer=null,this.tilesSprite=null,this.spriteSheet.recycleSpriteSheet(),s){for(t=0;t<this.cachedDisplayObjects.length;t++)this.cachedDisplayObjects[t].destroy();for(this.cachedDisplayObjects.recycle(),t=0;t<s.length;t++)if(s[t]){for(e=0;e<s.length;e++)s[t][e]&&s[t][e].recycle();s[t].recycle()}s.recycle()}this.laxCam.recycle(),this.cache.recycle(),this.cachePixels.recycle()}},getAssetList:function(){var t=function(e,i){if(e){if("string"==typeof e)return t(i[e],i);if(e.images)return e.images.greenSlice()}return Array.setUp()};return function(e,i,n){var s=null,r=0,o=null,a=platypus.game.settings.spriteSheets,h=e.spriteSheet||i.spriteSheet||n.spriteSheet;if(h){if("string"==typeof h&&"import"!==h)return t(h,a);if(Array.isArray(h)){for(r=h.length,o=Array.setUp();r--;)s=t(h[r],a),o.union(s),s.recycle();return o}if(h.images)return h.images.greenSlice()}return Array.setUp()}}()})}(),function(){"use strict";var t=include("platypus.Data");platypus.createComponentClass({id:"SceneChanger",properties:{scene:"",persistentData:null},constructor:function(){this.persistentData=t.setUp(this.persistentData)},events:{"new-scene":function(t){var e=t||this,i=e.scene||this.scene,n=e.persistentData||this.persistentData;platypus.game.loadScene(i,n)},"set-scene":function(t){this.scene=t},"set-persistent-scene-data":function(t){var e=this.persistentData,i="";for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}},methods:{destroy:function(){}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.Data"),i=include("platypus.Entity"),n=268435455,s=function(){var t=function(t,e){return t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24)>>>0},e=function(t,e){return t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24)>>>0};return function(i,n){var s=4,r=[],o=atob(i.replace(/\\/g,""));if("zlib"===n)for(o=pako.inflate(o);s<=o.length;)r.push(e(o,s-4)),s+=4;else for(;s<=o.length;)r.push(t(o,s-4)),s+=4;return r}}(),r=function(t){for(var e=1;t>e;)e*=10;return e},o={x:1,y:1,id:-1},a=function(t){var e=o,i=!!(1073741824&t),s=!!(2147483648&t);return e.id=n&t,e.x=1,e.y=1,i&&(e.y=-1),s&&(e.x=-1),e},h=function(t,e){var i=0,n=t.gid||-1,s={},r={gid:-1,transform:null,properties:s,type:""},h=null,u=null;for(-1!==n&&(r.transform=a(n),n=r.gid=o.id),i=0;i<e.length&&!(e[i].firstgid>n);i++)u=e[i];return u&&u.tileproperties&&u.tileproperties[n-u.firstgid]&&(h=u.tileproperties[n-u.firstgid]),""!==t.type?r.type=t.type:""!==t.name?r.type=t.name:h&&(r.type=h.entity||h.type||""),r.type?(r.transform?(s.scaleX=r.transform.x,s.scaleY=r.transform.y):(s.scaleX=1,s.scaleY=1),l(h,r.properties),l(t.properties,r.properties),r):null},l=function(t,e){var i="";if(t&&e)for(i in t)t.hasOwnProperty(i)&&(e[i]=u(t[i]));return e},u=function(t){var e=0;if("string"==typeof t){if(0===(e=parseFloat(t))||e)return e;if("true"===t)return!0;if("false"===t)return!1;if(t.length>1&&("{"===t[0]&&"}"===t[t.length-1]||"["===t[0]&&"]"===t[t.length-1]))try{return JSON.parse(t)}catch(t){}}return t},c=function(t,n){var s=0,r=0,o=Array.setUp(),a=null,l=Array.setUp(),u=null,c=null,d=null;if("string"==typeof t&&(t=platypus.game.settings.levels[t]),t)if(t.tilesets=f(t.tilesets),t.assets)l.union(t.assets);else{for(s=0;s<t.layers.length;s++)if("objectgroup"===t.layers[s].type)for(r=0;r<t.layers[s].objects.length;r++)(c=h(t.layers[s].objects[r],t.tilesets))&&(d=i.getAssetList(c),l.union(d),d.recycle());else"imagelayer"===t.layers[s].type?l.union([t.layers[s].image]):t.layers[s].properties&&t.layers[s].properties.entity&&(u=e.setUp("type",t.layers[s].properties.entity),a=i.getAssetList(u),l.union(a),a.recycle(),u.recycle());if(!n){for(s=0;s<t.tilesets.length;s++)o.push(t.tilesets[s].image);l.union(o),o.recycle()}t.assets=l.greenSlice()}return l},d={"render-layer":{id:"render-layer",components:[{type:"RenderTiles",spriteSheet:"import",imageMap:"import",entityCache:!0}]},"collision-layer":{id:"collision-layer",components:[{type:"CollisionTiles",collisionMap:"import"}]},"image-layer":{id:"image-layer",components:[{type:"RenderTiles",spriteSheet:"import",imageMap:"import"}]}},p=function(t){var e="",i=platypus.game.settings.levels[t.source.replace(".json","")];for(e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return delete t.source,t},f=function(t){var e=0;for(e=0;e<t.length;e++)t[e].source&&(t[e]=p(t[e]));return t};platypus.createComponentClass({id:"TiledLoader",properties:{offsetMap:!1,showCollisionTiles:!1,images:null,layerIncrement:1e3,separateTiles:!1,spriteSheet:null},publicProperties:{level:null,unitsPerPixel:1,imagesScale:1,entityPositionX:"center",entityPositionY:"bottom",manuallyLoad:!1},constructor:function(){this.assetCache=platypus.game.app.assetManager.cache,this.layerZ=0,this.followEntity=!1},events:{"scene-loaded":function(t){this.manuallyLoad||this.loadLevel({level:this.level||t.level,persistentData:t})},"load-level":function(t){this.loadLevel(t)}},methods:{createLayer:function(t,e,s,r,o,a,h,u,c){var p=null,f=e.width,g=e.height,v=e.tileheight||a,m=e.tilewidth||o,y=0,_=0,b=0,w=JSON.parse(JSON.stringify(platypus.game.settings.entities[t]||d[t])),x=null,T=null,E=null,S=!1,A=null,P=null,C=0,M=0,L=0,O="",R=null;if(this.decodeLayer(e),R=e.data,w.properties=w.properties||{},e.properties){if(e.properties.width&&(y=parseInt(e.properties.width,10)),e.properties.height&&(_=parseInt(e.properties.height,10)),y||_){for(y=y||f,_=_||g,R=[],M=0;y>M;M++)for(L=0;_>L;L++)R[M+L*y]=f>M&&g>L?e.data[M+L*f]:0;f=y,g=_}l(e.properties,w.properties)}if(x={},T=[],E=[],"collision-layer"===t)for(P=[],M=0;M<h.length;M++)if((A=h[M]).tileproperties)for(O in A.tileproperties)A.tileproperties.hasOwnProperty(O)&&A.tileproperties[O].jumpThrough&&P.push(A.firstgid+parseInt(O,10));if(w.properties.width=m*f*this.unitsPerPixel,w.properties.height=v*g*this.unitsPerPixel,w.properties.columns=f,w.properties.rows=g,w.properties.tileWidth=m*this.unitsPerPixel,w.properties.tileHeight=v*this.unitsPerPixel,w.properties.scaleX=this.imagesScale,w.properties.scaleY=this.imagesScale,w.properties.layerZ=this.layerZ,w.properties.left=w.properties.x||s,w.properties.top=w.properties.y||r,w.properties.z=w.properties.z||this.layerZ,h.length)for(b=h[h.length-1].imagewidth/m*(h[h.length-1].imageheight/v)+h[h.length-1].firstgid,M=-1;b>M;M++)x["tile"+M]=M;for(M=0;f>M;M++)for(T[M]=[],E[M]=[],L=0;g>L;L++)C=+R[M+L*f]-1,E[M][L]="tile"+C,C+=1,P&&P.length&&P[0]===(n&C)&&(C|=268435456),T[M][L]=C;for(M=0;M<w.components.length;M++)"RenderTiles"===w.components[M].type&&(S=w.components[M]),"import"===w.components[M].spriteSheet?w.components[M].spriteSheet={images:e.image?[e.image]:u,frames:{width:m*this.unitsPerPixel/this.imagesScale,height:v*this.unitsPerPixel/this.imagesScale,regX:m*this.unitsPerPixel/this.imagesScale/2,regY:v*this.unitsPerPixel/this.imagesScale/2},animations:x}:w.components[M].spriteSheet&&("string"==typeof w.components[M].spriteSheet&&platypus.game.settings.spriteSheets[w.components[M].spriteSheet]&&(w.components[M].spriteSheet=platypus.game.settings.spriteSheets[w.components[M].spriteSheet]),w.components[M].spriteSheet.animations||(w.components[M].spriteSheet.animations=x)),"import"===w.components[M].collisionMap&&(w.components[M].collisionMap=T),"import"===w.components[M].imageMap&&(w.components[M].imageMap=E);return this.layerZ+=this.layerIncrement,"render-layer"===t&&!this.separateTiles&&c&&c.tileHeight===v&&c.tileWidth===m&&c.columns===f&&c.rows===g?(c.triggerEvent("add-tiles",S),c):(p={},"render-layer"===t&&this.spriteSheet&&("string"==typeof this.spriteSheet?p.spriteSheet=platypus.game.settings.spriteSheets[this.spriteSheet]:p.spriteSheet=this.spriteSheet,p.spriteSheet.animations||(p.spriteSheet.animations=x)),this.owner.addEntity(new i(w,{properties:p})))},convertImageLayer:function(t,e,i){var n,s=0,r=t.properties||{},o={data:[],image:"",height:1,name:t.name,type:"tilelayer",width:1,tileheight:e,tilewidth:i,x:t.x,y:t.y,properties:r};for(r.repeat&&(o.width=+r.repeat,o.height=+r.repeat),r["repeat-x"]&&(o.width=+r["repeat-x"]),r["repeat-y"]&&(o.height=+r["repeat-y"]),n=o.width*o.height,s=0;n>s;s++)o.data.push(1);return this.assetCache.read(t.name)?(o.image=t.name,o.tileheight=this.assetCache.read(t.name).height,o.tilewidth=this.assetCache.read(t.name).width):(platypus.debug.warn('Component TiledLoader: Cannot find the "'+t.name+'" sprite sheet. Add it to the list of assets in config.json and give it the id "'+t.name+'".'),o.image=t.image),o},loadLevel:function(i){var n,s,o,a,h,u,c,d=!0,p=0,g=null,v=null,m=null,y=e.setUp("count",0,"progress",0,"total",0),_=0,b=0,w=e.setUp("level",null,"world",t.setUp(),"width",0,"height",0,"tile",t.setUp(),"camera",null);if(n=(s="string"==typeof i.level?platypus.game.settings.levels[i.level]:i.level).layers,a=f(s.tilesets),h=s.tilewidth,u=s.tileheight,s.properties&&l(s.properties,this.owner),0===(g=this.images?this.images.greenSlice():Array.setUp()).length)for(p=0;p<a.length;p++)this.assetCache.read(a[p].name)?g.push(a[p].name):(platypus.debug.warn('Component TiledLoader: Cannot find the "'+a[_].name+'" sprite sheet. Add it to the list of assets in config.json and give it the id "'+a[_].name+'".'),g.push(a[p].image));for(c=s.width*h*this.unitsPerPixel,o=s.height*u*this.unitsPerPixel,this.offsetMap&&(_=r(c),b=r(o)),y.total=p=n.length;p--;)"objectgroup"===n[p].type?y.total+=n[p].objects.length:d&&("collision"===n[p].name||n[p].properties&&"collision-layer"===n[p].properties.entity)&&(d=!1);for(p=0;p<n.length;p++){switch((m=n[p]).type){case"imagelayer":v=this.createLayer("image-layer",this.convertImageLayer(m,u,h),_,b,h,u,a,g,v);break;case"objectgroup":this.setUpEntities(m,_,b,h,u,a,y),v=null;break;case"tilelayer":v=this.setupLayer(m,d,v,_,b,h,u,a,g);break;default:platypus.debug.warn('TiledLoader: Platypus does not support Tiled layers of type "'+m.type+'". This layer will not be loaded.')}this.updateLoadingProgress(y)}y.recycle(),w.level=s,w.camera=this.followEntity,w.width=c,w.height=o,w.world.setBounds(_,b,_+c,b+o),w.tile.setBounds(0,0,h,u),this.owner.triggerEvent("world-loaded",w),w.world.recycle(),w.tile.recycle(),w.recycle(),this.owner.removeComponent(this)},setUpEntities:function(t,e,n,s,r,o,a){var l=1e3,u=0,c=0,d=0,p=0,f=0,g=0,v=0,m=null,y=0,_=null,b=null,w=null,x="",T="",E="",S=-1,A=1/0,P=-1/0,C=1/0,M=-1/0,L=null,O=null,R=null,I=0,D=0;for(x=this.entityPositionX,T=this.entityPositionY,t.properties&&(t.properties.entityPositionX&&(x=t.properties.entityPositionX),t.properties.entityPositionY&&(T=t.properties.entityPositionY)),y=0;y<t.objects.length;y++){if(_=t.objects[y],L=h(_,o)){if(S=L.gid,E=L.type,w=(b=platypus.game.settings.entities[E])&&b.properties||null,O=L.properties,_.polygon||_.polyline){for(A=1/0,P=-1/0,C=1/0,M=-1/0,R=null,_.polygon?R=_.polygon:_.polyline&&(R=_.polyline),d=0;d<R.length;d++)R[d].x>P&&(P=R[d].x),R[d].x<A&&(A=R[d].x),R[d].y>M&&(M=R[d].y),R[d].y<C&&(C=R[d].y);if(O.width=P-A,O.height=M-C,O.x=_.x+A,O.y=_.y+C,u=0,c=0,O.width=O.width*this.unitsPerPixel,O.height=O.height*this.unitsPerPixel,O.x=O.x*this.unitsPerPixel+e,O.y=O.y*this.unitsPerPixel+n,_.polygon)for(O.shape={},O.shape.type="polygon",O.shape.points=[],p=0;p<R.length;p++)O.shape.points.push({x:(R[p].x-A)*this.unitsPerPixel+e,y:(R[p].y-C)*this.unitsPerPixel+n});else if(_.polyline)for(O.shape={},O.shape.type="polyline",O.shape.points=[],p=0;p<R.length;p++)O.shape.points.push({x:(R[p].x-A)*this.unitsPerPixel+e,y:(R[p].y-C)*this.unitsPerPixel+n})}else I=s*this.unitsPerPixel,D=r*this.unitsPerPixel,u=0,c=0,O.width=(_.width||0)*this.unitsPerPixel,O.height=(_.height||0)*this.unitsPerPixel,w&&("number"==typeof w.width&&(O.width=w.width,u=I),"number"==typeof w.height&&(O.height=w.height,c=D)),O.width||(O.width=I),O.height||(O.height=D),u=u||O.width,c=c||O.height,O.x=_.x*this.unitsPerPixel,O.y=_.y*this.unitsPerPixel,_.rotation&&(f=(_.width||I)/2,g=(_.height||D)/2,v=_.rotation/180%2*Math.PI,m=platypus.Vector.setUp(f,-g).rotate(v),O.rotation=_.rotation,O.x=Math.round((O.x+m.x-f)*l)/l,O.y=Math.round((O.y+m.y+g)*l)/l,m.recycle()),"left"===x?O.regX=0:"center"===x?(O.regX=O.width/2,O.x+=u/2):"right"===x&&(O.regX=O.width,O.x+=u),O.x+=e,-1===S&&(O.y+=O.height),"bottom"===T?O.regY=O.height:"center"===T?(O.regY=O.height/2,O.y-=c/2):"top"===T&&(O.regY=0,O.y-=c),O.y+=n,_.ellipse?(O.shape={},O.shape.type="ellipse",O.shape.width=O.width*this.unitsPerPixel,O.shape.height=O.height*this.unitsPerPixel):_.width&&_.height&&(O.shape={},O.shape.type="rectangle",O.shape.width=O.width*this.unitsPerPixel,O.shape.height=O.height*this.unitsPerPixel);w?(O.scaleX*=this.imagesScale*(w.scaleX||1),O.scaleY*=this.imagesScale*(w.scaleY||1)):(O.scaleX*=this.imagesScale,O.scaleY*=this.imagesScale),O.layerZ=this.layerZ,O.z?O.z+=this.layerZ:w&&"number"==typeof w.z?O.z=this.layerZ+w.z:O.z=this.layerZ,O.parent=this.owner,(_=this.owner.addEntity(new i(b,{properties:O})))&&(_.camera&&(this.followEntity={entity:_,mode:_.camera}),this.owner.triggerEvent("entity-created",_))}this.updateLoadingProgress(a)}this.layerZ+=this.layerIncrement},setupLayer:function(t,e,i,n,s,r,o,a,h){var l="render-layer";return t.properties&&t.properties.entity?l=t.properties.entity:"collision"===t.name?l="collision-layer":"action"===t.name&&(l=e?"tile-layer":"render-layer"),"tile-layer"===l||this.showCollisionTiles&&platypus.game.settings.debug?(this.createLayer("collision-layer",t,n,s,r,o,a,h,i),this.createLayer("render-layer",t,n,s,r,o,a,h,i)):"collision-layer"===l?(this.createLayer("collision-layer",t,n,s,r,o,a,h,i),null):this.createLayer(l,t,n,s,r,o,a,h,i)},updateLoadingProgress:function(t){t.count+=1,t.progress=t.count/t.total,this.owner.triggerEvent("level-loading-progress",t)},destroy:function(){}},publicMethods:{decodeLayer:function(t){return"base64"===t.encoding&&(t.data=s(t.data,t.compression),t.encoding="csv"),t}},getAssetList:function(t,e,i){var n=e||{},s=i||{},r=t.spriteSheet||n.spriteSheet||s.spriteSheet,o=t.images||n.images||s.images,a=c(t.level||n.level||s.level,r);return r&&("string"==typeof r?a.union(platypus.game.settings.spriteSheets[r].images):a.union(r.images)),o&&a.union(o),a},getLateAssetList:function(t,e,i,n){var s=e||{},r=i||{},o=t.spriteSheet||s.spriteSheet||r.spriteSheet;return n&&n.level?c(n.level,o):Array.setUp()}})}(),function(){"use strict";var t=include("platypus.Data"),e=function(){this.active--},i=function(){this.active++},n=function(t){this.timelineInstances.push(this.createTimeStampedTimeline(this.timelines[t]))},s=function(t){for(var e=t.delta,i=null,n=this.timelineInstances,s=n.length;s--;)(i=n[s]).active&&(0===i.timeline.length?(n.greenSplice(s),i.timeline.recycle(2),i.recycle()):this.progressTimeline(i,e))};platypus.createComponentClass({id:"Timeline",properties:{timelines:{}},constructor:function(){var t=0;for(t in this.timelineInstances=Array.setUp(),this.timelines)this.timelines.hasOwnProperty(t)&&this.addEventListener(t,n.bind(this,t))},events:{"logic-tick":s,"handle-logic":s},methods:{createTimeStampedTimeline:function(n){var s=Array.setUp(),r=0,o=0,a=null;for(r=0;r<n.length;r++)"number"==typeof(a=n[r])?o+=a:s.push(t.setUp("time",o,"value",a));return s.reverse(),t.setUp("timeline",s,"time",0,"active",1,"pause",e,"play",i)},progressTimeline:function(t,e){var i=t.timeline,n=i.length,s=null,r=null,o=this.owner;for(t.time+=e;n--;){if(!((s=i[n]).time<=t.time))return;if("string"==typeof(r=s.value)?this.owner.triggerEvent(r):(r.entity&&((o=this.owner.getEntityById?this.owner.getEntityById(r.entity):this.owner.parent.getEntityById(r.entity))||(platypus.debug.warn("No entity of that id"),o=this.owner)),r.message?o.triggerEvent(r.event,r.message):o.trigger(r.event)),s.recycle(),i.pop(),!t.active)return;s=null,r=null,o=this.owner}},destroy:function(){for(var t=null,e=this.timelineInstances,i=e.length;i--;)(t=e[i]).timeline.recycle(2),t.recycle();e.recycle(),this.timelineInstances=null}}})}(),function(){"use strict";var t=function(t){var e=null;for(e in this.watchedEntities)t.type===e&&this.watchedEntities[e].push(t)},e=function(t){var e=0,i=t.type;for(e=this.watchedEntities[i].length-1;e>=0;e--)if(this.watchedEntities[i][e]===t){this.watchedEntities[i].splice(e,1);break}},i=function(t){var e=t.delta,i=0,n=null,s=null,r=-1,o=!1,a=null;for(i=0;i<this.tutorials.length;i++)if(o=!1,n=this.tutorials[i],this.playing||0!==this.theQueue.length?(!this.playing&&this.theQueue.length>0&&n.priority>this.theQueue[0].priority||this.playing&&this.playing.priority<n.priority||n.queue)&&(o=!0):o=!0,o&&this.checkRequirements(n.requirements)){if(n.replayDelay&&n.replayDelayTimer>0&&(n.replayDelayTimer-=e,n.replayDelayTimer>0))continue;(!s||s.priority<n.priority)&&(s=n,r=i)}s?(a=this.tutorials.splice(r,1)[0],this.playing?a.priority>this.playing.priority?(this.owner.triggerEvent("stop-audio"),this.play(a)):this.queue(a):this.theQueue.length>0?a.priority>this.theQueue[0].priority?this.play(a):(this.play(this.theQueue.splice(0,1)[0]),this.queue(a)):this.play(a)):!this.playing&&this.theQueue.length>0&&this.play(this.theQueue.splice(0,1)[0])};platypus.createComponentClass({id:"Tutorial",properties:{tutorialDefs:[]},publicProperties:{},constructor:function(){var t=0,e=null,i=null,n=null;for(this.playing=null,this.theQueue=[],this.watchedEntities={},this.tutorials=[],t=0;t<this.tutorialDefs.length;t++)if(n={},(i=this.tutorialDefs[t]).events){for(e in n.events=i.events.greenSlice(),n.originalEvents=i.events.greenSlice(),n.priority=i.priority||0,n.queue=i.queue||!1,n.timesToReplay="number"==typeof i.timesToReplay?i.timesToReplay:1/0,n.replayDelay=i.replayDelay||null,n.replayDelayTimer=n.replayDelay,n.level=i.level,n.requirements={},i.requirements)i.requirements.hasOwnProperty(e)&&(n.requirements[e]=i.requirements[e].greenSlice(),this.watchedEntities[e]||(this.watchedEntities[e]=[]));this.tutorials.push(n)}else platypus.debug.warn("Tutorial definition lacks events.")},events:{"child-entity-added":t,"peer-entity-added":t,"child-entity-removed":e,"peer-entity-removed":e,"logic-tick":i,"handle-logic":i,"sequence-complete":function(){this.playing.timesToReplay>=0&&this.tutorials.push(this.playing),this.playing=null}},methods:{play:function(t){var e;this.playing=t,0===this.playing.events.length&&(this.playing.events=this.playing.originalEvents.greenSlice()),e=this.playing.events.splice(Math.floor(Math.random()*this.playing.events.length),1)[0],this.owner.triggerEvent(e),t.timesToReplay-=1,t.replayDelayTimer=t.replayDelay},queue:function(t){var e=0,i=!1;for(e=0;e<this.theQueue.length;e++)if(this.theQueue[e].priority<t.priority){this.theQueue.splice(e,0,t),i=!0;break}i||this.theQueue.push(t)},checkRequirements:function(t){var e=0,i=0,n=null,s=null,r=null,o=!0;for(n in t)if(t.hasOwnProperty(n)){for(s=t[n],i=this.watchedEntities[n].length-1;i>=0;i--){for(r=this.watchedEntities[n][i],o=!0,e=0;e<s.length;e++)if(!r.state.get(s[e])){o=!1;break}if(o)break}if(!o)return!1}return!0},destroy:function(){this.watchedEntities=null,this.theQueue=null,this.playing=null,this.tutorials=null}}})}(),function(){"use strict";var t=function(t,e,i,n){return function(){t.trigger(e,i,n)}},e=function(e){return function(i){var n=0,s=e,r=null,o=null,a=null,h=createjs.Tween.get(this.owner);if(Array.isArray(i))s=i;else if(!Array.isArray(s))return;for(n=0;n<s.length;n++)"string"==typeof(r=s[n])?h.call(t(this.owner,r)):Array.isArray(r)?"call"===r[0]&&"string"==typeof r[1]?h.call(t(this.owner,r[1])):("to"===(o=r.greenSlice()).greenSplice(0)&&o[2]&&createjs.Ease[o[2]]&&(o.length>3?((a=o.greenSlice()).greenSplice(0),a.greenSplice(0),o[2]=createjs.Ease[a.greenSplice(0)].apply(null,a),a.recycle()):o[2]=createjs.Ease[o[2]]),h[r[0]].apply(h,o),o.recycle()):"call"===r.method&&"string"==typeof r.params?h.call(t(this.owner,r.params)):h[r.method].apply(h,r.params)}};platypus.createComponentClass({id:"Tween",constructor:function(t){var i="";if(t.events)for(i in t.events)t.events.hasOwnProperty(i)&&this.addEventListener(i,e(t.events[i]))}})}(),function(){"use strict";var t=function(t,e){return" "===e?t+"default":t+e},e=function(e,i,n,s){var r=0,o="",a={},h=0,l="",u="",c=e.voice;if("string"==typeof e.sound)a.sound=e.sound,a.events=Array.setUp();else{for(o in e.sound)e.sound.hasOwnProperty(o)&&(a[o]=e.sound[o]);a.events?a.events=a.events.greenSlice():a.events=Array.setUp()}if(c)for(c+=" ",r=0;r<c.length;r++)(u=c[r])!==l&&(l=u,a.events.push({time:h,event:t(n,u)})),h+=s;return a},i=function(t,i,n,s){var r=0,o=Array.setUp();if(i[" "]||(i[" "]=i.default),Array.isArray(t)){for(r=0;r<t.length;r++)"number"==typeof t[r]?o.push(t[r]):o.push(e(t[r],0,n,s));return o}return e(t,0,n,s)};platypus.createComponentClass({id:"VoiceOver",properties:{animationMap:{default:"default"},frameLength:100,messagePrefix:"VoiceOver",voiceOverMap:{}},constructor:function(e){var n="",s={audioMap:{},aliases:e.aliases},r={acceptInput:e.acceptInput,aliases:e.aliases,animationMap:{},eventBased:!0,flip:e.flip,hidden:e.hidden,mask:e.mask,mirror:e.mirror,offsetZ:e.offsetZ,pins:e.pins,pinTo:e.pinTo,restart:e.restart,rotate:e.rotate,scaleX:e.scaleX,scaleY:e.scaleY,spriteSheet:e.spriteSheet,stateBased:e.stateBased||!1};for(n in this.message=this.messagePrefix+"-",this.animationMap)this.animationMap.hasOwnProperty(n)&&(r.animationMap[t(this.message,n)]=this.animationMap[n]);for(n in r.animationMap.default=this.animationMap.default,this.owner.addComponent(new platypus.components.RenderSprite(this.owner,r)),this.voiceOverMap)this.voiceOverMap.hasOwnProperty(n)&&(s.audioMap[n]=i(this.voiceOverMap[n],this.animationMap,this.message,this.frameLength));this.owner.addComponent(new platypus.components.AudioVO(this.owner,s))},events:{load:function(){this.owner.removeComponent(this)}},getAssetList:function(t,e,i){var n=t.spriteSheet||e.spriteSheet||i.spriteSheet;return"string"==typeof n?platypus.game.settings.spriteSheets[n].images.greenSlice():n.images.greenSlice()}})}(),function(){"use strict";var t=include("window.XMLHttpRequest");platypus.createComponentClass({id:"XHR",properties:{method:"GET",path:"",responseType:"text",withCredentials:!1},constructor:function(t){this.setProperties(t)},events:{request:function(t){if(this.setProperties(t),"GET"===this.method)this.get();else{if("POST"!==this.method)throw"Method must be GET or POST";this.post()}}},methods:{setProperties:function(t){var e="",i="",n=t||this;if(this.method=n.method||this.method||"GET",this.path=n.path||this.path||null,this.responseType=n.responseType||this.responseType||"text",this.withCredentials=n.withCredentials||this.withCredentials||!1,n!==this&&n.data)for(e in this.data="",n.data)n.data.hasOwnProperty(e)&&(this.data+=i+e+"="+n.data[e],i="&");else this.data="";this.onload=n.onload||this.onload||function(){200===this.status&&this.owner.triggerEvent("response",this.responseText)}.bind(this)},get:function(){var e=new t,i=this.path;this.data&&(i+="?"+this.data),e.open(this.method,i,!0),e.withCredentials=this.withCredentials,e.responseType=this.responseType,e.onload=this.onload,e.send()},post:function(){var e=new t;e.open(this.method,this.path,!0),e.withCredentials=this.withCredentials,e.responseType=this.responseType,e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onload=this.onload,e.send(this.data)}}})}();